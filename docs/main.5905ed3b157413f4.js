var Nbe=Object.defineProperty,kbe=Object.defineProperties,Pbe=Object.getOwnPropertyDescriptors,Y0e=Object.getOwnPropertySymbols,xbe=Object.prototype.hasOwnProperty,Lbe=Object.prototype.propertyIsEnumerable,J0e=(h,l,g)=>l in h?Nbe(h,l,{enumerable:!0,configurable:!0,writable:!0,value:g}):h[l]=g,$0e=(h,l)=>{for(var g in l||(l={}))xbe.call(l,g)&&J0e(h,g,l[g]);if(Y0e)for(var g of Y0e(l))Lbe.call(l,g)&&J0e(h,g,l[g]);return h},Z0e=(h,l)=>kbe(h,Pbe(l));(self.webpackChunkpoc=self.webpackChunkpoc||[]).push([[179],{2011:(h,l,g)=>{"use strict";g.d(l,{Dh:()=>bh,GT:()=>ga,cc:()=>v_,hO:()=>I_,on:()=>_A,pX:()=>_s,xv:()=>n_});var f=g(5e3),k=g(127),q=g(5813);h=g.hmd(h);const _r=["ngOnDestroy"],_s=(V_,_0,c0,Pv={})=>new Proxy(V_,{get:(h0,I0)=>c0.runOutsideAngular(()=>{var G_;if(V_[I0])return(null===(G_=null==Pv?void 0:Pv.spy)||void 0===G_?void 0:G_.get)&&Pv.spy.get(I0,V_[I0]),V_[I0];if(_r.indexOf(I0)>-1)return()=>{};const e0=_0.toPromise().then(P_=>{const _v=P_&&P_[I0];return"function"==typeof _v?_v.bind(P_):_v&&_v.then?_v.then(E_=>c0.run(()=>E_)):c0.run(()=>_v)});return new Proxy(()=>{},{get:(P_,_v)=>e0[_v],apply:(P_,_v,E_)=>e0.then(L_=>{var F_;const J_=L_&&L_(...E_);return(null===(F_=null==Pv?void 0:Pv.spy)||void 0===F_?void 0:F_.apply)&&Pv.spy.apply(I0,E_,J_),J_})})})}),ga=(V_,_0)=>{_0.forEach(c0=>{Object.getOwnPropertyNames(c0.prototype||c0).forEach(Pv=>{Object.defineProperty(V_.prototype,Pv,Object.getOwnPropertyDescriptor(c0.prototype||c0,Pv))})})};class _l{constructor(_0){return _0}}const bh=new f.OlP("angularfire2.app.options"),n_=new f.OlP("angularfire2.app.name");function _A(V_,_0,c0){const h0="object"==typeof c0&&c0||{};h0.name=h0.name||"string"==typeof c0&&c0||"[DEFAULT]";const G_=k.Z.apps.filter(e0=>e0&&e0.name===h0.name)[0]||_0.runOutsideAngular(()=>k.Z.initializeApp(V_,h0));try{JSON.stringify(V_)!==JSON.stringify(G_.options)&&r_("error",`${G_.name} Firebase App already initialized with different options${h.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch(e0){}return new _l(G_)}const r_=(V_,..._0)=>{(0,f.X6Q)()&&"undefined"!=typeof console&&console[V_](..._0)},p_={provide:_l,useFactory:_A,deps:[bh,f.R0b,[new f.FiY,n_]]};let I_=(()=>{class V_{constructor(c0){k.Z.registerVersion("angularfire",q.q4.full,"core"),k.Z.registerVersion("angularfire",q.q4.full,"app-compat"),k.Z.registerVersion("angular",f.q4F.full,c0.toString())}static initializeApp(c0,Pv){return{ngModule:V_,providers:[{provide:bh,useValue:c0},{provide:n_,useValue:Pv}]}}}return V_.\u0275fac=function(c0){return new(c0||V_)(f.LFG(f.Lbi))},V_.\u0275mod=f.oAB({type:V_}),V_.\u0275inj=f.cJS({providers:[p_]}),V_})();function v_(V_,_0,c0,Pv,h0){const[,I0,G_]=globalThis.\u0275AngularfireInstanceCache.find(e0=>e0[0]===V_)||[];if(I0)return function S_(V_,_0){try{return V_.toString()===_0.toString()}catch(c0){return V_===_0}}(h0,G_)||(B_("error",`${_0} was already initialized on the ${c0} Firebase App with different settings.${x_?" You may need to reload as Firebase is not HMR aware.":""}`),B_("warn",{is:h0,was:G_})),I0;{const e0=Pv();return globalThis.\u0275AngularfireInstanceCache.push([V_,e0,h0]),e0}}const x_=!!h.hot,B_=(V_,..._0)=>{(0,f.X6Q)()&&"undefined"!=typeof console&&console[V_](..._0)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},5813:(h,l,g)=>{"use strict";g.d(l,{q4:()=>hM,iC:()=>RG,fc:()=>DS,HU:()=>IV,vb:()=>w9,JM:()=>pL});var f=g(5e3),k=g(5867),q=g(5861),_r=g(9681),_s=g(2090),ga=g(4859),_l=g(1877),bh=g(8766);const n_="@firebase/installations",p_="w:0.5.9",I_="FIS_v2",_0=new _s.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function c0(c_){return c_ instanceof _s.ZR&&c_.code.includes("request-failed")}function Pv({projectId:c_}){return`https://firebaseinstallations.googleapis.com/v1/projects/${c_}/installations`}function h0(c_){return{token:c_.token,requestStatus:2,expiresIn:L_(c_.expiresIn),creationTime:Date.now()}}function I0(c_,d_){return G_.apply(this,arguments)}function G_(){return(G_=(0,q.Z)(function*(c_,d_){const K_=(yield d_.json()).error;return _0.create("request-failed",{requestName:c_,serverCode:K_.code,serverMessage:K_.message,serverStatus:K_.status})})).apply(this,arguments)}function e0({apiKey:c_}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":c_})}function P_(c_,{refreshToken:d_}){const T_=e0(c_);return T_.append("Authorization",function F_(c_){return`${I_} ${c_}`}(d_)),T_}function _v(c_){return E_.apply(this,arguments)}function E_(){return(E_=(0,q.Z)(function*(c_){const d_=yield c_();return d_.status>=500&&d_.status<600?c_():d_})).apply(this,arguments)}function L_(c_){return Number(c_.replace("s","000"))}function J_(c_,d_){return Y_.apply(this,arguments)}function Y_(){return(Y_=(0,q.Z)(function*({appConfig:c_,heartbeatServiceProvider:d_},{fid:T_}){const K_=Pv(c_),p0=e0(c_),E0=d_.getImmediate({optional:!0});if(E0){const jI=yield E0.getHeartbeatsHeader();jI&&p0.append("x-firebase-client",jI)}const vI={method:"POST",headers:p0,body:JSON.stringify({fid:T_,authVersion:I_,appId:c_.appId,sdkVersion:p_})},SI=yield _v(()=>fetch(K_,vI));if(SI.ok){const jI=yield SI.json();return{fid:jI.fid||T_,registrationStatus:2,refreshToken:jI.refreshToken,authToken:h0(jI.authToken)}}throw yield I0("Create Installation",SI)})).apply(this,arguments)}function D0(c_){return new Promise(d_=>{setTimeout(d_,c_)})}const EI=/^[cdef][\w-]{21}$/;function Y0(){try{const c_=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(c_),c_[0]=112+c_[0]%16;const T_=function x1(c_){return function O0(c_){return btoa(String.fromCharCode(...c_)).replace(/\+/g,"-").replace(/\//g,"_")}(c_).substr(0,22)}(c_);return EI.test(T_)?T_:""}catch(c_){return""}}function _1(c_){return`${c_.appName}!${c_.appId}`}const UI=new Map;function Z1(c_,d_){const T_=_1(c_);w1(T_,d_),function SN(c_,d_){const T_=function NT(){return!_T&&"BroadcastChannel"in self&&(_T=new BroadcastChannel("[Firebase] FID Change"),_T.onmessage=c_=>{w1(c_.data.key,c_.data.fid)}),_T}();T_&&T_.postMessage({key:c_,fid:d_}),function YT(){0===UI.size&&_T&&(_T.close(),_T=null)}()}(T_,d_)}function w1(c_,d_){const T_=UI.get(c_);if(T_)for(const K_ of T_)K_(d_)}let _T=null;const jR="firebase-installations-store";let ZO=null;function KI(){return ZO||(ZO=(0,bh.X3)("firebase-installations-database",1,{upgrade:(c_,d_)=>{0===d_&&c_.createObjectStore(jR)}})),ZO}function dO(c_,d_){return TT.apply(this,arguments)}function TT(){return(TT=(0,q.Z)(function*(c_,d_){const T_=_1(c_),p0=(yield KI()).transaction(jR,"readwrite"),E0=p0.objectStore(jR),k0=yield E0.get(T_);return yield E0.put(d_,T_),yield p0.done,(!k0||k0.fid!==d_.fid)&&Z1(c_,d_.fid),d_})).apply(this,arguments)}function GT(c_){return dP.apply(this,arguments)}function dP(){return(dP=(0,q.Z)(function*(c_){const d_=_1(c_),K_=(yield KI()).transaction(jR,"readwrite");yield K_.objectStore(jR).delete(d_),yield K_.done})).apply(this,arguments)}function VR(c_,d_){return IS.apply(this,arguments)}function IS(){return(IS=(0,q.Z)(function*(c_,d_){const T_=_1(c_),p0=(yield KI()).transaction(jR,"readwrite"),E0=p0.objectStore(jR),k0=yield E0.get(T_),vI=d_(k0);return void 0===vI?yield E0.delete(T_):yield E0.put(vI,T_),yield p0.done,vI&&(!k0||k0.fid!==vI.fid)&&Z1(c_,vI.fid),vI})).apply(this,arguments)}function JT(c_){return SO.apply(this,arguments)}function SO(){return(SO=(0,q.Z)(function*(c_){let d_;const T_=yield VR(c_.appConfig,K_=>{const p0=_x(K_),E0=M1(c_,p0);return d_=E0.registrationPromise,E0.installationEntry});return""===T_.fid?{installationEntry:yield d_}:{installationEntry:T_,registrationPromise:d_}})).apply(this,arguments)}function _x(c_){return eL(c_||{fid:Y0(),registrationStatus:0})}function M1(c_,d_){if(0===d_.registrationStatus){if(!navigator.onLine)return{installationEntry:d_,registrationPromise:Promise.reject(_0.create("app-offline"))};const T_={fid:d_.fid,registrationStatus:1,registrationTime:Date.now()},K_=function kI(c_,d_){return JI.apply(this,arguments)}(c_,T_);return{installationEntry:T_,registrationPromise:K_}}return 1===d_.registrationStatus?{installationEntry:d_,registrationPromise:gR(c_)}:{installationEntry:d_}}function JI(){return(JI=(0,q.Z)(function*(c_,d_){try{const T_=yield J_(c_,d_);return dO(c_.appConfig,T_)}catch(T_){throw c0(T_)&&409===T_.customData.serverCode?yield GT(c_.appConfig):yield dO(c_.appConfig,{fid:d_.fid,registrationStatus:0}),T_}})).apply(this,arguments)}function gR(c_){return rR.apply(this,arguments)}function rR(){return(rR=(0,q.Z)(function*(c_){let d_=yield D1(c_.appConfig);for(;1===d_.registrationStatus;)yield D0(100),d_=yield D1(c_.appConfig);if(0===d_.registrationStatus){const{installationEntry:T_,registrationPromise:K_}=yield JT(c_);return K_||T_}return d_})).apply(this,arguments)}function D1(c_){return VR(c_,d_=>{if(!d_)throw _0.create("installation-not-found");return eL(d_)})}function eL(c_){return function mR(c_){return 1===c_.registrationStatus&&c_.registrationTime+1e4<Date.now()}(c_)?{fid:c_.fid,registrationStatus:0}:c_}function $T(c_,d_){return $_.apply(this,arguments)}function $_(){return($_=(0,q.Z)(function*({appConfig:c_,heartbeatServiceProvider:d_},T_){const K_=_E(c_,T_),p0=P_(c_,T_),E0=d_.getImmediate({optional:!0});if(E0){const jI=yield E0.getHeartbeatsHeader();jI&&p0.append("x-firebase-client",jI)}const vI={method:"POST",headers:p0,body:JSON.stringify({installation:{sdkVersion:p_,appId:c_.appId}})},SI=yield _v(()=>fetch(K_,vI));if(SI.ok)return h0(yield SI.json());throw yield I0("Generate Auth Token",SI)})).apply(this,arguments)}function _E(c_,{fid:d_}){return`${Pv(c_)}/${d_}/authTokens:generate`}function r0(c_){return M0.apply(this,arguments)}function M0(){return(M0=(0,q.Z)(function*(c_,d_=!1){let T_;const K_=yield VR(c_.appConfig,E0=>{if(!XI(E0))throw _0.create("not-registered");const k0=E0.authToken;if(!d_&&vT(k0))return E0;if(1===k0.requestStatus)return T_=_y(c_,d_),E0;{if(!navigator.onLine)throw _0.create("app-offline");const vI=ZT(E0);return T_=yI(c_,vI),vI}});return T_?yield T_:K_.authToken})).apply(this,arguments)}function _y(c_,d_){return m0.apply(this,arguments)}function m0(){return(m0=(0,q.Z)(function*(c_,d_){let T_=yield G0(c_.appConfig);for(;1===T_.authToken.requestStatus;)yield D0(100),T_=yield G0(c_.appConfig);const K_=T_.authToken;return 0===K_.requestStatus?r0(c_,d_):K_})).apply(this,arguments)}function G0(c_){return VR(c_,d_=>{if(!XI(d_))throw _0.create("not-registered");return function AR(c_){return 1===c_.requestStatus&&c_.requestTime+1e4<Date.now()}(d_.authToken)?Object.assign(Object.assign({},d_),{authToken:{requestStatus:0}}):d_})}function yI(c_,d_){return qI.apply(this,arguments)}function qI(){return(qI=(0,q.Z)(function*(c_,d_){try{const T_=yield $T(c_,d_),K_=Object.assign(Object.assign({},d_),{authToken:T_});return yield dO(c_.appConfig,K_),T_}catch(T_){if(!c0(T_)||401!==T_.customData.serverCode&&404!==T_.customData.serverCode){const K_=Object.assign(Object.assign({},d_),{authToken:{requestStatus:0}});yield dO(c_.appConfig,K_)}else yield GT(c_.appConfig);throw T_}})).apply(this,arguments)}function XI(c_){return void 0!==c_&&2===c_.registrationStatus}function vT(c_){return 2===c_.requestStatus&&!function _b(c_){const d_=Date.now();return d_<c_.creationTime||c_.creationTime+c_.expiresIn<d_+36e5}(c_)}function ZT(c_){const d_={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},c_),{authToken:d_})}function YM(){return(YM=(0,q.Z)(function*(c_){const d_=c_,{installationEntry:T_,registrationPromise:K_}=yield JT(d_);return K_?K_.catch(console.error):r0(d_).catch(console.error),T_.fid})).apply(this,arguments)}function JM(){return(JM=(0,q.Z)(function*(c_,d_=!1){const T_=c_;return yield bS(T_),(yield r0(T_,d_)).token})).apply(this,arguments)}function bS(c_){return X1.apply(this,arguments)}function X1(){return(X1=(0,q.Z)(function*(c_){const{registrationPromise:d_}=yield JT(c_);d_&&(yield d_)})).apply(this,arguments)}function $L(c_){return _0.create("missing-app-config-values",{valueName:c_})}const GR="installations",NI=c_=>{const d_=c_.getProvider("app").getImmediate(),T_=function QS(c_){if(!c_||!c_.options)throw $L("App Configuration");if(!c_.name)throw $L("App Name");const d_=["projectId","apiKey","appId"];for(const T_ of d_)if(!c_.options[T_])throw $L(T_);return{appName:c_.name,projectId:c_.options.projectId,apiKey:c_.options.apiKey,appId:c_.options.appId}}(d_);return{app:d_,appConfig:T_,heartbeatServiceProvider:(0,_r._getProvider)(d_,"heartbeat"),_delete:()=>Promise.resolve()}},B1=c_=>{const d_=c_.getProvider("app").getImmediate(),T_=(0,_r._getProvider)(d_,GR).getImmediate();return{getId:()=>function g3(c_){return YM.apply(this,arguments)}(T_),getToken:p0=>function ON(c_){return JM.apply(this,arguments)}(T_,p0)}};(function QR(){(0,_r._registerComponent)(new ga.wA(GR,NI,"PUBLIC")),(0,_r._registerComponent)(new ga.wA("installations-internal",B1,"PRIVATE"))})(),(0,_r.registerVersion)(n_,"0.5.9"),(0,_r.registerVersion)(n_,"0.5.9","esm2017");const DN="@firebase/remote-config",XT=new _s.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class _9{constructor(d_,T_,K_,p0){this.client=d_,this.storage=T_,this.storageCache=K_,this.logger=p0}isCachedDataFresh(d_,T_){if(!T_)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const K_=Date.now()-T_,p0=K_<=d_;return this.logger.debug(`Config fetch cache check. Cache age millis: ${K_}. Cache max age millis (minimumFetchIntervalMillis setting): ${d_}. Is cache hit: ${p0}.`),p0}fetch(d_){var T_=this;return(0,q.Z)(function*(){const[K_,p0]=yield Promise.all([T_.storage.getLastSuccessfulFetchTimestampMillis(),T_.storage.getLastSuccessfulFetchResponse()]);if(p0&&T_.isCachedDataFresh(d_.cacheMaxAgeMillis,K_))return p0;d_.eTag=p0&&p0.eTag;const E0=yield T_.client.fetch(d_),k0=[T_.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===E0.status&&k0.push(T_.storage.setLastSuccessfulFetchResponse(E0)),yield Promise.all(k0),E0})()}}function eV(c_=navigator){return c_.languages&&c_.languages[0]||c_.language}class iR{constructor(d_,T_,K_,p0,E0,k0){this.firebaseInstallations=d_,this.sdkVersion=T_,this.namespace=K_,this.projectId=p0,this.apiKey=E0,this.appId=k0}fetch(d_){var T_=this;return(0,q.Z)(function*(){const[K_,p0]=yield Promise.all([T_.firebaseInstallations.getId(),T_.firebaseInstallations.getToken()]),k0=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${T_.projectId}/namespaces/${T_.namespace}:fetch?key=${T_.apiKey}`,vI={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":d_.eTag||"*"},SI={sdk_version:T_.sdkVersion,app_instance_id:K_,app_instance_id_token:p0,app_id:T_.appId,language_code:eV()},jI={method:"POST",headers:vI,body:JSON.stringify(SI)},Q1=fetch(k0,jI),t1=new Promise((cR,k2)=>{d_.signal.addEventListener(()=>{const P2=new Error("The operation was aborted.");P2.name="AbortError",k2(P2)})});let dS;try{yield Promise.race([Q1,t1]),dS=yield Q1}catch(cR){let k2="fetch-client-network";throw"AbortError"===cR.name&&(k2="fetch-timeout"),XT.create(k2,{originalErrorMessage:cR.message})}let NS=dS.status;const QN=dS.headers.get("ETag")||void 0;let rN,zR;if(200===dS.status){let cR;try{cR=yield dS.json()}catch(k2){throw XT.create("fetch-client-parse",{originalErrorMessage:k2.message})}rN=cR.entries,zR=cR.state}if("INSTANCE_STATE_UNSPECIFIED"===zR?NS=500:"NO_CHANGE"===zR?NS=304:("NO_TEMPLATE"===zR||"EMPTY_CONFIG"===zR)&&(rN={}),304!==NS&&200!==NS)throw XT.create("fetch-status",{httpStatus:NS});return{status:NS,eTag:QN,config:rN}})()}}class yG{constructor(d_,T_){this.client=d_,this.storage=T_}fetch(d_){var T_=this;return(0,q.Z)(function*(){const K_=(yield T_.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return T_.attemptFetch(d_,K_)})()}attemptFetch(d_,{throttleEndTimeMillis:T_,backoffCount:K_}){var p0=this;return(0,q.Z)(function*(){yield function yT(c_,d_){return new Promise((T_,K_)=>{const p0=Math.max(d_-Date.now(),0),E0=setTimeout(T_,p0);c_.addEventListener(()=>{clearTimeout(E0),K_(XT.create("fetch-throttle",{throttleEndTimeMillis:d_}))})})}(d_.signal,T_);try{const E0=yield p0.client.fetch(d_);return yield p0.storage.deleteThrottleMetadata(),E0}catch(E0){if(!function _j(c_){if(!(c_ instanceof _s.ZR&&c_.customData))return!1;const d_=Number(c_.customData.httpStatus);return 429===d_||500===d_||503===d_||504===d_}(E0))throw E0;const k0={throttleEndTimeMillis:Date.now()+(0,_s.$s)(K_),backoffCount:K_+1};return yield p0.storage.setThrottleMetadata(k0),p0.attemptFetch(d_,k0)}})()}}class tV{constructor(d_,T_,K_,p0,E0){this.app=d_,this._client=T_,this._storageCache=K_,this._storage=p0,this._logger=E0,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function wS(c_,d_){const T_=c_.target.error||void 0;return XT.create(d_,{originalErrorMessage:T_&&T_.message})}const gP="app_namespace_store";class EG{constructor(d_,T_,K_,p0=function XM(){return new Promise((c_,d_)=>{try{const T_=indexedDB.open("firebase_remote_config",1);T_.onerror=K_=>{d_(wS(K_,"storage-open"))},T_.onsuccess=K_=>{c_(K_.target.result)},T_.onupgradeneeded=K_=>{0===K_.oldVersion&&K_.target.result.createObjectStore(gP,{keyPath:"compositeKey"})}}catch(T_){d_(XT.create("storage-open",{originalErrorMessage:T_}))}})}()){this.appId=d_,this.appName=T_,this.namespace=K_,this.openDbPromise=p0}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(d_){return this.set("last_fetch_status",d_)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(d_){return this.set("last_successful_fetch_timestamp_millis",d_)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(d_){return this.set("last_successful_fetch_response",d_)}getActiveConfig(){return this.get("active_config")}setActiveConfig(d_){return this.set("active_config",d_)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(d_){return this.set("active_config_etag",d_)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(d_){return this.set("throttle_metadata",d_)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(d_){var T_=this;return(0,q.Z)(function*(){const K_=yield T_.openDbPromise;return new Promise((p0,E0)=>{const vI=K_.transaction([gP],"readonly").objectStore(gP),SI=T_.createCompositeKey(d_);try{const jI=vI.get(SI);jI.onerror=Q1=>{E0(wS(Q1,"storage-get"))},jI.onsuccess=Q1=>{const t1=Q1.target.result;p0(t1?t1.value:void 0)}}catch(jI){E0(XT.create("storage-get",{originalErrorMessage:jI&&jI.message}))}})})()}set(d_,T_){var K_=this;return(0,q.Z)(function*(){const p0=yield K_.openDbPromise;return new Promise((E0,k0)=>{const SI=p0.transaction([gP],"readwrite").objectStore(gP),jI=K_.createCompositeKey(d_);try{const Q1=SI.put({compositeKey:jI,value:T_});Q1.onerror=t1=>{k0(wS(t1,"storage-set"))},Q1.onsuccess=()=>{E0()}}catch(Q1){k0(XT.create("storage-set",{originalErrorMessage:Q1&&Q1.message}))}})})()}delete(d_){var T_=this;return(0,q.Z)(function*(){const K_=yield T_.openDbPromise;return new Promise((p0,E0)=>{const vI=K_.transaction([gP],"readwrite").objectStore(gP),SI=T_.createCompositeKey(d_);try{const jI=vI.delete(SI);jI.onerror=Q1=>{E0(wS(Q1,"storage-delete"))},jI.onsuccess=()=>{p0()}}catch(jI){E0(XT.create("storage-delete",{originalErrorMessage:jI&&jI.message}))}})})()}createCompositeKey(d_){return[this.appId,this.appName,this.namespace,d_].join()}}class rV{constructor(d_){this.storage=d_}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var d_=this;return(0,q.Z)(function*(){const T_=d_.storage.getLastFetchStatus(),K_=d_.storage.getLastSuccessfulFetchTimestampMillis(),p0=d_.storage.getActiveConfig(),E0=yield T_;E0&&(d_.lastFetchStatus=E0);const k0=yield K_;k0&&(d_.lastSuccessfulFetchTimestampMillis=k0);const vI=yield p0;vI&&(d_.activeConfig=vI)})()}setLastFetchStatus(d_){return this.lastFetchStatus=d_,this.storage.setLastFetchStatus(d_)}setLastSuccessfulFetchTimestampMillis(d_){return this.lastSuccessfulFetchTimestampMillis=d_,this.storage.setLastSuccessfulFetchTimestampMillis(d_)}setActiveConfig(d_){return this.activeConfig=d_,this.storage.setActiveConfig(d_)}}function _3(){return iV.apply(this,arguments)}function iV(){return(iV=(0,q.Z)(function*(){if(!(0,_s.hl)())return!1;try{return yield(0,_s.eu)()}catch(c_){return!1}})).apply(this,arguments)}!function mP(){(0,_r._registerComponent)(new ga.wA("remote-config",function c_(d_,{instanceIdentifier:T_}){const K_=d_.getProvider("app").getImmediate(),p0=d_.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw XT.create("registration-window");if(!(0,_s.hl)())throw XT.create("indexed-db-unavailable");const{projectId:E0,apiKey:k0,appId:vI}=K_.options;if(!E0)throw XT.create("registration-project-id");if(!k0)throw XT.create("registration-api-key");if(!vI)throw XT.create("registration-app-id");const SI=new EG(vI,K_.name,T_=T_||"firebase"),jI=new rV(SI),Q1=new _l.Yd(DN);Q1.logLevel=_l.in.ERROR;const t1=new iR(p0,_r.SDK_VERSION,T_,E0,k0,vI),dS=new yG(t1,SI),NS=new _9(dS,SI,jI,Q1),QN=new tV(K_,NS,jI,SI,Q1);return function cT(c_){const d_=(0,_s.m9)(c_);d_._initializePromise||(d_._initializePromise=d_._storageCache.loadFromStorage().then(()=>{d_._isInitializationComplete=!0}))}(QN),QN},"PUBLIC").setMultipleInstances(!0)),(0,_r.registerVersion)(DN,"0.3.8"),(0,_r.registerVersion)(DN,"0.3.8","esm2017")}();const oV="/firebase-messaging-sw.js",_R="/firebase-cloud-messaging-push-scope",TS="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",XL="google.c.a.c_id",v3="google.c.a.c_l",CG="google.c.a.ts",nL="google.c.a.e";var v2=(()=>{return(c_=v2||(v2={})).PUSH_RECEIVED="push-received",c_.NOTIFICATION_CLICKED="notification-clicked",v2;var c_})();function qS(c_){const d_=new Uint8Array(c_);return btoa(String.fromCharCode(...d_)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function sV(c_){const T_=(c_+"=".repeat((4-c_.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),K_=atob(T_),p0=new Uint8Array(K_.length);for(let E0=0;E0<K_.length;++E0)p0[E0]=K_.charCodeAt(E0);return p0}const qR="fcm_token_details_db",OO="fcm_token_object_Store";function kj(c_){return aV.apply(this,arguments)}function aV(){return aV=(0,q.Z)(function*(c_){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(E0=>E0.name).includes(qR))return null;let d_=null;return(yield(0,bh.X3)(qR,5,{upgrade:(K_=(0,q.Z)(function*(p0,E0,k0,vI){var SI;if(E0<2||!p0.objectStoreNames.contains(OO))return;const jI=vI.objectStore(OO),Q1=yield jI.index("fcmSenderId").get(c_);if(yield jI.clear(),Q1)if(2===E0){const t1=Q1;if(!t1.auth||!t1.p256dh||!t1.endpoint)return;d_={token:t1.fcmToken,createTime:null!==(SI=t1.createTime)&&void 0!==SI?SI:Date.now(),subscriptionOptions:{auth:t1.auth,p256dh:t1.p256dh,endpoint:t1.endpoint,swScope:t1.swScope,vapidKey:"string"==typeof t1.vapidKey?t1.vapidKey:qS(t1.vapidKey)}}}else if(3===E0){const t1=Q1;d_={token:t1.fcmToken,createTime:t1.createTime,subscriptionOptions:{auth:qS(t1.auth),p256dh:qS(t1.p256dh),endpoint:t1.endpoint,swScope:t1.swScope,vapidKey:qS(t1.vapidKey)}}}else if(4===E0){const t1=Q1;d_={token:t1.fcmToken,createTime:t1.createTime,subscriptionOptions:{auth:qS(t1.auth),p256dh:qS(t1.p256dh),endpoint:t1.endpoint,swScope:t1.swScope,vapidKey:qS(t1.vapidKey)}}}}),function(E0,k0,vI,SI){return K_.apply(this,arguments)})})).close(),yield(0,bh.Lj)(qR),yield(0,bh.Lj)("fcm_vapid_details_db"),yield(0,bh.Lj)("undefined"),y3(d_)?d_:null;var K_}),aV.apply(this,arguments)}function y3(c_){if(!c_||!c_.subscriptionOptions)return!1;const{subscriptionOptions:d_}=c_;return"number"==typeof c_.createTime&&c_.createTime>0&&"string"==typeof c_.token&&c_.token.length>0&&"string"==typeof d_.auth&&d_.auth.length>0&&"string"==typeof d_.p256dh&&d_.p256dh.length>0&&"string"==typeof d_.endpoint&&d_.endpoint.length>0&&"string"==typeof d_.swScope&&d_.swScope.length>0&&"string"==typeof d_.vapidKey&&d_.vapidKey.length>0}const MN="firebase-messaging-store";let cV=null;function nT(){return cV||(cV=(0,bh.X3)("firebase-messaging-database",1,{upgrade:(c_,d_)=>{0===d_&&c_.createObjectStore(MN)}})),cV}function tU(c_){return iL.apply(this,arguments)}function iL(){return(iL=(0,q.Z)(function*(c_){const d_=WS(c_),K_=yield(yield nT()).transaction(MN).objectStore(MN).get(d_);if(K_)return K_;{const p0=yield kj(c_.appConfig.senderId);if(p0)return yield K1(c_,p0),p0}})).apply(this,arguments)}function K1(c_,d_){return oL.apply(this,arguments)}function oL(){return(oL=(0,q.Z)(function*(c_,d_){const T_=WS(c_),p0=(yield nT()).transaction(MN,"readwrite");return yield p0.objectStore(MN).put(d_,T_),yield p0.done,d_})).apply(this,arguments)}function E3(c_){return _P.apply(this,arguments)}function _P(){return(_P=(0,q.Z)(function*(c_){const d_=WS(c_),K_=(yield nT()).transaction(MN,"readwrite");yield K_.objectStore(MN).delete(d_),yield K_.done})).apply(this,arguments)}function WS({appConfig:c_}){return c_.appId}const kT=new _s.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function oR(c_,d_){return sR.apply(this,arguments)}function sR(){return(sR=(0,q.Z)(function*(c_,d_){const T_=yield eM(c_),K_=yP(d_),p0={method:"POST",headers:T_,body:JSON.stringify(K_)};let E0;try{E0=yield(yield fetch(DO(c_.appConfig),p0)).json()}catch(k0){throw kT.create("token-subscribe-failed",{errorInfo:k0})}if(E0.error)throw kT.create("token-subscribe-failed",{errorInfo:E0.error.message});if(!E0.token)throw kT.create("token-subscribe-no-token");return E0.token})).apply(this,arguments)}function vP(c_,d_){return y2.apply(this,arguments)}function y2(){return(y2=(0,q.Z)(function*(c_,d_){const T_=yield eM(c_),K_=yP(d_.subscriptionOptions),p0={method:"PATCH",headers:T_,body:JSON.stringify(K_)};let E0;try{E0=yield(yield fetch(`${DO(c_.appConfig)}/${d_.token}`,p0)).json()}catch(k0){throw kT.create("token-update-failed",{errorInfo:k0})}if(E0.error)throw kT.create("token-update-failed",{errorInfo:E0.error.message});if(!E0.token)throw kT.create("token-update-no-token");return E0.token})).apply(this,arguments)}function BN(c_,d_){return PT.apply(this,arguments)}function PT(){return(PT=(0,q.Z)(function*(c_,d_){const K_={method:"DELETE",headers:yield eM(c_)};try{const E0=yield(yield fetch(`${DO(c_.appConfig)}/${d_}`,K_)).json();if(E0.error)throw kT.create("token-unsubscribe-failed",{errorInfo:E0.error.message})}catch(p0){throw kT.create("token-unsubscribe-failed",{errorInfo:p0})}})).apply(this,arguments)}function DO({projectId:c_}){return`https://fcmregistrations.googleapis.com/v1/projects/${c_}/registrations`}function eM(c_){return zI.apply(this,arguments)}function zI(){return(zI=(0,q.Z)(function*({appConfig:c_,installations:d_}){const T_=yield d_.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":c_.apiKey,"x-goog-firebase-installations-auth":`FIS ${T_}`})})).apply(this,arguments)}function yP({p256dh:c_,auth:d_,endpoint:T_,vapidKey:K_}){const p0={web:{endpoint:T_,auth:d_,p256dh:c_}};return K_!==TS&&(p0.web.applicationPubKey=K_),p0}const rU=6048e5;function sL(c_){return jj.apply(this,arguments)}function jj(){return(jj=(0,q.Z)(function*(c_){const d_=yield nM(c_.swRegistration,c_.vapidKey),T_={vapidKey:c_.vapidKey,swScope:c_.swRegistration.scope,endpoint:d_.endpoint,auth:qS(d_.getKey("auth")),p256dh:qS(d_.getKey("p256dh"))},K_=yield tU(c_.firebaseDependencies);if(K_){if(C3(K_.subscriptionOptions,T_))return Date.now()>=K_.createTime+rU?b3(c_,{token:K_.token,createTime:Date.now(),subscriptionOptions:T_}):K_.token;try{yield BN(c_.firebaseDependencies,K_.token)}catch(p0){console.warn(p0)}return j0(c_.firebaseDependencies,T_)}return j0(c_.firebaseDependencies,T_)})).apply(this,arguments)}function iU(c_){return I3.apply(this,arguments)}function I3(){return(I3=(0,q.Z)(function*(c_){const d_=yield tU(c_.firebaseDependencies);d_&&(yield BN(c_.firebaseDependencies,d_.token),yield E3(c_.firebaseDependencies));const T_=yield c_.swRegistration.pushManager.getSubscription();return!T_||T_.unsubscribe()})).apply(this,arguments)}function b3(c_,d_){return tM.apply(this,arguments)}function tM(){return(tM=(0,q.Z)(function*(c_,d_){try{const T_=yield vP(c_.firebaseDependencies,d_),K_=Object.assign(Object.assign({},d_),{token:T_,createTime:Date.now()});return yield K1(c_.firebaseDependencies,K_),T_}catch(T_){throw yield iU(c_),T_}})).apply(this,arguments)}function j0(c_,d_){return T1.apply(this,arguments)}function T1(){return(T1=(0,q.Z)(function*(c_,d_){const K_={token:yield oR(c_,d_),createTime:Date.now(),subscriptionOptions:d_};return yield K1(c_,K_),K_.token})).apply(this,arguments)}function nM(c_,d_){return ST.apply(this,arguments)}function ST(){return(ST=(0,q.Z)(function*(c_,d_){return(yield c_.pushManager.getSubscription())||c_.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:sV(d_)})})).apply(this,arguments)}function C3(c_,d_){return d_.vapidKey===c_.vapidKey&&d_.endpoint===c_.endpoint&&d_.auth===c_.auth&&d_.p256dh===c_.p256dh}function _D(c_){const d_={from:c_.from,collapseKey:c_.collapse_key,messageId:c_.fcmMessageId};return function NO(c_,d_){if(!d_.notification)return;c_.notification={};const T_=d_.notification.title;T_&&(c_.notification.title=T_);const K_=d_.notification.body;K_&&(c_.notification.body=K_);const p0=d_.notification.image;p0&&(c_.notification.image=p0)}(d_,c_),function $j(c_,d_){!d_.data||(c_.data=d_.data)}(d_,c_),function UN(c_,d_){if(!d_.fcmOptions)return;c_.fcmOptions={};const T_=d_.fcmOptions.link;T_&&(c_.fcmOptions.link=T_);const K_=d_.fcmOptions.analytics_label;K_&&(c_.fcmOptions.analyticsLabel=K_)}(d_,c_),d_}function e5(c_){return"object"==typeof c_&&!!c_&&XL in c_}function uV(c_,d_){const T_=[];for(let K_=0;K_<c_.length;K_++)T_.push(c_.charAt(K_)),K_<d_.length&&T_.push(d_.charAt(K_));return T_.join("")}function kO(c_){return kT.create("missing-app-config-values",{valueName:c_})}uV("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),uV("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class vR{constructor(d_,T_,K_){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const p0=function E9(c_){if(!c_||!c_.options)throw kO("App Configuration Object");if(!c_.name)throw kO("App Name");const d_=["projectId","apiKey","appId","messagingSenderId"],{options:T_}=c_;for(const K_ of d_)if(!T_[K_])throw kO(K_);return{appName:c_.name,projectId:T_.projectId,apiKey:T_.apiKey,appId:T_.appId,senderId:T_.messagingSenderId}}(d_);this.firebaseDependencies={app:d_,appConfig:p0,installations:T_,analyticsProvider:K_}}_delete(){return Promise.resolve()}}function PO(c_){return E2.apply(this,arguments)}function E2(){return(E2=(0,q.Z)(function*(c_){try{c_.swRegistration=yield navigator.serviceWorker.register(oV,{scope:_R}),c_.swRegistration.update().catch(()=>{})}catch(d_){throw kT.create("failed-service-worker-registration",{browserErrorMessage:d_.message})}})).apply(this,arguments)}function EP(c_,d_){return SS.apply(this,arguments)}function SS(){return(SS=(0,q.Z)(function*(c_,d_){if(!d_&&!c_.swRegistration&&(yield PO(c_)),d_||!c_.swRegistration){if(!(d_ instanceof ServiceWorkerRegistration))throw kT.create("invalid-sw-registration");c_.swRegistration=d_}})).apply(this,arguments)}function t5(c_,d_){return w3.apply(this,arguments)}function w3(){return(w3=(0,q.Z)(function*(c_,d_){d_?c_.vapidKey=d_:c_.vapidKey||(c_.vapidKey=TS)})).apply(this,arguments)}function S3(){return(S3=(0,q.Z)(function*(c_,d_){if(!navigator)throw kT.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw kT.create("permission-blocked");return yield t5(c_,null==d_?void 0:d_.vapidKey),yield EP(c_,null==d_?void 0:d_.serviceWorkerRegistration),sL(c_)})).apply(this,arguments)}function oU(c_,d_,T_){return rM.apply(this,arguments)}function rM(){return(rM=(0,q.Z)(function*(c_,d_,T_){const K_=R3(d_);(yield c_.firebaseDependencies.analyticsProvider.get()).logEvent(K_,{message_id:T_[XL],message_name:T_[v3],message_time:T_[CG],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function R3(c_){switch(c_){case v2.NOTIFICATION_CLICKED:return"notification_open";case v2.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function dV(){return(dV=(0,q.Z)(function*(c_,d_){const T_=d_.data;if(!T_.isFirebaseMessaging)return;c_.onMessageHandler&&T_.messageType===v2.PUSH_RECEIVED&&("function"==typeof c_.onMessageHandler?c_.onMessageHandler(_D(T_)):c_.onMessageHandler.next(_D(T_)));const K_=T_.data;e5(K_)&&"1"===K_[nL]&&(yield oU(c_,T_.messageType,K_))})).apply(this,arguments)}const sU="@firebase/messaging",O3=c_=>{const d_=new vR(c_.getProvider("app").getImmediate(),c_.getProvider("installations-internal").getImmediate(),c_.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",T_=>function lV(c_,d_){return dV.apply(this,arguments)}(d_,T_)),d_},iM=c_=>{const d_=c_.getProvider("messaging").getImmediate();return{getToken:K_=>function T3(c_,d_){return S3.apply(this,arguments)}(d_,K_)}};function aU(){return fO.apply(this,arguments)}function fO(){return(fO=(0,q.Z)(function*(){try{yield(0,_s.eu)()}catch(c_){return!1}return"undefined"!=typeof window&&(0,_s.hl)()&&(0,_s.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function hV(){(0,_r._registerComponent)(new ga.wA("messaging",O3,"PUBLIC")),(0,_r._registerComponent)(new ga.wA("messaging-internal",iM,"PRIVATE")),(0,_r.registerVersion)(sU,"0.9.13"),(0,_r.registerVersion)(sU,"0.9.13","esm2017")}();const fV="analytics",pV="firebase_id",I2="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",eN="https://www.googletagmanager.com/gtag/js",RS=new _l.Yd("@firebase/analytics");function gV(c_){return Promise.all(c_.map(d_=>d_.catch(T_=>T_)))}function b9(c_,d_){const T_=document.createElement("script");T_.src=`${eN}?l=${c_}&id=${d_}`,T_.async=!0,document.head.appendChild(T_)}function bP(c_,d_,T_,K_,p0,E0){return oM.apply(this,arguments)}function oM(){return(oM=(0,q.Z)(function*(c_,d_,T_,K_,p0,E0){const k0=K_[p0];try{if(k0)yield d_[k0];else{const SI=(yield gV(T_)).find(jI=>jI.measurementId===p0);SI&&(yield d_[SI.appId])}}catch(vI){RS.error(vI)}c_("config",p0,E0)})).apply(this,arguments)}function mV(c_,d_,T_,K_,p0){return FN.apply(this,arguments)}function FN(){return(FN=(0,q.Z)(function*(c_,d_,T_,K_,p0){try{let E0=[];if(p0&&p0.send_to){let k0=p0.send_to;Array.isArray(k0)||(k0=[k0]);const vI=yield gV(T_);for(const SI of k0){const jI=vI.find(t1=>t1.measurementId===SI),Q1=jI&&d_[jI.appId];if(!Q1){E0=[];break}E0.push(Q1)}}0===E0.length&&(E0=Object.values(d_)),yield Promise.all(E0),c_("event",K_,p0||{})}catch(E0){RS.error(E0)}})).apply(this,arguments)}function uT(){const c_=window.document.getElementsByTagName("script");for(const d_ of Object.values(c_))if(d_.src&&d_.src.includes(eN))return d_;return null}const hI=new _s.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),aM=new class LT{constructor(d_={},T_=1e3){this.throttleMetadata=d_,this.intervalMillis=T_}getThrottleMetadata(d_){return this.throttleMetadata[d_]}setThrottleMetadata(d_,T_){this.throttleMetadata[d_]=T_}deleteThrottleMetadata(d_){delete this.throttleMetadata[d_]}};function AV(c_){return new Headers({Accept:"application/json","x-goog-api-key":c_})}function cM(c_){return CP.apply(this,arguments)}function CP(){return(CP=(0,q.Z)(function*(c_){var d_;const{appId:T_,apiKey:K_}=c_,p0={method:"GET",headers:AV(K_)},E0=I2.replace("{app-id}",T_),k0=yield fetch(E0,p0);if(200!==k0.status&&304!==k0.status){let vI="";try{const SI=yield k0.json();(null===(d_=SI.error)||void 0===d_?void 0:d_.message)&&(vI=SI.error.message)}catch(SI){}throw hI.create("config-fetch-failed",{httpStatus:k0.status,responseMessage:vI})}return k0.json()})).apply(this,arguments)}function tS(c_){return wP.apply(this,arguments)}function wP(){return(wP=(0,q.Z)(function*(c_,d_=aM,T_){const{appId:K_,apiKey:p0,measurementId:E0}=c_.options;if(!K_)throw hI.create("no-app-id");if(!p0){if(E0)return{measurementId:E0,appId:K_};throw hI.create("no-api-key")}const k0=d_.getThrottleMetadata(K_)||{backoffCount:0,throttleEndTimeMillis:Date.now()},vI=new D3;return setTimeout((0,q.Z)(function*(){vI.abort()}),void 0!==T_?T_:6e4),tN({appId:K_,apiKey:p0,measurementId:E0},k0,vI,d_)})).apply(this,arguments)}function tN(c_,d_,T_){return RI.apply(this,arguments)}function RI(){return(RI=(0,q.Z)(function*(c_,{throttleEndTimeMillis:d_,backoffCount:T_},K_,p0=aM){const{appId:E0,measurementId:k0}=c_;try{yield _V(K_,d_)}catch(vI){if(k0)return RS.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${k0} provided in the "measurementId" field in the local Firebase config. [${vI.message}]`),{appId:E0,measurementId:k0};throw vI}try{const vI=yield cM(c_);return p0.deleteThrottleMetadata(E0),vI}catch(vI){if(!vV(vI)){if(p0.deleteThrottleMetadata(E0),k0)return RS.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${k0} provided in the "measurementId" field in the local Firebase config. [${vI.message}]`),{appId:E0,measurementId:k0};throw vI}const SI=503===Number(vI.customData.httpStatus)?(0,_s.$s)(T_,p0.intervalMillis,30):(0,_s.$s)(T_,p0.intervalMillis),jI={throttleEndTimeMillis:Date.now()+SI,backoffCount:T_+1};return p0.setThrottleMetadata(E0,jI),RS.debug(`Calling attemptFetch again in ${SI} millis`),tN(c_,jI,K_,p0)}})).apply(this,arguments)}function _V(c_,d_){return new Promise((T_,K_)=>{const p0=Math.max(d_-Date.now(),0),E0=setTimeout(T_,p0);c_.addEventListener(()=>{clearTimeout(E0),K_(hI.create("fetch-throttle",{throttleEndTimeMillis:d_}))})})}function vV(c_){if(!(c_ instanceof _s.ZR&&c_.customData))return!1;const d_=Number(c_.customData.httpStatus);return 429===d_||500===d_||503===d_||504===d_}class D3{constructor(){this.listeners=[]}addEventListener(d_){this.listeners.push(d_)}abort(){this.listeners.forEach(d_=>d_())}}function uL(){return nS.apply(this,arguments)}function nS(){return(nS=(0,q.Z)(function*(){if(!(0,_s.hl)())return RS.warn(hI.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,_s.eu)()}catch(c_){return RS.warn(hI.create("indexeddb-unavailable",{errorInfo:c_}).message),!1}return!0})).apply(this,arguments)}function uM(){return(uM=(0,q.Z)(function*(c_,d_,T_,K_,p0,E0,k0){var vI;const SI=tS(c_);SI.then(NS=>{T_[NS.measurementId]=NS.appId,c_.options.measurementId&&NS.measurementId!==c_.options.measurementId&&RS.warn(`The measurement ID in the local Firebase config (${c_.options.measurementId}) does not match the measurement ID fetched from the server (${NS.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(NS=>RS.error(NS)),d_.push(SI);const jI=uL().then(NS=>{if(NS)return K_.getId()}),[Q1,t1]=yield Promise.all([SI,jI]);uT()||b9(E0,Q1.measurementId),p0("js",new Date);const dS=null!==(vI=null==k0?void 0:k0.config)&&void 0!==vI?vI:{};return dS.origin="firebase",dS.update=!0,null!=t1&&(dS[pV]=t1),p0("config",Q1.measurementId,dS),Q1.measurementId})).apply(this,arguments)}class SP{constructor(d_){this.app=d_}_delete(){return delete uS[this.app.options.appId],Promise.resolve()}}let uS={},lL=[];const RP={};let lM,DP,jN="dataLayer",VN=!1;function b2(c_,d_,T_){!function lU(){const c_=[];if((0,_s.ru)()&&c_.push("This is a browser extension environment."),(0,_s.zI)()||c_.push("Cookies are not available."),c_.length>0){const d_=c_.map((K_,p0)=>`(${p0+1}) ${K_}`).join(" "),T_=hI.create("invalid-analytics-context",{errorInfo:d_});RS.warn(T_.message)}}();const K_=c_.options.appId;if(!K_)throw hI.create("no-app-id");if(!c_.options.apiKey){if(!c_.options.measurementId)throw hI.create("no-api-key");RS.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${c_.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=uS[K_])throw hI.create("already-exists",{id:K_});if(!VN){!function cL(c_){let d_=[];Array.isArray(window[c_])?d_=window[c_]:window[c_]=d_}(jN);const{wrappedGtag:E0,gtagCore:k0}=function C9(c_,d_,T_,K_,p0){let E0=function(...k0){window[K_].push(arguments)};return window[p0]&&"function"==typeof window[p0]&&(E0=window[p0]),window[p0]=function uU(c_,d_,T_,K_){function E0(){return(E0=(0,q.Z)(function*(k0,vI,SI){try{"event"===k0?yield mV(c_,d_,T_,vI,SI):"config"===k0?yield bP(c_,d_,T_,K_,vI,SI):c_("set",vI)}catch(jI){RS.error(jI)}})).apply(this,arguments)}return function p0(k0,vI,SI){return E0.apply(this,arguments)}}(E0,c_,d_,T_),{gtagCore:E0,wrappedGtag:window[p0]}}(uS,lL,RP,jN,"gtag");DP=E0,lM=k0,VN=!0}return uS[K_]=function TP(c_,d_,T_,K_,p0,E0,k0){return uM.apply(this,arguments)}(c_,lL,RP,d_,lM,jN,T_),new SP(c_)}function rS(){return(rS=(0,q.Z)(function*(c_,d_,T_,K_,p0){if(p0&&p0.global)c_("event",T_,K_);else{const E0=yield d_;c_("event",T_,Object.assign(Object.assign({},K_),{send_to:E0}))}})).apply(this,arguments)}function LO(){return k3.apply(this,arguments)}function k3(){return(k3=(0,q.Z)(function*(){if((0,_s.ru)()||!(0,_s.zI)()||!(0,_s.hl)())return!1;try{return yield(0,_s.eu)()}catch(c_){return!1}})).apply(this,arguments)}const pO="@firebase/analytics";!function PP(){(0,_r._registerComponent)(new ga.wA(fV,(d_,{options:T_})=>b2(d_.getProvider("app").getImmediate(),d_.getProvider("installations-internal").getImmediate(),T_),"PUBLIC")),(0,_r._registerComponent)(new ga.wA("analytics-internal",function c_(d_){try{const T_=d_.getProvider(fV).getImmediate();return{logEvent:(K_,p0,E0)=>function dM(c_,d_,T_,K_){c_=(0,_s.m9)(c_),function dL(c_,d_,T_,K_,p0){return rS.apply(this,arguments)}(DP,uS[c_.app.options.appId],d_,T_,K_).catch(p0=>RS.error(p0))}(T_,K_,p0,E0)}}catch(T_){throw hI.create("interop-component-reg-failed",{reason:T_})}},"PRIVATE")),(0,_r.registerVersion)(pO,"0.7.9"),(0,_r.registerVersion)(pO,"0.7.9","esm2017")}();var o5=g(4408),P3=g(7565);const dU=new class lS extends P3.v{}(class w2 extends o5.o{constructor(d_,T_){super(d_,T_),this.scheduler=d_,this.work=T_}schedule(d_,T_=0){return T_>0?super.schedule(d_,T_):(this.delay=T_,this.state=d_,this.scheduler.flush(this),this)}execute(d_,T_){return T_>0||this.closed?super.execute(d_,T_):this._execute(d_,T_)}requestAsyncId(d_,T_,K_=0){return null!=K_&&K_>0||null==K_&&this.delay>0?super.requestAsyncId(d_,T_,K_):d_.flush(this)}});var EV=g(4986),SG=g(8505),yR=g(5363),KR=g(9468);const hM=new f.GfV("7.3.0"),fM="__angularfire_symbol__analyticsIsSupportedValue",T2="__angularfire_symbol__analyticsIsSupported",S2="__angularfire_symbol__remoteConfigIsSupportedValue",R2="__angularfire_symbol__remoteConfigIsSupported",O2="__angularfire_symbol__messagingIsSupportedValue",v1="__angularfire_symbol__messagingIsSupported";function pL(c_,d_,T_){if(d_){if(1===d_.length)return d_[0];const E0=d_.filter(k0=>k0.app===T_);if(1===E0.length)return E0[0]}return T_.container.getProvider(c_).getImmediate({optional:!0})}globalThis[T2]||(globalThis[T2]=LO().then(c_=>globalThis[fM]=c_).catch(()=>globalThis[fM]=!1)),globalThis[v1]||(globalThis[v1]=aU().then(c_=>globalThis[O2]=c_).catch(()=>globalThis[O2]=!1)),globalThis[R2]||(globalThis[R2]=_3().then(c_=>globalThis[S2]=c_).catch(()=>globalThis[S2]=!1));const w9=(c_,d_)=>{const T_=d_?[d_]:(0,k.C6)(),K_=[];return T_.forEach(p0=>{p0.container.getProvider(c_).instances.forEach(k0=>{K_.includes(k0)||K_.push(k0)})}),K_};function D2(){}class MO{constructor(d_,T_=dU){this.zone=d_,this.delegate=T_}now(){return this.delegate.now()}schedule(d_,T_,K_){const p0=this.zone;return this.delegate.schedule(function(k0){p0.runGuarded(()=>{d_.apply(this,[k0])})},T_,K_)}}class L3{constructor(d_){this.zone=d_,this.task=null}call(d_,T_){const K_=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",D2,{},D2,D2)),T_.pipe((0,SG.b)({next:K_,complete:K_,error:K_})).subscribe(d_).add(K_)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let IV=(()=>{class c_{constructor(T_){this.ngZone=T_,this.outsideAngular=T_.runOutsideAngular(()=>new MO(Zone.current)),this.insideAngular=T_.run(()=>new MO(Zone.current,EV.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return c_.\u0275fac=function(T_){return new(T_||c_)(f.LFG(f.R0b))},c_.\u0275prov=f.Yz7({token:c_,factory:c_.\u0275fac,providedIn:"root"}),c_})();function nN(){const c_=globalThis.\u0275AngularFireScheduler;if(!c_)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return c_}function DS(c_){return c_.pipe((0,yR.Q)(nN().outsideAngular))}function RG(c_){return nN(),function BO(c_){return function(T_){return(T_=T_.lift(new L3(c_.ngZone))).pipe((0,KR.R)(c_.outsideAngular),(0,yR.Q)(c_.insideAngular))}}(nN())(c_)}},2090:(h,l,g)=>{"use strict";g.d(l,{$s:()=>D1,BH:()=>I_,DV:()=>L1,Dv:()=>dP,G6:()=>e0,GJ:()=>Z1,L:()=>bh,LL:()=>Y_,Mn:()=>I0,Pz:()=>eI,Sg:()=>v_,UG:()=>B_,UI:()=>SN,US:()=>ga,Wj:()=>JT,Yr:()=>G_,ZB:()=>r_,ZR:()=>J_,b$:()=>c0,cI:()=>EI,d:()=>Pv,dS:()=>_x,eu:()=>_v,g5:()=>q,gK:()=>VR,gQ:()=>jR,h$:()=>_l,hl:()=>P_,hu:()=>k,jU:()=>V_,lb:()=>SO,m9:()=>$T,ne:()=>ZO,p$:()=>_A,pd:()=>RN,r3:()=>sT,ru:()=>_0,tV:()=>n_,uI:()=>x_,ug:()=>M1,vZ:()=>_T,w1:()=>h0,w9:()=>UI,xO:()=>YT,xb:()=>w1,z$:()=>S_,zI:()=>E_,zd:()=>$O});const k=function($_,_E){if(!$_)throw q(_E)},q=function($_){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+$_)},_r=function($_){const _E=[];let r0=0;for(let M0=0;M0<$_.length;M0++){let _y=$_.charCodeAt(M0);_y<128?_E[r0++]=_y:_y<2048?(_E[r0++]=_y>>6|192,_E[r0++]=63&_y|128):55296==(64512&_y)&&M0+1<$_.length&&56320==(64512&$_.charCodeAt(M0+1))?(_y=65536+((1023&_y)<<10)+(1023&$_.charCodeAt(++M0)),_E[r0++]=_y>>18|240,_E[r0++]=_y>>12&63|128,_E[r0++]=_y>>6&63|128,_E[r0++]=63&_y|128):(_E[r0++]=_y>>12|224,_E[r0++]=_y>>6&63|128,_E[r0++]=63&_y|128)}return _E},ga={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray($_,_E){if(!Array.isArray($_))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r0=_E?this.byteToCharMapWebSafe_:this.byteToCharMap_,M0=[];for(let _y=0;_y<$_.length;_y+=3){const m0=$_[_y],G0=_y+1<$_.length,yI=G0?$_[_y+1]:0,qI=_y+2<$_.length,XI=qI?$_[_y+2]:0;let ZT=(15&yI)<<2|XI>>6,AR=63&XI;qI||(AR=64,G0||(ZT=64)),M0.push(r0[m0>>2],r0[(3&m0)<<4|yI>>4],r0[ZT],r0[AR])}return M0.join("")},encodeString($_,_E){return this.HAS_NATIVE_SUPPORT&&!_E?btoa($_):this.encodeByteArray(_r($_),_E)},decodeString($_,_E){return this.HAS_NATIVE_SUPPORT&&!_E?atob($_):function($_){const _E=[];let r0=0,M0=0;for(;r0<$_.length;){const _y=$_[r0++];if(_y<128)_E[M0++]=String.fromCharCode(_y);else if(_y>191&&_y<224){const m0=$_[r0++];_E[M0++]=String.fromCharCode((31&_y)<<6|63&m0)}else if(_y>239&&_y<365){const qI=((7&_y)<<18|(63&$_[r0++])<<12|(63&$_[r0++])<<6|63&$_[r0++])-65536;_E[M0++]=String.fromCharCode(55296+(qI>>10)),_E[M0++]=String.fromCharCode(56320+(1023&qI))}else{const m0=$_[r0++],G0=$_[r0++];_E[M0++]=String.fromCharCode((15&_y)<<12|(63&m0)<<6|63&G0)}}return _E.join("")}(this.decodeStringToByteArray($_,_E))},decodeStringToByteArray($_,_E){this.init_();const r0=_E?this.charToByteMapWebSafe_:this.charToByteMap_,M0=[];for(let _y=0;_y<$_.length;){const m0=r0[$_.charAt(_y++)],yI=_y<$_.length?r0[$_.charAt(_y)]:0;++_y;const XI=_y<$_.length?r0[$_.charAt(_y)]:64;++_y;const _b=_y<$_.length?r0[$_.charAt(_y)]:64;if(++_y,null==m0||null==yI||null==XI||null==_b)throw Error();M0.push(m0<<2|yI>>4),64!==XI&&(M0.push(yI<<4&240|XI>>2),64!==_b&&M0.push(XI<<6&192|_b))}return M0},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let $_=0;$_<this.ENCODED_VALS.length;$_++)this.byteToCharMap_[$_]=this.ENCODED_VALS.charAt($_),this.charToByteMap_[this.byteToCharMap_[$_]]=$_,this.byteToCharMapWebSafe_[$_]=this.ENCODED_VALS_WEBSAFE.charAt($_),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[$_]]=$_,$_>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt($_)]=$_,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt($_)]=$_)}}},_l=function($_){const _E=_r($_);return ga.encodeByteArray(_E,!0)},bh=function($_){return _l($_).replace(/\./g,"")},n_=function($_){try{return ga.decodeString($_,!0)}catch(_E){console.error("base64Decode failed: ",_E)}return null};function _A($_){return r_(void 0,$_)}function r_($_,_E){if(!(_E instanceof Object))return _E;switch(_E.constructor){case Date:return new Date(_E.getTime());case Object:void 0===$_&&($_={});break;case Array:$_=[];break;default:return _E}for(const r0 in _E)!_E.hasOwnProperty(r0)||!p_(r0)||($_[r0]=r_($_[r0],_E[r0]));return $_}function p_($_){return"__proto__"!==$_}class I_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((_E,r0)=>{this.resolve=_E,this.reject=r0})}wrapCallback(_E){return(r0,M0)=>{r0?this.reject(r0):this.resolve(M0),"function"==typeof _E&&(this.promise.catch(()=>{}),1===_E.length?_E(r0):_E(r0,M0))}}}function v_($_,_E){if($_.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const M0=_E||"demo-project",_y=$_.iat||0,m0=$_.sub||$_.user_id;if(!m0)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const G0=Object.assign({iss:`https://securetoken.google.com/${M0}`,aud:M0,iat:_y,exp:_y+3600,auth_time:_y,sub:m0,user_id:m0,firebase:{sign_in_provider:"custom",identities:{}}},$_);return[bh(JSON.stringify({alg:"none",type:"JWT"})),bh(JSON.stringify(G0)),""].join(".")}function S_(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function x_(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(S_())}function B_(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch($_){return!1}}function V_(){return"object"==typeof self&&self.self===self}function _0(){const $_="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof $_&&void 0!==$_.id}function c0(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Pv(){return S_().indexOf("Electron/")>=0}function h0(){const $_=S_();return $_.indexOf("MSIE ")>=0||$_.indexOf("Trident/")>=0}function I0(){return S_().indexOf("MSAppHost/")>=0}function G_(){return!1}function e0(){return!B_()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function P_(){return"object"==typeof indexedDB}function _v(){return new Promise(($_,_E)=>{try{let r0=!0;const M0="validate-browser-context-for-indexeddb-analytics-module",_y=self.indexedDB.open(M0);_y.onsuccess=()=>{_y.result.close(),r0||self.indexedDB.deleteDatabase(M0),$_(!0)},_y.onupgradeneeded=()=>{r0=!1},_y.onerror=()=>{var m0;_E((null===(m0=_y.error)||void 0===m0?void 0:m0.message)||"")}}catch(r0){_E(r0)}})}function E_(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}class J_ extends Error{constructor(_E,r0,M0){super(r0),this.code=_E,this.customData=M0,this.name="FirebaseError",Object.setPrototypeOf(this,J_.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Y_.prototype.create)}}class Y_{constructor(_E,r0,M0){this.service=_E,this.serviceName=r0,this.errors=M0}create(_E,...r0){const M0=r0[0]||{},_y=`${this.service}/${_E}`,m0=this.errors[_E],G0=m0?function D0($_,_E){return $_.replace(O0,(r0,M0)=>{const _y=_E[M0];return null!=_y?String(_y):`<${M0}?>`})}(m0,M0):"Error";return new J_(_y,`${this.serviceName}: ${G0} (${_y}).`,M0)}}const O0=/\{\$([^}]+)}/g;function EI($_){return JSON.parse($_)}function eI($_){return JSON.stringify($_)}const Y0=function($_){let _E={},r0={},M0={},_y="";try{const m0=$_.split(".");_E=EI(n_(m0[0])||""),r0=EI(n_(m0[1])||""),_y=m0[2],M0=r0.d||{},delete r0.d}catch(m0){}return{header:_E,claims:r0,data:M0,signature:_y}},UI=function($_){const r0=Y0($_).claims;return!!r0&&"object"==typeof r0&&r0.hasOwnProperty("iat")},Z1=function($_){const _E=Y0($_).claims;return"object"==typeof _E&&!0===_E.admin};function sT($_,_E){return Object.prototype.hasOwnProperty.call($_,_E)}function L1($_,_E){if(Object.prototype.hasOwnProperty.call($_,_E))return $_[_E]}function w1($_){for(const _E in $_)if(Object.prototype.hasOwnProperty.call($_,_E))return!1;return!0}function SN($_,_E,r0){const M0={};for(const _y in $_)Object.prototype.hasOwnProperty.call($_,_y)&&(M0[_y]=_E.call(r0,$_[_y],_y,$_));return M0}function _T($_,_E){if($_===_E)return!0;const r0=Object.keys($_),M0=Object.keys(_E);for(const _y of r0){if(!M0.includes(_y))return!1;const m0=$_[_y],G0=_E[_y];if(NT(m0)&&NT(G0)){if(!_T(m0,G0))return!1}else if(m0!==G0)return!1}for(const _y of M0)if(!r0.includes(_y))return!1;return!0}function NT($_){return null!==$_&&"object"==typeof $_}function YT($_){const _E=[];for(const[r0,M0]of Object.entries($_))Array.isArray(M0)?M0.forEach(_y=>{_E.push(encodeURIComponent(r0)+"="+encodeURIComponent(_y))}):_E.push(encodeURIComponent(r0)+"="+encodeURIComponent(M0));return _E.length?"&"+_E.join("&"):""}function $O($_){const _E={};return $_.replace(/^\?/,"").split("&").forEach(M0=>{if(M0){const[_y,m0]=M0.split("=");_E[decodeURIComponent(_y)]=decodeURIComponent(m0)}}),_E}function RN($_){const _E=$_.indexOf("?");if(!_E)return"";const r0=$_.indexOf("#",_E);return $_.substring(_E,r0>0?r0:void 0)}class jR{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let _E=1;_E<this.blockSize;++_E)this.pad_[_E]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(_E,r0){r0||(r0=0);const M0=this.W_;if("string"==typeof _E)for(let _b=0;_b<16;_b++)M0[_b]=_E.charCodeAt(r0)<<24|_E.charCodeAt(r0+1)<<16|_E.charCodeAt(r0+2)<<8|_E.charCodeAt(r0+3),r0+=4;else for(let _b=0;_b<16;_b++)M0[_b]=_E[r0]<<24|_E[r0+1]<<16|_E[r0+2]<<8|_E[r0+3],r0+=4;for(let _b=16;_b<80;_b++){const ZT=M0[_b-3]^M0[_b-8]^M0[_b-14]^M0[_b-16];M0[_b]=4294967295&(ZT<<1|ZT>>>31)}let XI,vT,_y=this.chain_[0],m0=this.chain_[1],G0=this.chain_[2],yI=this.chain_[3],qI=this.chain_[4];for(let _b=0;_b<80;_b++){_b<40?_b<20?(XI=yI^m0&(G0^yI),vT=1518500249):(XI=m0^G0^yI,vT=1859775393):_b<60?(XI=m0&G0|yI&(m0|G0),vT=2400959708):(XI=m0^G0^yI,vT=3395469782);const ZT=(_y<<5|_y>>>27)+XI+qI+vT+M0[_b]&4294967295;qI=yI,yI=G0,G0=4294967295&(m0<<30|m0>>>2),m0=_y,_y=ZT}this.chain_[0]=this.chain_[0]+_y&4294967295,this.chain_[1]=this.chain_[1]+m0&4294967295,this.chain_[2]=this.chain_[2]+G0&4294967295,this.chain_[3]=this.chain_[3]+yI&4294967295,this.chain_[4]=this.chain_[4]+qI&4294967295}update(_E,r0){if(null==_E)return;void 0===r0&&(r0=_E.length);const M0=r0-this.blockSize;let _y=0;const m0=this.buf_;let G0=this.inbuf_;for(;_y<r0;){if(0===G0)for(;_y<=M0;)this.compress_(_E,_y),_y+=this.blockSize;if("string"==typeof _E){for(;_y<r0;)if(m0[G0]=_E.charCodeAt(_y),++G0,++_y,G0===this.blockSize){this.compress_(m0),G0=0;break}}else for(;_y<r0;)if(m0[G0]=_E[_y],++G0,++_y,G0===this.blockSize){this.compress_(m0),G0=0;break}}this.inbuf_=G0,this.total_+=r0}digest(){const _E=[];let r0=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let _y=this.blockSize-1;_y>=56;_y--)this.buf_[_y]=255&r0,r0/=256;this.compress_(this.buf_);let M0=0;for(let _y=0;_y<5;_y++)for(let m0=24;m0>=0;m0-=8)_E[M0]=this.chain_[_y]>>m0&255,++M0;return _E}}function ZO($_,_E){const r0=new KI($_,_E);return r0.subscribe.bind(r0)}class KI{constructor(_E,r0){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r0,this.task.then(()=>{_E(this)}).catch(M0=>{this.error(M0)})}next(_E){this.forEachObserver(r0=>{r0.next(_E)})}error(_E){this.forEachObserver(r0=>{r0.error(_E)}),this.close(_E)}complete(){this.forEachObserver(_E=>{_E.complete()}),this.close()}subscribe(_E,r0,M0){let _y;if(void 0===_E&&void 0===r0&&void 0===M0)throw new Error("Missing Observer.");_y=function TT($_,_E){if("object"!=typeof $_||null===$_)return!1;for(const r0 of _E)if(r0 in $_&&"function"==typeof $_[r0])return!0;return!1}(_E,["next","error","complete"])?_E:{next:_E,error:r0,complete:M0},void 0===_y.next&&(_y.next=GT),void 0===_y.error&&(_y.error=GT),void 0===_y.complete&&(_y.complete=GT);const m0=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?_y.error(this.finalError):_y.complete()}catch(G0){}}),this.observers.push(_y),m0}unsubscribeOne(_E){void 0===this.observers||void 0===this.observers[_E]||(delete this.observers[_E],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(_E){if(!this.finalized)for(let r0=0;r0<this.observers.length;r0++)this.sendOne(r0,_E)}sendOne(_E,r0){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[_E])try{r0(this.observers[_E])}catch(M0){"undefined"!=typeof console&&console.error&&console.error(M0)}})}close(_E){this.finalized||(this.finalized=!0,void 0!==_E&&(this.finalError=_E),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function GT(){}const dP=function($_,_E,r0,M0){let _y;if(M0<_E?_y="at least "+_E:M0>r0&&(_y=0===r0?"none":"no more than "+r0),_y)throw new Error($_+" failed: Was called with "+M0+(1===M0?" argument.":" arguments.")+" Expects "+_y+".")};function VR($_,_E){return`${$_} failed: ${_E} argument `}function JT($_,_E,r0,M0){if((!M0||r0)&&"function"!=typeof r0)throw new Error(VR($_,_E)+"must be a valid function.")}function SO($_,_E,r0,M0){if((!M0||r0)&&("object"!=typeof r0||null===r0))throw new Error(VR($_,_E)+"must be a valid context object.")}const _x=function($_){const _E=[];let r0=0;for(let M0=0;M0<$_.length;M0++){let _y=$_.charCodeAt(M0);if(_y>=55296&&_y<=56319){const m0=_y-55296;M0++,k(M0<$_.length,"Surrogate pair missing trail surrogate."),_y=65536+(m0<<10)+($_.charCodeAt(M0)-56320)}_y<128?_E[r0++]=_y:_y<2048?(_E[r0++]=_y>>6|192,_E[r0++]=63&_y|128):_y<65536?(_E[r0++]=_y>>12|224,_E[r0++]=_y>>6&63|128,_E[r0++]=63&_y|128):(_E[r0++]=_y>>18|240,_E[r0++]=_y>>12&63|128,_E[r0++]=_y>>6&63|128,_E[r0++]=63&_y|128)}return _E},M1=function($_){let _E=0;for(let r0=0;r0<$_.length;r0++){const M0=$_.charCodeAt(r0);M0<128?_E++:M0<2048?_E+=2:M0>=55296&&M0<=56319?(_E+=4,r0++):_E+=3}return _E};function D1($_,_E=1e3,r0=2){const M0=_E*Math.pow(r0,$_),_y=Math.round(.5*M0*(Math.random()-.5)*2);return Math.min(144e5,M0+_y)}function $T($_){return $_&&$_._delegate?$_._delegate:$_}},6114:(h,l,g)=>{"use strict";var f=g(5e3);let k=null;function q(){return k}const _l=new f.OlP("DocumentToken");let bh=(()=>{class o{historyGo(i){throw new Error("Not implemented")}}return o.\u0275fac=function(i){return new(i||o)},o.\u0275prov=f.Yz7({token:o,factory:function(){return function n_(){return(0,f.LFG)(r_)}()},providedIn:"platform"}),o})();const _A=new f.OlP("Location Initialized");let r_=(()=>{class o extends bh{constructor(i){super(),this._doc=i,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return q().getBaseHref(this._doc)}onPopState(i){const d=q().getGlobalEventTarget(this._doc,"window");return d.addEventListener("popstate",i,!1),()=>d.removeEventListener("popstate",i)}onHashChange(i){const d=q().getGlobalEventTarget(this._doc,"window");return d.addEventListener("hashchange",i,!1),()=>d.removeEventListener("hashchange",i)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(i){this.location.pathname=i}pushState(i,d,_){p_()?this._history.pushState(i,d,_):this.location.hash=_}replaceState(i,d,_){p_()?this._history.replaceState(i,d,_):this.location.hash=_}forward(){this._history.forward()}back(){this._history.back()}historyGo(i=0){this._history.go(i)}getState(){return this._history.state}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(_l))},o.\u0275prov=f.Yz7({token:o,factory:function(){return function I_(){return new r_((0,f.LFG)(_l))}()},providedIn:"platform"}),o})();function p_(){return!!window.history.pushState}function v_(o,e){if(0==o.length)return e;if(0==e.length)return o;let i=0;return o.endsWith("/")&&i++,e.startsWith("/")&&i++,2==i?o+e.substring(1):1==i?o+e:o+"/"+e}function S_(o){const e=o.match(/#|\?|$/),i=e&&e.index||o.length;return o.slice(0,i-("/"===o[i-1]?1:0))+o.slice(i)}function x_(o){return o&&"?"!==o[0]?"?"+o:o}let B_=(()=>{class o{historyGo(i){throw new Error("Not implemented")}}return o.\u0275fac=function(i){return new(i||o)},o.\u0275prov=f.Yz7({token:o,factory:function(){return function V_(o){const e=(0,f.LFG)(_l).location;return new c0((0,f.LFG)(bh),e&&e.origin||"")}()},providedIn:"root"}),o})();const _0=new f.OlP("appBaseHref");let c0=(()=>{class o extends B_{constructor(i,d){if(super(),this._platformLocation=i,this._removeListenerFns=[],null==d&&(d=this._platformLocation.getBaseHrefFromDOM()),null==d)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=d}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(i){this._removeListenerFns.push(this._platformLocation.onPopState(i),this._platformLocation.onHashChange(i))}getBaseHref(){return this._baseHref}prepareExternalUrl(i){return v_(this._baseHref,i)}path(i=!1){const d=this._platformLocation.pathname+x_(this._platformLocation.search),_=this._platformLocation.hash;return _&&i?`${d}${_}`:d}pushState(i,d,_,B){const _t=this.prepareExternalUrl(_+x_(B));this._platformLocation.pushState(i,d,_t)}replaceState(i,d,_,B){const _t=this.prepareExternalUrl(_+x_(B));this._platformLocation.replaceState(i,d,_t)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(i=0){var d,_;null===(_=(d=this._platformLocation).historyGo)||void 0===_||_.call(d,i)}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(bh),f.LFG(_0,8))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})(),Pv=(()=>{class o extends B_{constructor(i,d){super(),this._platformLocation=i,this._baseHref="",this._removeListenerFns=[],null!=d&&(this._baseHref=d)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(i){this._removeListenerFns.push(this._platformLocation.onPopState(i),this._platformLocation.onHashChange(i))}getBaseHref(){return this._baseHref}path(i=!1){let d=this._platformLocation.hash;return null==d&&(d="#"),d.length>0?d.substring(1):d}prepareExternalUrl(i){const d=v_(this._baseHref,i);return d.length>0?"#"+d:d}pushState(i,d,_,B){let _t=this.prepareExternalUrl(_+x_(B));0==_t.length&&(_t=this._platformLocation.pathname),this._platformLocation.pushState(i,d,_t)}replaceState(i,d,_,B){let _t=this.prepareExternalUrl(_+x_(B));0==_t.length&&(_t=this._platformLocation.pathname),this._platformLocation.replaceState(i,d,_t)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(i=0){var d,_;null===(_=(d=this._platformLocation).historyGo)||void 0===_||_.call(d,i)}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(bh),f.LFG(_0,8))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})(),h0=(()=>{class o{constructor(i,d){this._subject=new f.vpe,this._urlChangeListeners=[],this._platformStrategy=i;const _=this._platformStrategy.getBaseHref();this._platformLocation=d,this._baseHref=S_(e0(_)),this._platformStrategy.onPopState(B=>{this._subject.emit({url:this.path(!0),pop:!0,state:B.state,type:B.type})})}path(i=!1){return this.normalize(this._platformStrategy.path(i))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(i,d=""){return this.path()==this.normalize(i+x_(d))}normalize(i){return o.stripTrailingSlash(function G_(o,e){return o&&e.startsWith(o)?e.substring(o.length):e}(this._baseHref,e0(i)))}prepareExternalUrl(i){return i&&"/"!==i[0]&&(i="/"+i),this._platformStrategy.prepareExternalUrl(i)}go(i,d="",_=null){this._platformStrategy.pushState(_,"",i,d),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+x_(d)),_)}replaceState(i,d="",_=null){this._platformStrategy.replaceState(_,"",i,d),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+x_(d)),_)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(i=0){var d,_;null===(_=(d=this._platformStrategy).historyGo)||void 0===_||_.call(d,i)}onUrlChange(i){this._urlChangeListeners.push(i),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(d=>{this._notifyUrlChangeListeners(d.url,d.state)}))}_notifyUrlChangeListeners(i="",d){this._urlChangeListeners.forEach(_=>_(i,d))}subscribe(i,d,_){return this._subject.subscribe({next:i,error:d,complete:_})}}return o.normalizeQueryParams=x_,o.joinWithSlash=v_,o.stripTrailingSlash=S_,o.\u0275fac=function(i){return new(i||o)(f.LFG(B_),f.LFG(bh))},o.\u0275prov=f.Yz7({token:o,factory:function(){return function I0(){return new h0((0,f.LFG)(B_),(0,f.LFG)(bh))}()},providedIn:"root"}),o})();function e0(o){return o.replace(/\/index.html$/,"")}var L_=(()=>((L_=L_||{})[L_.Format=0]="Format",L_[L_.Standalone=1]="Standalone",L_))(),F_=(()=>((F_=F_||{})[F_.Narrow=0]="Narrow",F_[F_.Abbreviated=1]="Abbreviated",F_[F_.Wide=2]="Wide",F_[F_.Short=3]="Short",F_))(),J_=(()=>((J_=J_||{})[J_.Short=0]="Short",J_[J_.Medium=1]="Medium",J_[J_.Long=2]="Long",J_[J_.Full=3]="Full",J_))(),Y_=(()=>((Y_=Y_||{})[Y_.Decimal=0]="Decimal",Y_[Y_.Group=1]="Group",Y_[Y_.List=2]="List",Y_[Y_.PercentSign=3]="PercentSign",Y_[Y_.PlusSign=4]="PlusSign",Y_[Y_.MinusSign=5]="MinusSign",Y_[Y_.Exponential=6]="Exponential",Y_[Y_.SuperscriptingExponent=7]="SuperscriptingExponent",Y_[Y_.PerMille=8]="PerMille",Y_[Y_.Infinity=9]="Infinity",Y_[Y_.NaN=10]="NaN",Y_[Y_.TimeSeparator=11]="TimeSeparator",Y_[Y_.CurrencyDecimal=12]="CurrencyDecimal",Y_[Y_.CurrencyGroup=13]="CurrencyGroup",Y_))();function Z1(o,e){return TT((0,f.cg1)(o)[f.wAp.DateFormat],e)}function sT(o,e){return TT((0,f.cg1)(o)[f.wAp.TimeFormat],e)}function L1(o,e){return TT((0,f.cg1)(o)[f.wAp.DateTimeFormat],e)}function w1(o,e){const i=(0,f.cg1)(o),d=i[f.wAp.NumberSymbols][e];if(void 0===d){if(e===Y_.CurrencyDecimal)return i[f.wAp.NumberSymbols][Y_.Decimal];if(e===Y_.CurrencyGroup)return i[f.wAp.NumberSymbols][Y_.Group]}return d}function jR(o){if(!o[f.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${o[f.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function TT(o,e){for(let i=e;i>-1;i--)if(void 0!==o[i])return o[i];throw new Error("Locale data API: locale data undefined")}function GT(o){const[e,i]=o.split(":");return{hours:+e,minutes:+i}}const JT=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,SO={},_x=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var M1=(()=>((M1=M1||{})[M1.Short=0]="Short",M1[M1.ShortGMT=1]="ShortGMT",M1[M1.Long=2]="Long",M1[M1.Extended=3]="Extended",M1))(),kI=(()=>((kI=kI||{})[kI.FullYear=0]="FullYear",kI[kI.Month=1]="Month",kI[kI.Date=2]="Date",kI[kI.Hours=3]="Hours",kI[kI.Minutes=4]="Minutes",kI[kI.Seconds=5]="Seconds",kI[kI.FractionalSeconds=6]="FractionalSeconds",kI[kI.Day=7]="Day",kI))(),JI=(()=>((JI=JI||{})[JI.DayPeriods=0]="DayPeriods",JI[JI.Days=1]="Days",JI[JI.Months=2]="Months",JI[JI.Eras=3]="Eras",JI))();function gR(o,e,i,d){let _=function ON(o){if(bS(o))return o;if("number"==typeof o&&!isNaN(o))return new Date(o);if("string"==typeof o){if(o=o.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(o)){const[_,B=1,_t=1]=o.split("-").map(_a=>+_a);return rR(_,B-1,_t)}const i=parseFloat(o);if(!isNaN(o-i))return new Date(i);let d;if(d=o.match(JT))return function JM(o){const e=new Date(0);let i=0,d=0;const _=o[8]?e.setUTCFullYear:e.setFullYear,B=o[8]?e.setUTCHours:e.setHours;o[9]&&(i=Number(o[9]+o[10]),d=Number(o[9]+o[11])),_.call(e,Number(o[1]),Number(o[2])-1,Number(o[3]));const _t=Number(o[4]||0)-i,_a=Number(o[5]||0)-d,_h=Number(o[6]||0),_g=Math.floor(1e3*parseFloat("0."+(o[7]||0)));return B.call(e,_t,_a,_h,_g),e}(d)}const e=new Date(o);if(!bS(e))throw new Error(`Unable to convert "${o}" into a date`);return e}(o);e=D1(i,e)||e;let _a,_t=[];for(;e;){if(_a=_x.exec(e),!_a){_t.push(e);break}{_t=_t.concat(_a.slice(1));const l_=_t.pop();if(!l_)break;e=l_}}let _h=_.getTimezoneOffset();d&&(_h=AR(d,_h),_=function YM(o,e,i){const d=i?-1:1,_=o.getTimezoneOffset();return function g3(o,e){return(o=new Date(o.getTime())).setMinutes(o.getMinutes()+e),o}(o,d*(AR(e,_)-_))}(_,d,!0));let _g="";return _t.forEach(l_=>{const f_=function ZT(o){if(_b[o])return _b[o];let e;switch(o){case"G":case"GG":case"GGG":e=r0(JI.Eras,F_.Abbreviated);break;case"GGGG":e=r0(JI.Eras,F_.Wide);break;case"GGGGG":e=r0(JI.Eras,F_.Narrow);break;case"y":e=$_(kI.FullYear,1,0,!1,!0);break;case"yy":e=$_(kI.FullYear,2,0,!0,!0);break;case"yyy":e=$_(kI.FullYear,3,0,!1,!0);break;case"yyyy":e=$_(kI.FullYear,4,0,!1,!0);break;case"Y":e=vT(1);break;case"YY":e=vT(2,!0);break;case"YYY":e=vT(3);break;case"YYYY":e=vT(4);break;case"M":case"L":e=$_(kI.Month,1,1);break;case"MM":case"LL":e=$_(kI.Month,2,1);break;case"MMM":e=r0(JI.Months,F_.Abbreviated);break;case"MMMM":e=r0(JI.Months,F_.Wide);break;case"MMMMM":e=r0(JI.Months,F_.Narrow);break;case"LLL":e=r0(JI.Months,F_.Abbreviated,L_.Standalone);break;case"LLLL":e=r0(JI.Months,F_.Wide,L_.Standalone);break;case"LLLLL":e=r0(JI.Months,F_.Narrow,L_.Standalone);break;case"w":e=XI(1);break;case"ww":e=XI(2);break;case"W":e=XI(1,!0);break;case"d":e=$_(kI.Date,1);break;case"dd":e=$_(kI.Date,2);break;case"c":case"cc":e=$_(kI.Day,1);break;case"ccc":e=r0(JI.Days,F_.Abbreviated,L_.Standalone);break;case"cccc":e=r0(JI.Days,F_.Wide,L_.Standalone);break;case"ccccc":e=r0(JI.Days,F_.Narrow,L_.Standalone);break;case"cccccc":e=r0(JI.Days,F_.Short,L_.Standalone);break;case"E":case"EE":case"EEE":e=r0(JI.Days,F_.Abbreviated);break;case"EEEE":e=r0(JI.Days,F_.Wide);break;case"EEEEE":e=r0(JI.Days,F_.Narrow);break;case"EEEEEE":e=r0(JI.Days,F_.Short);break;case"a":case"aa":case"aaa":e=r0(JI.DayPeriods,F_.Abbreviated);break;case"aaaa":e=r0(JI.DayPeriods,F_.Wide);break;case"aaaaa":e=r0(JI.DayPeriods,F_.Narrow);break;case"b":case"bb":case"bbb":e=r0(JI.DayPeriods,F_.Abbreviated,L_.Standalone,!0);break;case"bbbb":e=r0(JI.DayPeriods,F_.Wide,L_.Standalone,!0);break;case"bbbbb":e=r0(JI.DayPeriods,F_.Narrow,L_.Standalone,!0);break;case"B":case"BB":case"BBB":e=r0(JI.DayPeriods,F_.Abbreviated,L_.Format,!0);break;case"BBBB":e=r0(JI.DayPeriods,F_.Wide,L_.Format,!0);break;case"BBBBB":e=r0(JI.DayPeriods,F_.Narrow,L_.Format,!0);break;case"h":e=$_(kI.Hours,1,-12);break;case"hh":e=$_(kI.Hours,2,-12);break;case"H":e=$_(kI.Hours,1);break;case"HH":e=$_(kI.Hours,2);break;case"m":e=$_(kI.Minutes,1);break;case"mm":e=$_(kI.Minutes,2);break;case"s":e=$_(kI.Seconds,1);break;case"ss":e=$_(kI.Seconds,2);break;case"S":e=$_(kI.FractionalSeconds,1);break;case"SS":e=$_(kI.FractionalSeconds,2);break;case"SSS":e=$_(kI.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=_y(M1.Short);break;case"ZZZZZ":e=_y(M1.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=_y(M1.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=_y(M1.Long);break;default:return null}return _b[o]=e,e}(l_);_g+=f_?f_(_,i,_h):"''"===l_?"'":l_.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),_g}function rR(o,e,i){const d=new Date(0);return d.setFullYear(o,e,i),d.setHours(0,0,0),d}function D1(o,e){const i=function O0(o){return(0,f.cg1)(o)[f.wAp.LocaleId]}(o);if(SO[i]=SO[i]||{},SO[i][e])return SO[i][e];let d="";switch(e){case"shortDate":d=Z1(o,J_.Short);break;case"mediumDate":d=Z1(o,J_.Medium);break;case"longDate":d=Z1(o,J_.Long);break;case"fullDate":d=Z1(o,J_.Full);break;case"shortTime":d=sT(o,J_.Short);break;case"mediumTime":d=sT(o,J_.Medium);break;case"longTime":d=sT(o,J_.Long);break;case"fullTime":d=sT(o,J_.Full);break;case"short":const _=D1(o,"shortTime"),B=D1(o,"shortDate");d=eL(L1(o,J_.Short),[_,B]);break;case"medium":const _t=D1(o,"mediumTime"),_a=D1(o,"mediumDate");d=eL(L1(o,J_.Medium),[_t,_a]);break;case"long":const _h=D1(o,"longTime"),_g=D1(o,"longDate");d=eL(L1(o,J_.Long),[_h,_g]);break;case"full":const l_=D1(o,"fullTime"),f_=D1(o,"fullDate");d=eL(L1(o,J_.Full),[l_,f_])}return d&&(SO[i][e]=d),d}function eL(o,e){return e&&(o=o.replace(/\{([^}]+)}/g,function(i,d){return null!=e&&d in e?e[d]:i})),o}function mR(o,e,i="-",d,_){let B="";(o<0||_&&o<=0)&&(_?o=1-o:(o=-o,B=i));let _t=String(o);for(;_t.length<e;)_t="0"+_t;return d&&(_t=_t.substr(_t.length-e)),B+_t}function $_(o,e,i=0,d=!1,_=!1){return function(B,_t){let _a=function _E(o,e){switch(o){case kI.FullYear:return e.getFullYear();case kI.Month:return e.getMonth();case kI.Date:return e.getDate();case kI.Hours:return e.getHours();case kI.Minutes:return e.getMinutes();case kI.Seconds:return e.getSeconds();case kI.FractionalSeconds:return e.getMilliseconds();case kI.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${o}".`)}}(o,B);if((i>0||_a>-i)&&(_a+=i),o===kI.Hours)0===_a&&-12===i&&(_a=12);else if(o===kI.FractionalSeconds)return function $T(o,e){return mR(o,3).substr(0,e)}(_a,e);const _h=w1(_t,Y_.MinusSign);return mR(_a,e,_h,d,_)}}function r0(o,e,i=L_.Format,d=!1){return function(_,B){return function M0(o,e,i,d,_,B){switch(i){case JI.Months:return function Y0(o,e,i){const d=(0,f.cg1)(o),B=TT([d[f.wAp.MonthsFormat],d[f.wAp.MonthsStandalone]],e);return TT(B,i)}(e,_,d)[o.getMonth()];case JI.Days:return function eI(o,e,i){const d=(0,f.cg1)(o),B=TT([d[f.wAp.DaysFormat],d[f.wAp.DaysStandalone]],e);return TT(B,i)}(e,_,d)[o.getDay()];case JI.DayPeriods:const _t=o.getHours(),_a=o.getMinutes();if(B){const _g=function ZO(o){const e=(0,f.cg1)(o);return jR(e),(e[f.wAp.ExtraData][2]||[]).map(d=>"string"==typeof d?GT(d):[GT(d[0]),GT(d[1])])}(e),l_=function KI(o,e,i){const d=(0,f.cg1)(o);jR(d);const B=TT([d[f.wAp.ExtraData][0],d[f.wAp.ExtraData][1]],e)||[];return TT(B,i)||[]}(e,_,d),f_=_g.findIndex(R_=>{if(Array.isArray(R_)){const[H_,W_]=R_,R0=_t>=H_.hours&&_a>=H_.minutes,H0=_t<W_.hours||_t===W_.hours&&_a<W_.minutes;if(H_.hours<W_.hours){if(R0&&H0)return!0}else if(R0||H0)return!0}else if(R_.hours===_t&&R_.minutes===_a)return!0;return!1});if(-1!==f_)return l_[f_]}return function EI(o,e,i){const d=(0,f.cg1)(o),B=TT([d[f.wAp.DayPeriodsFormat],d[f.wAp.DayPeriodsStandalone]],e);return TT(B,i)}(e,_,d)[_t<12?0:1];case JI.Eras:return function x1(o,e){return TT((0,f.cg1)(o)[f.wAp.Eras],e)}(e,d)[o.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${i}`)}}(_,B,o,e,i,d)}}function _y(o){return function(e,i,d){const _=-1*d,B=w1(i,Y_.MinusSign),_t=_>0?Math.floor(_/60):Math.ceil(_/60);switch(o){case M1.Short:return(_>=0?"+":"")+mR(_t,2,B)+mR(Math.abs(_%60),2,B);case M1.ShortGMT:return"GMT"+(_>=0?"+":"")+mR(_t,1,B);case M1.Long:return"GMT"+(_>=0?"+":"")+mR(_t,2,B)+":"+mR(Math.abs(_%60),2,B);case M1.Extended:return 0===d?"Z":(_>=0?"+":"")+mR(_t,2,B)+":"+mR(Math.abs(_%60),2,B);default:throw new Error(`Unknown zone width "${o}"`)}}}function qI(o){return rR(o.getFullYear(),o.getMonth(),o.getDate()+(4-o.getDay()))}function XI(o,e=!1){return function(i,d){let _;if(e){const B=new Date(i.getFullYear(),i.getMonth(),1).getDay()-1,_t=i.getDate();_=1+Math.floor((_t+B)/7)}else{const B=qI(i),_t=function yI(o){const e=rR(o,0,1).getDay();return rR(o,0,1+(e<=4?4:11)-e)}(B.getFullYear()),_a=B.getTime()-_t.getTime();_=1+Math.round(_a/6048e5)}return mR(_,o,w1(d,Y_.MinusSign))}}function vT(o,e=!1){return function(i,d){return mR(qI(i).getFullYear(),o,w1(d,Y_.MinusSign),e)}}const _b={};function AR(o,e){o=o.replace(/:/g,"");const i=Date.parse("Jan 01, 1970 00:00:00 "+o)/6e4;return isNaN(i)?e:i}function bS(o){return o instanceof Date&&!isNaN(o.valueOf())}function ZL(o,e){e=encodeURIComponent(e);for(const i of o.split(";")){const d=i.indexOf("="),[_,B]=-1==d?[i,""]:[i.slice(0,d),i.slice(d+1)];if(_.trim()===e)return decodeURIComponent(B)}return null}class pP{constructor(e,i,d,_){this.$implicit=e,this.ngForOf=i,this.index=d,this.count=_}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let HS=(()=>{class o{constructor(i,d,_){this._viewContainer=i,this._template=d,this._differs=_,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(i){this._ngForOf=i,this._ngForOfDirty=!0}set ngForTrackBy(i){this._trackByFn=i}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(i){i&&(this._template=i)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const i=this._ngForOf;!this._differ&&i&&(this._differ=this._differs.find(i).create(this.ngForTrackBy))}if(this._differ){const i=this._differ.diff(this._ngForOf);i&&this._applyChanges(i)}}_applyChanges(i){const d=this._viewContainer;i.forEachOperation((_,B,_t)=>{if(null==_.previousIndex)d.createEmbeddedView(this._template,new pP(_.item,this._ngForOf,-1,-1),null===_t?void 0:_t);else if(null==_t)d.remove(null===B?void 0:B);else if(null!==B){const _a=d.get(B);d.move(_a,_t),kN(_a,_)}});for(let _=0,B=d.length;_<B;_++){const _a=d.get(_).context;_a.index=_,_a.count=B,_a.ngForOf=this._ngForOf}i.forEachIdentityChange(_=>{kN(d.get(_.currentIndex),_)})}static ngTemplateContextGuard(i,d){return!0}}return o.\u0275fac=function(i){return new(i||o)(f.Y36(f.s_b),f.Y36(f.Rgc),f.Y36(f.ZZ4))},o.\u0275dir=f.lG2({type:o,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),o})();function kN(o,e){o.context.$implicit=e.item}let QT=(()=>{class o{constructor(i,d){this._viewContainer=i,this._context=new cT,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=d}set ngIf(i){this._context.$implicit=this._context.ngIf=i,this._updateView()}set ngIfThen(i){tL("ngIfThen",i),this._thenTemplateRef=i,this._thenViewRef=null,this._updateView()}set ngIfElse(i){tL("ngIfElse",i),this._elseTemplateRef=i,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(i,d){return!0}}return o.\u0275fac=function(i){return new(i||o)(f.Y36(f.s_b),f.Y36(f.Rgc))},o.\u0275dir=f.lG2({type:o,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),o})();class cT{constructor(){this.$implicit=null,this.ngIf=null}}function tL(o,e){if(e&&!e.createEmbeddedView)throw new Error(`${o} must be a TemplateRef, but received '${(0,f.AaK)(e)}'.`)}const nV=new f.OlP("DATE_PIPE_DEFAULT_TIMEZONE");let XM=(()=>{class o{constructor(i,d){this.locale=i,this.defaultTimezone=d}transform(i,d="mediumDate",_,B){var _t;if(null==i||""===i||i!=i)return null;try{return gR(i,d,B||this.locale,null!==(_t=null!=_?_:this.defaultTimezone)&&void 0!==_t?_t:void 0)}catch(_a){throw function iR(o,e){return new f.vHH(2100,"")}()}}}return o.\u0275fac=function(i){return new(i||o)(f.Y36(f.soG,16),f.Y36(nV,24))},o.\u0275pipe=f.Yjl({name:"date",type:o,pure:!0}),o})(),nL=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=f.oAB({type:o}),o.\u0275inj=f.cJS({}),o})();function rL(o){return"server"===o}let y3=(()=>{class o{}return o.\u0275prov=(0,f.Yz7)({token:o,providedIn:"root",factory:()=>new AP((0,f.LFG)(_l),window)}),o})();class AP{constructor(e,i){this.document=e,this.window=i,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const i=function MN(o,e){const i=o.getElementById(e)||o.getElementsByName(e)[0];if(i)return i;if("function"==typeof o.createTreeWalker&&o.body&&(o.body.createShadowRoot||o.body.attachShadow)){const d=o.createTreeWalker(o.body,NodeFilter.SHOW_ELEMENT);let _=d.currentNode;for(;_;){const B=_.shadowRoot;if(B){const _t=B.getElementById(e)||B.querySelector(`[name="${e}"]`);if(_t)return _t}_=d.nextNode()}}return null}(this.document,e);i&&(this.scrollToElement(i),i.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const i=this.window.history;i&&i.scrollRestoration&&(i.scrollRestoration=e)}}scrollToElement(e){const i=e.getBoundingClientRect(),d=i.left+this.window.pageXOffset,_=i.top+this.window.pageYOffset,B=this.offset();this.window.scrollTo(d-B[0],_-B[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=eU(this.window.history)||eU(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function eU(o){return Object.getOwnPropertyDescriptor(o,"scrollRestoration")}class nT{}class iL extends class tU extends class ga{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function _s(o){k||(k=o)}(new iL)}onAndCancel(e,i,d){return e.addEventListener(i,d,!1),()=>{e.removeEventListener(i,d,!1)}}dispatchEvent(e,i){e.dispatchEvent(i)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,i){return(i=i||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,i){return"window"===i?window:"document"===i?e:"body"===i?e.body:null}getBaseHref(e){const i=function oL(){return K1=K1||document.querySelector("base"),K1?K1.getAttribute("href"):null}();return null==i?null:function _P(o){E3=E3||document.createElement("a"),E3.setAttribute("href",o);const e=E3.pathname;return"/"===e.charAt(0)?e:`/${e}`}(i)}resetBaseElement(){K1=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return ZL(document.cookie,e)}}let E3,K1=null;const WS=new f.OlP("TRANSITION_ID"),kT=[{provide:f.ip1,useFactory:function nU(o,e,i){return()=>{i.get(f.CZH).donePromise.then(()=>{const d=q(),_=e.querySelectorAll(`style[ng-transition="${o}"]`);for(let B=0;B<_.length;B++)d.remove(_[B])})}},deps:[WS,_l,f.zs3],multi:!0}];class oR{static init(){(0,f.VLi)(new oR)}addToWindow(e){f.dqk.getAngularTestability=(d,_=!0)=>{const B=e.findTestabilityInTree(d,_);if(null==B)throw new Error("Could not find testability for element.");return B},f.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),f.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),f.dqk.frameworkStabilizers||(f.dqk.frameworkStabilizers=[]),f.dqk.frameworkStabilizers.push(d=>{const _=f.dqk.getAllAngularTestabilities();let B=_.length,_t=!1;const _a=function(_h){_t=_t||_h,B--,0==B&&d(_t)};_.forEach(function(_h){_h.whenStable(_a)})})}findTestabilityInTree(e,i,d){if(null==i)return null;const _=e.getTestability(i);return null!=_?_:d?q().isShadowRoot(i)?this.findTestabilityInTree(e,i.host,!0):this.findTestabilityInTree(e,i.parentElement,!0):null}}let sR=(()=>{class o{build(){return new XMLHttpRequest}}return o.\u0275fac=function(i){return new(i||o)},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})();const vP=new f.OlP("EventManagerPlugins");let y2=(()=>{class o{constructor(i,d){this._zone=d,this._eventNameToPlugin=new Map,i.forEach(_=>_.manager=this),this._plugins=i.slice().reverse()}addEventListener(i,d,_){return this._findPluginFor(d).addEventListener(i,d,_)}addGlobalEventListener(i,d,_){return this._findPluginFor(d).addGlobalEventListener(i,d,_)}getZone(){return this._zone}_findPluginFor(i){const d=this._eventNameToPlugin.get(i);if(d)return d;const _=this._plugins;for(let B=0;B<_.length;B++){const _t=_[B];if(_t.supports(i))return this._eventNameToPlugin.set(i,_t),_t}throw new Error(`No event manager plugin found for event ${i}`)}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(vP),f.LFG(f.R0b))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})();class BN{constructor(e){this._doc=e}addGlobalEventListener(e,i,d){const _=q().getGlobalEventTarget(this._doc,e);if(!_)throw new Error(`Unsupported event target ${_} for event ${i}`);return this.addEventListener(_,i,d)}}let PT=(()=>{class o{constructor(){this._stylesSet=new Set}addStyles(i){const d=new Set;i.forEach(_=>{this._stylesSet.has(_)||(this._stylesSet.add(_),d.add(_))}),this.onStylesAdded(d)}onStylesAdded(i){}getAllStyles(){return Array.from(this._stylesSet)}}return o.\u0275fac=function(i){return new(i||o)},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})(),DO=(()=>{class o extends PT{constructor(i){super(),this._doc=i,this._hostNodes=new Map,this._hostNodes.set(i.head,[])}_addStylesToHost(i,d,_){i.forEach(B=>{const _t=this._doc.createElement("style");_t.textContent=B,_.push(d.appendChild(_t))})}addHost(i){const d=[];this._addStylesToHost(this._stylesSet,i,d),this._hostNodes.set(i,d)}removeHost(i){const d=this._hostNodes.get(i);d&&d.forEach(eM),this._hostNodes.delete(i)}onStylesAdded(i){this._hostNodes.forEach((d,_)=>{this._addStylesToHost(i,_,d)})}ngOnDestroy(){this._hostNodes.forEach(i=>i.forEach(eM))}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(_l))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})();function eM(o){q().remove(o)}const zI={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},yP=/%COMP%/g;function tM(o,e,i){for(let d=0;d<e.length;d++){let _=e[d];Array.isArray(_)?tM(o,_,i):(_=_.replace(yP,o),i.push(_))}return i}function j0(o){return e=>{if("__ngUnwrap__"===e)return o;!1===o(e)&&(e.preventDefault(),e.returnValue=!1)}}let nM=(()=>{class o{constructor(i,d,_){this.eventManager=i,this.sharedStylesHost=d,this.appId=_,this.rendererByCompId=new Map,this.defaultRenderer=new ST(i)}createRenderer(i,d){if(!i||!d)return this.defaultRenderer;switch(d.encapsulation){case f.ifc.Emulated:{let _=this.rendererByCompId.get(d.id);return _||(_=new NO(this.eventManager,this.sharedStylesHost,d,this.appId),this.rendererByCompId.set(d.id,_)),_.applyToHost(i),_}case 1:case f.ifc.ShadowDom:return new $j(this.eventManager,this.sharedStylesHost,i,d);default:if(!this.rendererByCompId.has(d.id)){const _=tM(d.id,d.styles,[]);this.sharedStylesHost.addStyles(_),this.rendererByCompId.set(d.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(y2),f.LFG(DO),f.LFG(f.AFp))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})();class ST{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,i){return i?document.createElementNS(zI[i]||i,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,i){e.appendChild(i)}insertBefore(e,i,d){e&&e.insertBefore(i,d)}removeChild(e,i){e&&e.removeChild(i)}selectRootElement(e,i){let d="string"==typeof e?document.querySelector(e):e;if(!d)throw new Error(`The selector "${e}" did not match any elements`);return i||(d.textContent=""),d}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,i,d,_){if(_){i=_+":"+i;const B=zI[_];B?e.setAttributeNS(B,i,d):e.setAttribute(i,d)}else e.setAttribute(i,d)}removeAttribute(e,i,d){if(d){const _=zI[d];_?e.removeAttributeNS(_,i):e.removeAttribute(`${d}:${i}`)}else e.removeAttribute(i)}addClass(e,i){e.classList.add(i)}removeClass(e,i){e.classList.remove(i)}setStyle(e,i,d,_){_&(f.JOm.DashCase|f.JOm.Important)?e.style.setProperty(i,d,_&f.JOm.Important?"important":""):e.style[i]=d}removeStyle(e,i,d){d&f.JOm.DashCase?e.style.removeProperty(i):e.style[i]=""}setProperty(e,i,d){e[i]=d}setValue(e,i){e.nodeValue=i}listen(e,i,d){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,i,j0(d)):this.eventManager.addEventListener(e,i,j0(d))}}class NO extends ST{constructor(e,i,d,_){super(e),this.component=d;const B=tM(_+"-"+d.id,d.styles,[]);i.addStyles(B),this.contentAttr=function I3(o){return"_ngcontent-%COMP%".replace(yP,o)}(_+"-"+d.id),this.hostAttr=function b3(o){return"_nghost-%COMP%".replace(yP,o)}(_+"-"+d.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,i){const d=super.createElement(e,i);return super.setAttribute(d,this.contentAttr,""),d}}class $j extends ST{constructor(e,i,d,_){super(e),this.sharedStylesHost=i,this.hostEl=d,this.shadowRoot=d.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const B=tM(_.id,_.styles,[]);for(let _t=0;_t<B.length;_t++){const _a=document.createElement("style");_a.textContent=B[_t],this.shadowRoot.appendChild(_a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,i){return super.appendChild(this.nodeOrShadowRoot(e),i)}insertBefore(e,i,d){return super.insertBefore(this.nodeOrShadowRoot(e),i,d)}removeChild(e,i){return super.removeChild(this.nodeOrShadowRoot(e),i)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let UN=(()=>{class o extends BN{constructor(i){super(i)}supports(i){return!0}addEventListener(i,d,_){return i.addEventListener(d,_,!1),()=>this.removeEventListener(i,d,_)}removeEventListener(i,d,_){return i.removeEventListener(d,_)}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(_l))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})();const e5=["alt","control","meta","shift"],E9={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},kO={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},vR={alt:o=>o.altKey,control:o=>o.ctrlKey,meta:o=>o.metaKey,shift:o=>o.shiftKey};let PO=(()=>{class o extends BN{constructor(i){super(i)}supports(i){return null!=o.parseEventName(i)}addEventListener(i,d,_){const B=o.parseEventName(d),_t=o.eventCallback(B.fullKey,_,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>q().onAndCancel(i,B.domEventName,_t))}static parseEventName(i){const d=i.toLowerCase().split("."),_=d.shift();if(0===d.length||"keydown"!==_&&"keyup"!==_)return null;const B=o._normalizeKey(d.pop());let _t="";if(e5.forEach(_h=>{const _g=d.indexOf(_h);_g>-1&&(d.splice(_g,1),_t+=_h+".")}),_t+=B,0!=d.length||0===B.length)return null;const _a={};return _a.domEventName=_,_a.fullKey=_t,_a}static getEventFullKey(i){let d="",_=function E2(o){let e=o.key;if(null==e){if(e=o.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===o.location&&kO.hasOwnProperty(e)&&(e=kO[e]))}return E9[e]||e}(i);return _=_.toLowerCase()," "===_?_="space":"."===_&&(_="dot"),e5.forEach(B=>{B!=_&&vR[B](i)&&(d+=B+".")}),d+=_,d}static eventCallback(i,d,_){return B=>{o.getEventFullKey(B)===i&&_.runGuarded(()=>d(B))}}static _normalizeKey(i){return"esc"===i?"escape":i}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(_l))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})();const T3=(0,f.eFA)(f._c5,"browser",[{provide:f.Lbi,useValue:"browser"},{provide:f.g9A,useValue:function EP(){iL.makeCurrent(),oR.init()},multi:!0},{provide:_l,useFactory:function t5(){return(0,f.RDi)(document),document},deps:[]}]),S3=[{provide:f.zSh,useValue:"root"},{provide:f.qLn,useFactory:function SS(){return new f.qLn},deps:[]},{provide:vP,useClass:UN,multi:!0,deps:[_l,f.R0b,f.Lbi]},{provide:vP,useClass:PO,multi:!0,deps:[_l]},{provide:nM,useClass:nM,deps:[y2,DO,f.AFp]},{provide:f.FYo,useExisting:nM},{provide:PT,useExisting:DO},{provide:DO,useClass:DO,deps:[_l]},{provide:f.dDg,useClass:f.dDg,deps:[f.R0b]},{provide:y2,useClass:y2,deps:[vP,f.R0b]},{provide:nT,useClass:sR,deps:[]}];let oU=(()=>{class o{constructor(i){if(i)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(i){return{ngModule:o,providers:[{provide:f.AFp,useValue:i.appId},{provide:WS,useExisting:f.AFp},kT]}}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(o,12))},o.\u0275mod=f.oAB({type:o}),o.\u0275inj=f.cJS({providers:S3,imports:[nL,f.hGG]}),o})();"undefined"!=typeof window&&window;let mV=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275prov=f.Yz7({token:o,factory:function(i){let d=null;return d=i?new(i||o):f.LFG(uU),d},providedIn:"root"}),o})(),uU=(()=>{class o extends mV{constructor(i){super(),this._doc=i}sanitize(i,d){if(null==d)return null;switch(i){case f.q3G.NONE:return d;case f.q3G.HTML:return(0,f.qzn)(d,"HTML")?(0,f.z3N)(d):(0,f.EiD)(this._doc,String(d)).toString();case f.q3G.STYLE:return(0,f.qzn)(d,"Style")?(0,f.z3N)(d):d;case f.q3G.SCRIPT:if((0,f.qzn)(d,"Script"))return(0,f.z3N)(d);throw new Error("unsafe value used in a script context");case f.q3G.URL:return(0,f.yhl)(d),(0,f.qzn)(d,"URL")?(0,f.z3N)(d):(0,f.mCW)(String(d));case f.q3G.RESOURCE_URL:if((0,f.qzn)(d,"ResourceURL"))return(0,f.z3N)(d);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${i} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(i){return(0,f.JVY)(i)}bypassSecurityTrustStyle(i){return(0,f.L6k)(i)}bypassSecurityTrustScript(i){return(0,f.eBb)(i)}bypassSecurityTrustUrl(i){return(0,f.LAX)(i)}bypassSecurityTrustResourceUrl(i){return(0,f.pB0)(i)}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(_l))},o.\u0275prov=f.Yz7({token:o,factory:function(i){let d=null;return d=i?new i:function FN(o){return new uU(o.get(_l))}(f.LFG(f.zs3)),d},providedIn:"root"}),o})();var uT=g(8996),sM=g(7669);function hI(...o){const e=(0,sM.yG)(o);return(0,uT.D)(o,e)}var xT=g(7579);class WR extends xT.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const i=super._subscribe(e);return!i.closed&&e.next(this._value),i}getValue(){const{hasError:e,thrownError:i,_value:d}=this;if(e)throw i;return this._throwIfClosed(),d}next(e){super.next(this._value=e)}}var LT=g(8306);const{isArray:aM}=Array,{getPrototypeOf:AV,prototype:cM,keys:CP}=Object;function tS(o){if(1===o.length){const e=o[0];if(aM(e))return{args:e,keys:null};if(function wP(o){return o&&"object"==typeof o&&AV(o)===cM}(e)){const i=CP(e);return{args:i.map(d=>e[d]),keys:i}}}return{args:o,keys:null}}var tN=g(4671),RI=g(4004);const{isArray:_V}=Array;function D3(o){return(0,RI.U)(e=>function vV(o,e){return _V(e)?o(...e):o(e)}(o,e))}function uL(o,e){return o.reduce((i,d,_)=>(i[d]=e[_],i),{})}var nS=g(5403),TP=g(9672);function uS(o,e,i){o?(0,TP.f)(i,o,e):e()}var lL=g(576);function RP(o,e){const i=(0,lL.m)(o)?o:()=>o,d=_=>_.error(i());return new LT.y(e?_=>e.schedule(d,0,_):d)}const OP=(0,g(3888).d)(o=>function(){o(this),this.name="EmptyError",this.message="no elements in sequence"});var lM=g(8189);function VN(...o){return function DP(){return(0,lM.J)(1)}()((0,uT.D)(o,(0,sM.yG)(o)))}var NP=g(8421);function lU(o){return new LT.y(e=>{(0,NP.Xf)(o()).subscribe(e)})}var b2=g(515),dL=g(727),rS=g(4482);function N3(){return(0,rS.e)((o,e)=>{let i=null;o._refCount++;const d=(0,nS.x)(e,void 0,void 0,void 0,()=>{if(!o||o._refCount<=0||0<--o._refCount)return void(i=null);const _=o._connection,B=i;i=null,_&&(!B||_===B)&&_.unsubscribe(),e.unsubscribe()});o.subscribe(d),d.closed||(i=o.connect())})}class kP extends LT.y{constructor(e,i){super(),this.source=e,this.subjectFactory=i,this._subject=null,this._refCount=0,this._connection=null,(0,rS.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new dL.w0;const i=this.getSubject();e.add(this.source.subscribe((0,nS.x)(i,void 0,()=>{this._teardown(),i.complete()},d=>{this._teardown(),i.error(d)},()=>this._teardown()))),e.closed&&(this._connection=null,e=dL.w0.EMPTY)}return e}refCount(){return N3()(this)}}function HT(o,e){return(0,rS.e)((i,d)=>{let _=null,B=0,_t=!1;const _a=()=>_t&&!_&&d.complete();i.subscribe((0,nS.x)(d,_h=>{null==_||_.unsubscribe();let _g=0;const l_=B++;(0,NP.Xf)(o(_h,l_)).subscribe(_=(0,nS.x)(d,f_=>d.next(e?e(_h,f_,l_,_g++):f_),()=>{_=null,_a()}))},()=>{_t=!0,_a()}))})}var hL=g(5698);function GN(...o){const e=(0,sM.yG)(o);return(0,rS.e)((i,d)=>{(e?VN(o,i,e):VN(o,i)).subscribe(d)})}function C2(o,e,i,d,_){return(B,_t)=>{let _a=i,_h=e,_g=0;B.subscribe((0,nS.x)(_t,l_=>{const f_=_g++;_h=_a?o(_h,l_,f_):(_a=!0,l_),d&&_t.next(_h)},_&&(()=>{_a&&_t.next(_h),_t.complete()})))}}function xO(o,e){return(0,rS.e)(C2(o,e,arguments.length>=2,!0))}function zS(o,e){return(0,rS.e)((i,d)=>{let _=0;i.subscribe((0,nS.x)(d,B=>o.call(e,B,_++)&&d.next(B)))})}function aR(o){return(0,rS.e)((e,i)=>{let B,d=null,_=!1;d=e.subscribe((0,nS.x)(i,void 0,void 0,_t=>{B=(0,NP.Xf)(o(_t,aR(o)(e))),d?(d.unsubscribe(),d=null,B.subscribe(i)):_=!0})),_&&(d.unsubscribe(),d=null,B.subscribe(i))})}var OS=g(5577);function LO(o,e){return(0,lL.m)(e)?(0,OS.z)(o,e,1):(0,OS.z)(o,1)}function k3(o){return o<=0?()=>b2.E:(0,rS.e)((e,i)=>{let d=[];e.subscribe((0,nS.x)(i,_=>{d.push(_),o<d.length&&d.shift()},()=>{for(const _ of d)i.next(_);i.complete()},void 0,()=>{d=null}))})}function i5(o=RT){return(0,rS.e)((e,i)=>{let d=!1;e.subscribe((0,nS.x)(i,_=>{d=!0,i.next(_)},()=>d?i.complete():i.error(o())))})}function RT(){return new OP}function TG(o){return(0,rS.e)((e,i)=>{let d=!1;e.subscribe((0,nS.x)(i,_=>{d=!0,i.next(_)},()=>{d||i.next(o),i.complete()}))})}function dM(o,e){const i=arguments.length>=2;return d=>d.pipe(o?zS((_,B)=>o(_,B,d)):tN.y,(0,hL.q)(1),i?TG(e):i5(()=>new OP))}var pO=g(8505);class PP{constructor(e,i){this.id=e,this.url=i}}class o5 extends PP{constructor(e,i,d="imperative",_=null){super(e,i),this.navigationTrigger=d,this.restoredState=_}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class w2 extends PP{constructor(e,i,d){super(e,i),this.urlAfterRedirects=d}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class P3 extends PP{constructor(e,i,d){super(e,i),this.reason=d}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class lS extends PP{constructor(e,i,d){super(e,i),this.error=d}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class dU extends PP{constructor(e,i,d,_){super(e,i),this.urlAfterRedirects=d,this.state=_}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class x3 extends PP{constructor(e,i,d,_){super(e,i),this.urlAfterRedirects=d,this.state=_}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class EV extends PP{constructor(e,i,d,_,B){super(e,i),this.urlAfterRedirects=d,this.state=_,this.shouldActivate=B}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class SG extends PP{constructor(e,i,d,_){super(e,i),this.urlAfterRedirects=d,this.state=_}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class yR extends PP{constructor(e,i,d,_){super(e,i),this.urlAfterRedirects=d,this.state=_}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class KR{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class hM{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class fM{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class T2{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class S2{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class R2{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class O2{constructor(e,i,d){this.routerEvent=e,this.position=i,this.anchor=d}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const v1="primary";class s5{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const i=this.params[e];return Array.isArray(i)?i[0]:i}return null}getAll(e){if(this.has(e)){const i=this.params[e];return Array.isArray(i)?i:[i]}return[]}get keys(){return Object.keys(this.params)}}function fL(o){return new s5(o)}const ER="ngNavigationCancelingError";function pM(o){const e=Error("NavigationCancelingError: "+o);return e[ER]=!0,e}function w9(o,e,i){const d=i.path.split("/");if(d.length>o.length||"full"===i.pathMatch&&(e.hasChildren()||d.length<o.length))return null;const _={};for(let B=0;B<d.length;B++){const _t=d[B],_a=o[B];if(_t.startsWith(":"))_[_t.substring(1)]=_a;else if(_t!==_a.path)return null}return{consumed:o.slice(0,d.length),posParams:_}}function MO(o,e){const i=o?Object.keys(o):void 0,d=e?Object.keys(e):void 0;if(!i||!d||i.length!=d.length)return!1;let _;for(let B=0;B<i.length;B++)if(_=i[B],!L3(o[_],e[_]))return!1;return!0}function L3(o,e){if(Array.isArray(o)&&Array.isArray(e)){if(o.length!==e.length)return!1;const i=[...o].sort(),d=[...e].sort();return i.every((_,B)=>d[B]===_)}return o===e}function IV(o){return Array.prototype.concat.apply([],o)}function nN(o){return o.length>0?o[o.length-1]:null}function pT(o,e){for(const i in o)o.hasOwnProperty(i)&&e(o[i],i)}function DS(o){return(0,f.CqO)(o)?o:(0,f.QGY)(o)?(0,uT.D)(Promise.resolve(o)):hI(o)}const RG={exact:function c_(o,e,i){if(!jI(o.segments,e.segments)||!p0(o.segments,e.segments,i)||o.numberOfChildren!==e.numberOfChildren)return!1;for(const d in e.children)if(!o.children[d]||!c_(o.children[d],e.children[d],i))return!1;return!0},subset:T_},BO={exact:function N2(o,e){return MO(o,e)},subset:function d_(o,e){return Object.keys(e).length<=Object.keys(o).length&&Object.keys(e).every(i=>L3(o[i],e[i]))},ignored:()=>!0};function gL(o,e,i){return RG[i.paths](o.root,e.root,i.matrixParams)&&BO[i.queryParams](o.queryParams,e.queryParams)&&!("exact"===i.fragment&&o.fragment!==e.fragment)}function T_(o,e,i){return K_(o,e,e.segments,i)}function K_(o,e,i,d){if(o.segments.length>i.length){const _=o.segments.slice(0,i.length);return!(!jI(_,i)||e.hasChildren()||!p0(_,i,d))}if(o.segments.length===i.length){if(!jI(o.segments,i)||!p0(o.segments,i,d))return!1;for(const _ in e.children)if(!o.children[_]||!T_(o.children[_],e.children[_],d))return!1;return!0}{const _=i.slice(0,o.segments.length),B=i.slice(o.segments.length);return!!(jI(o.segments,_)&&p0(o.segments,_,d)&&o.children[v1])&&K_(o.children[v1],e,B,d)}}function p0(o,e,i){return e.every((d,_)=>BO[i](o[_].parameters,d.parameters))}class E0{constructor(e,i,d){this.root=e,this.queryParams=i,this.fragment=d}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=fL(this.queryParams)),this._queryParamMap}toString(){return NS.serialize(this)}}class k0{constructor(e,i){this.segments=e,this.children=i,this.parent=null,pT(i,(d,_)=>d.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return QN(this)}}class vI{constructor(e,i){this.path=e,this.parameters=i}get parameterMap(){return this._parameterMap||(this._parameterMap=fL(this.parameters)),this._parameterMap}toString(){return c5(this)}}function jI(o,e){return o.length===e.length&&o.every((i,d)=>i.path===e[d].path)}class t1{}class dS{parse(e){const i=new T9(e);return new E0(i.parseRootSegment(),i.parseQueryParams(),i.parseFragment())}serialize(e){const i=`/${rN(e.root,!0)}`,d=function wV(o){const e=Object.keys(o).map(i=>{const d=o[i];return Array.isArray(d)?d.map(_=>`${cR(i)}=${cR(_)}`).join("&"):`${cR(i)}=${cR(d)}`}).filter(i=>!!i);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${i}${d}${"string"==typeof e.fragment?`#${function k2(o){return encodeURI(o)}(e.fragment)}`:""}`}}const NS=new dS;function QN(o){return o.segments.map(e=>c5(e)).join("/")}function rN(o,e){if(!o.hasChildren())return QN(o);if(e){const i=o.children[v1]?rN(o.children[v1],!1):"",d=[];return pT(o.children,(_,B)=>{B!==v1&&d.push(`${B}:${rN(_,!1)}`)}),d.length>0?`${i}(${d.join("//")})`:i}{const i=function Q1(o,e){let i=[];return pT(o.children,(d,_)=>{_===v1&&(i=i.concat(e(d,_)))}),pT(o.children,(d,_)=>{_!==v1&&(i=i.concat(e(d,_)))}),i}(o,(d,_)=>_===v1?[rN(o.children[v1],!1)]:[`${_}:${rN(d,!1)}`]);return 1===Object.keys(o.children).length&&null!=o.children[v1]?`${QN(o)}/${i[0]}`:`${QN(o)}/(${i.join("//")})`}}function zR(o){return encodeURIComponent(o).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function cR(o){return zR(o).replace(/%3B/gi,";")}function P2(o){return zR(o).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function gM(o){return decodeURIComponent(o)}function YR(o){return gM(o.replace(/\+/g,"%20"))}function c5(o){return`${P2(o.path)}${function CV(o){return Object.keys(o).map(e=>`;${P2(e)}=${P2(o[e])}`).join("")}(o.parameters)}`}const OG=/^[^\/()?;=#]+/;function TV(o){const e=o.match(OG);return e?e[0]:""}const hU=/^[^=?&#]+/,SV=/^[^&#]+/;class T9{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new k0([],{}):new k0([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let i={};this.peekStartsWith("/(")&&(this.capture("/"),i=this.parseParens(!0));let d={};return this.peekStartsWith("(")&&(d=this.parseParens(!1)),(e.length>0||Object.keys(i).length>0)&&(d[v1]=new k0(e,i)),d}parseSegment(){const e=TV(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new vI(gM(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const i=TV(this.remaining);if(!i)return;this.capture(i);let d="";if(this.consumeOptional("=")){const _=TV(this.remaining);_&&(d=_,this.capture(d))}e[gM(i)]=gM(d)}parseQueryParam(e){const i=function u5(o){const e=o.match(hU);return e?e[0]:""}(this.remaining);if(!i)return;this.capture(i);let d="";if(this.consumeOptional("=")){const _t=function jX(o){const e=o.match(SV);return e?e[0]:""}(this.remaining);_t&&(d=_t,this.capture(d))}const _=YR(i),B=YR(d);if(e.hasOwnProperty(_)){let _t=e[_];Array.isArray(_t)||(_t=[_t],e[_]=_t),_t.push(B)}else e[_]=B}parseParens(e){const i={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const d=TV(this.remaining),_=this.remaining[d.length];if("/"!==_&&")"!==_&&";"!==_)throw new Error(`Cannot parse url '${this.url}'`);let B;d.indexOf(":")>-1?(B=d.substr(0,d.indexOf(":")),this.capture(B),this.capture(":")):e&&(B=v1);const _t=this.parseChildren();i[B]=1===Object.keys(_t).length?_t[v1]:new k0([],_t),this.consumeOptional("//")}return i}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class l5{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const i=this.pathFromRoot(e);return i.length>1?i[i.length-2]:null}children(e){const i=RV(e,this._root);return i?i.children.map(d=>d.value):[]}firstChild(e){const i=RV(e,this._root);return i&&i.children.length>0?i.children[0].value:null}siblings(e){const i=M3(e,this._root);return i.length<2?[]:i[i.length-2].children.map(_=>_.value).filter(_=>_!==e)}pathFromRoot(e){return M3(e,this._root).map(i=>i.value)}}function RV(o,e){if(o===e.value)return e;for(const i of e.children){const d=RV(o,i);if(d)return d}return null}function M3(o,e){if(o===e.value)return[e];for(const i of e.children){const d=M3(o,i);if(d.length)return d.unshift(e),d}return[]}class x2{constructor(e,i){this.value=e,this.children=i}toString(){return`TreeNode(${this.value})`}}function B3(o){const e={};return o&&o.children.forEach(i=>e[i.value.outlet]=i),e}class U3 extends l5{constructor(e,i){super(e),this.snapshot=i,h5(this,e)}toString(){return this.snapshot.toString()}}function OV(o,e){const i=function mM(o,e){const _t=new L2([],{},{},"",{},v1,e,null,o.root,-1,{});return new d5("",new x2(_t,[]))}(o,e),d=new WR([new vI("",{})]),_=new WR({}),B=new WR({}),_t=new WR({}),_a=new WR(""),_h=new iN(d,_,_t,_a,B,v1,e,i.root);return _h.snapshot=i.root,new U3(new x2(_h,[]),i)}class iN{constructor(e,i,d,_,B,_t,_a,_h){this.url=e,this.params=i,this.queryParams=d,this.fragment=_,this.data=B,this.outlet=_t,this.component=_a,this._futureSnapshot=_h}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,RI.U)(e=>fL(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,RI.U)(e=>fL(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function S9(o,e="emptyOnly"){const i=o.pathFromRoot;let d=0;if("always"!==e)for(d=i.length-1;d>=1;){const _=i[d],B=i[d-1];if(_.routeConfig&&""===_.routeConfig.path)d--;else{if(B.component)break;d--}}return function R9(o){return o.reduce((e,i)=>({params:Object.assign(Object.assign({},e.params),i.params),data:Object.assign(Object.assign({},e.data),i.data),resolve:Object.assign(Object.assign({},e.resolve),i._resolvedData)}),{params:{},data:{},resolve:{}})}(i.slice(d))}class L2{constructor(e,i,d,_,B,_t,_a,_h,_g,l_,f_){this.url=e,this.params=i,this.queryParams=d,this.fragment=_,this.data=B,this.outlet=_t,this.component=_a,this.routeConfig=_h,this._urlSegment=_g,this._lastPathIndex=l_,this._resolve=f_}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=fL(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=fL(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(d=>d.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class d5 extends l5{constructor(e,i){super(i),this.url=e,h5(this,i)}toString(){return fU(this._root)}}function h5(o,e){e.value._routerState=o,e.children.forEach(i=>h5(o,i))}function fU(o){const e=o.children.length>0?` { ${o.children.map(fU).join(", ")} } `:"";return`${o.value}${e}`}function xP(o){if(o.snapshot){const e=o.snapshot,i=o._futureSnapshot;o.snapshot=i,MO(e.queryParams,i.queryParams)||o.queryParams.next(i.queryParams),e.fragment!==i.fragment&&o.fragment.next(i.fragment),MO(e.params,i.params)||o.params.next(i.params),function D2(o,e){if(o.length!==e.length)return!1;for(let i=0;i<o.length;++i)if(!MO(o[i],e[i]))return!1;return!0}(e.url,i.url)||o.url.next(i.url),MO(e.data,i.data)||o.data.next(i.data)}else o.snapshot=o._futureSnapshot,o.data.next(o._futureSnapshot.data)}function oN(o,e){const i=MO(o.params,e.params)&&function SI(o,e){return jI(o,e)&&o.every((i,d)=>MO(i.parameters,e[d].parameters))}(o.url,e.url);return i&&!(!o.parent!=!e.parent)&&(!o.parent||oN(o.parent,e.parent))}function gU(o,e,i){if(i&&o.shouldReuseRoute(e.value,i.value.snapshot)){const d=i.value;d._futureSnapshot=e.value;const _=function DG(o,e,i){return e.children.map(d=>{for(const _ of i.children)if(o.shouldReuseRoute(d.value,_.value.snapshot))return gU(o,d,_);return gU(o,d)})}(o,e,i);return new x2(d,_)}{if(o.shouldAttach(e.value)){const B=o.retrieve(e.value);if(null!==B){const _t=B.route;return _t.value._futureSnapshot=e.value,_t.children=e.children.map(_a=>gU(o,_a)),_t}}const d=function NG(o){return new iN(new WR(o.url),new WR(o.params),new WR(o.queryParams),new WR(o.fragment),new WR(o.data),o.outlet,o.component,o)}(e.value),_=e.children.map(B=>gU(o,B));return new x2(d,_)}}function gO(o){return"object"==typeof o&&null!=o&&!o.outlets&&!o.segmentPath}function LP(o){return"object"==typeof o&&null!=o&&o.outlets}function F3(o,e,i,d,_){let B={};if(d&&pT(d,(_a,_h)=>{B[_h]=Array.isArray(_a)?_a.map(_g=>`${_g}`):`${_a}`}),o===e)return new E0(i,B,_);const _t=D9(o,e,i);return new E0(_t,B,_)}function D9(o,e,i){const d={};return pT(o.children,(_,B)=>{d[B]=_===e?i:D9(_,e,i)}),new k0(o.segments,d)}class mL{constructor(e,i,d){if(this.isAbsolute=e,this.numberOfDoubleDots=i,this.commands=d,e&&d.length>0&&gO(d[0]))throw new Error("Root segment cannot have matrix parameters");const _=d.find(LP);if(_&&_!==nN(d))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class f5{constructor(e,i,d){this.segmentGroup=e,this.processChildren=i,this.index=d}}function P9(o,e,i){if(o||(o=new k0([],{})),0===o.segments.length&&o.hasChildren())return j3(o,e,i);const d=function x9(o,e,i){let d=0,_=e;const B={match:!1,pathIndex:0,commandIndex:0};for(;_<o.segments.length;){if(d>=i.length)return B;const _t=o.segments[_],_a=i[d];if(LP(_a))break;const _h=`${_a}`,_g=d<i.length-1?i[d+1]:null;if(_>0&&void 0===_h)break;if(_h&&_g&&"object"==typeof _g&&void 0===_g.outlets){if(!DV(_h,_g,_t))return B;d+=2}else{if(!DV(_h,{},_t))return B;d++}_++}return{match:!0,pathIndex:_,commandIndex:d}}(o,e,i),_=i.slice(d.commandIndex);if(d.match&&d.pathIndex<o.segments.length){const B=new k0(o.segments.slice(0,d.pathIndex),{});return B.children[v1]=new k0(o.segments.slice(d.pathIndex),o.children),j3(B,0,_)}return d.match&&0===_.length?new k0(o.segments,{}):d.match&&!o.hasChildren()?L9(o,e,i):d.match?j3(o,0,_):L9(o,e,i)}function j3(o,e,i){if(0===i.length)return new k0(o.segments,{});{const d=function k9(o){return LP(o[0])?o[0].outlets:{[v1]:o}}(i),_={};return pT(d,(B,_t)=>{"string"==typeof B&&(B=[B]),null!==B&&(_[_t]=P9(o.children[_t],e,B))}),pT(o.children,(B,_t)=>{void 0===d[_t]&&(_[_t]=B)}),new k0(o.segments,_)}}function L9(o,e,i){const d=o.segments.slice(0,e);let _=0;for(;_<i.length;){const B=i[_];if(LP(B)){const _h=AM(B.outlets);return new k0(d,_h)}if(0===_&&gO(i[0])){d.push(new vI(o.segments[e].path,AL(i[0]))),_++;continue}const _t=LP(B)?B.outlets[v1]:`${B}`,_a=_<i.length-1?i[_+1]:null;_t&&_a&&gO(_a)?(d.push(new vI(_t,AL(_a))),_+=2):(d.push(new vI(_t,{})),_++)}return new k0(d,{})}function AM(o){const e={};return pT(o,(i,d)=>{"string"==typeof i&&(i=[i]),null!==i&&(e[d]=L9(new k0([],{}),0,i))}),e}function AL(o){const e={};return pT(o,(i,d)=>e[d]=`${i}`),e}function DV(o,e,i){return o==i.path&&MO(e,i.parameters)}class p5{constructor(e,i,d,_){this.routeReuseStrategy=e,this.futureState=i,this.currState=d,this.forwardEvent=_}activate(e){const i=this.futureState._root,d=this.currState?this.currState._root:null;this.deactivateChildRoutes(i,d,e),xP(this.futureState.root),this.activateChildRoutes(i,d,e)}deactivateChildRoutes(e,i,d){const _=B3(i);e.children.forEach(B=>{const _t=B.value.outlet;this.deactivateRoutes(B,_[_t],d),delete _[_t]}),pT(_,(B,_t)=>{this.deactivateRouteAndItsChildren(B,d)})}deactivateRoutes(e,i,d){const _=e.value,B=i?i.value:null;if(_===B)if(_.component){const _t=d.getContext(_.outlet);_t&&this.deactivateChildRoutes(e,i,_t.children)}else this.deactivateChildRoutes(e,i,d);else B&&this.deactivateRouteAndItsChildren(i,d)}deactivateRouteAndItsChildren(e,i){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,i):this.deactivateRouteAndOutlet(e,i)}detachAndStoreRouteSubtree(e,i){const d=i.getContext(e.value.outlet),_=d&&e.value.component?d.children:i,B=B3(e);for(const _t of Object.keys(B))this.deactivateRouteAndItsChildren(B[_t],_);if(d&&d.outlet){const _t=d.outlet.detach(),_a=d.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:_t,route:e,contexts:_a})}}deactivateRouteAndOutlet(e,i){const d=i.getContext(e.value.outlet),_=d&&e.value.component?d.children:i,B=B3(e);for(const _t of Object.keys(B))this.deactivateRouteAndItsChildren(B[_t],_);d&&d.outlet&&(d.outlet.deactivate(),d.children.onOutletDeactivated(),d.attachRef=null,d.resolver=null,d.route=null)}activateChildRoutes(e,i,d){const _=B3(i);e.children.forEach(B=>{this.activateRoutes(B,_[B.value.outlet],d),this.forwardEvent(new R2(B.value.snapshot))}),e.children.length&&this.forwardEvent(new T2(e.value.snapshot))}activateRoutes(e,i,d){const _=e.value,B=i?i.value:null;if(xP(_),_===B)if(_.component){const _t=d.getOrCreateContext(_.outlet);this.activateChildRoutes(e,i,_t.children)}else this.activateChildRoutes(e,i,d);else if(_.component){const _t=d.getOrCreateContext(_.outlet);if(this.routeReuseStrategy.shouldAttach(_.snapshot)){const _a=this.routeReuseStrategy.retrieve(_.snapshot);this.routeReuseStrategy.store(_.snapshot,null),_t.children.onOutletReAttached(_a.contexts),_t.attachRef=_a.componentRef,_t.route=_a.route.value,_t.outlet&&_t.outlet.attach(_a.componentRef,_a.route.value),xP(_a.route.value),this.activateChildRoutes(e,null,_t.children)}else{const _a=function V3(o){for(let e=o.parent;e;e=e.parent){const i=e.routeConfig;if(i&&i._loadedConfig)return i._loadedConfig;if(i&&i.component)return null}return null}(_.snapshot),_h=_a?_a.module.componentFactoryResolver:null;_t.attachRef=null,_t.route=_,_t.resolver=_h,_t.outlet&&_t.outlet.activateWith(_,_h),this.activateChildRoutes(e,null,_t.children)}}else this.activateChildRoutes(e,null,d)}}class g5{constructor(e,i){this.routes=e,this.module=i}}function _L(o){return"function"==typeof o}function G3(o){return o instanceof E0}const H3=Symbol("INITIAL_VALUE");function m5(){return HT(o=>function uM(...o){const e=(0,sM.yG)(o),i=(0,sM.jO)(o),{args:d,keys:_}=tS(o);if(0===d.length)return(0,uT.D)([],e);const B=new LT.y(function SP(o,e,i=tN.y){return d=>{uS(e,()=>{const{length:_}=o,B=new Array(_);let _t=_,_a=_;for(let _h=0;_h<_;_h++)uS(e,()=>{const _g=(0,uT.D)(o[_h],e);let l_=!1;_g.subscribe((0,nS.x)(d,f_=>{B[_h]=f_,l_||(l_=!0,_a--),_a||d.next(i(B.slice()))},()=>{--_t||d.complete()}))},d)},d)}}(d,e,_?_t=>uL(_,_t):tN.y));return i?B.pipe(D3(i)):B}(o.map(e=>e.pipe((0,hL.q)(1),GN(H3)))).pipe(xO((e,i)=>{let d=!1;return i.reduce((_,B,_t)=>_!==H3?_:(B===H3&&(d=!0),d||!1!==B&&_t!==i.length-1&&!G3(B)?_:B),e)},H3),zS(e=>e!==H3),(0,RI.U)(e=>G3(e)?e:!0===e),(0,hL.q)(1)))}class LG{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new mU,this.attachRef=null}}class mU{constructor(){this.contexts=new Map}onChildOutletCreated(e,i){const d=this.getOrCreateContext(e);d.outlet=i,this.contexts.set(e,d)}onChildOutletDestroyed(e){const i=this.getContext(e);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let i=this.getContext(e);return i||(i=new LG,this.contexts.set(e,i)),i}getContext(e){return this.contexts.get(e)||null}}let A5=(()=>{class o{constructor(i,d,_,B,_t){this.parentContexts=i,this.location=d,this.resolver=_,this.changeDetector=_t,this.activated=null,this._activatedRoute=null,this.activateEvents=new f.vpe,this.deactivateEvents=new f.vpe,this.attachEvents=new f.vpe,this.detachEvents=new f.vpe,this.name=B||v1,i.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const i=this.parentContexts.getContext(this.name);i&&i.route&&(i.attachRef?this.attach(i.attachRef,i.route):this.activateWith(i.route,i.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const i=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(i.instance),i}attach(i,d){this.activated=i,this._activatedRoute=d,this.location.insert(i.hostView),this.attachEvents.emit(i.instance)}deactivate(){if(this.activated){const i=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(i)}}activateWith(i,d){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=i;const _t=(d=d||this.resolver).resolveComponentFactory(i._futureSnapshot.routeConfig.component),_a=this.parentContexts.getOrCreateContext(this.name).children,_h=new mY(i,_a,this.location.injector);this.activated=this.location.createComponent(_t,this.location.length,_h),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return o.\u0275fac=function(i){return new(i||o)(f.Y36(mU),f.Y36(f.s_b),f.Y36(f._Vd),f.$8M("name"),f.Y36(f.sBO))},o.\u0275dir=f.lG2({type:o,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),o})();class mY{constructor(e,i,d){this.route=e,this.childContexts=i,this.parent=d}get(e,i){return e===iN?this.route:e===mU?this.childContexts:this.parent.get(e,i)}}let _5=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=f.Xpm({type:o,selectors:[["ng-component"]],decls:1,vars:0,template:function(i,d){1&i&&f._UZ(0,"router-outlet")},directives:[A5],encapsulation:2}),o})();function aN(o,e=""){for(let i=0;i<o.length;i++){const d=o[i];q3(d,MP(e,d))}}function q3(o,e){o.children&&aN(o.children,e)}function MP(o,e){return e?o||e.path?o&&!e.path?`${o}/`:!o&&e.path?e.path:`${o}/${e.path}`:"":o}function _M(o){const e=o.children&&o.children.map(_M),i=e?Object.assign(Object.assign({},o),{children:e}):Object.assign({},o);return!i.component&&(e||i.loadChildren)&&i.outlet&&i.outlet!==v1&&(i.component=_5),i}function JR(o){return o.outlet||v1}function iS(o,e){const i=o.filter(d=>JR(d)===e);return i.push(...o.filter(d=>JR(d)!==e)),i}const kV={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function PV(o,e,i){var d;if(""===e.path)return"full"===e.pathMatch&&(o.hasChildren()||i.length>0)?Object.assign({},kV):{matched:!0,consumedSegments:[],remainingSegments:i,parameters:{},positionalParamSegments:{}};const B=(e.matcher||w9)(i,o,e);if(!B)return Object.assign({},kV);const _t={};pT(B.posParams,(_h,_g)=>{_t[_g]=_h.path});const _a=B.consumed.length>0?Object.assign(Object.assign({},_t),B.consumed[B.consumed.length-1].parameters):_t;return{matched:!0,consumedSegments:B.consumed,remainingSegments:i.slice(B.consumed.length),parameters:_a,positionalParamSegments:null!==(d=B.posParams)&&void 0!==d?d:{}}}function AU(o,e,i,d,_="corrected"){if(i.length>0&&function AY(o,e,i){return i.some(d=>_U(o,e,d)&&JR(d)!==v1)}(o,i,d)){const _t=new k0(e,function v5(o,e,i,d){const _={};_[v1]=d,d._sourceSegment=o,d._segmentIndexShift=e.length;for(const B of i)if(""===B.path&&JR(B)!==v1){const _t=new k0([],{});_t._sourceSegment=o,_t._segmentIndexShift=e.length,_[JR(B)]=_t}return _}(o,e,d,new k0(i,o.children)));return _t._sourceSegment=o,_t._segmentIndexShift=e.length,{segmentGroup:_t,slicedSegments:[]}}if(0===i.length&&function _Y(o,e,i){return i.some(d=>_U(o,e,d))}(o,i,d)){const _t=new k0(o.segments,function xV(o,e,i,d,_,B){const _t={};for(const _a of d)if(_U(o,i,_a)&&!_[JR(_a)]){const _h=new k0([],{});_h._sourceSegment=o,_h._segmentIndexShift="legacy"===B?o.segments.length:e.length,_t[JR(_a)]=_h}return Object.assign(Object.assign({},_),_t)}(o,e,i,d,o.children,_));return _t._sourceSegment=o,_t._segmentIndexShift=e.length,{segmentGroup:_t,slicedSegments:i}}const B=new k0(o.segments,o.children);return B._sourceSegment=o,B._segmentIndexShift=e.length,{segmentGroup:B,slicedSegments:i}}function _U(o,e,i){return(!(o.hasChildren()||e.length>0)||"full"!==i.pathMatch)&&""===i.path}function MG(o,e,i,d){return!!(JR(o)===d||d!==v1&&_U(e,i,o))&&("**"===o.path||PV(e,o,i).matched)}function B9(o,e,i){return 0===e.length&&!o.children[i]}class BG{constructor(e){this.segmentGroup=e||null}}class vU{constructor(e){this.urlTree=e}}function hS(o){return RP(new BG(o))}function LV(o){return RP(new vU(o))}class W3{constructor(e,i,d,_,B){this.configLoader=i,this.urlSerializer=d,this.urlTree=_,this.config=B,this.allowRedirects=!0,this.ngModule=e.get(f.h0i)}apply(){const e=AU(this.urlTree.root,[],[],this.config).segmentGroup,i=new k0(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,i,v1).pipe((0,RI.U)(B=>this.createUrlTree(I5(B),this.urlTree.queryParams,this.urlTree.fragment))).pipe(aR(B=>{if(B instanceof vU)return this.allowRedirects=!1,this.match(B.urlTree);throw B instanceof BG?this.noMatchError(B):B}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,v1).pipe((0,RI.U)(_=>this.createUrlTree(I5(_),e.queryParams,e.fragment))).pipe(aR(_=>{throw _ instanceof BG?this.noMatchError(_):_}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,i,d){const _=e.segments.length>0?new k0([],{[v1]:e}):e;return new E0(_,i,d)}expandSegmentGroup(e,i,d,_){return 0===d.segments.length&&d.hasChildren()?this.expandChildren(e,i,d).pipe((0,RI.U)(B=>new k0([],B))):this.expandSegment(e,d,i,d.segments,_,!0)}expandChildren(e,i,d){const _=[];for(const B of Object.keys(d.children))"primary"===B?_.unshift(B):_.push(B);return(0,uT.D)(_).pipe(LO(B=>{const _t=d.children[B],_a=iS(i,B);return this.expandSegmentGroup(e,_a,_t,B).pipe((0,RI.U)(_h=>({segment:_h,outlet:B})))}),xO((B,_t)=>(B[_t.outlet]=_t.segment,B),{}),function gY(o,e){const i=arguments.length>=2;return d=>d.pipe(o?zS((_,B)=>o(_,B,d)):tN.y,k3(1),i?TG(e):i5(()=>new OP))}())}expandSegment(e,i,d,_,B,_t){return(0,uT.D)(d).pipe(LO(_a=>this.expandSegmentAgainstRoute(e,i,d,_a,_,B,_t).pipe(aR(_g=>{if(_g instanceof BG)return hI(null);throw _g}))),dM(_a=>!!_a),aR((_a,_h)=>{if(_a instanceof OP||"EmptyError"===_a.name)return B9(i,_,B)?hI(new k0([],{})):hS(i);throw _a}))}expandSegmentAgainstRoute(e,i,d,_,B,_t,_a){return MG(_,i,B,_t)?void 0===_.redirectTo?this.matchSegmentAgainstRoute(e,i,_,B,_t):_a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,i,d,_,B,_t):hS(i):hS(i)}expandSegmentAgainstRouteUsingRedirect(e,i,d,_,B,_t){return"**"===_.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,d,_,_t):this.expandRegularSegmentAgainstRouteUsingRedirect(e,i,d,_,B,_t)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,d,_){const B=this.applyRedirectCommands([],d.redirectTo,{});return d.redirectTo.startsWith("/")?LV(B):this.lineralizeSegments(d,B).pipe((0,OS.z)(_t=>{const _a=new k0(_t,{});return this.expandSegment(e,_a,i,_t,_,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,i,d,_,B,_t){const{matched:_a,consumedSegments:_h,remainingSegments:_g,positionalParamSegments:l_}=PV(i,_,B);if(!_a)return hS(i);const f_=this.applyRedirectCommands(_h,_.redirectTo,l_);return _.redirectTo.startsWith("/")?LV(f_):this.lineralizeSegments(_,f_).pipe((0,OS.z)(R_=>this.expandSegment(e,i,d,R_.concat(_g),_t,!1)))}matchSegmentAgainstRoute(e,i,d,_,B){if("**"===d.path)return d.loadChildren?(d._loadedConfig?hI(d._loadedConfig):this.configLoader.load(e.injector,d)).pipe((0,RI.U)(f_=>(d._loadedConfig=f_,new k0(_,{})))):hI(new k0(_,{}));const{matched:_t,consumedSegments:_a,remainingSegments:_h}=PV(i,d,_);return _t?this.getChildConfig(e,d,_).pipe((0,OS.z)(l_=>{const f_=l_.module,R_=l_.routes,{segmentGroup:H_,slicedSegments:W_}=AU(i,_a,_h,R_),R0=new k0(H_.segments,H_.children);if(0===W_.length&&R0.hasChildren())return this.expandChildren(f_,R_,R0).pipe((0,RI.U)(xI=>new k0(_a,xI)));if(0===R_.length&&0===W_.length)return hI(new k0(_a,{}));const H0=JR(d)===B;return this.expandSegment(f_,R0,R_,W_,H0?v1:B,!0).pipe((0,RI.U)(LI=>new k0(_a.concat(LI.segments),LI.children)))})):hS(i)}getChildConfig(e,i,d){return i.children?hI(new g5(i.children,e)):i.loadChildren?void 0!==i._loadedConfig?hI(i._loadedConfig):this.runCanLoadGuards(e.injector,i,d).pipe((0,OS.z)(_=>_?this.configLoader.load(e.injector,i).pipe((0,RI.U)(B=>(i._loadedConfig=B,B))):function y5(o){return RP(pM(`Cannot load children because the guard of the route "path: '${o.path}'" returned false`))}(i))):hI(new g5([],e))}runCanLoadGuards(e,i,d){const _=i.canLoad;return _&&0!==_.length?hI(_.map(_t=>{const _a=e.get(_t);let _h;if(function VX(o){return o&&_L(o.canLoad)}(_a))_h=_a.canLoad(i,d);else{if(!_L(_a))throw new Error("Invalid CanLoad guard");_h=_a(i,d)}return DS(_h)})).pipe(m5(),(0,pO.b)(_t=>{if(!G3(_t))return;const _a=pM(`Redirecting to "${this.urlSerializer.serialize(_t)}"`);throw _a.url=_t,_a}),(0,RI.U)(_t=>!0===_t)):hI(!0)}lineralizeSegments(e,i){let d=[],_=i.root;for(;;){if(d=d.concat(_.segments),0===_.numberOfChildren)return hI(d);if(_.numberOfChildren>1||!_.children[v1])return RP(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e.redirectTo}'`));_=_.children[v1]}}applyRedirectCommands(e,i,d){return this.applyRedirectCreatreUrlTree(i,this.urlSerializer.parse(i),e,d)}applyRedirectCreatreUrlTree(e,i,d,_){const B=this.createSegmentGroup(e,i.root,d,_);return new E0(B,this.createQueryParams(i.queryParams,this.urlTree.queryParams),i.fragment)}createQueryParams(e,i){const d={};return pT(e,(_,B)=>{if("string"==typeof _&&_.startsWith(":")){const _a=_.substring(1);d[B]=i[_a]}else d[B]=_}),d}createSegmentGroup(e,i,d,_){const B=this.createSegments(e,i.segments,d,_);let _t={};return pT(i.children,(_a,_h)=>{_t[_h]=this.createSegmentGroup(e,_a,d,_)}),new k0(B,_t)}createSegments(e,i,d,_){return i.map(B=>B.path.startsWith(":")?this.findPosParam(e,B,_):this.findOrReturn(B,d))}findPosParam(e,i,d){const _=d[i.path.substring(1)];if(!_)throw new Error(`Cannot redirect to '${e}'. Cannot find '${i.path}'.`);return _}findOrReturn(e,i){let d=0;for(const _ of i){if(_.path===e.path)return i.splice(d),_;d++}return e}}function I5(o){const e={};for(const d of Object.keys(o.children)){const B=I5(o.children[d]);(B.segments.length>0||B.hasChildren())&&(e[d]=B)}return function E5(o){if(1===o.numberOfChildren&&o.children[v1]){const e=o.children[v1];return new k0(o.segments.concat(e.segments),e.children)}return o}(new k0(o.segments,e))}class uR{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class vL{constructor(e,i){this.component=e,this.route=i}}function FG(o,e,i){const d=o._root;return b5(d,e?e._root:null,i,[d.value])}function vM(o,e,i){const d=function jG(o){if(!o)return null;for(let e=o.parent;e;e=e.parent){const i=e.routeConfig;if(i&&i._loadedConfig)return i._loadedConfig}return null}(e);return(d?d.module.injector:i).get(o)}function b5(o,e,i,d,_={canDeactivateChecks:[],canActivateChecks:[]}){const B=B3(e);return o.children.forEach(_t=>{(function UP(o,e,i,d,_={canDeactivateChecks:[],canActivateChecks:[]}){const B=o.value,_t=e?e.value:null,_a=i?i.getContext(o.value.outlet):null;if(_t&&B.routeConfig===_t.routeConfig){const _h=function FP(o,e,i){if("function"==typeof i)return i(o,e);switch(i){case"pathParamsChange":return!jI(o.url,e.url);case"pathParamsOrQueryParamsChange":return!jI(o.url,e.url)||!MO(o.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!oN(o,e)||!MO(o.queryParams,e.queryParams);default:return!oN(o,e)}}(_t,B,B.routeConfig.runGuardsAndResolvers);_h?_.canActivateChecks.push(new uR(d)):(B.data=_t.data,B._resolvedData=_t._resolvedData),b5(o,e,B.component?_a?_a.children:null:i,d,_),_h&&_a&&_a.outlet&&_a.outlet.isActivated&&_.canDeactivateChecks.push(new vL(_a.outlet.component,_t))}else _t&&$R(e,_a,_),_.canActivateChecks.push(new uR(d)),b5(o,null,B.component?_a?_a.children:null:i,d,_)})(_t,B[_t.value.outlet],i,d.concat([_t.value]),_),delete B[_t.value.outlet]}),pT(B,(_t,_a)=>$R(_t,i.getContext(_a),_)),_}function $R(o,e,i){const d=B3(o),_=o.value;pT(d,(B,_t)=>{$R(B,_.component?e?e.children.getContext(_t):null:e,i)}),i.canDeactivateChecks.push(new vL(_.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,_))}class F9{}function mO(o){return new LT.y(e=>e.error(o))}class QG{constructor(e,i,d,_,B,_t){this.rootComponentType=e,this.config=i,this.urlTree=d,this.url=_,this.paramsInheritanceStrategy=B,this.relativeLinkResolution=_t}recognize(){const e=AU(this.urlTree.root,[],[],this.config.filter(_t=>void 0===_t.redirectTo),this.relativeLinkResolution).segmentGroup,i=this.processSegmentGroup(this.config,e,v1);if(null===i)return null;const d=new L2([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},v1,this.rootComponentType,null,this.urlTree.root,-1,{}),_=new x2(d,i),B=new d5(this.url,_);return this.inheritParamsAndData(B._root),B}inheritParamsAndData(e){const i=e.value,d=S9(i,this.paramsInheritanceStrategy);i.params=Object.freeze(d.params),i.data=Object.freeze(d.data),e.children.forEach(_=>this.inheritParamsAndData(_))}processSegmentGroup(e,i,d){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,i):this.processSegment(e,i,i.segments,d)}processChildren(e,i){const d=[];for(const B of Object.keys(i.children)){const _t=i.children[B],_a=iS(e,B),_h=this.processSegmentGroup(_a,_t,B);if(null===_h)return null;d.push(..._h)}const _=V9(d);return function HG(o){o.sort((e,i)=>e.value.outlet===v1?-1:i.value.outlet===v1?1:e.value.outlet.localeCompare(i.value.outlet))}(_),_}processSegment(e,i,d,_){for(const B of e){const _t=this.processSegmentAgainstRoute(B,i,d,_);if(null!==_t)return _t}return B9(i,d,_)?[]:null}processSegmentAgainstRoute(e,i,d,_){if(e.redirectTo||!MG(e,i,d,_))return null;let B,_t=[],_a=[];if("**"===e.path){const H_=d.length>0?nN(d).parameters:{};B=new L2(d,H_,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Nf(e),JR(e),e.component,e,G9(i),HN(i)+d.length,_c(e))}else{const H_=PV(i,e,d);if(!H_.matched)return null;_t=H_.consumedSegments,_a=H_.remainingSegments,B=new L2(_t,H_.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Nf(e),JR(e),e.component,e,G9(i),HN(i)+_t.length,_c(e))}const _h=function j9(o){return o.children?o.children:o.loadChildren?o._loadedConfig.routes:[]}(e),{segmentGroup:_g,slicedSegments:l_}=AU(i,_t,_a,_h.filter(H_=>void 0===H_.redirectTo),this.relativeLinkResolution);if(0===l_.length&&_g.hasChildren()){const H_=this.processChildren(_h,_g);return null===H_?null:[new x2(B,H_)]}if(0===_h.length&&0===l_.length)return[new x2(B,[])];const f_=JR(e)===_,R_=this.processSegment(_h,_g,l_,f_?v1:_);return null===R_?null:[new x2(B,R_)]}}function UV(o){const e=o.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function V9(o){const e=[],i=new Set;for(const d of o){if(!UV(d)){e.push(d);continue}const _=e.find(B=>d.value.routeConfig===B.value.routeConfig);void 0!==_?(_.children.push(...d.children),i.add(_)):e.push(d)}for(const d of i){const _=V9(d.children);e.push(new x2(d.value,_))}return e.filter(d=>!i.has(d))}function G9(o){let e=o;for(;e._sourceSegment;)e=e._sourceSegment;return e}function HN(o){let e=o,i=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,i+=e._segmentIndexShift?e._segmentIndexShift:0;return i-1}function Nf(o){return o.data||{}}function _c(o){return o.resolve||{}}function s0(o){return[...Object.keys(o),...Object.getOwnPropertySymbols(o)]}function tI(o){return HT(e=>{const i=o(e);return i?(0,uT.D)(i).pipe((0,RI.U)(()=>e)):hI(e)})}class GI extends class VI{shouldDetach(e){return!1}store(e,i){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,i){return e.routeConfig===i.routeConfig}}{}const oS=new f.OlP("ROUTES");class FO{constructor(e,i,d,_){this.injector=e,this.compiler=i,this.onLoadStartListener=d,this.onLoadEndListener=_}load(e,i){if(i._loader$)return i._loader$;this.onLoadStartListener&&this.onLoadStartListener(i);const _=this.loadModuleFactory(i.loadChildren).pipe((0,RI.U)(B=>{this.onLoadEndListener&&this.onLoadEndListener(i);const _t=B.create(e);return new g5(IV(_t.injector.get(oS,void 0,f.XFs.Self|f.XFs.Optional)).map(_M),_t)}),aR(B=>{throw i._loader$=void 0,B}));return i._loader$=new kP(_,()=>new xT.x).pipe(N3()),i._loader$}loadModuleFactory(e){return DS(e()).pipe((0,OS.z)(i=>i instanceof f.YKP?hI(i):(0,uT.D)(this.compiler.compileModuleAsync(i))))}}class FV{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,i){return e}}function qG(o){throw o}function yU(o,e,i){return e.parse("/")}function T5(o,e){return hI(null)}const OT={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},S5={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let qT=(()=>{class o{constructor(i,d,_,B,_t,_a,_h){this.rootComponentType=i,this.urlSerializer=d,this.rootContexts=_,this.location=B,this.config=_h,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new xT.x,this.errorHandler=qG,this.malformedUriErrorHandler=yU,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:T5,afterPreactivation:T5},this.urlHandlingStrategy=new FV,this.routeReuseStrategy=new GI,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=_t.get(f.h0i),this.console=_t.get(f.c2e);const f_=_t.get(f.R0b);this.isNgZoneEnabled=f_ instanceof f.R0b&&f.R0b.isInAngularZone(),this.resetConfig(_h),this.currentUrlTree=function a5(){return new E0(new k0([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new FO(_t,_a,R_=>this.triggerEvent(new KR(R_)),R_=>this.triggerEvent(new hM(R_))),this.routerState=OV(this.currentUrlTree,this.rootComponentType),this.transitions=new WR({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var i;return null===(i=this.location.getState())||void 0===i?void 0:i.\u0275routerPageId}setupNavigations(i){const d=this.events;return i.pipe(zS(_=>0!==_.id),(0,RI.U)(_=>Object.assign(Object.assign({},_),{extractedUrl:this.urlHandlingStrategy.extract(_.rawUrl)})),HT(_=>{let B=!1,_t=!1;return hI(_).pipe((0,pO.b)(_a=>{this.currentNavigation={id:_a.id,initialUrl:_a.currentRawUrl,extractedUrl:_a.extractedUrl,trigger:_a.source,extras:_a.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),HT(_a=>{const _h=this.browserUrlTree.toString(),_g=!this.navigated||_a.extractedUrl.toString()!==_h||_h!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||_g)&&this.urlHandlingStrategy.shouldProcessUrl(_a.rawUrl))return WG(_a.source)&&(this.browserUrlTree=_a.extractedUrl),hI(_a).pipe(HT(f_=>{const R_=this.transitions.getValue();return d.next(new o5(f_.id,this.serializeUrl(f_.extractedUrl),f_.source,f_.restoredState)),R_!==this.transitions.getValue()?b2.E:Promise.resolve(f_)}),function vY(o,e,i,d){return HT(_=>function kS(o,e,i,d,_){return new W3(o,e,i,d,_).apply()}(o,e,i,_.extractedUrl,d).pipe((0,RI.U)(B=>Object.assign(Object.assign({},_),{urlAfterRedirects:B}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,pO.b)(f_=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:f_.urlAfterRedirects})}),function ah(o,e,i,d,_){return(0,OS.z)(B=>function w5(o,e,i,d,_="emptyOnly",B="legacy"){try{const _t=new QG(o,e,i,d,_,B).recognize();return null===_t?mO(new F9):hI(_t)}catch(_t){return mO(_t)}}(o,e,B.urlAfterRedirects,i(B.urlAfterRedirects),d,_).pipe((0,RI.U)(_t=>Object.assign(Object.assign({},B),{targetSnapshot:_t}))))}(this.rootComponentType,this.config,f_=>this.serializeUrl(f_),this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,pO.b)(f_=>{if("eager"===this.urlUpdateStrategy){if(!f_.extras.skipLocationChange){const H_=this.urlHandlingStrategy.merge(f_.urlAfterRedirects,f_.rawUrl);this.setBrowserUrl(H_,f_)}this.browserUrlTree=f_.urlAfterRedirects}const R_=new dU(f_.id,this.serializeUrl(f_.extractedUrl),this.serializeUrl(f_.urlAfterRedirects),f_.targetSnapshot);d.next(R_)}));if(_g&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:R_,extractedUrl:H_,source:W_,restoredState:R0,extras:H0}=_a,CI=new o5(R_,this.serializeUrl(H_),W_,R0);d.next(CI);const LI=OV(H_,this.rootComponentType).snapshot;return hI(Object.assign(Object.assign({},_a),{targetSnapshot:LI,urlAfterRedirects:H_,extras:Object.assign(Object.assign({},H0),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=_a.rawUrl,_a.resolve(null),b2.E}),tI(_a=>{const{targetSnapshot:_h,id:_g,extractedUrl:l_,rawUrl:f_,extras:{skipLocationChange:R_,replaceUrl:H_}}=_a;return this.hooks.beforePreactivation(_h,{navigationId:_g,appliedUrlTree:l_,rawUrlTree:f_,skipLocationChange:!!R_,replaceUrl:!!H_})}),(0,pO.b)(_a=>{const _h=new x3(_a.id,this.serializeUrl(_a.extractedUrl),this.serializeUrl(_a.urlAfterRedirects),_a.targetSnapshot);this.triggerEvent(_h)}),(0,RI.U)(_a=>Object.assign(Object.assign({},_a),{guards:FG(_a.targetSnapshot,_a.currentSnapshot,this.rootContexts)})),function C5(o,e){return(0,OS.z)(i=>{const{targetSnapshot:d,currentSnapshot:_,guards:{canActivateChecks:B,canDeactivateChecks:_t}}=i;return 0===_t.length&&0===B.length?hI(Object.assign(Object.assign({},i),{guardsResult:!0})):function VG(o,e,i,d){return(0,uT.D)(o).pipe((0,OS.z)(_=>function BV(o,e,i,d,_){const B=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return B&&0!==B.length?hI(B.map(_a=>{const _h=vM(_a,e,_);let _g;if(function NV(o){return o&&_L(o.canDeactivate)}(_h))_g=DS(_h.canDeactivate(o,e,i,d));else{if(!_L(_h))throw new Error("Invalid CanDeactivate guard");_g=DS(_h(o,e,i,d))}return _g.pipe(dM())})).pipe(m5()):hI(!0)}(_.component,_.route,i,e,d)),dM(_=>!0!==_,!0))}(_t,d,_,o).pipe((0,OS.z)(_a=>_a&&function M9(o){return"boolean"==typeof o}(_a)?function GG(o,e,i,d){return(0,uT.D)(e).pipe(LO(_=>VN(function U9(o,e){return null!==o&&e&&e(new fM(o)),hI(!0)}(_.route.parent,d),function yL(o,e){return null!==o&&e&&e(new S2(o)),hI(!0)}(_.route,d),function MV(o,e,i){const d=e[e.length-1],B=e.slice(0,e.length-1).reverse().map(_t=>function BP(o){const e=o.routeConfig?o.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:o,guards:e}:null}(_t)).filter(_t=>null!==_t).map(_t=>lU(()=>hI(_t.guards.map(_h=>{const _g=vM(_h,_t.node,i);let l_;if(function xG(o){return o&&_L(o.canActivateChild)}(_g))l_=DS(_g.canActivateChild(d,o));else{if(!_L(_g))throw new Error("Invalid CanActivateChild guard");l_=DS(_g(d,o))}return l_.pipe(dM())})).pipe(m5())));return hI(B).pipe(m5())}(o,_.path,i),function UO(o,e,i){const d=e.routeConfig?e.routeConfig.canActivate:null;if(!d||0===d.length)return hI(!0);const _=d.map(B=>lU(()=>{const _t=vM(B,e,i);let _a;if(function Q3(o){return o&&_L(o.canActivate)}(_t))_a=DS(_t.canActivate(e,o));else{if(!_L(_t))throw new Error("Invalid CanActivate guard");_a=DS(_t(e,o))}return _a.pipe(dM())}));return hI(_).pipe(m5())}(o,_.route,i))),dM(_=>!0!==_,!0))}(d,B,o,e):hI(_a)),(0,RI.U)(_a=>Object.assign(Object.assign({},i),{guardsResult:_a})))})}(this.ngModule.injector,_a=>this.triggerEvent(_a)),(0,pO.b)(_a=>{if(G3(_a.guardsResult)){const _g=pM(`Redirecting to "${this.serializeUrl(_a.guardsResult)}"`);throw _g.url=_a.guardsResult,_g}const _h=new EV(_a.id,this.serializeUrl(_a.extractedUrl),this.serializeUrl(_a.urlAfterRedirects),_a.targetSnapshot,!!_a.guardsResult);this.triggerEvent(_h)}),zS(_a=>!!_a.guardsResult||(this.restoreHistory(_a),this.cancelNavigationTransition(_a,""),!1)),tI(_a=>{if(_a.guards.canActivateChecks.length)return hI(_a).pipe((0,pO.b)(_h=>{const _g=new SG(_h.id,this.serializeUrl(_h.extractedUrl),this.serializeUrl(_h.urlAfterRedirects),_h.targetSnapshot);this.triggerEvent(_g)}),HT(_h=>{let _g=!1;return hI(_h).pipe(function _m(o,e){return(0,OS.z)(i=>{const{targetSnapshot:d,guards:{canActivateChecks:_}}=i;if(!_.length)return hI(i);let B=0;return(0,uT.D)(_).pipe(LO(_t=>function m_(o,e,i,d){return function O_(o,e,i,d){const _=s0(o);if(0===_.length)return hI({});const B={};return(0,uT.D)(_).pipe((0,OS.z)(_t=>function N0(o,e,i,d){const _=vM(o,e,d);return DS(_.resolve?_.resolve(e,i):_(e,i))}(o[_t],e,i,d).pipe((0,pO.b)(_a=>{B[_t]=_a}))),k3(1),(0,OS.z)(()=>s0(B).length===_.length?hI(B):b2.E))}(o._resolve,o,e,d).pipe((0,RI.U)(B=>(o._resolvedData=B,o.data=Object.assign(Object.assign({},o.data),S9(o,i).resolve),null)))}(_t.route,d,o,e)),(0,pO.b)(()=>B++),k3(1),(0,OS.z)(_t=>B===_.length?hI(i):b2.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,pO.b)({next:()=>_g=!0,complete:()=>{_g||(this.restoreHistory(_h),this.cancelNavigationTransition(_h,"At least one route resolver didn't emit any value."))}}))}),(0,pO.b)(_h=>{const _g=new yR(_h.id,this.serializeUrl(_h.extractedUrl),this.serializeUrl(_h.urlAfterRedirects),_h.targetSnapshot);this.triggerEvent(_g)}))}),tI(_a=>{const{targetSnapshot:_h,id:_g,extractedUrl:l_,rawUrl:f_,extras:{skipLocationChange:R_,replaceUrl:H_}}=_a;return this.hooks.afterPreactivation(_h,{navigationId:_g,appliedUrlTree:l_,rawUrlTree:f_,skipLocationChange:!!R_,replaceUrl:!!H_})}),(0,RI.U)(_a=>{const _h=function pU(o,e,i){const d=gU(o,e._root,i?i._root:void 0);return new U3(d,e)}(this.routeReuseStrategy,_a.targetSnapshot,_a.currentRouterState);return Object.assign(Object.assign({},_a),{targetRouterState:_h})}),(0,pO.b)(_a=>{this.currentUrlTree=_a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(_a.urlAfterRedirects,_a.rawUrl),this.routerState=_a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(_a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,_a),this.browserUrlTree=_a.urlAfterRedirects)}),((o,e,i)=>(0,RI.U)(d=>(new p5(e,d.targetRouterState,d.currentRouterState,i).activate(o),d)))(this.rootContexts,this.routeReuseStrategy,_a=>this.triggerEvent(_a)),(0,pO.b)({next(){B=!0},complete(){B=!0}}),function yV(o){return(0,rS.e)((e,i)=>{try{e.subscribe(i)}finally{i.add(o)}})}(()=>{var _a;B||_t||this.cancelNavigationTransition(_,`Navigation ID ${_.id} is not equal to the current navigation id ${this.navigationId}`),(null===(_a=this.currentNavigation)||void 0===_a?void 0:_a.id)===_.id&&(this.currentNavigation=null)}),aR(_a=>{if(_t=!0,function pL(o){return o&&o[ER]}(_a)){const _h=G3(_a.url);_h||(this.navigated=!0,this.restoreHistory(_,!0));const _g=new P3(_.id,this.serializeUrl(_.extractedUrl),_a.message);d.next(_g),_h?setTimeout(()=>{const l_=this.urlHandlingStrategy.merge(_a.url,this.rawUrlTree),f_={skipLocationChange:_.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||WG(_.source)};this.scheduleNavigation(l_,"imperative",null,f_,{resolve:_.resolve,reject:_.reject,promise:_.promise})},0):_.resolve(!1)}else{this.restoreHistory(_,!0);const _h=new lS(_.id,this.serializeUrl(_.extractedUrl),_a);d.next(_h);try{_.resolve(this.errorHandler(_a))}catch(_g){_.reject(_g)}}return b2.E}))}))}resetRootComponentType(i){this.rootComponentType=i,this.routerState.root.component=this.rootComponentType}setTransition(i){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),i))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(i=>{const d="popstate"===i.type?"popstate":"hashchange";"popstate"===d&&setTimeout(()=>{var _;const B={replaceUrl:!0},_t=(null===(_=i.state)||void 0===_?void 0:_.navigationId)?i.state:null;if(_t){const _h=Object.assign({},_t);delete _h.navigationId,delete _h.\u0275routerPageId,0!==Object.keys(_h).length&&(B.state=_h)}const _a=this.parseUrl(i.url);this.scheduleNavigation(_a,d,_t,B)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(i){this.events.next(i)}resetConfig(i){aN(i),this.config=i.map(_M),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(i,d={}){const{relativeTo:_,queryParams:B,fragment:_t,queryParamsHandling:_a,preserveFragment:_h}=d,_g=_||this.routerState.root,l_=_h?this.currentUrlTree.fragment:_t;let f_=null;switch(_a){case"merge":f_=Object.assign(Object.assign({},this.currentUrlTree.queryParams),B);break;case"preserve":f_=this.currentUrlTree.queryParams;break;default:f_=B||null}return null!==f_&&(f_=this.removeEmptyProps(f_)),function O9(o,e,i,d,_){if(0===i.length)return F3(e.root,e.root,e.root,d,_);const B=function N9(o){if("string"==typeof o[0]&&1===o.length&&"/"===o[0])return new mL(!0,0,o);let e=0,i=!1;const d=o.reduce((_,B,_t)=>{if("object"==typeof B&&null!=B){if(B.outlets){const _a={};return pT(B.outlets,(_h,_g)=>{_a[_g]="string"==typeof _h?_h.split("/"):_h}),[..._,{outlets:_a}]}if(B.segmentPath)return[..._,B.segmentPath]}return"string"!=typeof B?[..._,B]:0===_t?(B.split("/").forEach((_a,_h)=>{0==_h&&"."===_a||(0==_h&&""===_a?i=!0:".."===_a?e++:""!=_a&&_.push(_a))}),_):[..._,B]},[]);return new mL(i,e,d)}(i);if(B.toRoot())return F3(e.root,e.root,new k0([],{}),d,_);const _t=function kG(o,e,i){if(o.isAbsolute)return new f5(e.root,!0,0);if(-1===i.snapshot._lastPathIndex){const B=i.snapshot._urlSegment;return new f5(B,B===e.root,0)}const d=gO(o.commands[0])?0:1;return function PG(o,e,i){let d=o,_=e,B=i;for(;B>_;){if(B-=_,d=d.parent,!d)throw new Error("Invalid number of '../'");_=d.segments.length}return new f5(d,!1,_-B)}(i.snapshot._urlSegment,i.snapshot._lastPathIndex+d,o.numberOfDoubleDots)}(B,e,o),_a=_t.processChildren?j3(_t.segmentGroup,_t.index,B.commands):P9(_t.segmentGroup,_t.index,B.commands);return F3(e.root,_t.segmentGroup,_a,d,_)}(_g,this.currentUrlTree,i,f_,null!=l_?l_:null)}navigateByUrl(i,d={skipLocationChange:!1}){const _=G3(i)?i:this.parseUrl(i),B=this.urlHandlingStrategy.merge(_,this.rawUrlTree);return this.scheduleNavigation(B,"imperative",null,d)}navigate(i,d={skipLocationChange:!1}){return function jV(o){for(let e=0;e<o.length;e++){const i=o[e];if(null==i)throw new Error(`The requested path contains ${i} segment at index ${e}`)}}(i),this.navigateByUrl(this.createUrlTree(i,d),d)}serializeUrl(i){return this.urlSerializer.serialize(i)}parseUrl(i){let d;try{d=this.urlSerializer.parse(i)}catch(_){d=this.malformedUriErrorHandler(_,this.urlSerializer,i)}return d}isActive(i,d){let _;if(_=!0===d?Object.assign({},OT):!1===d?Object.assign({},S5):d,G3(i))return gL(this.currentUrlTree,i,_);const B=this.parseUrl(i);return gL(this.currentUrlTree,B,_)}removeEmptyProps(i){return Object.keys(i).reduce((d,_)=>{const B=i[_];return null!=B&&(d[_]=B),d},{})}processNavigations(){this.navigations.subscribe(i=>{this.navigated=!0,this.lastSuccessfulId=i.id,this.currentPageId=i.targetPageId,this.events.next(new w2(i.id,this.serializeUrl(i.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,i.resolve(!0)},i=>{this.console.warn(`Unhandled Navigation Error: ${i}`)})}scheduleNavigation(i,d,_,B,_t){var _a,_h;if(this.disposed)return Promise.resolve(!1);let _g,l_,f_;_t?(_g=_t.resolve,l_=_t.reject,f_=_t.promise):f_=new Promise((W_,R0)=>{_g=W_,l_=R0});const R_=++this.navigationId;let H_;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(_=this.location.getState()),H_=_&&_.\u0275routerPageId?_.\u0275routerPageId:B.replaceUrl||B.skipLocationChange?null!==(_a=this.browserPageId)&&void 0!==_a?_a:0:(null!==(_h=this.browserPageId)&&void 0!==_h?_h:0)+1):H_=0,this.setTransition({id:R_,targetPageId:H_,source:d,restoredState:_,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:i,extras:B,resolve:_g,reject:l_,promise:f_,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f_.catch(W_=>Promise.reject(W_))}setBrowserUrl(i,d){const _=this.urlSerializer.serialize(i),B=Object.assign(Object.assign({},d.extras.state),this.generateNgRouterState(d.id,d.targetPageId));this.location.isCurrentPathEqualTo(_)||d.extras.replaceUrl?this.location.replaceState(_,"",B):this.location.go(_,"",B)}restoreHistory(i,d=!1){var _,B;if("computed"===this.canceledNavigationResolution){const _t=this.currentPageId-i.targetPageId;"popstate"!==i.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(_=this.currentNavigation)||void 0===_?void 0:_.finalUrl)||0===_t?this.currentUrlTree===(null===(B=this.currentNavigation)||void 0===B?void 0:B.finalUrl)&&0===_t&&(this.resetState(i),this.browserUrlTree=i.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(_t)}else"replace"===this.canceledNavigationResolution&&(d&&this.resetState(i),this.resetUrlToCurrentUrlTree())}resetState(i){this.routerState=i.currentRouterState,this.currentUrlTree=i.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(i,d){const _=new P3(i.id,this.serializeUrl(i.extractedUrl),d);this.triggerEvent(_),i.resolve(!1)}generateNgRouterState(i,d){return"computed"===this.canceledNavigationResolution?{navigationId:i,\u0275routerPageId:d}:{navigationId:i}}}return o.\u0275fac=function(i){f.$Z()},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})();function WG(o){return"imperative"!==o}let z3=(()=>{class o{constructor(i,d,_,B,_t){this.router=i,this.route=d,this.tabIndexAttribute=_,this.renderer=B,this.el=_t,this.commands=null,this.onChanges=new xT.x,this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(i){if(null!=this.tabIndexAttribute)return;const d=this.renderer,_=this.el.nativeElement;null!==i?d.setAttribute(_,"tabindex",i):d.removeAttribute(_,"tabindex")}ngOnChanges(i){this.onChanges.next(this)}set routerLink(i){null!=i?(this.commands=Array.isArray(i)?i:[i],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){if(null===this.urlTree)return!0;const i={skipLocationChange:rT(this.skipLocationChange),replaceUrl:rT(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,i),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:rT(this.preserveFragment)})}}return o.\u0275fac=function(i){return new(i||o)(f.Y36(qT),f.Y36(iN),f.$8M("tabindex"),f.Y36(f.Qsj),f.Y36(f.SBq))},o.\u0275dir=f.lG2({type:o,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(i,d){1&i&&f.NdJ("click",function(){return d.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[f.TTD]}),o})();function rT(o){return""===o||!!o}class n1{}class zG{preload(e,i){return hI(null)}}let EY=(()=>{class o{constructor(i,d,_,B){this.router=i,this.injector=_,this.preloadingStrategy=B,this.loader=new FO(_,d,_h=>i.triggerEvent(new KR(_h)),_h=>i.triggerEvent(new hM(_h)))}setUpPreloading(){this.subscription=this.router.events.pipe(zS(i=>i instanceof w2),LO(()=>this.preload())).subscribe(()=>{})}preload(){const i=this.injector.get(f.h0i);return this.processRoutes(i,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(i,d){const _=[];for(const B of d)if(B.loadChildren&&!B.canLoad&&B._loadedConfig){const _t=B._loadedConfig;_.push(this.processRoutes(_t.module,_t.routes))}else B.loadChildren&&!B.canLoad?_.push(this.preloadConfig(i,B)):B.children&&_.push(this.processRoutes(i,B.children));return(0,uT.D)(_).pipe((0,lM.J)(),(0,RI.U)(B=>{}))}preloadConfig(i,d){return this.preloadingStrategy.preload(d,()=>(d._loadedConfig?hI(d._loadedConfig):this.loader.load(i.injector,d)).pipe((0,OS.z)(B=>(d._loadedConfig=B,this.processRoutes(B.module,B.routes)))))}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(qT),f.LFG(f.Sil),f.LFG(f.zs3),f.LFG(n1))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})(),Q9=(()=>{class o{constructor(i,d,_={}){this.router=i,this.viewportScroller=d,this.options=_,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},_.scrollPositionRestoration=_.scrollPositionRestoration||"disabled",_.anchorScrolling=_.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(i=>{i instanceof o5?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=i.navigationTrigger,this.restoredId=i.restoredState?i.restoredState.navigationId:0):i instanceof w2&&(this.lastId=i.id,this.scheduleScrollEvent(i,this.router.parseUrl(i.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(i=>{i instanceof O2&&(i.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(i.position):i.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(i.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(i,d){this.router.triggerEvent(new O2(i,"popstate"===this.lastSource?this.store[this.restoredId]:null,d))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return o.\u0275fac=function(i){f.$Z()},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})();const MT=new f.OlP("ROUTER_CONFIGURATION"),jP=new f.OlP("ROUTER_FORROOT_GUARD"),B2=[h0,{provide:t1,useClass:dS},{provide:qT,useFactory:function HX(o,e,i,d,_,B,_t={},_a,_h){const _g=new qT(null,o,e,i,d,_,IV(B));return _a&&(_g.urlHandlingStrategy=_a),_h&&(_g.routeReuseStrategy=_h),function yM(o,e){o.errorHandler&&(e.errorHandler=o.errorHandler),o.malformedUriErrorHandler&&(e.malformedUriErrorHandler=o.malformedUriErrorHandler),o.onSameUrlNavigation&&(e.onSameUrlNavigation=o.onSameUrlNavigation),o.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=o.paramsInheritanceStrategy),o.relativeLinkResolution&&(e.relativeLinkResolution=o.relativeLinkResolution),o.urlUpdateStrategy&&(e.urlUpdateStrategy=o.urlUpdateStrategy),o.canceledNavigationResolution&&(e.canceledNavigationResolution=o.canceledNavigationResolution)}(_t,_g),_t.enableTracing&&_g.events.subscribe(l_=>{var f_,R_;null===(f_=console.group)||void 0===f_||f_.call(console,`Router Event: ${l_.constructor.name}`),console.log(l_.toString()),console.log(l_),null===(R_=console.groupEnd)||void 0===R_||R_.call(console)}),_g},deps:[t1,mU,h0,f.zs3,f.Sil,oS,MT,[class K3{},new f.FiY],[class AI{},new f.FiY]]},mU,{provide:iN,useFactory:function JG(o){return o.routerState.root},deps:[qT]},EY,zG,class GX{preload(e,i){return i().pipe(aR(()=>hI(null)))}},{provide:MT,useValue:{enableTracing:!1}}];function QX(){return new f.PXZ("Router",qT)}let YG=(()=>{class o{constructor(i,d){}static forRoot(i,d){return{ngModule:o,providers:[B2,q9(i),{provide:jP,useFactory:bY,deps:[[qT,new f.FiY,new f.tp0]]},{provide:MT,useValue:d||{}},{provide:B_,useFactory:H9,deps:[bh,[new f.tBr(_0),new f.FiY],MT]},{provide:Q9,useFactory:AO,deps:[qT,y3,MT]},{provide:n1,useExisting:d&&d.preloadingStrategy?d.preloadingStrategy:zG},{provide:f.PXZ,multi:!0,useFactory:QX},[U2,{provide:f.ip1,multi:!0,useFactory:$G,deps:[U2]},{provide:W9,useFactory:qX,deps:[U2]},{provide:f.tb,multi:!0,useExisting:W9}]]}}static forChild(i){return{ngModule:o,providers:[q9(i)]}}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(jP,8),f.LFG(qT,8))},o.\u0275mod=f.oAB({type:o}),o.\u0275inj=f.cJS({}),o})();function AO(o,e,i){return i.scrollOffset&&e.setOffset(i.scrollOffset),new Q9(o,e,i)}function H9(o,e,i={}){return i.useHash?new Pv(o,e):new c0(o,e)}function bY(o){return"guarded"}function q9(o){return[{provide:f.deG,multi:!0,useValue:o},{provide:oS,multi:!0,useValue:o}]}let U2=(()=>{class o{constructor(i){this.injector=i,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new xT.x}appInitializer(){return this.injector.get(_A,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let d=null;const _=new Promise(_a=>d=_a),B=this.injector.get(qT),_t=this.injector.get(MT);return"disabled"===_t.initialNavigation?(B.setUpLocationChangeListener(),d(!0)):"enabled"===_t.initialNavigation||"enabledBlocking"===_t.initialNavigation?(B.hooks.afterPreactivation=()=>this.initNavigation?hI(null):(this.initNavigation=!0,d(!0),this.resultOfPreactivationDone),B.initialNavigation()):d(!0),_})}bootstrapListener(i){const d=this.injector.get(MT),_=this.injector.get(EY),B=this.injector.get(Q9),_t=this.injector.get(qT),_a=this.injector.get(f.z2F);i===_a.components[0]&&(("enabledNonBlocking"===d.initialNavigation||void 0===d.initialNavigation)&&_t.initialNavigation(),_.setUpPreloading(),B.init(),_t.resetRootComponentType(_a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(f.zs3))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})();function $G(o){return o.appInitializer.bind(o)}function qX(o){return o.bootstrapListener.bind(o)}const W9=new f.OlP("Router Initializer");var C0=g(5861);class KX{}class ZG{}class EU{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(i=>{const d=i.indexOf(":");if(d>0){const _=i.slice(0,d),B=_.toLowerCase(),_t=i.slice(d+1).trim();this.maybeSetNormalizedName(_,B),this.headers.has(B)?this.headers.get(B).push(_t):this.headers.set(B,[_t])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(i=>{let d=e[i];const _=i.toLowerCase();"string"==typeof d&&(d=[d]),d.length>0&&(this.headers.set(_,d),this.maybeSetNormalizedName(i,_))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const i=this.headers.get(e.toLowerCase());return i&&i.length>0?i[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,i){return this.clone({name:e,value:i,op:"a"})}set(e,i){return this.clone({name:e,value:i,op:"s"})}delete(e,i){return this.clone({name:e,value:i,op:"d"})}maybeSetNormalizedName(e,i){this.normalizedNames.has(i)||this.normalizedNames.set(i,e)}init(){this.lazyInit&&(this.lazyInit instanceof EU?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(i=>{this.headers.set(i,e.headers.get(i)),this.normalizedNames.set(i,e.normalizedNames.get(i))})}clone(e){const i=new EU;return i.lazyInit=this.lazyInit&&this.lazyInit instanceof EU?this.lazyInit:this,i.lazyUpdate=(this.lazyUpdate||[]).concat([e]),i}applyUpdate(e){const i=e.name.toLowerCase();switch(e.op){case"a":case"s":let d=e.value;if("string"==typeof d&&(d=[d]),0===d.length)return;this.maybeSetNormalizedName(e.name,i);const _=("a"===e.op?this.headers.get(i):void 0)||[];_.push(...d),this.headers.set(i,_);break;case"d":const B=e.value;if(B){let _t=this.headers.get(i);if(!_t)return;_t=_t.filter(_a=>-1===B.indexOf(_a)),0===_t.length?(this.headers.delete(i),this.normalizedNames.delete(i)):this.headers.set(i,_t)}else this.headers.delete(i),this.normalizedNames.delete(i)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(i=>e(this.normalizedNames.get(i),this.headers.get(i)))}}class K9{encodeKey(e){return coe(e)}encodeValue(e){return coe(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const GV=/%(\d[a-f0-9])/gi,YX={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function coe(o){return encodeURIComponent(o).replace(GV,(e,i)=>{var d;return null!==(d=YX[i])&&void 0!==d?d:e})}function EM(o){return`${o}`}class VP{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new K9,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function zX(o,e){const i=new Map;return o.length>0&&o.replace(/^\?/,"").split("&").forEach(_=>{const B=_.indexOf("="),[_t,_a]=-1==B?[e.decodeKey(_),""]:[e.decodeKey(_.slice(0,B)),e.decodeValue(_.slice(B+1))],_h=i.get(_t)||[];_h.push(_a),i.set(_t,_h)}),i}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(i=>{const d=e.fromObject[i];this.map.set(i,Array.isArray(d)?d:[d])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const i=this.map.get(e);return i?i[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,i){return this.clone({param:e,value:i,op:"a"})}appendAll(e){const i=[];return Object.keys(e).forEach(d=>{const _=e[d];Array.isArray(_)?_.forEach(B=>{i.push({param:d,value:B,op:"a"})}):i.push({param:d,value:_,op:"a"})}),this.clone(i)}set(e,i){return this.clone({param:e,value:i,op:"s"})}delete(e,i){return this.clone({param:e,value:i,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const i=this.encoder.encodeKey(e);return this.map.get(e).map(d=>i+"="+this.encoder.encodeValue(d)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const i=new VP({encoder:this.encoder});return i.cloneFrom=this.cloneFrom||this,i.updates=(this.updates||[]).concat(e),i}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const i=("a"===e.op?this.map.get(e.param):void 0)||[];i.push(EM(e.value)),this.map.set(e.param,i);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let d=this.map.get(e.param)||[];const _=d.indexOf(EM(e.value));-1!==_&&d.splice(_,1),d.length>0?this.map.set(e.param,d):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class IU{constructor(){this.map=new Map}set(e,i){return this.map.set(e,i),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function qN(o){return"undefined"!=typeof ArrayBuffer&&o instanceof ArrayBuffer}function JX(o){return"undefined"!=typeof Blob&&o instanceof Blob}function z9(o){return"undefined"!=typeof FormData&&o instanceof FormData}class IL{constructor(e,i,d,_){let B;if(this.url=i,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function CY(o){switch(o){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||_?(this.body=void 0!==d?d:null,B=_):B=d,B&&(this.reportProgress=!!B.reportProgress,this.withCredentials=!!B.withCredentials,B.responseType&&(this.responseType=B.responseType),B.headers&&(this.headers=B.headers),B.context&&(this.context=B.context),B.params&&(this.params=B.params)),this.headers||(this.headers=new EU),this.context||(this.context=new IU),this.params){const _t=this.params.toString();if(0===_t.length)this.urlWithParams=i;else{const _a=i.indexOf("?");this.urlWithParams=i+(-1===_a?"?":_a<i.length-1?"&":"")+_t}}else this.params=new VP,this.urlWithParams=i}serializeBody(){return null===this.body?null:qN(this.body)||JX(this.body)||z9(this.body)||function EL(o){return"undefined"!=typeof URLSearchParams&&o instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof VP?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||z9(this.body)?null:JX(this.body)?this.body.type||null:qN(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof VP?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var i;const d=e.method||this.method,_=e.url||this.url,B=e.responseType||this.responseType,_t=void 0!==e.body?e.body:this.body,_a=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,_h=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let _g=e.headers||this.headers,l_=e.params||this.params;const f_=null!==(i=e.context)&&void 0!==i?i:this.context;return void 0!==e.setHeaders&&(_g=Object.keys(e.setHeaders).reduce((R_,H_)=>R_.set(H_,e.setHeaders[H_]),_g)),e.setParams&&(l_=Object.keys(e.setParams).reduce((R_,H_)=>R_.set(H_,e.setParams[H_]),l_)),new IL(d,_,_t,{params:l_,headers:_g,context:f_,reportProgress:_h,responseType:B,withCredentials:_a})}}var YS=(()=>((YS=YS||{})[YS.Sent=0]="Sent",YS[YS.UploadProgress=1]="UploadProgress",YS[YS.ResponseHeader=2]="ResponseHeader",YS[YS.DownloadProgress=3]="DownloadProgress",YS[YS.Response=4]="Response",YS[YS.User=5]="User",YS))();class XG{constructor(e,i=200,d="OK"){this.headers=e.headers||new EU,this.status=void 0!==e.status?e.status:i,this.statusText=e.statusText||d,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class e7 extends XG{constructor(e={}){super(e),this.type=YS.ResponseHeader}clone(e={}){return new e7({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class t7 extends XG{constructor(e={}){super(e),this.type=YS.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new t7({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class wY extends XG{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function Y9(o,e){return{body:e,headers:o.headers,context:o.context,observe:o.observe,params:o.params,reportProgress:o.reportProgress,responseType:o.responseType,withCredentials:o.withCredentials}}let r1=(()=>{class o{constructor(i){this.handler=i}request(i,d,_={}){let B;if(i instanceof IL)B=i;else{let _h,_g;_h=_.headers instanceof EU?_.headers:new EU(_.headers),_.params&&(_g=_.params instanceof VP?_.params:new VP({fromObject:_.params})),B=new IL(i,d,void 0!==_.body?_.body:null,{headers:_h,context:_.context,params:_g,reportProgress:_.reportProgress,responseType:_.responseType||"json",withCredentials:_.withCredentials})}const _t=hI(B).pipe(LO(_h=>this.handler.handle(_h)));if(i instanceof IL||"events"===_.observe)return _t;const _a=_t.pipe(zS(_h=>_h instanceof t7));switch(_.observe||"body"){case"body":switch(B.responseType){case"arraybuffer":return _a.pipe((0,RI.U)(_h=>{if(null!==_h.body&&!(_h.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return _h.body}));case"blob":return _a.pipe((0,RI.U)(_h=>{if(null!==_h.body&&!(_h.body instanceof Blob))throw new Error("Response is not a Blob.");return _h.body}));case"text":return _a.pipe((0,RI.U)(_h=>{if(null!==_h.body&&"string"!=typeof _h.body)throw new Error("Response is not a string.");return _h.body}));default:return _a.pipe((0,RI.U)(_h=>_h.body))}case"response":return _a;default:throw new Error(`Unreachable: unhandled observe type ${_.observe}}`)}}delete(i,d={}){return this.request("DELETE",i,d)}get(i,d={}){return this.request("GET",i,d)}head(i,d={}){return this.request("HEAD",i,d)}jsonp(i,d){return this.request("JSONP",i,{params:(new VP).append(d,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(i,d={}){return this.request("OPTIONS",i,d)}patch(i,d,_={}){return this.request("PATCH",i,Y9(_,d))}post(i,d,_={}){return this.request("POST",i,Y9(_,d))}put(i,d,_={}){return this.request("PUT",i,Y9(_,d))}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(KX))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})();class J9{constructor(e,i){this.next=e,this.interceptor=i}handle(e){return this.interceptor.intercept(e,this.next)}}const TY=new f.OlP("HTTP_INTERCEPTORS");let $9=(()=>{class o{intercept(i,d){return d.handle(i)}}return o.\u0275fac=function(i){return new(i||o)},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})();const QV=/^\)\]\}',?\n/;let SY=(()=>{class o{constructor(i){this.xhrFactory=i}handle(i){if("JSONP"===i.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new LT.y(d=>{const _=this.xhrFactory.build();if(_.open(i.method,i.urlWithParams),i.withCredentials&&(_.withCredentials=!0),i.headers.forEach((H_,W_)=>_.setRequestHeader(H_,W_.join(","))),i.headers.has("Accept")||_.setRequestHeader("Accept","application/json, text/plain, */*"),!i.headers.has("Content-Type")){const H_=i.detectContentTypeHeader();null!==H_&&_.setRequestHeader("Content-Type",H_)}if(i.responseType){const H_=i.responseType.toLowerCase();_.responseType="json"!==H_?H_:"text"}const B=i.serializeBody();let _t=null;const _a=()=>{if(null!==_t)return _t;const H_=_.statusText||"OK",W_=new EU(_.getAllResponseHeaders()),R0=function Ide(o){return"responseURL"in o&&o.responseURL?o.responseURL:/^X-Request-URL:/m.test(o.getAllResponseHeaders())?o.getResponseHeader("X-Request-URL"):null}(_)||i.url;return _t=new e7({headers:W_,status:_.status,statusText:H_,url:R0}),_t},_h=()=>{let{headers:H_,status:W_,statusText:R0,url:H0}=_a(),CI=null;204!==W_&&(CI=void 0===_.response?_.responseText:_.response),0===W_&&(W_=CI?200:0);let LI=W_>=200&&W_<300;if("json"===i.responseType&&"string"==typeof CI){const xI=CI;CI=CI.replace(QV,"");try{CI=""!==CI?JSON.parse(CI):null}catch(DI){CI=xI,LI&&(LI=!1,CI={error:DI,text:CI})}}LI?(d.next(new t7({body:CI,headers:H_,status:W_,statusText:R0,url:H0||void 0})),d.complete()):d.error(new wY({error:CI,headers:H_,status:W_,statusText:R0,url:H0||void 0}))},_g=H_=>{const{url:W_}=_a(),R0=new wY({error:H_,status:_.status||0,statusText:_.statusText||"Unknown Error",url:W_||void 0});d.error(R0)};let l_=!1;const f_=H_=>{l_||(d.next(_a()),l_=!0);let W_={type:YS.DownloadProgress,loaded:H_.loaded};H_.lengthComputable&&(W_.total=H_.total),"text"===i.responseType&&!!_.responseText&&(W_.partialText=_.responseText),d.next(W_)},R_=H_=>{let W_={type:YS.UploadProgress,loaded:H_.loaded};H_.lengthComputable&&(W_.total=H_.total),d.next(W_)};return _.addEventListener("load",_h),_.addEventListener("error",_g),_.addEventListener("timeout",_g),_.addEventListener("abort",_g),i.reportProgress&&(_.addEventListener("progress",f_),null!==B&&_.upload&&_.upload.addEventListener("progress",R_)),_.send(B),d.next({type:YS.Sent}),()=>{_.removeEventListener("error",_g),_.removeEventListener("abort",_g),_.removeEventListener("load",_h),_.removeEventListener("timeout",_g),i.reportProgress&&(_.removeEventListener("progress",f_),null!==B&&_.upload&&_.upload.removeEventListener("progress",R_)),_.readyState!==_.DONE&&_.abort()}})}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(nT))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})();const ZX=new f.OlP("XSRF_COOKIE_NAME"),WN=new f.OlP("XSRF_HEADER_NAME");class n7{}let r7=(()=>{class o{constructor(i,d,_){this.doc=i,this.platform=d,this.cookieName=_,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const i=this.doc.cookie||"";return i!==this.lastCookieString&&(this.parseCount++,this.lastToken=ZL(i,this.cookieName),this.lastCookieString=i),this.lastToken}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(_l),f.LFG(f.Lbi),f.LFG(ZX))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})(),O5=(()=>{class o{constructor(i,d){this.tokenService=i,this.headerName=d}intercept(i,d){const _=i.url.toLowerCase();if("GET"===i.method||"HEAD"===i.method||_.startsWith("http://")||_.startsWith("https://"))return d.handle(i);const B=this.tokenService.getToken();return null!==B&&!i.headers.has(this.headerName)&&(i=i.clone({headers:i.headers.set(this.headerName,B)})),d.handle(i)}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(n7),f.LFG(WN))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})(),i7=(()=>{class o{constructor(i,d){this.backend=i,this.injector=d,this.chain=null}handle(i){if(null===this.chain){const d=this.injector.get(TY,[]);this.chain=d.reduceRight((_,B)=>new J9(_,B),this.backend)}return this.chain.handle(i)}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(ZG),f.LFG(f.zs3))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac}),o})(),eH=(()=>{class o{static disable(){return{ngModule:o,providers:[{provide:O5,useClass:$9}]}}static withOptions(i={}){return{ngModule:o,providers:[i.cookieName?{provide:ZX,useValue:i.cookieName}:[],i.headerName?{provide:WN,useValue:i.headerName}:[]]}}}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=f.oAB({type:o}),o.\u0275inj=f.cJS({providers:[O5,{provide:TY,useExisting:O5,multi:!0},{provide:n7,useClass:r7},{provide:ZX,useValue:"XSRF-TOKEN"},{provide:WN,useValue:"X-XSRF-TOKEN"}]}),o})(),XX=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=f.oAB({type:o}),o.\u0275inj=f.cJS({providers:[r1,{provide:KX,useClass:i7},SY,{provide:ZG,useExisting:SY}],imports:[[eH.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),o})();var foe=g(3890),HV=g.n(foe);function bM(o,e){return{type:7,name:o,definitions:e,options:{}}}function tH(o,e=null){return{type:4,styles:e,timings:o}}function eee(o){return{type:6,styles:o,offset:null}}function tee(o,e,i){return{type:0,name:o,styles:e,options:i}}function moe(o,e,i=null){return{type:1,expr:o,animation:e,options:i}}const nH=["toast-component",""];function RY(o,e){if(1&o){const i=f.EpF();f.TgZ(0,"button",5),f.NdJ("click",function(){return f.CHM(i),f.oxw().remove()}),f.TgZ(1,"span",6),f._uU(2,"\xd7"),f.qZA()()}}function PS(o,e){if(1&o&&(f.ynx(0),f._uU(1),f.BQk()),2&o){const i=f.oxw(2);f.xp6(1),f.hij("[",i.duplicatesCount+1,"]")}}function $3(o,e){if(1&o&&(f.TgZ(0,"div"),f._uU(1),f.YNc(2,PS,2,1,"ng-container",4),f.qZA()),2&o){const i=f.oxw();f.Tol(i.options.titleClass),f.uIk("aria-label",i.title),f.xp6(1),f.hij(" ",i.title," "),f.xp6(1),f.Q6J("ngIf",i.duplicatesCount)}}function OY(o,e){if(1&o&&f._UZ(0,"div",7),2&o){const i=f.oxw();f.Tol(i.options.messageClass),f.Q6J("innerHTML",i.message,f.oJD)}}function nee(o,e){if(1&o&&(f.TgZ(0,"div",8),f._uU(1),f.qZA()),2&o){const i=f.oxw();f.Tol(i.options.messageClass),f.uIk("aria-label",i.message),f.xp6(1),f.hij(" ",i.message," ")}}function DY(o,e){if(1&o&&(f.TgZ(0,"div"),f._UZ(1,"div",9),f.qZA()),2&o){const i=f.oxw();f.xp6(1),f.Udp("width",i.width+"%")}}function voe(o,e){if(1&o){const i=f.EpF();f.TgZ(0,"button",5),f.NdJ("click",function(){return f.CHM(i),f.oxw().remove()}),f.TgZ(1,"span",6),f._uU(2,"\xd7"),f.qZA()()}}function ree(o,e){if(1&o&&(f.ynx(0),f._uU(1),f.BQk()),2&o){const i=f.oxw(2);f.xp6(1),f.hij("[",i.duplicatesCount+1,"]")}}function yoe(o,e){if(1&o&&(f.TgZ(0,"div"),f._uU(1),f.YNc(2,ree,2,1,"ng-container",4),f.qZA()),2&o){const i=f.oxw();f.Tol(i.options.titleClass),f.uIk("aria-label",i.title),f.xp6(1),f.hij(" ",i.title," "),f.xp6(1),f.Q6J("ngIf",i.duplicatesCount)}}function Eoe(o,e){if(1&o&&f._UZ(0,"div",7),2&o){const i=f.oxw();f.Tol(i.options.messageClass),f.Q6J("innerHTML",i.message,f.oJD)}}function a7(o,e){if(1&o&&(f.TgZ(0,"div",8),f._uU(1),f.qZA()),2&o){const i=f.oxw();f.Tol(i.options.messageClass),f.uIk("aria-label",i.message),f.xp6(1),f.hij(" ",i.message," ")}}function qV(o,e){if(1&o&&(f.TgZ(0,"div"),f._UZ(1,"div",9),f.qZA()),2&o){const i=f.oxw();f.xp6(1),f.Udp("width",i.width+"%")}}class N5{constructor(e,i){this.component=e,this.injector=i}attach(e,i){return this._attachedHost=e,e.attach(this,i)}detach(){const e=this._attachedHost;if(e)return this._attachedHost=void 0,e.detach()}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class zV{constructor(e,i,d,_,B,_t){this.toastId=e,this.config=i,this.message=d,this.title=_,this.toastType=B,this.toastRef=_t,this._onTap=new xT.x,this._onAction=new xT.x,this.toastRef.afterClosed().subscribe(()=>{this._onAction.complete(),this._onTap.complete()})}triggerTap(){this._onTap.next(),this.config.tapToDismiss&&this._onTap.complete()}onTap(){return this._onTap.asObservable()}triggerAction(e){this._onAction.next(e)}onAction(){return this._onAction.asObservable()}}const NY={maxOpened:0,autoDismiss:!1,newestOnTop:!0,preventDuplicates:!1,countDuplicates:!1,resetTimeoutOnDuplicate:!1,includeTitleDuplicates:!1,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},closeButton:!1,disableTimeOut:!1,timeOut:5e3,extendedTimeOut:1e3,enableHtml:!1,progressBar:!1,toastClass:"ngx-toastr",positionClass:"toast-top-right",titleClass:"toast-title",messageClass:"toast-message",easing:"ease-in",easeTime:300,tapToDismiss:!0,onActivateTick:!1,progressAnimation:"decreasing",payload:null},u7=new f.OlP("ToastConfig");class kY{constructor(e){this._overlayRef=e,this.duplicatesCount=0,this._afterClosed=new xT.x,this._activate=new xT.x,this._manualClose=new xT.x,this._resetTimeout=new xT.x,this._countDuplicate=new xT.x}manualClose(){this._manualClose.next(),this._manualClose.complete()}manualClosed(){return this._manualClose.asObservable()}timeoutReset(){return this._resetTimeout.asObservable()}countDuplicate(){return this._countDuplicate.asObservable()}close(){this._overlayRef.detach(),this._afterClosed.next(),this._manualClose.next(),this._afterClosed.complete(),this._manualClose.complete(),this._activate.complete(),this._resetTimeout.complete(),this._countDuplicate.complete()}afterClosed(){return this._afterClosed.asObservable()}isInactive(){return this._activate.isStopped}activate(){this._activate.next(),this._activate.complete()}afterActivate(){return this._activate.asObservable()}onDuplicate(e,i){e&&this._resetTimeout.next(),i&&this._countDuplicate.next(++this.duplicatesCount)}}class PY{constructor(e,i){this._toastPackage=e,this._parentInjector=i}get(e,i,d){return e===zV?this._toastPackage:this._parentInjector.get(e,i,d)}}class iee extends class KV{attach(e,i){return this._attachedPortal=e,this.attachComponentPortal(e,i)}detach(){this._attachedPortal&&this._attachedPortal.setAttachedHost(),this._attachedPortal=void 0,this._disposeFn&&(this._disposeFn(),this._disposeFn=void 0)}setDisposeFn(e){this._disposeFn=e}}{constructor(e,i,d){super(),this._hostDomElement=e,this._componentFactoryResolver=i,this._appRef=d}attachComponentPortal(e,i){const d=this._componentFactoryResolver.resolveComponentFactory(e.component);let _;return _=d.create(e.injector),this._appRef.attachView(_.hostView),this.setDisposeFn(()=>{this._appRef.detachView(_.hostView),_.destroy()}),i?this._hostDomElement.insertBefore(this._getComponentRootNode(_),this._hostDomElement.firstChild):this._hostDomElement.appendChild(this._getComponentRootNode(_)),_}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}class rH{constructor(e){this._portalHost=e}attach(e,i=!0){return this._portalHost.attach(e,i)}detach(){return this._portalHost.detach()}}let Ioe=(()=>{class o{constructor(i){this._document=i}ngOnDestroy(){this._containerElement&&this._containerElement.parentNode&&this._containerElement.parentNode.removeChild(this._containerElement)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const i=this._document.createElement("div");i.classList.add("overlay-container"),i.setAttribute("aria-live","polite"),this._document.body.appendChild(i),this._containerElement=i}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(_l))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),oee=(()=>{class o{constructor(i,d,_,B){this._overlayContainer=i,this._componentFactoryResolver=d,this._appRef=_,this._document=B,this._paneElements=new Map}create(i,d){return this._createOverlayRef(this.getPaneElement(i,d))}getPaneElement(i="",d){return this._paneElements.get(d)||this._paneElements.set(d,{}),this._paneElements.get(d)[i]||(this._paneElements.get(d)[i]=this._createPaneElement(i,d)),this._paneElements.get(d)[i]}_createPaneElement(i,d){const _=this._document.createElement("div");return _.id="toast-container",_.classList.add(i),_.classList.add("toast-container"),d?d.getContainerElement().appendChild(_):this._overlayContainer.getContainerElement().appendChild(_),_}_createPortalHost(i){return new iee(i,this._componentFactoryResolver,this._appRef)}_createOverlayRef(i){return new rH(this._createPortalHost(i))}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(Ioe),f.LFG(f._Vd),f.LFG(f.z2F),f.LFG(_l))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),xY=(()=>{class o{constructor(i,d,_,B,_t){this.overlay=d,this._injector=_,this.sanitizer=B,this.ngZone=_t,this.currentlyActive=0,this.toasts=[],this.index=0,this.toastrConfig=Object.assign(Object.assign({},i.default),i.config),i.config.iconClasses&&(this.toastrConfig.iconClasses=Object.assign(Object.assign({},i.default.iconClasses),i.config.iconClasses))}show(i,d,_={},B=""){return this._preBuildNotification(B,i,d,this.applyConfig(_))}success(i,d,_={}){return this._preBuildNotification(this.toastrConfig.iconClasses.success||"",i,d,this.applyConfig(_))}error(i,d,_={}){return this._preBuildNotification(this.toastrConfig.iconClasses.error||"",i,d,this.applyConfig(_))}info(i,d,_={}){return this._preBuildNotification(this.toastrConfig.iconClasses.info||"",i,d,this.applyConfig(_))}warning(i,d,_={}){return this._preBuildNotification(this.toastrConfig.iconClasses.warning||"",i,d,this.applyConfig(_))}clear(i){for(const d of this.toasts)if(void 0!==i){if(d.toastId===i)return void d.toastRef.manualClose()}else d.toastRef.manualClose()}remove(i){const d=this._findToast(i);if(!d||(d.activeToast.toastRef.close(),this.toasts.splice(d.index,1),this.currentlyActive=this.currentlyActive-1,!this.toastrConfig.maxOpened||!this.toasts.length))return!1;if(this.currentlyActive<this.toastrConfig.maxOpened&&this.toasts[this.currentlyActive]){const _=this.toasts[this.currentlyActive].toastRef;_.isInactive()||(this.currentlyActive=this.currentlyActive+1,_.activate())}return!0}findDuplicate(i="",d="",_,B){const{includeTitleDuplicates:_t}=this.toastrConfig;for(const _a of this.toasts){const _h=_t&&_a.title===i;if((!_t||_h)&&_a.message===d)return _a.toastRef.onDuplicate(_,B),_a}return null}applyConfig(i={}){return Object.assign(Object.assign({},this.toastrConfig),i)}_findToast(i){for(let d=0;d<this.toasts.length;d++)if(this.toasts[d].toastId===i)return{index:d,activeToast:this.toasts[d]};return null}_preBuildNotification(i,d,_,B){return B.onActivateTick?this.ngZone.run(()=>this._buildNotification(i,d,_,B)):this._buildNotification(i,d,_,B)}_buildNotification(i,d,_,B){if(!B.toastComponent)throw new Error("toastComponent required");const _t=this.findDuplicate(_,d,this.toastrConfig.resetTimeoutOnDuplicate&&B.timeOut>0,this.toastrConfig.countDuplicates);if((this.toastrConfig.includeTitleDuplicates&&_||d)&&this.toastrConfig.preventDuplicates&&null!==_t)return _t;this.previousToastMessage=d;let _a=!1;this.toastrConfig.maxOpened&&this.currentlyActive>=this.toastrConfig.maxOpened&&(_a=!0,this.toastrConfig.autoDismiss&&this.clear(this.toasts[0].toastId));const _h=this.overlay.create(B.positionClass,this.overlayContainer);this.index=this.index+1;let _g=d;d&&B.enableHtml&&(_g=this.sanitizer.sanitize(f.q3G.HTML,d));const l_=new kY(_h),f_=new zV(this.index,B,_g,_,i,l_),R_=new PY(f_,this._injector),H_=new N5(B.toastComponent,R_),W_=_h.attach(H_,this.toastrConfig.newestOnTop);l_.componentInstance=W_.instance;const R0={toastId:this.index,title:_||"",message:d||"",toastRef:l_,onShown:l_.afterActivate(),onHidden:l_.afterClosed(),onTap:f_.onTap(),onAction:f_.onAction(),portal:W_};return _a||(this.currentlyActive=this.currentlyActive+1,setTimeout(()=>{R0.toastRef.activate()})),this.toasts.push(R0),R0}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(u7),f.LFG(oee),f.LFG(f.zs3),f.LFG(mV),f.LFG(f.R0b))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),see=(()=>{class o{constructor(i,d,_){this.toastrService=i,this.toastPackage=d,this.ngZone=_,this.width=-1,this.toastClasses="",this.state={value:"inactive",params:{easeTime:this.toastPackage.config.easeTime,easing:"ease-in"}},this.message=d.message,this.title=d.title,this.options=d.config,this.originalTimeout=d.config.timeOut,this.toastClasses=`${d.toastType} ${d.config.toastClass}`,this.sub=d.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=d.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=d.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=d.toastRef.countDuplicate().subscribe(B=>{this.duplicatesCount=B})}get displayStyle(){if("inactive"===this.state.value)return"none"}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state=Object.assign(Object.assign({},this.state),{value:"active"}),!0!==this.options.disableTimeOut&&"timeOut"!==this.options.disableTimeOut&&this.options.timeOut&&(this.outsideTimeout(()=>this.remove(),this.options.timeOut),this.hideTime=(new Date).getTime()+this.options.timeOut,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}updateProgress(){if(0===this.width||100===this.width||!this.options.timeOut)return;const i=(new Date).getTime();this.width=(this.hideTime-i)/this.options.timeOut*100,"increasing"===this.options.progressAnimation&&(this.width=100-this.width),this.width<=0&&(this.width=0),this.width>=100&&(this.width=100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state=Object.assign(Object.assign({},this.state),{value:"active"}),this.outsideTimeout(()=>this.remove(),this.originalTimeout),this.options.timeOut=this.originalTimeout,this.hideTime=(new Date).getTime()+(this.options.timeOut||0),this.width=-1,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10)}remove(){"removed"!==this.state.value&&(clearTimeout(this.timeout),this.state=Object.assign(Object.assign({},this.state),{value:"removed"}),this.outsideTimeout(()=>this.toastrService.remove(this.toastPackage.toastId),+this.toastPackage.config.easeTime))}tapToast(){"removed"!==this.state.value&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){"removed"!==this.state.value&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width=0)}delayedHideToast(){!0===this.options.disableTimeOut||"extendedTimeOut"===this.options.disableTimeOut||0===this.options.extendedTimeOut||"removed"===this.state.value||(this.outsideTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=(new Date).getTime()+(this.options.timeOut||0),this.width=-1,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}outsideTimeout(i,d){this.ngZone?this.ngZone.runOutsideAngular(()=>this.timeout=setTimeout(()=>this.runInsideAngular(i),d)):this.timeout=setTimeout(()=>i(),d)}outsideInterval(i,d){this.ngZone?this.ngZone.runOutsideAngular(()=>this.intervalId=setInterval(()=>this.runInsideAngular(i),d)):this.intervalId=setInterval(()=>i(),d)}runInsideAngular(i){this.ngZone?this.ngZone.run(()=>i()):i()}}return o.\u0275fac=function(i){return new(i||o)(f.Y36(xY),f.Y36(zV),f.Y36(f.R0b))},o.\u0275cmp=f.Xpm({type:o,selectors:[["","toast-component",""]],hostVars:5,hostBindings:function(i,d){1&i&&f.NdJ("click",function(){return d.tapToast()})("mouseenter",function(){return d.stickAround()})("mouseleave",function(){return d.delayedHideToast()}),2&i&&(f.d8E("@flyInOut",d.state),f.Tol(d.toastClasses),f.Udp("display",d.displayStyle))},attrs:nH,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(i,d){1&i&&(f.YNc(0,RY,3,0,"button",0),f.YNc(1,$3,3,5,"div",1),f.YNc(2,OY,1,3,"div",2),f.YNc(3,nee,2,4,"div",3),f.YNc(4,DY,2,2,"div",4)),2&i&&(f.Q6J("ngIf",d.options.closeButton),f.xp6(1),f.Q6J("ngIf",d.title),f.xp6(1),f.Q6J("ngIf",d.message&&d.options.enableHtml),f.xp6(1),f.Q6J("ngIf",d.message&&!d.options.enableHtml),f.xp6(1),f.Q6J("ngIf",d.options.progressBar))},directives:[QT],encapsulation:2,data:{animation:[bM("flyInOut",[tee("inactive",eee({opacity:0})),tee("active",eee({opacity:1})),tee("removed",eee({opacity:0})),moe("inactive => active",tH("{{ easeTime }}ms {{ easing }}")),moe("active => removed",tH("{{ easeTime }}ms {{ easing }}"))])]}}),o})();const LY=Object.assign(Object.assign({},NY),{toastComponent:see});let boe=(()=>{class o{static forRoot(i={}){return{ngModule:o,providers:[{provide:u7,useValue:{default:LY,config:i}}]}}}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=f.oAB({type:o}),o.\u0275inj=f.cJS({imports:[[nL]]}),o})(),woe=(()=>{class o{constructor(i,d,_){this.toastrService=i,this.toastPackage=d,this.appRef=_,this.width=-1,this.toastClasses="",this.state="inactive",this.message=d.message,this.title=d.title,this.options=d.config,this.originalTimeout=d.config.timeOut,this.toastClasses=`${d.toastType} ${d.config.toastClass}`,this.sub=d.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=d.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=d.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=d.toastRef.countDuplicate().subscribe(B=>{this.duplicatesCount=B})}get displayStyle(){if("inactive"===this.state)return"none"}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state="active",!(!0===this.options.disableTimeOut||"timeOut"===this.options.disableTimeOut)&&this.options.timeOut&&(this.timeout=setTimeout(()=>{this.remove()},this.options.timeOut),this.hideTime=(new Date).getTime()+this.options.timeOut,this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10))),this.options.onActivateTick&&this.appRef.tick()}updateProgress(){if(0===this.width||100===this.width||!this.options.timeOut)return;const i=(new Date).getTime();this.width=(this.hideTime-i)/this.options.timeOut*100,"increasing"===this.options.progressAnimation&&(this.width=100-this.width),this.width<=0&&(this.width=0),this.width>=100&&(this.width=100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state="active",this.options.timeOut=this.originalTimeout,this.timeout=setTimeout(()=>this.remove(),this.originalTimeout),this.hideTime=(new Date).getTime()+(this.originalTimeout||0),this.width=-1,this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10))}remove(){"removed"!==this.state&&(clearTimeout(this.timeout),this.state="removed",this.timeout=setTimeout(()=>this.toastrService.remove(this.toastPackage.toastId)))}tapToast(){"removed"!==this.state&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){"removed"!==this.state&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width=0)}delayedHideToast(){!0===this.options.disableTimeOut||"extendedTimeOut"===this.options.disableTimeOut||0===this.options.extendedTimeOut||"removed"===this.state||(this.timeout=setTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=(new Date).getTime()+(this.options.timeOut||0),this.width=-1,this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10)))}}return o.\u0275fac=function(i){return new(i||o)(f.Y36(xY),f.Y36(zV),f.Y36(f.z2F))},o.\u0275cmp=f.Xpm({type:o,selectors:[["","toast-component",""]],hostVars:4,hostBindings:function(i,d){1&i&&f.NdJ("click",function(){return d.tapToast()})("mouseenter",function(){return d.stickAround()})("mouseleave",function(){return d.delayedHideToast()}),2&i&&(f.Tol(d.toastClasses),f.Udp("display",d.displayStyle))},attrs:nH,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(i,d){1&i&&(f.YNc(0,voe,3,0,"button",0),f.YNc(1,yoe,3,5,"div",1),f.YNc(2,Eoe,1,3,"div",2),f.YNc(3,a7,2,4,"div",3),f.YNc(4,qV,2,2,"div",4)),2&i&&(f.Q6J("ngIf",d.options.closeButton),f.xp6(1),f.Q6J("ngIf",d.title),f.xp6(1),f.Q6J("ngIf",d.message&&d.options.enableHtml),f.xp6(1),f.Q6J("ngIf",d.message&&!d.options.enableHtml),f.xp6(1),f.Q6J("ngIf",d.options.progressBar))},directives:[QT],encapsulation:2}),o})();const l7=Object.assign(Object.assign({},NY),{toastComponent:woe});let j2=(()=>{class o{static forRoot(i={}){return{ngModule:o,providers:[{provide:u7,useValue:{default:l7,config:i}}]}}}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=f.oAB({type:o}),o.\u0275inj=f.cJS({imports:[[nL]]}),o})(),iH=(()=>{class o{constructor(i,d){this.router=i,this.toastr=d,this.rtc={client:null,localAudioTrack:null,localVideoTrack:null},this.options={appId:"65cfadb6ee9d42f4977b6eafb18b3d71",channel:"test"},this.remoteUsers=[],this.updateUserInfo=new WR(null),this.getMediaStatus=new WR(null)}createRTCClient(){this.rtc.client=HV().createClient({mode:"rtc",codec:"h264"})}agoraServerEvents(){var i=this;this.rtc.client.on("user-published",function(){var d=(0,C0.Z)(function*(_,B){if(yield i.rtc.client.subscribe(_,B),i.media=B,console.log("subscribe success"),i.getMediaStatus.next(!0),"video"===B){const _t=_.videoTrack;i.playerContainer=document.getElementById("remote-player"),i.playerContainer.id=_.uid.toString(),i.playerContainer.style.margin="25px",document.body.append(i.playerContainer),console.log(i.playerContainer),_t.play(i.playerContainer),i.rtc.localAudioTrack=yield HV().createMicrophoneAudioTrack(),i.rtc.localVideoTrack=yield HV().createCameraVideoTrack({encoderConfig:"720p"}),i.rtc.localVideoTrack.play("local-player"),yield i.rtc.client.publish([i.rtc.localAudioTrack,i.rtc.localVideoTrack])}"audio"===B&&(_.audioTrack.play(),i.rtc.localAudioTrack=yield HV().createMicrophoneAudioTrack(),yield i.rtc.client.publish([i.rtc.localAudioTrack]))});return function(_,B){return d.apply(this,arguments)}}()),this.rtc.client.on("user-unpublished",d=>{console.log(d,"user-unpublished")}),this.rtc.client.on("connection-state-change",(d,_)=>{console.log("current",d,"prev",_,"event")}),this.rtc.client.on("user-Joined",d=>{let _=d.id;this.remoteUsers.push({uid:+_}),this.updateUserInfo.next(_),console.log("user-Joined",d,this.remoteUsers,"event1")}),this.rtc.client.on("channel-media-relay-event",d=>{console.log("channel-media-relay-event",d,"event2")}),this.rtc.client.on("user-left",d=>{console.log("user-left",d,"event3"),this.toastr.error("user-left","",{timeOut:3e3}),this.leaveCall()}),this.rtc.client.on("channel-media-relay-state",d=>{console.log("channel-media-relay-state",d,"event4")}),this.rtc.client.on("crypt-error",d=>{console.log("crypt-error",d,"event5")}),this.rtc.client.on("exception",d=>{console.log("exception",d,"event6")}),this.rtc.client.on("live-streamig-error",d=>{console.log("live-streamig-error",d,"event7")}),this.rtc.client.on("live-streamig-warning",d=>{console.log("live-streamig-warning",d,"event8")}),this.rtc.client.on("exception",d=>{console.log("exception",d,"event9")}),this.rtc.client.on("media-reconnect-end",d=>{console.log("media-reconnect-end",d,"event10")}),this.rtc.client.on("network-quality",d=>{}),this.rtc.client.on("stream-fallback",d=>{console.log("stream-fallback",d,"event12")}),this.rtc.client.on("stream-type-changed",d=>{console.log("stream-type-changed",d,"event13")}),this.rtc.client.on("token-privilage-did-expire",d=>{console.log("token-privilage-did-expire",d,"event14")}),this.rtc.client.on("token-privilage-will-expire",d=>{console.log("token-privilage-will-expire",d,"event15")}),this.rtc.client.on("volume-indicator",d=>{console.log("volume-indicator",d,"event16")}),this.rtc.client.on("trace-ended",d=>{console.log("trace-ended",d,"event17")})}leaveCall(){var i=this;return(0,C0.Z)(function*(){"audio"==i.media&&i.rtc&&i.rtc.localAudioTrack&&(i.rtc.localAudioTrack.close(),yield i.rtc.client.leave(function(){console.log("Leave channel successfully")},function(d){console.log("Leave channel failed")})),"video"==i.media&&i.rtc&&i.rtc.localAudioTrack&&i.rtc.localVideoTrack&&(console.log("history"),i.rtc.localAudioTrack.close(),i.rtc.localVideoTrack.close(),i.playerContainer.remove(),yield i.rtc.client.leave(function(){console.log("Leave channel successfully")},function(d){console.log("Leave channel failed")})),i.media="",i.getMediaStatus.next(!1),i.router.navigate(["/user"])})()}handleEvents(){this.rtc.client.on("error",i=>{console.log(i)}),this.rtc.client.on("peer-leave",i=>{console.log("peer-leave",i.uid)}),this.rtc.client.on("stream-published",i=>{console.log("stream-published")}),this.rtc.client.on("stream-added",i=>{var _=i.stream.getId();console.log("remoteStream",_),console.log("stream-added remote-uid: ")}),this.rtc.client.on("stream-subscribed",i=>{const d=i.stream,_=d.getId();d.play("remote_video_"+_,{fit:"cover"}),console.log("stream-subscribed remote-uid: ",_)}),this.rtc.client.on("stream-removed",i=>{const d=i.stream,_=d.getId();d.stop("remote_video_"+_),console.log("stream-removed remote-uid: ",_)}),this.rtc.client.on("onTokenPrivilegeWillExpire",()=>{console.log("onTokenPrivilegeWillExpire")}),this.rtc.client.on("onTokenPrivilegeDidExpire",()=>{console.log("onTokenPrivilegeDidExpire")}),this.rtc.client.on("liveStreamingStarted",i=>{console.log("liveStreamingStarted",i)}),this.rtc.client.on("liveStreamingFailed",i=>{console.log("liveStreamingFailed",i)}),this.rtc.client.on("liveStreamingStopped",i=>{console.log("liveStreamingStopped",i)}),this.rtc.client.on("liveTranscodingUpdated",i=>{console.log("liveTranscodingUpdated",i)})}join(i){var d=this;return(0,C0.Z)(function*(){d.createRTCClient(),yield d.rtc.client.join(d.options.appId,i,null,1234),d.agoraServerEvents()})()}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(qT),f.LFG(xY))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),aee=(()=>{class o{constructor(i){this.http=i}getRequest(i,d={}){return this.http.get(i,{params:d}).pipe((0,RI.U)(_=>_),aR(_=>this.handleError(_)))}handleError(i){return RP(i)}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(r1))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var Sde=g(3528),Toe=g.n(Sde);let oH=(()=>{class o{constructor(i,d,_){this.router=i,this.streamService=d,this.toastr=_,this._invitation=null,this._token=void 0,this.getStatus=new WR(null),this.getRoomCode=(B,_t)=>{let _a="";return _a=B+_t,_a}}createRTMClient(){return this.rtmclient=Toe().createInstance("65cfadb6ee9d42f4977b6eafb18b3d71"),this.rtmclient}signalLogin(i){return this.rtmclient.login({token:this._token,uid:i}).then(()=>{console.log("status online")})}SignalLogout(i){return(0,C0.Z)(function*(){yield i.logout()})()}inquire(i){return this.rtmclient.queryPeersOnlineStatus(i)}RTMevents(i){i.on("ConnectionStateChanged",(d,_)=>{console.log("on connection state changed to"+d+"reason: "+_)}),i.on("MessageFromPeer",(d,_)=>{this.receivedMessage(d,_)}),i.on("PeersOnlineStatusChanged",d=>{console.log("PeersOnlineStatusChanged",d)})}receivedMessage(i,d){console.log(i,d,"MessageFromPeer"),"TEXT"===i.messageType&&this.setCurrentMessage({message:i.text,user:d})}receiveChannelMessage(i,d){i.on("ChannelMessage",(_,B,_t)=>{this.handleMessageReceived(_,B,_t,d)}),i.on("MemberJoined",_=>{console.log(_,"MemberJoined")}),i.on("MemberLeft",_=>{console.log("MemberLeft",_)})}handleMessageReceived(i,d,_,B){var _t=this;return(0,C0.Z)(function*(){const _a=yield B.getUserAttributes(d);console.log(i,d,_,_a,"channelmsg"),"TEXT"===i.messageType&&_t.setCurrentMessage({user:_a,message:i.text})})()}setCurrentMessage(i){console.log(i,"setCuurentMessage"),alert(i.message)}localInvitation(i,d){this._invitation=this.rtmclient.createLocalInvitation(i),this._invitation.on("LocalInvitationReceivedByPeer",()=>{console.log("Peers receive calls")}),this._invitation.on("LocalInvitationCanceled",()=>{console.log("Cancel call invitation")}),this._invitation.on("LocalInvitationAccepted",()=>{console.log("Peers accept invitations to call"),this.getStatus.next(!0),this.streamService.join(d)}),this._invitation.on("LocalInvitationRefused",()=>{console.log("Peers refuse to call invitations"),this.toastr.error("Peer refused to call invitations","",{timeOut:3e3}),this.getStatus.next(!1),this.router.navigate(["/user"])}),this._invitation.on("LocalInvitationFailure",()=>{console.log("Call process failed"),this.getStatus.next(!1)}),this._invitation.content=d,this._invitation.send()}createRtmChannel(i){return i.createChannel("test")}joinChannel(i){return(0,C0.Z)(function*(){yield i.join()})()}setLocalAttributes(i,d){return(0,C0.Z)(function*(){yield i.setLocalUserAttributes({name:d})})()}sendMessageChannel(i){i.sendMessage({text:"test channel message"}).then(()=>{console.log("test")})}leaveChannel(i,d){return(0,C0.Z)(function*(){d&&(yield d.leave()),i&&(yield i.logout())})()}sentOneToOneMessage(i,d){i.sendMessageToPeer({text:"test peer message"},d).then(_=>{_.hasPeerReceived&&console.log(_,"sendMessageToPeer")})}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(qT),f.LFG(iH),f.LFG(xY))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function Rde(o,e){1&o&&(f.TgZ(0,"div",15),f._uU(1,"Calling..."),f.qZA())}function Soe(o,e){1&o&&(f.TgZ(0,"div",15),f._uU(1,"Outgoing voice call"),f.qZA())}function CM(o,e){1&o&&(f.TgZ(0,"div",15),f._uU(1,"voice call"),f.qZA())}function GP(o,e){1&o&&(f.TgZ(0,"div",9)(1,"i"),f.O4$(),f.TgZ(2,"svg",11),f._UZ(3,"path",16)(4,"path",17),f.qZA()()())}let cee=(()=>{class o{constructor(i,d,_,B,_t){var _a=this;this.stream=i,this.api=d,this.message=_,this.router=B,this.route=_t,this.userName="",this.hideBtns=!0,this.callingStatus=!1,this.stream.updateUserInfo.subscribe(function(){var _h=(0,C0.Z)(function*(_g){if(_g){const l_=yield _a.message.rtmclient.getUserAttributes(_g.toString());for(let f_=0;f_<_a.stream.remoteUsers.length;f_++){const R_=_a.stream.remoteUsers[f_];R_.uid==_g&&(R_.name=l_.name)}}});return function(_g){return _h.apply(this,arguments)}}())}ngOnInit(){var i=this;this.id=this.route.snapshot.paramMap.get("id"),this.userName=this.route.snapshot.paramMap.get("username"),console.log("routeid",this.id),console.log("username",this.userName),this.startCall(),this.route.params.subscribe(d=>{console.log("value ",d)}),this.message.getStatus.subscribe(function(){var d=(0,C0.Z)(function*(_){i.callingStatus=_,console.log(i.callingStatus)});return function(_){return d.apply(this,arguments)}}()),this.stream.getMediaStatus.subscribe(function(){var d=(0,C0.Z)(function*(_){i.callingStatus=_});return function(_){return d.apply(this,arguments)}}())}startCall(){var i=this;return(0,C0.Z)(function*(){i.myId=1234,yield i.generateTokenAndUid(i.myId),yield i.rtmUserLogin(i.myId),i.hideBtns=!1,i.callPeer()})()}generateTokenAndUid(i){var d=this;return(0,C0.Z)(function*(){const B={params:new VP({fromString:"channel=test&uid="+i})},_t=yield d.api.getRequest("https://test-agora.herokuapp.com/access_token?",B.params).toPromise();return{uid:i,token:_t.token}})()}generateRtmTokenAndUid(i){var d=this;return(0,C0.Z)(function*(){const B={params:new VP({fromString:"account="+i})},_t=yield d.api.getRequest("https://sharp-pouncing-grass.glitch.me/rtmToken?",B.params).toPromise();return{uid:i,token:_t.key}})()}generateUid(){return Math.floor(Math.pow(10,3)+9*Math.random()*Math.pow(10,3))}rtmUserLogin(i){var d=this;return(0,C0.Z)(function*(){d.message.rtmclient=d.message.createRTMClient(),yield d.message.signalLogin(i.toString()),d.message.RTMevents(d.message.rtmclient)})()}callPeer(){const i=this.id;this.message.inquire([i]).then(d=>{if(d[i]){console.log("peer",i,"is online");let _=this.message.getRoomCode(this.myId,i);console.log("room",_+"Audio"),this.message.localInvitation(i,_+"Audio[Front Door]DoorID943")}}).catch(()=>{console.log("The query failed")})}leaveCall(){this.stream.leaveCall()}}return o.\u0275fac=function(i){return new(i||o)(f.Y36(iH),f.Y36(aee),f.Y36(oH),f.Y36(qT),f.Y36(iN))},o.\u0275cmp=f.Xpm({type:o,selectors:[["app-audio"]],decls:23,vars:5,consts:[["lang","en"],["charset","UTF-8"],["http-equiv","X-UA-Compatible","content","IE=edge"],["name","viewport","content","width=device-width, initial-scale=1.0"],[1,"container-fluid","content",2,"margin-left","28%","padding-top","40px","margin-right","28%","padding-bottom","500px"],["style","text-align: center;color: #73767D;",4,"ngIf"],[2,"text-align","center","color","#181818","font-weight","400","font-size","20px","font-family","inherit"],["style","text-align: center;",4,"ngIf"],[2,"margin-left","28%","padding-top","20px","margin-right","28%"],[2,"text-align","center"],["type","button",3,"click"],["width","50","height","50","viewBox","0 0 40 40","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M20 40C31.0457 40 40 31.0457 40 20C40 8.9543 31.0457 0 20 0C8.9543 0 0 8.9543 0 20C0 31.0457 8.9543 40 20 40Z","fill","#D45238"],["d","M26.59 18.52C27.64 19.03 28.63 19.67 29.55 20.43L28.48 21.5C27.9 21.03 27.27 20.61 26.6 20.23V18.52M13.4 18.52V20.22C12.75 20.59 12.12 21.01 11.53 21.49L10.46 20.42C11.37 19.67 12.36 19.04 13.4 18.52ZM20 15C15.46 15 11.34 16.78 8.29 19.67C8.11 19.85 8 20.1 8 20.38C8 20.66 8.11 20.91 8.29 21.08L10.77 23.56C10.95 23.74 11.2 23.85 11.48 23.85C11.75 23.85 12 23.75 12.18 23.57C12.97 22.84 13.86 22.21 14.84 21.72C15.17 21.56 15.4 21.21 15.4 20.82V17.72C16.85 17.25 18.4 17 20 17C21.6 17 23.15 17.25 24.59 17.73V20.83C24.59 21.23 24.82 21.57 25.15 21.73C26.13 22.22 27.03 22.84 27.82 23.58C28 23.75 28.25 23.86 28.52 23.86C28.8 23.86 29.05 23.75 29.23 23.57L31.71 21.09C31.89 20.91 32 20.66 32 20.38C32 20.1 31.89 19.85 31.71 19.67C28.66 16.78 24.54 15 20 15Z","fill","white"],[2,"text-align","center","color","#73767D","padding-top","16px"],[2,"text-align","center","color","#73767D"],["d","M28 23.51C26.76 23.51 25.55 23.31 24.43 22.94C24.33 22.9 24.22 22.89 24.12 22.89C23.86 22.89 23.61 22.99 23.41 23.18L21.21 25.38C18.38 23.93 16.06 21.62 14.62 18.79L16.82 16.59C17.1 16.31 17.18 15.92 17.07 15.57C16.7 14.45 16.5 13.25 16.5 12C16.5 11.45 16.05 11 15.5 11H12C11.45 11 11 11.45 11 12C11 21.39 18.61 29 28 29C28.55 29 29 28.55 29 28V24.51C29 23.96 28.55 23.51 28 23.51ZM13.03 13H14.53C14.6 13.89 14.75 14.76 14.99 15.59L13.79 16.79C13.38 15.59 13.12 14.32 13.03 13ZM27 26.97C25.68 26.88 24.41 26.62 23.2 26.22L24.39 25.03C25.24 25.27 26.11 25.42 26.99 25.48V26.97H27Z","fill","#73767D"],["d","M25.52 13H22.93V11H28.93V17H26.93V14.41L21.91 19.43L20.5 18.02L25.52 13Z","fill","#73767D"]],template:function(i,d){1&i&&(f.TgZ(0,"html",0)(1,"head"),f._UZ(2,"meta",1)(3,"meta",2)(4,"meta",3),f.TgZ(5,"title"),f._uU(6,"POC Audio"),f.qZA()(),f.TgZ(7,"body")(8,"div",4),f.YNc(9,Rde,2,0,"div",5),f.TgZ(10,"div",6),f._uU(11),f.qZA(),f.YNc(12,Soe,2,0,"div",5),f.YNc(13,CM,2,0,"div",5),f.YNc(14,GP,5,0,"div",7),f.qZA(),f.TgZ(15,"div",8)(16,"div",9)(17,"i",10),f.NdJ("click",function(){return d.leaveCall()}),f.O4$(),f.TgZ(18,"svg",11),f._UZ(19,"path",12)(20,"path",13),f.qZA()()(),f.kcU(),f.TgZ(21,"div",14),f._uU(22,"Tap to disconnect"),f.qZA()()()()),2&i&&(f.xp6(9),f.Q6J("ngIf",!d.callingStatus),f.xp6(2),f.Oqu(d.userName),f.xp6(1),f.Q6J("ngIf",!d.callingStatus),f.xp6(1),f.Q6J("ngIf",d.callingStatus),f.xp6(1),f.Q6J("ngIf",!d.callingStatus))},directives:[QT],styles:[".avatar[_ngcontent-%COMP%]{vertical-align:middle;width:115px;height:115px;border-radius:50%}"]}),o})();var sH=g(4986),MY=g(6451),BY=g(3099);function uee(o,e=tN.y){return o=null!=o?o:KN,(0,rS.e)((i,d)=>{let _,B=!0;i.subscribe((0,nS.x)(d,_t=>{const _a=e(_t);(B||!o(_,_a))&&(B=!1,_=_a,d.next(_t))}))})}function KN(o,e){return o===e}var Roe=g(5032),H1=g(5813),lR=g(2011),k5=(g(7092),g(3942)),bL=g(4859),uN=g(9681),M_=g(2090),QP=g(1877);const dee="@firebase/database";let CU="";function P5(o){CU=o}class Doe{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,i){null==i?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,M_.Pz)(i))}get(e){const i=this.domStorage_.getItem(this.prefixedName_(e));return null==i?null:(0,M_.cI)(i)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class Noe{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,i){null==i?delete this.cache_[e]:this.cache_[e]=i}get(e){return(0,M_.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const d7=function(o){try{if("undefined"!=typeof window&&void 0!==window[o]){const e=window[o];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Doe(e)}}catch(e){}return new Noe},wU=d7("localStorage"),UY=d7("sessionStorage"),V2=new QP.Yd("@firebase/database"),aH=function(){let o=1;return function(){return o++}}(),Z3=function(o){const e=(0,M_.dS)(o),i=new M_.gQ;i.update(e);const d=i.digest();return M_.US.encodeByteArray(d)},h7=function(...o){let e="";for(let i=0;i<o.length;i++){const d=o[i];Array.isArray(d)||d&&"object"==typeof d&&"number"==typeof d.length?e+=h7.apply(null,d):e+="object"==typeof d?(0,M_.Pz)(d):d,e+=" "}return e};let YV=null,xS=!0;const koe=function(o,e){(0,M_.hu)(!e||!0===o||!1===o,"Can't turn on custom loggers persistently."),!0===o?(V2.logLevel=QP.in.VERBOSE,YV=V2.log.bind(V2),e&&UY.set("logging_enabled",!0)):"function"==typeof o?YV=o:(YV=null,UY.remove("logging_enabled"))},ZR=function(...o){if(!0===xS&&(xS=!1,null===YV&&!0===UY.get("logging_enabled")&&koe(!0)),YV){const e=h7.apply(null,o);YV(e)}},X3=function(o){return function(...e){ZR(o,...e)}},cH=function(...o){const e="FIREBASE INTERNAL ERROR: "+h7(...o);V2.error(e)},CL=function(...o){const e=`FIREBASE FATAL ERROR: ${h7(...o)}`;throw V2.error(e),new Error(e)},_O=function(...o){const e="FIREBASE WARNING: "+h7(...o);V2.warn(e)},HP=function(o){return"number"==typeof o&&(o!=o||o===Number.POSITIVE_INFINITY||o===Number.NEGATIVE_INFINITY)},TU="[MIN_NAME]",TM="[MAX_NAME]",JV=function(o,e){if(o===e)return 0;if(o===TU||e===TM)return-1;if(e===TU||o===TM)return 1;{const i=fH(o),d=fH(e);return null!==i?null!==d?i-d==0?o.length-e.length:i-d:-1:null!==d?1:o<e?-1:1}},lH=function(o,e){return o===e?0:o<e?-1:1},$V=function(o,e){if(e&&o in e)return e[o];throw new Error("Missing required key ("+o+") in object: "+(0,M_.Pz)(e))},f7=function(o){if("object"!=typeof o||null===o)return(0,M_.Pz)(o);const e=[];for(const d in o)e.push(d);e.sort();let i="{";for(let d=0;d<e.length;d++)0!==d&&(i+=","),i+=(0,M_.Pz)(e[d]),i+=":",i+=f7(o[e[d]]);return i+="}",i},e4=function(o,e){const i=o.length;if(i<=e)return[o];const d=[];for(let _=0;_<i;_+=e)d.push(o.substring(_,_+e>i?i:_+e));return d};function JS(o,e){for(const i in o)o.hasOwnProperty(i)&&e(i,o[i])}const dH=function(o){(0,M_.hu)(!HP(o),"Invalid JSON number");const d=1023;let _,B,_t,_a,_h;0===o?(B=0,_t=0,_=1/o==-1/0?1:0):(_=o<0,(o=Math.abs(o))>=Math.pow(2,1-d)?(_a=Math.min(Math.floor(Math.log(o)/Math.LN2),d),B=_a+d,_t=Math.round(o*Math.pow(2,52-_a)-Math.pow(2,52))):(B=0,_t=Math.round(o/Math.pow(2,-1074))));const _g=[];for(_h=52;_h;_h-=1)_g.push(_t%2?1:0),_t=Math.floor(_t/2);for(_h=11;_h;_h-=1)_g.push(B%2?1:0),B=Math.floor(B/2);_g.push(_?1:0),_g.reverse();const l_=_g.join("");let f_="";for(_h=0;_h<64;_h+=8){let R_=parseInt(l_.substr(_h,8),2).toString(16);1===R_.length&&(R_="0"+R_),f_+=R_}return f_.toLowerCase()},t4=new RegExp("^-?(0*)\\d{1,10}$"),hH=-2147483648,jY=2147483647,fH=function(o){if(t4.test(o)){const e=Number(o);if(e>=hH&&e<=jY)return e}return null},SU=function(o){try{o()}catch(e){setTimeout(()=>{throw _O("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},qP=function(o,e){const i=setTimeout(o,e);return"object"==typeof i&&i.unref&&i.unref(),i};class Poe{constructor(e,i){this.appName_=e,this.appCheckProvider=i,this.appCheck=null==i?void 0:i.getImmediate({optional:!0}),this.appCheck||null==i||i.get().then(d=>this.appCheck=d)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((i,d)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(i,d):i(null)},0)})}addTokenChangeListener(e){var i;null===(i=this.appCheckProvider)||void 0===i||i.get().then(d=>d.addTokenListener(e))}notifyForInvalidToken(){_O(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class xoe{constructor(e,i,d){this.appName_=e,this.firebaseOptions_=i,this.authProvider_=d,this.auth_=null,this.auth_=d.getImmediate({optional:!0}),this.auth_||d.onInit(_=>this.auth_=_)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(i=>i&&"auth/token-not-initialized"===i.code?(ZR("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(i)):new Promise((i,d)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(i,d):i(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(i=>i.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(i=>i.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',_O(e)}}let lN=(()=>{class o{constructor(i){this.accessToken=i}getToken(i){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(i){i(this.accessToken)}removeTokenChangeListener(i){}notifyForInvalidToken(){}}return o.OWNER="owner",o})();const AH=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,GY="websocket",gee="long_polling";class QY{constructor(e,i,d,_,B=!1,_t="",_a=!1){this.secure=i,this.namespace=d,this.webSocketOnly=_,this.nodeAdmin=B,this.persistenceKey=_t,this.includeNamespaceInQueryParams=_a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=wU.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&wU.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function mee(o,e,i){let d;if((0,M_.hu)("string"==typeof e,"typeof type must == string"),(0,M_.hu)("object"==typeof i,"typeof params must == object"),e===GY)d=(o.secure?"wss://":"ws://")+o.internalHost+"/.ws?";else{if(e!==gee)throw new Error("Unknown connection type: "+e);d=(o.secure?"https://":"http://")+o.internalHost+"/.lp?"}(function Loe(o){return o.host!==o.internalHost||o.isCustomHost()||o.includeNamespaceInQueryParams})(o)&&(i.ns=o.namespace);const _=[];return JS(i,(B,_t)=>{_.push(B+"="+_t)}),d+_.join("&")}class Aee{constructor(){this.counters_={}}incrementCounter(e,i=1){(0,M_.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=i}get(){return(0,M_.p$)(this.counters_)}}const _ee={},yH={};function ZV(o){const e=o.toString();return _ee[e]||(_ee[e]=new Aee),_ee[e]}class Ode{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,i){this.closeAfterResponse=e,this.onClose=i,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,i){for(this.pendingResponses[e]=i;this.pendingResponses[this.currentResponseNum];){const d=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let _=0;_<d.length;++_)d[_]&&SU(()=>{this.onMessage_(d[_])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class H2{constructor(e,i,d,_,B,_t,_a){this.connId=e,this.repoInfo=i,this.applicationId=d,this.appCheckToken=_,this.authToken=B,this.transportSessionId=_t,this.lastSessionId=_a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=X3(e),this.stats_=ZV(i),this.urlFn=_h=>(this.appCheckToken&&(_h.ac=this.appCheckToken),mee(i,gee,_h))}open(e,i){this.curSegmentNum=0,this.onDisconnect_=i,this.myPacketOrderer=new Ode(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(o){if((0,M_.Yr)()||"complete"===document.readyState)o();else{let e=!1;const i=function(){document.body?e||(e=!0,o()):setTimeout(i,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",i,!1),window.addEventListener("load",i,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&i()}),window.attachEvent("onload",i))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new KY((...B)=>{const[_t,_a,_h,_g,l_]=B;if(this.incrementIncomingBytes_(B),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===_t)this.id=_a,this.password=_h;else{if("close"!==_t)throw new Error("Unrecognized command received: "+_t);_a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(_a,()=>{this.onClosed_()})):this.onClosed_()}},(...B)=>{const[_t,_a]=B;this.incrementIncomingBytes_(B),this.myPacketOrderer.handleResponse(_t,_a)},()=>{this.onClosed_()},this.urlFn);const d={start:"t"};d.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(d.cb=this.scriptTagHolder.uniqueCallbackIdentifier),d.v="5",this.transportSessionId&&(d.s=this.transportSessionId),this.lastSessionId&&(d.ls=this.lastSessionId),this.applicationId&&(d.p=this.applicationId),this.appCheckToken&&(d.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&AH.test(location.hostname)&&(d.r="f");const _=this.urlFn(d);this.log_("Connecting via long-poll to "+_),this.scriptTagHolder.addTag(_,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){H2.forceAllow_=!0}static forceDisallow(){H2.forceDisallow_=!0}static isAvailable(){return!((0,M_.Yr)()||!H2.forceAllow_&&(H2.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const i=(0,M_.Pz)(e);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);const d=(0,M_.h$)(i),_=e4(d,1840);for(let B=0;B<_.length;B++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,_.length,_[B]),this.curSegmentNum++}addDisconnectPingFrame(e,i){if((0,M_.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const d={dframe:"t"};d.id=e,d.pw=i,this.myDisconnFrame.src=this.urlFn(d),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const i=(0,M_.Pz)(e).length;this.bytesReceived+=i,this.stats_.incrementCounter("bytes_received",i)}}class KY{constructor(e,i,d,_){if(this.onDisconnect=d,this.urlFn=_,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,M_.Yr)())this.commandCB=e,this.onMessageCB=i;else{this.uniqueCallbackIdentifier=aH(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=i,this.myIFrame=KY.createIFrame_();let B="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(B='<script>document.domain="'+document.domain+'";<\/script>');const _t="<html><body>"+B+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(_t),this.myIFrame.doc.close()}catch(_a){ZR("frame writing exception"),_a.stack&&ZR(_a.stack),ZR(_a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||ZR("No IE domain setting required")}catch(i){const d=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+d+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,i){for(this.myID=e,this.myPW=i,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let i=this.urlFn(e),d="",_=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+d.length<=1870;){const _t=this.pendingSegs.shift();d=d+"&seg"+_+"="+_t.seg+"&ts"+_+"="+_t.ts+"&d"+_+"="+_t.d,_++}return i+=d,this.addLongPollTag_(i,this.currentSerial),!0}return!1}enqueueSegment(e,i,d){this.pendingSegs.push({seg:e,ts:i,d}),this.alive&&this.newRequest_()}addLongPollTag_(e,i){this.outstandingRequests.add(i);const d=()=>{this.outstandingRequests.delete(i),this.newRequest_()},_=setTimeout(d,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(_),d()})}addTag(e,i){(0,M_.Yr)()?this.doNodeLongPoll(e,i):setTimeout(()=>{try{if(!this.sendNewPolls)return;const d=this.myIFrame.doc.createElement("script");d.type="text/javascript",d.async=!0,d.src=e,d.onload=d.onreadystatechange=function(){const _=d.readyState;(!_||"loaded"===_||"complete"===_)&&(d.onload=d.onreadystatechange=null,d.parentNode&&d.parentNode.removeChild(d),i())},d.onerror=()=>{ZR("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(d)}catch(d){}},Math.floor(1))}}let CH=null;"undefined"!=typeof MozWebSocket?CH=MozWebSocket:"undefined"!=typeof WebSocket&&(CH=WebSocket);let e8=(()=>{class o{constructor(i,d,_,B,_t,_a,_h){this.connId=i,this.applicationId=_,this.appCheckToken=B,this.authToken=_t,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=X3(this.connId),this.stats_=ZV(d),this.connURL=o.connectionURL_(d,_a,_h,B,_),this.nodeAdmin=d.nodeAdmin}static connectionURL_(i,d,_,B,_t){const _a={v:"5"};return!(0,M_.Yr)()&&"undefined"!=typeof location&&location.hostname&&AH.test(location.hostname)&&(_a.r="f"),d&&(_a.s=d),_&&(_a.ls=_),B&&(_a.ac=B),_t&&(_a.p=_t),mee(i,GY,_a)}open(i,d){this.onDisconnect=d,this.onMessage=i,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,wU.set("previous_websocket_failure",!0);try{let _;if((0,M_.Yr)()){const _t={headers:{"User-Agent":`Firebase/5/${CU}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(_t.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(_t.headers["X-Firebase-AppCheck"]=this.appCheckToken);const _a=process.env,_h=0===this.connURL.indexOf("wss://")?_a.HTTPS_PROXY||_a.https_proxy:_a.HTTP_PROXY||_a.http_proxy;_h&&(_t.proxy={origin:_h})}this.mySock=new CH(this.connURL,[],_)}catch(_){this.log_("Error instantiating WebSocket.");const B=_.message||_.data;return B&&this.log_(B),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=_=>{this.handleIncomingFrame(_)},this.mySock.onerror=_=>{this.log_("WebSocket error.  Closing connection.");const B=_.message||_.data;B&&this.log_(B),this.onClosed_()}}start(){}static forceDisallow(){o.forceDisallow_=!0}static isAvailable(){let i=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const _=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);_&&_.length>1&&parseFloat(_[1])<4.4&&(i=!0)}return!i&&null!==CH&&!o.forceDisallow_}static previouslyFailed(){return wU.isInMemoryStorage||!0===wU.get("previous_websocket_failure")}markConnectionHealthy(){wU.remove("previous_websocket_failure")}appendFrame_(i){if(this.frames.push(i),this.frames.length===this.totalFrames){const d=this.frames.join("");this.frames=null;const _=(0,M_.cI)(d);this.onMessage(_)}}handleNewFrameCount_(i){this.totalFrames=i,this.frames=[]}extractFrameCount_(i){if((0,M_.hu)(null===this.frames,"We already have a frame buffer"),i.length<=6){const d=Number(i);if(!isNaN(d))return this.handleNewFrameCount_(d),null}return this.handleNewFrameCount_(1),i}handleIncomingFrame(i){if(null===this.mySock)return;const d=i.data;if(this.bytesReceived+=d.length,this.stats_.incrementCounter("bytes_received",d.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(d);else{const _=this.extractFrameCount_(d);null!==_&&this.appendFrame_(_)}}send(i){this.resetKeepAlive();const d=(0,M_.Pz)(i);this.bytesSent+=d.length,this.stats_.incrementCounter("bytes_sent",d.length);const _=e4(d,16384);_.length>1&&this.sendString_(String(_.length));for(let B=0;B<_.length;B++)this.sendString_(_[B])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(i){try{this.mySock.send(i)}catch(d){this.log_("Exception thrown from WebSocket.send():",d.message||d.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return o.responsesRequiredToBeHealthy=2,o.healthyTimeout=3e4,o})(),Cee=(()=>{class o{constructor(i){this.initTransports_(i)}static get ALL_TRANSPORTS(){return[H2,e8]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(i){const d=e8&&e8.isAvailable();let _=d&&!e8.previouslyFailed();if(i.webSocketOnly&&(d||_O("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),_=!0),_)this.transports_=[e8];else{const B=this.transports_=[];for(const _t of o.ALL_TRANSPORTS)_t&&_t.isAvailable()&&B.push(_t);o.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return o.globalTransportInitialized_=!1,o})();class U5{constructor(e,i,d,_,B,_t,_a,_h,_g,l_){this.id=e,this.repoInfo_=i,this.applicationId_=d,this.appCheckToken_=_,this.authToken_=B,this.onMessage_=_t,this.onReady_=_a,this.onDisconnect_=_h,this.onKill_=_g,this.lastSessionId=l_,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=X3("c:"+this.id+":"),this.transportManager_=new Cee(i),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const i=this.connReceiver_(this.conn_),d=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(i,d)},Math.floor(0));const _=e.healthyTimeout||0;_>0&&(this.healthyTimeout_=qP(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(_)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return i=>{e===this.conn_?this.onConnectionLost_(i):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return i=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(i):e===this.secondaryConn_?this.onSecondaryMessageReceived_(i):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const i=e.t;"a"===i?this.upgradeIfSecondaryHealthy_():"r"===i?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===i&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const i=$V("t",e),d=$V("d",e);if("c"===i)this.onSecondaryControl_(d);else{if("d"!==i)throw new Error("Unknown protocol layer: "+i);this.pendingDataMessages.push(d)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const i=$V("t",e),d=$V("d",e);"c"===i?this.onControl_(d):"d"===i&&this.onDataMessage_(d)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const i=$V("t",e);if("d"in e){const d=e.d;if("h"===i)this.onHandshake_(d);else if("n"===i){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let _=0;_<this.pendingDataMessages.length;++_)this.onDataMessage_(this.pendingDataMessages[_]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===i?this.onConnectionShutdown_(d):"r"===i?this.onReset_(d):"e"===i?cH("Server Error: "+d):"o"===i?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):cH("Unknown control packet command: "+i)}}onHandshake_(e){const i=e.ts,d=e.v,_=e.h;this.sessionId=e.s,this.repoInfo_.host=_,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,i),"5"!==d&&_O("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const i=this.connReceiver_(this.secondaryConn_),d=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(i,d),qP(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,i){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(i,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):qP(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(wU.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class OU{put(e,i,d,_){}merge(e,i,d,_){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,i,d){}onDisconnectMerge(e,i,d){}onDisconnectCancel(e,i){}reportStats(e){}}class DU{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,M_.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...i){if(Array.isArray(this.listeners_[e])){const d=[...this.listeners_[e]];for(let _=0;_<d.length;_++)d[_].callback.apply(d[_].context,i)}}on(e,i,d){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:i,context:d});const _=this.getInitialEvent(e);_&&i.apply(d,_)}off(e,i,d){this.validateEventType_(e);const _=this.listeners_[e]||[];for(let B=0;B<_.length;B++)if(_[B].callback===i&&(!d||d===_[B].context))return void _.splice(B,1)}validateEventType_(e){(0,M_.hu)(this.allowedEvents_.find(i=>i===e),"Unknown event: "+e)}}class dN extends DU{constructor(){super(["online"]),this.online_=!0,"undefined"!=typeof window&&void 0!==window.addEventListener&&!(0,M_.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new dN}getInitialEvent(e){return(0,M_.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class z1{constructor(e,i){if(void 0===i){this.pieces_=e.split("/");let d=0;for(let _=0;_<this.pieces_.length;_++)this.pieces_[_].length>0&&(this.pieces_[d]=this.pieces_[_],d++);this.pieces_.length=d,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=i}toString(){let e="";for(let i=this.pieceNum_;i<this.pieces_.length;i++)""!==this.pieces_[i]&&(e+="/"+this.pieces_[i]);return e||"/"}}function U1(){return new z1("")}function y1(o){return o.pieceNum_>=o.pieces_.length?null:o.pieces_[o.pieceNum_]}function NU(o){return o.pieces_.length-o.pieceNum_}function ET(o){let e=o.pieceNum_;return e<o.pieces_.length&&e++,new z1(o.pieces_,e)}function TH(o){return o.pieceNum_<o.pieces_.length?o.pieces_[o.pieces_.length-1]:null}function o4(o,e=0){return o.pieces_.slice(o.pieceNum_+e)}function $Y(o){if(o.pieceNum_>=o.pieces_.length)return null;const e=[];for(let i=o.pieceNum_;i<o.pieces_.length-1;i++)e.push(o.pieces_[i]);return new z1(e,0)}function IT(o,e){const i=[];for(let d=o.pieceNum_;d<o.pieces_.length;d++)i.push(o.pieces_[d]);if(e instanceof z1)for(let d=e.pieceNum_;d<e.pieces_.length;d++)i.push(e.pieces_[d]);else{const d=e.split("/");for(let _=0;_<d.length;_++)d[_].length>0&&i.push(d[_])}return new z1(i,0)}function S1(o){return o.pieceNum_>=o.pieces_.length}function VO(o,e){const i=y1(o),d=y1(e);if(null===i)return e;if(i===d)return VO(ET(o),ET(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+o+")")}function Tee(o,e){const i=o4(o,0),d=o4(e,0);for(let _=0;_<i.length&&_<d.length;_++){const B=JV(i[_],d[_]);if(0!==B)return B}return i.length===d.length?0:i.length<d.length?-1:1}function SH(o,e){if(NU(o)!==NU(e))return!1;for(let i=o.pieceNum_,d=e.pieceNum_;i<=o.pieces_.length;i++,d++)if(o.pieces_[i]!==e.pieces_[d])return!1;return!0}function zN(o,e){let i=o.pieceNum_,d=e.pieceNum_;if(NU(o)>NU(e))return!1;for(;i<o.pieces_.length;){if(o.pieces_[i]!==e.pieces_[d])return!1;++i,++d}return!0}class See{constructor(e,i){this.errorPrefix_=i,this.parts_=o4(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let d=0;d<this.parts_.length;d++)this.byteLength_+=(0,M_.ug)(this.parts_[d]);Ree(this)}}function Ree(o){if(o.byteLength_>768)throw new Error(o.errorPrefix_+"has a key path longer than 768 bytes ("+o.byteLength_+").");if(o.parts_.length>32)throw new Error(o.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+s4(o))}function s4(o){return 0===o.parts_.length?"":"in property '"+o.parts_.join(".")+"'"}class ZY extends DU{constructor(){let e,i;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(i="visibilitychange",e="hidden"):void 0!==document.mozHidden?(i="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(i="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(i="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,i&&document.addEventListener(i,()=>{const d=!document[e];d!==this.visible_&&(this.visible_=d,this.trigger("visible",d))},!1)}static getInstance(){return new ZY}getInitialEvent(e){return(0,M_.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const n8=1e3;let r8,F5=(()=>{class o extends OU{constructor(i,d,_,B,_t,_a,_h,_g){if(super(),this.repoInfo_=i,this.applicationId_=d,this.onDataUpdate_=_,this.onConnectStatus_=B,this.onServerInfoUpdate_=_t,this.authTokenProvider_=_a,this.appCheckTokenProvider_=_h,this.authOverride_=_g,this.id=o.nextPersistentConnectionId_++,this.log_=X3("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=n8,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,_g&&!(0,M_.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ZY.getInstance().on("visible",this.onVisible_,this),-1===i.host.indexOf("fblocal")&&dN.getInstance().on("online",this.onOnline_,this)}sendRequest(i,d,_){const B=++this.requestNumber_,_t={r:B,a:i,b:d};this.log_((0,M_.Pz)(_t)),(0,M_.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(_t),_&&(this.requestCBHash_[B]=_)}get(i){this.initConnection_();const d=new M_.BH,_={p:i._path.toString(),q:i._queryObject},B={action:"g",request:_,onComplete:_a=>{const _h=_a.d;"ok"===_a.s?(this.onDataUpdate_(_.p,_h,!1,null),d.resolve(_h)):d.reject(_h)}};this.outstandingGets_.push(B),this.outstandingGetCount_++;const _t=this.outstandingGets_.length-1;return this.connected_||setTimeout(()=>{const _a=this.outstandingGets_[_t];void 0===_a||B!==_a||(delete this.outstandingGets_[_t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+_t+" timed out on connection"),d.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(_t),d.promise}listen(i,d,_,B){this.initConnection_();const _t=i._queryIdentifier,_a=i._path.toString();this.log_("Listen called for "+_a+" "+_t),this.listens.has(_a)||this.listens.set(_a,new Map),(0,M_.hu)(i._queryParams.isDefault()||!i._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,M_.hu)(!this.listens.get(_a).has(_t),"listen() called twice for same path/queryId.");const _h={onComplete:B,hashFn:d,query:i,tag:_};this.listens.get(_a).set(_t,_h),this.connected_&&this.sendListen_(_h)}sendGet_(i){const d=this.outstandingGets_[i];this.sendRequest("g",d.request,_=>{delete this.outstandingGets_[i],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),d.onComplete&&d.onComplete(_)})}sendListen_(i){const d=i.query,_=d._path.toString(),B=d._queryIdentifier;this.log_("Listen on "+_+" for "+B);const _t={p:_};i.tag&&(_t.q=d._queryObject,_t.t=i.tag),_t.h=i.hashFn(),this.sendRequest("q",_t,_h=>{const _g=_h.d,l_=_h.s;o.warnOnListenWarnings_(_g,d),(this.listens.get(_)&&this.listens.get(_).get(B))===i&&(this.log_("listen response",_h),"ok"!==l_&&this.removeListen_(_,B),i.onComplete&&i.onComplete(l_,_g))})}static warnOnListenWarnings_(i,d){if(i&&"object"==typeof i&&(0,M_.r3)(i,"w")){const _=(0,M_.DV)(i,"w");if(Array.isArray(_)&&~_.indexOf("no_index")){const B='".indexOn": "'+d._queryParams.getIndex().toString()+'"',_t=d._path.toString();_O(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${B} at ${_t} to your security rules for better performance.`)}}}refreshAuthToken(i){this.authToken_=i,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(i)}reduceReconnectDelayIfAdminCredential_(i){(i&&40===i.length||(0,M_.GJ)(i))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(i){this.appCheckToken_=i,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const i=this.authToken_,d=(0,M_.w9)(i)?"auth":"gauth",_={cred:i};null===this.authOverride_?_.noauth=!0:"object"==typeof this.authOverride_&&(_.authvar=this.authOverride_),this.sendRequest(d,_,B=>{const _t=B.s,_a=B.d||"error";this.authToken_===i&&("ok"===_t?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(_t,_a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},i=>{const d=i.s,_=i.d||"error";"ok"===d?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(d,_)})}unlisten(i,d){const _=i._path.toString(),B=i._queryIdentifier;this.log_("Unlisten called for "+_+" "+B),(0,M_.hu)(i._queryParams.isDefault()||!i._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(_,B)&&this.connected_&&this.sendUnlisten_(_,B,i._queryObject,d)}sendUnlisten_(i,d,_,B){this.log_("Unlisten on "+i+" for "+d);const _t={p:i};B&&(_t.q=_,_t.t=B),this.sendRequest("n",_t)}onDisconnectPut(i,d,_){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",i,d,_):this.onDisconnectRequestQueue_.push({pathString:i,action:"o",data:d,onComplete:_})}onDisconnectMerge(i,d,_){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",i,d,_):this.onDisconnectRequestQueue_.push({pathString:i,action:"om",data:d,onComplete:_})}onDisconnectCancel(i,d){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",i,null,d):this.onDisconnectRequestQueue_.push({pathString:i,action:"oc",data:null,onComplete:d})}sendOnDisconnect_(i,d,_,B){const _t={p:d,d:_};this.log_("onDisconnect "+i,_t),this.sendRequest(i,_t,_a=>{B&&setTimeout(()=>{B(_a.s,_a.d)},Math.floor(0))})}put(i,d,_,B){this.putInternal("p",i,d,_,B)}merge(i,d,_,B){this.putInternal("m",i,d,_,B)}putInternal(i,d,_,B,_t){this.initConnection_();const _a={p:d,d:_};void 0!==_t&&(_a.h=_t),this.outstandingPuts_.push({action:i,request:_a,onComplete:B}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+d)}sendPut_(i){const d=this.outstandingPuts_[i].action,_=this.outstandingPuts_[i].request,B=this.outstandingPuts_[i].onComplete;this.outstandingPuts_[i].queued=this.connected_,this.sendRequest(d,_,_t=>{this.log_(d+" response",_t),delete this.outstandingPuts_[i],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),B&&B(_t.s,_t.d)})}reportStats(i){if(this.connected_){const d={c:i};this.log_("reportStats",d),this.sendRequest("s",d,_=>{"ok"!==_.s&&this.log_("reportStats","Error sending stats: "+_.d)})}}onDataMessage_(i){if("r"in i){this.log_("from server: "+(0,M_.Pz)(i));const d=i.r,_=this.requestCBHash_[d];_&&(delete this.requestCBHash_[d],_(i.b))}else{if("error"in i)throw"A server-side error has occurred: "+i.error;"a"in i&&this.onDataPush_(i.a,i.b)}}onDataPush_(i,d){this.log_("handleServerMessage",i,d),"d"===i?this.onDataUpdate_(d.p,d.d,!1,d.t):"m"===i?this.onDataUpdate_(d.p,d.d,!0,d.t):"c"===i?this.onListenRevoked_(d.p,d.q):"ac"===i?this.onAuthRevoked_(d.s,d.d):"apc"===i?this.onAppCheckRevoked_(d.s,d.d):"sd"===i?this.onSecurityDebugPacket_(d):cH("Unrecognized action received from server: "+(0,M_.Pz)(i)+"\nAre you using the latest client?")}onReady_(i,d){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(i),this.lastSessionId=d,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(i){(0,M_.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(i))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(i){i&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=n8,this.realtime_||this.scheduleConnect_(0)),this.visible_=i}onOnline_(i){i?(this.log_("Browser went online."),this.reconnectDelay_=n8,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=n8),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const i=(new Date).getTime()-this.lastConnectionAttemptTime_;let d=Math.max(0,this.reconnectDelay_-i);d=Math.random()*d,this.log_("Trying to reconnect in "+d+"ms"),this.scheduleConnect_(d),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var i=this;return(0,C0.Z)(function*(){if(i.shouldReconnect_()){i.log_("Making a connection attempt"),i.lastConnectionAttemptTime_=(new Date).getTime(),i.lastConnectionEstablishedTime_=null;const d=i.onDataMessage_.bind(i),_=i.onReady_.bind(i),B=i.onRealtimeDisconnect_.bind(i),_t=i.id+":"+o.nextConnectionId_++,_a=i.lastSessionId;let _h=!1,_g=null;const l_=function(){_g?_g.close():(_h=!0,B())};i.realtime_={close:l_,sendRequest:function(H_){(0,M_.hu)(_g,"sendRequest call when we're not connected not allowed."),_g.sendRequest(H_)}};const R_=i.forceTokenRefresh_;i.forceTokenRefresh_=!1;try{const[H_,W_]=yield Promise.all([i.authTokenProvider_.getToken(R_),i.appCheckTokenProvider_.getToken(R_)]);_h?ZR("getToken() completed but was canceled"):(ZR("getToken() completed. Creating connection."),i.authToken_=H_&&H_.accessToken,i.appCheckToken_=W_&&W_.token,_g=new U5(_t,i.repoInfo_,i.applicationId_,i.appCheckToken_,i.authToken_,d,_,B,R0=>{_O(R0+" ("+i.repoInfo_.toString()+")"),i.interrupt("server_kill")},_a))}catch(H_){i.log_("Failed to get token: "+H_),_h||(i.repoInfo_.nodeAdmin&&_O(H_),l_())}}})()}interrupt(i){ZR("Interrupting connection for reason: "+i),this.interruptReasons_[i]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(i){ZR("Resuming connection for reason: "+i),delete this.interruptReasons_[i],(0,M_.xb)(this.interruptReasons_)&&(this.reconnectDelay_=n8,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(i){const d=i-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:d})}cancelSentTransactions_(){for(let i=0;i<this.outstandingPuts_.length;i++){const d=this.outstandingPuts_[i];d&&"h"in d.request&&d.queued&&(d.onComplete&&d.onComplete("disconnect"),delete this.outstandingPuts_[i],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(i,d){let _;_=d?d.map(_t=>f7(_t)).join("$"):"default";const B=this.removeListen_(i,_);B&&B.onComplete&&B.onComplete("permission_denied")}removeListen_(i,d){const _=new z1(i).toString();let B;if(this.listens.has(_)){const _t=this.listens.get(_);B=_t.get(d),_t.delete(d),0===_t.size&&this.listens.delete(_)}else B=void 0;return B}onAuthRevoked_(i,d){ZR("Auth token revoked: "+i+"/"+d),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===i||"permission_denied"===i)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(i,d){ZR("App check token revoked: "+i+"/"+d),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===i||"permission_denied"===i)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(i){this.securityDebugCallback_?this.securityDebugCallback_(i):"msg"in i&&console.log("FIREBASE: "+i.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const i of this.listens.values())for(const d of i.values())this.sendListen_(d);for(let i=0;i<this.outstandingPuts_.length;i++)this.outstandingPuts_[i]&&this.sendPut_(i);for(;this.onDisconnectRequestQueue_.length;){const i=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(i.action,i.pathString,i.data,i.onComplete)}for(let i=0;i<this.outstandingGets_.length;i++)this.outstandingGets_[i]&&this.sendGet_(i)}sendConnectStats_(){const i={};let d="js";(0,M_.Yr)()&&(d=this.repoInfo_.nodeAdmin?"admin_node":"node"),i["sdk."+d+"."+CU.replace(/\./g,"-")]=1,(0,M_.uI)()?i["framework.cordova"]=1:(0,M_.b$)()&&(i["framework.reactnative"]=1),this.reportStats(i)}shouldReconnect_(){const i=dN.getInstance().currentlyOnline();return(0,M_.xb)(this.interruptReasons_)&&i}}return o.nextPersistentConnectionId_=0,o.nextConnectionId_=0,o})();class F1{constructor(e,i){this.name=e,this.node=i}static Wrap(e,i){return new F1(e,i)}}class nJ{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,i){const d=new F1(TU,e),_=new F1(TU,i);return 0!==this.compare(d,_)}minPost(){return F1.MIN}}class rJ extends nJ{static get __EMPTY_NODE(){return r8}static set __EMPTY_NODE(e){r8=e}compare(e,i){return JV(e.name,i.name)}isDefinedOn(e){throw(0,M_.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,i){return!1}minPost(){return F1.MIN}maxPost(){return new F1(TM,r8)}makePost(e,i){return(0,M_.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new F1(e,r8)}toString(){return".key"}}const kU=new rJ;class OH{constructor(e,i,d,_,B=null){this.isReverse_=_,this.resultGenerator_=B,this.nodeStack_=[];let _t=1;for(;!e.isEmpty();)if(e=e,_t=i?d(e.key,i):1,_&&(_t*=-1),_t<0)e=this.isReverse_?e.left:e.right;else{if(0===_t){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let i,e=this.nodeStack_.pop();if(i=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return i}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let j5,vO=(()=>{class o{constructor(i,d,_,B,_t){this.key=i,this.value=d,this.color=null!=_?_:o.RED,this.left=null!=B?B:bR.EMPTY_NODE,this.right=null!=_t?_t:bR.EMPTY_NODE}copy(i,d,_,B,_t){return new o(null!=i?i:this.key,null!=d?d:this.value,null!=_?_:this.color,null!=B?B:this.left,null!=_t?_t:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(i){return this.left.inorderTraversal(i)||!!i(this.key,this.value)||this.right.inorderTraversal(i)}reverseTraversal(i){return this.right.reverseTraversal(i)||i(this.key,this.value)||this.left.reverseTraversal(i)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(i,d,_){let B=this;const _t=_(i,B.key);return B=_t<0?B.copy(null,null,null,B.left.insert(i,d,_),null):0===_t?B.copy(null,d,null,null,null):B.copy(null,null,null,null,B.right.insert(i,d,_)),B.fixUp_()}removeMin_(){if(this.left.isEmpty())return bR.EMPTY_NODE;let i=this;return!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.removeMin_(),null),i.fixUp_()}remove(i,d){let _,B;if(_=this,d(i,_.key)<0)!_.left.isEmpty()&&!_.left.isRed_()&&!_.left.left.isRed_()&&(_=_.moveRedLeft_()),_=_.copy(null,null,null,_.left.remove(i,d),null);else{if(_.left.isRed_()&&(_=_.rotateRight_()),!_.right.isEmpty()&&!_.right.isRed_()&&!_.right.left.isRed_()&&(_=_.moveRedRight_()),0===d(i,_.key)){if(_.right.isEmpty())return bR.EMPTY_NODE;B=_.right.min_(),_=_.copy(B.key,B.value,null,null,_.right.removeMin_())}_=_.copy(null,null,null,null,_.right.remove(i,d))}return _.fixUp_()}isRed_(){return this.color}fixUp_(){let i=this;return i.right.isRed_()&&!i.left.isRed_()&&(i=i.rotateLeft_()),i.left.isRed_()&&i.left.left.isRed_()&&(i=i.rotateRight_()),i.left.isRed_()&&i.right.isRed_()&&(i=i.colorFlip_()),i}moveRedLeft_(){let i=this.colorFlip_();return i.right.left.isRed_()&&(i=i.copy(null,null,null,null,i.right.rotateRight_()),i=i.rotateLeft_(),i=i.colorFlip_()),i}moveRedRight_(){let i=this.colorFlip_();return i.left.left.isRed_()&&(i=i.rotateRight_(),i=i.colorFlip_()),i}rotateLeft_(){const i=this.copy(null,null,o.RED,null,this.right.left);return this.right.copy(null,null,this.color,i,null)}rotateRight_(){const i=this.copy(null,null,o.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,i)}colorFlip_(){const i=this.left.copy(null,null,!this.left.color,null,null),d=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,i,d)}checkMaxDepth_(){const i=this.check_();return Math.pow(2,i)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const i=this.left.check_();if(i!==this.right.check_())throw new Error("Black depths differ");return i+(this.isRed_()?0:1)}}return o.RED=!0,o.BLACK=!1,o})();class bR{constructor(e,i=bR.EMPTY_NODE){this.comparator_=e,this.root_=i}insert(e,i){return new bR(this.comparator_,this.root_.insert(e,i,this.comparator_).copy(null,null,vO.BLACK,null,null))}remove(e){return new bR(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,vO.BLACK,null,null))}get(e){let i,d=this.root_;for(;!d.isEmpty();){if(i=this.comparator_(e,d.key),0===i)return d.value;i<0?d=d.left:i>0&&(d=d.right)}return null}getPredecessorKey(e){let i,d=this.root_,_=null;for(;!d.isEmpty();){if(i=this.comparator_(e,d.key),0===i){if(d.left.isEmpty())return _?_.key:null;for(d=d.left;!d.right.isEmpty();)d=d.right;return d.key}i<0?d=d.left:i>0&&(_=d,d=d.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new OH(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,i){return new OH(this.root_,e,this.comparator_,!1,i)}getReverseIteratorFrom(e,i){return new OH(this.root_,e,this.comparator_,!0,i)}getReverseIterator(e){return new OH(this.root_,null,this.comparator_,!0,e)}}function Dee(o,e){return JV(o.name,e.name)}function a4(o,e){return JV(o,e)}bR.EMPTY_NODE=new class DH{copy(e,i,d,_,B){return this}insert(e,i,d){return new vO(e,i,null)}remove(e,i){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const iJ=function(o){return"number"==typeof o?"number:"+dH(o):"string:"+o},NH=function(o){if(o.isLeafNode()){const e=o.val();(0,M_.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,M_.r3)(e,".sv"),"Priority must be a string or number.")}else(0,M_.hu)(o===j5||o.isEmpty(),"priority of unexpected type.");(0,M_.hu)(o===j5||o.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let oJ,Nee,kee,V5=(()=>{class o{constructor(i,d=o.__childrenNodeConstructor.EMPTY_NODE){this.value_=i,this.priorityNode_=d,this.lazyHash_=null,(0,M_.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),NH(this.priorityNode_)}static set __childrenNodeConstructor(i){oJ=i}static get __childrenNodeConstructor(){return oJ}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(i){return new o(this.value_,i)}getImmediateChild(i){return".priority"===i?this.priorityNode_:o.__childrenNodeConstructor.EMPTY_NODE}getChild(i){return S1(i)?this:".priority"===y1(i)?this.priorityNode_:o.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(i,d){return null}updateImmediateChild(i,d){return".priority"===i?this.updatePriority(d):d.isEmpty()&&".priority"!==i?this:o.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(i,d).updatePriority(this.priorityNode_)}updateChild(i,d){const _=y1(i);return null===_?d:d.isEmpty()&&".priority"!==_?this:((0,M_.hu)(".priority"!==_||1===NU(i),".priority must be the last token in a path"),this.updateImmediateChild(_,o.__childrenNodeConstructor.EMPTY_NODE.updateChild(ET(i),d)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(i,d){return!1}val(i){return i&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let i="";this.priorityNode_.isEmpty()||(i+="priority:"+iJ(this.priorityNode_.val())+":");const d=typeof this.value_;i+=d+":",i+="number"===d?dH(this.value_):this.value_,this.lazyHash_=Z3(i)}return this.lazyHash_}getValue(){return this.value_}compareTo(i){return i===o.__childrenNodeConstructor.EMPTY_NODE?1:i instanceof o.__childrenNodeConstructor?-1:((0,M_.hu)(i.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(i))}compareToLeafNode_(i){const d=typeof i.value_,_=typeof this.value_,B=o.VALUE_TYPE_ORDER.indexOf(d),_t=o.VALUE_TYPE_ORDER.indexOf(_);return(0,M_.hu)(B>=0,"Unknown leaf type: "+d),(0,M_.hu)(_t>=0,"Unknown leaf type: "+_),B===_t?"object"===_?0:this.value_<i.value_?-1:this.value_===i.value_?0:1:_t-B}withIndex(){return this}isIndexed(){return!0}equals(i){if(i===this)return!0;if(i.isLeafNode()){const d=i;return this.value_===d.value_&&this.priorityNode_.equals(d.priorityNode_)}return!1}}return o.VALUE_TYPE_ORDER=["object","boolean","number","string"],o})();const DT=new class Lee extends nJ{compare(e,i){const d=e.node.getPriority(),_=i.node.getPriority(),B=d.compareTo(_);return 0===B?JV(e.name,i.name):B}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,i){return!e.getPriority().equals(i.getPriority())}minPost(){return F1.MIN}maxPost(){return new F1(TM,new V5("[PRIORITY-POST]",kee))}makePost(e,i){const d=Nee(e);return new F1(i,new V5("[PRIORITY-POST]",d))}toString(){return".priority"}},sJ=Math.log(2);class zoe{constructor(e){this.count=parseInt(Math.log(e+1)/sJ,10),this.current_=this.count-1;const _=(B=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&_}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const c4=function(o,e,i,d){o.sort(e);const _=function(_h,_g){const l_=_g-_h;let f_,R_;if(0===l_)return null;if(1===l_)return f_=o[_h],R_=i?i(f_):f_,new vO(R_,f_.node,vO.BLACK,null,null);{const H_=parseInt(l_/2,10)+_h,W_=_(_h,H_),R0=_(H_+1,_g);return f_=o[H_],R_=i?i(f_):f_,new vO(R_,f_.node,vO.BLACK,W_,R0)}},_a=function(_h){let _g=null,l_=null,f_=o.length;const R_=function(W_,R0){const H0=f_-W_,CI=f_;f_-=W_;const LI=_(H0+1,CI),xI=o[H0],DI=i?i(xI):xI;H_(new vO(DI,xI.node,R0,null,LI))},H_=function(W_){_g?(_g.left=W_,_g=W_):(l_=W_,_g=W_)};for(let W_=0;W_<_h.count;++W_){const R0=_h.nextBitIsOne(),H0=Math.pow(2,_h.count-(W_+1));R0?R_(H0,vO.BLACK):(R_(H0,vO.BLACK),R_(H0,vO.RED))}return l_}(new zoe(o.length));return new bR(d||e,_a)};let kH;const m7={};class YN{constructor(e,i){this.indexes_=e,this.indexSet_=i}static get Default(){return(0,M_.hu)(m7&&DT,"ChildrenNode.ts has not been loaded"),kH=kH||new YN({".priority":m7},{".priority":DT}),kH}get(e){const i=(0,M_.DV)(this.indexes_,e);if(!i)throw new Error("No index defined for "+e);return i instanceof bR?i:null}hasIndex(e){return(0,M_.r3)(this.indexSet_,e.toString())}addIndex(e,i){(0,M_.hu)(e!==kU,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const d=[];let _=!1;const B=i.getIterator(F1.Wrap);let _a,_t=B.getNext();for(;_t;)_=_||e.isDefinedOn(_t.node),d.push(_t),_t=B.getNext();_a=_?c4(d,e.getCompare()):m7;const _h=e.toString(),_g=Object.assign({},this.indexSet_);_g[_h]=e;const l_=Object.assign({},this.indexes_);return l_[_h]=_a,new YN(l_,_g)}addToIndexes(e,i){const d=(0,M_.UI)(this.indexes_,(_,B)=>{const _t=(0,M_.DV)(this.indexSet_,B);if((0,M_.hu)(_t,"Missing index implementation for "+B),_===m7){if(_t.isDefinedOn(e.node)){const _a=[],_h=i.getIterator(F1.Wrap);let _g=_h.getNext();for(;_g;)_g.name!==e.name&&_a.push(_g),_g=_h.getNext();return _a.push(e),c4(_a,_t.getCompare())}return m7}{const _a=i.get(e.name);let _h=_;return _a&&(_h=_h.remove(new F1(e.name,_a))),_h.insert(e,e.node)}});return new YN(d,this.indexSet_)}removeFromIndexes(e,i){const d=(0,M_.UI)(this.indexes_,_=>{if(_===m7)return _;{const B=i.get(e.name);return B?_.remove(new F1(e.name,B)):_}});return new YN(d,this.indexSet_)}}let G5,m1=(()=>{class o{constructor(i,d,_){this.children_=i,this.priorityNode_=d,this.indexMap_=_,this.lazyHash_=null,this.priorityNode_&&NH(this.priorityNode_),this.children_.isEmpty()&&(0,M_.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return G5||(G5=new o(new bR(a4),null,YN.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||G5}updatePriority(i){return this.children_.isEmpty()?this:new o(this.children_,i,this.indexMap_)}getImmediateChild(i){if(".priority"===i)return this.getPriority();{const d=this.children_.get(i);return null===d?G5:d}}getChild(i){const d=y1(i);return null===d?this:this.getImmediateChild(d).getChild(ET(i))}hasChild(i){return null!==this.children_.get(i)}updateImmediateChild(i,d){if((0,M_.hu)(d,"We should always be passing snapshot nodes"),".priority"===i)return this.updatePriority(d);{const _=new F1(i,d);let B,_t;d.isEmpty()?(B=this.children_.remove(i),_t=this.indexMap_.removeFromIndexes(_,this.children_)):(B=this.children_.insert(i,d),_t=this.indexMap_.addToIndexes(_,this.children_));const _a=B.isEmpty()?G5:this.priorityNode_;return new o(B,_a,_t)}}updateChild(i,d){const _=y1(i);if(null===_)return d;{(0,M_.hu)(".priority"!==y1(i)||1===NU(i),".priority must be the last token in a path");const B=this.getImmediateChild(_).updateChild(ET(i),d);return this.updateImmediateChild(_,B)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(i){if(this.isEmpty())return null;const d={};let _=0,B=0,_t=!0;if(this.forEachChild(DT,(_a,_h)=>{d[_a]=_h.val(i),_++,_t&&o.INTEGER_REGEXP_.test(_a)?B=Math.max(B,Number(_a)):_t=!1}),!i&&_t&&B<2*_){const _a=[];for(const _h in d)_a[_h]=d[_h];return _a}return i&&!this.getPriority().isEmpty()&&(d[".priority"]=this.getPriority().val()),d}hash(){if(null===this.lazyHash_){let i="";this.getPriority().isEmpty()||(i+="priority:"+iJ(this.getPriority().val())+":"),this.forEachChild(DT,(d,_)=>{const B=_.hash();""!==B&&(i+=":"+d+":"+B)}),this.lazyHash_=""===i?"":Z3(i)}return this.lazyHash_}getPredecessorChildName(i,d,_){const B=this.resolveIndex_(_);if(B){const _t=B.getPredecessorKey(new F1(i,d));return _t?_t.name:null}return this.children_.getPredecessorKey(i)}getFirstChildName(i){const d=this.resolveIndex_(i);if(d){const _=d.minKey();return _&&_.name}return this.children_.minKey()}getFirstChild(i){const d=this.getFirstChildName(i);return d?new F1(d,this.children_.get(d)):null}getLastChildName(i){const d=this.resolveIndex_(i);if(d){const _=d.maxKey();return _&&_.name}return this.children_.maxKey()}getLastChild(i){const d=this.getLastChildName(i);return d?new F1(d,this.children_.get(d)):null}forEachChild(i,d){const _=this.resolveIndex_(i);return _?_.inorderTraversal(B=>d(B.name,B.node)):this.children_.inorderTraversal(d)}getIterator(i){return this.getIteratorFrom(i.minPost(),i)}getIteratorFrom(i,d){const _=this.resolveIndex_(d);if(_)return _.getIteratorFrom(i,B=>B);{const B=this.children_.getIteratorFrom(i.name,F1.Wrap);let _t=B.peek();for(;null!=_t&&d.compare(_t,i)<0;)B.getNext(),_t=B.peek();return B}}getReverseIterator(i){return this.getReverseIteratorFrom(i.maxPost(),i)}getReverseIteratorFrom(i,d){const _=this.resolveIndex_(d);if(_)return _.getReverseIteratorFrom(i,B=>B);{const B=this.children_.getReverseIteratorFrom(i.name,F1.Wrap);let _t=B.peek();for(;null!=_t&&d.compare(_t,i)>0;)B.getNext(),_t=B.peek();return B}}compareTo(i){return this.isEmpty()?i.isEmpty()?0:-1:i.isLeafNode()||i.isEmpty()?1:i===H5?-1:0}withIndex(i){if(i===kU||this.indexMap_.hasIndex(i))return this;{const d=this.indexMap_.addIndex(i,this.children_);return new o(this.children_,this.priorityNode_,d)}}isIndexed(i){return i===kU||this.indexMap_.hasIndex(i)}equals(i){if(i===this)return!0;if(i.isLeafNode())return!1;{const d=i;if(this.getPriority().equals(d.getPriority())){if(this.children_.count()===d.children_.count()){const _=this.getIterator(DT),B=d.getIterator(DT);let _t=_.getNext(),_a=B.getNext();for(;_t&&_a;){if(_t.name!==_a.name||!_t.node.equals(_a.node))return!1;_t=_.getNext(),_a=B.getNext()}return null===_t&&null===_a}return!1}return!1}}resolveIndex_(i){return i===kU?null:this.indexMap_.get(i.toString())}}return o.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,o})();const H5=new class Q5 extends m1{constructor(){super(new bR(a4),m1.EMPTY_NODE,YN.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return m1.EMPTY_NODE}isEmpty(){return!1}};function bT(o,e=null){if(null===o)return m1.EMPTY_NODE;if("object"==typeof o&&".priority"in o&&(e=o[".priority"]),(0,M_.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof o&&".value"in o&&null!==o[".value"]&&(o=o[".value"]),"object"!=typeof o||".sv"in o)return new V5(o,bT(e));if(o instanceof Array){let i=m1.EMPTY_NODE;return JS(o,(d,_)=>{if((0,M_.r3)(o,d)&&"."!==d.substring(0,1)){const B=bT(_);(B.isLeafNode()||!B.isEmpty())&&(i=i.updateImmediateChild(d,B))}}),i.updatePriority(bT(e))}{const i=[];let d=!1;if(JS(o,(_t,_a)=>{if("."!==_t.substring(0,1)){const _h=bT(_a);_h.isEmpty()||(d=d||!_h.getPriority().isEmpty(),i.push(new F1(_t,_h)))}}),0===i.length)return m1.EMPTY_NODE;const B=c4(i,Dee,_t=>_t.name,a4);if(d){const _t=c4(i,DT.getCompare());return new m1(B,bT(e),new YN({".priority":_t},{".priority":DT}))}return new m1(B,bT(e),YN.Default)}}Object.defineProperties(F1,{MIN:{value:new F1(TU,m1.EMPTY_NODE)},MAX:{value:new F1(TM,H5)}}),rJ.__EMPTY_NODE=m1.EMPTY_NODE,V5.__childrenNodeConstructor=m1,function Koe(o){j5=o}(H5),function xee(o){kee=o}(H5),function Pee(o){Nee=o}(bT);class i8 extends nJ{constructor(e){super(),this.indexPath_=e,(0,M_.hu)(!S1(e)&&".priority"!==y1(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,i){const d=this.extractChild(e.node),_=this.extractChild(i.node),B=d.compareTo(_);return 0===B?JV(e.name,i.name):B}makePost(e,i){const d=bT(e),_=m1.EMPTY_NODE.updateChild(this.indexPath_,d);return new F1(i,_)}maxPost(){const e=m1.EMPTY_NODE.updateChild(this.indexPath_,H5);return new F1(TM,e)}toString(){return o4(this.indexPath_,0).join("/")}}const PH=new class Mee extends nJ{compare(e,i){const d=e.node.compareTo(i.node);return 0===d?JV(e.name,i.name):d}isDefinedOn(e){return!0}indexedValueChanged(e,i){return!e.equals(i)}minPost(){return F1.MIN}maxPost(){return F1.MAX}makePost(e,i){const d=bT(e);return new F1(i,d)}toString(){return".value"}},TL="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",s8=function(){let o=0;const e=[];return function(i){const d=i===o;let _;o=i;const B=new Array(8);for(_=7;_>=0;_--)B[_]=TL.charAt(i%64),i=Math.floor(i/64);(0,M_.hu)(0===i,"Cannot push at time == 0");let _t=B.join("");if(d){for(_=11;_>=0&&63===e[_];_--)e[_]=0;e[_]++}else for(_=0;_<12;_++)e[_]=Math.floor(64*Math.random());for(_=0;_<12;_++)_t+=TL.charAt(e[_]);return(0,M_.hu)(20===_t.length,"nextPushId: Length should be 20."),_t}}(),cJ=function(o){if(o===""+jY)return"-";const e=fH(o);if(null!=e)return""+(e+1);const i=new Array(o.length);for(let _t=0;_t<i.length;_t++)i[_t]=o.charAt(_t);if(i.length<786)return i.push("-"),i.join("");let d=i.length-1;for(;d>=0&&"z"===i[d];)d--;if(-1===d)return TM;const B=TL.charAt(TL.indexOf(i[d])+1);return i[d]=B,i.slice(0,d+1).join("")},a8=function(o){if(o===""+hH)return TU;const e=fH(o);if(null!=e)return""+(e-1);const i=new Array(o.length);for(let d=0;d<i.length;d++)i[d]=o.charAt(d);return"-"===i[i.length-1]?1===i.length?""+jY:(delete i[i.length-1],i.join("")):(i[i.length-1]=TL.charAt(TL.indexOf(i[i.length-1])-1),i.join("")+"z".repeat(786-i.length))};function LH(o){return{type:"value",snapshotNode:o}}function q5(o,e){return{type:"child_added",snapshotNode:e,childName:o}}function _7(o,e){return{type:"child_removed",snapshotNode:e,childName:o}}function c8(o,e,i){return{type:"child_changed",snapshotNode:e,childName:o,oldSnap:i}}class v7{constructor(e){this.index_=e}updateChild(e,i,d,_,B,_t){(0,M_.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const _a=e.getImmediateChild(i);return _a.getChild(_).equals(d.getChild(_))&&_a.isEmpty()===d.isEmpty()||(null!=_t&&(d.isEmpty()?e.hasChild(i)?_t.trackChildChange(_7(i,_a)):(0,M_.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):_a.isEmpty()?_t.trackChildChange(q5(i,d)):_t.trackChildChange(c8(i,d,_a))),e.isLeafNode()&&d.isEmpty())?e:e.updateImmediateChild(i,d).withIndex(this.index_)}updateFullNode(e,i,d){return null!=d&&(e.isLeafNode()||e.forEachChild(DT,(_,B)=>{i.hasChild(_)||d.trackChildChange(_7(_,B))}),i.isLeafNode()||i.forEachChild(DT,(_,B)=>{if(e.hasChild(_)){const _t=e.getImmediateChild(_);_t.equals(B)||d.trackChildChange(c8(_,B,_t))}else d.trackChildChange(q5(_,B))})),i.withIndex(this.index_)}updatePriority(e,i){return e.isEmpty()?m1.EMPTY_NODE:e.updatePriority(i)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class u4{constructor(e){this.indexedFilter_=new v7(e.getIndex()),this.index_=e.getIndex(),this.startPost_=u4.getStartPost_(e),this.endPost_=u4.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,i,d,_,B,_t){return this.matches(new F1(i,d))||(d=m1.EMPTY_NODE),this.indexedFilter_.updateChild(e,i,d,_,B,_t)}updateFullNode(e,i,d){i.isLeafNode()&&(i=m1.EMPTY_NODE);let _=i.withIndex(this.index_);_=_.updatePriority(m1.EMPTY_NODE);const B=this;return i.forEachChild(DT,(_t,_a)=>{B.matches(new F1(_t,_a))||(_=_.updateImmediateChild(_t,m1.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,_,d)}updatePriority(e,i){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const i=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),i)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const i=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),i)}return e.getIndex().maxPost()}}class Yoe{constructor(e){this.rangedFilter_=new u4(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,i,d,_,B,_t){return this.rangedFilter_.matches(new F1(i,d))||(d=m1.EMPTY_NODE),e.getImmediateChild(i).equals(d)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,i,d,_,B,_t):this.fullLimitUpdateChild_(e,i,d,B,_t)}updateFullNode(e,i,d){let _;if(i.isLeafNode()||i.isEmpty())_=m1.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<i.numChildren()&&i.isIndexed(this.index_)){let B;_=m1.EMPTY_NODE.withIndex(this.index_),B=this.reverse_?i.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let _t=0;for(;B.hasNext()&&_t<this.limit_;){const _a=B.getNext();let _h;if(_h=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),_a)<=0:this.index_.compare(_a,this.rangedFilter_.getEndPost())<=0,!_h)break;_=_.updateImmediateChild(_a.name,_a.node),_t++}}else{let B,_t,_a,_h;if(_=i.withIndex(this.index_),_=_.updatePriority(m1.EMPTY_NODE),this.reverse_){_h=_.getReverseIterator(this.index_),B=this.rangedFilter_.getEndPost(),_t=this.rangedFilter_.getStartPost();const f_=this.index_.getCompare();_a=(R_,H_)=>f_(H_,R_)}else _h=_.getIterator(this.index_),B=this.rangedFilter_.getStartPost(),_t=this.rangedFilter_.getEndPost(),_a=this.index_.getCompare();let _g=0,l_=!1;for(;_h.hasNext();){const f_=_h.getNext();!l_&&_a(B,f_)<=0&&(l_=!0),l_&&_g<this.limit_&&_a(f_,_t)<=0?_g++:_=_.updateImmediateChild(f_.name,m1.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,_,d)}updatePriority(e,i){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,i,d,_,B){let _t;if(this.reverse_){const f_=this.index_.getCompare();_t=(R_,H_)=>f_(H_,R_)}else _t=this.index_.getCompare();const _a=e;(0,M_.hu)(_a.numChildren()===this.limit_,"");const _h=new F1(i,d),_g=this.reverse_?_a.getFirstChild(this.index_):_a.getLastChild(this.index_),l_=this.rangedFilter_.matches(_h);if(_a.hasChild(i)){const f_=_a.getImmediateChild(i);let R_=_.getChildAfterChild(this.index_,_g,this.reverse_);for(;null!=R_&&(R_.name===i||_a.hasChild(R_.name));)R_=_.getChildAfterChild(this.index_,R_,this.reverse_);const H_=null==R_?1:_t(R_,_h);if(l_&&!d.isEmpty()&&H_>=0)return null!=B&&B.trackChildChange(c8(i,d,f_)),_a.updateImmediateChild(i,d);{null!=B&&B.trackChildChange(_7(i,f_));const R0=_a.updateImmediateChild(i,m1.EMPTY_NODE);return null!=R_&&this.rangedFilter_.matches(R_)?(null!=B&&B.trackChildChange(q5(R_.name,R_.node)),R0.updateImmediateChild(R_.name,R_.node)):R0}}return d.isEmpty()?e:l_&&_t(_g,_h)>=0?(null!=B&&(B.trackChildChange(_7(_g.name,_g.node)),B.trackChildChange(q5(i,d))),_a.updateImmediateChild(i,d).updateImmediateChild(_g.name,m1.EMPTY_NODE)):e}}class MH{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=DT}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,M_.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,M_.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:TU}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,M_.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,M_.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:TM}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,M_.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===DT}copy(){const e=new MH;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function BH(o,e,i){const d=o.copy();return d.startSet_=!0,void 0===e&&(e=null),d.indexStartValue_=e,null!=i?(d.startNameSet_=!0,d.indexStartName_=i):(d.startNameSet_=!1,d.indexStartName_=""),d}function E7(o,e,i){const d=o.copy();return d.endSet_=!0,void 0===e&&(e=null),d.indexEndValue_=e,void 0!==i?(d.endNameSet_=!0,d.indexEndName_=i):(d.endNameSet_=!1,d.indexEndName_=""),d}function I7(o,e){const i=o.copy();return i.index_=e,i}function dJ(o){const e={};if(o.isDefault())return e;let i;return o.index_===DT?i="$priority":o.index_===PH?i="$value":o.index_===kU?i="$key":((0,M_.hu)(o.index_ instanceof i8,"Unrecognized index type!"),i=o.index_.toString()),e.orderBy=(0,M_.Pz)(i),o.startSet_&&(e.startAt=(0,M_.Pz)(o.indexStartValue_),o.startNameSet_&&(e.startAt+=","+(0,M_.Pz)(o.indexStartName_))),o.endSet_&&(e.endAt=(0,M_.Pz)(o.indexEndValue_),o.endNameSet_&&(e.endAt+=","+(0,M_.Pz)(o.indexEndName_))),o.limitSet_&&(o.isViewFromLeft()?e.limitToFirst=o.limit_:e.limitToLast=o.limit_),e}function hJ(o){const e={};if(o.startSet_&&(e.sp=o.indexStartValue_,o.startNameSet_&&(e.sn=o.indexStartName_)),o.endSet_&&(e.ep=o.indexEndValue_,o.endNameSet_&&(e.en=o.indexEndName_)),o.limitSet_){e.l=o.limit_;let i=o.viewFrom_;""===i&&(i=o.isViewFromLeft()?"l":"r"),e.vf=i}return o.index_!==DT&&(e.i=o.index_.toString()),e}class b7 extends OU{constructor(e,i,d,_){super(),this.repoInfo_=e,this.onDataUpdate_=i,this.authTokenProvider_=d,this.appCheckTokenProvider_=_,this.log_=X3("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,i){return void 0!==i?"tag$"+i:((0,M_.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,i,d,_){const B=e._path.toString();this.log_("Listen called for "+B+" "+e._queryIdentifier);const _t=b7.getListenId_(e,d),_a={};this.listens_[_t]=_a;const _h=dJ(e._queryParams);this.restRequest_(B+".json",_h,(_g,l_)=>{let f_=l_;if(404===_g&&(f_=null,_g=null),null===_g&&this.onDataUpdate_(B,f_,!1,d),(0,M_.DV)(this.listens_,_t)===_a){let R_;R_=_g?401===_g?"permission_denied":"rest_error:"+_g:"ok",_(R_,null)}})}unlisten(e,i){const d=b7.getListenId_(e,i);delete this.listens_[d]}get(e){const i=dJ(e._queryParams),d=e._path.toString(),_=new M_.BH;return this.restRequest_(d+".json",i,(B,_t)=>{let _a=_t;404===B&&(_a=null,B=null),null===B?(this.onDataUpdate_(d,_a,!1,null),_.resolve(_a)):_.reject(new Error(_a))}),_.promise}refreshAuthToken(e){}restRequest_(e,i={},d){return i.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([_,B])=>{_&&_.accessToken&&(i.auth=_.accessToken),B&&B.token&&(i.ac=B.token);const _t=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,M_.xO)(i);this.log_("Sending REST request for "+_t);const _a=new XMLHttpRequest;_a.onreadystatechange=()=>{if(d&&4===_a.readyState){this.log_("REST Response for "+_t+" received. status:",_a.status,"response:",_a.responseText);let _h=null;if(_a.status>=200&&_a.status<300){try{_h=(0,M_.cI)(_a.responseText)}catch(_g){_O("Failed to parse JSON response for "+_t+": "+_a.responseText)}d(null,_h)}else 401!==_a.status&&404!==_a.status&&_O("Got unsuccessful REST response for "+_t+" Status: "+_a.status),d(_a.status);d=null}},_a.open("GET",_t,!0),_a.send()})}}class Joe{constructor(){this.rootNode_=m1.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,i){this.rootNode_=this.rootNode_.updateChild(e,i)}}function q2(){return{value:null,children:new Map}}function W5(o,e,i){if(S1(e))o.value=i,o.children.clear();else if(null!==o.value)o.value=o.value.updateChild(e,i);else{const d=y1(e);o.children.has(d)||o.children.set(d,q2()),W5(o.children.get(d),e=ET(e),i)}}function UH(o,e){if(S1(e))return o.value=null,o.children.clear(),!0;if(null!==o.value){if(o.value.isLeafNode())return!1;{const i=o.value;return o.value=null,i.forEachChild(DT,(d,_)=>{W5(o,new z1(d),_)}),UH(o,e)}}if(o.children.size>0){const i=y1(e);return e=ET(e),o.children.has(i)&&UH(o.children.get(i),e)&&o.children.delete(i),0===o.children.size}return!0}function FH(o,e,i){null!==o.value?i(e,o.value):function LS(o,e){o.children.forEach((i,d)=>{e(d,i)})}(o,(d,_)=>{FH(_,new z1(e.toString()+"/"+d),i)})}class l4{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),i=Object.assign({},e);return this.last_&&JS(this.last_,(d,_)=>{i[d]=i[d]-_}),this.last_=e,i}}class C7{constructor(e,i){this.server_=i,this.statsToReport_={},this.statsListener_=new l4(e);const d=1e4+2e4*Math.random();qP(this.reportStats_.bind(this),Math.floor(d))}reportStats_(){const e=this.statsListener_.get(),i={};let d=!1;JS(e,(_,B)=>{B>0&&(0,M_.r3)(this.statsToReport_,_)&&(i[_]=B,d=!0)}),d&&this.server_.reportStats(i),qP(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var XR=(()=>{return(o=XR||(XR={}))[o.OVERWRITE=0]="OVERWRITE",o[o.MERGE=1]="MERGE",o[o.ACK_USER_WRITE=2]="ACK_USER_WRITE",o[o.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",XR;var o})();function w7(o){return{fromUser:!1,fromServer:!0,queryId:o,tagged:!0}}class K5{constructor(e,i,d){this.path=e,this.affectedTree=i,this.revert=d,this.type=XR.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(S1(this.path)){if(null!=this.affectedTree.value)return(0,M_.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const i=this.affectedTree.subtree(new z1(e));return new K5(U1(),i,this.revert)}}return(0,M_.hu)(y1(this.path)===e,"operationForChild called for unrelated child."),new K5(ET(this.path),this.affectedTree,this.revert)}}class u8{constructor(e,i){this.source=e,this.path=i,this.type=XR.LISTEN_COMPLETE}operationForChild(e){return S1(this.path)?new u8(this.source,U1()):new u8(this.source,ET(this.path))}}class h4{constructor(e,i,d){this.source=e,this.path=i,this.snap=d,this.type=XR.OVERWRITE}operationForChild(e){return S1(this.path)?new h4(this.source,U1(),this.snap.getImmediateChild(e)):new h4(this.source,ET(this.path),this.snap)}}class f4{constructor(e,i,d){this.source=e,this.path=i,this.children=d,this.type=XR.MERGE}operationForChild(e){if(S1(this.path)){const i=this.children.subtree(new z1(e));return i.isEmpty()?null:i.value?new h4(this.source,U1(),i.value):new f4(this.source,U1(),i)}return(0,M_.hu)(y1(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new f4(this.source,ET(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class p4{constructor(e,i,d){this.node_=e,this.fullyInitialized_=i,this.filtered_=d}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(S1(e))return this.isFullyInitialized()&&!this.filtered_;const i=y1(e);return this.isCompleteForChild(i)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class pJ{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function hN(o,e,i,d,_,B){const _t=d.filter(_a=>_a.type===i);_t.sort((_a,_h)=>function Vee(o,e,i){if(null==e.childName||null==i.childName)throw(0,M_.g5)("Should only compare child_ events.");const d=new F1(e.childName,e.snapshotNode),_=new F1(i.childName,i.snapshotNode);return o.index_.compare(d,_)}(o,_a,_h)),_t.forEach(_a=>{const _h=function GH(o,e,i){return"value"===e.type||"child_removed"===e.type||(e.prevName=i.getPredecessorChildName(e.childName,e.snapshotNode,o.index_)),e}(o,_a,B);_.forEach(_g=>{_g.respondsTo(_a.type)&&e.push(_g.createEvent(_h,o.query_))})})}function W2(o,e){return{eventCache:o,serverCache:e}}function fN(o,e,i,d){return W2(new p4(e,i,d),o.serverCache)}function WP(o,e,i,d){return W2(o.eventCache,new p4(e,i,d))}function T7(o){return o.eventCache.isFullyInitialized()?o.eventCache.getNode():null}function g4(o){return o.serverCache.isFullyInitialized()?o.serverCache.getNode():null}let QH;class BT{constructor(e,i=(()=>(QH||(QH=new bR(lH)),QH))()){this.value=e,this.children=i}static fromObject(e){let i=new BT(null);return JS(e,(d,_)=>{i=i.set(new z1(d),_)}),i}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,i){if(null!=this.value&&i(this.value))return{path:U1(),value:this.value};if(S1(e))return null;{const d=y1(e),_=this.children.get(d);if(null!==_){const B=_.findRootMostMatchingPathAndValue(ET(e),i);return null!=B?{path:IT(new z1(d),B.path),value:B.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(S1(e))return this;{const i=y1(e),d=this.children.get(i);return null!==d?d.subtree(ET(e)):new BT(null)}}set(e,i){if(S1(e))return new BT(i,this.children);{const d=y1(e),B=(this.children.get(d)||new BT(null)).set(ET(e),i),_t=this.children.insert(d,B);return new BT(this.value,_t)}}remove(e){if(S1(e))return this.children.isEmpty()?new BT(null):new BT(null,this.children);{const i=y1(e),d=this.children.get(i);if(d){const _=d.remove(ET(e));let B;return B=_.isEmpty()?this.children.remove(i):this.children.insert(i,_),null===this.value&&B.isEmpty()?new BT(null):new BT(this.value,B)}return this}}get(e){if(S1(e))return this.value;{const i=y1(e),d=this.children.get(i);return d?d.get(ET(e)):null}}setTree(e,i){if(S1(e))return i;{const d=y1(e),B=(this.children.get(d)||new BT(null)).setTree(ET(e),i);let _t;return _t=B.isEmpty()?this.children.remove(d):this.children.insert(d,B),new BT(this.value,_t)}}fold(e){return this.fold_(U1(),e)}fold_(e,i){const d={};return this.children.inorderTraversal((_,B)=>{d[_]=B.fold_(IT(e,_),i)}),i(e,this.value,d)}findOnPath(e,i){return this.findOnPath_(e,U1(),i)}findOnPath_(e,i,d){const _=!!this.value&&d(i,this.value);if(_)return _;if(S1(e))return null;{const B=y1(e),_t=this.children.get(B);return _t?_t.findOnPath_(ET(e),IT(i,B),d):null}}foreachOnPath(e,i){return this.foreachOnPath_(e,U1(),i)}foreachOnPath_(e,i,d){if(S1(e))return this;{this.value&&d(i,this.value);const _=y1(e),B=this.children.get(_);return B?B.foreachOnPath_(ET(e),IT(i,_),d):new BT(null)}}foreach(e){this.foreach_(U1(),e)}foreach_(e,i){this.children.inorderTraversal((d,_)=>{_.foreach_(IT(e,d),i)}),this.value&&i(e,this.value)}foreachChild(e){this.children.inorderTraversal((i,d)=>{d.value&&e(i,d.value)})}}class K2{constructor(e){this.writeTree_=e}static empty(){return new K2(new BT(null))}}function m4(o,e,i){if(S1(e))return new K2(new BT(i));{const d=o.writeTree_.findRootMostValueAndPath(e);if(null!=d){const _=d.path;let B=d.value;const _t=VO(_,e);return B=B.updateChild(_t,i),new K2(o.writeTree_.set(_,B))}{const _=new BT(i),B=o.writeTree_.setTree(e,_);return new K2(B)}}}function z5(o,e,i){let d=o;return JS(i,(_,B)=>{d=m4(d,IT(e,_),B)}),d}function Gee(o,e){if(S1(e))return K2.empty();{const i=o.writeTree_.setTree(e,new BT(null));return new K2(i)}}function HH(o,e){return null!=Y5(o,e)}function Y5(o,e){const i=o.writeTree_.findRootMostValueAndPath(e);return null!=i?o.writeTree_.get(i.path).getChild(VO(i.path,e)):null}function AJ(o){const e=[],i=o.writeTree_.value;return null!=i?i.isLeafNode()||i.forEachChild(DT,(d,_)=>{e.push(new F1(d,_))}):o.writeTree_.children.inorderTraversal((d,_)=>{null!=_.value&&e.push(new F1(d,_.value))}),e}function PU(o,e){if(S1(e))return o;{const i=Y5(o,e);return new K2(null!=i?new BT(i):o.writeTree_.subtree(e))}}function l8(o){return o.writeTree_.isEmpty()}function xU(o,e){return _J(U1(),o.writeTree_,e)}function _J(o,e,i){if(null!=e.value)return i.updateChild(o,e.value);{let d=null;return e.children.inorderTraversal((_,B)=>{".priority"===_?((0,M_.hu)(null!==B.value,"Priority writes must always be leaf nodes"),d=B.value):i=_J(IT(o,_),B,i)}),!i.getChild(o).isEmpty()&&null!==d&&(i=i.updateChild(IT(o,".priority"),d)),i}}function S7(o,e){return $ee(e,o)}function qee(o,e){if(o.snap)return zN(o.path,e);for(const i in o.children)if(o.children.hasOwnProperty(i)&&zN(IT(o.path,i),e))return!0;return!1}function Wee(o){return o.visible}function h8(o,e,i){let d=K2.empty();for(let _=0;_<o.length;++_){const B=o[_];if(e(B)){const _t=B.path;let _a;if(B.snap)zN(i,_t)?(_a=VO(i,_t),d=m4(d,_a,B.snap)):zN(_t,i)&&(_a=VO(_t,i),d=m4(d,U1(),B.snap.getChild(_a)));else{if(!B.children)throw(0,M_.g5)("WriteRecord should have .snap or .children");if(zN(i,_t))_a=VO(i,_t),d=z5(d,_a,B.children);else if(zN(_t,i))if(_a=VO(_t,i),S1(_a))d=z5(d,U1(),B.children);else{const _h=(0,M_.DV)(B.children,y1(_a));if(_h){const _g=_h.getChild(ET(_a));d=m4(d,U1(),_g)}}}}}return d}function R7(o,e,i,d,_){if(d||_){const B=PU(o.visibleWrites,e);return!_&&l8(B)?i:_||null!=i||HH(B,U1())?xU(h8(o.allWrites,function(_g){return(_g.visible||_)&&(!d||!~d.indexOf(_g.writeId))&&(zN(_g.path,e)||zN(e,_g.path))},e),i||m1.EMPTY_NODE):null}{const B=Y5(o.visibleWrites,e);if(null!=B)return B;{const _t=PU(o.visibleWrites,e);return l8(_t)?i:null!=i||HH(_t,U1())?xU(_t,i||m1.EMPTY_NODE):null}}}function qH(o,e,i,d){return R7(o.writeTree,o.treePath,e,i,d)}function IJ(o,e){return function Kee(o,e,i){let d=m1.EMPTY_NODE;const _=Y5(o.visibleWrites,e);if(_)return _.isLeafNode()||_.forEachChild(DT,(B,_t)=>{d=d.updateImmediateChild(B,_t)}),d;if(i){const B=PU(o.visibleWrites,e);return i.forEachChild(DT,(_t,_a)=>{const _h=xU(PU(B,new z1(_t)),_a);d=d.updateImmediateChild(_t,_h)}),AJ(B).forEach(_t=>{d=d.updateImmediateChild(_t.name,_t.node)}),d}return AJ(PU(o.visibleWrites,e)).forEach(_t=>{d=d.updateImmediateChild(_t.name,_t.node)}),d}(o.writeTree,o.treePath,e)}function O7(o,e,i,d){return function $oe(o,e,i,d,_){(0,M_.hu)(d||_,"Either existingEventSnap or existingServerSnap must exist");const B=IT(e,i);if(HH(o.visibleWrites,B))return null;{const _t=PU(o.visibleWrites,B);return l8(_t)?_.getChild(i):xU(_t,_.getChild(i))}}(o.writeTree,o.treePath,e,i,d)}function WH(o,e){return function zee(o,e){return Y5(o.visibleWrites,e)}(o.writeTree,IT(o.treePath,e))}function bJ(o,e,i){return function Zoe(o,e,i,d){const _=IT(e,i),B=Y5(o.visibleWrites,_);return null!=B?B:d.isCompleteForChild(i)?xU(PU(o.visibleWrites,_),d.getNode().getImmediateChild(i)):null}(o.writeTree,o.treePath,e,i)}function Jee(o,e){return $ee(IT(o.treePath,e),o.writeTree)}function $ee(o,e){return{treePath:o,writeTree:e}}class ese{constructor(){this.changeMap=new Map}trackChildChange(e){const i=e.type,d=e.childName;(0,M_.hu)("child_added"===i||"child_changed"===i||"child_removed"===i,"Only child changes supported for tracking"),(0,M_.hu)(".priority"!==d,"Only non-priority child changes can be tracked.");const _=this.changeMap.get(d);if(_){const B=_.type;if("child_added"===i&&"child_removed"===B)this.changeMap.set(d,c8(d,e.snapshotNode,_.snapshotNode));else if("child_removed"===i&&"child_added"===B)this.changeMap.delete(d);else if("child_removed"===i&&"child_changed"===B)this.changeMap.set(d,_7(d,_.oldSnap));else if("child_changed"===i&&"child_added"===B)this.changeMap.set(d,q5(d,e.snapshotNode));else{if("child_changed"!==i||"child_changed"!==B)throw(0,M_.g5)("Illegal combination of changes: "+e+" occurred after "+_);this.changeMap.set(d,c8(d,e.snapshotNode,_.oldSnap))}}else this.changeMap.set(d,e)}getChanges(){return Array.from(this.changeMap.values())}}const Xee=new class Zee{getCompleteChild(e){return null}getChildAfterChild(e,i,d){return null}};class CJ{constructor(e,i,d=null){this.writes_=e,this.viewCache_=i,this.optCompleteServerCache_=d}getCompleteChild(e){const i=this.viewCache_.eventCache;if(i.isCompleteForChild(e))return i.getNode().getImmediateChild(e);{const d=null!=this.optCompleteServerCache_?new p4(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return bJ(this.writes_,e,d)}}getChildAfterChild(e,i,d){const _=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:g4(this.viewCache_),B=function Xoe(o,e,i,d,_,B){return function Yee(o,e,i,d,_,B,_t){let _a;const _h=PU(o.visibleWrites,e),_g=Y5(_h,U1());if(null!=_g)_a=_g;else{if(null==i)return[];_a=xU(_h,i)}if(_a=_a.withIndex(_t),_a.isEmpty()||_a.isLeafNode())return[];{const l_=[],f_=_t.getCompare(),R_=B?_a.getReverseIteratorFrom(d,_t):_a.getIteratorFrom(d,_t);let H_=R_.getNext();for(;H_&&l_.length<_;)0!==f_(H_,d)&&l_.push(H_),H_=R_.getNext();return l_}}(o.writeTree,o.treePath,e,i,d,_,B)}(this.writes_,_,i,1,d,e);return 0===B.length?null:B[0]}}function f8(o,e,i,d,_,B){const _t=e.eventCache;if(null!=WH(d,i))return e;{let _a,_h;if(S1(i))if((0,M_.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const _g=g4(e),f_=IJ(d,_g instanceof m1?_g:m1.EMPTY_NODE);_a=o.filter.updateFullNode(e.eventCache.getNode(),f_,B)}else{const _g=qH(d,g4(e));_a=o.filter.updateFullNode(e.eventCache.getNode(),_g,B)}else{const _g=y1(i);if(".priority"===_g){(0,M_.hu)(1===NU(i),"Can't have a priority with additional path components");const l_=_t.getNode();_h=e.serverCache.getNode();const f_=O7(d,i,l_,_h);_a=null!=f_?o.filter.updatePriority(l_,f_):_t.getNode()}else{const l_=ET(i);let f_;if(_t.isCompleteForChild(_g)){_h=e.serverCache.getNode();const R_=O7(d,i,_t.getNode(),_h);f_=null!=R_?_t.getNode().getImmediateChild(_g).updateChild(l_,R_):_t.getNode().getImmediateChild(_g)}else f_=bJ(d,_g,e.serverCache);_a=null!=f_?o.filter.updateChild(_t.getNode(),_g,f_,l_,_,B):_t.getNode()}}return fN(e,_a,_t.isFullyInitialized()||S1(i),o.filter.filtersNodes())}}function N7(o,e,i,d,_,B,_t,_a){const _h=e.serverCache;let _g;const l_=_t?o.filter:o.filter.getIndexedFilter();if(S1(i))_g=l_.updateFullNode(_h.getNode(),d,null);else if(l_.filtersNodes()&&!_h.isFiltered()){const H_=_h.getNode().updateChild(i,d);_g=l_.updateFullNode(_h.getNode(),H_,null)}else{const H_=y1(i);if(!_h.isCompleteForPath(i)&&NU(i)>1)return e;const W_=ET(i),H0=_h.getNode().getImmediateChild(H_).updateChild(W_,d);_g=".priority"===H_?l_.updatePriority(_h.getNode(),H0):l_.updateChild(_h.getNode(),H_,H0,W_,Xee,null)}const f_=WP(e,_g,_h.isFullyInitialized()||S1(i),l_.filtersNodes());return f8(o,f_,i,_,new CJ(_,f_,B),_a)}function KH(o,e,i,d,_,B,_t){const _a=e.eventCache;let _h,_g;const l_=new CJ(_,e,B);if(S1(i))_g=o.filter.updateFullNode(e.eventCache.getNode(),d,_t),_h=fN(e,_g,!0,o.filter.filtersNodes());else{const f_=y1(i);if(".priority"===f_)_g=o.filter.updatePriority(e.eventCache.getNode(),d),_h=fN(e,_g,_a.isFullyInitialized(),_a.isFiltered());else{const R_=ET(i),H_=_a.getNode().getImmediateChild(f_);let W_;if(S1(R_))W_=d;else{const R0=l_.getCompleteChild(f_);W_=null!=R0?".priority"===TH(R_)&&R0.getChild($Y(R_)).isEmpty()?R0:R0.updateChild(R_,d):m1.EMPTY_NODE}_h=H_.equals(W_)?e:fN(e,o.filter.updateChild(_a.getNode(),f_,W_,R_,l_,_t),_a.isFullyInitialized(),o.filter.filtersNodes())}}return _h}function wJ(o,e){return o.eventCache.isCompleteForChild(e)}function TJ(o,e,i){return i.foreach((d,_)=>{e=e.updateChild(d,_)}),e}function zH(o,e,i,d,_,B,_t,_a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let _g,_h=e;_g=S1(i)?d:new BT(null).setTree(i,d);const l_=e.serverCache.getNode();return _g.children.inorderTraversal((f_,R_)=>{if(l_.hasChild(f_)){const W_=TJ(0,e.serverCache.getNode().getImmediateChild(f_),R_);_h=N7(o,_h,new z1(f_),W_,_,B,_t,_a)}}),_g.children.inorderTraversal((f_,R_)=>{const H_=!e.serverCache.isCompleteForChild(f_)&&void 0===R_.value;if(!l_.hasChild(f_)&&!H_){const R0=TJ(0,e.serverCache.getNode().getImmediateChild(f_),R_);_h=N7(o,_h,new z1(f_),R0,_,B,_t,_a)}}),_h}class rse{constructor(e,i){this.query_=e,this.eventRegistrations_=[];const d=this.query_._queryParams,_=new v7(d.getIndex()),B=function Bee(o){return o.loadsAllData()?new v7(o.getIndex()):o.hasLimit()?new Yoe(o):new u4(o)}(d);this.processor_=function tse(o){return{filter:o}}(B);const _t=i.serverCache,_a=i.eventCache,_h=_.updateFullNode(m1.EMPTY_NODE,_t.getNode(),null),_g=B.updateFullNode(m1.EMPTY_NODE,_a.getNode(),null),l_=new p4(_h,_t.isFullyInitialized(),_.filtersNodes()),f_=new p4(_g,_a.isFullyInitialized(),B.filtersNodes());this.viewCache_=W2(f_,l_),this.eventGenerator_=new pJ(this.query_)}get query(){return this.query_}}function SJ(o,e){const i=g4(o.viewCache_);return i&&(o.query._queryParams.loadsAllData()||!S1(e)&&!i.getImmediateChild(y1(e)).isEmpty())?i.getChild(e):null}function ise(o){return 0===o.eventRegistrations_.length}function k7(o,e,i){const d=[];if(i){(0,M_.hu)(null==e,"A cancel should cancel all event registrations.");const _=o.query._path;o.eventRegistrations_.forEach(B=>{const _t=B.createCancelEvent(i,_);_t&&d.push(_t)})}if(e){let _=[];for(let B=0;B<o.eventRegistrations_.length;++B){const _t=o.eventRegistrations_[B];if(_t.matches(e)){if(e.hasAnyCallback()){_=_.concat(o.eventRegistrations_.slice(B+1));break}}else _.push(_t)}o.eventRegistrations_=_}else o.eventRegistrations_=[];return d}function rte(o,e,i,d){e.type===XR.MERGE&&null!==e.source.queryId&&((0,M_.hu)(g4(o.viewCache_),"We should always have a full cache before handling merges"),(0,M_.hu)(T7(o.viewCache_),"Missing event cache, even though we have a server cache"));const _=o.viewCache_,B=function ete(o,e,i,d,_){const B=new ese;let _t,_a;if(i.type===XR.OVERWRITE){const _g=i;_g.source.fromUser?_t=KH(o,e,_g.path,_g.snap,d,_,B):((0,M_.hu)(_g.source.fromServer,"Unknown source."),_a=_g.source.tagged||e.serverCache.isFiltered()&&!S1(_g.path),_t=N7(o,e,_g.path,_g.snap,d,_,_a,B))}else if(i.type===XR.MERGE){const _g=i;_g.source.fromUser?_t=function nte(o,e,i,d,_,B,_t){let _a=e;return d.foreach((_h,_g)=>{const l_=IT(i,_h);wJ(e,y1(l_))&&(_a=KH(o,_a,l_,_g,_,B,_t))}),d.foreach((_h,_g)=>{const l_=IT(i,_h);wJ(e,y1(l_))||(_a=KH(o,_a,l_,_g,_,B,_t))}),_a}(o,e,_g.path,_g.children,d,_,B):((0,M_.hu)(_g.source.fromServer,"Unknown source."),_a=_g.source.tagged||e.serverCache.isFiltered(),_t=zH(o,e,_g.path,_g.children,d,_,_a,B))}else if(i.type===XR.ACK_USER_WRITE){const _g=i;_t=_g.revert?function nse(o,e,i,d,_,B){let _t;if(null!=WH(d,i))return e;{const _a=new CJ(d,e,_),_h=e.eventCache.getNode();let _g;if(S1(i)||".priority"===y1(i)){let l_;if(e.serverCache.isFullyInitialized())l_=qH(d,g4(e));else{const f_=e.serverCache.getNode();(0,M_.hu)(f_ instanceof m1,"serverChildren would be complete if leaf node"),l_=IJ(d,f_)}l_=l_,_g=o.filter.updateFullNode(_h,l_,B)}else{const l_=y1(i);let f_=bJ(d,l_,e.serverCache);null==f_&&e.serverCache.isCompleteForChild(l_)&&(f_=_h.getImmediateChild(l_)),_g=null!=f_?o.filter.updateChild(_h,l_,f_,ET(i),_a,B):e.eventCache.getNode().hasChild(l_)?o.filter.updateChild(_h,l_,m1.EMPTY_NODE,ET(i),_a,B):_h,_g.isEmpty()&&e.serverCache.isFullyInitialized()&&(_t=qH(d,g4(e)),_t.isLeafNode()&&(_g=o.filter.updateFullNode(_g,_t,B)))}return _t=e.serverCache.isFullyInitialized()||null!=WH(d,U1()),fN(e,_g,_t,o.filter.filtersNodes())}}(o,e,_g.path,d,_,B):function p8(o,e,i,d,_,B,_t){if(null!=WH(_,i))return e;const _a=e.serverCache.isFiltered(),_h=e.serverCache;if(null!=d.value){if(S1(i)&&_h.isFullyInitialized()||_h.isCompleteForPath(i))return N7(o,e,i,_h.getNode().getChild(i),_,B,_a,_t);if(S1(i)){let _g=new BT(null);return _h.getNode().forEachChild(kU,(l_,f_)=>{_g=_g.set(new z1(l_),f_)}),zH(o,e,i,_g,_,B,_a,_t)}return e}{let _g=new BT(null);return d.foreach((l_,f_)=>{const R_=IT(i,l_);_h.isCompleteForPath(R_)&&(_g=_g.set(l_,_h.getNode().getChild(R_)))}),zH(o,e,i,_g,_,B,_a,_t)}}(o,e,_g.path,_g.affectedTree,d,_,B)}else{if(i.type!==XR.LISTEN_COMPLETE)throw(0,M_.g5)("Unknown operation type: "+i.type);_t=function A4(o,e,i,d,_){const B=e.serverCache;return f8(o,WP(e,B.getNode(),B.isFullyInitialized()||S1(i),B.isFiltered()),i,d,Xee,_)}(o,e,i.path,d,B)}const _h=B.getChanges();return function tte(o,e,i){const d=e.eventCache;if(d.isFullyInitialized()){const _=d.getNode().isLeafNode()||d.getNode().isEmpty(),B=T7(o);(i.length>0||!o.eventCache.isFullyInitialized()||_&&!d.getNode().equals(B)||!d.getNode().getPriority().equals(B.getPriority()))&&i.push(LH(T7(e)))}}(e,_t,_h),{viewCache:_t,changes:_h}}(o.processor_,_,e,i,d);return function D7(o,e){(0,M_.hu)(e.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),(0,M_.hu)(e.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed")}(o.processor_,B.viewCache),(0,M_.hu)(B.viewCache.serverCache.isFullyInitialized()||!_.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),o.viewCache_=B.viewCache,P7(o,B.changes,B.viewCache.eventCache.getNode(),null)}function P7(o,e,i,d){return function gJ(o,e,i,d){const _=[],B=[];return e.forEach(_t=>{"child_changed"===_t.type&&o.index_.indexedValueChanged(_t.oldSnap,_t.snapshotNode)&&B.push(function uJ(o,e){return{type:"child_moved",snapshotNode:e,childName:o}}(_t.childName,_t.snapshotNode))}),hN(o,_,"child_removed",e,d,i),hN(o,_,"child_added",e,d,i),hN(o,_,"child_moved",B,d,i),hN(o,_,"child_changed",e,d,i),hN(o,_,"value",e,d,i),_}(o.eventGenerator_,e,i,d?[d]:o.eventRegistrations_)}let _4,XH;class ite{constructor(){this.views=new Map}}function g8(o,e,i,d){const _=e.source.queryId;if(null!==_){const B=o.views.get(_);return(0,M_.hu)(null!=B,"SyncTree gave us an op for an invalid query."),rte(B,e,i,d)}{let B=[];for(const _t of o.views.values())B=B.concat(rte(_t,e,i,d));return B}}function fS(o,e,i,d,_){const _t=o.views.get(e._queryIdentifier);if(!_t){let _a=qH(i,_?d:null),_h=!1;_a?_h=!0:d instanceof m1?(_a=IJ(i,d),_h=!1):(_a=m1.EMPTY_NODE,_h=!1);const _g=W2(new p4(_a,_h,!1),new p4(d,_,!1));return new rse(e,_g)}return _t}function ate(o){const e=[];for(const i of o.views.values())i.query._queryParams.loadsAllData()||e.push(i);return e}function v4(o,e){let i=null;for(const d of o.views.values())i=i||SJ(d,e);return i}function $H(o,e){return e._queryParams.loadsAllData()?L7(o):o.views.get(e._queryIdentifier)}function ZH(o,e){return null!=$H(o,e)}function SL(o){return null!=L7(o)}function L7(o){for(const e of o.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let M7=1;class cte{constructor(e){this.listenProvider_=e,this.syncPointTree_=new BT(null),this.pendingWriteTree_=function EJ(){return{visibleWrites:K2.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function OJ(o,e,i,d,_){return function vJ(o,e,i,d,_){(0,M_.hu)(d>o.lastWriteId,"Stacking an older write on top of newer ones"),void 0===_&&(_=!0),o.allWrites.push({path:e,snap:i,writeId:d,visible:_}),_&&(o.visibleWrites=m4(o.visibleWrites,e,i)),o.lastWriteId=d}(o.pendingWriteTree_,e,i,d,_),_?MU(o,new h4({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i)):[]}function RL(o,e,i=!1){const d=function Qee(o,e){for(let i=0;i<o.allWrites.length;i++){const d=o.allWrites[i];if(d.writeId===e)return d}return null}(o.pendingWriteTree_,e);if(function Hee(o,e){const i=o.allWrites.findIndex(_a=>_a.writeId===e);(0,M_.hu)(i>=0,"removeWrite called with nonexistent writeId.");const d=o.allWrites[i];o.allWrites.splice(i,1);let _=d.visible,B=!1,_t=o.allWrites.length-1;for(;_&&_t>=0;){const _a=o.allWrites[_t];_a.visible&&(_t>=i&&qee(_a,d.path)?_=!1:zN(d.path,_a.path)&&(B=!0)),_t--}return!!_&&(B?(function yJ(o){o.visibleWrites=h8(o.allWrites,Wee,U1()),o.lastWriteId=o.allWrites.length>0?o.allWrites[o.allWrites.length-1].writeId:-1}(o),!0):(d.snap?o.visibleWrites=Gee(o.visibleWrites,d.path):JS(d.children,_h=>{o.visibleWrites=Gee(o.visibleWrites,IT(d.path,_h))}),!0))}(o.pendingWriteTree_,e)){let B=new BT(null);return null!=d.snap?B=B.set(U1(),!0):JS(d.children,_t=>{B=B.set(new z1(_t),!0)}),MU(o,new K5(d.path,B,i))}return[]}function $5(o,e,i){return MU(o,new h4({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,i))}function Z5(o,e,i,d){const _=e._path,B=o.syncPointTree_.get(_);let _t=[];if(B&&("default"===e._queryIdentifier||ZH(B,e))){const _a=function ste(o,e,i,d){const _=e._queryIdentifier,B=[];let _t=[];const _a=SL(o);if("default"===_)for(const[_h,_g]of o.views.entries())_t=_t.concat(k7(_g,i,d)),ise(_g)&&(o.views.delete(_h),_g.query._queryParams.loadsAllData()||B.push(_g.query));else{const _h=o.views.get(_);_h&&(_t=_t.concat(k7(_h,i,d)),ise(_h)&&(o.views.delete(_),_h.query._queryParams.loadsAllData()||B.push(_h.query)))}return _a&&!SL(o)&&B.push(new(function ote(){return(0,M_.hu)(_4,"Reference.ts has not been loaded"),_4}())(e._repo,e._path)),{removed:B,events:_t}}(B,e,i,d);(function JH(o){return 0===o.views.size})(B)&&(o.syncPointTree_=o.syncPointTree_.remove(_));const _h=_a.removed;_t=_a.events;const _g=-1!==_h.findIndex(f_=>f_._queryParams.loadsAllData()),l_=o.syncPointTree_.findOnPath(_,(f_,R_)=>SL(R_));if(_g&&!l_){const f_=o.syncPointTree_.subtree(_);if(!f_.isEmpty()){const R_=function Nde(o){return o.fold((e,i,d)=>{if(i&&SL(i))return[L7(i)];{let _=[];return i&&(_=ate(i)),JS(d,(B,_t)=>{_=_.concat(_t)}),_}})}(f_);for(let H_=0;H_<R_.length;++H_){const W_=R_[H_],R0=W_.query,H0=kJ(o,W_);o.listenProvider_.startListening(m8(R0),U7(o,R0),H0.hashFn,H0.onComplete)}}}!l_&&_h.length>0&&!d&&(_g?o.listenProvider_.stopListening(m8(e),null):_h.forEach(f_=>{const R_=o.queryToTagMap.get(nW(f_));o.listenProvider_.stopListening(m8(f_),R_)})),function F7(o,e){for(let i=0;i<e.length;++i){const d=e[i];if(!d._queryParams.loadsAllData()){const _=nW(d),B=o.queryToTagMap.get(_);o.queryToTagMap.delete(_),o.tagToQueryMap.delete(B)}}}(o,_h)}return _t}function dte(o,e,i){const d=e._path;let _=null,B=!1;o.syncPointTree_.foreachOnPath(d,(f_,R_)=>{const H_=VO(f_,d);_=_||v4(R_,H_),B=B||SL(R_)});let _a,_t=o.syncPointTree_.get(d);_t?(B=B||SL(_t),_=_||v4(_t,U1())):(_t=new ite,o.syncPointTree_=o.syncPointTree_.set(d,_t)),null!=_?_a=!0:(_a=!1,_=m1.EMPTY_NODE,o.syncPointTree_.subtree(d).foreachChild((R_,H_)=>{const W_=v4(H_,U1());W_&&(_=_.updateImmediateChild(R_,W_))}));const _h=ZH(_t,e);if(!_h&&!e._queryParams.loadsAllData()){const f_=nW(e);(0,M_.hu)(!o.queryToTagMap.has(f_),"View does not exist, but we have a tag");const R_=function ase(){return M7++}();o.queryToTagMap.set(f_,R_),o.tagToQueryMap.set(R_,f_)}let l_=function x7(o,e,i,d,_,B){const _t=fS(o,e,d,_,B);return o.views.has(e._queryIdentifier)||o.views.set(e._queryIdentifier,_t),function RJ(o,e){o.eventRegistrations_.push(e)}(_t,i),function $I(o,e){const i=o.viewCache_.eventCache,d=[];return i.getNode().isLeafNode()||i.getNode().forEachChild(DT,(B,_t)=>{d.push(q5(B,_t))}),i.isFullyInitialized()&&d.push(LH(i.getNode())),P7(o,d,i.getNode(),e)}(_t,i)}(_t,e,i,S7(o.pendingWriteTree_,d),_,_a);if(!_h&&!B){const f_=$H(_t,e);l_=l_.concat(function cse(o,e,i){const d=e._path,_=U7(o,e),B=kJ(o,i),_t=o.listenProvider_.startListening(m8(e),_,B.hashFn,B.onComplete),_a=o.syncPointTree_.subtree(d);if(_)(0,M_.hu)(!SL(_a.value),"If we're adding a query, it shouldn't be shadowed");else{const _h=_a.fold((_g,l_,f_)=>{if(!S1(_g)&&l_&&SL(l_))return[L7(l_).query];{let R_=[];return l_&&(R_=R_.concat(ate(l_).map(H_=>H_.query))),JS(f_,(H_,W_)=>{R_=R_.concat(W_)}),R_}});for(let _g=0;_g<_h.length;++_g){const l_=_h[_g];o.listenProvider_.stopListening(m8(l_),U7(o,l_))}}return _t}(o,e,f_))}return l_}function tW(o,e,i){const _=o.pendingWriteTree_,B=o.syncPointTree_.findOnPath(e,(_t,_a)=>{const _g=v4(_a,VO(_t,e));if(_g)return _g});return R7(_,e,B,i,!0)}function MU(o,e){return DJ(e,o.syncPointTree_,null,S7(o.pendingWriteTree_,U1()))}function DJ(o,e,i,d){if(S1(o.path))return NJ(o,e,i,d);{const _=e.get(U1());null==i&&null!=_&&(i=v4(_,U1()));let B=[];const _t=y1(o.path),_a=o.operationForChild(_t),_h=e.children.get(_t);if(_h&&_a){const _g=i?i.getImmediateChild(_t):null,l_=Jee(d,_t);B=B.concat(DJ(_a,_h,_g,l_))}return _&&(B=B.concat(g8(_,o,d,i))),B}}function NJ(o,e,i,d){const _=e.get(U1());null==i&&null!=_&&(i=v4(_,U1()));let B=[];return e.children.inorderTraversal((_t,_a)=>{const _h=i?i.getImmediateChild(_t):null,_g=Jee(d,_t),l_=o.operationForChild(_t);l_&&(B=B.concat(NJ(l_,_a,_h,_g)))}),_&&(B=B.concat(g8(_,o,d,i))),B}function kJ(o,e){const i=e.query,d=U7(o,i);return{hashFn:()=>(function J5(o){return o.viewCache_.serverCache.getNode()}(e)||m1.EMPTY_NODE).hash(),onComplete:_=>{if("ok"===_)return d?function eW(o,e,i){const d=fte(o,i);if(d){const _=pte(d),B=_.path,_t=_.queryId,_a=VO(B,e);return gte(o,B,new u8(w7(_t),_a))}return[]}(o,i._path,d):function lte(o,e){return MU(o,new u8({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(o,i._path);{const B=function pee(o,e){let i="Unknown Error";"too_big"===o?i="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===o?i="Client doesn't have permission to access the desired data.":"unavailable"===o&&(i="The service is unavailable");const d=new Error(o+" at "+e._path.toString()+": "+i);return d.code=o.toUpperCase(),d}(_,i);return Z5(o,i,null,B)}}}}function U7(o,e){const i=nW(e);return o.queryToTagMap.get(i)}function nW(o){return o._path.toString()+"$"+o._queryIdentifier}function fte(o,e){return o.tagToQueryMap.get(e)}function pte(o){const e=o.indexOf("$");return(0,M_.hu)(-1!==e&&e<o.length-1,"Bad queryKey."),{queryId:o.substr(e+1),path:new z1(o.substr(0,e))}}function gte(o,e,i){const d=o.syncPointTree_.get(e);return(0,M_.hu)(d,"Missing sync point for query tag that we're tracking"),g8(d,i,S7(o.pendingWriteTree_,e),null)}function m8(o){return o._queryParams.loadsAllData()&&!o._queryParams.isDefault()?new(function _q(){return(0,M_.hu)(XH,"Reference.ts has not been loaded"),XH}())(o._repo,o._path):o}class j7{constructor(e){this.node_=e}getImmediateChild(e){const i=this.node_.getImmediateChild(e);return new j7(i)}node(){return this.node_}}class X5{constructor(e,i){this.syncTree_=e,this.path_=i}getImmediateChild(e){const i=IT(this.path_,e);return new X5(this.syncTree_,i)}node(){return tW(this.syncTree_,this.path_)}}const PJ=function(o,e,i){return o&&"object"==typeof o?((0,M_.hu)(".sv"in o,"Unexpected leaf node or priority contents"),"string"==typeof o[".sv"]?iW(o[".sv"],e,i):"object"==typeof o[".sv"]?use(o[".sv"],e):void(0,M_.hu)(!1,"Unexpected server value: "+JSON.stringify(o,null,2))):o},iW=function(o,e,i){if("timestamp"===o)return i.timestamp;(0,M_.hu)(!1,"Unexpected server value: "+o)},use=function(o,e,i){o.hasOwnProperty("increment")||(0,M_.hu)(!1,"Unexpected server value: "+JSON.stringify(o,null,2));const d=o.increment;"number"!=typeof d&&(0,M_.hu)(!1,"Unexpected increment value: "+d);const _=e.node();if((0,M_.hu)(null!=_,"Expected ChildrenNode.EMPTY_NODE for nulls"),!_.isLeafNode())return d;const _t=_.getValue();return"number"!=typeof _t?d:_t+d},mte=function(o,e,i,d){return xJ(e,new X5(i,o),d)},OL=function(o,e,i){return xJ(o,new j7(e),i)};function xJ(o,e,i){const d=o.getPriority().val(),_=PJ(d,e.getImmediateChild(".priority"),i);let B;if(o.isLeafNode()){const _t=o,_a=PJ(_t.getValue(),e,i);return _a!==_t.getValue()||_!==_t.getPriority().val()?new V5(_a,bT(_)):o}{const _t=o;return B=_t,_!==_t.getPriority().val()&&(B=B.updatePriority(new V5(_))),_t.forEachChild(DT,(_a,_h)=>{const _g=xJ(_h,e.getImmediateChild(_a),i);_g!==_h&&(B=B.updateImmediateChild(_a,_g))}),B}}class LJ{constructor(e="",i=null,d={children:{},childCount:0}){this.name=e,this.parent=i,this.node=d}}function BU(o,e){let i=e instanceof z1?e:new z1(e),d=o,_=y1(i);for(;null!==_;){const B=(0,M_.DV)(d.node.children,_)||{children:{},childCount:0};d=new LJ(_,d,B),i=ET(i),_=y1(i)}return d}function e6(o){return o.node.value}function oW(o,e){o.node.value=e,V7(o)}function Ate(o){return o.node.childCount>0}function t6(o,e){JS(o.node.children,(i,d)=>{e(new LJ(i,o,d))})}function MJ(o,e,i,d){i&&!d&&e(o),t6(o,_=>{MJ(_,e,!0,d)}),i&&d&&e(o)}function SM(o){return new z1(null===o.parent?o.name:SM(o.parent)+"/"+o.name)}function V7(o){null!==o.parent&&function yte(o,e,i){const d=function _te(o){return void 0===e6(o)&&!Ate(o)}(i),_=(0,M_.r3)(o.node.children,e);d&&_?(delete o.node.children[e],o.node.childCount--,V7(o)):!d&&!_&&(o.node.children[e]=i.node,o.node.childCount++,V7(o))}(o.parent,o.name,o)}const Ete=/[\[\].#$\/\u0000-\u001F\u007F]/,lse=/[\[\].#$\u0000-\u001F\u007F]/,BJ=10485760,sW=function(o){return"string"==typeof o&&0!==o.length&&!Ete.test(o)},aW=function(o){return"string"==typeof o&&0!==o.length&&!lse.test(o)},A8=function(o){return null===o||"string"==typeof o||"number"==typeof o&&!HP(o)||o&&"object"==typeof o&&(0,M_.r3)(o,".sv")},JN=function(o,e,i,d){d&&void 0===e||n6((0,M_.gK)(o,"value"),e,i)},n6=function(o,e,i){const d=i instanceof z1?new See(i,o):i;if(void 0===e)throw new Error(o+"contains undefined "+s4(d));if("function"==typeof e)throw new Error(o+"contains a function "+s4(d)+" with contents = "+e.toString());if(HP(e))throw new Error(o+"contains "+e.toString()+" "+s4(d));if("string"==typeof e&&e.length>BJ/3&&(0,M_.ug)(e)>BJ)throw new Error(o+"contains a string greater than "+BJ+" utf8 bytes "+s4(d)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let _=!1,B=!1;if(JS(e,(_t,_a)=>{if(".value"===_t)_=!0;else if(".priority"!==_t&&".sv"!==_t&&(B=!0,!sW(_t)))throw new Error(o+" contains an invalid key ("+_t+") "+s4(d)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function RH(o,e){o.parts_.length>0&&(o.byteLength_+=1),o.parts_.push(e),o.byteLength_+=(0,M_.ug)(e),Ree(o)})(d,_t),n6(o,_a,d),function Qoe(o){const e=o.parts_.pop();o.byteLength_-=(0,M_.ug)(e),o.parts_.length>0&&(o.byteLength_-=1)}(d)}),_&&B)throw new Error(o+' contains ".value" child '+s4(d)+" in addition to actual children.")}},uW=function(o,e,i,d){if(d&&void 0===e)return;const _=(0,M_.gK)(o,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(_+" must be an object containing the children to replace.");const B=[];JS(e,(_t,_a)=>{const _h=new z1(_t);if(n6(_,_a,IT(i,_h)),".priority"===TH(_h)&&!A8(_a))throw new Error(_+"contains an invalid value for '"+_h.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");B.push(_h)}),function(o,e){let i,d;for(i=0;i<e.length;i++){d=e[i];const B=o4(d);for(let _t=0;_t<B.length;_t++)if((".priority"!==B[_t]||_t!==B.length-1)&&!sW(B[_t]))throw new Error(o+"contains an invalid key ("+B[_t]+") in path "+d.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(Tee);let _=null;for(i=0;i<e.length;i++){if(d=e[i],null!==_&&zN(_,d))throw new Error(o+"contains a path "+_.toString()+" that is ancestor of another path "+d.toString());_=d}}(_,B)},UJ=function(o,e,i){if(!i||void 0!==e){if(HP(e))throw new Error((0,M_.gK)(o,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!A8(e))throw new Error((0,M_.gK)(o,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},y4=function(o,e,i,d){if(!(d&&void 0===i||sW(i)))throw new Error((0,M_.gK)(o,e)+'was an invalid key = "'+i+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},UU=function(o,e,i,d){if(!(d&&void 0===i||aW(i)))throw new Error((0,M_.gK)(o,e)+'was an invalid path = "'+i+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},pN=function(o,e){if(".info"===y1(e))throw new Error(o+" failed = Can't modify data under /.info/")},FJ=function(o,e){const i=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!sW(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==i.length&&!function(o){return o&&(o=o.replace(/^\/*\.info(\/|$)/,"/")),aW(o)}(i))throw new Error((0,M_.gK)(o,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class hse{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function G7(o,e){let i=null;for(let d=0;d<e.length;d++){const _=e[d],B=_.getPath();null!==i&&!SH(B,i.path)&&(o.eventLists_.push(i),i=null),null===i&&(i={events:[],path:B}),i.events.push(_)}i&&o.eventLists_.push(i)}function dW(o,e,i){G7(o,i),hW(o,d=>SH(d,e))}function z2(o,e,i){G7(o,i),hW(o,d=>zN(d,e)||zN(e,d))}function hW(o,e){o.recursionDepth_++;let i=!0;for(let d=0;d<o.eventLists_.length;d++){const _=o.eventLists_[d];_&&(e(_.path)?(fse(o.eventLists_[d]),o.eventLists_[d]=null):i=!1)}i&&(o.eventLists_=[]),o.recursionDepth_--}function fse(o){for(let e=0;e<o.events.length;e++){const i=o.events[e];if(null!==i){o.events[e]=null;const d=i.getEventRunner();YV&&ZR("event: "+i.toString()),SU(d)}}}const fW="repo_interrupt";class pW{constructor(e,i,d,_){this.repoInfo_=e,this.forceRestClient_=i,this.authTokenProvider_=d,this.appCheckProvider_=_,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new hse,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=q2(),this.transactionQueueTree_=new LJ,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Ite(o){const i=o.infoData_.getNode(new z1(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+i}function _8(o){return function(o){return(o=o||{}).timestamp=o.timestamp||(new Date).getTime(),o}({timestamp:Ite(o)})}function v8(o,e,i,d,_){o.dataUpdateCount++;const B=new z1(e);i=o.interceptServerDataCallback_?o.interceptServerDataCallback_(e,i):i;let _t=[];if(_)if(d){const _h=(0,M_.UI)(i,_g=>bT(_g));_t=function sse(o,e,i,d){const _=fte(o,d);if(_){const B=pte(_),_t=B.path,_a=B.queryId,_h=VO(_t,e),_g=BT.fromObject(i);return gte(o,_t,new f4(w7(_a),_h,_g))}return[]}(o.serverSyncTree_,B,_h,_)}else{const _h=bT(i);_t=function B7(o,e,i,d){const _=fte(o,d);if(null!=_){const B=pte(_),_t=B.path,_a=B.queryId,_h=VO(_t,e);return gte(o,_t,new h4(w7(_a),_h,i))}return[]}(o.serverSyncTree_,B,_h,_)}else if(d){const _h=(0,M_.UI)(i,_g=>bT(_g));_t=function ute(o,e,i){const d=BT.fromObject(i);return MU(o,new f4({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,d))}(o.serverSyncTree_,B,_h)}else{const _h=bT(i);_t=$5(o.serverSyncTree_,B,_h)}let _a=B;_t.length>0&&(_a=jU(o,B)),z2(o.eventQueue_,_a,_t)}function bte(o,e){VJ(o,"connected",e),!1===e&&function Cte(o){I8(o,"onDisconnectEvents");const e=_8(o),i=q2();FH(o.onDisconnect_,U1(),(_,B)=>{const _t=mte(_,B,o.serverSyncTree_,e);W5(i,_,_t)});let d=[];FH(i,U1(),(_,B)=>{d=d.concat($5(o.serverSyncTree_,_,B));const _t=HJ(o,_);jU(o,_t)}),o.onDisconnect_=q2(),z2(o.eventQueue_,U1(),d)}(o)}function VJ(o,e,i){const d=new z1("/.info/"+e),_=bT(i);o.infoData_.updateSnapshot(d,_);const B=$5(o.infoSyncTree_,d,_);z2(o.eventQueue_,d,B)}function y8(o){return o.nextWriteId_++}function FU(o,e,i,d,_){I8(o,"set",{path:e.toString(),value:i,priority:d});const B=_8(o),_t=bT(i,d),_a=tW(o.serverSyncTree_,e),_h=OL(_t,_a,B),_g=y8(o),l_=OJ(o.serverSyncTree_,e,_h,_g,!0);G7(o.eventQueue_,l_),o.server_.put(e.toString(),_t.val(!0),(R_,H_)=>{const W_="ok"===R_;W_||_O("set at "+e+" failed: "+R_);const R0=RL(o.serverSyncTree_,_g,!W_);z2(o.eventQueue_,e,R0),Y2(0,_,R_,H_)});const f_=HJ(o,e);jU(o,f_),z2(o.eventQueue_,f_,[])}function H7(o,e,i){o.server_.onDisconnectCancel(e.toString(),(d,_)=>{"ok"===d&&UH(o.onDisconnect_,e),Y2(0,i,d,_)})}function r6(o,e,i,d){const _=bT(i);o.server_.onDisconnectPut(e.toString(),_.val(!0),(B,_t)=>{"ok"===B&&W5(o.onDisconnect_,e,_),Y2(0,d,B,_t)})}function Tte(o,e,i){let d;d=".info"===y1(e._path)?Z5(o.infoSyncTree_,e,i):Z5(o.serverSyncTree_,e,i),dW(o.eventQueue_,e._path,d)}function W7(o){o.persistentConnection_&&o.persistentConnection_.interrupt(fW)}function I8(o,...e){let i="";o.persistentConnection_&&(i=o.persistentConnection_.id+":"),ZR(i,...e)}function Y2(o,e,i,d){e&&SU(()=>{if("ok"===i)e(null);else{const _=(i||"error").toUpperCase();let B=_;d&&(B+=": "+d);const _t=new Error(B);_t.code=_,e(_t)}})}function gW(o,e,i){return tW(o.serverSyncTree_,e,i)||m1.EMPTY_NODE}function K7(o,e=o.transactionQueueTree_){if(e||_W(o,e),e6(e)){const i=QJ(o,e);(0,M_.hu)(i.length>0,"Sending zero length transaction queue"),i.every(_=>0===_.status)&&function mW(o,e,i){const d=i.map(_g=>_g.currentWriteId),_=gW(o,e,d);let B=_;const _t=_.hash();for(let _g=0;_g<i.length;_g++){const l_=i[_g];(0,M_.hu)(0===l_.status,"tryToSendTransactionQueue_: items in queue should all be run."),l_.status=1,l_.retryCount++;const f_=VO(e,l_.path);B=B.updateChild(f_,l_.currentOutputSnapshotRaw)}const _a=B.val(!0),_h=e;o.server_.put(_h.toString(),_a,_g=>{I8(o,"transaction put response",{path:_h.toString(),status:_g});let l_=[];if("ok"===_g){const f_=[];for(let R_=0;R_<i.length;R_++)i[R_].status=2,l_=l_.concat(RL(o.serverSyncTree_,i[R_].currentWriteId)),i[R_].onComplete&&f_.push(()=>i[R_].onComplete(null,!0,i[R_].currentOutputSnapshotResolved)),i[R_].unwatcher();_W(o,BU(o.transactionQueueTree_,e)),K7(o,o.transactionQueueTree_),z2(o.eventQueue_,e,l_);for(let R_=0;R_<f_.length;R_++)SU(f_[R_])}else{if("datastale"===_g)for(let f_=0;f_<i.length;f_++)i[f_].status=3===i[f_].status?4:0;else{_O("transaction at "+_h.toString()+" failed: "+_g);for(let f_=0;f_<i.length;f_++)i[f_].status=4,i[f_].abortReason=_g}jU(o,e)}},_t)}(o,SM(e),i)}else Ate(e)&&t6(e,i=>{K7(o,i)})}function jU(o,e){const i=GJ(o,e),d=SM(i);return function i6(o,e,i){if(0===e.length)return;const d=[];let _=[];const _t=e.filter(_a=>0===_a.status).map(_a=>_a.currentWriteId);for(let _a=0;_a<e.length;_a++){const _h=e[_a],_g=VO(i,_h.path);let f_,l_=!1;if((0,M_.hu)(null!==_g,"rerunTransactionsUnderNode_: relativePath should not be null."),4===_h.status)l_=!0,f_=_h.abortReason,_=_.concat(RL(o.serverSyncTree_,_h.currentWriteId,!0));else if(0===_h.status)if(_h.retryCount>=25)l_=!0,f_="maxretry",_=_.concat(RL(o.serverSyncTree_,_h.currentWriteId,!0));else{const R_=gW(o,_h.path,_t);_h.currentInputSnapshot=R_;const H_=e[_a].update(R_.val());if(void 0!==H_){n6("transaction failed: Data returned ",H_,_h.path);let W_=bT(H_);"object"==typeof H_&&null!=H_&&(0,M_.r3)(H_,".priority")||(W_=W_.updatePriority(R_.getPriority()));const H0=_h.currentWriteId,CI=_8(o),LI=OL(W_,R_,CI);_h.currentOutputSnapshotRaw=W_,_h.currentOutputSnapshotResolved=LI,_h.currentWriteId=y8(o),_t.splice(_t.indexOf(H0),1),_=_.concat(OJ(o.serverSyncTree_,_h.path,LI,_h.currentWriteId,_h.applyLocally)),_=_.concat(RL(o.serverSyncTree_,H0,!0))}else l_=!0,f_="nodata",_=_.concat(RL(o.serverSyncTree_,_h.currentWriteId,!0))}z2(o.eventQueue_,i,_),_=[],l_&&(e[_a].status=2,setTimeout(e[_a].unwatcher,Math.floor(0)),e[_a].onComplete&&d.push("nodata"===f_?()=>e[_a].onComplete(null,!1,e[_a].currentInputSnapshot):()=>e[_a].onComplete(new Error(f_),!1,null)))}_W(o,o.transactionQueueTree_);for(let _a=0;_a<d.length;_a++)SU(d[_a]);K7(o,o.transactionQueueTree_)}(o,QJ(o,i),d),d}function GJ(o,e){let i,d=o.transactionQueueTree_;for(i=y1(e);null!==i&&void 0===e6(d);)d=BU(d,i),i=y1(e=ET(e));return d}function QJ(o,e){const i=[];return AW(o,e,i),i.sort((d,_)=>d.order-_.order),i}function AW(o,e,i){const d=e6(e);if(d)for(let _=0;_<d.length;_++)i.push(d[_]);t6(e,_=>{AW(o,_,i)})}function _W(o,e){const i=e6(e);if(i){let d=0;for(let _=0;_<i.length;_++)2!==i[_].status&&(i[d]=i[_],d++);i.length=d,oW(e,i.length>0?i:void 0)}t6(e,d=>{_W(o,d)})}function HJ(o,e){const i=SM(GJ(o,e)),d=BU(o.transactionQueueTree_,e);return function vte(o,e,i){let d=i?o:o.parent;for(;null!==d;){if(e(d))return!0;d=d.parent}}(d,_=>{z7(o,_)}),z7(o,d),MJ(d,_=>{z7(o,_)}),i}function z7(o,e){const i=e6(e);if(i){const d=[];let _=[],B=-1;for(let _t=0;_t<i.length;_t++)3===i[_t].status||(1===i[_t].status?((0,M_.hu)(B===_t-1,"All SENT items should be at beginning of queue."),B=_t,i[_t].status=3,i[_t].abortReason="set"):((0,M_.hu)(0===i[_t].status,"Unexpected transaction status in abort"),i[_t].unwatcher(),_=_.concat(RL(o.serverSyncTree_,i[_t].currentWriteId,!0)),i[_t].onComplete&&d.push(i[_t].onComplete.bind(null,new Error("set"),!1,null))));-1===B?oW(e,void 0):i.length=B+1,z2(o.eventQueue_,SM(e),_);for(let _t=0;_t<d.length;_t++)SU(d[_t])}}const qJ=function(o,e){const i=Ase(o),d=i.namespace;return"firebase.com"===i.domain&&CL(i.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!d||"undefined"===d)&&"localhost"!==i.domain&&CL("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),i.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&_O("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new QY(i.host,i.secure,d,"ws"===i.scheme||"wss"===i.scheme,e,"",d!==i.subdomain),path:new z1(i.pathString)}},Ase=function(o){let e="",i="",d="",_="",B="",_t=!0,_a="https",_h=443;if("string"==typeof o){let _g=o.indexOf("//");_g>=0&&(_a=o.substring(0,_g-1),o=o.substring(_g+2));let l_=o.indexOf("/");-1===l_&&(l_=o.length);let f_=o.indexOf("?");-1===f_&&(f_=o.length),e=o.substring(0,Math.min(l_,f_)),l_<f_&&(_=function mse(o){let e="";const i=o.split("/");for(let d=0;d<i.length;d++)if(i[d].length>0){let _=i[d];try{_=decodeURIComponent(_.replace(/\+/g," "))}catch(B){}e+="/"+_}return e}(o.substring(l_,f_)));const R_=function kde(o){const e={};"?"===o.charAt(0)&&(o=o.substring(1));for(const i of o.split("&")){if(0===i.length)continue;const d=i.split("=");2===d.length?e[decodeURIComponent(d[0])]=decodeURIComponent(d[1]):_O(`Invalid query segment '${i}' in query '${o}'`)}return e}(o.substring(Math.min(o.length,f_)));_g=e.indexOf(":"),_g>=0?(_t="https"===_a||"wss"===_a,_h=parseInt(e.substring(_g+1),10)):_g=e.length;const H_=e.slice(0,_g);if("localhost"===H_.toLowerCase())i="localhost";else if(H_.split(".").length<=2)i=H_;else{const W_=e.indexOf(".");d=e.substring(0,W_).toLowerCase(),i=e.substring(W_+1),B=d}"ns"in R_&&(B=R_.ns)}return{host:e,port:_h,domain:i,subdomain:d,secure:_t,scheme:_a,pathString:_,namespace:B}};class b4{constructor(e,i,d,_){this.eventType=e,this.eventRegistration=i,this.snapshot=d,this.prevName=_}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,M_.Pz)(this.snapshot.exportVal())}}class VU{constructor(e,i,d){this.eventRegistration=e,this.error=i,this.path=d}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class o6{constructor(e,i){this.snapshotCallback=e,this.cancelCallback=i}onValue(e,i){this.snapshotCallback.call(null,e,i)}onCancel(e){return(0,M_.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class _se{constructor(e,i){this._repo=e,this._path=i}cancel(){const e=new M_.BH;return H7(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){pN("OnDisconnect.remove",this._path);const e=new M_.BH;return r6(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){pN("OnDisconnect.set",this._path),JN("OnDisconnect.set",e,this._path,!1);const i=new M_.BH;return r6(this._repo,this._path,e,i.wrapCallback(()=>{})),i.promise}setWithPriority(e,i){pN("OnDisconnect.setWithPriority",this._path),JN("OnDisconnect.setWithPriority",e,this._path,!1),UJ("OnDisconnect.setWithPriority",i,!1);const d=new M_.BH;return function I4(o,e,i,d,_){const B=bT(i,d);o.server_.onDisconnectPut(e.toString(),B.val(!0),(_t,_a)=>{"ok"===_t&&W5(o.onDisconnect_,e,B),Y2(0,_,_t,_a)})}(this._repo,this._path,e,i,d.wrapCallback(()=>{})),d.promise}update(e){pN("OnDisconnect.update",this._path),uW("OnDisconnect.update",e,this._path,!1);const i=new M_.BH;return function q7(o,e,i,d){if((0,M_.xb)(i))return ZR("onDisconnect().update() called with empty data.  Don't do anything."),void Y2(0,d,"ok",void 0);o.server_.onDisconnectMerge(e.toString(),i,(_,B)=>{"ok"===_&&JS(i,(_t,_a)=>{const _h=bT(_a);W5(o.onDisconnect_,IT(e,_t),_h)}),Y2(0,d,_,B)})}(this._repo,this._path,e,i.wrapCallback(()=>{})),i.promise}}class gN{constructor(e,i,d,_){this._repo=e,this._path=i,this._queryParams=d,this._orderByCalled=_}get key(){return S1(this._path)?null:TH(this._path)}get ref(){return new KP(this._repo,this._path)}get _queryIdentifier(){const e=hJ(this._queryParams),i=f7(e);return"{}"===i?"default":i}get _queryObject(){return hJ(this._queryParams)}isEqual(e){if(!((e=(0,M_.m9)(e))instanceof gN))return!1;const i=this._repo===e._repo,d=SH(this._path,e._path);return i&&d&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function JY(o){let e="";for(let i=o.pieceNum_;i<o.pieces_.length;i++)""!==o.pieces_[i]&&(e+="/"+encodeURIComponent(String(o.pieces_[i])));return e||"/"}(this._path)}}function vW(o,e){if(!0===o._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function s6(o){let e=null,i=null;if(o.hasStart()&&(e=o.getIndexStartValue()),o.hasEnd()&&(i=o.getIndexEndValue()),o.getIndex()===kU){const d="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",_="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(o.hasStart()){if(o.getIndexStartName()!==TU)throw new Error(d);if("string"!=typeof e)throw new Error(_)}if(o.hasEnd()){if(o.getIndexEndName()!==TM)throw new Error(d);if("string"!=typeof i)throw new Error(_)}}else if(o.getIndex()===DT){if(null!=e&&!A8(e)||null!=i&&!A8(i))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,M_.hu)(o.getIndex()instanceof i8||o.getIndex()===PH,"unknown index type."),null!=e&&"object"==typeof e||null!=i&&"object"==typeof i)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Y7(o){if(o.hasStart()&&o.hasEnd()&&o.hasLimit()&&!o.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class KP extends gN{constructor(e,i){super(e,i,new MH,!1)}get parent(){const e=$Y(this._path);return null===e?null:new KP(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class C4{constructor(e,i,d){this._node=e,this.ref=i,this._index=d}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const i=new z1(e),d=a6(this.ref,e);return new C4(this._node.getChild(i),d,DT)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(d,_)=>e(new C4(_,a6(this.ref,d),DT)))}hasChild(e){const i=new z1(e);return!this._node.getChild(i).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function yW(o,e){return(o=(0,M_.m9)(o))._checkNotDeleted("ref"),void 0!==e?a6(o._root,e):o._root}function Rte(o,e){(o=(0,M_.m9)(o))._checkNotDeleted("refFromURL");const i=qJ(e,o._repo.repoInfo_.nodeAdmin);FJ("refFromURL",i);const d=i.repoInfo;return!o._repo.repoInfo_.isCustomHost()&&d.host!==o._repo.repoInfo_.host&&CL("refFromURL: Host name does not match the current database: (found "+d.host+" but expected "+o._repo.repoInfo_.host+")"),yW(o,i.path.toString())}function a6(o,e){return null===y1((o=(0,M_.m9)(o))._path)?(i=e,i&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),UU("child","path",i,!1)):UU("child","path",e,!1),new KP(o._repo,IT(o._path,e));var i}function WJ(o,e){o=(0,M_.m9)(o),pN("set",o._path),JN("set",e,o._path,!1);const i=new M_.BH;return FU(o._repo,o._path,e,null,i.wrapCallback(()=>{})),i.promise}function Nte(o,e){uW("update",e,o._path,!1);const i=new M_.BH;return function E8(o,e,i,d){I8(o,"update",{path:e.toString(),value:i});let _=!0;const B=_8(o),_t={};if(JS(i,(_a,_h)=>{_=!1,_t[_a]=mte(IT(e,_a),bT(_h),o.serverSyncTree_,B)}),_)ZR("update() called with empty data.  Don't do anything."),Y2(0,d,"ok",void 0);else{const _a=y8(o),_h=function LU(o,e,i,d){!function d8(o,e,i,d){(0,M_.hu)(d>o.lastWriteId,"Stacking an older merge on top of newer ones"),o.allWrites.push({path:e,children:i,writeId:d,visible:!0}),o.visibleWrites=z5(o.visibleWrites,e,i),o.lastWriteId=d}(o.pendingWriteTree_,e,i,d);const _=BT.fromObject(i);return MU(o,new f4({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,_))}(o.serverSyncTree_,e,_t,_a);G7(o.eventQueue_,_h),o.server_.merge(e.toString(),i,(_g,l_)=>{const f_="ok"===_g;f_||_O("update at "+e+" failed: "+_g);const R_=RL(o.serverSyncTree_,_a,!f_),H_=R_.length>0?jU(o,e):e;z2(o.eventQueue_,H_,R_),Y2(0,d,_g,l_)}),JS(i,_g=>{const l_=HJ(o,IT(e,_g));jU(o,l_)}),z2(o.eventQueue_,e,[])}}(o._repo,o._path,e,i.wrapCallback(()=>{})),i.promise}function IW(o){return function pse(o,e){const i=function hte(o,e){const i=e._path;let d=null;o.syncPointTree_.foreachOnPath(i,(_g,l_)=>{const f_=VO(_g,i);d=d||v4(l_,f_)});let _=o.syncPointTree_.get(i);_?d=d||v4(_,U1()):(_=new ite,o.syncPointTree_=o.syncPointTree_.set(i,_));const B=null!=d,_t=B?new p4(d,!0,!1):null;return function Dde(o){return T7(o.viewCache_)}(fS(_,e,S7(o.pendingWriteTree_,e._path),B?_t.getNode():m1.EMPTY_NODE,B))}(o.serverSyncTree_,e);return null!=i?Promise.resolve(i):o.server_.get(e).then(d=>{const _=bT(d).withIndex(e._queryParams.getIndex()),B=$5(o.serverSyncTree_,e._path,_);return dW(o.eventQueue_,e._path,B),Promise.resolve(_)},d=>(I8(o,"get for query "+(0,M_.Pz)(e)+" failed: "+d),Promise.reject(new Error(d))))}((o=(0,M_.m9)(o))._repo,o).then(e=>new C4(e,new KP(o._repo,o._path),o._queryParams.getIndex()))}class GU{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,i){const d=i._queryParams.getIndex();return new b4("value",this,new C4(e.snapshotNode,new KP(i._repo,i._path),d))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,i){return this.callbackContext.hasCancelCallback?new VU(this,e,i):null}matches(e){return e instanceof GU&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class J7{constructor(e,i){this.eventType=e,this.callbackContext=i}respondsTo(e){let i="children_added"===e?"child_added":e;return i="children_removed"===i?"child_removed":i,this.eventType===i}createCancelEvent(e,i){return this.callbackContext.hasCancelCallback?new VU(this,e,i):null}createEvent(e,i){(0,M_.hu)(null!=e.childName,"Child events should have a childName.");const d=a6(new KP(i._repo,i._path),e.childName),_=i._queryParams.getIndex();return new b4(e.type,this,new C4(e.snapshotNode,d,_),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof J7&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function c6(o,e,i,d,_){let B;if("object"==typeof d&&(B=void 0,_=d),"function"==typeof d&&(B=d),_&&_.onlyOnce){const _h=i,_g=(l_,f_)=>{Tte(o._repo,o,_a),_h(l_,f_)};_g.userCallback=i.userCallback,_g.context=i.context,i=_g}const _t=new o6(i,B||void 0),_a="value"===e?new GU(_t):new J7(e,_t);return function wte(o,e,i){let d;d=".info"===y1(e._path)?dte(o.infoSyncTree_,e,i):dte(o.serverSyncTree_,e,i),dW(o.eventQueue_,e._path,d)}(o._repo,o,_a),()=>Tte(o._repo,o,_a)}function bW(o,e,i,d){return c6(o,"value",e,i,d)}function CW(o,e,i,d){return c6(o,"child_added",e,i,d)}function wW(o,e,i,d){return c6(o,"child_changed",e,i,d)}function kte(o,e,i,d){return c6(o,"child_moved",e,i,d)}function zJ(o,e,i,d){return c6(o,"child_removed",e,i,d)}function Pte(o,e,i){let d=null;const _=i?new o6(i):null;"value"===e?d=new GU(_):e&&(d=new J7(e,_)),Tte(o._repo,o,d)}class DL{}class YJ extends DL{constructor(e,i){super(),this._value=e,this._key=i}_apply(e){JN("endAt",this._value,e._path,!0);const i=E7(e._queryParams,this._value,this._key);if(Y7(i),s6(i),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new gN(e._repo,e._path,i,e._orderByCalled)}}class xte extends DL{constructor(e,i){super(),this._value=e,this._key=i}_apply(e){JN("endBefore",this._value,e._path,!1);const i=function Fee(o,e,i){let d,_;return o.index_===kU?("string"==typeof e&&(e=a8(e)),_=E7(o,e,i)):(d=null==i?TU:a8(i),_=E7(o,e,d)),_.endBeforeSet_=!0,_}(e._queryParams,this._value,this._key);if(Y7(i),s6(i),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new gN(e._repo,e._path,i,e._orderByCalled)}}class Lte extends DL{constructor(e,i){super(),this._value=e,this._key=i}_apply(e){JN("startAt",this._value,e._path,!0);const i=BH(e._queryParams,this._value,this._key);if(Y7(i),s6(i),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new gN(e._repo,e._path,i,e._orderByCalled)}}class NL extends DL{constructor(e,i){super(),this._value=e,this._key=i}_apply(e){JN("startAfter",this._value,e._path,!1);const i=function lJ(o,e,i){let d;if(o.index_===kU)"string"==typeof e&&(e=cJ(e)),d=BH(o,e,i);else{let _;_=null==i?TM:cJ(i),d=BH(o,e,_)}return d.startAfterSet_=!0,d}(e._queryParams,this._value,this._key);if(Y7(i),s6(i),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new gN(e._repo,e._path,i,e._orderByCalled)}}class $J extends DL{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new gN(e._repo,e._path,function Uee(o,e){const i=o.copy();return i.limitSet_=!0,i.limit_=e,i.viewFrom_="l",i}(e._queryParams,this._limit),e._orderByCalled)}}class Mte extends DL{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new gN(e._repo,e._path,function y7(o,e){const i=o.copy();return i.limitSet_=!0,i.limit_=e,i.viewFrom_="r",i}(e._queryParams,this._limit),e._orderByCalled)}}class Ise extends DL{constructor(e){super(),this._path=e}_apply(e){vW(e,"orderByChild");const i=new z1(this._path);if(S1(i))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const d=new i8(i),_=I7(e._queryParams,d);return s6(_),new gN(e._repo,e._path,_,!0)}}class TW extends DL{_apply(e){vW(e,"orderByKey");const i=I7(e._queryParams,kU);return s6(i),new gN(e._repo,e._path,i,!0)}}class Ute extends DL{_apply(e){vW(e,"orderByPriority");const i=I7(e._queryParams,DT);return s6(i),new gN(e._repo,e._path,i,!0)}}class jte extends DL{_apply(e){vW(e,"orderByValue");const i=I7(e._queryParams,PH);return s6(i),new gN(e._repo,e._path,i,!0)}}class Vte extends DL{constructor(e,i){super(),this._value=e,this._key=i}_apply(e){if(JN("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new YJ(this._value,this._key)._apply(new Lte(this._value,this._key)._apply(e))}}function J2(o,...e){let i=(0,M_.m9)(o);for(const d of e)i=d._apply(i);return i}(function YH(o){(0,M_.hu)(!_4,"__referenceConstructor has already been defined"),_4=o})(KP),function ose(o){(0,M_.hu)(!XH,"__referenceConstructor has already been defined"),XH=o}(KP);const X7={};function T4(o,e,i,d,_){let B=d||o.options.databaseURL;void 0===B&&(o.options.projectId||CL("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ZR("Using default host for project ",o.options.projectId),B=`${o.options.projectId}-default-rtdb.firebaseio.com`);let _h,_g,_t=qJ(B,_),_a=_t.repoInfo;"undefined"!=typeof process&&process.env&&(_g=process.env.FIREBASE_DATABASE_EMULATOR_HOST),_g?(_h=!0,B=`http://${_g}?ns=${_a.namespace}`,_t=qJ(B,_),_a=_t.repoInfo):_h=!_t.repoInfo.secure;const l_=_&&_h?new lN(lN.OWNER):new xoe(o.name,o.options,e);FJ("Invalid Firebase Database URL",_t),S1(_t.path)||CL("Database URL must point to the root of a Firebase Database (not including a child path).");const f_=function Qte(o,e,i,d){let _=X7[e.name];_||(_={},X7[e.name]=_);let B=_[o.toURLString()];return B&&CL("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),B=new pW(o,false,i,d),_[o.toURLString()]=B,B}(_a,o,l_,new Poe(o.name,i));return new RW(f_,o)}class RW{constructor(e,i){this._repoInternal=e,this.app=i,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function jJ(o,e,i){if(o.stats_=ZV(o.repoInfo_),o.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)o.server_=new b7(o.repoInfo_,(d,_,B,_t)=>{v8(o,d,_,B,_t)},o.authTokenProvider_,o.appCheckProvider_),setTimeout(()=>bte(o,!0),0);else{if(null!=i){if("object"!=typeof i)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,M_.Pz)(i)}catch(d){throw new Error("Invalid authOverride provided: "+d)}}o.persistentConnection_=new F5(o.repoInfo_,e,(d,_,B,_t)=>{v8(o,d,_,B,_t)},d=>{bte(o,d)},d=>{!function E4(o,e){JS(e,(i,d)=>{VJ(o,i,d)})}(o,d)},o.authTokenProvider_,o.appCheckProvider_,i),o.server_=o.persistentConnection_}o.authTokenProvider_.addTokenChangeListener(d=>{o.server_.refreshAuthToken(d)}),o.appCheckProvider_.addTokenChangeListener(d=>{o.server_.refreshAppCheckToken(d.token)}),o.statsReporter_=function Moe(o,e){const i=o.toString();return yH[i]||(yH[i]=e()),yH[i]}(o.repoInfo_,()=>new C7(o.stats_,o.server_)),o.infoData_=new Joe,o.infoSyncTree_=new cte({startListening:(d,_,B,_t)=>{let _a=[];const _h=o.infoData_.getNode(d._path);return _h.isEmpty()||(_a=$5(o.infoSyncTree_,d._path,_h),setTimeout(()=>{_t("ok")},0)),_a},stopListening:()=>{}}),VJ(o,"connected",!1),o.serverSyncTree_=new cte({startListening:(d,_,B,_t)=>(o.server_.listen(d,B,_,(_a,_h)=>{const _g=_t(_a,_h);z2(o.eventQueue_,d._path,_g)}),[]),stopListening:(d,_)=>{o.server_.unlisten(d,_)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new KP(this._repo,U1())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function S4(o,e){const i=X7[e];(!i||i[o.key]!==o)&&CL(`Database ${e}(${o.repoInfo_}) has already been deleted.`),W7(o),delete i[o.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&CL("Cannot call "+e+" on a deleted database.")}}function Hte(){Cee.IS_TRANSPORT_INITIALIZED&&_O("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function qte(){Hte(),H2.forceDisallow()}function e$(){Hte(),e8.forceDisallow(),H2.forceAllow()}function n$(o,e){koe(o,e)}const $N={".sv":"timestamp"};class Yte{constructor(e,i){this.committed=e,this.snapshot=i}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}F5.prototype.simpleListen=function(o,e){this.sendRequest("q",{p:o},e)},F5.prototype.echo=function(o,e){this.sendRequest("echo",{d:o},e)},function r$(o){P5(uN.SDK_VERSION),(0,uN._registerComponent)(new bL.wA("database",(e,{instanceIdentifier:i})=>T4(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),i),"PUBLIC").setMultipleInstances(!0)),(0,uN.registerVersion)(dee,"0.13.0",o),(0,uN.registerVersion)(dee,"0.13.0","esm2017")}();const tQ=new QP.Yd("@firebase/database-compat"),Jte=function(o){tQ.warn("FIREBASE WARNING: "+o)};class $te{constructor(e){this._delegate=e}cancel(e){(0,M_.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,M_.Wj)("OnDisconnect.cancel","onComplete",e,!0);const i=this._delegate.cancel();return e&&i.then(()=>e(null),d=>e(d)),i}remove(e){(0,M_.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,M_.Wj)("OnDisconnect.remove","onComplete",e,!0);const i=this._delegate.remove();return e&&i.then(()=>e(null),d=>e(d)),i}set(e,i){(0,M_.Dv)("OnDisconnect.set",1,2,arguments.length),(0,M_.Wj)("OnDisconnect.set","onComplete",i,!0);const d=this._delegate.set(e);return i&&d.then(()=>i(null),_=>i(_)),d}setWithPriority(e,i,d){(0,M_.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,M_.Wj)("OnDisconnect.setWithPriority","onComplete",d,!0);const _=this._delegate.setWithPriority(e,i);return d&&_.then(()=>d(null),B=>d(B)),_}update(e,i){if((0,M_.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const _={};for(let B=0;B<e.length;++B)_[""+B]=e[B];e=_,Jte("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,M_.Wj)("OnDisconnect.update","onComplete",i,!0);const d=this._delegate.update(e);return i&&d.then(()=>i(null),_=>i(_)),d}}class o${constructor(e,i){this.committed=e,this.snapshot=i}toJSON(){return(0,M_.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class R4{constructor(e,i){this._database=e,this._delegate=i}val(){return(0,M_.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,M_.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,M_.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,M_.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,M_.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),UU("DataSnapshot.child","path",e,!1),new R4(this._database,this._delegate.child(e))}hasChild(e){return(0,M_.Dv)("DataSnapshot.hasChild",1,1,arguments.length),UU("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,M_.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,M_.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,M_.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(i=>e(new R4(this._database,i)))}hasChildren(){return(0,M_.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,M_.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,M_.Dv)("DataSnapshot.ref",0,0,arguments.length),new ZN(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class dR{constructor(e,i){this.database=e,this._delegate=i}on(e,i,d,_){var B;(0,M_.Dv)("Query.on",2,4,arguments.length),(0,M_.Wj)("Query.on","callback",i,!1);const _t=dR.getCancelAndContextArgs_("Query.on",d,_),_a=(_g,l_)=>{i.call(_t.context,new R4(this.database,_g),l_)};_a.userCallback=i,_a.context=_t.context;const _h=null===(B=_t.cancel)||void 0===B?void 0:B.bind(_t.context);switch(e){case"value":return bW(this._delegate,_a,_h),i;case"child_added":return CW(this._delegate,_a,_h),i;case"child_removed":return zJ(this._delegate,_a,_h),i;case"child_changed":return wW(this._delegate,_a,_h),i;case"child_moved":return kte(this._delegate,_a,_h),i;default:throw new Error((0,M_.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,i,d){if((0,M_.Dv)("Query.off",0,3,arguments.length),function(o,e,i){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,M_.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,M_.Wj)("Query.off","callback",i,!0),(0,M_.lb)("Query.off","context",d,!0),i){const _=()=>{};_.userCallback=i,_.context=d,Pte(this._delegate,e,_)}else Pte(this._delegate,e)}get(){return IW(this._delegate).then(e=>new R4(this.database,e))}once(e,i,d,_){(0,M_.Dv)("Query.once",1,4,arguments.length),(0,M_.Wj)("Query.once","callback",i,!0);const B=dR.getCancelAndContextArgs_("Query.once",d,_),_t=new M_.BH,_a=(_g,l_)=>{const f_=new R4(this.database,_g);i&&i.call(B.context,f_,l_),_t.resolve(f_)};_a.userCallback=i,_a.context=B.context;const _h=_g=>{B.cancel&&B.cancel.call(B.context,_g),_t.reject(_g)};switch(e){case"value":bW(this._delegate,_a,_h,{onlyOnce:!0});break;case"child_added":CW(this._delegate,_a,_h,{onlyOnce:!0});break;case"child_removed":zJ(this._delegate,_a,_h,{onlyOnce:!0});break;case"child_changed":wW(this._delegate,_a,_h,{onlyOnce:!0});break;case"child_moved":kte(this._delegate,_a,_h,{onlyOnce:!0});break;default:throw new Error((0,M_.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return _t.promise}limitToFirst(e){return(0,M_.Dv)("Query.limitToFirst",1,1,arguments.length),new dR(this.database,J2(this._delegate,function u6(o){if("number"!=typeof o||Math.floor(o)!==o||o<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new $J(o)}(e)))}limitToLast(e){return(0,M_.Dv)("Query.limitToLast",1,1,arguments.length),new dR(this.database,J2(this._delegate,function Bte(o){if("number"!=typeof o||Math.floor(o)!==o||o<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Mte(o)}(e)))}orderByChild(e){return(0,M_.Dv)("Query.orderByChild",1,1,arguments.length),new dR(this.database,J2(this._delegate,function Z7(o){if("$key"===o)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===o)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===o)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return UU("orderByChild","path",o,!1),new Ise(o)}(e)))}orderByKey(){return(0,M_.Dv)("Query.orderByKey",0,0,arguments.length),new dR(this.database,J2(this._delegate,function bse(){return new TW}()))}orderByPriority(){return(0,M_.Dv)("Query.orderByPriority",0,0,arguments.length),new dR(this.database,J2(this._delegate,function Fte(){return new Ute}()))}orderByValue(){return(0,M_.Dv)("Query.orderByValue",0,0,arguments.length),new dR(this.database,J2(this._delegate,function SW(){return new jte}()))}startAt(e=null,i){return(0,M_.Dv)("Query.startAt",0,2,arguments.length),new dR(this.database,J2(this._delegate,function JJ(o=null,e){return y4("startAt","key",e,!0),new Lte(o,e)}(e,i)))}startAfter(e=null,i){return(0,M_.Dv)("Query.startAfter",0,2,arguments.length),new dR(this.database,J2(this._delegate,function Ese(o,e){return y4("startAfter","key",e,!0),new NL(o,e)}(e,i)))}endAt(e=null,i){return(0,M_.Dv)("Query.endAt",0,2,arguments.length),new dR(this.database,J2(this._delegate,function yse(o,e){return y4("endAt","key",e,!0),new YJ(o,e)}(e,i)))}endBefore(e=null,i){return(0,M_.Dv)("Query.endBefore",0,2,arguments.length),new dR(this.database,J2(this._delegate,function $7(o,e){return y4("endBefore","key",e,!0),new xte(o,e)}(e,i)))}equalTo(e,i){return(0,M_.Dv)("Query.equalTo",1,2,arguments.length),new dR(this.database,J2(this._delegate,function Gte(o,e){return y4("equalTo","key",e,!0),new Vte(o,e)}(e,i)))}toString(){return(0,M_.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,M_.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,M_.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof dR))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,i,d){const _={cancel:void 0,context:void 0};if(i&&d)_.cancel=i,(0,M_.Wj)(e,"cancel",_.cancel,!0),_.context=d,(0,M_.lb)(e,"context",_.context,!0);else if(i)if("object"==typeof i&&null!==i)_.context=i;else{if("function"!=typeof i)throw new Error((0,M_.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");_.cancel=i}return _}get ref(){return new ZN(this.database,new KP(this._delegate._repo,this._delegate._path))}}class ZN extends dR{constructor(e,i){super(e,new gN(i._repo,i._path,new MH,!1)),this.database=e,this._delegate=i}getKey(){return(0,M_.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,M_.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new ZN(this.database,a6(this._delegate,e))}getParent(){(0,M_.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new ZN(this.database,e):null}getRoot(){return(0,M_.Dv)("Reference.root",0,0,arguments.length),new ZN(this.database,this._delegate.root)}set(e,i){(0,M_.Dv)("Reference.set",1,2,arguments.length),(0,M_.Wj)("Reference.set","onComplete",i,!0);const d=WJ(this._delegate,e);return i&&d.then(()=>i(null),_=>i(_)),d}update(e,i){if((0,M_.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const _={};for(let B=0;B<e.length;++B)_[""+B]=e[B];e=_,Jte("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}pN("Reference.update",this._delegate._path),(0,M_.Wj)("Reference.update","onComplete",i,!0);const d=Nte(this._delegate,e);return i&&d.then(()=>i(null),_=>i(_)),d}setWithPriority(e,i,d){(0,M_.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,M_.Wj)("Reference.setWithPriority","onComplete",d,!0);const _=function KJ(o,e,i){if(pN("setWithPriority",o._path),JN("setWithPriority",e,o._path,!1),UJ("setWithPriority",i,!1),".length"===o.key||".keys"===o.key)throw"setWithPriority failed: "+o.key+" is a read-only object.";const d=new M_.BH;return FU(o._repo,o._path,e,i,d.wrapCallback(()=>{})),d.promise}(this._delegate,e,i);return d&&_.then(()=>d(null),B=>d(B)),_}remove(e){(0,M_.Dv)("Reference.remove",0,1,arguments.length),(0,M_.Wj)("Reference.remove","onComplete",e,!0);const i=function Dte(o){return pN("remove",o._path),WJ(o,null)}(this._delegate);return e&&i.then(()=>e(null),d=>e(d)),i}transaction(e,i,d){(0,M_.Dv)("Reference.transaction",1,3,arguments.length),(0,M_.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,M_.Wj)("Reference.transaction","onComplete",i,!0),function(o,e,i,d){if(void 0!==i&&"boolean"!=typeof i)throw new Error((0,M_.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,d);const _=function mN(o,e,i){var d;if(o=(0,M_.m9)(o),pN("Reference.transaction",o._path),".length"===o.key||".keys"===o.key)throw"Reference.transaction failed: "+o.key+" is a read-only object.";const _=null===(d=null==i?void 0:i.applyLocally)||void 0===d||d,B=new M_.BH,_a=bW(o,()=>{});return function gse(o,e,i,d,_,B){I8(o,"transaction on "+e);const _t={path:e,update:i,onComplete:d,status:null,order:aH(),applyLocally:B,retryCount:0,unwatcher:_,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},_a=gW(o,e,void 0);_t.currentInputSnapshot=_a;const _h=_t.update(_a.val());if(void 0===_h)_t.unwatcher(),_t.currentOutputSnapshotRaw=null,_t.currentOutputSnapshotResolved=null,_t.onComplete&&_t.onComplete(null,!1,_t.currentInputSnapshot);else{n6("transaction failed: Data returned ",_h,_t.path),_t.status=0;const _g=BU(o.transactionQueueTree_,e),l_=e6(_g)||[];let f_;l_.push(_t),oW(_g,l_),"object"==typeof _h&&null!==_h&&(0,M_.r3)(_h,".priority")?(f_=(0,M_.DV)(_h,".priority"),(0,M_.hu)(A8(f_),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f_=(tW(o.serverSyncTree_,e)||m1.EMPTY_NODE).getPriority().val();const R_=_8(o),H_=bT(_h,f_),W_=OL(H_,_a,R_);_t.currentOutputSnapshotRaw=H_,_t.currentOutputSnapshotResolved=W_,_t.currentWriteId=y8(o);const R0=OJ(o.serverSyncTree_,e,W_,_t.currentWriteId,_t.applyLocally);z2(o.eventQueue_,e,R0),K7(o,o.transactionQueueTree_)}}(o._repo,o._path,e,(_h,_g,l_)=>{let f_=null;_h?B.reject(_h):(f_=new C4(l_,new KP(o._repo,o._path),DT),B.resolve(new Yte(_g,f_)))},_a,_),B.promise}(this._delegate,e,{applyLocally:d}).then(B=>new o$(B.committed,new R4(this.database,B.snapshot)));return i&&_.then(B=>i(null,B.committed,B.snapshot),B=>i(B,!1,null)),_}setPriority(e,i){(0,M_.Dv)("Reference.setPriority",1,2,arguments.length),(0,M_.Wj)("Reference.setPriority","onComplete",i,!0);const d=function EW(o,e){o=(0,M_.m9)(o),pN("setPriority",o._path),UJ("setPriority",e,!1);const i=new M_.BH;return FU(o._repo,IT(o._path,".priority"),e,null,i.wrapCallback(()=>{})),i.promise}(this._delegate,e);return i&&d.then(()=>i(null),_=>i(_)),d}push(e,i){(0,M_.Dv)("Reference.push",0,2,arguments.length),(0,M_.Wj)("Reference.push","onComplete",i,!0);const d=function Ote(o,e){o=(0,M_.m9)(o),pN("push",o._path),JN("push",e,o._path,!0);const i=Ite(o._repo),d=s8(i),_=a6(o,d),B=a6(o,d);let _t;return _t=null!=e?WJ(B,e).then(()=>B):Promise.resolve(B),_.then=_t.then.bind(_t),_.catch=_t.then.bind(_t,void 0),_}(this._delegate,e),_=d.then(_t=>new ZN(this.database,_t));i&&_.then(()=>i(null),_t=>i(_t));const B=new ZN(this.database,d);return B.then=_.then.bind(_),B.catch=_.catch.bind(_,void 0),B}onDisconnect(){return pN("Reference.onDisconnect",this._delegate._path),new $te(new _se(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class O4{constructor(e,i){this._delegate=e,this.app=i,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:qte,forceLongPolling:e$}}useEmulator(e,i,d={}){!function Cse(o,e,i,d={}){(o=(0,M_.m9)(o))._checkNotDeleted("useEmulator"),o._instanceStarted&&CL("Cannot call useEmulator() after instance has already been initialized.");const _=o._repoInternal;let B;if(_.repoInfo_.nodeAdmin)d.mockUserToken&&CL('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),B=new lN(lN.OWNER);else if(d.mockUserToken){const _t="string"==typeof d.mockUserToken?d.mockUserToken:(0,M_.Sg)(d.mockUserToken,o.app.options.projectId);B=new lN(_t)}!function ZJ(o,e,i,d){o.repoInfo_=new QY(`${e}:${i}`,!1,o.repoInfo_.namespace,o.repoInfo_.webSocketOnly,o.repoInfo_.nodeAdmin,o.repoInfo_.persistenceKey,o.repoInfo_.includeNamespaceInQueryParams),d&&(o.authTokenProvider_=d)}(_,e,i,B)}(this._delegate,e,i,d)}ref(e){if((0,M_.Dv)("database.ref",0,1,arguments.length),e instanceof ZN){const i=Rte(this._delegate,e.toString());return new ZN(this,i)}{const i=yW(this._delegate,e);return new ZN(this,i)}}refFromURL(e){(0,M_.Dv)("database.refFromURL",1,1,arguments.length);const d=Rte(this._delegate,e);return new ZN(this,d)}goOffline(){return(0,M_.Dv)("database.goOffline",0,0,arguments.length),function Kte(o){(o=(0,M_.m9)(o))._checkNotDeleted("goOffline"),W7(o._repo)}(this._delegate)}goOnline(){return(0,M_.Dv)("database.goOnline",0,0,arguments.length),function t$(o){(o=(0,M_.m9)(o))._checkNotDeleted("goOnline"),function Ste(o){o.persistentConnection_&&o.persistentConnection_.resume(fW)}(o._repo)}(this._delegate)}}O4.ServerValue={TIMESTAMP:function wse(){return $N}(),increment:o=>function zte(o){return{".sv":{increment:o}}}(o)};var s$=Object.freeze({__proto__:null,initStandalone:function D4({app:o,url:e,version:i,customAuthImpl:d,namespace:_,nodeAdmin:B=!1}){P5(i);const _t=new bL.zt("auth-internal",new bL.H0("database-standalone"));return _t.setComponent(new bL.wA("auth-internal",()=>d,"PRIVATE")),{instance:new O4(T4(o,_t,void 0,e,B),o),namespace:_}}});const Zte=O4.ServerValue;!function OW(o){o.INTERNAL.registerComponent(new bL.wA("database-compat",(e,{instanceIdentifier:i})=>{const d=e.getProvider("app-compat").getImmediate(),_=e.getProvider("database").getImmediate({identifier:i});return new O4(_,d)},"PUBLIC").setServiceProps({Reference:ZN,Query:dR,Database:O4,DataSnapshot:R4,enableLogging:n$,INTERNAL:s$,ServerValue:Zte}).setMultipleInstances(!0)),o.registerVersion("@firebase/database-compat","0.2.0")}(k5.Z);var rQ=g(5363),a$=g(6063);class N4 extends xT.x{constructor(e=1/0,i=1/0,d=a$.l){super(),this._bufferSize=e,this._windowTime=i,this._timestampProvider=d,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=i===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,i)}next(e){const{isStopped:i,_buffer:d,_infiniteTimeWindow:_,_timestampProvider:B,_windowTime:_t}=this;i||(d.push(e),!_&&d.push(B.now()+_t)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const i=this._innerSubscribe(e),{_infiniteTimeWindow:d,_buffer:_}=this,B=_.slice();for(let _t=0;_t<B.length&&!e.closed;_t+=d?1:2)e.next(B[_t]);return this._checkFinalizedStatuses(e),i}_trimBuffer(){const{_bufferSize:e,_timestampProvider:i,_buffer:d,_infiniteTimeWindow:_}=this,B=(_?1:2)*e;if(e<1/0&&B<d.length&&d.splice(0,d.length-B),!_){const _t=i.now();let _a=0;for(let _h=1;_h<d.length&&d[_h]<=_t;_h+=2)_a=_h;_a&&d.splice(0,_a+1)}}}function QU(o,e,i){let d,_=!1;return o&&"object"==typeof o?({bufferSize:d=1/0,windowTime:e=1/0,refCount:_=!1,scheduler:i}=o):d=null!=o?o:1/0,(0,BY.B)({connector:()=>new N4(d,e,i),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:_})}function b8(o,e){return(0,lL.m)(e)?HT(()=>o,e):HT(()=>o)}var RM=g(9468);g(5867);const h$=new Map,f$={activated:!1,tokenObservers:[]},p$={initialized:!1,enabled:!1};function eO(o){return h$.get(o)||f$}function OM(o,e){h$.set(o,e)}function P4(){return p$}class jde{constructor(e,i,d,_,B){if(this.operation=e,this.retryPolicy=i,this.getWaitDuration=d,this.lowerBound=_,this.upperBound=B,this.pending=null,this.nextErrorWaitInterval=_,_>B)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var i=this;return(0,C0.Z)(function*(){i.stop();try{i.pending=new M_.BH,yield function sQ(o){return new Promise(e=>{setTimeout(e,o)})}(i.getNextRun(e)),i.pending.resolve(),yield i.pending.promise,i.pending=new M_.BH,yield i.operation(),i.pending.resolve(),yield i.pending.promise,i.process(!0).catch(()=>{})}catch(d){i.retryPolicy(d)?i.process(!1).catch(()=>{}):i.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const i=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),i}}}const tO=new M_.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function m$(o){if(!eO(o).activated)throw tO.create("use-before-activation",{appName:o.name})}function kW(o,e){return HU.apply(this,arguments)}function HU(){return(HU=(0,C0.Z)(function*({url:o,body:e},i){const d={"Content-Type":"application/json"},_=i.getImmediate({optional:!0});if(_){const f_=yield _.getHeartbeatsHeader();f_&&(d["X-Firebase-Client"]=f_)}const B={method:"POST",body:JSON.stringify(e),headers:d};let _t,_a;try{_t=yield fetch(o,B)}catch(f_){throw tO.create("fetch-network-error",{originalErrorMessage:f_.message})}if(200!==_t.status)throw tO.create("fetch-status-error",{httpStatus:_t.status});try{_a=yield _t.json()}catch(f_){throw tO.create("fetch-parse-error",{originalErrorMessage:f_.message})}const _h=_a.ttl.match(/^([\d.]+)(s)$/);if(!_h||!_h[2]||isNaN(Number(_h[1])))throw tO.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${_a.ttl}`});const _g=1e3*Number(_h[1]),l_=Date.now();return{token:_a.token,expireTimeMillis:l_+_g,issuedAtTimeMillis:l_}})).apply(this,arguments)}function v$(o,e){const{projectId:i,appId:d,apiKey:_}=o.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${i}/apps/${d}:exchangeDebugToken?key=${_}`,body:{debug_token:e}}}const d6="firebase-app-check-store";let PW=null;function nne(){return PW||(PW=new Promise((o,e)=>{try{const i=indexedDB.open("firebase-app-check-database",1);i.onsuccess=d=>{o(d.target.result)},i.onerror=d=>{var _;e(tO.create("storage-open",{originalErrorMessage:null===(_=d.target.error)||void 0===_?void 0:_.message}))},i.onupgradeneeded=d=>{0===d.oldVersion&&d.target.result.createObjectStore(d6,{keyPath:"compositeKey"})}}catch(i){e(tO.create("storage-open",{originalErrorMessage:i.message}))}}),PW)}function $2(){return($2=(0,C0.Z)(function*(o,e){const d=(yield nne()).transaction(d6,"readwrite"),B=d.objectStore(d6).put({compositeKey:o,value:e});return new Promise((_t,_a)=>{B.onsuccess=_h=>{_t()},d.onerror=_h=>{var _g;_a(tO.create("storage-set",{originalErrorMessage:null===(_g=_h.target.error)||void 0===_g?void 0:_g.message}))}})})).apply(this,arguments)}const aQ=new QP.Yd("@firebase/app-check");function y$(o,e){return(0,M_.hl)()?function Vde(o,e){return function LW(o,e){return $2.apply(this,arguments)}(function MW(o){return`${o.options.appId}-${o.name}`}(o),e)}(o,e).catch(i=>{aQ.warn(`Failed to write token to IndexedDB. Error: ${i}`)}):Promise.resolve()}function one(){return P4().enabled}function kL(){return FW.apply(this,arguments)}function FW(){return(FW=(0,C0.Z)(function*(){const o=P4();if(o.enabled&&o.token)return o.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const h6={error:"UNKNOWN_ERROR"};function sne(o){return M_.US.encodeString(JSON.stringify(o),!1)}function XN(o){return S8.apply(this,arguments)}function S8(){return(S8=(0,C0.Z)(function*(o,e=!1){const i=o.app;m$(i);const d=eO(i);let B,_=d.token;if(!_){const _h=yield d.cachedTokenPromise;_h&&VW(_h)&&(_=_h)}if(!e&&_&&VW(_))return{token:_.token};let _a,_t=!1;if(one()){d.exchangeTokenPromise||(d.exchangeTokenPromise=kW(v$(i,yield kL()),o.heartbeatServiceProvider).then(_g=>(d.exchangeTokenPromise=void 0,_g)),_t=!0);const _h=yield d.exchangeTokenPromise;return yield y$(i,_h),OM(i,Object.assign(Object.assign({},d),{token:_h})),{token:_h.token}}try{d.exchangeTokenPromise||(d.exchangeTokenPromise=d.provider.getToken().then(_h=>(d.exchangeTokenPromise=void 0,_h)),_t=!0),_=yield d.exchangeTokenPromise}catch(_h){"appCheck/throttled"===_h.code?aQ.warn(_h.message):aQ.error(_h),B=_h}return _?(_a={token:_.token},OM(i,Object.assign(Object.assign({},d),{token:_})),yield y$(i,_)):_a=ane(B),_t&&b$(i,_a),_a})).apply(this,arguments)}function lQ(o,e){const i=eO(o),d=i.tokenObservers.filter(_=>_.next!==e);0===d.length&&i.tokenRefresher&&i.tokenRefresher.isRunning()&&i.tokenRefresher.stop(),OM(o,Object.assign(Object.assign({},i),{tokenObservers:d}))}function jW(o){const{app:e}=o,i=eO(e);let d=i.tokenRefresher;d||(d=function R8(o){const{app:e}=o;return new jde((0,C0.Z)(function*(){let d;if(d=eO(e).token?yield XN(o,!0):yield XN(o),d.error)throw d.error}),()=>!0,()=>{const i=eO(e);if(i.token){let d=i.token.issuedAtTimeMillis+.5*(i.token.expireTimeMillis-i.token.issuedAtTimeMillis)+3e5;return d=Math.min(d,i.token.expireTimeMillis-3e5),Math.max(0,d-Date.now())}return 0},3e4,96e4)}(o),OM(e,Object.assign(Object.assign({},i),{tokenRefresher:d}))),!d.isRunning()&&i.isTokenAutoRefreshEnabled&&d.start()}function b$(o,e){const i=eO(o).tokenObservers;for(const d of i)try{"EXTERNAL"===d.type&&null!=e.error?d.error(e.error):d.next(e)}catch(_){}}function VW(o){return o.expireTimeMillis-Date.now()>0}function ane(o){return{token:sne(h6),error:o}}class Fse{constructor(e,i){this.app=e,this.heartbeatServiceProvider=i}_delete(){const{tokenObservers:e}=eO(this.app);for(const i of e)lQ(this.app,i.next);return Promise.resolve()}}const pne="app-check-internal";!function O$(){(0,uN._registerComponent)(new bL.wA("app-check",o=>function O8(o,e){return new Fse(o,e)}(o.getProvider("app").getImmediate(),o.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((o,e,i)=>{o.getProvider(pne).initialize()})),(0,uN._registerComponent)(new bL.wA(pne,o=>function cne(o){return{getToken:e=>XN(o,e),addTokenListener:e=>function I$(o,e,i,d){const{app:_}=o,B=eO(_),_t={next:i,error:d,type:e};if(OM(_,Object.assign(Object.assign({},B),{tokenObservers:[...B.tokenObservers,_t]})),B.token&&VW(B.token)){const _a=B.token;Promise.resolve().then(()=>{i({token:_a.token}),jW(o)}).catch(()=>{})}B.cachedTokenPromise.then(()=>jW(o))}(o,"INTERNAL",e),removeTokenListener:e=>lQ(o.app,e)}}(o.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,uN.registerVersion)("@firebase/app-check","0.5.8")}();class f6{constructor(){return(0,H1.vb)("app-check")}}"undefined"!=typeof window&&window;var hQ=g(127);const P$=new f.OlP("angularfire2.auth.use-emulator"),KW=new f.OlP("angularfire2.auth.settings"),fQ=new f.OlP("angularfire2.auth.tenant-id"),p6=new f.OlP("angularfire2.auth.langugage-code"),x$=new f.OlP("angularfire2.auth.use-device-language"),D8=new f.OlP("angularfire.auth.persistence"),N8=(o,e,i,d,_,B,_t,_a)=>(0,lR.cc)(`${o.name}.auth`,"AngularFireAuth",o.name,()=>{const _h=e.runOutsideAngular(()=>o.auth());if(i&&_h.useEmulator(...i),d&&(_h.tenantId=d),_h.languageCode=_,B&&_h.useDeviceLanguage(),_t)for(const[_g,l_]of Object.entries(_t))_h.settings[_g]=l_;return _a&&_h.setPersistence(_a),_h},[i,d,_,B,_t,_a]);let iI=(()=>{class o{constructor(i,d,_,B,_t,_a,_h,_g,l_,f_,R_,H_){const W_=new xT.x,R0=hI(void 0).pipe((0,rQ.Q)(_t.outsideAngular),HT(()=>B.runOutsideAngular(()=>Promise.resolve().then(g.bind(g,7092)))),(0,RI.U)(()=>(0,lR.on)(i,B,d)),(0,RI.U)(H0=>N8(H0,B,_a,_g,l_,f_,_h,R_)),QU({bufferSize:1,refCount:!1}));if(rL(_))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=hI(null);else{R0.pipe(dM()).subscribe();const CI=R0.pipe(HT(DI=>DI.getRedirectResult().then(_C=>_C,()=>null)),H1.iC,QU({bufferSize:1,refCount:!1})),LI=R0.pipe(HT(DI=>new LT.y(_C=>({unsubscribe:B.runOutsideAngular(()=>DI.onAuthStateChanged(G1=>_C.next(G1),G1=>_C.error(G1),()=>_C.complete()))})))),xI=R0.pipe(HT(DI=>new LT.y(_C=>({unsubscribe:B.runOutsideAngular(()=>DI.onIdTokenChanged(G1=>_C.next(G1),G1=>_C.error(G1),()=>_C.complete()))}))));this.authState=CI.pipe(b8(LI),(0,RM.R)(_t.outsideAngular),(0,rQ.Q)(_t.insideAngular)),this.user=CI.pipe(b8(xI),(0,RM.R)(_t.outsideAngular),(0,rQ.Q)(_t.insideAngular)),this.idToken=this.user.pipe(HT(DI=>DI?(0,uT.D)(DI.getIdToken()):hI(null))),this.idTokenResult=this.user.pipe(HT(DI=>DI?(0,uT.D)(DI.getIdTokenResult()):hI(null))),this.credential=(0,MY.T)(CI,W_,this.authState.pipe(zS(DI=>!DI))).pipe((0,RI.U)(DI=>(null==DI?void 0:DI.user)?DI:null),(0,RM.R)(_t.outsideAngular),(0,rQ.Q)(_t.insideAngular))}return(0,lR.pX)(this,R0,B,{spy:{apply:(H0,CI,LI)=>{(H0.startsWith("signIn")||H0.startsWith("createUser"))&&LI.then(xI=>W_.next(xI))}}})}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(lR.Dh),f.LFG(lR.xv,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(H1.HU),f.LFG(P$,8),f.LFG(KW,8),f.LFG(fQ,8),f.LFG(p6,8),f.LFG(x$,8),f.LFG(D8,8),f.LFG(f6,8))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac,providedIn:"any"}),o})(),Wse=(()=>{class o{constructor(){hQ.Z.registerVersion("angularfire",H1.q4.full,"auth-compat")}}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=f.oAB({type:o}),o.\u0275inj=f.cJS({providers:[iI]}),o})();function _ne(o){return null==o}function vne(o){return"function"==typeof o.set}function yne(o,e){return vne(e)?e:o.ref(e)}function zW(o,e){if(function $de(o){return"string"==typeof o}(o))return e.stringCase();if(vne(o))return e.firebaseCase();if(function Zde(o){return"function"==typeof o.exportVal}(o))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof o)}function YW(o,e,i="on",d=sH.z){return new LT.y(_=>{let B=null;return B=o[i](e,(_t,_a)=>{d.schedule(()=>{_.next({snapshot:_t,prevKey:_a})}),"once"===i&&d.schedule(()=>_.complete())},_t=>{d.schedule(()=>_.error(_t))}),"on"===i?{unsubscribe(){null!=B&&o.off(e,B)}}:{unsubscribe(){}}}).pipe((0,RI.U)(_=>{const{snapshot:B,prevKey:_t}=_;let _a=null;return B.exists()&&(_a=B.key),{type:e,payload:B,prevKey:_t,key:_a}}),(0,BY.B)())}function zse(o,e){const i=o.length;for(let d=0;d<i;d++)if(o[d].payload.key===e)return d;return-1}function L$(o,e){const{payload:i,prevKey:d,key:_}=e,B=zse(o,_),_t=function Yse(o,e){if(_ne(e))return 0;{const i=zse(o,e);return-1===i?o.length:i+1}}(o,d);switch(e.type){case"value":if(e.payload&&e.payload.exists()){let _a=null;e.payload.forEach(_h=>{const _g={payload:_h,type:"value",prevKey:_a,key:_h.key};return _a=_h.key,o=[...o,_g],!1})}return o;case"child_added":if(B>-1){const _a=o[B-1];(_a&&_a.key||null)!==d&&(o=o.filter(_h=>_h.payload.key!==i.key)).splice(_t,0,e)}else{if(null==d)return[e,...o];(o=o.slice()).splice(_t,0,e)}return o;case"child_removed":return o.filter(_a=>_a.payload.key!==i.key);case"child_changed":return o.map(_a=>_a.payload.key===_?e:_a);case"child_moved":if(B>-1){const _a=o.splice(B,1)[0];return(o=o.slice()).splice(_t,0,_a),o}return o;default:return o}}function M$(o){return(_ne(o)||0===o.length)&&(o=["child_added","child_removed","child_changed","child_moved"]),o}function Jse(o,e,i){return function Kse(o,e,i){return YW(o,"value","once",i).pipe(HT(d=>{const _=[hI(d)];return e.forEach(B=>_.push(YW(o,B,"on",i))),(0,MY.T)(..._).pipe(xO(L$,[]))}),uee())}(o,e=M$(e),i)}function B$(o,e,i){const d=(e=M$(e)).map(_=>YW(o,_,"on",i));return(0,MY.T)(...d)}function _n(o,e){return function(d,_){return zW(d,{stringCase:()=>o.child(d)[e](_),firebaseCase:()=>d[e](_),snapshotCase:()=>d.ref[e](_)})}}function ca(o){return function(i){return i?zW(i,{stringCase:()=>o.child(i).remove(),firebaseCase:()=>i.remove(),snapshotCase:()=>i.ref.remove()}):o.remove()}}function _p(o,e){return function(){return YW(o,"value","on",e)}}const s_=new f.OlP("angularfire2.realtimeDatabaseURL"),A_=new f.OlP("angularfire2.database.use-emulator");let C_=(()=>{class o{constructor(i,d,_,B,_t,_a,_h,_g,l_,f_,R_,H_,W_,R0,H0){this.schedulers=_a;const CI=_h,LI=(0,lR.on)(i,_t,d);_g&&N8(LI,_t,l_,R_,H_,W_,f_,R0),this.database=(0,lR.cc)(`${LI.name}.database.${_}`,"AngularFireDatabase",LI.name,()=>{const xI=_t.runOutsideAngular(()=>LI.database(_||void 0));return CI&&xI.useEmulator(...CI),xI},[CI])}list(i,d){const _=this.schedulers.ngZone.runOutsideAngular(()=>yne(this.database,i));let B=_;return d&&(B=d(_)),function _d(o,e){const i=e.schedulers.outsideAngular,d=e.schedulers.ngZone.run(()=>o.ref);return{query:o,update:_n(d,"update"),set:_n(d,"set"),push:_=>d.push(_),remove:ca(d),snapshotChanges:_=>Jse(o,_,i).pipe(H1.iC),stateChanges:_=>B$(o,_,i).pipe(H1.iC),auditTrail:_=>function I(o,e,i){return function F(o,e,i){return function b(o,e){return YW(o,"value","on",e).pipe((0,RI.U)(i=>{let d;return i.payload.forEach(_=>(d=_.key,!1)),{data:i,lastKeyToLoad:d}}))}(o,i).pipe(function Ooe(...o){const e=(0,sM.jO)(o);return(0,rS.e)((i,d)=>{const _=o.length,B=new Array(_);let _t=o.map(()=>!1),_a=!1;for(let _h=0;_h<_;_h++)(0,NP.Xf)(o[_h]).subscribe((0,nS.x)(d,_g=>{B[_h]=_g,!_a&&!_t[_h]&&(_t[_h]=!0,(_a=_t.every(tN.y))&&(_t=null))},Roe.Z));i.subscribe((0,nS.x)(d,_h=>{if(_a){const _g=[_h,...B];d.next(e?e(..._g):_g)}}))})}(e),(0,RI.U)(([_,B])=>{const _t=_.lastKeyToLoad,_a=B.map(_h=>_h.key);return{actions:B,lastKeyToLoad:_t,loadedKeys:_a}}),function lee(o){return(0,rS.e)((e,i)=>{let d=!1,_=0;e.subscribe((0,nS.x)(i,B=>(d||(d=!o(B,_++)))&&i.next(B)))})}(_=>-1===_.loadedKeys.indexOf(_.lastKeyToLoad)),(0,RI.U)(_=>_.actions))}(o,B$(o,e).pipe(xO((_,B)=>[..._,B],[])),i)}(o,_,i).pipe(H1.iC),valueChanges:(_,B)=>Jse(o,_,i).pipe((0,RI.U)(_a=>_a.map(_h=>B&&B.idField?Object.assign(Object.assign({},_h.payload.val()),{[B.idField]:_h.key}):_h.payload.val())),H1.iC)}}(B,this)}object(i){return function t_(o,e){return{query:o,snapshotChanges:()=>_p(o,e.schedulers.outsideAngular)().pipe(H1.iC),update:i=>o.ref.update(i),set:i=>o.ref.set(i),remove:()=>o.ref.remove(),valueChanges:()=>_p(o,e.schedulers.outsideAngular)().pipe(H1.iC,(0,RI.U)(d=>d.payload.exists()?d.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>yne(this.database,i)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(lR.Dh),f.LFG(lR.xv,8),f.LFG(s_,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(H1.HU),f.LFG(A_,8),f.LFG(iI,8),f.LFG(P$,8),f.LFG(KW,8),f.LFG(fQ,8),f.LFG(p6,8),f.LFG(x$,8),f.LFG(D8,8),f.LFG(f6,8))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac,providedIn:"any"}),o})(),Q_=(()=>{class o{constructor(){hQ.Z.registerVersion("angularfire",H1.q4.full,"rtdb-compat")}}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=f.oAB({type:o}),o.\u0275inj=f.cJS({providers:[C_]}),o})(),g0=(()=>{class o{constructor(i,d){this._renderer=i,this._elementRef=d,this.onChange=_=>{},this.onTouched=()=>{}}setProperty(i,d){this._renderer.setProperty(this._elementRef.nativeElement,i,d)}registerOnTouched(i){this.onTouched=i}registerOnChange(i){this.onChange=i}setDisabledState(i){this.setProperty("disabled",i)}}return o.\u0275fac=function(i){return new(i||o)(f.Y36(f.Qsj),f.Y36(f.SBq))},o.\u0275dir=f.lG2({type:o}),o})(),P0=(()=>{class o extends g0{}return o.\u0275fac=function(){let e;return function(d){return(e||(e=f.n5z(o)))(d||o)}}(),o.\u0275dir=f.lG2({type:o,features:[f.qOj]}),o})();const Q0=new f.OlP("NgValueAccessor"),V0={provide:Q0,useExisting:(0,f.Gpc)(()=>_w),multi:!0},j1=new f.OlP("CompositionEventMode");let _w=(()=>{class o extends g0{constructor(i,d,_){super(i,d),this._compositionMode=_,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function YI(){const o=q()?q().getUserAgent():"";return/android (\d+)/.test(o.toLowerCase())}())}writeValue(i){this.setProperty("value",null==i?"":i)}_handleInput(i){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(i)}_compositionStart(){this._composing=!0}_compositionEnd(i){this._composing=!1,this._compositionMode&&this.onChange(i)}}return o.\u0275fac=function(i){return new(i||o)(f.Y36(f.Qsj),f.Y36(f.SBq),f.Y36(j1,8))},o.\u0275dir=f.lG2({type:o,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,d){1&i&&f.NdJ("input",function(B){return d._handleInput(B.target.value)})("blur",function(){return d.onTouched()})("compositionstart",function(){return d._compositionStart()})("compositionend",function(B){return d._compositionEnd(B.target.value)})},features:[f._Bn([V0]),f.qOj]}),o})();const CR=new f.OlP("NgValidators"),YP=new f.OlP("NgAsyncValidators");function Ine(o){return null!=o}function bne(o){const e=(0,f.QGY)(o)?(0,uT.D)(o):o;return(0,f.CqO)(e),e}function Zse(o){let e={};return o.forEach(i=>{e=null!=i?Object.assign(Object.assign({},e),i):e}),0===Object.keys(e).length?null:e}function ehe(o,e){return e.map(i=>i(o))}function Xse(o){return o.map(e=>function sAe(o){return!o.validate}(e)?e:i=>e.validate(i))}function eae(o){return null!=o?function Cne(o){if(!o)return null;const e=o.filter(Ine);return 0==e.length?null:function(i){return Zse(ehe(i,e))}}(Xse(o)):null}function wne(o){return null!=o?function F$(o){if(!o)return null;const e=o.filter(Ine);return 0==e.length?null:function(i){return function Qv(...o){const e=(0,sM.jO)(o),{args:i,keys:d}=tS(o),_=new LT.y(B=>{const{length:_t}=i;if(!_t)return void B.complete();const _a=new Array(_t);let _h=_t,_g=_t;for(let l_=0;l_<_t;l_++){let f_=!1;(0,NP.Xf)(i[l_]).subscribe((0,nS.x)(B,R_=>{f_||(f_=!0,_g--),_a[l_]=R_},()=>_h--,void 0,()=>{(!_h||!f_)&&(_g||B.next(d?uL(d,_a):_a),B.complete())}))}});return e?_.pipe(D3(e)):_}(ehe(i,e).map(bne)).pipe((0,RI.U)(Zse))}}(Xse(o)):null}function j$(o,e){return null===o?[e]:Array.isArray(o)?[...o,e]:[o,e]}function tae(o){return o?Array.isArray(o)?o:[o]:[]}function Sne(o,e){return Array.isArray(o)?o.includes(e):o===e}function nae(o,e){const i=tae(e);return tae(o).forEach(_=>{Sne(i,_)||i.push(_)}),i}function ZW(o,e){return tae(e).filter(i=>!Sne(o,i))}class rae{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=eae(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=wne(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,i){return!!this.control&&this.control.hasError(e,i)}getError(e,i){return this.control?this.control.getError(e,i):null}}class A6 extends rae{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class e2 extends rae{get formDirective(){return null}get path(){return null}}let oae=(()=>{class o extends class iae{constructor(e){this._cd=e}is(e){var i,d,_;return"submitted"===e?!!(null===(i=this._cd)||void 0===i?void 0:i.submitted):!!(null===(_=null===(d=this._cd)||void 0===d?void 0:d.control)||void 0===_?void 0:_[e])}}{constructor(i){super(i)}}return o.\u0275fac=function(i){return new(i||o)(f.Y36(A6,2))},o.\u0275dir=f.lG2({type:o,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,d){2&i&&f.ekj("ng-untouched",d.is("untouched"))("ng-touched",d.is("touched"))("ng-pristine",d.is("pristine"))("ng-dirty",d.is("dirty"))("ng-valid",d.is("valid"))("ng-invalid",d.is("invalid"))("ng-pending",d.is("pending"))},features:[f.qOj]}),o})();function mQ(o,e){(function lae(o,e){const i=function Tne(o){return o._rawValidators}(o);null!==e.validator?o.setValidators(j$(i,e.validator)):"function"==typeof i&&o.setValidators([i]);const d=function the(o){return o._rawAsyncValidators}(o);null!==e.asyncValidator?o.setAsyncValidators(j$(d,e.asyncValidator)):"function"==typeof d&&o.setAsyncValidators([d]);const _=()=>o.updateValueAndValidity();XW(e._rawValidators,_),XW(e._rawAsyncValidators,_)})(o,e),e.valueAccessor.writeValue(o.value),function mAe(o,e){e.valueAccessor.registerOnChange(i=>{o._pendingValue=i,o._pendingChange=!0,o._pendingDirty=!0,"change"===o.updateOn&&rhe(o,e)})}(o,e),function _Ae(o,e){const i=(d,_)=>{e.valueAccessor.writeValue(d),_&&e.viewToModelUpdate(d)};o.registerOnChange(i),e._registerOnDestroy(()=>{o._unregisterOnChange(i)})}(o,e),function AAe(o,e){e.valueAccessor.registerOnTouched(()=>{o._pendingTouched=!0,"blur"===o.updateOn&&o._pendingChange&&rhe(o,e),"submit"!==o.updateOn&&o.markAsTouched()})}(o,e),function gAe(o,e){if(e.valueAccessor.setDisabledState){const i=d=>{e.valueAccessor.setDisabledState(d)};o.registerOnDisabledChange(i),e._registerOnDestroy(()=>{o._unregisterOnDisabledChange(i)})}}(o,e)}function XW(o,e){o.forEach(i=>{i.registerOnValidatorChange&&i.registerOnValidatorChange(e)})}function rhe(o,e){o._pendingDirty&&o.markAsDirty(),o.setValue(o._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(o._pendingValue),o._pendingChange=!1}function k8(o,e){const i=o.indexOf(e);i>-1&&o.splice(i,1)}const Q$="VALID",kne="INVALID",eK="PENDING",AQ="DISABLED";function pae(o){return(q$(o)?o.validators:o)||null}function ahe(o){return Array.isArray(o)?eae(o):o||null}function H$(o,e){return(q$(e)?e.asyncValidators:o)||null}function gae(o){return Array.isArray(o)?wne(o):o||null}function q$(o){return null!=o&&!Array.isArray(o)&&"object"==typeof o}const Pne=o=>o instanceof mae;function uhe(o){return(o=>o instanceof _Q)(o)?o.value:o.getRawValue()}function lhe(o,e){const i=Pne(o),d=o.controls;if(!(i?Object.keys(d):d).length)throw new f.vHH(1e3,"");if(!d[e])throw new f.vHH(1001,"")}function dhe(o,e){Pne(o),o._forEachChild((d,_)=>{if(void 0===e[_])throw new f.vHH(1002,"")})}class W${constructor(e,i){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=i,this._composedValidatorFn=ahe(this._rawValidators),this._composedAsyncValidatorFn=gae(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Q$}get invalid(){return this.status===kne}get pending(){return this.status==eK}get disabled(){return this.status===AQ}get enabled(){return this.status!==AQ}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=ahe(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=gae(e)}addValidators(e){this.setValidators(nae(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(nae(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(ZW(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(ZW(e,this._rawAsyncValidators))}hasValidator(e){return Sne(this._rawValidators,e)}hasAsyncValidator(e){return Sne(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(i=>{i.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=eK,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const i=this._parentMarkedDirty(e.onlySelf);this.status=AQ,this.errors=null,this._forEachChild(d=>{d.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:i})),this._onDisabledChange.forEach(d=>d(!0))}enable(e={}){const i=this._parentMarkedDirty(e.onlySelf);this.status=Q$,this._forEachChild(d=>{d.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:i})),this._onDisabledChange.forEach(d=>d(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Q$||this.status===eK)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(i=>i._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?AQ:Q$}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=eK,this._hasOwnPendingAsyncValidator=!0;const i=bne(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(d=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(d,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,i={}){this.errors=e,this._updateControlsErrors(!1!==i.emitEvent)}get(e){return function IAe(o,e,i){if(null==e||(Array.isArray(e)||(e=e.split(i)),Array.isArray(e)&&0===e.length))return null;let d=o;return e.forEach(_=>{d=Pne(d)?d.controls.hasOwnProperty(_)?d.controls[_]:null:(o=>o instanceof CAe)(d)&&d.at(_)||null}),d}(this,e,".")}getError(e,i){const d=i?this.get(i):this;return d&&d.errors?d.errors[e]:null}hasError(e,i){return!!this.getError(e,i)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new f.vpe,this.statusChanges=new f.vpe}_calculateStatus(){return this._allControlsDisabled()?AQ:this.errors?kne:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(eK)?eK:this._anyControlsHaveStatus(kne)?kne:Q$}_anyControlsHaveStatus(e){return this._anyControls(i=>i.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){q$(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class _Q extends W${constructor(e=null,i,d){super(pae(i),H$(d,i)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(i),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),q$(i)&&i.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(e)?e.value:e)}setValue(e,i={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==i.emitModelToViewChange&&this._onChange.forEach(d=>d(this.value,!1!==i.emitViewToModelChange)),this.updateValueAndValidity(i)}patchValue(e,i={}){this.setValue(e,i)}reset(e=this.defaultValue,i={}){this._applyFormState(e),this.markAsPristine(i),this.markAsUntouched(i),this.setValue(this.value,i),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){k8(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){k8(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class mae extends W${constructor(e,i,d){super(pae(i),H$(d,i)),this.controls=e,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,i){return this.controls[e]?this.controls[e]:(this.controls[e]=i,i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange),i)}addControl(e,i,d={}){this.registerControl(e,i),this.updateValueAndValidity({emitEvent:d.emitEvent}),this._onCollectionChange()}removeControl(e,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}setControl(e,i,d={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],i&&this.registerControl(e,i),this.updateValueAndValidity({emitEvent:d.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,i={}){dhe(this,e),Object.keys(e).forEach(d=>{lhe(this,d),this.controls[d].setValue(e[d],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(e,i={}){null!=e&&(Object.keys(e).forEach(d=>{this.controls[d]&&this.controls[d].patchValue(e[d],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(e={},i={}){this._forEachChild((d,_)=>{d.reset(e[_],{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i),this._updateTouched(i),this.updateValueAndValidity(i)}getRawValue(){return this._reduceChildren({},(e,i,d)=>(e[d]=uhe(i),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(i,d)=>!!d._syncPendingControls()||i);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(i=>{const d=this.controls[i];d&&e(d,i)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const i of Object.keys(this.controls)){const d=this.controls[i];if(this.contains(i)&&e(d))return!0}return!1}_reduceValue(){return this._reduceChildren({},(e,i,d)=>((i.enabled||this.disabled)&&(e[d]=i.value),e))}_reduceChildren(e,i){let d=e;return this._forEachChild((_,B)=>{d=i(d,_,B)}),d}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class CAe extends W${constructor(e,i,d){super(pae(i),H$(d,i)),this.controls=e,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[e]}push(e,i={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}insert(e,i,d={}){this.controls.splice(e,0,i),this._registerControl(i),this.updateValueAndValidity({emitEvent:d.emitEvent})}removeAt(e,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:i.emitEvent})}setControl(e,i,d={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),i&&(this.controls.splice(e,0,i),this._registerControl(i)),this.updateValueAndValidity({emitEvent:d.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,i={}){dhe(this,e),e.forEach((d,_)=>{lhe(this,_),this.at(_).setValue(d,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(e,i={}){null!=e&&(e.forEach((d,_)=>{this.at(_)&&this.at(_).patchValue(d,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(e=[],i={}){this._forEachChild((d,_)=>{d.reset(e[_],{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i),this._updateTouched(i),this.updateValueAndValidity(i)}getRawValue(){return this.controls.map(e=>uhe(e))}clear(e={}){this.controls.length<1||(this._forEachChild(i=>i._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_syncPendingControls(){let e=this.controls.reduce((i,d)=>!!d._syncPendingControls()||i,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((i,d)=>{e(i,d)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(i=>i.enabled&&e(i))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}const OAe={provide:A6,useExisting:(0,f.Gpc)(()=>vae)},fhe=(()=>Promise.resolve(null))();let vae=(()=>{class o extends A6{constructor(i,d,_,B,_t){super(),this._changeDetectorRef=_t,this.control=new _Q,this._registered=!1,this.update=new f.vpe,this._parent=i,this._setValidators(d),this._setAsyncValidators(_),this.valueAccessor=function hae(o,e){if(!e)return null;let i,d,_;return Array.isArray(e),e.forEach(B=>{B.constructor===_w?i=B:function EAe(o){return Object.getPrototypeOf(o.constructor)===P0}(B)?d=B:_=B}),_||d||i||null}(0,B)}ngOnChanges(i){if(this._checkForErrors(),!this._registered||"name"in i){if(this._registered&&(this._checkName(),this.formDirective)){const d=i.name.previousValue;this.formDirective.removeControl({name:d,path:this._getPath(d)})}this._setUpControl()}"isDisabled"in i&&this._updateDisabled(i),function dae(o,e){if(!o.hasOwnProperty("model"))return!1;const i=o.model;return!!i.isFirstChange()||!Object.is(e,i.currentValue)}(i,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){mQ(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(i){fhe.then(()=>{var d;this.control.setValue(i,{emitViewToModelChange:!1}),null===(d=this._changeDetectorRef)||void 0===d||d.markForCheck()})}_updateDisabled(i){const d=i.isDisabled.currentValue,_=""===d||d&&"false"!==d;fhe.then(()=>{var B;_&&!this.control.disabled?this.control.disable():!_&&this.control.disabled&&this.control.enable(),null===(B=this._changeDetectorRef)||void 0===B||B.markForCheck()})}_getPath(i){return this._parent?function One(o,e){return[...e.path,o]}(i,this._parent):[i]}}return o.\u0275fac=function(i){return new(i||o)(f.Y36(e2,9),f.Y36(CR,10),f.Y36(YP,10),f.Y36(Q0,10),f.Y36(f.sBO,8))},o.\u0275dir=f.lG2({type:o,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[f._Bn([OAe]),f.qOj,f.TTD]}),o})(),Ahe=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=f.oAB({type:o}),o.\u0275inj=f.cJS({}),o})(),jAe=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=f.oAB({type:o}),o.\u0275inj=f.cJS({imports:[[Ahe]]}),o})(),$$=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=f.oAB({type:o}),o.\u0275inj=f.cJS({imports:[jAe]}),o})();const Lhe=function(o,e){return["/audio",o,e]},QAe=function(o,e){return["/video",o,e]};function Mhe(o,e){if(1&o&&(f.TgZ(0,"div",12)(1,"blockquote",13)(2,"div",14),f._UZ(3,"i",15),f.TgZ(4,"p",16),f._uU(5),f.qZA(),f._UZ(6,"div",8),f.TgZ(7,"div",17)(8,"i",18),f.O4$(),f.TgZ(9,"svg",19),f._UZ(10,"path",20),f.qZA()(),f.kcU(),f.TgZ(11,"i",21),f.O4$(),f.TgZ(12,"svg",22),f._UZ(13,"path",23),f.qZA()()()()()()),2&o){const i=e.$implicit;f.xp6(5),f.Oqu(i.TenantName),f.xp6(3),f.Q6J("routerLink",f.WLB(3,Lhe,i.TenantPin,i.TenantName)),f.xp6(3),f.Q6J("routerLink",f.WLB(6,QAe,i.TenantPin,i.TenantName))}}let Oae=(()=>{class o{constructor(i,d,_){this.db=i,this.route=d,this.activatedRoute=_,this.userCopy=[],this.userName=""}ngOnInit(){this.id=this.activatedRoute.snapshot.paramMap.get("id"),this.stamp=this.activatedRoute.snapshot.paramMap.get("stmp"),this.id&&localStorage.setItem("id",this.id),console.log(this.id),console.log(this.stamp),this.db.list("TenantList").snapshotChanges().subscribe(i=>{this.getUsers=[],i.forEach(d=>{let _=d.payload.toJSON();_.id=d.key,this.getUsers.push(_),this.userCopy.push(_)}),this.filterByID()})}filterByID(){if(localStorage.getItem("id")){const i=localStorage.getItem("id");console.log(i,"local");const d=this.getUsers.find(_=>_.id===localStorage.getItem("id"));if((null==d?void 0:d.id)&&(null==d?void 0:d.ListFBTenantIdModel)){"object"==typeof d.ListFBTenantIdModel&&(d.ListFBTenantIdModel=Object.values(d.ListFBTenantIdModel)),this.userCopy=d.ListFBTenantIdModel;const _=this.userCopy;_.sort((B,_t)=>null==B?void 0:B.TenantName.localeCompare(null==_t?void 0:_t.TenantName)),console.log(_),this.getUsers=this.userCopy}}}searchUser(){this.userCopy=this.searchText?this.getUsers.filter(i=>-1!==i.TenantName.toLowerCase().indexOf(this.searchText.toLowerCase())):this.getUsers}}return o.\u0275fac=function(i){return new(i||o)(f.Y36(C_),f.Y36(qT),f.Y36(iN))},o.\u0275cmp=f.Xpm({type:o,selectors:[["app-sdk"]],decls:18,vars:2,consts:[["lang","en"],["charset","UTF-8"],["http-equiv","X-UA-Compatible","content","IE=edge"],["name","viewport","content","width=device-width, initial-scale=1.0"],[1,"navbar","navbar-default",2,"background-color","#00679A"],[1,"text",2,"font-style","normal"],[1,"search-hero",2,"padding-bottom","20px","padding-right","15px","padding-left","15px"],["type","text","name","search","autocomplete","off","placeholder","\uf002  Resident's name",1,"form-control",2,"font-family","Arial, FontAwesome","font-style","normal","color","#73767D","letter-spacing","0.125px","background-color","#FAFAFAED",3,"ngModel","keyup","ngModelChange"],[1,"container-fluid"],[2,"font-size","unset","padding-left","10px","font-style","normal"],[1,"card"],["class","card-body","style","background: #F0F3F6;box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.1);border-radius: 4px;",4,"ngFor","ngForOf"],[1,"card-body",2,"background","#F0F3F6","box-shadow","0px 2px 2px rgba(0, 0, 0, 0.1)","border-radius","4px"],[1,"conatiner-fluid",2,"background-color","#F0F3F6","display","-webkit-box","border","none","border-radius","5px"],[1,"row",2,"display","contents"],[1,"fa-regular","fa-user",2,"font-size","2.4rem","color","#049755","padding-top","10px"],[2,"padding-left","1rem","padding-top","1rem"],[1,"call-content",2,"padding-top","5px"],[2,"font-size","2.6rem","color","#183153","padding-right","20px",3,"routerLink"],["width","18","height","18","viewBox","0 0 18 18","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M3.54 2C3.6 2.89 3.75 3.76 3.99 4.59L2.79 5.79C2.38 4.59 2.12 3.32 2.03 2H3.54ZM13.4 14.02C14.25 14.26 15.12 14.41 16 14.47V15.96C14.68 15.87 13.41 15.61 12.2 15.21L13.4 14.02ZM4.5 0H1C0.45 0 0 0.45 0 1C0 10.39 7.61 18 17 18C17.55 18 18 17.55 18 17V13.51C18 12.96 17.55 12.51 17 12.51C15.76 12.51 14.55 12.31 13.43 11.94C13.33 11.9 13.22 11.89 13.12 11.89C12.86 11.89 12.61 11.99 12.41 12.18L10.21 14.38C7.38 12.93 5.06 10.62 3.62 7.79L5.82 5.59C6.1 5.31 6.18 4.92 6.07 4.57C5.7 3.45 5.5 2.25 5.5 1C5.5 0.45 5.05 0 4.5 0Z","fill","#049755"],[2,"font-size","2.6rem","color","#183153","padding-right","15px",3,"routerLink"],["width","18","height","18","viewBox","0 0 18 12","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M14 4.5V1C14 0.45 13.55 0 13 0H1C0.45 0 0 0.45 0 1V11C0 11.55 0.45 12 1 12H13C13.55 12 14 11.55 14 11V7.5L18 11.5V0.5L14 4.5ZM12 10H2V2H12V10ZM6 9H8V7H10V5H8V3H6V5H4V7H6V9Z","fill","#049755"]],template:function(i,d){1&i&&(f.TgZ(0,"html",0)(1,"head"),f._UZ(2,"meta",1)(3,"meta",2)(4,"meta",3),f.TgZ(5,"title"),f._uU(6,"Document"),f.qZA()(),f.TgZ(7,"body")(8,"div",4)(9,"div",5),f._uU(10,"Welcome guest!"),f.qZA(),f.TgZ(11,"div",6)(12,"input",7),f.NdJ("keyup",function(){return d.searchUser()})("ngModelChange",function(B){return d.searchText=B}),f.qZA()()(),f.TgZ(13,"div",8)(14,"p",9),f._uU(15,"Voice/video call a resident to request access "),f.qZA(),f.TgZ(16,"div",10),f.YNc(17,Mhe,14,9,"div",11),f.qZA()()()()),2&i&&(f.xp6(12),f.Q6J("ngModel",d.searchText),f.xp6(5),f.Q6J("ngForOf",d.userCopy))},directives:[_w,oae,vae,HS,z3],styles:[".avatar[_ngcontent-%COMP%]{vertical-align:middle;width:35px;height:35px;border-radius:50%}.text[_ngcontent-%COMP%]{font-weight:500;font-size:large;padding:20px;color:#f5f5f5}.search[_ngcontent-%COMP%]{overflow:auto;padding-bottom:15px;border:none}.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}.search[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:focus{outline:0}@media only screen and (min-width: 150px) and (max-width: 1080px){.search[_ngcontent-%COMP%]{margin:0 auto;width:100%}}.form-control[_ngcontent-%COMP%]{padding-left:2.375rem;border-radius:10px}.conatiner-fluid[_ngcontent-%COMP%]{display:flex}"]}),o})();function Bhe(o,e){1&o&&(f.TgZ(0,"div",12),f._uU(1," Calling... "),f.qZA())}const Fhe=[{path:"",redirectTo:"user",pathMatch:"full"},{path:"user",component:Oae},{path:"user/:id/:stmp",component:Oae},{path:"video/:id/:username",component:(()=>{class o{constructor(i,d,_,B,_t){var _a=this;this.stream=i,this.api=d,this.message=_,this.router=B,this.route=_t,this.userName="",this.hideBtns=!0,this.callingStatus=!1,this.stream.updateUserInfo.subscribe(function(){var _h=(0,C0.Z)(function*(_g){if(_g){const l_=yield _a.message.rtmclient.getUserAttributes(_g.toString());for(let f_=0;f_<_a.stream.remoteUsers.length;f_++){const R_=_a.stream.remoteUsers[f_];R_.uid==_g&&(R_.name=l_.name)}}});return function(_g){return _h.apply(this,arguments)}}())}ngOnInit(){var i=this;this.remoteId=this.route.snapshot.paramMap.get("id"),this.userName=this.route.snapshot.paramMap.get("username"),console.log("routeid",this.remoteId),this.startCall(),this.route.params.subscribe(d=>{console.log("value ",d)}),this.message.getStatus.subscribe(function(){var d=(0,C0.Z)(function*(_){i.callingStatus=_});return function(_){return d.apply(this,arguments)}}()),this.stream.getMediaStatus.subscribe(function(){var d=(0,C0.Z)(function*(_){i.callingStatus=_});return function(_){return d.apply(this,arguments)}}())}startCall(){var i=this;return(0,C0.Z)(function*(){i.myId=1234,yield i.generateTokenAndUid(i.myId),yield i.rtmUserLogin(i.myId),i.hideBtns=!1,i.callPeer()})()}generateTokenAndUid(i){var d=this;return(0,C0.Z)(function*(){const B={params:new VP({fromString:"channel=test&uid="+i})},_t=yield d.api.getRequest("https://test-agora.herokuapp.com/access_token?",B.params).toPromise();return{uid:i,token:_t.token}})()}generateRtmTokenAndUid(i){var d=this;return(0,C0.Z)(function*(){const B={params:new VP({fromString:"account="+i})},_t=yield d.api.getRequest("https://sharp-pouncing-grass.glitch.me/rtmToken?",B.params).toPromise();return{uid:i,token:_t.key}})()}generateUid(){return Math.floor(Math.pow(10,3)+9*Math.random()*Math.pow(10,3))}rtmUserLogin(i){var d=this;return(0,C0.Z)(function*(){d.message.rtmclient=d.message.createRTMClient(),yield d.message.signalLogin(i.toString()),d.message.RTMevents(d.message.rtmclient)})()}callPeer(){const i=this.remoteId;this.message.inquire([i]).then(d=>{d[i]&&(console.log("peer",i,"is online"),this.roomCode=this.message.getRoomCode(this.myId,i),console.log("room",this.roomCode+"Video"),this.message.localInvitation(i,this.roomCode+"Video[Front Door]DoorID943"))}).catch(()=>{console.log("The query failed")})}leaveCall(){this.stream.leaveCall()}}return o.\u0275fac=function(i){return new(i||o)(f.Y36(iH),f.Y36(aee),f.Y36(oH),f.Y36(qT),f.Y36(iN))},o.\u0275cmp=f.Xpm({type:o,selectors:[["app-video"]],decls:25,vars:2,consts:[["lang","en"],["charset","UTF-8"],["http-equiv","X-UA-Compatible","content","IE=edge"],["name","viewport","content","width=device-width, initial-scale=1.0"],[2,"margin-left","24px","margin-top","20px"],["style","text-align: center;",4,"ngIf"],[1,"container-fluid",2,"padding-left","0px"],[2,"text-align","left","font-weight","bolder","padding-bottom","15px"],["id","local-player",1,"player",2,"height","250px","width","250px","border","1px solid","box-shadow","0 5px 10px 0 #B0C1D9"],[2,"padding-top","30px","padding-bottom","20px","font-weight","bolder"],["id","remote-player",1,"player",2,"height","250px","width","250px","border","1px solid","box-shadow","0 5px 10px 0 #B0C1D9"],[2,"margin-left","28%","padding-top","20px","margin-right","28%"],[2,"text-align","center"],["type","button",3,"click"],["width","50","height","50","viewBox","0 0 40 40","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M20 40C31.0457 40 40 31.0457 40 20C40 8.9543 31.0457 0 20 0C8.9543 0 0 8.9543 0 20C0 31.0457 8.9543 40 20 40Z","fill","#D45238"],["d","M26.59 18.52C27.64 19.03 28.63 19.67 29.55 20.43L28.48 21.5C27.9 21.03 27.27 20.61 26.6 20.23V18.52M13.4 18.52V20.22C12.75 20.59 12.12 21.01 11.53 21.49L10.46 20.42C11.37 19.67 12.36 19.04 13.4 18.52ZM20 15C15.46 15 11.34 16.78 8.29 19.67C8.11 19.85 8 20.1 8 20.38C8 20.66 8.11 20.91 8.29 21.08L10.77 23.56C10.95 23.74 11.2 23.85 11.48 23.85C11.75 23.85 12 23.75 12.18 23.57C12.97 22.84 13.86 22.21 14.84 21.72C15.17 21.56 15.4 21.21 15.4 20.82V17.72C16.85 17.25 18.4 17 20 17C21.6 17 23.15 17.25 24.59 17.73V20.83C24.59 21.23 24.82 21.57 25.15 21.73C26.13 22.22 27.03 22.84 27.82 23.58C28 23.75 28.25 23.86 28.52 23.86C28.8 23.86 29.05 23.75 29.23 23.57L31.71 21.09C31.89 20.91 32 20.66 32 20.38C32 20.1 31.89 19.85 31.71 19.67C28.66 16.78 24.54 15 20 15Z","fill","white"],[2,"text-align","center","color","#73767D","padding-top","16px"]],template:function(i,d){1&i&&(f.TgZ(0,"html",0)(1,"head"),f._UZ(2,"meta",1)(3,"meta",2)(4,"meta",3),f.TgZ(5,"title"),f._uU(6,"POC Video"),f.qZA()(),f.TgZ(7,"body")(8,"div",4),f.YNc(9,Bhe,2,0,"div",5),f.TgZ(10,"div",6)(11,"h3",7),f._uU(12,"Visitor"),f.qZA(),f._UZ(13,"div",8),f.TgZ(14,"h3",9),f._uU(15),f.qZA(),f._UZ(16,"div",10),f.qZA()(),f.TgZ(17,"div",11)(18,"div",12)(19,"i",13),f.NdJ("click",function(){return d.leaveCall()}),f.O4$(),f.TgZ(20,"svg",14),f._UZ(21,"path",15)(22,"path",16),f.qZA()()(),f.kcU(),f.TgZ(23,"div",17),f._uU(24,"Tap to disconnect"),f.qZA()()()()),2&i&&(f.xp6(9),f.Q6J("ngIf",!d.callingStatus),f.xp6(6),f.Oqu(d.userName))},directives:[QT],styles:[""]}),o})()},{path:"audio/:id/:username",component:cee}];let jhe=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=f.oAB({type:o}),o.\u0275inj=f.cJS({imports:[[YG.forRoot(Fhe)],YG]}),o})(),Vhe=(()=>{class o{constructor(i,d,_){this.datePipe=i,this.http=d,this.route=_,this.endPoint={url:"https://demo.kantech.com:8801/smartservice/Login",path_variables:"username=#username&password=#password&encrypted=#encrypted&SourceID=#SourceID&DateFormat=#DateFormat&TimeFormat=#TimeFormat&LocalDateTime=#LocalDateTime&ConnectedProgram=#ConnectedProgram"},this.loginDetail={username:"entrapassdemo",password:"entrapassdemo",SourceID:"MOBILEAPP",encrypted:1,LocalDateTime:"",ConnectedProgram:"",DateFormat:"yyyy-MM-dd",TimeFormat:"HH:mm:ss"}}ngOnInit(){const i=window.location.href;console.log(i)}}return o.\u0275fac=function(i){return new(i||o)(f.Y36(XM),f.Y36(r1),f.Y36(qT))},o.\u0275cmp=f.Xpm({type:o,selectors:[["app-root"]],decls:1,vars:0,template:function(i,d){1&i&&f._UZ(0,"router-outlet")},directives:[A5],styles:[""]}),o})();const Dae_firebaseConfig={apiKey:"AIzaSyBoIJc-e2mqec731UkkLJ7H3-t_kCzU_FA",authDomain:"videodemo-6010f.firebaseapp.com",databaseURL:"https://videodemo-6010f-default-rtdb.firebaseio.com",projectId:"videodemo-6010f",storageBucket:"videodemo-6010f.appspot.com",messagingSenderId:"430546386749",appId:"1:430546386749:web:68ff0a4bd21ae8514d8f54"},Nae="firebasestorage.googleapis.com",kae="storageBucket";class $S extends M_.ZR{constructor(e,i){super(jne(e),`Firebase Storage: ${i} (${jne(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,$S.prototype)}_codeEquals(e){return jne(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}function jne(o){return"storage/"+o}function Vne(){return new $S("unknown","An unknown error occurred, please check the error payload for server response.")}function Yhe(){return new $S("canceled","User canceled the upload/download.")}function $he(){return new $S("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function tK(o){return new $S("invalid-argument",o)}function Zhe(){return new $S("app-deleted","The Firebase app was deleted.")}function xae(o){return new $S("invalid-root-operation","The operation '"+o+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Z$(o,e){return new $S("invalid-format","String does not match format '"+o+"': "+e)}function X$(o){throw new $S("internal-error","Internal error: "+o)}class n2{constructor(e,i){this.bucket=e,this.path_=i}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,i){let d;try{d=n2.makeFromUrl(e,i)}catch(_){return new n2(e,"")}if(""===d.path)return d;throw function Gne(o){return new $S("invalid-default-bucket","Invalid default bucket '"+o+"'.")}(e)}static makeFromUrl(e,i){let d=null;const _="([A-Za-z0-9.\\-_]+)",_a=new RegExp("^gs://"+_+"(/(.*))?$","i");function _g(DI){DI.path_=decodeURIComponent(DI.path)}const f_=i.replace(/[.]/g,"\\."),xI=[{regex:_a,indices:{bucket:1,path:3},postModify:function B(DI){"/"===DI.path.charAt(DI.path.length-1)&&(DI.path_=DI.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${f_}/v[A-Za-z0-9_]+/b/${_}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:_g},{regex:new RegExp(`^https?://${i===Nae?"(?:storage.googleapis.com|storage.cloud.google.com)":i}/${_}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:_g}];for(let DI=0;DI<xI.length;DI++){const _C=xI[DI],G1=_C.regex.exec(e);if(G1){let p2=G1[_C.indices.path];p2||(p2=""),d=new n2(G1[_C.indices.bucket],p2),_C.postModify(d);break}}if(null==d)throw function Jhe(o){return new $S("invalid-url","Invalid URL '"+o+"'.")}(e);return d}}class $Ae{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function EQ(o){return"string"==typeof o||o instanceof String}function nK(o){return IQ()&&o instanceof Blob}function IQ(){return"undefined"!=typeof Blob}function eZ(o,e,i,d){if(d<e)throw tK(`Invalid value for '${o}'. Expected ${e} or greater.`);if(d>i)throw tK(`Invalid value for '${o}'. Expected ${i} or less.`)}function qU(o,e,i){let d=e;return null==i&&(d=`https://${e}`),`${i}://${d}/v0${o}`}function tZ(o){const e=encodeURIComponent;let i="?";for(const d in o)o.hasOwnProperty(d)&&(i=i+(e(d)+"=")+e(o[d])+"&");return i=i.slice(0,-1),i}var x8=(()=>{return(o=x8||(x8={}))[o.NO_ERROR=0]="NO_ERROR",o[o.NETWORK_ERROR=1]="NETWORK_ERROR",o[o.ABORT=2]="ABORT",x8;var o})();class wR{constructor(e,i,d,_,B,_t,_a,_h,_g,l_,f_){this.url_=e,this.method_=i,this.headers_=d,this.body_=_,this.successCodes_=B,this.additionalRetryCodes_=_t,this.callback_=_a,this.errorCallback_=_h,this.timeout_=_g,this.progressCallback_=l_,this.connectionFactory_=f_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((R_,H_)=>{this.resolve_=R_,this.reject_=H_,this.start_()})}start_(){const i=(d,_)=>{const B=this.resolve_,_t=this.reject_,_a=_.connection;if(_.wasSuccessCode)try{const _h=this.callback_(_a,_a.getResponse());!function ZAe(o){return void 0!==o}(_h)?B():B(_h)}catch(_h){_t(_h)}else if(null!==_a){const _h=Vne();_h.serverResponse=_a.getErrorText(),_t(this.errorCallback_?this.errorCallback_(_a,_h):_h)}else _t(_.canceled?this.appDelete_?Zhe():Yhe():function zAe(){return new $S("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}())};this.canceled_?i(0,new C1(!1,null,!0)):this.backoffId_=function Lae(o,e,i){let d=1,_=null,B=null,_t=!1,_a=0;function _h(){return 2===_a}let _g=!1;function l_(...H0){_g||(_g=!0,e.apply(null,H0))}function f_(H0){_=setTimeout(()=>{_=null,o(H_,_h())},H0)}function R_(){B&&clearTimeout(B)}function H_(H0,...CI){if(_g)return void R_();if(H0)return R_(),void l_.call(null,H0,...CI);if(_h()||_t)return R_(),void l_.call(null,H0,...CI);let xI;d<64&&(d*=2),1===_a?(_a=2,xI=0):xI=1e3*(d+Math.random()),f_(xI)}let W_=!1;function R0(H0){W_||(W_=!0,R_(),!_g&&(null!==_?(H0||(_a=2),clearTimeout(_),f_(0)):H0||(_a=1)))}return f_(0),B=setTimeout(()=>{_t=!0,R0(!0)},i),R0}((d,_)=>{if(_)return void d(!1,new C1(!1,null,!0));const B=this.connectionFactory_();this.pendingConnection_=B;const _t=_a=>{null!==this.progressCallback_&&this.progressCallback_(_a.loaded,_a.lengthComputable?_a.total:-1)};null!==this.progressCallback_&&B.addUploadProgressListener(_t),B.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&B.removeUploadProgressListener(_t),this.pendingConnection_=null;const _a=B.getErrorCode()===x8.NO_ERROR,_h=B.getStatus();if(!_a||this.isRetryStatusCode_(_h)){const l_=B.getErrorCode()===x8.ABORT;return void d(!1,new C1(!1,null,l_))}const _g=-1!==this.successCodes_.indexOf(_h);d(!0,new C1(_g,B))})},i,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function yQ(o){o(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const i=e>=500&&e<600,_=-1!==[408,429].indexOf(e),B=-1!==this.additionalRetryCodes_.indexOf(e);return i||_||B}}class C1{constructor(e,i,d){this.wasSuccessCode=e,this.connection=i,this.canceled=!!d}}function t_e(...o){const e=function e_e(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}();if(void 0!==e){const i=new e;for(let d=0;d<o.length;d++)i.append(o[d]);return i.getBlob()}if(IQ())return new Blob(o);throw new $S("unsupported-environment","This browser doesn't seem to support creating Blobs")}const PL={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Uae{constructor(e,i){this.data=e,this.contentType=i||null}}function nZ(o,e){switch(o){case PL.RAW:return new Uae(Z2(e));case PL.BASE64:case PL.BASE64URL:return new Uae(r2(o,e));case PL.DATA_URL:return new Uae(function rK(o){const e=new Fae(o);return e.base64?r2(PL.BASE64,e.rest):function X2(o){let e;try{e=decodeURIComponent(o)}catch(i){throw Z$(PL.DATA_URL,"Malformed data URL.")}return Z2(e)}(e.rest)}(e),function tfe(o){return new Fae(o).contentType}(e))}throw Vne()}function Z2(o){const e=[];for(let i=0;i<o.length;i++){let d=o.charCodeAt(i);d<=127?e.push(d):d<=2047?e.push(192|d>>6,128|63&d):55296==(64512&d)?i<o.length-1&&56320==(64512&o.charCodeAt(i+1))?(d=65536|(1023&d)<<10|1023&o.charCodeAt(++i),e.push(240|d>>18,128|d>>12&63,128|d>>6&63,128|63&d)):e.push(239,191,189):56320==(64512&d)?e.push(239,191,189):e.push(224|d>>12,128|d>>6&63,128|63&d)}return new Uint8Array(e)}function r2(o,e){switch(o){case PL.BASE64:{const _=-1!==e.indexOf("-"),B=-1!==e.indexOf("_");if(_||B)throw Z$(o,"Invalid character '"+(_?"-":"_")+"' found: is it base64url encoded?");break}case PL.BASE64URL:{const _=-1!==e.indexOf("+"),B=-1!==e.indexOf("/");if(_||B)throw Z$(o,"Invalid character '"+(_?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let i;try{i=function Hne(o){return atob(o)}(e)}catch(_){throw Z$(o,"Invalid character found")}const d=new Uint8Array(i.length);for(let _=0;_<i.length;_++)d[_]=i.charCodeAt(_);return d}class Fae{constructor(e){this.base64=!1,this.contentType=null;const i=e.match(/^data:([^,]+)?,/);if(null===i)throw Z$(PL.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const d=i[1]||null;null!=d&&(this.base64=function nfe(o,e){return o.length>=e.length&&o.substring(o.length-e.length)===e}(d,";base64"),this.contentType=this.base64?d.substring(0,d.length-7):d),this.rest=e.substring(e.indexOf(",")+1)}}class kM{constructor(e,i){let d=0,_="";nK(e)?(this.data_=e,d=e.size,_=e.type):e instanceof ArrayBuffer?(i?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),d=this.data_.length):e instanceof Uint8Array&&(i?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),d=e.length),this.size_=d,this.type_=_}size(){return this.size_}type(){return this.type_}slice(e,i){if(nK(this.data_)){const _=function efe(o,e,i){return o.webkitSlice?o.webkitSlice(e,i):o.mozSlice?o.mozSlice(e,i):o.slice?o.slice(e,i):null}(this.data_,e,i);return null===_?null:new kM(_)}{const d=new Uint8Array(this.data_.buffer,e,i-e);return new kM(d,!0)}}static getBlob(...e){if(IQ()){const i=e.map(d=>d instanceof kM?d.data_:d);return new kM(t_e.apply(null,i))}{const i=e.map(_t=>EQ(_t)?nZ(PL.RAW,_t).data:_t.data_);let d=0;i.forEach(_t=>{d+=_t.byteLength});const _=new Uint8Array(d);let B=0;return i.forEach(_t=>{for(let _a=0;_a<_t.length;_a++)_[B++]=_t[_a]}),new kM(_,!0)}}uploadData(){return this.data_}}function WU(o){let e;try{e=JSON.parse(o)}catch(i){return null}return function Qne(o){return"object"==typeof o&&!Array.isArray(o)}(e)?e:null}function bQ(o){const e=o.lastIndexOf("/",o.length-2);return-1===e?o:o.slice(e+1)}function ofe(o,e){return e}class i2{constructor(e,i,d,_){this.server=e,this.local=i||e,this.writable=!!d,this.xform=_||ofe}}let qne=null;function iK(){if(qne)return qne;const o=[];o.push(new i2("bucket")),o.push(new i2("generation")),o.push(new i2("metageneration")),o.push(new i2("name","fullPath",!0));const i=new i2("name");i.xform=function e(B,_t){return function n_e(o){return!EQ(o)||o.length<2?o:bQ(o)}(_t)},o.push(i);const _=new i2("size");return _.xform=function d(B,_t){return void 0!==_t?Number(_t):_t},o.push(_),o.push(new i2("timeCreated")),o.push(new i2("updated")),o.push(new i2("md5Hash",null,!0)),o.push(new i2("cacheControl",null,!0)),o.push(new i2("contentDisposition",null,!0)),o.push(new i2("contentEncoding",null,!0)),o.push(new i2("contentLanguage",null,!0)),o.push(new i2("contentType",null,!0)),o.push(new i2("metadata","customMetadata",!0)),qne=o,qne}function jae(o,e,i){const d=WU(e);return null===d?null:function r_e(o,e,i){const d={type:"file"},_=i.length;for(let B=0;B<_;B++){const _t=i[B];d[_t.local]=_t.xform(d,e[_t.server])}return function sfe(o,e){Object.defineProperty(o,"ref",{get:function i(){const B=new n2(o.bucket,o.fullPath);return e._makeStorageReference(B)}})}(d,o),d}(o,d,i)}function rZ(o,e){const i={},d=e.length;for(let _=0;_<d;_++){const B=e[_];B.writable&&(i[B.server]=o[B.local])}return JSON.stringify(i)}class KU{constructor(e,i,d,_){this.url=e,this.method=i,this.handler=d,this.timeout=_,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function zU(o){if(!o)throw Vne()}function iZ(o,e){return function i(d,_){const B=jae(o,_,e);return zU(null!==B),B}}function YU(o){return function e(i,d){let _;return _=401===i.getStatus()?i.getErrorText().includes("Firebase App Check token is invalid")?function zhe(){return new $S("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}():function Khe(){return new $S("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===i.getStatus()?function Whe(o){return new $S("quota-exceeded","Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(o.bucket):403===i.getStatus()?function KAe(o){return new $S("unauthorized","User does not have permission to access '"+o+"'.")}(o.path):d,_.serverResponse=d.serverResponse,_}}function sK(o){const e=YU(o);return function i(d,_){let B=e(d,_);return 404===d.getStatus()&&(B=function qhe(o){return new $S("object-not-found","Object '"+o+"' does not exist.")}(o.path)),B.serverResponse=_.serverResponse,B}}function Gae(o,e,i){const _=qU(e.fullServerUrl(),o.host,o._protocol),_t=o.maxOperationRetryTime,_a=new KU(_,"GET",iZ(o,i),_t);return _a.errorHandler=sK(e),_a}function o_e(o,e,i,d,_){const B={};B.prefix=e.isRoot?"":e.path+"/",i&&i.length>0&&(B.delimiter=i),d&&(B.pageToken=d),_&&(B.maxResults=_);const _a=qU(e.bucketOnlyServerUrl(),o.host,o._protocol),_g=o.maxOperationRetryTime,l_=new KU(_a,"GET",function Wne(o,e){return function i(d,_){const B=function oK(o,e,i){const d=WU(i);return null===d?null:function i_e(o,e,i){const d={prefixes:[],items:[],nextPageToken:i.nextPageToken};if(i.prefixes)for(const _ of i.prefixes){const B=_.replace(/\/$/,""),_t=o._makeStorageReference(new n2(e,B));d.prefixes.push(_t)}if(i.items)for(const _ of i.items){const B=o._makeStorageReference(new n2(e,_.name));d.items.push(B)}return d}(o,e,d)}(o,e,_);return zU(null!==B),B}}(o,e.bucket),_g);return l_.urlParams=B,l_.errorHandler=YU(e),l_}function ufe(o,e,i){const d=Object.assign({},i);return d.fullPath=o.path,d.size=e.size(),d.contentType||(d.contentType=function c_e(o,e){return o&&o.contentType||e&&e.type()||"application/octet-stream"}(null,e)),d}class Kne{constructor(e,i,d,_){this.current=e,this.total=i,this.finalized=!!d,this.metadata=_||null}}function sZ(o,e){let i=null;try{i=o.getResponseHeader("X-Goog-Upload-Status")}catch(_){zU(!1)}return zU(!!i&&-1!==(e||["active"]).indexOf(i)),i}const l_e={STATE_CHANGED:"state_changed"},AN={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Hae(o){switch(o){case"running":case"pausing":case"canceling":return AN.RUNNING;case"paused":return AN.PAUSED;case"success":return AN.SUCCESS;case"canceled":return AN.CANCELED;default:return AN.ERROR}}class d_e{constructor(e,i,d){if(function Xhe(o){return"function"==typeof o}(e)||null!=i||null!=d)this.next=e,this.error=null!=i?i:void 0,this.complete=null!=d?d:void 0;else{const B=e;this.next=B.next,this.error=B.error,this.complete=B.complete}}}function aK(o){return(...e)=>{Promise.resolve().then(()=>o(...e))}}class h_e extends class qae{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=x8.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=x8.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=x8.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,i,d,_){if(this.sent_)throw X$("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(i,e,!0),void 0!==_)for(const B in _)_.hasOwnProperty(B)&&this.xhr_.setRequestHeader(B,_[B].toString());return void 0!==d?this.xhr_.send(d):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw X$("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw X$("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw X$("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw X$("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}{initXhr(){this.xhr_.responseType="text"}}function BS(){return new h_e}class aZ{constructor(e,i,d=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=i,this._metadata=d,this._mappings=iK(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=_=>{this._request=void 0,this._chunkMultiplier=1,_._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=_,this._transition("error"))},this._metadataErrorHandler=_=>{this._request=void 0,_._codeEquals("canceled")?this.completeTransitions_():(this._error=_,this._transition("error"))},this._promise=new Promise((_,B)=>{this._resolve=_,this._reject=B,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return i=>this._updateProgress(e+i)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([i,d])=>{switch(this._state){case"running":e(i,d);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,i)=>{const d=function u_e(o,e,i,d,_){const B=e.bucketOnlyServerUrl(),_t=ufe(e,d,_),_a={name:_t.fullPath},_h=qU(B,o.host,o._protocol),l_={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${d.size()}`,"X-Goog-Upload-Header-Content-Type":_t.contentType,"Content-Type":"application/json; charset=utf-8"},f_=rZ(_t,i),W_=new KU(_h,"POST",function H_(R0){let H0;sZ(R0);try{H0=R0.getResponseHeader("X-Goog-Upload-URL")}catch(CI){zU(!1)}return zU(EQ(H0)),H0},o.maxUploadRetryTime);return W_.urlParams=_a,W_.headers=l_,W_.body=f_,W_.errorHandler=YU(e),W_}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),_=this._ref.storage._makeRequest(d,BS,e,i);this._request=_,_.getPromise().then(B=>{this._request=void 0,this._uploadUrl=B,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((i,d)=>{const _=function lfe(o,e,i,d){const _h=new KU(i,"POST",function B(_g){const l_=sZ(_g,["active","final"]);let f_=null;try{f_=_g.getResponseHeader("X-Goog-Upload-Size-Received")}catch(H_){zU(!1)}f_||zU(!1);const R_=Number(f_);return zU(!isNaN(R_)),new Kne(R_,d.size(),"final"===l_)},o.maxUploadRetryTime);return _h.headers={"X-Goog-Upload-Command":"query"},_h.errorHandler=YU(e),_h}(this._ref.storage,this._ref._location,e,this._blob),B=this._ref.storage._makeRequest(_,BS,i,d);this._request=B,B.getPromise().then(_t=>{_t=_t,this._request=void 0,this._updateProgress(_t.current),this._needToFetchStatus=!1,_t.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,i=new Kne(this._transferred,this._blob.size()),d=this._uploadUrl;this._resolveToken((_,B)=>{let _t;try{_t=function zne(o,e,i,d,_,B,_t,_a){const _h=new Kne(0,0);if(_t?(_h.current=_t.current,_h.total=_t.total):(_h.current=0,_h.total=d.size()),d.size()!==_h.total)throw function Pae(){return new $S("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}();const _g=_h.total-_h.current;let l_=_g;_>0&&(l_=Math.min(l_,_));const f_=_h.current,W_={"X-Goog-Upload-Command":l_===_g?"upload, finalize":"upload","X-Goog-Upload-Offset":`${_h.current}`},R0=d.slice(f_,f_+l_);if(null===R0)throw $he();const xI=new KU(i,"POST",function H0(DI,_C){const G1=sZ(DI,["active","final"]),BR=_h.current+l_,p2=d.size();let yS;return yS="final"===G1?iZ(e,B)(DI,_C):null,new Kne(BR,p2,"final"===G1,yS)},e.maxUploadRetryTime);return xI.headers=W_,xI.body=R0.uploadData(),xI.progressCallback=_a||null,xI.errorHandler=YU(o),xI}(this._ref._location,this._ref.storage,d,this._blob,e,this._mappings,i,this._makeProgressCallback())}catch(_h){return this._error=_h,void this._transition("error")}const _a=this._ref.storage._makeRequest(_t,BS,_,B);this._request=_a,_a.getPromise().then(_h=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(_h.current),_h.finalized?(this._metadata=_h.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,i)=>{const d=Gae(this._ref.storage,this._ref._location,this._mappings),_=this._ref.storage._makeRequest(d,BS,e,i);this._request=_,_.getPromise().then(B=>{this._request=void 0,this._metadata=B,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,i)=>{const d=function Qae(o,e,i,d,_){const B=e.bucketOnlyServerUrl(),_t={"X-Goog-Upload-Protocol":"multipart"},_h=function _a(){let xI="";for(let DI=0;DI<2;DI++)xI+=Math.random().toString().slice(2);return xI}();_t["Content-Type"]="multipart/related; boundary="+_h;const _g=ufe(e,d,_),l_=rZ(_g,i),H_=kM.getBlob("--"+_h+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+l_+"\r\n--"+_h+"\r\nContent-Type: "+_g.contentType+"\r\n\r\n",d,"\r\n--"+_h+"--");if(null===H_)throw $he();const W_={name:_g.fullPath},R0=qU(B,o.host,o._protocol),CI=o.maxUploadRetryTime,LI=new KU(R0,"POST",iZ(o,i),CI);return LI.urlParams=W_,LI.headers=_t,LI.body=H_.uploadData(),LI.errorHandler=YU(e),LI}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),_=this._ref.storage._makeRequest(d,BS,e,i);this._request=_,_.getPromise().then(B=>{this._request=void 0,this._metadata=B,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const i=this._transferred;this._transferred=e,this._transferred!==i&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request&&this._request.cancel();break;case"running":const i="paused"===this._state;this._state=e,i&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=Yhe(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=Hae(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,i,d,_){const B=new d_e(i||void 0,d||void 0,_||void 0);return this._addObserver(B),()=>{this._removeObserver(B)}}then(e,i){return this._promise.then(e,i)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const i=this._observers.indexOf(e);-1!==i&&this._observers.splice(i,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(i=>{this._notifyObserver(i)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(Hae(this._state)){case AN.SUCCESS:aK(this._resolve.bind(null,this.snapshot))();break;case AN.CANCELED:case AN.ERROR:aK(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Hae(this._state)){case AN.RUNNING:case AN.PAUSED:e.next&&aK(e.next.bind(e,this.snapshot))();break;case AN.SUCCESS:e.complete&&aK(e.complete.bind(e))();break;default:e.error&&aK(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class L8{constructor(e,i){this._service=e,this._location=i instanceof n2?i:n2.makeFromUrl(i,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,i){return new L8(e,i)}get root(){const e=new n2(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return bQ(this._location.path)}get storage(){return this._service}get parent(){const e=function rfe(o){if(0===o.length)return null;const e=o.lastIndexOf("/");return-1===e?"":o.slice(0,e)}(this._location.path);if(null===e)return null;const i=new n2(this._location.bucket,e);return new L8(this._service,i)}_throwIfRoot(e){if(""===this._location.path)throw xae(e)}}function Yne(o,e,i){return E6.apply(this,arguments)}function E6(){return(E6=(0,C0.Z)(function*(o,e,i){const _=yield Kae(o,{pageToken:i});e.prefixes.push(..._.prefixes),e.items.push(..._.items),null!=_.nextPageToken&&(yield Yne(o,e,_.nextPageToken))})).apply(this,arguments)}function Kae(o,e){null!=e&&"number"==typeof e.maxResults&&eZ("options.maxResults",1,1e3,e.maxResults);const i=e||{},d=o_e(o.storage,o._location,"/",i.pageToken,i.maxResults);return o.storage.makeRequestWithTokens(d,BS)}function _fe(o){o._throwIfRoot("getDownloadURL");const e=function s_e(o,e,i){const _=qU(e.fullServerUrl(),o.host,o._protocol),_t=o.maxOperationRetryTime,_a=new KU(_,"GET",function xL(o,e){return function i(d,_){const B=jae(o,_,e);return zU(null!==B),function a_(o,e,i,d){const _=WU(e);if(null===_||!EQ(_.downloadTokens))return null;const B=_.downloadTokens;if(0===B.length)return null;const _t=encodeURIComponent;return B.split(",").map(_g=>{const f_=o.fullPath;return qU("/b/"+_t(o.bucket)+"/o/"+_t(f_),i,d)+tZ({alt:"media",token:_g})})[0]}(B,_,o.host,o._protocol)}}(o,i),_t);return _a.errorHandler=sK(e),_a}(o.storage,o._location,iK());return o.storage.makeRequestWithTokens(e,BS).then(i=>{if(null===i)throw function JAe(){return new $S("no-download-url","The given file does not have any download URLs.")}();return i})}function zae(o,e){const i=function ife(o,e){const i=e.split("/").filter(d=>d.length>0).join("/");return 0===o.length?i:o+"/"+i}(o._location.path,e),d=new n2(o._location.bucket,i);return new L8(o.storage,d)}function $ne(o,e){if(o instanceof Yae){const i=o;if(null==i._bucket)throw function YAe(){return new $S("no-default-bucket","No default bucket found. Did you set the '"+kae+"' property when initializing the app?")}();const d=new L8(i,i._bucket);return null!=e?$ne(d,e):d}return void 0!==e?zae(o,e):o}function vfe(o,e){if(e&&function cZ(o){return/^[A-Za-z]+:\/\//.test(o)}(e)){if(o instanceof Yae)return function v_e(o,e){return new L8(o,e)}(o,e);throw tK("To use ref(service, url), the first argument must be a Storage instance.")}return $ne(o,e)}function yfe(o,e){const i=null==e?void 0:e[kae];return null==i?null:n2.makeFromBucketSpec(i,o)}class Yae{constructor(e,i,d,_,B){this.app=e,this._authProvider=i,this._appCheckProvider=d,this._url=_,this._firebaseVersion=B,this._bucket=null,this._host=Nae,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=_?n2.makeFromBucketSpec(_,this._host):yfe(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?n2.makeFromBucketSpec(this._url,e):yfe(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){eZ("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){eZ("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,C0.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const i=e._authProvider.getImmediate({optional:!0});if(i){const d=yield i.getToken();if(null!==d)return d.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,C0.Z)(function*(){const i=e._appCheckProvider.getImmediate({optional:!0});return i?(yield i.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new L8(this,e)}_makeRequest(e,i,d,_){if(this._deleted)return new $Ae(Zhe());{const B=function XAe(o,e,i,d,_,B){const _t=tZ(o.urlParams),_a=o.url+_t,_h=Object.assign({},o.headers);return function y6(o,e){e&&(o["X-Firebase-GMPID"]=e)}(_h,e),function Mae(o,e){null!==e&&e.length>0&&(o.Authorization="Firebase "+e)}(_h,i),function Bae(o,e){o["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(_h,B),function Y1(o,e){null!==e&&(o["X-Firebase-AppCheck"]=e)}(_h,d),new wR(_a,o.method,_h,o.body,o.successCodes,o.additionalRetryCodes,o.handler,o.errorHandler,o.timeout,o.progressCallback,_)}(e,this._appId,d,_,i,this._firebaseVersion);return this._requests.add(B),B.getPromise().then(()=>this._requests.delete(B),()=>this._requests.delete(B)),B}}makeRequestWithTokens(e,i){var d=this;return(0,C0.Z)(function*(){const[_,B]=yield Promise.all([d._getAuthToken(),d._getAppCheckToken()]);return d._makeRequest(e,i,_,B).getPromise()})()}}const Jae="@firebase/storage";function ere(o,e){return vfe(o=(0,M_.m9)(o),e)}function h_(o,{instanceIdentifier:e}){const i=o.getProvider("app").getImmediate(),d=o.getProvider("auth-internal"),_=o.getProvider("app-check-internal");return new Yae(i,d,_,e,uN.SDK_VERSION)}!function tre(){(0,uN._registerComponent)(new bL.wA("storage",h_,"PUBLIC").setMultipleInstances(!0)),(0,uN.registerVersion)(Jae,"0.9.6",""),(0,uN.registerVersion)(Jae,"0.9.6","esm2017")}();class CQ{constructor(e,i,d){this._delegate=e,this.task=i,this.ref=d}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class Cfe{constructor(e,i){this._delegate=e,this._ref=i,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new CQ(this._delegate.snapshot,this,this._ref)}then(e,i){return this._delegate.then(d=>{if(e)return e(new CQ(d,this,this._ref))},i)}on(e,i,d,_){let B;return i&&(B="function"==typeof i?_t=>i(new CQ(_t,this,this._ref)):{next:i.next?_t=>i.next(new CQ(_t,this,this._ref)):void 0,complete:i.complete||void 0,error:i.error||void 0}),this._delegate.on(e,B,d||void 0,_||void 0)}}class lZ{constructor(e,i){this._delegate=e,this._service=i}get prefixes(){return this._delegate.prefixes.map(e=>new $U(e,this._service))}get items(){return this._delegate.items.map(e=>new $U(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class $U{constructor(e,i){this._delegate=e,this.storage=i}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const i=function LL(o,e){return zae(o,e)}(this._delegate,e);return new $U(i,this.storage)}get root(){return new $U(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new $U(e,this.storage)}put(e,i){return this._throwIfRoot("put"),new Cfe(function JU(o,e,i){return function p_e(o,e,i){return o._throwIfRoot("uploadBytesResumable"),new aZ(o,new kM(e),i)}(o=(0,M_.m9)(o),e,i)}(this._delegate,e,i),this)}putString(e,i=PL.RAW,d){this._throwIfRoot("putString");const _=nZ(i,e),B=Object.assign({},d);return null==B.contentType&&null!=_.contentType&&(B.contentType=_.contentType),new Cfe(new aZ(this._delegate,new kM(_.data,!0),B),this)}listAll(){return function N_(o){return function m_e(o){const e={prefixes:[],items:[]};return Yne(o,e).then(()=>e)}(o=(0,M_.m9)(o))}(this._delegate).then(e=>new lZ(e,this.storage))}list(e){return function Xne(o,e){return Kae(o=(0,M_.m9)(o),e)}(this._delegate,e||void 0).then(i=>new lZ(i,this.storage))}getMetadata(){return function E_e(o){return function Jne(o){o._throwIfRoot("getMetadata");const e=Gae(o.storage,o._location,iK());return o.storage.makeRequestWithTokens(e,BS)}(o=(0,M_.m9)(o))}(this._delegate)}updateMetadata(e){return function sS(o,e){return function A_e(o,e){o._throwIfRoot("updateMetadata");const i=function a_e(o,e,i,d){const B=qU(e.fullServerUrl(),o.host,o._protocol),_a=rZ(i,d),_g=o.maxOperationRetryTime,l_=new KU(B,"PATCH",iZ(o,d),_g);return l_.headers={"Content-Type":"application/json; charset=utf-8"},l_.body=_a,l_.errorHandler=sK(e),l_}(o.storage,o._location,e,iK());return o.storage.makeRequestWithTokens(i,BS)}(o=(0,M_.m9)(o),e)}(this._delegate,e)}getDownloadURL(){return function U_(o){return _fe(o=(0,M_.m9)(o))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function pS(o){return function __e(o){o._throwIfRoot("deleteObject");const e=function cfe(o,e){const d=qU(e.fullServerUrl(),o.host,o._protocol),_a=new KU(d,"DELETE",function _t(_h,_g){},o.maxOperationRetryTime);return _a.successCodes=[200,204],_a.errorHandler=sK(e),_a}(o.storage,o._location);return o.storage.makeRequestWithTokens(e,BS)}(o=(0,M_.m9)(o))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw xae(e)}}class Zae{constructor(e,i){this.app=e,this._delegate=i}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(Xae(e))throw tK("ref() expected a child path but got a URL, use refFromURL instead.");return new $U(ere(this._delegate,e),this)}refFromURL(e){if(!Xae(e))throw tK("refFromURL() expected a full URL but got a child path, use ref() instead.");try{n2.makeFromUrl(e,this._delegate.host)}catch(i){throw tK("refFromUrl() expected a valid full URL but got an invalid one.")}return new $U(ere(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,i,d={}){!function ML(o,e,i,d={}){!function Zne(o,e,i,d={}){o.host=`${e}:${i}`,o._protocol="http";const{mockUserToken:_}=d;_&&(o._overrideAuthToken="string"==typeof _?_:(0,M_.Sg)(_,o.app.options.projectId))}(o,e,i,d)}(this._delegate,e,i,d)}}function Xae(o){return/^[A-Za-z]+:\/\//.test(o)}function Tfe(o,{instanceIdentifier:e}){const i=o.getProvider("app-compat").getImmediate(),d=o.getProvider("storage").getImmediate({identifier:e});return new Zae(i,d)}function ore(o){const e=function ire(o){return new LT.y(e=>{const i=_t=>e.next(_t);i(o.snapshot);const B=o.on("state_changed",i);return o.then(_t=>{i(_t),e.complete()},_t=>{i(o.snapshot),(_t=>{e.error(_t)})(_t)}),function(){B()}}).pipe(function Ghe(o,e=sH.z){return(0,rS.e)((i,d)=>{let _=null,B=null,_t=null;const _a=()=>{if(_){_.unsubscribe(),_=null;const _g=B;B=null,d.next(_g)}};function _h(){const _g=_t+o,l_=e.now();if(l_<_g)return _=this.schedule(void 0,_g-l_),void d.add(_);_a()}i.subscribe((0,nS.x)(d,_g=>{B=_g,_t=e.now(),_||(_=e.schedule(_h,o),d.add(_))},()=>{_a(),d.complete()},void 0,()=>{B=_=null}))})}(0))}(o);return{task:o,then:o.then.bind(o),catch:o.catch.bind(o),pause:o.pause.bind(o),cancel:o.cancel.bind(o),resume:o.resume.bind(o),snapshotChanges:()=>e,percentageChanges:()=>e.pipe((0,RI.U)(i=>i.bytesTransferred/i.totalBytes*100))}}function cK(o){return{getDownloadURL:()=>hI(void 0).pipe(H1.fc,HT(()=>o.getDownloadURL()),H1.iC),getMetadata:()=>hI(void 0).pipe(H1.fc,HT(()=>o.getMetadata()),H1.iC),delete:()=>(0,uT.D)(o.delete()),child:e=>cK(o.child(e)),updateMetadata:e=>(0,uT.D)(o.updateMetadata(e)),put:(e,i)=>ore(o.put(e,i)),putString:(e,i,d)=>ore(o.putString(e,i,d)),list:e=>(0,uT.D)(o.list(e)),listAll:()=>(0,uT.D)(o.listAll())}}!function ece(o){const e={TaskState:AN,TaskEvent:l_e,StringFormat:PL,Storage:Zae,Reference:$U};o.INTERNAL.registerComponent(new bL.wA("storage-compat",Tfe,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),o.registerVersion("@firebase/storage-compat","0.1.14")}(k5.Z);const wQ=new f.OlP("angularfire2.storageBucket"),sI=new f.OlP("angularfire2.storage.maxUploadRetryTime"),lT=new f.OlP("angularfire2.storage.maxOperationRetryTime"),BL=new f.OlP("angularfire2.storage.use-emulator");let b6=(()=>{class o{constructor(i,d,_,B,_t,_a,_h,_g,l_,f_){const R_=(0,lR.on)(i,_t,d);this.storage=(0,lR.cc)(`${R_.name}.storage.${_}`,"AngularFireStorage",R_.name,()=>{const H_=_t.runOutsideAngular(()=>R_.storage(_||void 0)),W_=l_;return W_&&H_.useEmulator(...W_),_h&&H_.setMaxUploadRetryTime(_h),_g&&H_.setMaxOperationRetryTime(_g),H_},[_h,_g])}ref(i){return cK(this.storage.ref(i))}refFromURL(i){return cK(this.storage.refFromURL(i))}upload(i,d,_){return cK(this.storage.ref(i)).put(d,_)}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(lR.Dh),f.LFG(lR.xv,8),f.LFG(wQ,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(H1.HU),f.LFG(sI,8),f.LFG(lT,8),f.LFG(BL,8),f.LFG(f6,8))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac,providedIn:"any"}),o})(),uK=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=f.oAB({type:o}),o.\u0275inj=f.cJS({}),o})(),II=(()=>{class o{constructor(){hQ.Z.registerVersion("angularfire",H1.q4.full,"gcs-compat")}}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=f.oAB({type:o}),o.\u0275inj=f.cJS({providers:[b6],imports:[uK]}),o})();function TR(){return(0,rS.e)((o,e)=>{let i,d=!1;o.subscribe((0,nS.x)(e,_=>{const B=i;i=_,d&&e.next([B,_]),d=!0}))})}var TI,sre="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ZU={},GO=GO||{},A1=sre||self;function aS(){}function tce(o){var e=typeof o;return"array"==(e="object"!=e?e:o?Array.isArray(o)?"array":e:"null")||"object"==e&&"number"==typeof o.length}function dZ(o){var e=typeof o;return"object"==e&&null!=o||"function"==e}var M8="closure_uid_"+(1e9*Math.random()>>>0),nce=0;function are(o,e,i){return o.call.apply(o.bind,arguments)}function b_e(o,e,i){if(!o)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var _=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(_,d),o.apply(e,_)}}return function(){return o.apply(e,arguments)}}function nO(o,e,i){return(nO=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?are:b_e).apply(null,arguments)}function SR(o,e){var i=Array.prototype.slice.call(arguments,1);return function(){var d=i.slice();return d.push.apply(d,arguments),o.apply(this,d)}}function v0(o,e){function i(){}i.prototype=e.prototype,o.Z=e.prototype,o.prototype=new i,o.prototype.constructor=o,o.Vb=function(d,_,B){for(var _t=Array(arguments.length-2),_a=2;_a<arguments.length;_a++)_t[_a-2]=arguments[_a];return e.prototype[_].apply(d,_t)}}function ZS(){this.s=this.s,this.o=this.o}var lK={};ZS.prototype.s=!1,ZS.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var o=function I_e(o){return Object.prototype.hasOwnProperty.call(o,M8)&&o[M8]||(o[M8]=++nce)}(this);delete lK[o]}},ZS.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const s1=Array.prototype.indexOf?function(o,e){return Array.prototype.indexOf.call(o,e,void 0)}:function(o,e){if("string"==typeof o)return"string"!=typeof e||1!=e.length?-1:o.indexOf(e,0);for(let i=0;i<o.length;i++)if(i in o&&o[i]===e)return i;return-1},UL=Array.prototype.forEach?function(o,e,i){Array.prototype.forEach.call(o,e,i)}:function(o,e,i){const d=o.length,_="string"==typeof o?o.split(""):o;for(let B=0;B<d;B++)B in _&&e.call(i,_[B],B,o)};function Sfe(o){return Array.prototype.concat.apply([],arguments)}function B8(o){const e=o.length;if(0<e){const i=Array(e);for(let d=0;d<e;d++)i[d]=o[d];return i}return[]}function U8(o){return/^[\s\xa0]*$/.test(o)}var QO,Rfe=String.prototype.trim?function(o){return o.trim()}:function(o){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(o)[1]};function _k(o,e){return-1!=o.indexOf(e)}function oce(o,e){return o<e?-1:o>e?1:0}e:{var sce=A1.navigator;if(sce){var Ofe=sce.userAgent;if(Ofe){QO=Ofe;break e}}QO=""}function ace(o,e,i){for(const d in o)e.call(i,o[d],d,o)}function Dfe(o){const e={};for(const i in o)e[i]=o[i];return e}var Nfe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function cre(o,e){let i,d;for(let _=1;_<arguments.length;_++){for(i in d=arguments[_],d)o[i]=d[i];for(let B=0;B<Nfe.length;B++)i=Nfe[B],Object.prototype.hasOwnProperty.call(d,i)&&(o[i]=d[i])}}function ure(o){return ure[" "](o),o}ure[" "]=aS;var hZ,o,cce=_k(QO,"Opera"),dK=_k(QO,"Trident")||_k(QO,"MSIE"),kfe=_k(QO,"Edge"),lre=kfe||dK,uce=_k(QO,"Gecko")&&!(_k(QO.toLowerCase(),"webkit")&&!_k(QO,"Edge"))&&!(_k(QO,"Trident")||_k(QO,"MSIE"))&&!_k(QO,"Edge"),w_e=_k(QO.toLowerCase(),"webkit")&&!_k(QO,"Edge");function Pfe(){var o=A1.document;return o?o.documentMode:void 0}e:{var lce="",dce=(o=QO,uce?/rv:([^\);]+)(\)|;)/.exec(o):kfe?/Edge\/([\d\.]+)/.exec(o):dK?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(o):w_e?/WebKit\/(\S+)/.exec(o):cce?/(?:Version)[ \/]?(\S+)/.exec(o):void 0);if(dce&&(lce=dce?dce[1]:""),dK){var dre=Pfe();if(null!=dre&&dre>parseFloat(lce)){hZ=String(dre);break e}}hZ=lce}var T_e={};var pce=A1.document&&dK&&(Pfe()||parseInt(hZ,10))||void 0,R_e=function(){if(!A1.addEventListener||!Object.defineProperty)return!1;var o=!1,e=Object.defineProperty({},"passive",{get:function(){o=!0}});try{A1.addEventListener("test",aS,e),A1.removeEventListener("test",aS,e)}catch(i){}return o}();function o2(o,e){this.type=o,this.g=this.target=e,this.defaultPrevented=!1}function hK(o,e){if(o2.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var i=this.type=o.type,d=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=e,e=o.relatedTarget){if(uce){e:{try{ure(e.nodeName);var _=!0;break e}catch(B){}_=!1}_||(e=null)}}else"mouseover"==i?e=o.fromElement:"mouseout"==i&&(e=o.toElement);this.relatedTarget=e,d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==o.clientX?o.clientX:o.pageX,this.clientY=void 0!==o.clientY?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType="string"==typeof o.pointerType?o.pointerType:O_e[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&hK.Z.h.call(this)}}o2.prototype.h=function(){this.defaultPrevented=!0},v0(hK,o2);var O_e={2:"touch",3:"pen",4:"mouse"};hK.prototype.h=function(){hK.Z.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var fK="closure_listenable_"+(1e6*Math.random()|0),xfe=0;function F8(o,e,i,d,_){this.listener=o,this.proxy=null,this.src=e,this.type=i,this.capture=!!d,this.ia=_,this.key=++xfe,this.ca=this.fa=!1}function fZ(o){o.ca=!0,o.listener=null,o.proxy=null,o.src=null,o.ia=null}function hre(o){this.src=o,this.g={},this.h=0}function gce(o,e){var i=e.type;if(i in o.g){var B,d=o.g[i],_=s1(d,e);(B=0<=_)&&Array.prototype.splice.call(d,_,1),B&&(fZ(e),0==o.g[i].length&&(delete o.g[i],o.h--))}}function mce(o,e,i,d){for(var _=0;_<o.length;++_){var B=o[_];if(!B.ca&&B.listener==e&&B.capture==!!i&&B.ia==d)return _}return-1}hre.prototype.add=function(o,e,i,d,_){var B=o.toString();(o=this.g[B])||(o=this.g[B]=[],this.h++);var _t=mce(o,e,d,_);return-1<_t?(e=o[_t],i||(e.fa=!1)):((e=new F8(e,this.src,B,!!d,_)).fa=i,o.push(e)),e};var Ace="closure_lm_"+(1e6*Math.random()|0),fre={};function Lfe(o,e,i,d,_){if(d&&d.once)return pre(o,e,i,d,_);if(Array.isArray(e)){for(var B=0;B<e.length;B++)Lfe(o,e[B],i,d,_);return null}return i=pZ(i),o&&o[fK]?o.N(e,i,dZ(d)?!!d.capture:!!d,_):Mfe(o,e,i,!1,d,_)}function Mfe(o,e,i,d,_,B){if(!e)throw Error("Invalid event type");var _t=dZ(_)?!!_.capture:!!_,_a=rO(o);if(_a||(o[Ace]=_a=new hre(o)),(i=_a.add(e,i,d,_t,B)).proxy)return i;if(d=function D_e(){var e=iT;return function o(i){return e.call(o.src,o.listener,i)}}(),i.proxy=d,d.src=o,d.listener=i,o.addEventListener)R_e||(_=_t),void 0===_&&(_=!1),o.addEventListener(e.toString(),d,_);else if(o.attachEvent)o.attachEvent(RR(e.toString()),d);else{if(!o.addListener||!o.removeListener)throw Error("addEventListener and attachEvent are unavailable.");o.addListener(d)}return i}function pre(o,e,i,d,_){if(Array.isArray(e)){for(var B=0;B<e.length;B++)pre(o,e[B],i,d,_);return null}return i=pZ(i),o&&o[fK]?o.O(e,i,dZ(d)?!!d.capture:!!d,_):Mfe(o,e,i,!0,d,_)}function gre(o,e,i,d,_){if(Array.isArray(e))for(var B=0;B<e.length;B++)gre(o,e[B],i,d,_);else d=dZ(d)?!!d.capture:!!d,i=pZ(i),o&&o[fK]?(o=o.i,(e=String(e).toString())in o.g&&-1<(i=mce(B=o.g[e],i,d,_))&&(fZ(B[i]),Array.prototype.splice.call(B,i,1),0==B.length&&(delete o.g[e],o.h--))):o&&(o=rO(o))&&(e=o.g[e.toString()],o=-1,e&&(o=mce(e,i,d,_)),(i=-1<o?e[o]:null)&&pK(i))}function pK(o){if("number"!=typeof o&&o&&!o.ca){var e=o.src;if(e&&e[fK])gce(e.i,o);else{var i=o.type,d=o.proxy;e.removeEventListener?e.removeEventListener(i,d,o.capture):e.detachEvent?e.detachEvent(RR(i),d):e.addListener&&e.removeListener&&e.removeListener(d),(i=rO(e))?(gce(i,o),0==i.h&&(i.src=null,e[Ace]=null)):fZ(o)}}}function RR(o){return o in fre?fre[o]:fre[o]="on"+o}function iT(o,e){if(o.ca)o=!0;else{e=new hK(e,this);var i=o.listener,d=o.ia||o.src;o.fa&&pK(o),o=i.call(d,e)}return o}function rO(o){return(o=o[Ace])instanceof hre?o:null}var TQ="__closure_events_fn_"+(1e9*Math.random()>>>0);function pZ(o){return"function"==typeof o?o:(o[TQ]||(o[TQ]=function(e){return o.handleEvent(e)}),o[TQ])}function iO(){ZS.call(this),this.i=new hre(this),this.P=this,this.I=null}function l1(o,e){var i,d=o.I;if(d)for(i=[];d;d=d.I)i.push(d);if(o=o.P,d=e.type||e,"string"==typeof e)e=new o2(e,o);else if(e instanceof o2)e.target=e.target||o;else{var _=e;cre(e=new o2(d,o),_)}if(_=!0,i)for(var B=i.length-1;0<=B;B--){var _t=e.g=i[B];_=gZ(_t,d,!0,e)&&_}if(_=gZ(_t=e.g=o,d,!0,e)&&_,_=gZ(_t,d,!1,e)&&_,i)for(B=0;B<i.length;B++)_=gZ(_t=e.g=i[B],d,!1,e)&&_}function gZ(o,e,i,d){if(!(e=o.i.g[String(e)]))return!0;e=e.concat();for(var _=!0,B=0;B<e.length;++B){var _t=e[B];if(_t&&!_t.ca&&_t.capture==i){var _a=_t.listener,_h=_t.ia||_t.src;_t.fa&&gce(o.i,_t),_=!1!==_a.call(_h,d)&&_}}return _&&!d.defaultPrevented}v0(iO,ZS),iO.prototype[fK]=!0,iO.prototype.removeEventListener=function(o,e,i,d){gre(this,o,e,i,d)},iO.prototype.M=function(){if(iO.Z.M.call(this),this.i){var e,o=this.i;for(e in o.g){for(var i=o.g[e],d=0;d<i.length;d++)fZ(i[d]);delete o.g[e],o.h--}}this.I=null},iO.prototype.N=function(o,e,i,d){return this.i.add(String(o),e,!1,i,d)},iO.prototype.O=function(o,e,i,d){return this.i.add(String(o),e,!0,i,d)};var _ce=A1.JSON.stringify;function N_e(){var o=Ice;let e=null;return o.g&&(e=o.g,o.g=o.g.next,o.g||(o.h=null),e.next=null),e}var Ece,J1=new class{constructor(o,e){this.i=o,this.j=e,this.h=0,this.g=null}get(){let o;return 0<this.h?(this.h--,o=this.g,this.g=o.next,o.next=null):o=this.i(),o}}(()=>new yO,o=>o.reset());class yO{constructor(){this.next=this.g=this.h=null}set(e,i){this.h=e,this.g=i,this.next=null}reset(){this.next=this.g=this.h=null}}function vce(o){A1.setTimeout(()=>{throw o},0)}function yce(o,e){Ece||function oO(){var o=A1.Promise.resolve(void 0);Ece=function(){o.then(bI)}}(),gT||(Ece(),gT=!0),Ice.add(o,e)}var gT=!1,Ice=new class Bfe{constructor(){this.h=this.g=null}add(e,i){const d=J1.get();d.set(e,i),this.h?this.h.next=d:this.g=d,this.h=d}};function bI(){for(var o;o=N_e();){try{o.h.call(o.g)}catch(i){vce(i)}var e=J1;e.j(o),100>e.h&&(e.h++,o.next=e.g,e.g=o)}gT=!1}function lI(o,e){iO.call(this),this.h=o||1,this.g=e||A1,this.j=nO(this.kb,this),this.l=Date.now()}function C6(o){o.da=!1,o.S&&(o.g.clearTimeout(o.S),o.S=null)}function XU(o,e,i){if("function"==typeof o)i&&(o=nO(o,i));else{if(!o||"function"!=typeof o.handleEvent)throw Error("Invalid listener argument");o=nO(o.handleEvent,o)}return 2147483647<Number(e)?-1:A1.setTimeout(o,e||0)}function SQ(o){o.g=XU(()=>{o.g=null,o.i&&(o.i=!1,SQ(o))},o.j);const e=o.h;o.h=null,o.m.apply(null,e)}v0(lI,iO),(TI=lI.prototype).da=!1,TI.S=null,TI.kb=function(){if(this.da){var o=Date.now()-this.l;0<o&&o<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-o):(this.S&&(this.g.clearTimeout(this.S),this.S=null),l1(this,"tick"),this.da&&(C6(this),this.start()))}},TI.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},TI.M=function(){lI.Z.M.call(this),C6(this),delete this.g};class mZ extends ZS{constructor(e,i){super(),this.m=e,this.j=i,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:SQ(this)}M(){super.M(),this.g&&(A1.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function HO(o){ZS.call(this),this.h=o,this.g={}}v0(HO,ZS);var OR=[];function OI(o,e,i,d){Array.isArray(i)||(i&&(OR[0]=i.toString()),i=OR);for(var _=0;_<i.length;_++){var B=Lfe(e,i[_],d||o.handleEvent,!1,o.h||o);if(!B)break;o.g[B.key]=B}}function mre(o){ace(o.g,function(e,i){this.g.hasOwnProperty(i)&&pK(e)},o),o.g={}}function gS(){this.g=!0}function WT(o,e,i,d){o.info(function(){return"XMLHTTP TEXT ("+e+"): "+function h1(o,e){if(!o.g)return e;if(!e)return null;try{var i=JSON.parse(e);if(i)for(o=0;o<i.length;o++)if(Array.isArray(i[o])){var d=i[o];if(!(2>d.length)){var _=d[1];if(Array.isArray(_)&&!(1>_.length)){var B=_[0];if("noop"!=B&&"stop"!=B&&"close"!=B)for(var _t=1;_t<_.length;_t++)_[_t]=""}}}return _ce(i)}catch(_a){return e}}(o,i)+(d?" "+d:"")})}HO.prototype.M=function(){HO.Z.M.call(this),mre(this)},HO.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},gS.prototype.Aa=function(){this.g=!1},gS.prototype.info=function(){};var hR={},V1=null;function AZ(){return V1=V1||new iO}function s2(o){o2.call(this,hR.Ma,o)}function gK(o){const e=AZ();l1(e,new s2(e,o))}function Ufe(o,e){o2.call(this,hR.STAT_EVENT,o),this.stat=e}function vN(o){const e=AZ();l1(e,new Ufe(e,o))}function bce(o,e){o2.call(this,hR.Na,o),this.size=e}function mK(o,e){if("function"!=typeof o)throw Error("Fn must not be null and must be a function");return A1.setTimeout(function(){o()},e)}hR.Ma="serverreachability",v0(s2,o2),hR.STAT_EVENT="statevent",v0(Ufe,o2),hR.Na="timingevent",v0(bce,o2);var AK={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Are={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function _re(){}function Cce(){}_re.prototype.h=null;var wce,p1={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function UT(){o2.call(this,"d")}function B4(){o2.call(this,"c")}function _K(){}function RQ(o,e,i,d){this.l=o,this.j=e,this.m=i,this.X=d||1,this.V=new HO(this),this.P=k_e,this.W=new lI(o=lre?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new jfe}function jfe(){this.i=null,this.g="",this.h=!1}v0(UT,o2),v0(B4,o2),v0(_K,_re),_K.prototype.g=function(){return new XMLHttpRequest},_K.prototype.i=function(){return{}},wce=new _K;var k_e=45e3,JP={},w6={};function mT(o,e,i){o.K=1,o.v=EN(AT(e)),o.s=i,o.U=!0,Tce(o,null)}function Tce(o,e){o.F=Date.now(),xM(o),o.A=AT(o.v);var i=o.A,d=o.X;Array.isArray(d)||(d=[String(d)]),Hfe(i.h,"t",d),o.C=0,i=o.l.H,o.h=new jfe,o.g=Vce(o.l,i?e:null,!o.s),0<o.O&&(o.L=new mZ(nO(o.Ia,o,o.g),o.O)),OI(o.V,o.g,"readystatechange",o.gb),e=o.H?Dfe(o.H):{},o.s?(o.u||(o.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.s,e)):(o.u="GET",o.g.ea(o.A,o.u,null,e)),gK(1),function d1(o,e,i,d,_,B){o.info(function(){if(o.g)if(B)for(var _t="",_a=B.split("&"),_h=0;_h<_a.length;_h++){var _g=_a[_h].split("=");if(1<_g.length){var l_=_g[0];_g=_g[1];var f_=l_.split("_");_t=2<=f_.length&&"type"==f_[1]?_t+(l_+"=")+_g+"&":_t+(l_+"=redacted&")}}else _t=null;else _t=B;return"XMLHTTP REQ ("+d+") [attempt "+_+"]: "+e+"\n"+i+"\n"+_t})}(o.j,o.u,o.A,o.m,o.X,o.s)}function EO(o){return!!o.g&&"GET"==o.u&&2!=o.K&&o.l.Ba}function PM(o,e,i){let _,d=!0;for(;!o.I&&o.C<i.length;){if(_=yN(o,i),_==w6){4==e&&(o.o=4,vN(14),d=!1),WT(o.j,o.m,null,"[Incomplete Response]");break}if(_==JP){o.o=4,vN(15),WT(o.j,o.m,i,"[Invalid Chunk]"),d=!1;break}WT(o.j,o.m,_,null),DR(o,_)}EO(o)&&_!=w6&&_!=JP&&(o.h.g="",o.C=0),4!=e||0!=i.length||o.h.h||(o.o=1,vN(16),d=!1),o.i=o.i&&d,d?0<i.length&&!o.aa&&(o.aa=!0,(e=o.l).g==o&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+i.length),Bce(e),e.L=!0,vN(11))):(WT(o.j,o.m,i,"[Invalid Chunked Response]"),mI(o),dT(o))}function yN(o,e){var i=o.C,d=e.indexOf("\n",i);return-1==d?w6:(i=Number(e.substring(i,d)),isNaN(i)?JP:(d+=1)+i>e.length?w6:(e=e.substr(d,i),o.C=d+i,e))}function xM(o){o.Y=Date.now()+o.P,KT(o,o.P)}function KT(o,e){if(null!=o.B)throw Error("WatchDog timer not null");o.B=mK(nO(o.eb,o),e)}function FT(o){o.B&&(A1.clearTimeout(o.B),o.B=null)}function dT(o){0==o.l.G||o.I||tpe(o.l,o)}function mI(o){FT(o);var e=o.L;e&&"function"==typeof e.na&&e.na(),o.L=null,C6(o.W),mre(o.V),o.g&&(e=o.g,o.g=null,e.abort(),e.na())}function DR(o,e){try{var i=o.l;if(0!=i.G&&(i.g==o||vre(i.i,o)))if(i.I=o.N,!o.J&&vre(i.i,o)&&3==i.G){try{var d=i.Ca.g.parse(e)}catch(_g){d=null}if(Array.isArray(d)&&3==d.length){var _=d;if(0==_[0])e:if(i.u)i.ta=_[1],0<i.ta-i.U&&37500>_[2]&&i.N&&0==i.A&&!i.v&&(i.v=mK(nO(i.ab,i),6e3));else{if(i.g){if(!(i.g.F+3e3<o.F))break e;Tre(i),SZ(i)}wre(i),vN(18)}if(1>=Kfe(i.i)&&i.ka){try{i.ka()}catch(_g){}i.ka=void 0}}else q8(i,11)}else if((o.J||i.g==o)&&Tre(i),!U8(e))for(_=i.Ca.g.parse(e),e=0;e<_.length;e++){let _g=_[e];if(i.U=_g[0],_g=_g[1],2==i.G)if("c"==_g[0]){i.J=_g[1],i.la=_g[2];const l_=_g[3];null!=l_&&(i.ma=l_,i.h.info("VER="+i.ma));const f_=_g[4];null!=f_&&(i.za=f_,i.h.info("SVER="+i.za));const R_=_g[5];null!=R_&&"number"==typeof R_&&0<R_&&(i.K=d=1.5*R_,i.h.info("backChannelRequestTimeoutMs_="+d)),d=i;const H_=o.g;if(H_){const W_=H_.g?H_.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(W_){var B=d.i;!B.g&&(_k(W_,"spdy")||_k(W_,"quic")||_k(W_,"h2"))&&(B.j=B.l,B.g=new Set,B.h&&(Dce(B,B.h),B.h=null))}if(d.D){const R0=H_.g?H_.g.getResponseHeader("X-HTTP-Session-Id"):null;R0&&(d.sa=R0,U0(d.F,d.D,R0))}}i.G=3,i.j&&i.j.xa(),i.$&&(i.O=Date.now()-o.F,i.h.info("Handshake RTT: "+i.O+"ms"));var _t=o;if((d=i).oa=jce(d,d.H?d.la:null,d.W),_t.J){zfe(d.i,_t);var _a=_t,_h=d.K;_h&&_a.setTimeout(_h),_a.B&&(FT(_a),xM(_a)),d.g=_t}else H8(d);0<i.l.length&&RZ(i)}else"stop"!=_g[0]&&"close"!=_g[0]||q8(i,7);else 3==i.G&&("stop"==_g[0]||"close"==_g[0]?"stop"==_g[0]?q8(i,7):Q8(i):"noop"!=_g[0]&&i.j&&i.j.wa(_g),i.A=0)}gK(4)}catch(_g){}}function _Z(o,e){if(o.forEach&&"function"==typeof o.forEach)o.forEach(e,void 0);else if(tce(o)||"string"==typeof o)UL(o,e,void 0);else{if(o.T&&"function"==typeof o.T)var i=o.T();else if(o.R&&"function"==typeof o.R)i=void 0;else if(tce(o)||"string"==typeof o){i=[];for(var d=o.length,_=0;_<d;_++)i.push(_)}else for(_ in i=[],d=0,o)i[d++]=_;d=function Sce(o){if(o.R&&"function"==typeof o.R)return o.R();if("string"==typeof o)return o.split("");if(tce(o)){for(var e=[],i=o.length,d=0;d<i;d++)e.push(o[d]);return e}for(d in e=[],i=0,o)e[i++]=o[d];return e}(o),_=d.length;for(var B=0;B<_;B++)e.call(void 0,d[B],i&&i[B],o)}}function FL(o,e){this.h={},this.g=[],this.i=0;var i=arguments.length;if(1<i){if(i%2)throw Error("Uneven number of arguments");for(var d=0;d<i;d+=2)this.set(arguments[d],arguments[d+1])}else if(o)if(o instanceof FL)for(i=o.T(),d=0;d<i.length;d++)this.set(i[d],o.get(i[d]));else for(d in o)this.set(d,o[d])}function j8(o){if(o.i!=o.g.length){for(var e=0,i=0;e<o.g.length;){var d=o.g[e];u1(o.h,d)&&(o.g[i++]=d),e++}o.g.length=i}if(o.i!=o.g.length){var _={};for(i=e=0;e<o.g.length;)u1(_,d=o.g[e])||(o.g[i++]=d,_[d]=1),e++;o.g.length=i}}function u1(o,e){return Object.prototype.hasOwnProperty.call(o,e)}(TI=RQ.prototype).setTimeout=function(o){this.P=o},TI.gb=function(o){o=o.target;const e=this.L;e&&3==S6(o)?e.l():this.Ia(o)},TI.Ia=function(o){try{if(o==this.g)e:{const l_=S6(this.g);var e=this.g.Da();const f_=this.g.ba();if(!(3>l_)&&(3!=l_||lre||this.g&&(this.h.h||this.g.ga()||epe(this.g)))){this.I||4!=l_||7==e||gK(8==e||0>=f_?3:2),FT(this);var i=this.g.ba();this.N=i;t:if(EO(this)){var d=epe(this.g);o="";var _=d.length,B=4==S6(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){mI(this),dT(this);var _t="";break t}this.h.i=new A1.TextDecoder}for(e=0;e<_;e++)this.h.h=!0,o+=this.h.i.decode(d[e],{stream:B&&e==_-1});d.splice(0,_),this.h.g+=o,this.C=0,_t=this.h.g}else _t=this.g.ga();if(this.i=200==i,function _N(o,e,i,d,_,B,_t){o.info(function(){return"XMLHTTP RESP ("+d+") [ attempt "+_+"]: "+e+"\n"+i+"\n"+B+" "+_t})}(this.j,this.u,this.A,this.m,this.X,l_,i),this.i){if(this.$&&!this.J){t:{if(this.g){var _a,_h=this.g;if((_a=_h.g?_h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U8(_a)){var _g=_a;break t}}_g=null}if(!(i=_g)){this.i=!1,this.o=3,vN(12),mI(this),dT(this);break e}WT(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,DR(this,i)}this.U?(PM(this,l_,_t),lre&&this.i&&3==l_&&(OI(this.V,this.W,"tick",this.fb),this.W.start())):(WT(this.j,this.m,_t,null),DR(this,_t)),4==l_&&mI(this),this.i&&!this.I&&(4==l_?tpe(this.l,this):(this.i=!1,xM(this)))}else 400==i&&0<_t.indexOf("Unknown SID")?(this.o=3,vN(12)):(this.o=0,vN(13)),mI(this),dT(this)}}}catch(l_){}},TI.fb=function(){if(this.g){var o=S6(this.g),e=this.g.ga();this.C<e.length&&(FT(this),PM(this,o,e),this.i&&4!=o&&xM(this))}},TI.cancel=function(){this.I=!0,mI(this)},TI.eb=function(){this.B=null;const o=Date.now();0<=o-this.Y?(function i1(o,e){o.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(gK(3),vN(17)),mI(this),this.o=2,dT(this)):KT(this,this.Y-o)},(TI=FL.prototype).R=function(){j8(this);for(var o=[],e=0;e<this.g.length;e++)o.push(this.h[this.g[e]]);return o},TI.T=function(){return j8(this),this.g.concat()},TI.get=function(o,e){return u1(this.h,o)?this.h[o]:e},TI.set=function(o,e){u1(this.h,o)||(this.i++,this.g.push(o)),this.h[o]=e},TI.forEach=function(o,e){for(var i=this.T(),d=0;d<i.length;d++){var _=i[d],B=this.get(_);o.call(e,B,_,this)}};var Rce=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function OQ(o,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,o instanceof OQ){this.g=void 0!==e?e:o.g,vK(this,o.j),this.s=o.s,V8(this,o.i),vZ(this,o.m),this.l=o.l,e=o.h;var i=new yZ;i.i=e.i,e.g&&(i.g=new FL(e.g),i.h=e.h),o1(this,i),this.o=o.o}else o&&(i=String(o).match(Rce))?(this.g=!!e,vK(this,i[1]||"",!0),this.s=_F(i[2]||""),V8(this,i[3]||"",!0),vZ(this,i[4]),this.l=_F(i[5]||"",!0),o1(this,i[6]||"",!0),this.o=_F(i[7]||"")):(this.g=!!e,this.h=new yZ(null,this.g))}function AT(o){return new OQ(o)}function vK(o,e,i){o.j=i?_F(e,!0):e,o.j&&(o.j=o.j.replace(/:$/,""))}function V8(o,e,i){o.i=i?_F(e,!0):e}function vZ(o,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);o.m=e}else o.m=null}function o1(o,e,i){e instanceof yZ?(o.h=e,function T6(o,e){e&&!o.j&&(G8(o),o.i=null,o.g.forEach(function(i,d){var _=d.toLowerCase();d!=_&&(Qfe(this,d),Hfe(this,_,i))},o)),o.j=e}(o.h,o.g)):(i||(e=yK(e,bN)),o.h=new yZ(e,o.g))}function U0(o,e,i){o.h.set(e,i)}function EN(o){return U0(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function _F(o,e){return o?e?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function yK(o,e,i){return"string"==typeof o?(o=encodeURI(o).replace(e,P_e),i&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function P_e(o){return"%"+((o=o.charCodeAt(0))>>4&15).toString(16)+(15&o).toString(16)}OQ.prototype.toString=function(){var o=[],e=this.j;e&&o.push(yK(e,tP,!0),":");var i=this.i;return(i||"file"==e)&&(o.push("//"),(e=this.s)&&o.push(yK(e,tP,!0),"@"),o.push(encodeURIComponent(String(i)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(i=this.m)&&o.push(":",String(i))),(i=this.l)&&(this.i&&"/"!=i.charAt(0)&&o.push("/"),o.push(yK(i,"/"==i.charAt(0)?IN:a2,!0))),(i=this.h.toString())&&o.push("?",i),(i=this.o)&&o.push("#",yK(i,Gfe)),o.join("")};var tP=/[#\/\?@]/g,a2=/[#\?:]/g,IN=/[#\?]/g,bN=/[#\?@]/g,Gfe=/#/g;function yZ(o,e){this.h=this.g=null,this.i=o||null,this.j=!!e}function G8(o){o.g||(o.g=new FL,o.h=0,o.i&&function Vfe(o,e){if(o){o=o.split("&");for(var i=0;i<o.length;i++){var d=o[i].indexOf("="),_=null;if(0<=d){var B=o[i].substring(0,d);_=o[i].substring(d+1)}else B=o[i];e(B,_?decodeURIComponent(_.replace(/\+/g," ")):"")}}}(o.i,function(e,i){o.add(decodeURIComponent(e.replace(/\+/g," ")),i)}))}function Qfe(o,e){G8(o),e=EK(o,e),u1(o.g.h,e)&&(o.i=null,o.h-=o.g.get(e).length,u1((o=o.g).h,e)&&(delete o.h[e],o.i--,o.g.length>2*o.i&&j8(o)))}function Oce(o,e){return G8(o),e=EK(o,e),u1(o.g.h,e)}function Hfe(o,e,i){Qfe(o,e),0<i.length&&(o.i=null,o.g.set(EK(o,e),B8(i)),o.h+=i.length)}function EK(o,e){return e=String(e),o.j&&(e=e.toLowerCase()),e}function qfe(o){this.l=o||L_e,o=A1.PerformanceNavigationTiming?0<(o=A1.performance.getEntriesByType("navigation")).length&&("hq"==o[0].nextHopProtocol||"h2"==o[0].nextHopProtocol):!!(A1.g&&A1.g.Ea&&A1.g.Ea()&&A1.g.Ea().Zb),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(TI=yZ.prototype).add=function(o,e){G8(this),this.i=null,o=EK(this,o);var i=this.g.get(o);return i||this.g.set(o,i=[]),i.push(e),this.h+=1,this},TI.forEach=function(o,e){G8(this),this.g.forEach(function(i,d){UL(i,function(_){o.call(e,_,d,this)},this)},this)},TI.T=function(){G8(this);for(var o=this.g.R(),e=this.g.T(),i=[],d=0;d<e.length;d++)for(var _=o[d],B=0;B<_.length;B++)i.push(e[d]);return i},TI.R=function(o){G8(this);var e=[];if("string"==typeof o)Oce(this,o)&&(e=Sfe(e,this.g.get(EK(this,o))));else{o=this.g.R();for(var i=0;i<o.length;i++)e=Sfe(e,o[i])}return e},TI.set=function(o,e){return G8(this),this.i=null,Oce(this,o=EK(this,o))&&(this.h-=this.g.get(o).length),this.g.set(o,[e]),this.h+=1,this},TI.get=function(o,e){return o&&0<(o=this.R(o)).length?String(o[0]):e},TI.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var o=[],e=this.g.T(),i=0;i<e.length;i++){var d=e[i],_=encodeURIComponent(String(d));d=this.R(d);for(var B=0;B<d.length;B++){var _t=_;""!==d[B]&&(_t+="="+encodeURIComponent(String(d[B]))),o.push(_t)}}return this.i=o.join("&")};var L_e=10;function Wfe(o){return!!o.h||!!o.g&&o.g.size>=o.j}function Kfe(o){return o.h?1:o.g?o.g.size:0}function vre(o,e){return o.h?o.h==e:!!o.g&&o.g.has(e)}function Dce(o,e){o.g?o.g.add(e):o.h=e}function zfe(o,e){o.h&&o.h==e?o.h=null:o.g&&o.g.has(e)&&o.g.delete(e)}function Yfe(o){if(null!=o.h)return o.i.concat(o.h.D);if(null!=o.g&&0!==o.g.size){let e=o.i;for(const i of o.g.values())e=e.concat(i.D);return e}return B8(o.i)}function Nce(){}function Jfe(){this.g=new Nce}function M_e(o,e,i){const d=i||"";try{_Z(o,function(_,B){let _t=_;dZ(_)&&(_t=_ce(_)),e.push(d+B+"="+encodeURIComponent(_t))})}catch(_){throw e.push(d+"type="+encodeURIComponent("_badmap")),_}}function yre(o,e,i,d,_){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,_(d)}catch(B){}}function EZ(o){this.l=o.$b||null,this.j=o.ib||!1}function IZ(o,e){iO.call(this),this.D=o,this.u=e,this.m=void 0,this.readyState=IK,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}qfe.prototype.cancel=function(){if(this.i=Yfe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const o of this.g.values())o.cancel();this.g.clear()}},Nce.prototype.stringify=function(o){return A1.JSON.stringify(o,void 0)},Nce.prototype.parse=function(o){return A1.JSON.parse(o,void 0)},v0(EZ,_re),EZ.prototype.g=function(){return new IZ(this.l,this.j)},EZ.prototype.i=function(o){return function(){return o}}({}),v0(IZ,iO);var IK=0;function Ere(o){o.j.read().then(o.Sa.bind(o)).catch(o.ha.bind(o))}function DQ(o){o.readyState=4,o.l=null,o.j=null,o.A=null,bZ(o)}function bZ(o){o.onreadystatechange&&o.onreadystatechange.call(o)}(TI=IZ.prototype).open=function(o,e){if(this.readyState!=IK)throw this.abort(),Error("Error reopening a connection");this.C=o,this.B=e,this.readyState=1,bZ(this)},TI.send=function(o){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};o&&(e.body=o),(this.D||A1).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},TI.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,DQ(this)),this.readyState=IK},TI.Va=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,bZ(this)),this.g&&(this.readyState=3,bZ(this),this.g)))if("arraybuffer"===this.responseType)o.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==A1.ReadableStream&&"body"in o){if(this.j=o.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Ere(this)}else o.text().then(this.Ua.bind(this),this.ha.bind(this))},TI.Sa=function(o){if(this.g){if(this.u&&o.value)this.response.push(o.value);else if(!this.u){var e=o.value?o.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!o.done}))&&(this.response=this.responseText+=e)}o.done?DQ(this):bZ(this),3==this.readyState&&Ere(this)}},TI.Ua=function(o){this.g&&(this.response=this.responseText=o,DQ(this))},TI.Ta=function(o){this.g&&(this.response=o,DQ(this))},TI.ha=function(){this.g&&DQ(this)},TI.setRequestHeader=function(o,e){this.v.append(o,e)},TI.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},TI.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],e=this.h.entries();for(var i=e.next();!i.done;)o.push((i=i.value)[0]+": "+i[1]),i=e.next();return o.join("\r\n")},Object.defineProperty(IZ.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(o){this.m=o?"include":"same-origin"}});var $fe=A1.JSON.parse;function NR(o){iO.call(this),this.headers=new FL,this.u=o||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=kce,this.K=this.L=!1}v0(NR,iO);var kce="",Pce=/^https?$/i,Ire=["POST","PUT"];function F_e(o){return"content-type"==o.toLowerCase()}function CZ(o,e){o.h=!1,o.g&&(o.l=!0,o.g.abort(),o.l=!1),o.j=e,o.m=5,xce(o),wZ(o)}function xce(o){o.D||(o.D=!0,l1(o,"complete"),l1(o,"error"))}function Zfe(o){if(o.h&&void 0!==GO&&(!o.C[1]||4!=S6(o)||2!=o.ba()))if(o.v&&4==S6(o))XU(o.Fa,0,o);else if(l1(o,"readystatechange"),4==S6(o)){o.h=!1;try{const _a=o.ba();e:switch(_a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var i;if(!(i=e)){var d;if(d=0===_a){var _=String(o.H).match(Rce)[1]||null;if(!_&&A1.self&&A1.self.location){var B=A1.self.location.protocol;_=B.substr(0,B.length-1)}d=!Pce.test(_?_.toLowerCase():"")}i=d}if(i)l1(o,"complete"),l1(o,"success");else{o.m=6;try{var _t=2<S6(o)?o.g.statusText:""}catch(_h){_t=""}o.j=_t+" ["+o.ba()+"]",xce(o)}}finally{wZ(o)}}}function wZ(o,e){if(o.g){Xfe(o);const i=o.g,d=o.C[0]?aS:null;o.g=null,o.C=null,e||l1(o,"ready");try{i.onreadystatechange=d}catch(_){}}}function Xfe(o){o.g&&o.K&&(o.g.ontimeout=null),o.A&&(A1.clearTimeout(o.A),o.A=null)}function S6(o){return o.g?o.g.readyState:0}function epe(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.J){case kce:case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch(e){return null}}function bre(o,e,i){e:{for(d in i){var d=!1;break e}d=!0}d||(i=function j_e(o){let e="";return ace(o,function(i,d){e+=d,e+=":",e+=i,e+="\r\n"}),e}(i),"string"==typeof o?null!=i&&encodeURIComponent(String(i)):U0(o,e,i))}function TZ(o,e,i){return i&&i.internalChannelParams&&i.internalChannelParams[o]||e}function Lce(o){this.za=0,this.l=[],this.h=new gS,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=TZ("failFast",!1,o),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=TZ("baseRetryDelayMs",5e3,o),this.$a=TZ("retryDelaySeedMs",1e4,o),this.Ya=TZ("forwardChannelMaxRetries",2,o),this.ra=TZ("forwardChannelRequestTimeoutMs",2e4,o),this.qa=o&&o.xmlHttpFactory||void 0,this.Ba=o&&o.Yb||!1,this.K=void 0,this.H=o&&o.supportsCrossDomainXhr||!1,this.J="",this.i=new qfe(o&&o.concurrentRequestLimit),this.Ca=new Jfe,this.ja=o&&o.fastHandshake||!1,this.Ra=o&&o.Wb||!1,o&&o.Aa&&this.h.Aa(),o&&o.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&o&&o.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!o||!1!==o.Xb}function Q8(o){if(Cre(o),3==o.G){var e=o.V++,i=AT(o.F);U0(i,"SID",o.J),U0(i,"RID",e),U0(i,"TYPE","terminate"),U4(o,i),(e=new RQ(o,o.h,e,void 0)).K=2,e.v=EN(AT(i)),i=!1,A1.navigator&&A1.navigator.sendBeacon&&(i=A1.navigator.sendBeacon(e.v.toString(),"")),!i&&A1.Image&&((new Image).src=e.v,i=!0),i||(e.g=Vce(e.l,null),e.g.ea(e.v)),e.F=Date.now(),xM(e)}Fce(o)}function SZ(o){o.g&&(Bce(o),o.g.cancel(),o.g=null)}function Cre(o){SZ(o),o.u&&(A1.clearTimeout(o.u),o.u=null),Tre(o),o.i.cancel(),o.m&&("number"==typeof o.m&&A1.clearTimeout(o.m),o.m=null)}function Mce(o,e){o.l.push(new class{constructor(o,e){this.h=o,this.g=e}}(o.Za++,e)),3==o.G&&RZ(o)}function RZ(o){Wfe(o.i)||o.m||(o.m=!0,yce(o.Ha,o),o.C=0)}function LM(o,e){var i;i=e?e.m:o.V++;const d=AT(o.F);U0(d,"SID",o.J),U0(d,"RID",i),U0(d,"AID",o.U),U4(o,d),o.o&&o.s&&bre(d,o.o,o.s),i=new RQ(o,o.h,i,o.C+1),null===o.o&&(i.H=o.s),e&&(o.l=e.D.concat(o.l)),e=F4(o,i,1e3),i.setTimeout(Math.round(.5*o.ra)+Math.round(.5*o.ra*Math.random())),Dce(o.i,i),mT(i,d,e)}function U4(o,e){o.j&&_Z({},function(i,d){U0(e,d,i)})}function F4(o,e,i){i=Math.min(o.l.length,i);var d=o.j?nO(o.j.Oa,o.j,o):null;e:{var _=o.l;let B=-1;for(;;){const _t=["count="+i];-1==B?0<i?(B=_[0].h,_t.push("ofs="+B)):B=0:_t.push("ofs="+B);let _a=!0;for(let _h=0;_h<i;_h++){let _g=_[_h].h;const l_=_[_h].g;if(_g-=B,0>_g)B=Math.max(0,_[_h].h-100),_a=!1;else try{M_e(l_,_t,"req"+_g+"_")}catch(f_){d&&d(l_)}}if(_a){d=_t.join("&");break e}}}return o=o.l.splice(0,i),e.D=o,d}function H8(o){o.g||o.u||(o.Y=1,yce(o.Ga,o),o.A=0)}function wre(o){return!(o.g||o.u||3<=o.A||(o.Y++,o.u=mK(nO(o.Ga,o),Uce(o,o.A)),o.A++,0))}function Bce(o){null!=o.B&&(A1.clearTimeout(o.B),o.B=null)}function OZ(o){o.g=new RQ(o,o.h,"rpc",o.Y),null===o.o&&(o.g.H=o.s),o.g.O=0;var e=AT(o.oa);U0(e,"RID","rpc"),U0(e,"SID",o.J),U0(e,"CI",o.N?"0":"1"),U0(e,"AID",o.U),U4(o,e),U0(e,"TYPE","xmlhttp"),o.o&&o.s&&bre(e,o.o,o.s),o.K&&o.g.setTimeout(o.K);var i=o.g;o=o.la,i.K=1,i.v=EN(AT(e)),i.s=null,i.U=!0,Tce(i,o)}function Tre(o){null!=o.v&&(A1.clearTimeout(o.v),o.v=null)}function tpe(o,e){var i=null;if(o.g==e){Tre(o),Bce(o),o.g=null;var d=2}else{if(!vre(o.i,e))return;i=e.D,zfe(o.i,e),d=1}if(o.I=e.N,0!=o.G)if(e.i)if(1==d){i=e.s?e.s.length:0,e=Date.now()-e.F;var _=o.C;l1(d=AZ(),new bce(d,i,e,_)),RZ(o)}else H8(o);else if(3==(_=e.o)||0==_&&0<o.I||!(1==d&&function e3(o,e){return!(Kfe(o.i)>=o.i.j-(o.m?1:0)||(o.m?(o.l=e.D.concat(o.l),0):1==o.G||2==o.G||o.C>=(o.Xa?0:o.Ya)||(o.m=mK(nO(o.Ha,o,e),Uce(o,o.C)),o.C++,0)))}(o,e)||2==d&&wre(o)))switch(i&&0<i.length&&(e=o.i,e.i=e.i.concat(i)),_){case 1:q8(o,5);break;case 4:q8(o,10);break;case 3:q8(o,6);break;default:q8(o,2)}}function Uce(o,e){let i=o.Pa+Math.floor(Math.random()*o.$a);return o.j||(i*=2),i*e}function q8(o,e){if(o.h.info("Error code "+e),2==e){var i=null;o.j&&(i=null);var d=nO(o.jb,o);i||(i=new OQ("//www.google.com/images/cleardot.gif"),A1.location&&"http"==A1.location.protocol||vK(i,"https"),EN(i)),function B_e(o,e){const i=new gS;if(A1.Image){const d=new Image;d.onload=SR(yre,i,d,"TestLoadImage: loaded",!0,e),d.onerror=SR(yre,i,d,"TestLoadImage: error",!1,e),d.onabort=SR(yre,i,d,"TestLoadImage: abort",!1,e),d.ontimeout=SR(yre,i,d,"TestLoadImage: timeout",!1,e),A1.setTimeout(function(){d.ontimeout&&d.ontimeout()},1e4),d.src=o}else e(!1)}(i.toString(),d)}else vN(2);o.G=0,o.j&&o.j.va(e),Fce(o),Cre(o)}function Fce(o){o.G=0,o.I=-1,o.j&&((0!=Yfe(o.i).length||0!=o.l.length)&&(o.i.i.length=0,B8(o.l),o.l.length=0),o.j.ua())}function jce(o,e,i){let d=function I1(o){return o instanceof OQ?AT(o):new OQ(o,void 0)}(i);if(""!=d.i)e&&V8(d,e+"."+d.i),vZ(d,d.m);else{const _=A1.location;d=function eP(o,e,i,d){var _=new OQ(null,void 0);return o&&vK(_,o),e&&V8(_,e),i&&vZ(_,i),d&&(_.l=d),_}(_.protocol,e?e+"."+_.hostname:_.hostname,+_.port,i)}return o.aa&&ace(o.aa,function(_,B){U0(d,B,_)}),i=o.sa,(e=o.D)&&i&&U0(d,e,i),U0(d,"VER",o.ma),U4(o,d),d}function Vce(o,e,i){if(e&&!o.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new NR(i&&o.Ba&&!o.qa?new EZ({ib:!0}):o.qa)).L=o.H,e}function Gce(){}function Sre(){if(dK&&!(10<=Number(pce)))throw Error("Environmental error: no available transport.")}function jL(o,e){iO.call(this),this.g=new Lce(e),this.l=o,this.h=e&&e.messageUrlParams||null,o=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.s=o,o=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(o?o["X-WebChannel-Content-Type"]=e.messageContentType:o={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(o?o["X-WebChannel-Client-Profile"]=e.ya:o={"X-WebChannel-Client-Profile":e.ya}),this.g.P=o,(o=e&&e.httpHeadersOverwriteParam)&&!U8(o)&&(this.g.o=o),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!U8(e)&&(this.g.D=e,null!==(o=this.h)&&e in o&&e in(o=this.h)&&delete o[e]),this.j=new VL(this)}function DZ(o){UT.call(this);var e=o.__sm__;if(e){e:{for(const i in e){o=i;break e}o=void 0}(this.i=o)&&(o=this.i,e=null!==e&&o in e?e[o]:void 0),this.data=e}else this.data=o}function R6(){B4.call(this),this.status=1}function VL(o){this.g=o}(TI=NR.prototype).ea=function(o,e,i,d){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+o);e=e?e.toUpperCase():"GET",this.H=o,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():wce.g(),this.C=function Ffe(o){return o.h||(o.h=o.i())}(this.u?this.u:wce),this.g.onreadystatechange=nO(this.Fa,this);try{this.F=!0,this.g.open(e,String(o),!0),this.F=!1}catch(B){return void CZ(this,B)}o=i||"";const _=new FL(this.headers);d&&_Z(d,function(B,_t){_.set(_t,B)}),d=function ice(o){e:{var e=F_e;const i=o.length,d="string"==typeof o?o.split(""):o;for(let _=0;_<i;_++)if(_ in d&&e.call(void 0,d[_],_,o)){e=_;break e}e=-1}return 0>e?null:"string"==typeof o?o.charAt(e):o[e]}(_.T()),i=A1.FormData&&o instanceof A1.FormData,!(0<=s1(Ire,e))||d||i||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),_.forEach(function(B,_t){this.g.setRequestHeader(_t,B)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Xfe(this),0<this.B&&((this.K=function U_e(o){return dK&&function S_e(){return function C_e(o){var e=T_e;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=o(9)}(function(){let o=0;const e=Rfe(String(hZ)).split("."),i=Rfe("9").split("."),d=Math.max(e.length,i.length);for(let _t=0;0==o&&_t<d;_t++){var _=e[_t]||"",B=i[_t]||"";do{if(_=/(\d*)(\D*)(.*)/.exec(_)||["","","",""],B=/(\d*)(\D*)(.*)/.exec(B)||["","","",""],0==_[0].length&&0==B[0].length)break;o=oce(0==_[1].length?0:parseInt(_[1],10),0==B[1].length?0:parseInt(B[1],10))||oce(0==_[2].length,0==B[2].length)||oce(_[2],B[2]),_=_[3],B=B[3]}while(0==o)}return 0<=o})}()&&"number"==typeof o.timeout&&void 0!==o.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=nO(this.pa,this)):this.A=XU(this.pa,this.B,this)),this.v=!0,this.g.send(o),this.v=!1}catch(B){CZ(this,B)}},TI.pa=function(){void 0!==GO&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,l1(this,"timeout"),this.abort(8))},TI.abort=function(o){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=o||7,l1(this,"complete"),l1(this,"abort"),wZ(this))},TI.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),wZ(this,!0)),NR.Z.M.call(this)},TI.Fa=function(){this.s||(this.F||this.v||this.l?Zfe(this):this.cb())},TI.cb=function(){Zfe(this)},TI.ba=function(){try{return 2<S6(this)?this.g.status:-1}catch(o){return-1}},TI.ga=function(){try{return this.g?this.g.responseText:""}catch(o){return""}},TI.Qa=function(o){if(this.g){var e=this.g.responseText;return o&&0==e.indexOf(o)&&(e=e.substring(o.length)),$fe(e)}},TI.Da=function(){return this.m},TI.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(TI=Lce.prototype).ma=8,TI.G=1,TI.hb=function(o){try{this.h.info("Origin Trials invoked: "+o)}catch(e){}},TI.Ha=function(o){if(this.m)if(this.m=null,1==this.G){if(!o){this.V=Math.floor(1e5*Math.random()),o=this.V++;const _=new RQ(this,this.h,o,void 0);let B=this.s;if(this.P&&(B?(B=Dfe(B),cre(B,this.P)):B=this.P),null===this.o&&(_.H=B),this.ja)e:{for(var e=0,i=0;i<this.l.length;i++){var d=this.l[i];if(void 0===(d="__data__"in d.g&&"string"==typeof(d=d.g.__data__)?d.length:void 0))break;if(4096<(e+=d)){e=i;break e}if(4096===e||i===this.l.length-1){e=i+1;break e}}e=1e3}else e=1e3;e=F4(this,_,e),U0(i=AT(this.F),"RID",o),U0(i,"CVER",22),this.D&&U0(i,"X-HTTP-Session-Id",this.D),U4(this,i),this.o&&B&&bre(i,this.o,B),Dce(this.i,_),this.Ra&&U0(i,"TYPE","init"),this.ja?(U0(i,"$req",e),U0(i,"SID","null"),_.$=!0,mT(_,i,null)):mT(_,i,e),this.G=2}}else 3==this.G&&(o?LM(this,o):0==this.l.length||Wfe(this.i)||LM(this))},TI.Ga=function(){if(this.u=null,OZ(this),this.$&&!(this.L||null==this.g||0>=this.O)){var o=2*this.O;this.h.info("BP detection timer enabled: "+o),this.B=mK(nO(this.bb,this),o)}},TI.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,vN(10),SZ(this),OZ(this))},TI.ab=function(){null!=this.v&&(this.v=null,SZ(this),wre(this),vN(19))},TI.jb=function(o){o?(this.h.info("Successfully pinged google.com"),vN(2)):(this.h.info("Failed to ping google.com"),vN(1))},(TI=Gce.prototype).xa=function(){},TI.wa=function(){},TI.va=function(){},TI.ua=function(){},TI.Oa=function(){},Sre.prototype.g=function(o,e){return new jL(o,e)},v0(jL,iO),jL.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var o=this.g,e=this.l,i=this.h||void 0;o.Wa&&(o.h.info("Origin Trials enabled."),yce(nO(o.hb,o,e))),vN(0),o.W=e,o.aa=i||{},o.N=o.X,o.F=jce(o,null,o.W),RZ(o)},jL.prototype.close=function(){Q8(this.g)},jL.prototype.u=function(o){if("string"==typeof o){var e={};e.__data__=o,Mce(this.g,e)}else this.v?((e={}).__data__=_ce(o),Mce(this.g,e)):Mce(this.g,o)},jL.prototype.M=function(){this.g.j=null,delete this.j,Q8(this.g),delete this.g,jL.Z.M.call(this)},v0(DZ,UT),v0(R6,B4),v0(VL,Gce),VL.prototype.xa=function(){l1(this.g,"a")},VL.prototype.wa=function(o){l1(this.g,new DZ(o))},VL.prototype.va=function(o){l1(this.g,new R6(o))},VL.prototype.ua=function(){l1(this.g,"b")},Sre.prototype.createWebChannel=Sre.prototype.g,jL.prototype.send=jL.prototype.u,jL.prototype.open=jL.prototype.m,jL.prototype.close=jL.prototype.close,AK.NO_ERROR=0,AK.TIMEOUT=8,AK.HTTP_ERROR=6,Are.COMPLETE="complete",Cce.EventType=p1,p1.OPEN="a",p1.CLOSE="b",p1.ERROR="c",p1.MESSAGE="d",iO.prototype.listen=iO.prototype.N,NR.prototype.listenOnce=NR.prototype.O,NR.prototype.getLastError=NR.prototype.La,NR.prototype.getLastErrorCode=NR.prototype.Da,NR.prototype.getStatus=NR.prototype.ba,NR.prototype.getResponseJson=NR.prototype.Qa,NR.prototype.getResponseText=NR.prototype.ga,NR.prototype.send=NR.prototype.ea;var npe=ZU.createWebChannelTransport=function(){return new Sre},Qce=ZU.getStatEventTarget=function(){return AZ()},Rre=ZU.ErrorCode=AK,rpe=ZU.EventType=Are,Ore=ZU.Event=hR,Hce=ZU.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Dre=ZU.FetchXmlHttpFactory=EZ,Nre=ZU.WebChannel=Cce,qce=ZU.XhrIo=NR;const ipe="@firebase/firestore";class qO{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}qO.UNAUTHENTICATED=new qO(null),qO.GOOGLE_CREDENTIALS=new qO("google-credentials-uid"),qO.FIRST_PARTY=new qO("first-party-uid"),qO.MOCK_USER=new qO("mock-user");let NQ="9.8.0";const W8=new QP.Yd("@firebase/firestore");function Wce(){return W8.logLevel}function nI(o,...e){if(W8.logLevel<=QP.in.DEBUG){const i=e.map(zce);W8.debug(`Firestore (${NQ}): ${o}`,...i)}}function kR(o,...e){if(W8.logLevel<=QP.in.ERROR){const i=e.map(zce);W8.error(`Firestore (${NQ}): ${o}`,...i)}}function bK(o,...e){if(W8.logLevel<=QP.in.WARN){const i=e.map(zce);W8.warn(`Firestore (${NQ}): ${o}`,...i)}}function zce(o){if("string"==typeof o)return o;try{return JSON.stringify(o)}catch(i){return o}}function PI(o="Unexpected state"){const e=`FIRESTORE (${NQ}) INTERNAL ASSERTION FAILED: `+o;throw kR(e),new Error(e)}function QI(o,e){o||PI()}function pI(o,e){return o}const T0={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class W0 extends M_.ZR{constructor(e,i){super(e,i),this.code=e,this.message=i,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class sO{constructor(){this.promise=new Promise((e,i)=>{this.resolve=e,this.reject=i})}}class c2{constructor(e,i){this.user=i,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ope{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,i){e.enqueueRetryable(()=>i(qO.UNAUTHENTICATED))}shutdown(){}}class Yce{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,i){this.changeListener=i,e.enqueueRetryable(()=>i(this.token.user))}shutdown(){this.changeListener=null}}class kQ{constructor(e){this.t=e,this.currentUser=qO.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,i){var d=this;let _=this.i;const B=_g=>this.i!==_?(_=this.i,i(_g)):Promise.resolve();let _t=new sO;this.o=()=>{this.i++,this.currentUser=this.u(),_t.resolve(),_t=new sO,e.enqueueRetryable(()=>B(this.currentUser))};const _a=()=>{const _g=_t;e.enqueueRetryable((0,C0.Z)(function*(){yield _g.promise,yield B(d.currentUser)}))},_h=_g=>{nI("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=_g,this.auth.addAuthTokenListener(this.o),_a()};this.t.onInit(_g=>_h(_g)),setTimeout(()=>{if(!this.auth){const _g=this.t.getImmediate({optional:!0});_g?_h(_g):(nI("FirebaseAuthCredentialsProvider","Auth not yet detected"),_t.resolve(),_t=new sO)}},0),_a()}getToken(){const e=this.i,i=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(i).then(d=>this.i!==e?(nI("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):d?(QI("string"==typeof d.accessToken),new c2(d.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return QI(null===e||"string"==typeof e),new qO(e)}}class Jce{constructor(e,i,d){this.type="FirstParty",this.user=qO.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",i);const _=e.auth.getAuthHeaderValueForFirstParty([]);_&&this.headers.set("Authorization",_),d&&this.headers.set("X-Goog-Iam-Authorization-Token",d)}}class V_e{constructor(e,i,d){this.h=e,this.l=i,this.m=d}getToken(){return Promise.resolve(new Jce(this.h,this.l,this.m))}start(e,i){e.enqueueRetryable(()=>i(qO.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class kre{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $ce{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,i){const d=B=>{null!=B.error&&nI("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${B.error.message}`);const _t=B.token!==this.p;return this.p=B.token,nI("FirebaseAppCheckTokenProvider",`Received ${_t?"new":"existing"} token.`),_t?i(B.token):Promise.resolve()};this.o=B=>{e.enqueueRetryable(()=>d(B))};const _=B=>{nI("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=B,this.appCheck.addTokenListener(this.o)};this.g.onInit(B=>_(B)),setTimeout(()=>{if(!this.appCheck){const B=this.g.getImmediate({optional:!0});B?_(B):nI("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(i=>i?(QI("string"==typeof i.token),this.p=i.token,new kre(i.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class GL{constructor(e,i){this.previousValue=e,i&&(i.sequenceNumberHandler=d=>this.I(d),this.T=d=>i.writeSequenceNumber(d))}I(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.T&&this.T(e),e}}function Zce(o){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),i=new Uint8Array(o);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(i);else for(let d=0;d<o;d++)i[d]=Math.floor(256*Math.random());return i}GL.A=-1;class PQ{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=Math.floor(256/e.length)*e.length;let d="";for(;d.length<20;){const _=Zce(40);for(let B=0;B<_.length;++B)d.length<20&&_[B]<i&&(d+=e.charAt(_[B]%e.length))}return d}}function R1(o,e){return o<e?-1:o>e?1:0}function xQ(o,e,i){return o.length===e.length&&o.every((d,_)=>i(d,e[_]))}function NZ(o){return o+"\0"}class XS{constructor(e,i){if(this.seconds=e,this.nanoseconds=i,i<0)throw new W0(T0.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(i>=1e9)throw new W0(T0.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(e<-62135596800)throw new W0(T0.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new W0(T0.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return XS.fromMillis(Date.now())}static fromDate(e){return XS.fromMillis(e.getTime())}static fromMillis(e){const i=Math.floor(e/1e3),d=Math.floor(1e6*(e-1e3*i));return new XS(i,d)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?R1(this.nanoseconds,e.nanoseconds):R1(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class a1{constructor(e){this.timestamp=e}static fromTimestamp(e){return new a1(e)}static min(){return new a1(new XS(0,0))}static max(){return new a1(new XS(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function Xce(o){let e=0;for(const i in o)Object.prototype.hasOwnProperty.call(o,i)&&e++;return e}function u2(o,e){for(const i in o)Object.prototype.hasOwnProperty.call(o,i)&&e(i,o[i])}function MM(o){for(const e in o)if(Object.prototype.hasOwnProperty.call(o,e))return!1;return!0}class kZ{constructor(e,i,d){void 0===i?i=0:i>e.length&&PI(),void 0===d?d=e.length-i:d>e.length-i&&PI(),this.segments=e,this.offset=i,this.len=d}get length(){return this.len}isEqual(e){return 0===kZ.comparator(this,e)}child(e){const i=this.segments.slice(this.offset,this.limit());return e instanceof kZ?e.forEach(d=>{i.push(d)}):i.push(e),this.construct(i)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==e.get(i))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==e.get(i))return!1;return!0}forEach(e){for(let i=this.offset,d=this.limit();i<d;i++)e(this.segments[i])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,i){const d=Math.min(e.length,i.length);for(let _=0;_<d;_++){const B=e.get(_),_t=i.get(_);if(B<_t)return-1;if(B>_t)return 1}return e.length<i.length?-1:e.length>i.length?1:0}}class eT extends kZ{construct(e,i,d){return new eT(e,i,d)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const i=[];for(const d of e){if(d.indexOf("//")>=0)throw new W0(T0.INVALID_ARGUMENT,`Invalid segment (${d}). Paths must not contain // in them.`);i.push(...d.split("/").filter(_=>_.length>0))}return new eT(i)}static emptyPath(){return new eT([])}}const spe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class PR extends kZ{construct(e,i,d){return new PR(e,i,d)}static isValidIdentifier(e){return spe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),PR.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new PR(["__name__"])}static fromServerFormat(e){const i=[];let d="",_=0;const B=()=>{if(0===d.length)throw new W0(T0.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);i.push(d),d=""};let _t=!1;for(;_<e.length;){const _a=e[_];if("\\"===_a){if(_+1===e.length)throw new W0(T0.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const _h=e[_+1];if("\\"!==_h&&"."!==_h&&"`"!==_h)throw new W0(T0.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);d+=_h,_+=2}else"`"===_a?(_t=!_t,_++):"."!==_a||_t?(d+=_a,_++):(B(),_++)}if(B(),_t)throw new W0(T0.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new PR(i)}static emptyPath(){return new PR([])}}class K8{constructor(e){this.fields=e,e.sort(PR.comparator)}covers(e){for(const i of this.fields)if(i.isPrefixOf(e))return!0;return!1}isEqual(e){return xQ(this.fields,e.fields,(i,d)=>i.isEqual(d))}}class aO{constructor(e){this.binaryString=e}static fromBase64String(e){const i=atob(e);return new aO(i)}static fromUint8Array(e){const i=function(d){let _="";for(let B=0;B<d.length;++B)_+=String.fromCharCode(d[B]);return _}(e);return new aO(i)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const i=new Uint8Array(e.length);for(let d=0;d<e.length;d++)i[d]=e.charCodeAt(d);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return R1(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}aO.EMPTY_BYTE_STRING=new aO("");const D6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function j4(o){if(QI(!!o),"string"==typeof o){let e=0;const i=D6.exec(o);if(QI(!!i),i[1]){let _=i[1];_=(_+"000000000").substr(0,9),e=Number(_)}const d=new Date(o);return{seconds:Math.floor(d.getTime()/1e3),nanos:e}}return{seconds:eR(o.seconds),nanos:eR(o.nanos)}}function eR(o){return"number"==typeof o?o:"string"==typeof o?Number(o):0}function QL(o){return"string"==typeof o?aO.fromBase64String(o):aO.fromUint8Array(o)}function Pre(o){var e,i;return"server_timestamp"===(null===(i=((null===(e=null==o?void 0:o.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===i?void 0:i.stringValue)}function xre(o){const e=o.mapValue.fields.__previous_value__;return Pre(e)?xre(e):e}function PZ(o){const e=j4(o.mapValue.fields.__local_write_time__.timestampValue);return new XS(e.seconds,e.nanos)}class G_e{constructor(e,i,d,_,B,_t,_a,_h){this.databaseId=e,this.appId=i,this.persistenceKey=d,this.host=_,this.ssl=B,this.forceLongPolling=_t,this.autoDetectLongPolling=_a,this.useFetchStreams=_h}}class N6{constructor(e,i){this.projectId=e,this.database=i||"(default)"}static empty(){return new N6("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof N6&&e.projectId===this.projectId&&e.database===this.database}}function t3(o){return null==o}function xZ(o){return 0===o&&1/o==-1/0}function ape(o){return"number"==typeof o&&Number.isInteger(o)&&!xZ(o)&&o<=Number.MAX_SAFE_INTEGER&&o>=Number.MIN_SAFE_INTEGER}class fI{constructor(e){this.path=e}static fromPath(e){return new fI(eT.fromString(e))}static fromName(e){return new fI(eT.fromString(e).popFirst(5))}static empty(){return new fI(eT.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===eT.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,i){return eT.comparator(e.path,i.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new fI(new eT(e.slice()))}}const z8={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Lre={nullValue:"NULL_VALUE"};function LQ(o){return"nullValue"in o?0:"booleanValue"in o?1:"integerValue"in o||"doubleValue"in o?2:"timestampValue"in o?3:"stringValue"in o?5:"bytesValue"in o?6:"referenceValue"in o?7:"geoPointValue"in o?8:"arrayValue"in o?9:"mapValue"in o?Pre(o)?4:dpe(o)?9007199254740991:10:PI()}function V4(o,e){if(o===e)return!0;const i=LQ(o);if(i!==LQ(e))return!1;switch(i){case 0:case 9007199254740991:return!0;case 1:return o.booleanValue===e.booleanValue;case 4:return PZ(o).isEqual(PZ(e));case 3:return function(d,_){if("string"==typeof d.timestampValue&&"string"==typeof _.timestampValue&&d.timestampValue.length===_.timestampValue.length)return d.timestampValue===_.timestampValue;const B=j4(d.timestampValue),_t=j4(_.timestampValue);return B.seconds===_t.seconds&&B.nanos===_t.nanos}(o,e);case 5:return o.stringValue===e.stringValue;case 6:return _=e,QL(o.bytesValue).isEqual(QL(_.bytesValue));case 7:return o.referenceValue===e.referenceValue;case 8:return function(d,_){return eR(d.geoPointValue.latitude)===eR(_.geoPointValue.latitude)&&eR(d.geoPointValue.longitude)===eR(_.geoPointValue.longitude)}(o,e);case 2:return function(d,_){if("integerValue"in d&&"integerValue"in _)return eR(d.integerValue)===eR(_.integerValue);if("doubleValue"in d&&"doubleValue"in _){const B=eR(d.doubleValue),_t=eR(_.doubleValue);return B===_t?xZ(B)===xZ(_t):isNaN(B)&&isNaN(_t)}return!1}(o,e);case 9:return xQ(o.arrayValue.values||[],e.arrayValue.values||[],V4);case 10:return function(d,_){const B=d.mapValue.fields||{},_t=_.mapValue.fields||{};if(Xce(B)!==Xce(_t))return!1;for(const _a in B)if(B.hasOwnProperty(_a)&&(void 0===_t[_a]||!V4(B[_a],_t[_a])))return!1;return!0}(o,e);default:return PI()}var _}function LZ(o,e){return void 0!==(o.values||[]).find(i=>V4(i,e))}function k6(o,e){if(o===e)return 0;const i=LQ(o),d=LQ(e);if(i!==d)return R1(i,d);switch(i){case 0:case 9007199254740991:return 0;case 1:return R1(o.booleanValue,e.booleanValue);case 2:return function(_,B){const _t=eR(_.integerValue||_.doubleValue),_a=eR(B.integerValue||B.doubleValue);return _t<_a?-1:_t>_a?1:_t===_a?0:isNaN(_t)?isNaN(_a)?0:-1:1}(o,e);case 3:return cpe(o.timestampValue,e.timestampValue);case 4:return cpe(PZ(o),PZ(e));case 5:return R1(o.stringValue,e.stringValue);case 6:return function(_,B){const _t=QL(_),_a=QL(B);return _t.compareTo(_a)}(o.bytesValue,e.bytesValue);case 7:return function(_,B){const _t=_.split("/"),_a=B.split("/");for(let _h=0;_h<_t.length&&_h<_a.length;_h++){const _g=R1(_t[_h],_a[_h]);if(0!==_g)return _g}return R1(_t.length,_a.length)}(o.referenceValue,e.referenceValue);case 8:return function(_,B){const _t=R1(eR(_.latitude),eR(B.latitude));return 0!==_t?_t:R1(eR(_.longitude),eR(B.longitude))}(o.geoPointValue,e.geoPointValue);case 9:return function(_,B){const _t=_.values||[],_a=B.values||[];for(let _h=0;_h<_t.length&&_h<_a.length;++_h){const _g=k6(_t[_h],_a[_h]);if(_g)return _g}return R1(_t.length,_a.length)}(o.arrayValue,e.arrayValue);case 10:return function(_,B){if(_===z8.mapValue&&B===z8.mapValue)return 0;if(_===z8.mapValue)return 1;if(B===z8.mapValue)return-1;const _t=_.fields||{},_a=Object.keys(_t),_h=B.fields||{},_g=Object.keys(_h);_a.sort(),_g.sort();for(let l_=0;l_<_a.length&&l_<_g.length;++l_){const f_=R1(_a[l_],_g[l_]);if(0!==f_)return f_;const R_=k6(_t[_a[l_]],_h[_g[l_]]);if(0!==R_)return R_}return R1(_a.length,_g.length)}(o.mapValue,e.mapValue);default:throw PI()}}function cpe(o,e){if("string"==typeof o&&"string"==typeof e&&o.length===e.length)return R1(o,e);const i=j4(o),d=j4(e),_=R1(i.seconds,d.seconds);return 0!==_?_:R1(i.nanos,d.nanos)}function wK(o){return eue(o)}function eue(o){return"nullValue"in o?"null":"booleanValue"in o?""+o.booleanValue:"integerValue"in o?""+o.integerValue:"doubleValue"in o?""+o.doubleValue:"timestampValue"in o?function(d){const _=j4(d);return`time(${_.seconds},${_.nanos})`}(o.timestampValue):"stringValue"in o?o.stringValue:"bytesValue"in o?QL(o.bytesValue).toBase64():"referenceValue"in o?fI.fromName(o.referenceValue).toString():"geoPointValue"in o?`geo(${(e=o.geoPointValue).latitude},${e.longitude})`:"arrayValue"in o?function(d){let _="[",B=!0;for(const _t of d.values||[])B?B=!1:_+=",",_+=eue(_t);return _+"]"}(o.arrayValue):"mapValue"in o?function(d){const _=Object.keys(d.fields||{}).sort();let B="{",_t=!0;for(const _a of _)_t?_t=!1:B+=",",B+=`${_a}:${eue(d.fields[_a])}`;return B+"}"}(o.mapValue):PI();var e}function MQ(o,e){return{referenceValue:`projects/${o.projectId}/databases/${o.database}/documents/${e.path.canonicalString()}`}}function tue(o){return!!o&&"integerValue"in o}function MZ(o){return!!o&&"arrayValue"in o}function upe(o){return!!o&&"nullValue"in o}function lpe(o){return!!o&&"doubleValue"in o&&isNaN(Number(o.doubleValue))}function Mre(o){return!!o&&"mapValue"in o}function BZ(o){if(o.geoPointValue)return{geoPointValue:Object.assign({},o.geoPointValue)};if(o.timestampValue&&"object"==typeof o.timestampValue)return{timestampValue:Object.assign({},o.timestampValue)};if(o.mapValue){const e={mapValue:{fields:{}}};return u2(o.mapValue.fields,(i,d)=>e.mapValue.fields[i]=BZ(d)),e}if(o.arrayValue){const e={arrayValue:{values:[]}};for(let i=0;i<(o.arrayValue.values||[]).length;++i)e.arrayValue.values[i]=BZ(o.arrayValue.values[i]);return e}return Object.assign({},o)}function dpe(o){return"__max__"===(((o.mapValue||{}).fields||{}).__type__||{}).stringValue}function hpe(o){return"nullValue"in o?Lre:"booleanValue"in o?{booleanValue:!1}:"integerValue"in o||"doubleValue"in o?{doubleValue:NaN}:"timestampValue"in o?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in o?{stringValue:""}:"bytesValue"in o?{bytesValue:""}:"referenceValue"in o?MQ(N6.empty(),fI.empty()):"geoPointValue"in o?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in o?{arrayValue:{}}:"mapValue"in o?{mapValue:{}}:PI()}function Q_e(o){return"nullValue"in o?{booleanValue:!1}:"booleanValue"in o?{doubleValue:NaN}:"integerValue"in o||"doubleValue"in o?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in o?{stringValue:""}:"stringValue"in o?{bytesValue:""}:"bytesValue"in o?MQ(N6.empty(),fI.empty()):"referenceValue"in o?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in o?{arrayValue:{}}:"arrayValue"in o?{mapValue:{}}:"mapValue"in o?z8:PI()}function fpe(o,e){const i=k6(o.value,e.value);return 0!==i?i:o.inclusive&&!e.inclusive?-1:!o.inclusive&&e.inclusive?1:0}function ppe(o,e){const i=k6(o.value,e.value);return 0!==i?i:o.inclusive&&!e.inclusive?1:!o.inclusive&&e.inclusive?-1:0}class CN{constructor(e){this.value=e}static empty(){return new CN({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let i=this.value;for(let d=0;d<e.length-1;++d)if(i=(i.mapValue.fields||{})[e.get(d)],!Mre(i))return null;return i=(i.mapValue.fields||{})[e.lastSegment()],i||null}}set(e,i){this.getFieldsMap(e.popLast())[e.lastSegment()]=BZ(i)}setAll(e){let i=PR.emptyPath(),d={},_=[];e.forEach((_t,_a)=>{if(!i.isImmediateParentOf(_a)){const _h=this.getFieldsMap(i);this.applyChanges(_h,d,_),d={},_=[],i=_a.popLast()}_t?d[_a.lastSegment()]=BZ(_t):_.push(_a.lastSegment())});const B=this.getFieldsMap(i);this.applyChanges(B,d,_)}delete(e){const i=this.field(e.popLast());Mre(i)&&i.mapValue.fields&&delete i.mapValue.fields[e.lastSegment()]}isEqual(e){return V4(this.value,e.value)}getFieldsMap(e){let i=this.value;i.mapValue.fields||(i.mapValue={fields:{}});for(let d=0;d<e.length;++d){let _=i.mapValue.fields[e.get(d)];Mre(_)&&_.mapValue.fields||(_={mapValue:{fields:{}}},i.mapValue.fields[e.get(d)]=_),i=_}return i.mapValue.fields}applyChanges(e,i,d){u2(i,(_,B)=>e[_]=B);for(const _ of d)delete e[_]}clone(){return new CN(BZ(this.value))}}function gpe(o){const e=[];return u2(o.fields,(i,d)=>{const _=new PR([i]);if(Mre(d)){const B=gpe(d.mapValue).fields;if(0===B.length)e.push(_);else for(const _t of B)e.push(_.child(_t))}else e.push(_)}),new K8(e)}class mS{constructor(e,i,d,_,B,_t){this.key=e,this.documentType=i,this.version=d,this.readTime=_,this.data=B,this.documentState=_t}static newInvalidDocument(e){return new mS(e,0,a1.min(),a1.min(),CN.empty(),0)}static newFoundDocument(e,i,d){return new mS(e,1,i,a1.min(),d,0)}static newNoDocument(e,i){return new mS(e,2,i,a1.min(),CN.empty(),0)}static newUnknownDocument(e,i){return new mS(e,3,i,a1.min(),CN.empty(),2)}convertToFoundDocument(e,i){return this.version=e,this.documentType=1,this.data=i,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=CN.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=CN.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof mS&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new mS(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Bre{constructor(e,i,d,_){this.indexId=e,this.collectionGroup=i,this.fields=d,this.indexState=_}}function nue(o){return o.fields.find(e=>2===e.kind)}function BQ(o){return o.fields.filter(e=>2!==e.kind)}Bre.UNKNOWN_ID=-1;class Ure{constructor(e,i){this.fieldPath=e,this.kind=i}}class TK{constructor(e,i){this.sequenceNumber=e,this.offset=i}static empty(){return new TK(0,BM.min())}}function P6(o,e){const i=o.toTimestamp().seconds,d=o.toTimestamp().nanoseconds+1,_=a1.fromTimestamp(1e9===d?new XS(i+1,0):new XS(i,d));return new BM(_,fI.empty(),e)}function H_e(o){return new BM(o.readTime,o.key,-1)}class BM{constructor(e,i,d){this.readTime=e,this.documentKey=i,this.largestBatchId=d}static min(){return new BM(a1.min(),fI.empty(),-1)}static max(){return new BM(a1.max(),fI.empty(),-1)}}function rue(o,e){let i=o.readTime.compareTo(e.readTime);return 0!==i?i:(i=fI.comparator(o.documentKey,e.documentKey),0!==i?i:R1(o.largestBatchId,e.largestBatchId))}class fR{constructor(e,i){this.comparator=e,this.root=i||wN.EMPTY}insert(e,i){return new fR(this.comparator,this.root.insert(e,i,this.comparator).copy(null,null,wN.BLACK,null,null))}remove(e){return new fR(this.comparator,this.root.remove(e,this.comparator).copy(null,null,wN.BLACK,null,null))}get(e){let i=this.root;for(;!i.isEmpty();){const d=this.comparator(e,i.key);if(0===d)return i.value;d<0?i=i.left:d>0&&(i=i.right)}return null}indexOf(e){let i=0,d=this.root;for(;!d.isEmpty();){const _=this.comparator(e,d.key);if(0===_)return i+d.left.size;_<0?d=d.left:(i+=d.left.size+1,d=d.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((i,d)=>(e(i,d),!1))}toString(){const e=[];return this.inorderTraversal((i,d)=>(e.push(`${i}:${d}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Fre(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Fre(this.root,e,this.comparator,!1)}getReverseIterator(){return new Fre(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Fre(this.root,e,this.comparator,!0)}}class Fre{constructor(e,i,d,_){this.isReverse=_,this.nodeStack=[];let B=1;for(;!e.isEmpty();)if(B=i?d(e.key,i):1,i&&_&&(B*=-1),B<0)e=this.isReverse?e.left:e.right;else{if(0===B){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const i={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return i}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class wN{constructor(e,i,d,_,B){this.key=e,this.value=i,this.color=null!=d?d:wN.RED,this.left=null!=_?_:wN.EMPTY,this.right=null!=B?B:wN.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,i,d,_,B){return new wN(null!=e?e:this.key,null!=i?i:this.value,null!=d?d:this.color,null!=_?_:this.left,null!=B?B:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,i,d){let _=this;const B=d(e,_.key);return _=B<0?_.copy(null,null,null,_.left.insert(e,i,d),null):0===B?_.copy(null,i,null,null,null):_.copy(null,null,null,null,_.right.insert(e,i,d)),_.fixUp()}removeMin(){if(this.left.isEmpty())return wN.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,i){let d,_=this;if(i(e,_.key)<0)_.left.isEmpty()||_.left.isRed()||_.left.left.isRed()||(_=_.moveRedLeft()),_=_.copy(null,null,null,_.left.remove(e,i),null);else{if(_.left.isRed()&&(_=_.rotateRight()),_.right.isEmpty()||_.right.isRed()||_.right.left.isRed()||(_=_.moveRedRight()),0===i(e,_.key)){if(_.right.isEmpty())return wN.EMPTY;d=_.right.min(),_=_.copy(d.key,d.value,null,null,_.right.removeMin())}_=_.copy(null,null,null,null,_.right.remove(e,i))}return _.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,wN.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,wN.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,i)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw PI();const e=this.left.check();if(e!==this.right.check())throw PI();return e+(this.isRed()?0:1)}}wN.EMPTY=null,wN.RED=!0,wN.BLACK=!1,wN.EMPTY=new class{constructor(){this.size=0}get key(){throw PI()}get value(){throw PI()}get color(){throw PI()}get left(){throw PI()}get right(){throw PI()}copy(o,e,i,d,_){return this}insert(o,e,i){return new wN(o,e)}remove(o,e){return this}isEmpty(){return!0}inorderTraversal(o){return!1}reverseTraversal(o){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class hT{constructor(e){this.comparator=e,this.data=new fR(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((i,d)=>(e(i),!1))}forEachInRange(e,i){const d=this.data.getIteratorFrom(e[0]);for(;d.hasNext();){const _=d.getNext();if(this.comparator(_.key,e[1])>=0)return;i(_.key)}}forEachWhile(e,i){let d;for(d=void 0!==i?this.data.getIteratorFrom(i):this.data.getIterator();d.hasNext();)if(!e(d.getNext().key))return}firstAfterOrEqual(e){const i=this.data.getIteratorFrom(e);return i.hasNext()?i.getNext().key:null}getIterator(){return new iue(this.data.getIterator())}getIteratorFrom(e){return new iue(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let i=this;return i.size<e.size&&(i=e,e=this),e.forEach(d=>{i=i.add(d)}),i}isEqual(e){if(!(e instanceof hT)||this.size!==e.size)return!1;const i=this.data.getIterator(),d=e.data.getIterator();for(;i.hasNext();){const _=i.getNext().key,B=d.getNext().key;if(0!==this.comparator(_,B))return!1}return!0}toArray(){const e=[];return this.forEach(i=>{e.push(i)}),e}toString(){const e=[];return this.forEach(i=>e.push(i)),"SortedSet("+e.toString()+")"}copy(e){const i=new hT(this.comparator);return i.data=e,i}}class iue{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function UQ(o){return o.hasNext()?o.getNext():void 0}class q_e{constructor(e,i=null,d=[],_=[],B=null,_t=null,_a=null){this.path=e,this.collectionGroup=i,this.orderBy=d,this.filters=_,this.limit=B,this.startAt=_t,this.endAt=_a,this.P=null}}function FQ(o,e=null,i=[],d=[],_=null,B=null,_t=null){return new q_e(o,e,i,d,_,B,_t)}function jQ(o){const e=pI(o);if(null===e.P){let i=e.path.canonicalString();null!==e.collectionGroup&&(i+="|cg:"+e.collectionGroup),i+="|f:",i+=e.filters.map(d=>{return(_=d).field.canonicalString()+_.op.toString()+wK(_.value);var _}).join(","),i+="|ob:",i+=e.orderBy.map(d=>{return(_=d).field.canonicalString()+_.dir;var _}).join(","),t3(e.limit)||(i+="|l:",i+=e.limit),e.startAt&&(i+="|lb:",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map(d=>wK(d)).join(",")),e.endAt&&(i+="|ub:",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map(d=>wK(d)).join(",")),e.P=i}return e.P}function SK(o,e){if(o.limit!==e.limit||o.orderBy.length!==e.orderBy.length)return!1;for(let _=0;_<o.orderBy.length;_++)if(!X_e(o.orderBy[_],e.orderBy[_]))return!1;if(o.filters.length!==e.filters.length)return!1;for(let _=0;_<o.filters.length;_++)if((i=o.filters[_]).op!==(d=e.filters[_]).op||!i.field.isEqual(d.field)||!V4(i.value,d.value))return!1;var i,d;return o.collectionGroup===e.collectionGroup&&!!o.path.isEqual(e.path)&&!!_pe(o.startAt,e.startAt)&&_pe(o.endAt,e.endAt)}function RK(o){return fI.isDocumentKey(o.path)&&null===o.collectionGroup&&0===o.filters.length}function UZ(o,e){return o.filters.filter(i=>i instanceof IO&&i.field.isEqual(e))}function OK(o,e,i){let d=Lre,_=!0;for(const B of UZ(o,e)){let _t=Lre,_a=!0;switch(B.op){case"<":case"<=":_t=hpe(B.value);break;case"==":case"in":case">=":_t=B.value;break;case">":_t=B.value,_a=!1;break;case"!=":case"not-in":_t=Lre}fpe({value:d,inclusive:_},{value:_t,inclusive:_a})<0&&(d=_t,_=_a)}if(null!==i)for(let B=0;B<o.orderBy.length;++B)if(o.orderBy[B].field.isEqual(e)){const _t=i.position[B];fpe({value:d,inclusive:_},{value:_t,inclusive:i.inclusive})<0&&(d=_t,_=i.inclusive);break}return{value:d,inclusive:_}}function mpe(o,e,i){let d=z8,_=!0;for(const B of UZ(o,e)){let _t=z8,_a=!0;switch(B.op){case">=":case">":_t=Q_e(B.value),_a=!1;break;case"==":case"in":case"<=":_t=B.value;break;case"<":_t=B.value,_a=!1;break;case"!=":case"not-in":_t=z8}ppe({value:d,inclusive:_},{value:_t,inclusive:_a})>0&&(d=_t,_=_a)}if(null!==i)for(let B=0;B<o.orderBy.length;++B)if(o.orderBy[B].field.isEqual(e)){const _t=i.position[B];ppe({value:d,inclusive:_},{value:_t,inclusive:i.inclusive})>0&&(d=_t,_=i.inclusive);break}return{value:d,inclusive:_}}class IO extends class{}{constructor(e,i,d){super(),this.field=e,this.op=i,this.value=d}static create(e,i,d){return e.isKeyField()?"in"===i||"not-in"===i?this.V(e,i,d):new K_e(e,i,d):"array-contains"===i?new J_e(e,d):"in"===i?new Ape(e,d):"not-in"===i?new $_e(e,d):"array-contains-any"===i?new Z_e(e,d):new IO(e,i,d)}static V(e,i,d){return"in"===i?new z_e(e,d):new Y_e(e,d)}matches(e){const i=e.data.field(this.field);return"!="===this.op?null!==i&&this.v(k6(i,this.value)):null!==i&&LQ(this.value)===LQ(i)&&this.v(k6(i,this.value))}v(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return PI()}}S(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class K_e extends IO{constructor(e,i,d){super(e,i,d),this.key=fI.fromName(d.referenceValue)}matches(e){const i=fI.comparator(e.key,this.key);return this.v(i)}}class z_e extends IO{constructor(e,i){super(e,"in",i),this.keys=FZ(0,i)}matches(e){return this.keys.some(i=>i.isEqual(e.key))}}class Y_e extends IO{constructor(e,i){super(e,"not-in",i),this.keys=FZ(0,i)}matches(e){return!this.keys.some(i=>i.isEqual(e.key))}}function FZ(o,e){var i;return((null===(i=e.arrayValue)||void 0===i?void 0:i.values)||[]).map(d=>fI.fromName(d.referenceValue))}class J_e extends IO{constructor(e,i){super(e,"array-contains",i)}matches(e){const i=e.data.field(this.field);return MZ(i)&&LZ(i.arrayValue,this.value)}}class Ape extends IO{constructor(e,i){super(e,"in",i)}matches(e){const i=e.data.field(this.field);return null!==i&&LZ(this.value.arrayValue,i)}}class $_e extends IO{constructor(e,i){super(e,"not-in",i)}matches(e){if(LZ(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const i=e.data.field(this.field);return null!==i&&!LZ(this.value.arrayValue,i)}}class Z_e extends IO{constructor(e,i){super(e,"array-contains-any",i)}matches(e){const i=e.data.field(this.field);return!(!MZ(i)||!i.arrayValue.values)&&i.arrayValue.values.some(d=>LZ(this.value.arrayValue,d))}}class x6{constructor(e,i){this.position=e,this.inclusive=i}}class VQ{constructor(e,i="asc"){this.field=e,this.dir=i}}function X_e(o,e){return o.dir===e.dir&&o.field.isEqual(e.field)}function jre(o,e,i){let d=0;for(let _=0;_<o.position.length;_++){const B=e[_],_t=o.position[_];if(d=B.field.isKeyField()?fI.comparator(fI.fromName(_t.referenceValue),i.key):k6(_t,i.data.field(B.field)),"desc"===B.dir&&(d*=-1),0!==d)break}return d}function _pe(o,e){if(null===o)return null===e;if(null===e||o.inclusive!==e.inclusive||o.position.length!==e.position.length)return!1;for(let i=0;i<o.position.length;i++)if(!V4(o.position[i],e.position[i]))return!1;return!0}class n3{constructor(e,i=null,d=[],_=[],B=null,_t="F",_a=null,_h=null){this.path=e,this.collectionGroup=i,this.explicitOrderBy=d,this.filters=_,this.limit=B,this.limitType=_t,this.startAt=_a,this.endAt=_h,this.D=null,this.C=null}}function vpe(o,e,i,d,_,B,_t,_a){return new n3(o,e,i,d,_,B,_t,_a)}function DK(o){return new n3(o)}function Vre(o){return o.explicitOrderBy.length>0?o.explicitOrderBy[0].field:null}function sue(o){for(const e of o.filters)if(e.S())return e.field;return null}function aue(o){return null!==o.collectionGroup}function L6(o){const e=pI(o);if(null===e.D){e.D=[];const i=sue(e),d=Vre(e);if(null!==i&&null===d)i.isKeyField()||e.D.push(new VQ(i)),e.D.push(new VQ(PR.keyField(),"asc"));else{let _=!1;for(const B of e.explicitOrderBy)e.D.push(B),B.field.isKeyField()&&(_=!0);if(!_){const B=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.D.push(new VQ(PR.keyField(),B))}}}return e.D}function UM(o){const e=pI(o);if(!e.C)if("F"===e.limitType)e.C=FQ(e.path,e.collectionGroup,L6(e),e.filters,e.limit,e.startAt,e.endAt);else{const i=[];for(const B of L6(e))i.push(new VQ(B.field,"desc"===B.dir?"asc":"desc"));const d=e.endAt?new x6(e.endAt.position,e.endAt.inclusive):null,_=e.startAt?new x6(e.startAt.position,e.startAt.inclusive):null;e.C=FQ(e.path,e.collectionGroup,i,e.filters,e.limit,d,_)}return e.C}function cue(o,e,i){return new n3(o.path,o.collectionGroup,o.explicitOrderBy.slice(),o.filters.slice(),e,i,o.startAt,o.endAt)}function NK(o,e){return SK(UM(o),UM(e))&&o.limitType===e.limitType}function kK(o){return`${jQ(UM(o))}|lt:${o.limitType}`}function uue(o){return`Query(target=${function W_e(o){let e=o.path.canonicalString();return null!==o.collectionGroup&&(e+=" collectionGroup="+o.collectionGroup),o.filters.length>0&&(e+=`, filters: [${o.filters.map(i=>{return`${(d=i).field.canonicalString()} ${d.op} ${wK(d.value)}`;var d}).join(", ")}]`),t3(o.limit)||(e+=", limit: "+o.limit),o.orderBy.length>0&&(e+=`, orderBy: [${o.orderBy.map(i=>{return`${(d=i).field.canonicalString()} (${d.dir})`;var d}).join(", ")}]`),o.startAt&&(e+=", startAt: ",e+=o.startAt.inclusive?"b:":"a:",e+=o.startAt.position.map(i=>wK(i)).join(",")),o.endAt&&(e+=", endAt: ",e+=o.endAt.inclusive?"a:":"b:",e+=o.endAt.position.map(i=>wK(i)).join(",")),`Target(${e})`}(UM(o))}; limitType=${o.limitType})`}function jZ(o,e){return e.isFoundDocument()&&function(i,d){const _=d.key.path;return null!==i.collectionGroup?d.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(_):fI.isDocumentKey(i.path)?i.path.isEqual(_):i.path.isImmediateParentOf(_)}(o,e)&&function(i,d){for(const _ of i.explicitOrderBy)if(!_.field.isKeyField()&&null===d.data.field(_.field))return!1;return!0}(o,e)&&function(i,d){for(const _ of i.filters)if(!_.matches(d))return!1;return!0}(o,e)&&(d=e,!((i=o).startAt&&!function(_,B,_t){const _a=jre(_,B,_t);return _.inclusive?_a<=0:_a<0}(i.startAt,L6(i),d)||i.endAt&&!function(_,B,_t){const _a=jre(_,B,_t);return _.inclusive?_a>=0:_a>0}(i.endAt,L6(i),d)));var i,d}function VZ(o){return o.collectionGroup||(o.path.length%2==1?o.path.lastSegment():o.path.get(o.path.length-2))}function Gre(o){return(e,i)=>{let d=!1;for(const _ of L6(o)){const B=ype(_,e,i);if(0!==B)return B;d=d||_.field.isKeyField()}return 0}}function ype(o,e,i){const d=o.field.isKeyField()?fI.comparator(e.key,i.key):function(_,B,_t){const _a=B.data.field(_),_h=_t.data.field(_);return null!==_a&&null!==_h?k6(_a,_h):PI()}(o.field,e,i);switch(o.dir){case"asc":return d;case"desc":return-1*d;default:return PI()}}function GZ(o,e){if(o.N){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xZ(e)?"-0":e}}function lue(o){return{integerValue:""+o}}function due(o,e){return ape(e)?lue(e):GZ(o,e)}class QZ{constructor(){this._=void 0}}function Epe(o,e,i){return o instanceof PK?function(d,_){const B={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:d.seconds,nanos:d.nanoseconds}}}};return _&&(B.fields.__previous_value__=_),{mapValue:B}}(i,e):o instanceof Y8?hue(o,e):o instanceof M6?bpe(o,e):function(d,_){const B=Ipe(d,_),_t=Cpe(B)+Cpe(d.k);return tue(B)&&tue(d.k)?lue(_t):GZ(d.M,_t)}(o,e)}function eve(o,e,i){return o instanceof Y8?hue(o,e):o instanceof M6?bpe(o,e):i}function Ipe(o,e){return o instanceof xK?tue(i=e)||(d=i)&&"doubleValue"in d?e:{integerValue:0}:null;var d,i}class PK extends QZ{}class Y8 extends QZ{constructor(e){super(),this.elements=e}}function hue(o,e){const i=fue(e);for(const d of o.elements)i.some(_=>V4(_,d))||i.push(d);return{arrayValue:{values:i}}}class M6 extends QZ{constructor(e){super(),this.elements=e}}function bpe(o,e){let i=fue(e);for(const d of o.elements)i=i.filter(_=>!V4(_,d));return{arrayValue:{values:i}}}class xK extends QZ{constructor(e,i){super(),this.M=e,this.k=i}}function Cpe(o){return eR(o.integerValue||o.doubleValue)}function fue(o){return MZ(o)&&o.arrayValue.values?o.arrayValue.values.slice():[]}class HZ{constructor(e,i){this.field=e,this.transform=i}}class wpe{constructor(e,i){this.version=e,this.transformResults=i}}class xR{constructor(e,i){this.updateTime=e,this.exists=i}static none(){return new xR}static exists(e){return new xR(void 0,e)}static updateTime(e){return new xR(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Qre(o,e){return void 0!==o.updateTime?e.isFoundDocument()&&e.version.isEqual(o.updateTime):void 0===o.exists||o.exists===e.isFoundDocument()}class Hre{}function gue(o,e,i){o instanceof qZ?function(d,_,B){const _t=d.value.clone(),_a=Aue(d.fieldTransforms,_,B.transformResults);_t.setAll(_a),_.convertToFoundDocument(B.version,_t).setHasCommittedMutations()}(o,e,i):o instanceof GQ?function(d,_,B){if(!Qre(d.precondition,_))return void _.convertToUnknownDocument(B.version);const _t=Aue(d.fieldTransforms,_,B.transformResults),_a=_.data;_a.setAll(Rpe(d)),_a.setAll(_t),_.convertToFoundDocument(B.version,_a).setHasCommittedMutations()}(o,e,i):e.convertToNoDocument(i.version).setHasCommittedMutations()}function mue(o,e,i){var _;o instanceof qZ?function(d,_,B){if(!Qre(d.precondition,_))return;const _t=d.value.clone(),_a=Ope(d.fieldTransforms,B,_);_t.setAll(_a),_.convertToFoundDocument(qre(_),_t).setHasLocalMutations()}(o,e,i):o instanceof GQ?function(d,_,B){if(!Qre(d.precondition,_))return;const _t=Ope(d.fieldTransforms,B,_),_a=_.data;_a.setAll(Rpe(d)),_a.setAll(_t),_.convertToFoundDocument(qre(_),_a).setHasLocalMutations()}(o,e,i):Qre(o.precondition,_=e)&&_.convertToNoDocument(a1.min())}function Tpe(o,e){let i=null;for(const d of o.fieldTransforms){const _=e.data.field(d.field),B=Ipe(d.transform,_||null);null!=B&&(null==i&&(i=CN.empty()),i.set(d.field,B))}return i||null}function Spe(o,e){return o.type===e.type&&!!o.key.isEqual(e.key)&&!!o.precondition.isEqual(e.precondition)&&(d=e.fieldTransforms,!!(void 0===(i=o.fieldTransforms)&&void 0===d||i&&d&&xQ(i,d,(_,B)=>function pue(o,e){return o.field.isEqual(e.field)&&(d=e.transform,(i=o.transform)instanceof Y8&&d instanceof Y8||i instanceof M6&&d instanceof M6?xQ(i.elements,d.elements,V4):i instanceof xK&&d instanceof xK?V4(i.k,d.k):i instanceof PK&&d instanceof PK);var i,d}(_,B))))&&(0===o.type?o.value.isEqual(e.value):1!==o.type||o.data.isEqual(e.data)&&o.fieldMask.isEqual(e.fieldMask));var i,d}function qre(o){return o.isFoundDocument()?o.version:a1.min()}class qZ extends Hre{constructor(e,i,d,_=[]){super(),this.key=e,this.value=i,this.precondition=d,this.fieldTransforms=_,this.type=0}}class GQ extends Hre{constructor(e,i,d,_,B=[]){super(),this.key=e,this.data=i,this.fieldMask=d,this.precondition=_,this.fieldTransforms=B,this.type=1}}function Rpe(o){const e=new Map;return o.fieldMask.fields.forEach(i=>{if(!i.isEmpty()){const d=o.data.field(i);e.set(i,d)}}),e}function Aue(o,e,i){const d=new Map;QI(o.length===i.length);for(let _=0;_<i.length;_++){const B=o[_],_t=B.transform,_a=e.data.field(B.field);d.set(B.field,eve(_t,_a,i[_]))}return d}function Ope(o,e,i){const d=new Map;for(const _ of o){const B=_.transform,_t=i.data.field(_.field);d.set(_.field,Epe(B,_t,e))}return d}class WZ extends Hre{constructor(e,i){super(),this.key=e,this.precondition=i,this.type=2,this.fieldTransforms=[]}}class Wre extends Hre{constructor(e,i){super(),this.key=e,this.precondition=i,this.type=3,this.fieldTransforms=[]}}class tve{constructor(e){this.count=e}}var LR,oT;function Kre(o){switch(o){default:return PI();case T0.CANCELLED:case T0.UNKNOWN:case T0.DEADLINE_EXCEEDED:case T0.RESOURCE_EXHAUSTED:case T0.INTERNAL:case T0.UNAVAILABLE:case T0.UNAUTHENTICATED:return!1;case T0.INVALID_ARGUMENT:case T0.NOT_FOUND:case T0.ALREADY_EXISTS:case T0.PERMISSION_DENIED:case T0.FAILED_PRECONDITION:case T0.ABORTED:case T0.OUT_OF_RANGE:case T0.UNIMPLEMENTED:case T0.DATA_LOSS:return!0}}function Dpe(o){if(void 0===o)return kR("GRPC error has no .code"),T0.UNKNOWN;switch(o){case LR.OK:return T0.OK;case LR.CANCELLED:return T0.CANCELLED;case LR.UNKNOWN:return T0.UNKNOWN;case LR.DEADLINE_EXCEEDED:return T0.DEADLINE_EXCEEDED;case LR.RESOURCE_EXHAUSTED:return T0.RESOURCE_EXHAUSTED;case LR.INTERNAL:return T0.INTERNAL;case LR.UNAVAILABLE:return T0.UNAVAILABLE;case LR.UNAUTHENTICATED:return T0.UNAUTHENTICATED;case LR.INVALID_ARGUMENT:return T0.INVALID_ARGUMENT;case LR.NOT_FOUND:return T0.NOT_FOUND;case LR.ALREADY_EXISTS:return T0.ALREADY_EXISTS;case LR.PERMISSION_DENIED:return T0.PERMISSION_DENIED;case LR.FAILED_PRECONDITION:return T0.FAILED_PRECONDITION;case LR.ABORTED:return T0.ABORTED;case LR.OUT_OF_RANGE:return T0.OUT_OF_RANGE;case LR.UNIMPLEMENTED:return T0.UNIMPLEMENTED;case LR.DATA_LOSS:return T0.DATA_LOSS;default:return PI()}}(oT=LR||(LR={}))[oT.OK=0]="OK",oT[oT.CANCELLED=1]="CANCELLED",oT[oT.UNKNOWN=2]="UNKNOWN",oT[oT.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",oT[oT.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",oT[oT.NOT_FOUND=5]="NOT_FOUND",oT[oT.ALREADY_EXISTS=6]="ALREADY_EXISTS",oT[oT.PERMISSION_DENIED=7]="PERMISSION_DENIED",oT[oT.UNAUTHENTICATED=16]="UNAUTHENTICATED",oT[oT.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",oT[oT.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",oT[oT.ABORTED=10]="ABORTED",oT[oT.OUT_OF_RANGE=11]="OUT_OF_RANGE",oT[oT.UNIMPLEMENTED=12]="UNIMPLEMENTED",oT[oT.INTERNAL=13]="INTERNAL",oT[oT.UNAVAILABLE=14]="UNAVAILABLE",oT[oT.DATA_LOSS=15]="DATA_LOSS";class J8{constructor(e,i){this.mapKeyFn=e,this.equalsFn=i,this.inner={},this.innerSize=0}get(e){const i=this.mapKeyFn(e),d=this.inner[i];if(void 0!==d)for(const[_,B]of d)if(this.equalsFn(_,e))return B}has(e){return void 0!==this.get(e)}set(e,i){const d=this.mapKeyFn(e),_=this.inner[d];if(void 0===_)return this.inner[d]=[[e,i]],void this.innerSize++;for(let B=0;B<_.length;B++)if(this.equalsFn(_[B][0],e))return void(_[B]=[e,i]);_.push([e,i]),this.innerSize++}delete(e){const i=this.mapKeyFn(e),d=this.inner[i];if(void 0===d)return!1;for(let _=0;_<d.length;_++)if(this.equalsFn(d[_][0],e))return 1===d.length?delete this.inner[i]:d.splice(_,1),this.innerSize--,!0;return!1}forEach(e){u2(this.inner,(i,d)=>{for(const[_,B]of d)e(_,B)})}isEmpty(){return MM(this.inner)}size(){return this.innerSize}}const Npe=new fR(fI.comparator);function HL(){return Npe}const nve=new fR(fI.comparator);function zre(...o){let e=nve;for(const i of o)e=e.insert(i.key,i);return e}function LK(){return new J8(o=>o.toString(),(o,e)=>o.isEqual(e))}const rve=new fR(fI.comparator),ive=new hT(fI.comparator);function CT(...o){let e=ive;for(const i of o)e=e.add(i);return e}const KZ=new hT(R1);function B6(){return KZ}class zZ{constructor(e,i,d,_,B){this.snapshotVersion=e,this.targetChanges=i,this.targetMismatches=d,this.documentUpdates=_,this.resolvedLimboDocuments=B}static createSynthesizedRemoteEventForCurrentChange(e,i){const d=new Map;return d.set(e,MK.createSynthesizedTargetChangeForCurrentChange(e,i)),new zZ(a1.min(),d,B6(),HL(),CT())}}class MK{constructor(e,i,d,_,B){this.resumeToken=e,this.current=i,this.addedDocuments=d,this.modifiedDocuments=_,this.removedDocuments=B}static createSynthesizedTargetChangeForCurrentChange(e,i){return new MK(aO.EMPTY_BYTE_STRING,i,CT(),CT(),CT())}}class Yre{constructor(e,i,d,_){this.O=e,this.removedTargetIds=i,this.key=d,this.F=_}}class kpe{constructor(e,i){this.targetId=e,this.$=i}}class _ue{constructor(e,i,d=aO.EMPTY_BYTE_STRING,_=null){this.state=e,this.targetIds=i,this.resumeToken=d,this.cause=_}}class AS{constructor(){this.B=0,this.L=Ppe(),this.U=aO.EMPTY_BYTE_STRING,this.q=!1,this.K=!0}get current(){return this.q}get resumeToken(){return this.U}get G(){return 0!==this.B}get j(){return this.K}W(e){e.approximateByteSize()>0&&(this.K=!0,this.U=e)}H(){let e=CT(),i=CT(),d=CT();return this.L.forEach((_,B)=>{switch(B){case 0:e=e.add(_);break;case 2:i=i.add(_);break;case 1:d=d.add(_);break;default:PI()}}),new MK(this.U,this.q,e,i,d)}J(){this.K=!1,this.L=Ppe()}Y(e,i){this.K=!0,this.L=this.L.insert(e,i)}X(e){this.K=!0,this.L=this.L.remove(e)}Z(){this.B+=1}tt(){this.B-=1}et(){this.K=!0,this.q=!0}}class ove{constructor(e){this.nt=e,this.st=new Map,this.it=HL(),this.rt=BK(),this.ot=new hT(R1)}ut(e){for(const i of e.O)e.F&&e.F.isFoundDocument()?this.at(i,e.F):this.ct(i,e.key,e.F);for(const i of e.removedTargetIds)this.ct(i,e.key,e.F)}ht(e){this.forEachTarget(e,i=>{const d=this.lt(i);switch(e.state){case 0:this.ft(i)&&d.W(e.resumeToken);break;case 1:d.tt(),d.G||d.J(),d.W(e.resumeToken);break;case 2:d.tt(),d.G||this.removeTarget(i);break;case 3:this.ft(i)&&(d.et(),d.W(e.resumeToken));break;case 4:this.ft(i)&&(this.dt(i),d.W(e.resumeToken));break;default:PI()}})}forEachTarget(e,i){e.targetIds.length>0?e.targetIds.forEach(i):this.st.forEach((d,_)=>{this.ft(_)&&i(_)})}_t(e){const i=e.targetId,d=e.$.count,_=this.wt(i);if(_){const B=_.target;if(RK(B))if(0===d){const _t=new fI(B.path);this.ct(i,_t,mS.newNoDocument(_t,a1.min()))}else QI(1===d);else this.gt(i)!==d&&(this.dt(i),this.ot=this.ot.add(i))}}yt(e){const i=new Map;this.st.forEach((B,_t)=>{const _a=this.wt(_t);if(_a){if(B.current&&RK(_a.target)){const _h=new fI(_a.target.path);null!==this.it.get(_h)||this.It(_t,_h)||this.ct(_t,_h,mS.newNoDocument(_h,e))}B.j&&(i.set(_t,B.H()),B.J())}});let d=CT();this.rt.forEach((B,_t)=>{let _a=!0;_t.forEachWhile(_h=>{const _g=this.wt(_h);return!_g||2===_g.purpose||(_a=!1,!1)}),_a&&(d=d.add(B))}),this.it.forEach((B,_t)=>_t.setReadTime(e));const _=new zZ(e,i,this.ot,this.it,d);return this.it=HL(),this.rt=BK(),this.ot=new hT(R1),_}at(e,i){if(!this.ft(e))return;const d=this.It(e,i.key)?2:0;this.lt(e).Y(i.key,d),this.it=this.it.insert(i.key,i),this.rt=this.rt.insert(i.key,this.Tt(i.key).add(e))}ct(e,i,d){if(!this.ft(e))return;const _=this.lt(e);this.It(e,i)?_.Y(i,1):_.X(i),this.rt=this.rt.insert(i,this.Tt(i).delete(e)),d&&(this.it=this.it.insert(i,d))}removeTarget(e){this.st.delete(e)}gt(e){const i=this.lt(e).H();return this.nt.getRemoteKeysForTarget(e).size+i.addedDocuments.size-i.removedDocuments.size}Z(e){this.lt(e).Z()}lt(e){let i=this.st.get(e);return i||(i=new AS,this.st.set(e,i)),i}Tt(e){let i=this.rt.get(e);return i||(i=new hT(R1),this.rt=this.rt.insert(e,i)),i}ft(e){const i=null!==this.wt(e);return i||nI("WatchChangeAggregator","Detected inactive target",e),i}wt(e){const i=this.st.get(e);return i&&i.G?null:this.nt.Et(e)}dt(e){this.st.set(e,new AS),this.nt.getRemoteKeysForTarget(e).forEach(i=>{this.ct(e,i,null)})}It(e,i){return this.nt.getRemoteKeysForTarget(e).has(i)}}function BK(){return new fR(fI.comparator)}function Ppe(){return new fR(fI.comparator)}const xpe={asc:"ASCENDING",desc:"DESCENDING"},sve={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class ave{constructor(e,i){this.databaseId=e,this.N=i}}function YZ(o,e){return o.N?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function vue(o,e){return o.N?e.toBase64():e.toUint8Array()}function cve(o,e){return YZ(o,e.toTimestamp())}function bO(o){return QI(!!o),a1.fromTimestamp(function(e){const i=j4(e);return new XS(i.seconds,i.nanos)}(o))}function yue(o,e){return(i=o,new eT(["projects",i.projectId,"databases",i.database])).child("documents").child(e).canonicalString();var i}function Lpe(o){const e=eT.fromString(o);return QI(jpe(e)),e}function JZ(o,e){return yue(o.databaseId,e.path)}function G4(o,e){const i=Lpe(e);if(i.get(1)!==o.databaseId.projectId)throw new W0(T0.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+i.get(1)+" vs "+o.databaseId.projectId);if(i.get(3)!==o.databaseId.database)throw new W0(T0.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+i.get(3)+" vs "+o.databaseId.database);return new fI(bue(i))}function Eue(o,e){return yue(o.databaseId,e)}function Iue(o){const e=Lpe(o);return 4===e.length?eT.emptyPath():bue(e)}function FM(o){return new eT(["projects",o.databaseId.projectId,"databases",o.databaseId.database]).canonicalString()}function bue(o){return QI(o.length>4&&"documents"===o.get(4)),o.popFirst(5)}function Mpe(o,e,i){return{name:JZ(o,e),fields:i.value.mapValue.fields}}function Cue(o,e,i){const d=G4(o,e.name),_=bO(e.updateTime),B=new CN({mapValue:{fields:e.fields}}),_t=mS.newFoundDocument(d,_,B);return i&&_t.setHasCommittedMutations(),i?_t.setHasCommittedMutations():_t}function $Z(o,e){let i;if(e instanceof qZ)i={update:Mpe(o,e.key,e.value)};else if(e instanceof WZ)i={delete:JZ(o,e.key)};else if(e instanceof GQ)i={update:Mpe(o,e.key,e.data),updateMask:mve(e.fieldMask)};else{if(!(e instanceof Wre))return PI();i={verify:JZ(o,e.key)}}return e.fieldTransforms.length>0&&(i.updateTransforms=e.fieldTransforms.map(d=>function(_,B){const _t=B.transform;if(_t instanceof PK)return{fieldPath:B.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(_t instanceof Y8)return{fieldPath:B.field.canonicalString(),appendMissingElements:{values:_t.elements}};if(_t instanceof M6)return{fieldPath:B.field.canonicalString(),removeAllFromArray:{values:_t.elements}};if(_t instanceof xK)return{fieldPath:B.field.canonicalString(),increment:_t.k};throw PI()}(0,d))),e.precondition.isNone||(i.currentDocument=void 0!==(_=e.precondition).updateTime?{updateTime:cve(o,_.updateTime)}:void 0!==_.exists?{exists:_.exists}:PI()),i;var _}function wue(o,e){const i=e.currentDocument?void 0!==(_=e.currentDocument).updateTime?xR.updateTime(bO(_.updateTime)):void 0!==_.exists?xR.exists(_.exists):xR.none():xR.none(),d=e.updateTransforms?e.updateTransforms.map(_=>function(B,_t){let _a=null;"setToServerValue"in _t?(QI("REQUEST_TIME"===_t.setToServerValue),_a=new PK):"appendMissingElements"in _t?_a=new Y8(_t.appendMissingElements.values||[]):"removeAllFromArray"in _t?_a=new M6(_t.removeAllFromArray.values||[]):"increment"in _t?_a=new xK(B,_t.increment):PI();const _h=PR.fromServerFormat(_t.fieldPath);return new HZ(_h,_a)}(o,_)):[];var _;if(e.update){const _=G4(o,e.update.name),B=new CN({mapValue:{fields:e.update.fields}});if(e.updateMask){const _t=new K8((e.updateMask.fieldPaths||[]).map(_g=>PR.fromServerFormat(_g)));return new GQ(_,B,_t,i,d)}return new qZ(_,B,i,d)}if(e.delete){const _=G4(o,e.delete);return new WZ(_,i)}if(e.verify){const _=G4(o,e.verify);return new Wre(_,i)}return PI()}function Jre(o,e){return{documents:[Eue(o,e.path)]}}function Bpe(o,e){const i={structuredQuery:{}},d=e.path;null!==e.collectionGroup?(i.parent=Eue(o,d),i.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i.parent=Eue(o,d.popLast()),i.structuredQuery.from=[{collectionId:d.lastSegment()}]);const _=function(_h){if(0===_h.length)return;const _g=_h.map(l_=>function(f_){if("=="===f_.op){if(lpe(f_.value))return{unaryFilter:{field:UK(f_.field),op:"IS_NAN"}};if(upe(f_.value))return{unaryFilter:{field:UK(f_.field),op:"IS_NULL"}}}else if("!="===f_.op){if(lpe(f_.value))return{unaryFilter:{field:UK(f_.field),op:"IS_NOT_NAN"}};if(upe(f_.value))return{unaryFilter:{field:UK(f_.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:UK(f_.field),op:pve(f_.op),value:f_.value}}}(l_));return 1===_g.length?_g[0]:{compositeFilter:{op:"AND",filters:_g}}}(e.filters);_&&(i.structuredQuery.where=_);const B=function(_h){if(0!==_h.length)return _h.map(_g=>{return{field:UK((l_=_g).field),direction:fve(l_.dir)};var l_})}(e.orderBy);B&&(i.structuredQuery.orderBy=B);const _t=(_g=e.limit,o.N||t3(_g)?_g:{value:_g});var _g,_a,_h;return null!==_t&&(i.structuredQuery.limit=_t),e.startAt&&(i.structuredQuery.startAt={before:(_a=e.startAt).inclusive,values:_a.position}),e.endAt&&(i.structuredQuery.endAt={before:!(_h=e.endAt).inclusive,values:_h.position}),i}function Upe(o){let e=Iue(o.parent);const i=o.structuredQuery,d=i.from?i.from.length:0;let _=null;if(d>0){QI(1===d);const l_=i.from[0];l_.allDescendants?_=l_.collectionId:e=e.child(l_.collectionId)}let B=[];i.where&&(B=Tue(i.where));let _t=[];i.orderBy&&(_t=i.orderBy.map(l_=>{return new VQ(FK((f_=l_).field),function(R_){switch(R_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(f_.direction));var f_}));let _a=null;i.limit&&(_a=function(l_){let f_;return f_="object"==typeof l_?l_.value:l_,t3(f_)?null:f_}(i.limit));let _h=null;var l_;i.startAt&&(_h=new x6((l_=i.startAt).values||[],!!l_.before));let _g=null;return i.endAt&&(_g=function(l_){return new x6(l_.values||[],!l_.before)}(i.endAt)),vpe(e,_,_t,B,_a,"F",_h,_g)}function Tue(o){return o?void 0!==o.unaryFilter?[Fpe(o)]:void 0!==o.fieldFilter?[gve(o)]:void 0!==o.compositeFilter?o.compositeFilter.filters.map(e=>Tue(e)).reduce((e,i)=>e.concat(i)):PI():[]}function fve(o){return xpe[o]}function pve(o){return sve[o]}function UK(o){return{fieldPath:o.canonicalString()}}function FK(o){return PR.fromServerFormat(o.fieldPath)}function gve(o){return IO.create(FK(o.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return PI()}}(o.fieldFilter.op),o.fieldFilter.value)}function Fpe(o){switch(o.unaryFilter.op){case"IS_NAN":const e=FK(o.unaryFilter.field);return IO.create(e,"==",{doubleValue:NaN});case"IS_NULL":const i=FK(o.unaryFilter.field);return IO.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const d=FK(o.unaryFilter.field);return IO.create(d,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const _=FK(o.unaryFilter.field);return IO.create(_,"!=",{nullValue:"NULL_VALUE"});default:return PI()}}function mve(o){const e=[];return o.fields.forEach(i=>e.push(i.canonicalString())),{fieldPaths:e}}function jpe(o){return o.length>=4&&"projects"===o.get(0)&&"databases"===o.get(2)}function nP(o){let e="";for(let i=0;i<o.length;i++)e.length>0&&(e=Vpe(e)),e=Sue(o.get(i),e);return Vpe(e)}function Sue(o,e){let i=e;const d=o.length;for(let _=0;_<d;_++){const B=o.charAt(_);switch(B){case"\0":i+="\x01\x10";break;case"\x01":i+="\x01\x11";break;default:i+=B}}return i}function Vpe(o){return o+"\x01\x01"}function Q4(o){const e=o.length;if(QI(e>=2),2===e)return QI("\x01"===o.charAt(0)&&"\x01"===o.charAt(1)),eT.emptyPath();const i=e-2,d=[];let _="";for(let B=0;B<e;){const _t=o.indexOf("\x01",B);switch((_t<0||_t>i)&&PI(),o.charAt(_t+1)){case"\x01":const _a=o.substring(B,_t);let _h;0===_.length?_h=_a:(_+=_a,_h=_,_=""),d.push(_h);break;case"\x10":_+=o.substring(B,_t),_+="\0";break;case"\x11":_+=o.substring(B,_t+1);break;default:PI()}B=_t+2}return new eT(d)}const Gpe=["userId","batchId"];function $re(o,e){return[o,nP(e)]}function Rue(o,e,i){return[o,nP(e),i]}const Ave={},_ve=["prefixPath","collectionGroup","readTime","documentId"],Qpe=["prefixPath","collectionGroup","documentId"],vve=["collectionGroup","readTime","prefixPath","documentId"],yve=["canonicalId","targetId"],Hpe=["targetId","path"],Eve=["path","targetId"],Ive=["collectionId","parent"],bve=["indexId","uid"],Cve=["uid","sequenceNumber"],wve=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Tve=["indexId","uid","orderedDocumentKey"],Sve=["userId","collectionPath","documentId"],Oue=["userId","collectionPath","largestBatchId"],Rve=["userId","collectionGroup","largestBatchId"],qpe=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Ove=[...qpe,"documentOverlays"],Wpe=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Due=[...Wpe,"indexConfiguration","indexState","indexEntries"],Kpe="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class gI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}class x0{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(i=>{this.isDone=!0,this.result=i,this.nextCallback&&this.nextCallback(i)},i=>{this.isDone=!0,this.error=i,this.catchCallback&&this.catchCallback(i)})}catch(e){return this.next(void 0,e)}next(e,i){return this.callbackAttached&&PI(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(i,this.error):this.wrapSuccess(e,this.result):new x0((d,_)=>{this.nextCallback=B=>{this.wrapSuccess(e,B).next(d,_)},this.catchCallback=B=>{this.wrapFailure(i,B).next(d,_)}})}toPromise(){return new Promise((e,i)=>{this.next(e,i)})}wrapUserFunction(e){try{const i=e();return i instanceof x0?i:x0.resolve(i)}catch(i){return x0.reject(i)}}wrapSuccess(e,i){return e?this.wrapUserFunction(()=>e(i)):x0.resolve(i)}wrapFailure(e,i){return e?this.wrapUserFunction(()=>e(i)):x0.reject(i)}static resolve(e){return new x0((i,d)=>{i(e)})}static reject(e){return new x0((i,d)=>{d(e)})}static waitFor(e){return new x0((i,d)=>{let _=0,B=0,_t=!1;e.forEach(_a=>{++_,_a.next(()=>{++B,_t&&B===_&&i()},_h=>d(_h))}),_t=!0,B===_&&i()})}static or(e){let i=x0.resolve(!1);for(const d of e)i=i.next(_=>_?x0.resolve(_):d());return i}static forEach(e,i){const d=[];return e.forEach((_,B)=>{d.push(i.call(this,_,B))}),this.waitFor(d)}}class Zre{constructor(e,i){this.action=e,this.transaction=i,this.aborted=!1,this.At=new sO,this.transaction.oncomplete=()=>{this.At.resolve()},this.transaction.onabort=()=>{i.error?this.At.reject(new ZZ(e,i.error)):this.At.resolve()},this.transaction.onerror=d=>{const _=Nue(d.target.error);this.At.reject(new ZZ(e,_))}}static open(e,i,d,_){try{return new Zre(i,e.transaction(_,d))}catch(B){throw new ZZ(i,B)}}get Rt(){return this.At.promise}abort(e){e&&this.At.reject(e),this.aborted||(nI("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}bt(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const i=this.transaction.objectStore(e);return new Nve(i)}}class r3{constructor(e,i,d){this.name=e,this.version=i,this.Pt=d,12.2===r3.Vt((0,M_.z$)())&&kR("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return nI("SimpleDb","Removing database:",e),rP(window.indexedDB.deleteDatabase(e)).toPromise()}static vt(){if(!(0,M_.hl)())return!1;if(r3.St())return!0;const e=(0,M_.z$)(),i=r3.Vt(e),d=0<i&&i<10,_=r3.Dt(e),B=0<_&&_<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||d||B)}static St(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.Ct)}static xt(e,i){return e.store(i)}static Vt(e){const i=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),d=i?i[1].split("_").slice(0,2).join("."):"-1";return Number(d)}static Dt(e){const i=e.match(/Android ([\d.]+)/i),d=i?i[1].split(".").slice(0,2).join("."):"-1";return Number(d)}Nt(e){var i=this;return(0,C0.Z)(function*(){return i.db||(nI("SimpleDb","Opening database:",i.name),i.db=yield new Promise((d,_)=>{const B=indexedDB.open(i.name,i.version);B.onsuccess=_t=>{d(_t.target.result)},B.onblocked=()=>{_(new ZZ(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},B.onerror=_t=>{const _a=_t.target.error;_("VersionError"===_a.name?new W0(T0.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===_a.name?new W0(T0.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+_a):new ZZ(e,_a))},B.onupgradeneeded=_t=>{nI("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',_t.oldVersion),i.Pt.kt(_t.target.result,B.transaction,_t.oldVersion,i.version).next(()=>{nI("SimpleDb","Database upgrade to version "+i.version+" complete")})}})),i.Mt&&(i.db.onversionchange=d=>i.Mt(d)),i.db})()}Ot(e){this.Mt=e,this.db&&(this.db.onversionchange=i=>e(i))}runTransaction(e,i,d,_){var B=this;return(0,C0.Z)(function*(){const _t="readonly"===i;let _a=0;for(;;){++_a;try{B.db=yield B.Nt(e);const _h=Zre.open(B.db,e,_t?"readonly":"readwrite",d),_g=_(_h).next(l_=>(_h.bt(),l_)).catch(l_=>(_h.abort(l_),x0.reject(l_))).toPromise();return _g.catch(()=>{}),yield _h.Rt,_g}catch(_h){const _g="FirebaseError"!==_h.name&&_a<3;if(nI("SimpleDb","Transaction failed with error:",_h.message,"Retrying:",_g),B.close(),!_g)return Promise.reject(_h)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Dve{constructor(e){this.Ft=e,this.$t=!1,this.Bt=null}get isDone(){return this.$t}get Lt(){return this.Bt}set cursor(e){this.Ft=e}done(){this.$t=!0}Ut(e){this.Bt=e}delete(){return rP(this.Ft.delete())}}class ZZ extends W0{constructor(e,i){super(T0.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${i}`),this.name="IndexedDbTransactionError"}}function U6(o){return"IndexedDbTransactionError"===o.name}class Nve{constructor(e){this.store=e}put(e,i){let d;return void 0!==i?(nI("SimpleDb","PUT",this.store.name,e,i),d=this.store.put(i,e)):(nI("SimpleDb","PUT",this.store.name,"<auto-key>",e),d=this.store.put(e)),rP(d)}add(e){return nI("SimpleDb","ADD",this.store.name,e,e),rP(this.store.add(e))}get(e){return rP(this.store.get(e)).next(i=>(void 0===i&&(i=null),nI("SimpleDb","GET",this.store.name,e,i),i))}delete(e){return nI("SimpleDb","DELETE",this.store.name,e),rP(this.store.delete(e))}count(){return nI("SimpleDb","COUNT",this.store.name),rP(this.store.count())}qt(e,i){const d=this.options(e,i);if(d.index||"function"!=typeof this.store.getAll){const _=this.cursor(d),B=[];return this.Kt(_,(_t,_a)=>{B.push(_a)}).next(()=>B)}{const _=this.store.getAll(d.range);return new x0((B,_t)=>{_.onerror=_a=>{_t(_a.target.error)},_.onsuccess=_a=>{B(_a.target.result)}})}}Gt(e,i){const d=this.store.getAll(e,null===i?void 0:i);return new x0((_,B)=>{d.onerror=_t=>{B(_t.target.error)},d.onsuccess=_t=>{_(_t.target.result)}})}Qt(e,i){nI("SimpleDb","DELETE ALL",this.store.name);const d=this.options(e,i);d.jt=!1;const _=this.cursor(d);return this.Kt(_,(B,_t,_a)=>_a.delete())}Wt(e,i){let d;i?d=e:(d={},i=e);const _=this.cursor(d);return this.Kt(_,i)}zt(e){const i=this.cursor({});return new x0((d,_)=>{i.onerror=B=>{const _t=Nue(B.target.error);_(_t)},i.onsuccess=B=>{const _t=B.target.result;_t?e(_t.primaryKey,_t.value).next(_a=>{_a?_t.continue():d()}):d()}})}Kt(e,i){const d=[];return new x0((_,B)=>{e.onerror=_t=>{B(_t.target.error)},e.onsuccess=_t=>{const _a=_t.target.result;if(!_a)return void _();const _h=new Dve(_a),_g=i(_a.primaryKey,_a.value,_h);if(_g instanceof x0){const l_=_g.catch(f_=>(_h.done(),x0.reject(f_)));d.push(l_)}_h.isDone?_():null===_h.Lt?_a.continue():_a.continue(_h.Lt)}}).next(()=>x0.waitFor(d))}options(e,i){let d;return void 0!==e&&("string"==typeof e?d=e:i=e),{index:d,range:i}}cursor(e){let i="next";if(e.reverse&&(i="prev"),e.index){const d=this.store.index(e.index);return e.jt?d.openKeyCursor(e.range,i):d.openCursor(e.range,i)}return this.store.openCursor(e.range,i)}}function rP(o){return new x0((e,i)=>{o.onsuccess=d=>{e(d.target.result)},o.onerror=d=>{const _=Nue(d.target.error);i(_)}})}let zpe=!1;function Nue(o){const e=r3.Vt((0,M_.z$)());if(e>=12.2&&e<13){const i="An internal error was encountered in the Indexed Database server";if(o.message.indexOf(i)>=0){const d=new W0("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${i}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return zpe||(zpe=!0,setTimeout(()=>{throw d},0)),d}}return o}class Ype extends gI{constructor(e,i){super(),this.Ht=e,this.currentSequenceNumber=i}}function WO(o,e){const i=pI(o);return r3.xt(i.Ht,e)}class kue{constructor(e,i,d,_){this.batchId=e,this.localWriteTime=i,this.baseMutations=d,this.mutations=_}applyToRemoteDocument(e,i){const d=i.mutationResults;for(let _=0;_<this.mutations.length;_++){const B=this.mutations[_];B.key.isEqual(e.key)&&gue(B,e,d[_])}}applyToLocalView(e){for(const i of this.baseMutations)i.key.isEqual(e.key)&&mue(i,e,this.localWriteTime);for(const i of this.mutations)i.key.isEqual(e.key)&&mue(i,e,this.localWriteTime)}applyToLocalDocumentSet(e){this.mutations.forEach(i=>{const d=e.get(i.key),_=d;this.applyToLocalView(_),d.isValidDocument()||_.convertToNoDocument(a1.min())})}keys(){return this.mutations.reduce((e,i)=>e.add(i.key),CT())}isEqual(e){return this.batchId===e.batchId&&xQ(this.mutations,e.mutations,(i,d)=>Spe(i,d))&&xQ(this.baseMutations,e.baseMutations,(i,d)=>Spe(i,d))}}class XZ{constructor(e,i,d,_){this.batch=e,this.commitVersion=i,this.mutationResults=d,this.docVersions=_}static from(e,i,d){QI(e.mutations.length===d.length);let _=rve;const B=e.mutations;for(let _t=0;_t<B.length;_t++)_=_.insert(B[_t].key,d[_t].version);return new XZ(e,i,d,_)}}class Pue{constructor(e,i){this.largestBatchId=e,this.mutation=i}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class $P{constructor(e,i,d,_,B=a1.min(),_t=a1.min(),_a=aO.EMPTY_BYTE_STRING){this.target=e,this.targetId=i,this.purpose=d,this.sequenceNumber=_,this.snapshotVersion=B,this.lastLimboFreeSnapshotVersion=_t,this.resumeToken=_a}withSequenceNumber(e){return new $P(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,i){return new $P(this.target,this.targetId,this.purpose,this.sequenceNumber,i,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new $P(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class xue{constructor(e){this.Jt=e}}function eX(o,e){const i=e.key,d={prefixPath:i.getCollectionPath().popLast().toArray(),collectionGroup:i.collectionGroup,documentId:i.path.lastSegment(),readTime:jK(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())d.document={name:JZ(_=o.Jt,(B=e).key),fields:B.data.value.mapValue.fields,updateTime:YZ(_,B.version.toTimestamp())};else if(e.isNoDocument())d.noDocument={path:i.path.toArray(),readTime:KO(e.version)};else{if(!e.isUnknownDocument())return PI();d.unknownDocument={path:i.path.toArray(),version:KO(e.version)}}var _,B;return d}function jK(o){const e=o.toTimestamp();return[e.seconds,e.nanoseconds]}function KO(o){const e=o.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function QQ(o){const e=new XS(o.seconds,o.nanoseconds);return a1.fromTimestamp(e)}function $8(o,e){const i=(e.baseMutations||[]).map(B=>wue(o.Jt,B));for(let B=0;B<e.mutations.length-1;++B){const _t=e.mutations[B];B+1<e.mutations.length&&void 0!==e.mutations[B+1].transform&&(_t.updateTransforms=e.mutations[B+1].transform.fieldTransforms,e.mutations.splice(B+1,1),++B)}const d=e.mutations.map(B=>wue(o.Jt,B)),_=XS.fromMillis(e.localWriteTimeMs);return new kue(e.batchId,_,i,d)}function _S(o){const e=QQ(o.readTime),i=void 0!==o.lastLimboFreeSnapshotVersion?QQ(o.lastLimboFreeSnapshotVersion):a1.min();let d;var _;return void 0!==o.query.documents?(QI(1===(_=o.query).documents.length),d=UM(DK(Iue(_.documents[0])))):d=UM(Upe(o.query)),new $P(d,o.targetId,0,o.lastListenSequenceNumber,e,i,aO.fromBase64String(o.resumeToken))}function Xre(o,e){const i=KO(e.snapshotVersion),d=KO(e.lastLimboFreeSnapshotVersion);let _;_=RK(e.target)?Jre(o.Jt,e.target):Bpe(o.Jt,e.target);const B=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:jQ(e.target),readTime:i,resumeToken:B,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:d,query:_}}function l2(o){const e=Upe({parent:o.parent,structuredQuery:o.structuredQuery});return"LAST"===o.limitType?cue(e,e.limit,"L"):e}function eie(o,e){return new Pue(e.largestBatchId,wue(o.Jt,e.overlayMutation))}function Lue(o,e){const i=e.path.lastSegment();return[o,nP(e.path.popLast()),i]}class $pe{getBundleMetadata(e,i){return Pb(e).get(i).next(d=>{if(d)return{id:(_=d).bundleId,createTime:QQ(_.createTime),version:_.version};var _})}saveBundleMetadata(e,i){return Pb(e).put({bundleId:(d=i).id,createTime:KO(bO(d.createTime)),version:d.version});var d}getNamedQuery(e,i){return HQ(e).get(i).next(d=>{if(d)return{name:(_=d).name,query:l2(_.bundledQuery),readTime:QQ(_.readTime)};var _})}saveNamedQuery(e,i){return HQ(e).put({name:(d=i).name,readTime:KO(bO(d.readTime)),bundledQuery:d.bundledQuery});var d}}function Pb(o){return WO(o,"bundles")}function HQ(o){return WO(o,"namedQueries")}class VK{constructor(e,i){this.M=e,this.userId=i}static Yt(e,i){return new VK(e,i.uid||"")}getOverlay(e,i){return w0(e).get(Lue(this.userId,i)).next(d=>d?eie(this.M,d):null)}saveOverlays(e,i,d){const _=[];return d.forEach((B,_t)=>{const _a=new Pue(i,_t);_.push(this.Xt(e,_a))}),x0.waitFor(_)}removeOverlaysForBatchId(e,i,d){const _=new Set;i.forEach(_t=>_.add(nP(_t.getCollectionPath())));const B=[];return _.forEach(_t=>{const _a=IDBKeyRange.bound([this.userId,_t,d],[this.userId,_t,d+1],!1,!0);B.push(w0(e).Qt("collectionPathOverlayIndex",_a))}),x0.waitFor(B)}getOverlaysForCollection(e,i,d){const _=LK(),B=nP(i),_t=IDBKeyRange.bound([this.userId,B,d],[this.userId,B,Number.POSITIVE_INFINITY],!0);return w0(e).qt("collectionPathOverlayIndex",_t).next(_a=>{for(const _h of _a){const _g=eie(this.M,_h);_.set(_g.getKey(),_g)}return _})}getOverlaysForCollectionGroup(e,i,d,_){const B=LK();let _t;const _a=IDBKeyRange.bound([this.userId,i,d],[this.userId,i,Number.POSITIVE_INFINITY],!0);return w0(e).Wt({index:"collectionGroupOverlayIndex",range:_a},(_h,_g,l_)=>{const f_=eie(this.M,_g);B.size()<_||f_.largestBatchId===_t?(B.set(f_.getKey(),f_),_t=f_.largestBatchId):l_.done()}).next(()=>B)}Xt(e,i){return w0(e).put(function(d,_,B){const[_t,_a,_h]=Lue(_,B.mutation.key);return{userId:_,collectionPath:_a,documentId:_h,collectionGroup:B.mutation.key.getCollectionGroup(),largestBatchId:B.largestBatchId,overlayMutation:$Z(d.Jt,B.mutation)}}(this.M,this.userId,i))}}function w0(o){return WO(o,"documentOverlays")}class Z8{constructor(){}Zt(e,i){this.te(e,i),i.ee()}te(e,i){if("nullValue"in e)this.ne(i,5);else if("booleanValue"in e)this.ne(i,10),i.se(e.booleanValue?1:0);else if("integerValue"in e)this.ne(i,15),i.se(eR(e.integerValue));else if("doubleValue"in e){const d=eR(e.doubleValue);isNaN(d)?this.ne(i,13):(this.ne(i,15),xZ(d)?i.se(0):i.se(d))}else if("timestampValue"in e){const d=e.timestampValue;this.ne(i,20),"string"==typeof d?i.ie(d):(i.ie(`${d.seconds||""}`),i.se(d.nanos||0))}else if("stringValue"in e)this.re(e.stringValue,i),this.oe(i);else if("bytesValue"in e)this.ne(i,30),i.ue(QL(e.bytesValue)),this.oe(i);else if("referenceValue"in e)this.ae(e.referenceValue,i);else if("geoPointValue"in e){const d=e.geoPointValue;this.ne(i,45),i.se(d.latitude||0),i.se(d.longitude||0)}else"mapValue"in e?dpe(e)?this.ne(i,Number.MAX_SAFE_INTEGER):(this.ce(e.mapValue,i),this.oe(i)):"arrayValue"in e?(this.he(e.arrayValue,i),this.oe(i)):PI()}re(e,i){this.ne(i,25),this.le(e,i)}le(e,i){i.ie(e)}ce(e,i){const d=e.fields||{};this.ne(i,55);for(const _ of Object.keys(d))this.re(_,i),this.te(d[_],i)}he(e,i){const d=e.values||[];this.ne(i,50);for(const _ of d)this.te(_,i)}ae(e,i){this.ne(i,37),fI.fromName(e).path.forEach(d=>{this.ne(i,60),this.le(d,i)})}ne(e,i){e.se(i)}oe(e){e.se(2)}}function US(o){if(0===o)return 8;let e=0;return o>>4==0&&(e+=4,o<<=4),o>>6==0&&(e+=2,o<<=2),o>>7==0&&(e+=1),e}function tie(o){const e=64-function(i){let d=0;for(let _=0;_<8;++_){const B=US(255&i[_]);if(d+=B,8!==B)break}return d}(o);return Math.ceil(e/8)}Z8.fe=new Z8;class Zpe{constructor(){this.buffer=new Uint8Array(1024),this.position=0}de(e){const i=e[Symbol.iterator]();let d=i.next();for(;!d.done;)this._e(d.value),d=i.next();this.we()}me(e){const i=e[Symbol.iterator]();let d=i.next();for(;!d.done;)this.ge(d.value),d=i.next();this.ye()}pe(e){for(const i of e){const d=i.charCodeAt(0);if(d<128)this._e(d);else if(d<2048)this._e(960|d>>>6),this._e(128|63&d);else if(i<"\ud800"||"\udbff"<i)this._e(480|d>>>12),this._e(128|63&d>>>6),this._e(128|63&d);else{const _=i.codePointAt(0);this._e(240|_>>>18),this._e(128|63&_>>>12),this._e(128|63&_>>>6),this._e(128|63&_)}}this.we()}Ie(e){for(const i of e){const d=i.charCodeAt(0);if(d<128)this.ge(d);else if(d<2048)this.ge(960|d>>>6),this.ge(128|63&d);else if(i<"\ud800"||"\udbff"<i)this.ge(480|d>>>12),this.ge(128|63&d>>>6),this.ge(128|63&d);else{const _=i.codePointAt(0);this.ge(240|_>>>18),this.ge(128|63&_>>>12),this.ge(128|63&_>>>6),this.ge(128|63&_)}}this.ye()}Te(e){const i=this.Ee(e),d=tie(i);this.Ae(1+d),this.buffer[this.position++]=255&d;for(let _=i.length-d;_<i.length;++_)this.buffer[this.position++]=255&i[_]}Re(e){const i=this.Ee(e),d=tie(i);this.Ae(1+d),this.buffer[this.position++]=~(255&d);for(let _=i.length-d;_<i.length;++_)this.buffer[this.position++]=~(255&i[_])}be(){this.Pe(255),this.Pe(255)}Ve(){this.ve(255),this.ve(255)}reset(){this.position=0}seed(e){this.Ae(e.length),this.buffer.set(e,this.position),this.position+=e.length}Se(){return this.buffer.slice(0,this.position)}Ee(e){const i=function(_){const B=new DataView(new ArrayBuffer(8));return B.setFloat64(0,_,!1),new Uint8Array(B.buffer)}(e),d=0!=(128&i[0]);i[0]^=d?255:128;for(let _=1;_<i.length;++_)i[_]^=d?255:0;return i}_e(e){const i=255&e;0===i?(this.Pe(0),this.Pe(255)):255===i?(this.Pe(255),this.Pe(0)):this.Pe(i)}ge(e){const i=255&e;0===i?(this.ve(0),this.ve(255)):255===i?(this.ve(255),this.ve(0)):this.ve(e)}we(){this.Pe(0),this.Pe(1)}ye(){this.ve(0),this.ve(1)}Pe(e){this.Ae(1),this.buffer[this.position++]=e}ve(e){this.Ae(1),this.buffer[this.position++]=~e}Ae(e){const i=e+this.position;if(i<=this.buffer.length)return;let d=2*this.buffer.length;d<i&&(d=i);const _=new Uint8Array(d);_.set(this.buffer),this.buffer=_}}class kve{constructor(e){this.De=e}ue(e){this.De.de(e)}ie(e){this.De.pe(e)}se(e){this.De.Te(e)}ee(){this.De.be()}}class iP{constructor(e){this.De=e}ue(e){this.De.me(e)}ie(e){this.De.Ie(e)}se(e){this.De.Re(e)}ee(){this.De.Ve()}}class H4{constructor(){this.De=new Zpe,this.Ce=new kve(this.De),this.xe=new iP(this.De)}seed(e){this.De.seed(e)}Ne(e){return 0===e?this.Ce:this.xe}Se(){return this.De.Se()}reset(){this.De.reset()}}class F6{constructor(e,i,d,_){this.indexId=e,this.documentKey=i,this.arrayValue=d,this.directionalValue=_}ke(){const e=this.directionalValue.length,i=0===e||255===this.directionalValue[e-1]?e+1:e,d=new Uint8Array(i);return d.set(this.directionalValue,0),i!==e?d.set([0],this.directionalValue.length):++d[d.length-1],new F6(this.indexId,this.documentKey,this.arrayValue,d)}}function j6(o,e){let i=o.indexId-e.indexId;return 0!==i?i:(i=tX(o.arrayValue,e.arrayValue),0!==i?i:(i=tX(o.directionalValue,e.directionalValue),0!==i?i:fI.comparator(o.documentKey,e.documentKey)))}function tX(o,e){for(let i=0;i<o.length&&i<e.length;++i){const d=o[i]-e[i];if(0!==d)return d}return o.length-e.length}class Xpe{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Me=e.orderBy,this.Oe=[];for(const i of e.filters){const d=i;d.S()?this.Fe=d:this.Oe.push(d)}}$e(e){const i=nue(e);if(void 0!==i&&!this.Be(i))return!1;const d=BQ(e);let _=0,B=0;for(;_<d.length&&this.Be(d[_]);++_);if(_===d.length)return!0;if(void 0!==this.Fe){const _t=d[_];if(!this.Le(this.Fe,_t)||!this.Ue(this.Me[B++],_t))return!1;++_}for(;_<d.length;++_){const _t=d[_];if(B>=this.Me.length||!this.Ue(this.Me[B++],_t))return!1}return!0}Be(e){for(const i of this.Oe)if(this.Le(i,e))return!0;return!1}Le(e,i){return!(void 0===e||!e.field.isEqual(i.fieldPath))&&2===i.kind==("array-contains"===e.op||"array-contains-any"===e.op)}Ue(e,i){return!!e.field.isEqual(i.fieldPath)&&(0===i.kind&&"asc"===e.dir||1===i.kind&&"desc"===e.dir)}}class qL{constructor(){this.qe=new g1}addToCollectionParentIndex(e,i){return this.qe.add(i),x0.resolve()}getCollectionParents(e,i){return x0.resolve(this.qe.getEntries(i))}addFieldIndex(e,i){return x0.resolve()}deleteFieldIndex(e,i){return x0.resolve()}getDocumentsMatchingTarget(e,i){return x0.resolve(null)}getIndexType(e,i){return x0.resolve(0)}getFieldIndexes(e,i){return x0.resolve([])}getNextCollectionGroupToUpdate(e){return x0.resolve(null)}getMinOffset(e,i){return x0.resolve(BM.min())}updateCollectionGroup(e,i,d){return x0.resolve()}updateIndexEntries(e,i){return x0.resolve()}}class g1{constructor(){this.index={}}add(e){const i=e.lastSegment(),d=e.popLast(),_=this.index[i]||new hT(eT.comparator),B=!_.has(d);return this.index[i]=_.add(d),B}has(e){const i=e.lastSegment(),d=e.popLast(),_=this.index[i];return _&&_.has(d)}getEntries(e){return(this.index[e]||new hT(eT.comparator)).toArray()}}const nie=new Uint8Array(0);class nX{constructor(e,i){this.user=e,this.databaseId=i,this.Ke=new g1,this.Ge=new J8(d=>jQ(d),(d,_)=>SK(d,_)),this.uid=e.uid||""}addToCollectionParentIndex(e,i){if(!this.Ke.has(i)){const d=i.lastSegment(),_=i.popLast();e.addOnCommittedListener(()=>{this.Ke.add(i)});const B={collectionId:d,parent:nP(_)};return GK(e).put(B)}return x0.resolve()}getCollectionParents(e,i){const d=[],_=IDBKeyRange.bound([i,""],[NZ(i),""],!1,!0);return GK(e).qt(_).next(B=>{for(const _t of B){if(_t.collectionId!==i)break;d.push(Q4(_t.parent))}return d})}addFieldIndex(e,i){const d=QK(e),_={indexId:(B=i).indexId,collectionGroup:B.collectionGroup,fields:B.fields.map(_t=>[_t.fieldPath.canonicalString(),_t.kind])};var B;return delete _.indexId,d.add(_).next()}deleteFieldIndex(e,i){const d=QK(e),_=i3(e),B=qQ(e);return d.delete(i.indexId).next(()=>_.delete(IDBKeyRange.bound([i.indexId],[i.indexId+1],!1,!0))).next(()=>B.delete(IDBKeyRange.bound([i.indexId],[i.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,i){const d=qQ(e);let _=!0;const B=new Map;return x0.forEach(this.Qe(i),_t=>this.je(e,_t).next(_a=>{_&&(_=!!_a),B.set(_t,_a)})).next(()=>{if(_){let _t=CT();const _a=[];return x0.forEach(B,(_h,_g)=>{var l_;nI("IndexedDbIndexManager",`Using index ${l_=_h,`id=${l_.indexId}|cg=${l_.collectionGroup}|f=${l_.fields.map(xI=>`${xI.fieldPath}:${xI.kind}`).join(",")}`} to execute ${jQ(i)}`);const f_=function(xI,DI){const _C=nue(DI);if(void 0===_C)return null;for(const G1 of UZ(xI,_C.fieldPath))switch(G1.op){case"array-contains-any":return G1.value.arrayValue.values||[];case"array-contains":return[G1.value]}return null}(_g,_h),R_=function(xI,DI){const _C=new Map;for(const G1 of BQ(DI))for(const BR of UZ(xI,G1.fieldPath))switch(BR.op){case"==":case"in":_C.set(G1.fieldPath.canonicalString(),BR.value);break;case"not-in":case"!=":return _C.set(G1.fieldPath.canonicalString(),BR.value),Array.from(_C.values())}return null}(_g,_h),H_=function(xI,DI){const _C=[];let G1=!0;for(const BR of BQ(DI)){const p2=0===BR.kind?OK(xI,BR.fieldPath,xI.startAt):mpe(xI,BR.fieldPath,xI.startAt);_C.push(p2.value),G1&&(G1=p2.inclusive)}return new x6(_C,G1)}(_g,_h),W_=function(xI,DI){const _C=[];let G1=!0;for(const BR of BQ(DI)){const p2=0===BR.kind?mpe(xI,BR.fieldPath,xI.endAt):OK(xI,BR.fieldPath,xI.endAt);_C.push(p2.value),G1&&(G1=p2.inclusive)}return new x6(_C,G1)}(_g,_h),R0=this.We(_h,_g,H_),H0=this.We(_h,_g,W_),CI=this.ze(_h,_g,R_),LI=this.He(_h.indexId,f_,R0,H_.inclusive,H0,W_.inclusive,CI);return x0.forEach(LI,xI=>d.Gt(xI,i.limit).next(DI=>{DI.forEach(_C=>{const G1=fI.fromSegments(_C.documentKey);_t.has(G1)||(_t=_t.add(G1),_a.push(G1))})}))}).next(()=>_a)}return x0.resolve(null)})}Qe(e){let i=this.Ge.get(e);return i||(i=[e],this.Ge.set(e,i),i)}He(e,i,d,_,B,_t,_a){const _h=(null!=i?i.length:1)*Math.max(d.length,B.length),_g=_h/(null!=i?i.length:1),l_=[];for(let f_=0;f_<_h;++f_){const R_=i?this.Je(i[f_/_g]):nie,H_=this.Ye(e,R_,d[f_%_g],_),W_=this.Xe(e,R_,B[f_%_g],_t),R0=_a.map(H0=>this.Ye(e,R_,H0,!0));l_.push(...this.createRange(H_,W_,R0))}return l_}Ye(e,i,d,_){const B=new F6(e,fI.empty(),i,d);return _?B:B.ke()}Xe(e,i,d,_){const B=new F6(e,fI.empty(),i,d);return _?B.ke():B}je(e,i){const d=new Xpe(i),_=null!=i.collectionGroup?i.collectionGroup:i.path.lastSegment();return this.getFieldIndexes(e,_).next(B=>{let _t=null;for(const _a of B)d.$e(_a)&&(!_t||_a.fields.length>_t.fields.length)&&(_t=_a);return _t})}getIndexType(e,i){let d=2;return x0.forEach(this.Qe(i),_=>this.je(e,_).next(B=>{B?0!==d&&B.fields.length<function(_t){let _a=new hT(PR.comparator),_h=!1;for(const _g of _t.filters){const l_=_g;l_.field.isKeyField()||("array-contains"===l_.op||"array-contains-any"===l_.op?_h=!0:_a=_a.add(l_.field))}for(const _g of _t.orderBy)_g.field.isKeyField()||(_a=_a.add(_g.field));return _a.size+(_h?1:0)}(_)&&(d=1):d=0})).next(()=>d)}Ze(e,i){const d=new H4;for(const _ of BQ(e)){const B=i.data.field(_.fieldPath);if(null==B)return null;const _t=d.Ne(_.kind);Z8.fe.Zt(B,_t)}return d.Se()}Je(e){const i=new H4;return Z8.fe.Zt(e,i.Ne(0)),i.Se()}tn(e,i){const d=new H4;return Z8.fe.Zt(MQ(this.databaseId,i),d.Ne(function(_){const B=BQ(_);return 0===B.length?0:B[B.length-1].kind}(e))),d.Se()}ze(e,i,d){if(null===d)return[];let _=[];_.push(new H4);let B=0;for(const _t of BQ(e)){const _a=d[B++];for(const _h of _)if(this.en(i,_t.fieldPath)&&MZ(_a))_=this.nn(_,_t,_a);else{const _g=_h.Ne(_t.kind);Z8.fe.Zt(_a,_g)}}return this.sn(_)}We(e,i,d){return this.ze(e,i,d.position)}sn(e){const i=[];for(let d=0;d<e.length;++d)i[d]=e[d].Se();return i}nn(e,i,d){const _=[...e],B=[];for(const _t of d.arrayValue.values||[])for(const _a of _){const _h=new H4;_h.seed(_a.Se()),Z8.fe.Zt(_t,_h.Ne(i.kind)),B.push(_h)}return B}en(e,i){return!!e.filters.find(d=>d instanceof IO&&d.field.isEqual(i)&&("in"===d.op||"not-in"===d.op))}getFieldIndexes(e,i){const d=QK(e),_=i3(e);return(i?d.qt("collectionGroupIndex",IDBKeyRange.bound(i,i)):d.qt()).next(B=>{const _t=[];return x0.forEach(B,_a=>_.get([_a.indexId,this.uid]).next(_h=>{_t.push(function(_g,l_){const f_=l_?new TK(l_.sequenceNumber,new BM(QQ(l_.readTime),new fI(Q4(l_.documentKey)),l_.largestBatchId)):TK.empty(),R_=_g.fields.map(([H_,W_])=>new Ure(PR.fromServerFormat(H_),W_));return new Bre(_g.indexId,_g.collectionGroup,R_,f_)}(_a,_h))})).next(()=>_t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(i=>0===i.length?null:(i.sort((d,_)=>{const B=d.indexState.sequenceNumber-_.indexState.sequenceNumber;return 0!==B?B:R1(d.collectionGroup,_.collectionGroup)}),i[0].collectionGroup))}updateCollectionGroup(e,i,d){const _=QK(e),B=i3(e);return this.rn(e).next(_t=>_.qt("collectionGroupIndex",IDBKeyRange.bound(i,i)).next(_a=>x0.forEach(_a,_h=>{return B.put({indexId:_h.indexId,uid:this.user.uid||"",sequenceNumber:_t,readTime:KO((R_=d).readTime),documentKey:nP(R_.documentKey.path),largestBatchId:R_.largestBatchId});var R_})))}updateIndexEntries(e,i){const d=new Map;return x0.forEach(i,(_,B)=>{const _t=d.get(_.collectionGroup);return(_t?x0.resolve(_t):this.getFieldIndexes(e,_.collectionGroup)).next(_a=>(d.set(_.collectionGroup,_a),x0.forEach(_a,_h=>this.on(e,_,_h).next(_g=>{const l_=this.un(B,_h);return _g.isEqual(l_)?x0.resolve():this.an(e,B,_h,_g,l_)}))))})}cn(e,i,d,_){return qQ(e).put({indexId:_.indexId,uid:this.uid,arrayValue:_.arrayValue,directionalValue:_.directionalValue,orderedDocumentKey:this.tn(d,i.key),documentKey:i.key.path.toArray()})}hn(e,i,d,_){return qQ(e).delete([_.indexId,this.uid,_.arrayValue,_.directionalValue,this.tn(d,i.key),i.key.path.toArray()])}on(e,i,d){const _=qQ(e);let B=new hT(j6);return _.Wt({index:"documentKeyIndex",range:IDBKeyRange.only([d.indexId,this.uid,this.tn(d,i)])},(_t,_a)=>{B=B.add(new F6(d.indexId,i,_a.arrayValue,_a.directionalValue))}).next(()=>B)}un(e,i){let d=new hT(j6);const _=this.Ze(i,e);if(null==_)return d;const B=nue(i);if(null!=B){const _t=e.data.field(B.fieldPath);if(MZ(_t))for(const _a of _t.arrayValue.values||[])d=d.add(new F6(i.indexId,e.key,this.Je(_a),_))}else d=d.add(new F6(i.indexId,e.key,nie,_));return d}an(e,i,d,_,B){nI("IndexedDbIndexManager","Updating index entries for document '%s'",i.key);const _t=[];return function(_a,_h,_g,l_,f_){const R_=_a.getIterator(),H_=_h.getIterator();let W_=UQ(R_),R0=UQ(H_);for(;W_||R0;){let H0=!1,CI=!1;if(W_&&R0){const LI=_g(W_,R0);LI<0?CI=!0:LI>0&&(H0=!0)}else null!=W_?CI=!0:H0=!0;H0?(l_(R0),R0=UQ(H_)):CI?(f_(W_),W_=UQ(R_)):(W_=UQ(R_),R0=UQ(H_))}}(_,B,j6,_a=>{_t.push(this.cn(e,i,d,_a))},_a=>{_t.push(this.hn(e,i,d,_a))}),x0.waitFor(_t)}rn(e){let i=1;return i3(e).Wt({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(d,_,B)=>{B.done(),i=_.sequenceNumber+1}).next(()=>i)}createRange(e,i,d){d=d.sort((_t,_a)=>j6(_t,_a)).filter((_t,_a,_h)=>!_a||0!==j6(_t,_h[_a-1]));const _=[];_.push(e);for(const _t of d){const _a=j6(_t,e),_h=j6(_t,i);if(0===_a)_[0]=e.ke();else if(_a>0&&_h<0)_.push(_t),_.push(_t.ke());else if(_h>0)break}_.push(i);const B=[];for(let _t=0;_t<_.length;_t+=2)B.push(IDBKeyRange.bound([_[_t].indexId,this.uid,_[_t].arrayValue,_[_t].directionalValue,nie,[]],[_[_t+1].indexId,this.uid,_[_t+1].arrayValue,_[_t+1].directionalValue,nie,[]]));return B}getMinOffset(e,i){let d;return x0.forEach(this.Qe(i),_=>this.je(e,_).next(B=>{B?(!d||rue(B.indexState.offset,d)<0)&&(d=B.indexState.offset):d=BM.min()})).next(()=>d)}}function GK(o){return WO(o,"collectionParents")}function qQ(o){return WO(o,"indexEntries")}function QK(o){return WO(o,"indexConfiguration")}function i3(o){return WO(o,"indexState")}const ege={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class oP{constructor(e,i,d){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=i,this.maximumSequenceNumbersToCollect=d}static withCacheSize(e){return new oP(e,oP.DEFAULT_COLLECTION_PERCENTILE,oP.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Mue(o,e,i){const d=o.store("mutations"),_=o.store("documentMutations"),B=[],_t=IDBKeyRange.only(i.batchId);let _a=0;const _h=d.Wt({range:_t},(l_,f_,R_)=>(_a++,R_.delete()));B.push(_h.next(()=>{QI(1===_a)}));const _g=[];for(const l_ of i.mutations){const f_=Rue(e,l_.key.path,i.batchId);B.push(_.delete(f_)),_g.push(l_.key)}return x0.waitFor(B).next(()=>_g)}function rX(o){if(!o)return 0;let e;if(o.document)e=o.document;else if(o.unknownDocument)e=o.unknownDocument;else{if(!o.noDocument)throw PI();e=o.noDocument}return JSON.stringify(e).length}oP.DEFAULT_COLLECTION_PERCENTILE=10,oP.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,oP.DEFAULT=new oP(41943040,oP.DEFAULT_COLLECTION_PERCENTILE,oP.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),oP.DISABLED=new oP(-1,0,0);class iX{constructor(e,i,d,_){this.userId=e,this.M=i,this.indexManager=d,this.referenceDelegate=_,this.ln={}}static Yt(e,i,d,_){QI(""!==e.uid);const B=e.isAuthenticated()?e.uid:"";return new iX(B,i,d,_)}checkEmpty(e){let i=!0;const d=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return q4(e).Wt({index:"userMutationsIndex",range:d},(_,B,_t)=>{i=!1,_t.done()}).next(()=>i)}addMutationBatch(e,i,d,_){const B=WQ(e),_t=q4(e);return _t.add({}).next(_a=>{QI("number"==typeof _a);const _h=new kue(_a,i,d,_),_g=function(R_,H_,W_){const R0=W_.baseMutations.map(CI=>$Z(R_.Jt,CI)),H0=W_.mutations.map(CI=>$Z(R_.Jt,CI));return{userId:H_,batchId:W_.batchId,localWriteTimeMs:W_.localWriteTime.toMillis(),baseMutations:R0,mutations:H0}}(this.M,this.userId,_h),l_=[];let f_=new hT((R_,H_)=>R1(R_.canonicalString(),H_.canonicalString()));for(const R_ of _){const H_=Rue(this.userId,R_.key.path,_a);f_=f_.add(R_.key.path.popLast()),l_.push(_t.put(_g)),l_.push(B.put(H_,Ave))}return f_.forEach(R_=>{l_.push(this.indexManager.addToCollectionParentIndex(e,R_))}),e.addOnCommittedListener(()=>{this.ln[_a]=_h.keys()}),x0.waitFor(l_).next(()=>_h)})}lookupMutationBatch(e,i){return q4(e).get(i).next(d=>d?(QI(d.userId===this.userId),$8(this.M,d)):null)}fn(e,i){return this.ln[i]?x0.resolve(this.ln[i]):this.lookupMutationBatch(e,i).next(d=>{if(d){const _=d.keys();return this.ln[i]=_,_}return null})}getNextMutationBatchAfterBatchId(e,i){const d=i+1,_=IDBKeyRange.lowerBound([this.userId,d]);let B=null;return q4(e).Wt({index:"userMutationsIndex",range:_},(_t,_a,_h)=>{_a.userId===this.userId&&(QI(_a.batchId>=d),B=$8(this.M,_a)),_h.done()}).next(()=>B)}getHighestUnacknowledgedBatchId(e){const i=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let d=-1;return q4(e).Wt({index:"userMutationsIndex",range:i,reverse:!0},(_,B,_t)=>{d=B.batchId,_t.done()}).next(()=>d)}getAllMutationBatches(e){const i=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return q4(e).qt("userMutationsIndex",i).next(d=>d.map(_=>$8(this.M,_)))}getAllMutationBatchesAffectingDocumentKey(e,i){const d=$re(this.userId,i.path),_=IDBKeyRange.lowerBound(d),B=[];return WQ(e).Wt({range:_},(_t,_a,_h)=>{const[_g,l_,f_]=_t,R_=Q4(l_);if(_g===this.userId&&i.path.isEqual(R_))return q4(e).get(f_).next(H_=>{if(!H_)throw PI();QI(H_.userId===this.userId),B.push($8(this.M,H_))});_h.done()}).next(()=>B)}getAllMutationBatchesAffectingDocumentKeys(e,i){let d=new hT(R1);const _=[];return i.forEach(B=>{const _t=$re(this.userId,B.path),_a=IDBKeyRange.lowerBound(_t),_h=WQ(e).Wt({range:_a},(_g,l_,f_)=>{const[R_,H_,W_]=_g,R0=Q4(H_);R_===this.userId&&B.path.isEqual(R0)?d=d.add(W_):f_.done()});_.push(_h)}),x0.waitFor(_).next(()=>this.dn(e,d))}getAllMutationBatchesAffectingQuery(e,i){const d=i.path,_=d.length+1,B=$re(this.userId,d),_t=IDBKeyRange.lowerBound(B);let _a=new hT(R1);return WQ(e).Wt({range:_t},(_h,_g,l_)=>{const[f_,R_,H_]=_h,W_=Q4(R_);f_===this.userId&&d.isPrefixOf(W_)?W_.length===_&&(_a=_a.add(H_)):l_.done()}).next(()=>this.dn(e,_a))}dn(e,i){const d=[],_=[];return i.forEach(B=>{_.push(q4(e).get(B).next(_t=>{if(null===_t)throw PI();QI(_t.userId===this.userId),d.push($8(this.M,_t))}))}),x0.waitFor(_).next(()=>d)}removeMutationBatch(e,i){return Mue(e.Ht,this.userId,i).next(d=>(e.addOnCommittedListener(()=>{this._n(i.batchId)}),x0.forEach(d,_=>this.referenceDelegate.markPotentiallyOrphaned(e,_))))}_n(e){delete this.ln[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(i=>{if(!i)return x0.resolve();const d=IDBKeyRange.lowerBound([this.userId]),_=[];return WQ(e).Wt({range:d},(B,_t,_a)=>{if(B[0]===this.userId){const _h=Q4(B[1]);_.push(_h)}else _a.done()}).next(()=>{QI(0===_.length)})})}containsKey(e,i){return tge(e,this.userId,i)}wn(e){return rie(e).get(this.userId).next(i=>i||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function tge(o,e,i){const d=$re(e,i.path),_=d[1],B=IDBKeyRange.lowerBound(d);let _t=!1;return WQ(o).Wt({range:B,jt:!0},(_a,_h,_g)=>{const[l_,f_,R_]=_a;l_===e&&f_===_&&(_t=!0),_g.done()}).next(()=>_t)}function q4(o){return WO(o,"mutations")}function WQ(o){return WO(o,"documentMutations")}function rie(o){return WO(o,"mutationQueues")}class W4{constructor(e){this.mn=e}next(){return this.mn+=2,this.mn}static gn(){return new W4(0)}static yn(){return new W4(-1)}}class nge{constructor(e,i){this.referenceDelegate=e,this.M=i}allocateTargetId(e){return this.pn(e).next(i=>{const d=new W4(i.highestTargetId);return i.highestTargetId=d.next(),this.In(e,i).next(()=>i.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.pn(e).next(i=>a1.fromTimestamp(new XS(i.lastRemoteSnapshotVersion.seconds,i.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.pn(e).next(i=>i.highestListenSequenceNumber)}setTargetsMetadata(e,i,d){return this.pn(e).next(_=>(_.highestListenSequenceNumber=i,d&&(_.lastRemoteSnapshotVersion=d.toTimestamp()),i>_.highestListenSequenceNumber&&(_.highestListenSequenceNumber=i),this.In(e,_)))}addTargetData(e,i){return this.Tn(e,i).next(()=>this.pn(e).next(d=>(d.targetCount+=1,this.En(i,d),this.In(e,d))))}updateTargetData(e,i){return this.Tn(e,i)}removeTargetData(e,i){return this.removeMatchingKeysForTargetId(e,i.targetId).next(()=>X8(e).delete(i.targetId)).next(()=>this.pn(e)).next(d=>(QI(d.targetCount>0),d.targetCount-=1,this.In(e,d)))}removeTargets(e,i,d){let _=0;const B=[];return X8(e).Wt((_t,_a)=>{const _h=_S(_a);_h.sequenceNumber<=i&&null===d.get(_h.targetId)&&(_++,B.push(this.removeTargetData(e,_h)))}).next(()=>x0.waitFor(B)).next(()=>_)}forEachTarget(e,i){return X8(e).Wt((d,_)=>{const B=_S(_);i(B)})}pn(e){return Bue(e).get("targetGlobalKey").next(i=>(QI(null!==i),i))}In(e,i){return Bue(e).put("targetGlobalKey",i)}Tn(e,i){return X8(e).put(Xre(this.M,i))}En(e,i){let d=!1;return e.targetId>i.highestTargetId&&(i.highestTargetId=e.targetId,d=!0),e.sequenceNumber>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e.sequenceNumber,d=!0),d}getTargetCount(e){return this.pn(e).next(i=>i.targetCount)}getTargetData(e,i){const d=jQ(i),_=IDBKeyRange.bound([d,Number.NEGATIVE_INFINITY],[d,Number.POSITIVE_INFINITY]);let B=null;return X8(e).Wt({range:_,index:"queryTargetsIndex"},(_t,_a,_h)=>{const _g=_S(_a);SK(i,_g.target)&&(B=_g,_h.done())}).next(()=>B)}addMatchingKeys(e,i,d){const _=[],B=V6(e);return i.forEach(_t=>{const _a=nP(_t.path);_.push(B.put({targetId:d,path:_a})),_.push(this.referenceDelegate.addReference(e,d,_t))}),x0.waitFor(_)}removeMatchingKeys(e,i,d){const _=V6(e);return x0.forEach(i,B=>{const _t=nP(B.path);return x0.waitFor([_.delete([d,_t]),this.referenceDelegate.removeReference(e,d,B)])})}removeMatchingKeysForTargetId(e,i){const d=V6(e),_=IDBKeyRange.bound([i],[i+1],!1,!0);return d.delete(_)}getMatchingKeysForTargetId(e,i){const d=IDBKeyRange.bound([i],[i+1],!1,!0),_=V6(e);let B=CT();return _.Wt({range:d,jt:!0},(_t,_a,_h)=>{const _g=Q4(_t[1]),l_=new fI(_g);B=B.add(l_)}).next(()=>B)}containsKey(e,i){const d=nP(i.path),_=IDBKeyRange.bound([d],[NZ(d)],!1,!0);let B=0;return V6(e).Wt({index:"documentTargetsIndex",jt:!0,range:_},([_t,_a],_h,_g)=>{0!==_t&&(B++,_g.done())}).next(()=>B>0)}Et(e,i){return X8(e).get(i).next(d=>d?_S(d):null)}}function X8(o){return WO(o,"targets")}function Bue(o){return WO(o,"targetGlobal")}function V6(o){return WO(o,"targetDocuments")}function zO(o){return oX.apply(this,arguments)}function oX(){return oX=(0,C0.Z)(function*(o){if(o.code!==T0.FAILED_PRECONDITION||o.message!==Kpe)throw o;nI("LocalStore","Unexpectedly lost primary lease")}),oX.apply(this,arguments)}function rge([o,e],[i,d]){const _=R1(o,i);return 0===_?R1(e,d):_}class Uue{constructor(e){this.An=e,this.buffer=new hT(rge),this.Rn=0}bn(){return++this.Rn}Pn(e){const i=[e,this.bn()];if(this.buffer.size<this.An)this.buffer=this.buffer.add(i);else{const d=this.buffer.last();rge(i,d)<0&&(this.buffer=this.buffer.delete(d).add(i))}}get maxValue(){return this.buffer.last()[0]}}class iie{constructor(e,i){this.garbageCollector=e,this.asyncQueue=i,this.Vn=!1,this.vn=null}start(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Sn(e)}stop(){this.vn&&(this.vn.cancel(),this.vn=null)}get started(){return null!==this.vn}Sn(e){var i=this;const d=this.Vn?3e5:6e4;nI("LruGarbageCollector",`Garbage collection scheduled in ${d}ms`),this.vn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",d,(0,C0.Z)(function*(){i.vn=null,i.Vn=!0;try{yield e.collectGarbage(i.garbageCollector)}catch(_){U6(_)?nI("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",_):yield zO(_)}yield i.Sn(e)}))}}class HK{constructor(e,i){this.Dn=e,this.params=i}calculateTargetCount(e,i){return this.Dn.Cn(e).next(d=>Math.floor(i/100*d))}nthSequenceNumber(e,i){if(0===i)return x0.resolve(GL.A);const d=new Uue(i);return this.Dn.forEachTarget(e,_=>d.Pn(_.sequenceNumber)).next(()=>this.Dn.xn(e,_=>d.Pn(_))).next(()=>d.maxValue)}removeTargets(e,i,d){return this.Dn.removeTargets(e,i,d)}removeOrphanedDocuments(e,i){return this.Dn.removeOrphanedDocuments(e,i)}collect(e,i){return-1===this.params.cacheSizeCollectionThreshold?(nI("LruGarbageCollector","Garbage collection skipped; disabled"),x0.resolve(ege)):this.getCacheSize(e).next(d=>d<this.params.cacheSizeCollectionThreshold?(nI("LruGarbageCollector",`Garbage collection skipped; Cache size ${d} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ege):this.Nn(e,i))}getCacheSize(e){return this.Dn.getCacheSize(e)}Nn(e,i){let d,_,B,_t,_a,_h,_g;const l_=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f_=>(f_>this.params.maximumSequenceNumbersToCollect?(nI("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f_}`),_=this.params.maximumSequenceNumbersToCollect):_=f_,_t=Date.now(),this.nthSequenceNumber(e,_))).next(f_=>(d=f_,_a=Date.now(),this.removeTargets(e,d,i))).next(f_=>(B=f_,_h=Date.now(),this.removeOrphanedDocuments(e,d))).next(f_=>(_g=Date.now(),Wce()<=QP.in.DEBUG&&nI("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${_t-l_}ms\n\tDetermined least recently used ${_} in `+(_a-_t)+`ms\n\tRemoved ${B} targets in `+(_h-_a)+`ms\n\tRemoved ${f_} documents in `+(_g-_h)+`ms\nTotal Duration: ${_g-l_}ms`),x0.resolve({didRun:!0,sequenceNumbersCollected:_,targetsRemoved:B,documentsRemoved:f_})))}}class sP{constructor(e,i){this.db=e,this.garbageCollector=new HK(this,i)}Cn(e){const i=this.kn(e);return this.db.getTargetCache().getTargetCount(e).next(d=>i.next(_=>d+_))}kn(e){let i=0;return this.xn(e,d=>{i++}).next(()=>i)}forEachTarget(e,i){return this.db.getTargetCache().forEachTarget(e,i)}xn(e,i){return this.Mn(e,(d,_)=>i(_))}addReference(e,i,d){return sX(e,d)}removeReference(e,i,d){return sX(e,d)}removeTargets(e,i,d){return this.db.getTargetCache().removeTargets(e,i,d)}markPotentiallyOrphaned(e,i){return sX(e,i)}On(e,i){return function(d,_){let B=!1;return rie(d).zt(_t=>tge(d,_t,_).next(_a=>(_a&&(B=!0),x0.resolve(!_a)))).next(()=>B)}(e,i)}removeOrphanedDocuments(e,i){const d=this.db.getRemoteDocumentCache().newChangeBuffer(),_=[];let B=0;return this.Mn(e,(_t,_a)=>{if(_a<=i){const _h=this.On(e,_t).next(_g=>{if(!_g)return B++,d.getEntry(e,_t).next(()=>(d.removeEntry(_t,a1.min()),V6(e).delete([0,nP(_t.path)])))});_.push(_h)}}).next(()=>x0.waitFor(_)).next(()=>d.apply(e)).next(()=>B)}removeTarget(e,i){const d=i.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,d)}updateLimboDocument(e,i){return sX(e,i)}Mn(e,i){const d=V6(e);let _,B=GL.A;return d.Wt({index:"documentTargetsIndex"},([_t,_a],{path:_h,sequenceNumber:_g})=>{0===_t?(B!==GL.A&&i(new fI(Q4(_)),B),B=_g,_=_h):B=GL.A}).next(()=>{B!==GL.A&&i(new fI(Q4(_)),B)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function sX(o,e){return V6(o).put((d=o.currentSequenceNumber,{targetId:0,path:nP(e.path),sequenceNumber:d}));var d}class ige{constructor(){this.changes=new J8(e=>e.toString(),(e,i)=>e.isEqual(i)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,i){this.assertNotApplied(),this.changes.set(e,mS.newInvalidDocument(e).setReadTime(i))}getEntry(e,i){this.assertNotApplied();const d=this.changes.get(i);return void 0!==d?x0.resolve(d):this.getFromCache(e,i)}getEntries(e,i){return this.getAllFromCache(e,i)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Pve{constructor(e){this.M=e}setIndexManager(e){this.indexManager=e}addEntry(e,i,d){return eG(e).put(d)}removeEntry(e,i,d){return eG(e).delete(function(_,B){const _t=_.path.toArray();return[_t.slice(0,_t.length-2),_t[_t.length-2],jK(B),_t[_t.length-1]]}(i,d))}updateMetadata(e,i){return this.getMetadata(e).next(d=>(d.byteSize+=i,this.Fn(e,d)))}getEntry(e,i){let d=mS.newInvalidDocument(i);return eG(e).Wt({index:"documentKeyIndex",range:IDBKeyRange.only(qK(i))},(_,B)=>{d=this.$n(i,B)}).next(()=>d)}Bn(e,i){let d={size:0,document:mS.newInvalidDocument(i)};return eG(e).Wt({index:"documentKeyIndex",range:IDBKeyRange.only(qK(i))},(_,B)=>{d={document:this.$n(i,B),size:rX(B)}}).next(()=>d)}getEntries(e,i){let d=HL();return this.Ln(e,i,(_,B)=>{const _t=this.$n(_,B);d=d.insert(_,_t)}).next(()=>d)}Un(e,i){let d=HL(),_=new fR(fI.comparator);return this.Ln(e,i,(B,_t)=>{const _a=this.$n(B,_t);d=d.insert(B,_a),_=_.insert(B,rX(_t))}).next(()=>({documents:d,qn:_}))}Ln(e,i,d){if(i.isEmpty())return x0.resolve();let _=new hT(jue);i.forEach(_h=>_=_.add(_h));const B=IDBKeyRange.bound(qK(_.first()),qK(_.last())),_t=_.getIterator();let _a=_t.getNext();return eG(e).Wt({index:"documentKeyIndex",range:B},(_h,_g,l_)=>{const f_=fI.fromSegments([..._g.prefixPath,_g.collectionGroup,_g.documentId]);for(;_a&&jue(_a,f_)<0;)d(_a,null),_a=_t.getNext();_a&&_a.isEqual(f_)&&(d(_a,_g),_a=_t.hasNext()?_t.getNext():null),_a?l_.Ut(qK(_a)):l_.done()}).next(()=>{for(;_a;)d(_a,null),_a=_t.hasNext()?_t.getNext():null})}getAllFromCollection(e,i,d){const _=[i.popLast().toArray(),i.lastSegment(),jK(d.readTime),d.documentKey.path.isEmpty()?"":d.documentKey.path.lastSegment()],B=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return eG(e).qt(IDBKeyRange.bound(_,B,!0)).next(_t=>{let _a=HL();for(const _h of _t){const _g=this.$n(fI.fromSegments(_h.prefixPath.concat(_h.collectionGroup,_h.documentId)),_h);_a=_a.insert(_g.key,_g)}return _a})}getAllFromCollectionGroup(e,i,d,_){let B=HL();const _t=Fue(i,d),_a=Fue(i,BM.max());return eG(e).Wt({index:"collectionGroupIndex",range:IDBKeyRange.bound(_t,_a,!0)},(_h,_g,l_)=>{const f_=this.$n(fI.fromSegments(_g.prefixPath.concat(_g.collectionGroup,_g.documentId)),_g);B=B.insert(f_.key,f_),B.size===_&&l_.done()}).next(()=>B)}newChangeBuffer(e){return new aP(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(i=>i.byteSize)}getMetadata(e){return jT(e).get("remoteDocumentGlobalKey").next(i=>(QI(!!i),i))}Fn(e,i){return jT(e).put("remoteDocumentGlobalKey",i)}$n(e,i){if(i){const d=function Jpe(o,e){let i;if(e.document)i=Cue(o.Jt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const d=fI.fromSegments(e.noDocument.path),_=QQ(e.noDocument.readTime);i=mS.newNoDocument(d,_),e.hasCommittedMutations&&i.setHasCommittedMutations()}else{if(!e.unknownDocument)return PI();{const d=fI.fromSegments(e.unknownDocument.path),_=QQ(e.unknownDocument.version);i=mS.newUnknownDocument(d,_)}}return e.readTime&&i.setReadTime(function(d){const _=new XS(d[0],d[1]);return a1.fromTimestamp(_)}(e.readTime)),i}(this.M,i);if(!d.isNoDocument()||!d.version.isEqual(a1.min()))return d}return mS.newInvalidDocument(e)}}class aP extends ige{constructor(e,i){super(),this.Kn=e,this.trackRemovals=i,this.Gn=new J8(d=>d.toString(),(d,_)=>d.isEqual(_))}applyChanges(e){const i=[];let d=0,_=new hT((B,_t)=>R1(B.canonicalString(),_t.canonicalString()));return this.changes.forEach((B,_t)=>{const _a=this.Gn.get(B);if(i.push(this.Kn.removeEntry(e,B,_a.readTime)),_t.isValidDocument()){const _h=eX(this.Kn.M,_t);_=_.add(B.path.popLast()),d+=rX(_h)-_a.size,i.push(this.Kn.addEntry(e,B,_h))}else if(d-=_a.size,this.trackRemovals){const _h=eX(this.Kn.M,_t.convertToNoDocument(a1.min()));i.push(this.Kn.addEntry(e,B,_h))}}),_.forEach(B=>{i.push(this.Kn.indexManager.addToCollectionParentIndex(e,B))}),i.push(this.Kn.updateMetadata(e,d)),x0.waitFor(i)}getFromCache(e,i){return this.Kn.Bn(e,i).next(d=>(this.Gn.set(i,{size:d.size,readTime:d.document.readTime}),d.document))}getAllFromCache(e,i){return this.Kn.Un(e,i).next(({documents:d,qn:_})=>(_.forEach((B,_t)=>{this.Gn.set(B,{size:_t,readTime:d.get(B).readTime})}),d))}}function jT(o){return WO(o,"remoteDocumentGlobal")}function eG(o){return WO(o,"remoteDocumentsV14")}function qK(o){const e=o.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Fue(o,e){const i=e.documentKey.path.toArray();return[o,jK(e.readTime),i.slice(0,i.length-2),i.length>0?i[i.length-1]:""]}function jue(o,e){const i=o.path.toArray(),d=e.path.toArray();let _=0;for(let B=0;B<i.length-2&&B<d.length-2;++B)if(_=R1(i[B],d[B]),_)return _;return _=R1(i.length,d.length),_||(_=R1(i[i.length-2],d[d.length-2]),_||R1(i[i.length-1],d[d.length-1]))}class oge{constructor(e){this.M=e}kt(e,i,d,_){const B=new Zre("createOrUpgrade",i);var _a;d<1&&_>=1&&(e.createObjectStore("owner"),(_a=e).createObjectStore("mutationQueues",{keyPath:"userId"}),_a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Gpe,{unique:!0}),_a.createObjectStore("documentMutations"),Vue(e),function(_a){_a.createObjectStore("remoteDocuments")}(e));let _t=x0.resolve();return d<3&&_>=3&&(0!==d&&(function(_a){_a.deleteObjectStore("targetDocuments"),_a.deleteObjectStore("targets"),_a.deleteObjectStore("targetGlobal")}(e),Vue(e)),_t=_t.next(()=>function(_a){const _h=_a.store("targetGlobal"),_g={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:a1.min().toTimestamp(),targetCount:0};return _h.put("targetGlobalKey",_g)}(B))),d<4&&_>=4&&(0!==d&&(_t=_t.next(()=>function(_a,_h){return _h.store("mutations").qt().next(_g=>{_a.deleteObjectStore("mutations"),_a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Gpe,{unique:!0});const l_=_h.store("mutations"),f_=_g.map(R_=>l_.put(R_));return x0.waitFor(f_)})}(e,B))),_t=_t.next(()=>{!function(_a){_a.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),d<5&&_>=5&&(_t=_t.next(()=>this.Qn(B))),d<6&&_>=6&&(_t=_t.next(()=>(function(_a){_a.createObjectStore("remoteDocumentGlobal")}(e),this.jn(B)))),d<7&&_>=7&&(_t=_t.next(()=>this.Wn(B))),d<8&&_>=8&&(_t=_t.next(()=>this.zn(e,B))),d<9&&_>=9&&(_t=_t.next(()=>{!function(_a){_a.objectStoreNames.contains("remoteDocumentChanges")&&_a.deleteObjectStore("remoteDocumentChanges")}(e)})),d<10&&_>=10&&(_t=_t.next(()=>this.Hn(B))),d<11&&_>=11&&(_t=_t.next(()=>{(function(_a){_a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(_a){_a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),d<12&&_>=12&&(_t=_t.next(()=>{!function(_a){const _h=_a.createObjectStore("documentOverlays",{keyPath:Sve});_h.createIndex("collectionPathOverlayIndex",Oue,{unique:!1}),_h.createIndex("collectionGroupOverlayIndex",Rve,{unique:!1})}(e)})),d<13&&_>=13&&(_t=_t.next(()=>function(_a){const _h=_a.createObjectStore("remoteDocumentsV14",{keyPath:_ve});_h.createIndex("documentKeyIndex",Qpe),_h.createIndex("collectionGroupIndex",vve)}(e)).next(()=>this.Jn(e,B)).next(()=>e.deleteObjectStore("remoteDocuments"))),d<14&&_>=14&&(_t=_t.next(()=>{!function(_a){_a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),_a.createObjectStore("indexState",{keyPath:bve}).createIndex("sequenceNumberIndex",Cve,{unique:!1}),_a.createObjectStore("indexEntries",{keyPath:wve}).createIndex("documentKeyIndex",Tve,{unique:!1})}(e)})),_t}jn(e){let i=0;return e.store("remoteDocuments").Wt((d,_)=>{i+=rX(_)}).next(()=>{const d={byteSize:i};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",d)})}Qn(e){const i=e.store("mutationQueues"),d=e.store("mutations");return i.qt().next(_=>x0.forEach(_,B=>{const _t=IDBKeyRange.bound([B.userId,-1],[B.userId,B.lastAcknowledgedBatchId]);return d.qt("userMutationsIndex",_t).next(_a=>x0.forEach(_a,_h=>{QI(_h.userId===B.userId);const _g=$8(this.M,_h);return Mue(e,B.userId,_g).next(()=>{})}))}))}Wn(e){const i=e.store("targetDocuments"),d=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(_=>{const B=[];return d.Wt((_t,_a)=>{const _h=new eT(_t),_g=[0,nP(_h)];B.push(i.get(_g).next(l_=>l_?x0.resolve():i.put({targetId:0,path:nP(_h),sequenceNumber:_.highestListenSequenceNumber})))}).next(()=>x0.waitFor(B))})}zn(e,i){e.createObjectStore("collectionParents",{keyPath:Ive});const d=i.store("collectionParents"),_=new g1,B=_t=>{if(_.add(_t)){const _a=_t.lastSegment(),_h=_t.popLast();return d.put({collectionId:_a,parent:nP(_h)})}};return i.store("remoteDocuments").Wt({jt:!0},(_t,_a)=>{const _h=new eT(_t);return B(_h.popLast())}).next(()=>i.store("documentMutations").Wt({jt:!0},([_t,_a,_h],_g)=>{const l_=Q4(_a);return B(l_.popLast())}))}Hn(e){const i=e.store("targets");return i.Wt((d,_)=>{const B=_S(_),_t=Xre(this.M,B);return i.put(_t)})}Jn(e,i){const d=i.store("remoteDocuments"),_=[];return d.Wt((B,_t)=>{const _a=i.store("remoteDocumentsV14"),_h=(_g=_t,_g.document?new fI(eT.fromString(_g.document.name).popFirst(5)):_g.noDocument?fI.fromSegments(_g.noDocument.path):_g.unknownDocument?fI.fromSegments(_g.unknownDocument.path):PI()).path.toArray();var _g;const l_={prefixPath:_h.slice(0,_h.length-2),collectionGroup:_h[_h.length-2],documentId:_h[_h.length-1],readTime:_t.readTime||[0,0],unknownDocument:_t.unknownDocument,noDocument:_t.noDocument,document:_t.document,hasCommittedMutations:!!_t.hasCommittedMutations};_.push(_a.put(l_))}).next(()=>x0.waitFor(_))}}function Vue(o){o.createObjectStore("targetDocuments",{keyPath:Hpe}).createIndex("documentTargetsIndex",Eve,{unique:!0}),o.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",yve,{unique:!0}),o.createObjectStore("targetGlobal")}const oie="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class sie{constructor(e,i,d,_,B,_t,_a,_h,_g,l_,f_=13){if(this.allowTabSynchronization=e,this.persistenceKey=i,this.clientId=d,this.Yn=B,this.window=_t,this.document=_a,this.Xn=_g,this.Zn=l_,this.ts=f_,this.es=null,this.ns=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ss=null,this.inForeground=!1,this.rs=null,this.os=null,this.us=Number.NEGATIVE_INFINITY,this.cs=R_=>Promise.resolve(),!sie.vt())throw new W0(T0.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new sP(this,_),this.hs=i+"main",this.M=new xue(_h),this.ls=new r3(this.hs,this.ts,new oge(this.M)),this.fs=new nge(this.referenceDelegate,this.M),this.ds=new Pve(this.M),this._s=new $pe,this.window&&this.window.localStorage?this.ws=this.window.localStorage:(this.ws=null,!1===l_&&kR("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.gs().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new W0(T0.FAILED_PRECONDITION,oie);return this.ys(),this.ps(),this.Is(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.fs.getHighestSequenceNumber(e))}).then(e=>{this.es=new GL(e,this.Xn)}).then(()=>{this.ns=!0}).catch(e=>(this.ls&&this.ls.close(),Promise.reject(e)))}Ts(e){var i=this;return this.cs=function(){var d=(0,C0.Z)(function*(_){if(i.started)return e(_)});return function(_){return d.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ls.Ot(function(){var i=(0,C0.Z)(function*(d){null===d.newVersion&&(yield e())});return function(d){return i.apply(this,arguments)}}())}setNetworkEnabled(e){var i=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Yn.enqueueAndForget((0,C0.Z)(function*(){i.started&&(yield i.gs())})))}gs(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>aX(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Es(e).next(i=>{i||(this.isPrimary=!1,this.Yn.enqueueRetryable(()=>this.cs(!1)))})}).next(()=>this.As(e)).next(i=>this.isPrimary&&!i?this.Rs(e).next(()=>!1):!!i&&this.bs(e).next(()=>!0))).catch(e=>{if(U6(e))return nI("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return nI("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Yn.enqueueRetryable(()=>this.cs(e)),this.isPrimary=e})}Es(e){return WK(e).get("owner").next(i=>x0.resolve(this.Ps(i)))}Vs(e){return aX(e).delete(this.clientId)}vs(){var e=this;return(0,C0.Z)(function*(){if(e.isPrimary&&!e.Ss(e.us,18e5)){e.us=Date.now();const i=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",d=>{const _=WO(d,"clientMetadata");return _.qt().next(B=>{const _t=e.Ds(B,18e5),_a=B.filter(_h=>-1===_t.indexOf(_h));return x0.forEach(_a,_h=>_.delete(_h.clientId)).next(()=>_a)})}).catch(()=>[]);if(e.ws)for(const d of i)e.ws.removeItem(e.Cs(d.clientId))}})()}Is(){this.os=this.Yn.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.gs().then(()=>this.vs()).then(()=>this.Is()))}Ps(e){return!!e&&e.ownerId===this.clientId}As(e){return this.Zn?x0.resolve(!0):WK(e).get("owner").next(i=>{if(null!==i&&this.Ss(i.leaseTimestampMs,5e3)&&!this.xs(i.ownerId)){if(this.Ps(i)&&this.networkEnabled)return!0;if(!this.Ps(i)){if(!i.allowTabSynchronization)throw new W0(T0.FAILED_PRECONDITION,oie);return!1}}return!(!this.networkEnabled||!this.inForeground)||aX(e).qt().next(d=>void 0===this.Ds(d,5e3).find(_=>{if(this.clientId!==_.clientId){const _t=!this.inForeground&&_.inForeground,_a=this.networkEnabled===_.networkEnabled;if(!this.networkEnabled&&_.networkEnabled||_t&&_a)return!0}return!1}))}).next(i=>(this.isPrimary!==i&&nI("IndexedDbPersistence",`Client ${i?"is":"is not"} eligible for a primary lease.`),i))}shutdown(){var e=this;return(0,C0.Z)(function*(){e.ns=!1,e.Ns(),e.os&&(e.os.cancel(),e.os=null),e.ks(),e.Ms(),yield e.ls.runTransaction("shutdown","readwrite",["owner","clientMetadata"],i=>{const d=new Ype(i,GL.A);return e.Rs(d).next(()=>e.Vs(d))}),e.ls.close(),e.Os()})()}Ds(e,i){return e.filter(d=>this.Ss(d.updateTimeMs,i)&&!this.xs(d.clientId))}Fs(){return this.runTransaction("getActiveClients","readonly",e=>aX(e).qt().next(i=>this.Ds(i,18e5).map(d=>d.clientId)))}get started(){return this.ns}getMutationQueue(e,i){return iX.Yt(e,this.M,i,this.referenceDelegate)}getTargetCache(){return this.fs}getRemoteDocumentCache(){return this.ds}getIndexManager(e){return new nX(e,this.M.Jt.databaseId)}getDocumentOverlayCache(e){return VK.Yt(this.M,e)}getBundleCache(){return this._s}runTransaction(e,i,d){nI("IndexedDbPersistence","Starting transaction:",e);const _="readonly"===i?"readonly":"readwrite",B=14===(_t=this.ts)?Due:13===_t?Wpe:12===_t?Ove:11===_t?qpe:void PI();var _t;let _a;return this.ls.runTransaction(e,_,B,_h=>(_a=new Ype(_h,this.es?this.es.next():GL.A),"readwrite-primary"===i?this.Es(_a).next(_g=>!!_g||this.As(_a)).next(_g=>{if(!_g)throw kR(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Yn.enqueueRetryable(()=>this.cs(!1)),new W0(T0.FAILED_PRECONDITION,Kpe);return d(_a)}).next(_g=>this.bs(_a).next(()=>_g)):this.$s(_a).next(()=>d(_a)))).then(_h=>(_a.raiseOnCommittedEvent(),_h))}$s(e){return WK(e).get("owner").next(i=>{if(null!==i&&this.Ss(i.leaseTimestampMs,5e3)&&!this.xs(i.ownerId)&&!this.Ps(i)&&!(this.Zn||this.allowTabSynchronization&&i.allowTabSynchronization))throw new W0(T0.FAILED_PRECONDITION,oie)})}bs(e){const i={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return WK(e).put("owner",i)}static vt(){return r3.vt()}Rs(e){const i=WK(e);return i.get("owner").next(d=>this.Ps(d)?(nI("IndexedDbPersistence","Releasing primary lease."),i.delete("owner")):x0.resolve())}Ss(e,i){const d=Date.now();return!(e<d-i||e>d&&(kR(`Detected an update time that is in the future: ${e} > ${d}`),1))}ys(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.rs=()=>{this.Yn.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.gs()))},this.document.addEventListener("visibilitychange",this.rs),this.inForeground="visible"===this.document.visibilityState)}ks(){this.rs&&(this.document.removeEventListener("visibilitychange",this.rs),this.rs=null)}ps(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ss=()=>{this.Ns(),(0,M_.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Yn.enterRestrictedMode(!0),this.Yn.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ss))}Ms(){this.ss&&(this.window.removeEventListener("pagehide",this.ss),this.ss=null)}xs(e){var i;try{const d=null!==(null===(i=this.ws)||void 0===i?void 0:i.getItem(this.Cs(e)));return nI("IndexedDbPersistence",`Client '${e}' ${d?"is":"is not"} zombied in LocalStorage`),d}catch(d){return kR("IndexedDbPersistence","Failed to get zombied client id.",d),!1}}Ns(){if(this.ws)try{this.ws.setItem(this.Cs(this.clientId),String(Date.now()))}catch(e){kR("Failed to set zombie client id.",e)}}Os(){if(this.ws)try{this.ws.removeItem(this.Cs(this.clientId))}catch(e){}}Cs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function WK(o){return WO(o,"owner")}function aX(o){return WO(o,"clientMetadata")}function aie(o,e){let i=o.projectId;return o.isDefaultDatabase||(i+="."+o.database),"firestore/"+e+"/"+i+"/"}class sge{constructor(e,i,d){this.ds=e,this.Bs=i,this.indexManager=d}Ls(e,i){return this.Bs.getAllMutationBatchesAffectingDocumentKey(e,i).next(d=>this.Us(e,i,d))}Us(e,i,d){return this.ds.getEntry(e,i).next(_=>{for(const B of d)B.applyToLocalView(_);return _})}qs(e,i){e.forEach((d,_)=>{for(const B of i)B.applyToLocalView(_)})}Ks(e,i){return this.ds.getEntries(e,i).next(d=>this.Gs(e,d).next(()=>d))}Gs(e,i){return this.Bs.getAllMutationBatchesAffectingDocumentKeys(e,i).next(d=>this.qs(i,d))}Qs(e,i,d){return fI.isDocumentKey((_=i).path)&&null===_.collectionGroup&&0===_.filters.length?this.js(e,i.path):aue(i)?this.Ws(e,i,d):this.zs(e,i,d);var _}js(e,i){return this.Ls(e,new fI(i)).next(d=>{let _=zre();return d.isFoundDocument()&&(_=_.insert(d.key,d)),_})}Ws(e,i,d){const _=i.collectionGroup;let B=zre();return this.indexManager.getCollectionParents(e,_).next(_t=>x0.forEach(_t,_a=>{const _h=(_g=i,l_=_a.child(_),new n3(l_,null,_g.explicitOrderBy.slice(),_g.filters.slice(),_g.limit,_g.limitType,_g.startAt,_g.endAt));var _g,l_;return this.zs(e,_h,d).next(_g=>{_g.forEach((l_,f_)=>{B=B.insert(l_,f_)})})}).next(()=>B))}zs(e,i,d){let _;return this.ds.getAllFromCollection(e,i.path,d).next(B=>(_=B,this.Bs.getAllMutationBatchesAffectingQuery(e,i))).next(B=>{for(const _t of B)for(const _a of _t.mutations){const _h=_a.key;let _g=_.get(_h);null==_g&&(_g=mS.newInvalidDocument(_h),_=_.insert(_h,_g)),mue(_a,_g,_t.localWriteTime),_g.isFoundDocument()||(_=_.remove(_h))}}).next(()=>(_.forEach((B,_t)=>{jZ(i,_t)||(_=_.remove(B))}),_))}}class FS{constructor(e,i,d,_){this.targetId=e,this.fromCache=i,this.Hs=d,this.Js=_}static Ys(e,i){let d=CT(),_=CT();for(const B of i.docChanges)switch(B.type){case 0:d=d.add(B.doc.key);break;case 1:_=_.add(B.doc.key)}return new FS(e,i.fromCache,d,_)}}class Gue{constructor(){this.Xs=!1}initialize(e,i){this.Zs=e,this.indexManager=i,this.Xs=!0}Qs(e,i,d,_){return this.ti(e,i).next(B=>B||this.ei(e,i,_,d)).next(B=>B||this.ni(e,i))}ti(e,i){return x0.resolve(null)}ei(e,i,d,_){return function oue(o){return 0===o.filters.length&&null===o.limit&&null==o.startAt&&null==o.endAt&&(0===o.explicitOrderBy.length||1===o.explicitOrderBy.length&&o.explicitOrderBy[0].field.isKeyField())}(i)||_.isEqual(a1.min())?this.ni(e,i):this.Zs.Ks(e,d).next(B=>{const _t=this.si(i,B);return this.ii(i,_t,d,_)?this.ni(e,i):(Wce()<=QP.in.DEBUG&&nI("QueryEngine","Re-using previous result from %s to execute query: %s",_.toString(),uue(i)),this.ri(e,_t,i,P6(_,-1)))})}si(e,i){let d=new hT(Gre(e));return i.forEach((_,B)=>{jZ(e,B)&&(d=d.add(B))}),d}ii(e,i,d,_){if(null===e.limit)return!1;if(d.size!==i.size)return!0;const B="F"===e.limitType?i.last():i.first();return!!B&&(B.hasPendingWrites||B.version.compareTo(_)>0)}ni(e,i){return Wce()<=QP.in.DEBUG&&nI("QueryEngine","Using full collection scan to execute query:",uue(i)),this.Zs.Qs(e,i,BM.min())}ri(e,i,d,_){return this.Zs.Qs(e,d,_).next(B=>(i.forEach(_t=>{B=B.insert(_t.key,_t)}),B))}}class age{constructor(e,i,d,_){this.persistence=e,this.oi=i,this.M=_,this.ui=new fR(R1),this.ai=new J8(B=>jQ(B),SK),this.ci=new Map,this.hi=e.getRemoteDocumentCache(),this.fs=e.getTargetCache(),this._s=e.getBundleCache(),this.li(d)}li(e){this.indexManager=this.persistence.getIndexManager(e),this.Bs=this.persistence.getMutationQueue(e,this.indexManager),this.fi=new sge(this.hi,this.Bs,this.indexManager),this.hi.setIndexManager(this.indexManager),this.oi.initialize(this.fi,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",i=>e.collect(i,this.ui))}}function Que(o,e,i,d){return new age(o,e,i,d)}function Hue(o,e){return cie.apply(this,arguments)}function cie(){return cie=(0,C0.Z)(function*(o,e){const i=pI(o);return yield i.persistence.runTransaction("Handle user change","readonly",d=>{let _;return i.Bs.getAllMutationBatches(d).next(B=>(_=B,i.li(e),i.Bs.getAllMutationBatches(d))).next(B=>{const _t=[],_a=[];let _h=CT();for(const _g of _){_t.push(_g.batchId);for(const l_ of _g.mutations)_h=_h.add(l_.key)}for(const _g of B){_a.push(_g.batchId);for(const l_ of _g.mutations)_h=_h.add(l_.key)}return i.fi.Ks(d,_h).next(_g=>({di:_g,removedBatchIds:_t,addedBatchIds:_a}))})})}),cie.apply(this,arguments)}function KQ(o,e){const i=pI(o);return i.persistence.runTransaction("Acknowledge batch","readwrite-primary",d=>{const _=e.batch.keys(),B=i.hi.newChangeBuffer({trackRemovals:!0});return function(_t,_a,_h,_g){const l_=_h.batch,f_=l_.keys();let R_=x0.resolve();return f_.forEach(H_=>{R_=R_.next(()=>_g.getEntry(_a,H_)).next(W_=>{const R0=_h.docVersions.get(H_);QI(null!==R0),W_.version.compareTo(R0)<0&&(l_.applyToRemoteDocument(W_,_h),W_.isValidDocument()&&(W_.setReadTime(_h.commitVersion),_g.addEntry(W_)))})}),R_.next(()=>_t.Bs.removeMutationBatch(_a,l_))}(i,d,e,B).next(()=>B.apply(d)).next(()=>i.Bs.performConsistencyCheck(d)).next(()=>i.fi.Ks(d,_))})}function que(o){const e=pI(o);return e.persistence.runTransaction("Get last remote snapshot version","readonly",i=>e.fs.getLastRemoteSnapshotVersion(i))}function cge(o,e){const i=pI(o),d=e.snapshotVersion;let _=i.ui;return i.persistence.runTransaction("Apply remote event","readwrite-primary",B=>{const _t=i.hi.newChangeBuffer({trackRemovals:!0});_=i.ui;const _a=[];e.targetChanges.forEach((_g,l_)=>{const f_=_.get(l_);if(!f_)return;_a.push(i.fs.removeMatchingKeys(B,_g.removedDocuments,l_).next(()=>i.fs.addMatchingKeys(B,_g.addedDocuments,l_)));let R_=f_.withSequenceNumber(B.currentSequenceNumber);var H_,W_,R0;e.targetMismatches.has(l_)?R_=R_.withResumeToken(aO.EMPTY_BYTE_STRING,a1.min()).withLastLimboFreeSnapshotVersion(a1.min()):_g.resumeToken.approximateByteSize()>0&&(R_=R_.withResumeToken(_g.resumeToken,d)),_=_.insert(l_,R_),W_=R_,R0=_g,(0===(H_=f_).resumeToken.approximateByteSize()||W_.snapshotVersion.toMicroseconds()-H_.snapshotVersion.toMicroseconds()>=3e8||R0.addedDocuments.size+R0.modifiedDocuments.size+R0.removedDocuments.size>0)&&_a.push(i.fs.updateTargetData(B,R_))});let _h=HL();if(e.documentUpdates.forEach(_g=>{e.resolvedLimboDocuments.has(_g)&&_a.push(i.persistence.referenceDelegate.updateLimboDocument(B,_g))}),_a.push(Wue(B,_t,e.documentUpdates).next(_g=>{_h=_g})),!d.isEqual(a1.min())){const _g=i.fs.getLastRemoteSnapshotVersion(B).next(l_=>i.fs.setTargetsMetadata(B,B.currentSequenceNumber,d));_a.push(_g)}return x0.waitFor(_a).next(()=>_t.apply(B)).next(()=>i.fi.Gs(B,_h)).next(()=>_h)}).then(B=>(i.ui=_,B))}function Wue(o,e,i){let d=CT();return i.forEach(_=>d=d.add(_)),e.getEntries(o,d).next(_=>{let B=HL();return i.forEach((_t,_a)=>{const _h=_.get(_t);_a.isNoDocument()&&_a.version.isEqual(a1.min())?(e.removeEntry(_t,_a.readTime),B=B.insert(_t,_a)):!_h.isValidDocument()||_a.version.compareTo(_h.version)>0||0===_a.version.compareTo(_h.version)&&_h.hasPendingWrites?(e.addEntry(_a),B=B.insert(_t,_a)):nI("LocalStore","Ignoring outdated watch update for ",_t,". Current version:",_h.version," Watch version:",_a.version)}),B})}function uge(o,e){const i=pI(o);return i.persistence.runTransaction("Get next mutation batch","readonly",d=>(void 0===e&&(e=-1),i.Bs.getNextMutationBatchAfterBatchId(d,e)))}function zQ(o,e){const i=pI(o);return i.persistence.runTransaction("Allocate target","readwrite",d=>{let _;return i.fs.getTargetData(d,e).next(B=>B?(_=B,x0.resolve(_)):i.fs.allocateTargetId(d).next(_t=>(_=new $P(e,_t,0,d.currentSequenceNumber),i.fs.addTargetData(d,_).next(()=>_))))}).then(d=>{const _=i.ui.get(d.targetId);return(null===_||d.snapshotVersion.compareTo(_.snapshotVersion)>0)&&(i.ui=i.ui.insert(d.targetId,d),i.ai.set(e,d.targetId)),d})}function YQ(o,e,i){return uie.apply(this,arguments)}function uie(){return uie=(0,C0.Z)(function*(o,e,i){const d=pI(o),_=d.ui.get(e),B=i?"readwrite":"readwrite-primary";try{i||(yield d.persistence.runTransaction("Release target",B,_t=>d.persistence.referenceDelegate.removeTarget(_t,_)))}catch(_t){if(!U6(_t))throw _t;nI("LocalStore",`Failed to update sequence numbers for target ${e}: ${_t}`)}d.ui=d.ui.remove(e),d.ai.delete(_.target)}),uie.apply(this,arguments)}function CO(o,e,i){const d=pI(o);let _=a1.min(),B=CT();return d.persistence.runTransaction("Execute query","readonly",_t=>function(_a,_h,_g){const l_=pI(_a),f_=l_.ai.get(_g);return void 0!==f_?x0.resolve(l_.ui.get(f_)):l_.fs.getTargetData(_h,_g)}(d,_t,UM(e)).next(_a=>{if(_a)return _=_a.lastLimboFreeSnapshotVersion,d.fs.getMatchingKeysForTargetId(_t,_a.targetId).next(_h=>{B=_h})}).next(()=>d.oi.Qs(_t,e,i?_:a1.min(),i?B:CT())).next(_a=>(lie(d,VZ(e),_a),{documents:_a,_i:B})))}function Kue(o,e){const i=pI(o),d=pI(i.fs),_=i.ui.get(e);return _?Promise.resolve(_.target):i.persistence.runTransaction("Get target data","readonly",B=>d.Et(B,e).next(_t=>_t?_t.target:null))}function zue(o,e){const i=pI(o),d=i.ci.get(e)||a1.min();return i.persistence.runTransaction("Get new document changes","readonly",_=>i.hi.getAllFromCollectionGroup(_,e,P6(d,-1),Number.MAX_SAFE_INTEGER)).then(_=>(lie(i,e,_),_))}function lie(o,e,i){let d=a1.min();i.forEach((_,B)=>{B.readTime.compareTo(d)>0&&(d=B.readTime)}),o.ci.set(e,d)}function JQ(){return JQ=(0,C0.Z)(function*(o,e,i,d){const _=pI(o);let B=CT(),_t=HL();for(const _g of i){const l_=e.wi(_g.metadata.name);_g.document&&(B=B.add(l_));const f_=e.mi(_g);f_.setReadTime(e.gi(_g.metadata.readTime)),_t=_t.insert(l_,f_)}const _a=_.hi.newChangeBuffer({trackRemovals:!0}),_h=yield zQ(_,(_g=d,UM(DK(eT.fromString(`__bundle__/docs/${_g}`)))));var _g;return _.persistence.runTransaction("Apply bundle documents","readwrite",_g=>Wue(_g,_a,_t).next(l_=>(_a.apply(_g),l_)).next(l_=>_.fs.removeMatchingKeysForTargetId(_g,_h.targetId).next(()=>_.fs.addMatchingKeys(_g,B,_h.targetId)).next(()=>_.fi.Gs(_g,l_)).next(()=>l_)))}),JQ.apply(this,arguments)}function xve(o,e){return cP.apply(this,arguments)}function cP(){return cP=(0,C0.Z)(function*(o,e,i=CT()){const d=yield zQ(o,UM(l2(e.bundledQuery))),_=pI(o);return _.persistence.runTransaction("Save named query","readwrite",B=>{const _t=bO(e.readTime);if(d.snapshotVersion.compareTo(_t)>=0)return _._s.saveNamedQuery(B,e);const _a=d.withResumeToken(aO.EMPTY_BYTE_STRING,_t);return _.ui=_.ui.insert(_a.targetId,_a),_.fs.updateTargetData(B,_a).next(()=>_.fs.removeMatchingKeysForTargetId(B,d.targetId)).next(()=>_.fs.addMatchingKeys(B,i,d.targetId)).next(()=>_._s.saveNamedQuery(B,e))})}),cP.apply(this,arguments)}class Lve{constructor(e){this.M=e,this.yi=new Map,this.pi=new Map}getBundleMetadata(e,i){return x0.resolve(this.yi.get(i))}saveBundleMetadata(e,i){var d;return this.yi.set(i.id,{id:(d=i).id,version:d.version,createTime:bO(d.createTime)}),x0.resolve()}getNamedQuery(e,i){return x0.resolve(this.pi.get(i))}saveNamedQuery(e,i){return this.pi.set(i.name,{name:(d=i).name,query:l2(d.bundledQuery),readTime:bO(d.readTime)}),x0.resolve();var d}}class Mve{constructor(){this.overlays=new fR(fI.comparator),this.Ii=new Map}getOverlay(e,i){return x0.resolve(this.overlays.get(i))}saveOverlays(e,i,d){return d.forEach((_,B)=>{this.Xt(e,i,B)}),x0.resolve()}removeOverlaysForBatchId(e,i,d){const _=this.Ii.get(d);return void 0!==_&&(_.forEach(B=>this.overlays=this.overlays.remove(B)),this.Ii.delete(d)),x0.resolve()}getOverlaysForCollection(e,i,d){const _=LK(),B=i.length+1,_t=new fI(i.child("")),_a=this.overlays.getIteratorFrom(_t);for(;_a.hasNext();){const _h=_a.getNext().value,_g=_h.getKey();if(!i.isPrefixOf(_g.path))break;_g.path.length===B&&_h.largestBatchId>d&&_.set(_h.getKey(),_h)}return x0.resolve(_)}getOverlaysForCollectionGroup(e,i,d,_){let B=new fR((_g,l_)=>_g-l_);const _t=this.overlays.getIterator();for(;_t.hasNext();){const _g=_t.getNext().value;if(_g.getKey().getCollectionGroup()===i&&_g.largestBatchId>d){let l_=B.get(_g.largestBatchId);null===l_&&(l_=LK(),B=B.insert(_g.largestBatchId,l_)),l_.set(_g.getKey(),_g)}}const _a=LK(),_h=B.getIterator();for(;_h.hasNext()&&(_h.getNext().value.forEach((_g,l_)=>_a.set(_g,l_)),!(_a.size()>=_)););return x0.resolve(_a)}Xt(e,i,d){if(null===d)return;const _=this.overlays.get(d.key);if(null!==_){const _t=this.Ii.get(_.largestBatchId).delete(d.key);this.Ii.set(_.largestBatchId,_t)}this.overlays=this.overlays.insert(d.key,new Pue(i,d));let B=this.Ii.get(i);void 0===B&&(B=CT(),this.Ii.set(i,B)),this.Ii.set(i,B.add(d.key))}}class Yue{constructor(){this.Ti=new hT(wO.Ei),this.Ai=new hT(wO.Ri)}isEmpty(){return this.Ti.isEmpty()}addReference(e,i){const d=new wO(e,i);this.Ti=this.Ti.add(d),this.Ai=this.Ai.add(d)}bi(e,i){e.forEach(d=>this.addReference(d,i))}removeReference(e,i){this.Pi(new wO(e,i))}Vi(e,i){e.forEach(d=>this.removeReference(d,i))}vi(e){const i=new fI(new eT([])),d=new wO(i,e),_=new wO(i,e+1),B=[];return this.Ai.forEachInRange([d,_],_t=>{this.Pi(_t),B.push(_t.key)}),B}Si(){this.Ti.forEach(e=>this.Pi(e))}Pi(e){this.Ti=this.Ti.delete(e),this.Ai=this.Ai.delete(e)}Di(e){const i=new fI(new eT([])),d=new wO(i,e),_=new wO(i,e+1);let B=CT();return this.Ai.forEachInRange([d,_],_t=>{B=B.add(_t.key)}),B}containsKey(e){const i=new wO(e,0),d=this.Ti.firstAfterOrEqual(i);return null!==d&&e.isEqual(d.key)}}class wO{constructor(e,i){this.key=e,this.Ci=i}static Ei(e,i){return fI.comparator(e.key,i.key)||R1(e.Ci,i.Ci)}static Ri(e,i){return R1(e.Ci,i.Ci)||fI.comparator(e.key,i.key)}}class WL{constructor(e,i){this.indexManager=e,this.referenceDelegate=i,this.Bs=[],this.xi=1,this.Ni=new hT(wO.Ei)}checkEmpty(e){return x0.resolve(0===this.Bs.length)}addMutationBatch(e,i,d,_){const B=this.xi;this.xi++;const _t=new kue(B,i,d,_);this.Bs.push(_t);for(const _a of _)this.Ni=this.Ni.add(new wO(_a.key,B)),this.indexManager.addToCollectionParentIndex(e,_a.key.path.popLast());return x0.resolve(_t)}lookupMutationBatch(e,i){return x0.resolve(this.ki(i))}getNextMutationBatchAfterBatchId(e,i){const _=this.Mi(i+1),B=_<0?0:_;return x0.resolve(this.Bs.length>B?this.Bs[B]:null)}getHighestUnacknowledgedBatchId(){return x0.resolve(0===this.Bs.length?-1:this.xi-1)}getAllMutationBatches(e){return x0.resolve(this.Bs.slice())}getAllMutationBatchesAffectingDocumentKey(e,i){const d=new wO(i,0),_=new wO(i,Number.POSITIVE_INFINITY),B=[];return this.Ni.forEachInRange([d,_],_t=>{const _a=this.ki(_t.Ci);B.push(_a)}),x0.resolve(B)}getAllMutationBatchesAffectingDocumentKeys(e,i){let d=new hT(R1);return i.forEach(_=>{const B=new wO(_,0),_t=new wO(_,Number.POSITIVE_INFINITY);this.Ni.forEachInRange([B,_t],_a=>{d=d.add(_a.Ci)})}),x0.resolve(this.Oi(d))}getAllMutationBatchesAffectingQuery(e,i){const d=i.path,_=d.length+1;let B=d;fI.isDocumentKey(B)||(B=B.child(""));const _t=new wO(new fI(B),0);let _a=new hT(R1);return this.Ni.forEachWhile(_h=>{const _g=_h.key.path;return!!d.isPrefixOf(_g)&&(_g.length===_&&(_a=_a.add(_h.Ci)),!0)},_t),x0.resolve(this.Oi(_a))}Oi(e){const i=[];return e.forEach(d=>{const _=this.ki(d);null!==_&&i.push(_)}),i}removeMutationBatch(e,i){QI(0===this.Fi(i.batchId,"removed")),this.Bs.shift();let d=this.Ni;return x0.forEach(i.mutations,_=>{const B=new wO(_.key,i.batchId);return d=d.delete(B),this.referenceDelegate.markPotentiallyOrphaned(e,_.key)}).next(()=>{this.Ni=d})}_n(e){}containsKey(e,i){const d=new wO(i,0),_=this.Ni.firstAfterOrEqual(d);return x0.resolve(i.isEqual(_&&_.key))}performConsistencyCheck(e){return x0.resolve()}Fi(e,i){return this.Mi(e)}Mi(e){return 0===this.Bs.length?0:e-this.Bs[0].batchId}ki(e){const i=this.Mi(e);return i<0||i>=this.Bs.length?null:this.Bs[i]}}class lge{constructor(e){this.$i=e,this.docs=new fR(fI.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,i){const d=i.key,_=this.docs.get(d),B=_?_.size:0,_t=this.$i(i);return this.docs=this.docs.insert(d,{document:i.mutableCopy(),size:_t}),this.size+=_t-B,this.indexManager.addToCollectionParentIndex(e,d.path.popLast())}removeEntry(e){const i=this.docs.get(e);i&&(this.docs=this.docs.remove(e),this.size-=i.size)}getEntry(e,i){const d=this.docs.get(i);return x0.resolve(d?d.document.mutableCopy():mS.newInvalidDocument(i))}getEntries(e,i){let d=HL();return i.forEach(_=>{const B=this.docs.get(_);d=d.insert(_,B?B.document.mutableCopy():mS.newInvalidDocument(_))}),x0.resolve(d)}getAllFromCollection(e,i,d){let _=HL();const B=new fI(i.child("")),_t=this.docs.getIteratorFrom(B);for(;_t.hasNext();){const{key:_a,value:{document:_h}}=_t.getNext();if(!i.isPrefixOf(_a.path))break;_a.path.length>i.length+1||rue(H_e(_h),d)<=0||(_=_.insert(_h.key,_h.mutableCopy()))}return x0.resolve(_)}getAllFromCollectionGroup(e,i,d,_){PI()}Bi(e,i){return x0.forEach(this.docs,d=>i(d))}newChangeBuffer(e){return new $Q(this)}getSize(e){return x0.resolve(this.size)}}class $Q extends ige{constructor(e){super(),this.Kn=e}applyChanges(e){const i=[];return this.changes.forEach((d,_)=>{_.isValidDocument()?i.push(this.Kn.addEntry(e,_)):this.Kn.removeEntry(d)}),x0.waitFor(i)}getFromCache(e,i){return this.Kn.getEntry(e,i)}getAllFromCache(e,i){return this.Kn.getEntries(e,i)}}class KK{constructor(e){this.persistence=e,this.Li=new J8(i=>jQ(i),SK),this.lastRemoteSnapshotVersion=a1.min(),this.highestTargetId=0,this.Ui=0,this.qi=new Yue,this.targetCount=0,this.Ki=W4.gn()}forEachTarget(e,i){return this.Li.forEach((d,_)=>i(_)),x0.resolve()}getLastRemoteSnapshotVersion(e){return x0.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return x0.resolve(this.Ui)}allocateTargetId(e){return this.highestTargetId=this.Ki.next(),x0.resolve(this.highestTargetId)}setTargetsMetadata(e,i,d){return d&&(this.lastRemoteSnapshotVersion=d),i>this.Ui&&(this.Ui=i),x0.resolve()}Tn(e){this.Li.set(e.target,e);const i=e.targetId;i>this.highestTargetId&&(this.Ki=new W4(i),this.highestTargetId=i),e.sequenceNumber>this.Ui&&(this.Ui=e.sequenceNumber)}addTargetData(e,i){return this.Tn(i),this.targetCount+=1,x0.resolve()}updateTargetData(e,i){return this.Tn(i),x0.resolve()}removeTargetData(e,i){return this.Li.delete(i.target),this.qi.vi(i.targetId),this.targetCount-=1,x0.resolve()}removeTargets(e,i,d){let _=0;const B=[];return this.Li.forEach((_t,_a)=>{_a.sequenceNumber<=i&&null===d.get(_a.targetId)&&(this.Li.delete(_t),B.push(this.removeMatchingKeysForTargetId(e,_a.targetId)),_++)}),x0.waitFor(B).next(()=>_)}getTargetCount(e){return x0.resolve(this.targetCount)}getTargetData(e,i){const d=this.Li.get(i)||null;return x0.resolve(d)}addMatchingKeys(e,i,d){return this.qi.bi(i,d),x0.resolve()}removeMatchingKeys(e,i,d){this.qi.Vi(i,d);const _=this.persistence.referenceDelegate,B=[];return _&&i.forEach(_t=>{B.push(_.markPotentiallyOrphaned(e,_t))}),x0.waitFor(B)}removeMatchingKeysForTargetId(e,i){return this.qi.vi(i),x0.resolve()}getMatchingKeysForTargetId(e,i){const d=this.qi.Di(i);return x0.resolve(d)}containsKey(e,i){return x0.resolve(this.qi.containsKey(i))}}class dge{constructor(e,i){this.Gi={},this.overlays={},this.es=new GL(0),this.ns=!1,this.ns=!0,this.referenceDelegate=e(this),this.fs=new KK(this),this.indexManager=new qL,this.ds=new lge(d=>this.referenceDelegate.Qi(d)),this.M=new xue(i),this._s=new Lve(this.M)}start(){return Promise.resolve()}shutdown(){return this.ns=!1,Promise.resolve()}get started(){return this.ns}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let i=this.overlays[e.toKey()];return i||(i=new Mve,this.overlays[e.toKey()]=i),i}getMutationQueue(e,i){let d=this.Gi[e.toKey()];return d||(d=new WL(i,this.referenceDelegate),this.Gi[e.toKey()]=d),d}getTargetCache(){return this.fs}getRemoteDocumentCache(){return this.ds}getBundleCache(){return this._s}runTransaction(e,i,d){nI("MemoryPersistence","Starting transaction:",e);const _=new Bve(this.es.next());return this.referenceDelegate.ji(),d(_).next(B=>this.referenceDelegate.Wi(_).next(()=>B)).toPromise().then(B=>(_.raiseOnCommittedEvent(),B))}zi(e,i){return x0.or(Object.values(this.Gi).map(d=>()=>d.containsKey(e,i)))}}class Bve extends gI{constructor(e){super(),this.currentSequenceNumber=e}}class die{constructor(e){this.persistence=e,this.Hi=new Yue,this.Ji=null}static Yi(e){return new die(e)}get Xi(){if(this.Ji)return this.Ji;throw PI()}addReference(e,i,d){return this.Hi.addReference(d,i),this.Xi.delete(d.toString()),x0.resolve()}removeReference(e,i,d){return this.Hi.removeReference(d,i),this.Xi.add(d.toString()),x0.resolve()}markPotentiallyOrphaned(e,i){return this.Xi.add(i.toString()),x0.resolve()}removeTarget(e,i){this.Hi.vi(i.targetId).forEach(_=>this.Xi.add(_.toString()));const d=this.persistence.getTargetCache();return d.getMatchingKeysForTargetId(e,i.targetId).next(_=>{_.forEach(B=>this.Xi.add(B.toString()))}).next(()=>d.removeTargetData(e,i))}ji(){this.Ji=new Set}Wi(e){const i=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x0.forEach(this.Xi,d=>{const _=fI.fromPath(d);return this.Zi(e,_).next(B=>{B||i.removeEntry(_,a1.min())})}).next(()=>(this.Ji=null,i.apply(e)))}updateLimboDocument(e,i){return this.Zi(e,i).next(d=>{d?this.Xi.delete(i.toString()):this.Xi.add(i.toString())})}Qi(e){return 0}Zi(e,i){return x0.or([()=>x0.resolve(this.Hi.containsKey(i)),()=>this.persistence.getTargetCache().containsKey(e,i),()=>this.persistence.zi(e,i)])}}function cX(o,e){return`firestore_clients_${o}_${e}`}function hge(o,e,i){let d=`firestore_mutations_${o}_${i}`;return e.isAuthenticated()&&(d+=`_${e.uid}`),d}function uX(o,e){return`firestore_targets_${o}_${e}`}class lX{constructor(e,i,d,_){this.user=e,this.batchId=i,this.state=d,this.error=_}static tr(e,i,d){const _=JSON.parse(d);let B,_t="object"==typeof _&&-1!==["pending","acknowledged","rejected"].indexOf(_.state)&&(void 0===_.error||"object"==typeof _.error);return _t&&_.error&&(_t="string"==typeof _.error.message&&"string"==typeof _.error.code,_t&&(B=new W0(_.error.code,_.error.message))),_t?new lX(e,i,_.state,B):(kR("SharedClientState",`Failed to parse mutation state for ID '${i}': ${d}`),null)}er(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class jM{constructor(e,i,d){this.targetId=e,this.state=i,this.error=d}static tr(e,i){const d=JSON.parse(i);let _,B="object"==typeof d&&-1!==["not-current","current","rejected"].indexOf(d.state)&&(void 0===d.error||"object"==typeof d.error);return B&&d.error&&(B="string"==typeof d.error.message&&"string"==typeof d.error.code,B&&(_=new W0(d.error.code,d.error.message))),B?new jM(e,d.state,_):(kR("SharedClientState",`Failed to parse target state for ID '${e}': ${i}`),null)}er(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class dX{constructor(e,i){this.clientId=e,this.activeTargetIds=i}static tr(e,i){const d=JSON.parse(i);let _="object"==typeof d&&d.activeTargetIds instanceof Array,B=B6();for(let _t=0;_&&_t<d.activeTargetIds.length;++_t)_=ape(d.activeTargetIds[_t]),B=B.add(d.activeTargetIds[_t]);return _?new dX(e,B):(kR("SharedClientState",`Failed to parse client data for instance '${e}': ${i}`),null)}}class hie{constructor(e,i){this.clientId=e,this.onlineState=i}static tr(e){const i=JSON.parse(e);return"object"==typeof i&&-1!==["Unknown","Online","Offline"].indexOf(i.onlineState)&&"string"==typeof i.clientId?new hie(i.clientId,i.onlineState):(kR("SharedClientState",`Failed to parse online state: ${e}`),null)}}class fie{constructor(){this.activeTargetIds=B6()}nr(e){this.activeTargetIds=this.activeTargetIds.add(e)}sr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}er(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class hX{constructor(e,i,d,_,B){this.window=e,this.Yn=i,this.persistenceKey=d,this.ir=_,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.rr=this.ur.bind(this),this.ar=new fR(R1),this.started=!1,this.cr=[];const _t=d.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=B,this.hr=cX(this.persistenceKey,this.ir),this.lr=`firestore_sequence_number_${this.persistenceKey}`,this.ar=this.ar.insert(this.ir,new fie),this.dr=new RegExp(`^firestore_clients_${_t}_([^_]*)$`),this._r=new RegExp(`^firestore_mutations_${_t}_(\\d+)(?:_(.*))?$`),this.wr=new RegExp(`^firestore_targets_${_t}_(\\d+)$`),this.mr=`firestore_online_state_${this.persistenceKey}`,this.gr=function(_a){return`firestore_bundle_loaded_v2_${_a}`}(this.persistenceKey),this.window.addEventListener("storage",this.rr)}static vt(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,C0.Z)(function*(){const i=yield e.syncEngine.Fs();for(const _ of i){if(_===e.ir)continue;const B=e.getItem(cX(e.persistenceKey,_));if(B){const _t=dX.tr(_,B);_t&&(e.ar=e.ar.insert(_t.clientId,_t))}}e.yr();const d=e.storage.getItem(e.mr);if(d){const _=e.pr(d);_&&e.Ir(_)}for(const _ of e.cr)e.ur(_);e.cr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.lr,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Tr(this.ar)}isActiveQueryTarget(e){let i=!1;return this.ar.forEach((d,_)=>{_.activeTargetIds.has(e)&&(i=!0)}),i}addPendingMutation(e){this.Er(e,"pending")}updateMutationState(e,i,d){this.Er(e,i,d),this.Ar(e)}addLocalQueryTarget(e){let i="not-current";if(this.isActiveQueryTarget(e)){const d=this.storage.getItem(uX(this.persistenceKey,e));if(d){const _=jM.tr(e,d);_&&(i=_.state)}}return this.Rr.nr(e),this.yr(),i}removeLocalQueryTarget(e){this.Rr.sr(e),this.yr()}isLocalQueryTarget(e){return this.Rr.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(uX(this.persistenceKey,e))}updateQueryState(e,i,d){this.br(e,i,d)}handleUserChange(e,i,d){i.forEach(_=>{this.Ar(_)}),this.currentUser=e,d.forEach(_=>{this.addPendingMutation(_)})}setOnlineState(e){this.Pr(e)}notifyBundleLoaded(e){this.Vr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.rr),this.removeItem(this.hr),this.started=!1)}getItem(e){const i=this.storage.getItem(e);return nI("SharedClientState","READ",e,i),i}setItem(e,i){nI("SharedClientState","SET",e,i),this.storage.setItem(e,i)}removeItem(e){nI("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ur(e){var i=this;const d=e;if(d.storageArea===this.storage){if(nI("SharedClientState","EVENT",d.key,d.newValue),d.key===this.hr)return void kR("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Yn.enqueueRetryable((0,C0.Z)(function*(){if(i.started){if(null!==d.key)if(i.dr.test(d.key)){if(null==d.newValue){const _=i.vr(d.key);return i.Sr(_,null)}{const _=i.Dr(d.key,d.newValue);if(_)return i.Sr(_.clientId,_)}}else if(i._r.test(d.key)){if(null!==d.newValue){const _=i.Cr(d.key,d.newValue);if(_)return i.Nr(_)}}else if(i.wr.test(d.key)){if(null!==d.newValue){const _=i.kr(d.key,d.newValue);if(_)return i.Mr(_)}}else if(d.key===i.mr){if(null!==d.newValue){const _=i.pr(d.newValue);if(_)return i.Ir(_)}}else if(d.key===i.lr){const _=function(B){let _t=GL.A;if(null!=B)try{const _a=JSON.parse(B);QI("number"==typeof _a),_t=_a}catch(_a){kR("SharedClientState","Failed to read sequence number from WebStorage",_a)}return _t}(d.newValue);_!==GL.A&&i.sequenceNumberHandler(_)}else if(d.key===i.gr){const _=i.Or(d.newValue);yield Promise.all(_.map(B=>i.syncEngine.Fr(B)))}}else i.cr.push(d)}))}}get Rr(){return this.ar.get(this.ir)}yr(){this.setItem(this.hr,this.Rr.er())}Er(e,i,d){const _=new lX(this.currentUser,e,i,d),B=hge(this.persistenceKey,this.currentUser,e);this.setItem(B,_.er())}Ar(e){const i=hge(this.persistenceKey,this.currentUser,e);this.removeItem(i)}Pr(e){this.storage.setItem(this.mr,JSON.stringify({clientId:this.ir,onlineState:e}))}br(e,i,d){const _=uX(this.persistenceKey,e),B=new jM(e,i,d);this.setItem(_,B.er())}Vr(e){const i=JSON.stringify(Array.from(e));this.setItem(this.gr,i)}vr(e){const i=this.dr.exec(e);return i?i[1]:null}Dr(e,i){const d=this.vr(e);return dX.tr(d,i)}Cr(e,i){const d=this._r.exec(e),_=Number(d[1]);return lX.tr(new qO(void 0!==d[2]?d[2]:null),_,i)}kr(e,i){const d=this.wr.exec(e),_=Number(d[1]);return jM.tr(_,i)}pr(e){return hie.tr(e)}Or(e){return JSON.parse(e)}Nr(e){var i=this;return(0,C0.Z)(function*(){if(e.user.uid===i.currentUser.uid)return i.syncEngine.$r(e.batchId,e.state,e.error);nI("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Mr(e){return this.syncEngine.Br(e.targetId,e.state,e.error)}Sr(e,i){const d=i?this.ar.insert(e,i):this.ar.remove(e),_=this.Tr(this.ar),B=this.Tr(d),_t=[],_a=[];return B.forEach(_h=>{_.has(_h)||_t.push(_h)}),_.forEach(_h=>{B.has(_h)||_a.push(_h)}),this.syncEngine.Lr(_t,_a).then(()=>{this.ar=d})}Ir(e){this.ar.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Tr(e){let i=B6();return e.forEach((d,_)=>{i=i.unionWith(_.activeTargetIds)}),i}}class fge{constructor(){this.Ur=new fie,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,i,d){}addLocalQueryTarget(e){return this.Ur.nr(e),this.qr[e]||"not-current"}updateQueryState(e,i,d){this.qr[e]=i}removeLocalQueryTarget(e){this.Ur.sr(e)}isLocalQueryTarget(e){return this.Ur.activeTargetIds.has(e)}clearQueryState(e){delete this.qr[e]}getAllActiveQueryTargets(){return this.Ur.activeTargetIds}isActiveQueryTarget(e){return this.Ur.activeTargetIds.has(e)}start(){return this.Ur=new fie,Promise.resolve()}handleUserChange(e,i,d){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Jue{Kr(e){}shutdown(){}}class pge{constructor(){this.Gr=()=>this.Qr(),this.jr=()=>this.Wr(),this.zr=[],this.Hr()}Kr(e){this.zr.push(e)}shutdown(){window.removeEventListener("online",this.Gr),window.removeEventListener("offline",this.jr)}Hr(){window.addEventListener("online",this.Gr),window.addEventListener("offline",this.jr)}Qr(){nI("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.zr)e(0)}Wr(){nI("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.zr)e(1)}static vt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const tG={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class gge{constructor(e){this.Jr=e.Jr,this.Yr=e.Yr}Xr(e){this.Zr=e}eo(e){this.no=e}onMessage(e){this.so=e}close(){this.Yr()}send(e){this.Jr(e)}io(){this.Zr()}ro(e){this.no(e)}oo(e){this.so(e)}}class ZQ extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.uo=(e.ssl?"https":"http")+"://"+e.host,this.ao="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}co(e,i,d,_,B){const _t=this.ho(e,i);nI("RestConnection","Sending: ",_t,d);const _a={};return this.lo(_a,_,B),this.fo(e,_t,_a,d).then(_h=>(nI("RestConnection","Received: ",_h),_h),_h=>{throw bK("RestConnection",`${e} failed with error: `,_h,"url: ",_t,"request:",d),_h})}_o(e,i,d,_,B){return this.co(e,i,d,_,B)}lo(e,i,d){e["X-Goog-Api-Client"]="gl-js/ fire/"+NQ,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((_,B)=>e[B]=_),d&&d.headers.forEach((_,B)=>e[B]=_)}ho(e,i){return`${this.uo}/v1/${i}:${tG[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}fo(e,i,d,_){return new Promise((B,_t)=>{const _a=new qce;_a.listenOnce(rpe.COMPLETE,()=>{try{switch(_a.getLastErrorCode()){case Rre.NO_ERROR:const _g=_a.getResponseJson();nI("Connection","XHR received:",JSON.stringify(_g)),B(_g);break;case Rre.TIMEOUT:nI("Connection",'RPC "'+e+'" timed out'),_t(new W0(T0.DEADLINE_EXCEEDED,"Request time out"));break;case Rre.HTTP_ERROR:const l_=_a.getStatus();if(nI("Connection",'RPC "'+e+'" failed with status:',l_,"response text:",_a.getResponseText()),l_>0){const f_=_a.getResponseJson().error;if(f_&&f_.status&&f_.message){const R_=function(H_){const W_=H_.toLowerCase().replace(/_/g,"-");return Object.values(T0).indexOf(W_)>=0?W_:T0.UNKNOWN}(f_.status);_t(new W0(R_,f_.message))}else _t(new W0(T0.UNKNOWN,"Server responded with status "+_a.getStatus()))}else _t(new W0(T0.UNAVAILABLE,"Connection failed."));break;default:PI()}}finally{nI("Connection",'RPC "'+e+'" completed.')}});const _h=JSON.stringify(_);_a.send(i,"POST",_h,d,15)})}wo(e,i,d){const _=[this.uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],B=npe(),_t=Qce(),_a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(_a.xmlHttpFactory=new Dre({})),this.lo(_a.initMessageHeaders,i,d),(0,M_.uI)()||(0,M_.b$)()||(0,M_.d)()||(0,M_.w1)()||(0,M_.Mn)()||(0,M_.ru)()||(_a.httpHeadersOverwriteParam="$httpHeaders");const _h=_.join("");nI("Connection","Creating WebChannel: "+_h,_a);const _g=B.createWebChannel(_h,_a);let l_=!1,f_=!1;const R_=new gge({Jr:W_=>{f_?nI("Connection","Not sending because WebChannel is closed:",W_):(l_||(nI("Connection","Opening WebChannel transport."),_g.open(),l_=!0),nI("Connection","WebChannel sending:",W_),_g.send(W_))},Yr:()=>_g.close()}),H_=(W_,R0,H0)=>{W_.listen(R0,CI=>{try{H0(CI)}catch(LI){setTimeout(()=>{throw LI},0)}})};return H_(_g,Nre.EventType.OPEN,()=>{f_||nI("Connection","WebChannel transport opened.")}),H_(_g,Nre.EventType.CLOSE,()=>{f_||(f_=!0,nI("Connection","WebChannel transport closed"),R_.ro())}),H_(_g,Nre.EventType.ERROR,W_=>{f_||(f_=!0,bK("Connection","WebChannel transport errored:",W_),R_.ro(new W0(T0.UNAVAILABLE,"The operation could not be completed")))}),H_(_g,Nre.EventType.MESSAGE,W_=>{var R0;if(!f_){const H0=W_.data[0];QI(!!H0);const CI=H0,LI=CI.error||(null===(R0=CI[0])||void 0===R0?void 0:R0.error);if(LI){nI("Connection","WebChannel received error:",LI);const xI=LI.status;let DI=function(G1){const BR=LR[G1];if(void 0!==BR)return Dpe(BR)}(xI),_C=LI.message;void 0===DI&&(DI=T0.INTERNAL,_C="Unknown error status: "+xI+" with message "+LI.message),f_=!0,R_.ro(new W0(DI,_C)),_g.close()}else nI("Connection","WebChannel received:",H0),R_.oo(H0)}}),H_(_t,Ore.STAT_EVENT,W_=>{W_.stat===Hce.PROXY?nI("Connection","Detected buffering proxy"):W_.stat===Hce.NOPROXY&&nI("Connection","Detected no buffering proxy")}),setTimeout(()=>{R_.io()},0),R_}}function XQ(){return"undefined"!=typeof window?window:null}function pR(){return"undefined"!=typeof document?document:null}function fX(o){return new ave(o,!0)}class VT{constructor(e,i,d=1e3,_=1.5,B=6e4){this.Yn=e,this.timerId=i,this.mo=d,this.yo=_,this.po=B,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(e){this.cancel();const i=Math.floor(this.Io+this.bo()),d=Math.max(0,Date.now()-this.Eo),_=Math.max(0,i-d);_>0&&nI("ExponentialBackoff",`Backing off for ${_} ms (base delay: ${this.Io} ms, delay with jitter: ${i} ms, last attempt: ${d} ms ago)`),this.To=this.Yn.enqueueAfterDelay(this.timerId,_,()=>(this.Eo=Date.now(),e())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class $ue{constructor(e,i,d,_,B,_t,_a,_h){this.Yn=e,this.Vo=d,this.vo=_,this.So=B,this.authCredentialsProvider=_t,this.appCheckCredentialsProvider=_a,this.listener=_h,this.state=0,this.Do=0,this.Co=null,this.xo=null,this.stream=null,this.No=new VT(e,i)}ko(){return 1===this.state||5===this.state||this.Mo()}Mo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var e=this;return(0,C0.Z)(function*(){e.ko()&&(yield e.close(0))})()}Fo(){this.state=0,this.No.reset()}$o(){this.Mo()&&null===this.Co&&(this.Co=this.Yn.enqueueAfterDelay(this.Vo,6e4,()=>this.Bo()))}Lo(e){this.Uo(),this.stream.send(e)}Bo(){var e=this;return(0,C0.Z)(function*(){if(e.Mo())return e.close(0)})()}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}qo(){this.xo&&(this.xo.cancel(),this.xo=null)}close(e,i){var d=this;return(0,C0.Z)(function*(){d.Uo(),d.qo(),d.No.cancel(),d.Do++,4!==e?d.No.reset():i&&i.code===T0.RESOURCE_EXHAUSTED?(kR(i.toString()),kR("Using maximum backoff delay to prevent overloading the backend."),d.No.Ao()):i&&i.code===T0.UNAUTHENTICATED&&3!==d.state&&(d.authCredentialsProvider.invalidateToken(),d.appCheckCredentialsProvider.invalidateToken()),null!==d.stream&&(d.Ko(),d.stream.close(),d.stream=null),d.state=e,yield d.listener.eo(i)})()}Ko(){}auth(){this.state=1;const e=this.Go(this.Do),i=this.Do;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([d,_])=>{this.Do===i&&this.Qo(d,_)},d=>{e(()=>{const _=new W0(T0.UNKNOWN,"Fetching auth token failed: "+d.message);return this.jo(_)})})}Qo(e,i){const d=this.Go(this.Do);this.stream=this.Wo(e,i),this.stream.Xr(()=>{d(()=>(this.state=2,this.xo=this.Yn.enqueueAfterDelay(this.vo,1e4,()=>(this.Mo()&&(this.state=3),Promise.resolve())),this.listener.Xr()))}),this.stream.eo(_=>{d(()=>this.jo(_))}),this.stream.onMessage(_=>{d(()=>this.onMessage(_))})}Oo(){var e=this;this.state=5,this.No.Ro((0,C0.Z)(function*(){e.state=0,e.start()}))}jo(e){return nI("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Go(e){return i=>{this.Yn.enqueueAndForget(()=>this.Do===e?i():(nI("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class pie extends $ue{constructor(e,i,d,_,B,_t){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",i,d,_,_t),this.M=B}Wo(e,i){return this.So.wo("Listen",e,i)}onMessage(e){this.No.reset();const i=function lve(o,e){let i;if("targetChange"in e){const d="NO_CHANGE"===(_h=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===_h?1:"REMOVE"===_h?2:"CURRENT"===_h?3:"RESET"===_h?4:PI(),_=e.targetChange.targetIds||[],B=function(_h,_g){return _h.N?(QI(void 0===_g||"string"==typeof _g),aO.fromBase64String(_g||"")):(QI(void 0===_g||_g instanceof Uint8Array),aO.fromUint8Array(_g||new Uint8Array))}(o,e.targetChange.resumeToken),_t=e.targetChange.cause,_a=_t&&function(_h){const _g=void 0===_h.code?T0.UNKNOWN:Dpe(_h.code);return new W0(_g,_h.message||"")}(_t);i=new _ue(d,_,B,_a||null)}else if("documentChange"in e){const d=e.documentChange,_=G4(o,d.document.name),B=bO(d.document.updateTime),_t=new CN({mapValue:{fields:d.document.fields}}),_a=mS.newFoundDocument(_,B,_t);i=new Yre(d.targetIds||[],d.removedTargetIds||[],_a.key,_a)}else if("documentDelete"in e){const d=e.documentDelete,_=G4(o,d.document),B=d.readTime?bO(d.readTime):a1.min(),_t=mS.newNoDocument(_,B);i=new Yre([],d.removedTargetIds||[],_t.key,_t)}else if("documentRemove"in e){const d=e.documentRemove,_=G4(o,d.document);i=new Yre([],d.removedTargetIds||[],_,null)}else{if(!("filter"in e))return PI();{const d=e.filter,B=new tve(d.count||0);i=new kpe(d.targetId,B)}}var _h;return i}(this.M,e),d=function(_){if(!("targetChange"in _))return a1.min();const B=_.targetChange;return B.targetIds&&B.targetIds.length?a1.min():B.readTime?bO(B.readTime):a1.min()}(e);return this.listener.zo(i,d)}Ho(e){const i={};i.database=FM(this.M),i.addTarget=function(_,B){let _t;const _a=B.target;return _t=RK(_a)?{documents:Jre(_,_a)}:{query:Bpe(_,_a)},_t.targetId=B.targetId,B.resumeToken.approximateByteSize()>0?_t.resumeToken=vue(_,B.resumeToken):B.snapshotVersion.compareTo(a1.min())>0&&(_t.readTime=YZ(_,B.snapshotVersion.toTimestamp())),_t}(this.M,e);const d=function hve(o,e){const i=function(d,_){switch(_){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return PI()}}(0,e.purpose);return null==i?null:{"goog-listen-tags":i}}(0,e);d&&(i.labels=d),this.Lo(i)}Jo(e){const i={};i.database=FM(this.M),i.removeTarget=e,this.Lo(i)}}class mge extends $ue{constructor(e,i,d,_,B,_t){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",i,d,_,_t),this.M=B,this.Yo=!1}get Xo(){return this.Yo}start(){this.Yo=!1,this.lastStreamToken=void 0,super.start()}Ko(){this.Yo&&this.Zo([])}Wo(e,i){return this.So.wo("Write",e,i)}onMessage(e){if(QI(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Yo){this.No.reset();const i=function dve(o,e){return o&&o.length>0?(QI(void 0!==e),o.map(i=>function(d,_){let B=bO(d.updateTime?d.updateTime:_);return B.isEqual(a1.min())&&(B=bO(_)),new wpe(B,d.transformResults||[])}(i,e))):[]}(e.writeResults,e.commitTime),d=bO(e.commitTime);return this.listener.tu(d,i)}return QI(!e.writeResults||0===e.writeResults.length),this.Yo=!0,this.listener.eu()}nu(){const e={};e.database=FM(this.M),this.Lo(e)}Zo(e){const i={streamToken:this.lastStreamToken,writes:e.map(d=>$Z(this.M,d))};this.Lo(i)}}class e9 extends class{}{constructor(e,i,d,_){super(),this.authCredentials=e,this.appCheckCredentials=i,this.So=d,this.M=_,this.su=!1}iu(){if(this.su)throw new W0(T0.FAILED_PRECONDITION,"The client has already been terminated.")}co(e,i,d){return this.iu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([_,B])=>this.So.co(e,i,d,_,B)).catch(_=>{throw"FirebaseError"===_.name?(_.code===T0.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),_):new W0(T0.UNKNOWN,_.toString())})}_o(e,i,d){return this.iu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([_,B])=>this.So._o(e,i,d,_,B)).catch(_=>{throw"FirebaseError"===_.name?(_.code===T0.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),_):new W0(T0.UNKNOWN,_.toString())})}terminate(){this.su=!0}}class ZP{constructor(e,i){this.asyncQueue=e,this.onlineStateHandler=i,this.state="Unknown",this.ru=0,this.ou=null,this.uu=!0}au(){0===this.ru&&(this.cu("Unknown"),this.ou=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ou=null,this.hu("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}lu(e){"Online"===this.state?this.cu("Unknown"):(this.ru++,this.ru>=1&&(this.fu(),this.hu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.cu("Offline")))}set(e){this.fu(),this.ru=0,"Online"===e&&(this.uu=!1),this.cu(e)}cu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}hu(e){const i=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.uu?(kR(i),this.uu=!1):nI("OnlineStateTracker",i)}fu(){null!==this.ou&&(this.ou.cancel(),this.ou=null)}}class wT{constructor(e,i,d,_,B){var _t=this;this.localStore=e,this.datastore=i,this.asyncQueue=d,this.remoteSyncer={},this.du=[],this._u=new Map,this.wu=new Set,this.mu=[],this.gu=B,this.gu.Kr(_a=>{d.enqueueAndForget((0,C0.Z)(function*(){var _h;G6(_t)&&(nI("RemoteStore","Restarting streams for network reachability change."),yield(_h=(0,C0.Z)(function*(_g){const l_=pI(_g);l_.wu.add(4),yield nG(l_),l_.yu.set("Unknown"),l_.wu.delete(4),yield o3(l_)}),function(_g){return _h.apply(this,arguments)})(_t))}))}),this.yu=new ZP(d,_)}}function o3(o){return zK.apply(this,arguments)}function zK(){return zK=(0,C0.Z)(function*(o){if(G6(o))for(const e of o.mu)yield e(!0)}),zK.apply(this,arguments)}function nG(o){return gie.apply(this,arguments)}function gie(){return gie=(0,C0.Z)(function*(o){for(const e of o.mu)yield e(!1)}),gie.apply(this,arguments)}function d2(o,e){const i=pI(o);i._u.has(e.targetId)||(i._u.set(e.targetId,e),JK(i)?pX(i):r9(i).Mo()&&mie(i,e))}function jS(o,e){const i=pI(o),d=r9(i);i._u.delete(e),d.Mo()&&YK(i,e),0===i._u.size&&(d.Mo()?d.$o():G6(i)&&i.yu.set("Unknown"))}function mie(o,e){o.pu.Z(e.targetId),r9(o).Ho(e)}function YK(o,e){o.pu.Z(e),r9(o).Jo(e)}function pX(o){o.pu=new ove({getRemoteKeysForTarget:e=>o.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>o._u.get(e)||null}),r9(o).start(),o.yu.au()}function JK(o){return G6(o)&&!r9(o).ko()&&o._u.size>0}function G6(o){return 0===pI(o).wu.size}function Zue(o){o.pu=void 0}function t9(o){return Aie.apply(this,arguments)}function Aie(){return Aie=(0,C0.Z)(function*(o){o._u.forEach((e,i)=>{mie(o,e)})}),Aie.apply(this,arguments)}function Uve(o,e){return Xue.apply(this,arguments)}function Xue(){return Xue=(0,C0.Z)(function*(o,e){Zue(o),JK(o)?(o.yu.lu(e),pX(o)):o.yu.set("Unknown")}),Xue.apply(this,arguments)}function Age(o,e,i){return _ie.apply(this,arguments)}function _ie(){return _ie=(0,C0.Z)(function*(o,e,i){if(o.yu.set("Online"),e instanceof _ue&&2===e.state&&e.cause)try{yield(d=(0,C0.Z)(function*(_,B){const _t=B.cause;for(const _a of B.targetIds)_._u.has(_a)&&(yield _.remoteSyncer.rejectListen(_a,_t),_._u.delete(_a),_.pu.removeTarget(_a))}),function(_,B){return d.apply(this,arguments)})(o,e)}catch(d){nI("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),d),yield vie(o,d)}else if(e instanceof Yre?o.pu.ut(e):e instanceof kpe?o.pu._t(e):o.pu.ht(e),!i.isEqual(a1.min()))try{const d=yield que(o.localStore);i.compareTo(d)>=0&&(yield function(_,B){const _t=_.pu.yt(B);return _t.targetChanges.forEach((_a,_h)=>{if(_a.resumeToken.approximateByteSize()>0){const _g=_._u.get(_h);_g&&_._u.set(_h,_g.withResumeToken(_a.resumeToken,B))}}),_t.targetMismatches.forEach(_a=>{const _h=_._u.get(_a);if(!_h)return;_._u.set(_a,_h.withResumeToken(aO.EMPTY_BYTE_STRING,_h.snapshotVersion)),YK(_,_a);const _g=new $P(_h.target,_a,1,_h.sequenceNumber);mie(_,_g)}),_.remoteSyncer.applyRemoteEvent(_t)}(o,i))}catch(d){nI("RemoteStore","Failed to raise snapshot:",d),yield vie(o,d)}var d}),_ie.apply(this,arguments)}function vie(o,e,i){return ele.apply(this,arguments)}function ele(){return ele=(0,C0.Z)(function*(o,e,i){if(!U6(e))throw e;o.wu.add(1),yield nG(o),o.yu.set("Offline"),i||(i=()=>que(o.localStore)),o.asyncQueue.enqueueRetryable((0,C0.Z)(function*(){nI("RemoteStore","Retrying IndexedDB access"),yield i(),o.wu.delete(1),yield o3(o)}))}),ele.apply(this,arguments)}function _ge(o,e){return e().catch(i=>vie(o,i,e))}function rG(o){return tle.apply(this,arguments)}function tle(){return tle=(0,C0.Z)(function*(o){const e=pI(o),i=iG(e);let d=e.du.length>0?e.du[e.du.length-1].batchId:-1;for(;Fve(e);)try{const _=yield uge(e.localStore,d);if(null===_){0===e.du.length&&i.$o();break}d=_.batchId,jve(e,_)}catch(_){yield vie(e,_)}vge(e)&&n9(e)}),tle.apply(this,arguments)}function Fve(o){return G6(o)&&o.du.length<10}function jve(o,e){o.du.push(e);const i=iG(o);i.Mo()&&i.Xo&&i.Zo(e.mutations)}function vge(o){return G6(o)&&!iG(o).ko()&&o.du.length>0}function n9(o){iG(o).start()}function yge(o){return nle.apply(this,arguments)}function nle(){return nle=(0,C0.Z)(function*(o){iG(o).nu()}),nle.apply(this,arguments)}function Vve(o){return rle.apply(this,arguments)}function rle(){return rle=(0,C0.Z)(function*(o){const e=iG(o);for(const i of o.du)e.Zo(i.mutations)}),rle.apply(this,arguments)}function Gve(o,e,i){return ile.apply(this,arguments)}function ile(){return ile=(0,C0.Z)(function*(o,e,i){const d=o.du.shift(),_=XZ.from(d,e,i);yield _ge(o,()=>o.remoteSyncer.applySuccessfulWrite(_)),yield rG(o)}),ile.apply(this,arguments)}function Qve(o,e){return ole.apply(this,arguments)}function ole(){return ole=(0,C0.Z)(function*(o,e){var i;e&&iG(o).Xo&&(yield(i=(0,C0.Z)(function*(d,_){if(Kre(B=_.code)&&B!==T0.ABORTED){const _t=d.du.shift();iG(d).Fo(),yield _ge(d,()=>d.remoteSyncer.rejectFailedWrite(_t.batchId,_)),yield rG(d)}var B}),function(d,_){return i.apply(this,arguments)})(o,e)),vge(o)&&n9(o)}),ole.apply(this,arguments)}function Ege(o,e){return sle.apply(this,arguments)}function sle(){return sle=(0,C0.Z)(function*(o,e){const i=pI(o);i.asyncQueue.verifyOperationInProgress(),nI("RemoteStore","RemoteStore received new credentials");const d=G6(i);i.wu.add(3),yield nG(i),d&&i.yu.set("Unknown"),yield i.remoteSyncer.handleCredentialChange(e),i.wu.delete(3),yield o3(i)}),sle.apply(this,arguments)}function ale(o,e){return cle.apply(this,arguments)}function cle(){return cle=(0,C0.Z)(function*(o,e){const i=pI(o);e?(i.wu.delete(2),yield o3(i)):e||(i.wu.add(2),yield nG(i),i.yu.set("Unknown"))}),cle.apply(this,arguments)}function r9(o){return o.Iu||(o.Iu=function(e,i,d){const _=pI(e);return _.iu(),new pie(i,_.So,_.authCredentials,_.appCheckCredentials,_.M,d)}(o.datastore,o.asyncQueue,{Xr:t9.bind(null,o),eo:Uve.bind(null,o),zo:Age.bind(null,o)}),o.mu.push(function(){var e=(0,C0.Z)(function*(i){i?(o.Iu.Fo(),JK(o)?pX(o):o.yu.set("Unknown")):(yield o.Iu.stop(),Zue(o))});return function(i){return e.apply(this,arguments)}}())),o.Iu}function iG(o){return o.Tu||(o.Tu=function(e,i,d){const _=pI(e);return _.iu(),new mge(i,_.So,_.authCredentials,_.appCheckCredentials,_.M,d)}(o.datastore,o.asyncQueue,{Xr:yge.bind(null,o),eo:Qve.bind(null,o),eu:Vve.bind(null,o),tu:Gve.bind(null,o)}),o.mu.push(function(){var e=(0,C0.Z)(function*(i){i?(o.Tu.Fo(),yield rG(o)):(yield o.Tu.stop(),o.du.length>0&&(nI("RemoteStore",`Stopping write stream with ${o.du.length} pending writes`),o.du=[]))});return function(i){return e.apply(this,arguments)}}())),o.Tu}class ule{constructor(e,i,d,_,B){this.asyncQueue=e,this.timerId=i,this.targetTimeMs=d,this.op=_,this.removalCallback=B,this.deferred=new sO,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(_t=>{})}static createAndSchedule(e,i,d,_,B){const _t=Date.now()+d,_a=new ule(e,i,_t,_,B);return _a.start(d),_a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new W0(T0.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function i9(o,e){if(kR("AsyncQueue",`${e}: ${o}`),U6(o))return new W0(T0.UNAVAILABLE,`${e}: ${o}`);throw o}class VM{constructor(e){this.comparator=e?(i,d)=>e(i,d)||fI.comparator(i.key,d.key):(i,d)=>fI.comparator(i.key,d.key),this.keyedMap=zre(),this.sortedSet=new fR(this.comparator)}static emptySet(e){return new VM(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const i=this.keyedMap.get(e);return i?this.sortedSet.indexOf(i):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((i,d)=>(e(i),!1))}add(e){const i=this.delete(e.key);return i.copy(i.keyedMap.insert(e.key,e),i.sortedSet.insert(e,null))}delete(e){const i=this.get(e);return i?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(i)):this}isEqual(e){if(!(e instanceof VM)||this.size!==e.size)return!1;const i=this.sortedSet.getIterator(),d=e.sortedSet.getIterator();for(;i.hasNext();){const _=i.getNext().key,B=d.getNext().key;if(!_.isEqual(B))return!1}return!0}toString(){const e=[];return this.forEach(i=>{e.push(i.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,i){const d=new VM;return d.comparator=this.comparator,d.keyedMap=e,d.sortedSet=i,d}}class yie{constructor(){this.Eu=new fR(fI.comparator)}track(e){const i=e.doc.key,d=this.Eu.get(i);d?0!==e.type&&3===d.type?this.Eu=this.Eu.insert(i,e):3===e.type&&1!==d.type?this.Eu=this.Eu.insert(i,{type:d.type,doc:e.doc}):2===e.type&&2===d.type?this.Eu=this.Eu.insert(i,{type:2,doc:e.doc}):2===e.type&&0===d.type?this.Eu=this.Eu.insert(i,{type:0,doc:e.doc}):1===e.type&&0===d.type?this.Eu=this.Eu.remove(i):1===e.type&&2===d.type?this.Eu=this.Eu.insert(i,{type:1,doc:d.doc}):0===e.type&&1===d.type?this.Eu=this.Eu.insert(i,{type:2,doc:e.doc}):PI():this.Eu=this.Eu.insert(i,e)}Au(){const e=[];return this.Eu.inorderTraversal((i,d)=>{e.push(d)}),e}}class $K{constructor(e,i,d,_,B,_t,_a,_h){this.query=e,this.docs=i,this.oldDocs=d,this.docChanges=_,this.mutatedKeys=B,this.fromCache=_t,this.syncStateChanged=_a,this.excludesMetadataChanges=_h}static fromInitialDocuments(e,i,d,_){const B=[];return i.forEach(_t=>{B.push({type:0,doc:_t})}),new $K(e,i,VM.emptySet(i),B,d,_,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&NK(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const i=this.docChanges,d=e.docChanges;if(i.length!==d.length)return!1;for(let _=0;_<i.length;_++)if(i[_].type!==d[_].type||!i[_].doc.isEqual(d[_].doc))return!1;return!0}}class Ige{constructor(){this.Ru=void 0,this.listeners=[]}}class bge{constructor(){this.queries=new J8(e=>kK(e),NK),this.onlineState="Unknown",this.bu=new Set}}function Eie(o,e){return lle.apply(this,arguments)}function lle(){return lle=(0,C0.Z)(function*(o,e){const i=pI(o),d=e.query;let _=!1,B=i.queries.get(d);if(B||(_=!0,B=new Ige),_)try{B.Ru=yield i.onListen(d)}catch(_t){const _a=i9(_t,`Initialization of query '${uue(e.query)}' failed`);return void e.onError(_a)}i.queries.set(d,B),B.listeners.push(e),e.Pu(i.onlineState),B.Ru&&e.Vu(B.Ru)&&K4(i)}),lle.apply(this,arguments)}function oG(o,e){return gX.apply(this,arguments)}function gX(){return gX=(0,C0.Z)(function*(o,e){const i=pI(o),d=e.query;let _=!1;const B=i.queries.get(d);if(B){const _t=B.listeners.indexOf(e);_t>=0&&(B.listeners.splice(_t,1),_=0===B.listeners.length)}if(_)return i.queries.delete(d),i.onUnlisten(d)}),gX.apply(this,arguments)}function Cge(o,e){const i=pI(o);let d=!1;for(const _ of e){const _t=i.queries.get(_.query);if(_t){for(const _a of _t.listeners)_a.Vu(_)&&(d=!0);_t.Ru=_}}d&&K4(i)}function wge(o,e,i){const d=pI(o),_=d.queries.get(e);if(_)for(const B of _.listeners)B.onError(i);d.queries.delete(e)}function K4(o){o.bu.forEach(e=>{e.next()})}class dle{constructor(e,i,d){this.query=e,this.vu=i,this.Su=!1,this.Du=null,this.onlineState="Unknown",this.options=d||{}}Vu(e){if(!this.options.includeMetadataChanges){const d=[];for(const _ of e.docChanges)3!==_.type&&d.push(_);e=new $K(e.query,e.docs,e.oldDocs,d,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let i=!1;return this.Su?this.Cu(e)&&(this.vu.next(e),i=!0):this.xu(e,this.onlineState)&&(this.Nu(e),i=!0),this.Du=e,i}onError(e){this.vu.error(e)}Pu(e){this.onlineState=e;let i=!1;return this.Du&&!this.Su&&this.xu(this.Du,e)&&(this.Nu(this.Du),i=!0),i}xu(e,i){return!e.fromCache||!(this.options.ku&&"Offline"!==i||e.docs.isEmpty()&&"Offline"!==i)}Cu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Du&&this.Du.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Nu(e){e=$K.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Su=!0,this.vu.next(e)}}class Hve{constructor(e,i){this.payload=e,this.byteLength=i}Mu(){return"metadata"in this.payload}}class Tge{constructor(e){this.M=e}wi(e){return G4(this.M,e)}mi(e){return e.metadata.exists?Cue(this.M,e.document,!1):mS.newNoDocument(this.wi(e.metadata.name),this.gi(e.metadata.readTime))}gi(e){return bO(e)}}class Sge{constructor(e,i,d){this.Ou=e,this.localStore=i,this.M=d,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Rge(e)}Fu(e){this.progress.bytesLoaded+=e.byteLength;let i=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++i;const d=eT.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(d.get(d.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++i);return i!==this.progress.documentsLoaded?(this.progress.documentsLoaded=i,Object.assign({},this.progress)):null}$u(e){const i=new Map,d=new Tge(this.M);for(const _ of e)if(_.metadata.queries){const B=d.wi(_.metadata.name);for(const _t of _.metadata.queries){const _a=(i.get(_t)||CT()).add(B);i.set(_t,_a)}}return i}complete(){var e=this;return(0,C0.Z)(function*(){const i=yield function cO(o,e,i,d){return JQ.apply(this,arguments)}(e.localStore,new Tge(e.M),e.documents,e.Ou.id),d=e.$u(e.documents);for(const _ of e.queries)yield xve(e.localStore,_,d.get(_.name));return e.progress.taskState="Success",{progress:e.progress,Bu:e.collectionGroups,Lu:i}})()}}function Rge(o){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:o.totalDocuments,totalBytes:o.totalBytes}}class Oge{constructor(e){this.key=e}}class Dge{constructor(e){this.key=e}}class Iie{constructor(e,i){this.query=e,this.Uu=i,this.qu=null,this.current=!1,this.Ku=CT(),this.mutatedKeys=CT(),this.Gu=Gre(e),this.Qu=new VM(this.Gu)}get ju(){return this.Uu}Wu(e,i){const d=i?i.zu:new yie,_=i?i.Qu:this.Qu;let B=i?i.mutatedKeys:this.mutatedKeys,_t=_,_a=!1;const _h="F"===this.query.limitType&&_.size===this.query.limit?_.last():null,_g="L"===this.query.limitType&&_.size===this.query.limit?_.first():null;if(e.inorderTraversal((l_,f_)=>{const R_=_.get(l_),H_=jZ(this.query,f_)?f_:null,W_=!!R_&&this.mutatedKeys.has(R_.key),R0=!!H_&&(H_.hasLocalMutations||this.mutatedKeys.has(H_.key)&&H_.hasCommittedMutations);let H0=!1;R_&&H_?R_.data.isEqual(H_.data)?W_!==R0&&(d.track({type:3,doc:H_}),H0=!0):this.Hu(R_,H_)||(d.track({type:2,doc:H_}),H0=!0,(_h&&this.Gu(H_,_h)>0||_g&&this.Gu(H_,_g)<0)&&(_a=!0)):!R_&&H_?(d.track({type:0,doc:H_}),H0=!0):R_&&!H_&&(d.track({type:1,doc:R_}),H0=!0,(_h||_g)&&(_a=!0)),H0&&(H_?(_t=_t.add(H_),B=R0?B.add(l_):B.delete(l_)):(_t=_t.delete(l_),B=B.delete(l_)))}),null!==this.query.limit)for(;_t.size>this.query.limit;){const l_="F"===this.query.limitType?_t.last():_t.first();_t=_t.delete(l_.key),B=B.delete(l_.key),d.track({type:1,doc:l_})}return{Qu:_t,zu:d,ii:_a,mutatedKeys:B}}Hu(e,i){return e.hasLocalMutations&&i.hasCommittedMutations&&!i.hasLocalMutations}applyChanges(e,i,d){const _=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;const B=e.zu.Au();B.sort((_g,l_)=>function(f_,R_){const H_=W_=>{switch(W_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return PI()}};return H_(f_)-H_(R_)}(_g.type,l_.type)||this.Gu(_g.doc,l_.doc)),this.Ju(d);const _t=i?this.Yu():[],_a=0===this.Ku.size&&this.current?1:0,_h=_a!==this.qu;return this.qu=_a,0!==B.length||_h?{snapshot:new $K(this.query,e.Qu,_,B,e.mutatedKeys,0===_a,_h,!1),Xu:_t}:{Xu:_t}}Pu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new yie,mutatedKeys:this.mutatedKeys,ii:!1},!1)):{Xu:[]}}Zu(e){return!this.Uu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}Ju(e){e&&(e.addedDocuments.forEach(i=>this.Uu=this.Uu.add(i)),e.modifiedDocuments.forEach(i=>{}),e.removedDocuments.forEach(i=>this.Uu=this.Uu.delete(i)),this.current=e.current)}Yu(){if(!this.current)return[];const e=this.Ku;this.Ku=CT(),this.Qu.forEach(d=>{this.Zu(d.key)&&(this.Ku=this.Ku.add(d.key))});const i=[];return e.forEach(d=>{this.Ku.has(d)||i.push(new Dge(d))}),this.Ku.forEach(d=>{e.has(d)||i.push(new Oge(d))}),i}ta(e){this.Uu=e._i,this.Ku=CT();const i=this.Wu(e.documents);return this.applyChanges(i,!0)}ea(){return $K.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu)}}class bie{constructor(e,i,d){this.query=e,this.targetId=i,this.view=d}}class hle{constructor(e){this.key=e,this.na=!1}}class Cie{constructor(e,i,d,_,B,_t){this.localStore=e,this.remoteStore=i,this.eventManager=d,this.sharedClientState=_,this.currentUser=B,this.maxConcurrentLimboResolutions=_t,this.sa={},this.ia=new J8(_a=>kK(_a),NK),this.ra=new Map,this.oa=new Set,this.ua=new fR(fI.comparator),this.aa=new Map,this.ca=new Yue,this.ha={},this.la=new Map,this.fa=W4.yn(),this.onlineState="Unknown",this.da=void 0}get isPrimaryClient(){return!0===this.da}}function z4(o,e){return wie.apply(this,arguments)}function wie(){return wie=(0,C0.Z)(function*(o,e){const i=Rle(o);let d,_;const B=i.ia.get(e);if(B)d=B.targetId,i.sharedClientState.addLocalQueryTarget(d),_=B.view.ea();else{const _t=yield zQ(i.localStore,UM(e));i.isPrimaryClient&&d2(i.remoteStore,_t);const _a=i.sharedClientState.addLocalQueryTarget(_t.targetId);d=_t.targetId,_=yield Tie(i,e,d,"current"===_a)}return _}),wie.apply(this,arguments)}function Tie(o,e,i,d){return fle.apply(this,arguments)}function fle(){return fle=(0,C0.Z)(function*(o,e,i,d){o._a=(l_,f_,R_)=>{return(H_=(0,C0.Z)(function*(W_,R0,H0,CI){let LI=R0.view.Wu(H0);LI.ii&&(LI=yield CO(W_.localStore,R0.query,!1).then(({documents:_C})=>R0.view.Wu(_C,LI)));const xI=CI&&CI.targetChanges.get(R0.targetId),DI=R0.view.applyChanges(LI,W_.isPrimaryClient,xI);return Die(W_,R0.targetId,DI.Xu),DI.snapshot}),function(W_,R0,H0,CI){return H_.apply(this,arguments)})(o,l_,f_,R_);var H_};const _=yield CO(o.localStore,e,!0),B=new Iie(e,_._i),_t=B.Wu(_.documents),_a=MK.createSynthesizedTargetChangeForCurrentChange(i,d&&"Offline"!==o.onlineState),_h=B.applyChanges(_t,o.isPrimaryClient,_a);Die(o,i,_h.Xu);const _g=new bie(e,i,B);return o.ia.set(e,_g),o.ra.has(i)?o.ra.get(i).push(e):o.ra.set(i,[e]),_h.snapshot}),fle.apply(this,arguments)}function qve(o,e){return ple.apply(this,arguments)}function ple(){return ple=(0,C0.Z)(function*(o,e){const i=pI(o),d=i.ia.get(e),_=i.ra.get(d.targetId);if(_.length>1)return i.ra.set(d.targetId,_.filter(B=>!NK(B,e))),void i.ia.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(d.targetId),i.sharedClientState.isActiveQueryTarget(d.targetId)||(yield YQ(i.localStore,d.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(d.targetId),jS(i.remoteStore,d.targetId),ZK(i,d.targetId)}).catch(zO))):(ZK(i,d.targetId),yield YQ(i.localStore,d.targetId,!0))}),ple.apply(this,arguments)}function Sie(){return Sie=(0,C0.Z)(function*(o,e,i){const d=Lie(o);try{const _=yield function(B,_t){const _a=pI(B),_h=XS.now(),_g=_t.reduce((f_,R_)=>f_.add(R_.key),CT());let l_;return _a.persistence.runTransaction("Locally write mutations","readwrite",f_=>_a.fi.Ks(f_,_g).next(R_=>{l_=R_;const H_=[];for(const W_ of _t){const R0=Tpe(W_,l_.get(W_.key));null!=R0&&H_.push(new GQ(W_.key,R0,gpe(R0.value.mapValue),xR.exists(!0)))}return _a.Bs.addMutationBatch(f_,_h,H_,_t)})).then(f_=>(f_.applyToLocalDocumentSet(l_),{batchId:f_.batchId,changes:l_}))}(d.localStore,e);d.sharedClientState.addPendingMutation(_.batchId),function(B,_t,_a){let _h=B.ha[B.currentUser.toKey()];_h||(_h=new fR(R1)),_h=_h.insert(_t,_a),B.ha[B.currentUser.toKey()]=_h}(d,_.batchId,i),yield Q6(d,_.changes),yield rG(d.remoteStore)}catch(_){const B=i9(_,"Failed to persist write");i.reject(B)}}),Sie.apply(this,arguments)}function Rie(o,e){return mle.apply(this,arguments)}function mle(){return mle=(0,C0.Z)(function*(o,e){const i=pI(o);try{const d=yield cge(i.localStore,e);e.targetChanges.forEach((_,B)=>{const _t=i.aa.get(B);_t&&(QI(_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size<=1),_.addedDocuments.size>0?_t.na=!0:_.modifiedDocuments.size>0?QI(_t.na):_.removedDocuments.size>0&&(QI(_t.na),_t.na=!1))}),yield Q6(i,d,e)}catch(d){yield zO(d)}}),mle.apply(this,arguments)}function Nge(o,e,i){const d=pI(o);if(d.isPrimaryClient&&0===i||!d.isPrimaryClient&&1===i){const _=[];d.ia.forEach((B,_t)=>{const _a=_t.view.Pu(e);_a.snapshot&&_.push(_a.snapshot)}),function(B,_t){const _a=pI(B);_a.onlineState=_t;let _h=!1;_a.queries.forEach((_g,l_)=>{for(const f_ of l_.listeners)f_.Pu(_t)&&(_h=!0)}),_h&&K4(_a)}(d.eventManager,e),_.length&&d.sa.zo(_),d.onlineState=e,d.isPrimaryClient&&d.sharedClientState.setOnlineState(e)}}function Wve(o,e,i){return Ale.apply(this,arguments)}function Ale(){return Ale=(0,C0.Z)(function*(o,e,i){const d=pI(o);d.sharedClientState.updateQueryState(e,"rejected",i);const _=d.aa.get(e),B=_&&_.key;if(B){let _t=new fR(fI.comparator);_t=_t.insert(B,mS.newNoDocument(B,a1.min()));const _a=CT().add(B),_h=new zZ(a1.min(),new Map,new hT(R1),_t,_a);yield Rie(d,_h),d.ua=d.ua.remove(B),d.aa.delete(e),KL(d)}else yield YQ(d.localStore,e,!1).then(()=>ZK(d,e,i)).catch(zO)}),Ale.apply(this,arguments)}function kge(o,e){return uP.apply(this,arguments)}function uP(){return uP=(0,C0.Z)(function*(o,e){const i=pI(o),d=e.batch.batchId;try{const _=yield KQ(i.localStore,e);yle(i,d,null),sG(i,d),i.sharedClientState.updateMutationState(d,"acknowledged"),yield Q6(i,_)}catch(_){yield zO(_)}}),uP.apply(this,arguments)}function Kve(o,e,i){return Oie.apply(this,arguments)}function Oie(){return Oie=(0,C0.Z)(function*(o,e,i){const d=pI(o);try{const _=yield function(B,_t){const _a=pI(B);return _a.persistence.runTransaction("Reject batch","readwrite-primary",_h=>{let _g;return _a.Bs.lookupMutationBatch(_h,_t).next(l_=>(QI(null!==l_),_g=l_.keys(),_a.Bs.removeMutationBatch(_h,l_))).next(()=>_a.Bs.performConsistencyCheck(_h)).next(()=>_a.fi.Ks(_h,_g))})}(d.localStore,e);yle(d,e,i),sG(d,e),d.sharedClientState.updateMutationState(e,"rejected",i),yield Q6(d,_)}catch(_){yield zO(_)}}),Oie.apply(this,arguments)}function vle(){return vle=(0,C0.Z)(function*(o,e){const i=pI(o);G6(i.remoteStore)||nI("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const d=yield function(B){const _t=pI(B);return _t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",_a=>_t.Bs.getHighestUnacknowledgedBatchId(_a))}(i.localStore);if(-1===d)return void e.resolve();const _=i.la.get(d)||[];_.push(e),i.la.set(d,_)}catch(d){const _=i9(d,"Initialization of waitForPendingWrites() operation failed");e.reject(_)}}),vle.apply(this,arguments)}function sG(o,e){(o.la.get(e)||[]).forEach(i=>{i.resolve()}),o.la.delete(e)}function yle(o,e,i){const d=pI(o);let _=d.ha[d.currentUser.toKey()];if(_){const B=_.get(e);B&&(i?B.reject(i):B.resolve(),_=_.remove(e)),d.ha[d.currentUser.toKey()]=_}}function ZK(o,e,i=null){o.sharedClientState.removeLocalQueryTarget(e);for(const d of o.ra.get(e))o.ia.delete(d),i&&o.sa.wa(d,i);o.ra.delete(e),o.isPrimaryClient&&o.ca.vi(e).forEach(d=>{o.ca.containsKey(d)||mX(o,d)})}function mX(o,e){o.oa.delete(e.path.canonicalString());const i=o.ua.get(e);null!==i&&(jS(o.remoteStore,i),o.ua=o.ua.remove(e),o.aa.delete(i),KL(o))}function Die(o,e,i){for(const d of i)d instanceof Oge?(o.ca.addReference(d.key,e),Pge(o,d)):d instanceof Dge?(nI("SyncEngine","Document no longer in limbo: "+d.key),o.ca.removeReference(d.key,e),o.ca.containsKey(d.key)||mX(o,d.key)):PI()}function Pge(o,e){const i=e.key,d=i.path.canonicalString();o.ua.get(i)||o.oa.has(d)||(nI("SyncEngine","New document in limbo: "+i),o.oa.add(d),KL(o))}function KL(o){for(;o.oa.size>0&&o.ua.size<o.maxConcurrentLimboResolutions;){const e=o.oa.values().next().value;o.oa.delete(e);const i=new fI(eT.fromString(e)),d=o.fa.next();o.aa.set(d,new hle(i)),o.ua=o.ua.insert(i,d),d2(o.remoteStore,new $P(UM(DK(i.path)),d,2,GL.A))}}function Q6(o,e,i){return Nie.apply(this,arguments)}function Nie(){return Nie=(0,C0.Z)(function*(o,e,i){const d=pI(o),_=[],B=[],_t=[];var _a;d.ia.isEmpty()||(d.ia.forEach((_a,_h)=>{_t.push(d._a(_h,e,i).then(_g=>{if(_g){d.isPrimaryClient&&d.sharedClientState.updateQueryState(_h.targetId,_g.fromCache?"not-current":"current"),_.push(_g);const l_=FS.Ys(_h.targetId,_g);B.push(l_)}}))}),yield Promise.all(_t),d.sa.zo(_),yield(_a=(0,C0.Z)(function*(_h,_g){const l_=pI(_h);try{yield l_.persistence.runTransaction("notifyLocalViewChanges","readwrite",f_=>x0.forEach(_g,R_=>x0.forEach(R_.Hs,H_=>l_.persistence.referenceDelegate.addReference(f_,R_.targetId,H_)).next(()=>x0.forEach(R_.Js,H_=>l_.persistence.referenceDelegate.removeReference(f_,R_.targetId,H_)))))}catch(f_){if(!U6(f_))throw f_;nI("LocalStore","Failed to update sequence numbers: "+f_)}for(const f_ of _g){const R_=f_.targetId;if(!f_.fromCache){const H_=l_.ui.get(R_),R0=H_.withLastLimboFreeSnapshotVersion(H_.snapshotVersion);l_.ui=l_.ui.insert(R_,R0)}}}),function(_h,_g){return _a.apply(this,arguments)})(d.localStore,B))}),Nie.apply(this,arguments)}function kie(o,e){return o9.apply(this,arguments)}function o9(){return o9=(0,C0.Z)(function*(o,e){const i=pI(o);if(!i.currentUser.isEqual(e)){nI("SyncEngine","User change. New user:",e.toKey());const d=yield Hue(i.localStore,e);i.currentUser=e,(_=i).la.forEach(_t=>{_t.forEach(_a=>{_a.reject(new W0(T0.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),_.la.clear(),i.sharedClientState.handleUserChange(e,d.removedBatchIds,d.addedBatchIds),yield Q6(i,d.di)}var _}),o9.apply(this,arguments)}function Ele(o,e){const i=pI(o),d=i.aa.get(e);if(d&&d.na)return CT().add(d.key);{let _=CT();const B=i.ra.get(e);if(!B)return _;for(const _t of B){const _a=i.ia.get(_t);_=_.unionWith(_a.view.ju)}return _}}function xge(o,e){return Ile.apply(this,arguments)}function Ile(){return Ile=(0,C0.Z)(function*(o,e){const i=pI(o),d=yield CO(i.localStore,e.query,!0),_=e.view.ta(d);return i.isPrimaryClient&&Die(i,e.targetId,_.Xu),_}),Ile.apply(this,arguments)}function zve(o,e){return Pie.apply(this,arguments)}function Pie(){return Pie=(0,C0.Z)(function*(o,e){const i=pI(o);return zue(i.localStore,e).then(d=>Q6(i,d))}),Pie.apply(this,arguments)}function Yve(o,e,i,d){return ble.apply(this,arguments)}function ble(){return ble=(0,C0.Z)(function*(o,e,i,d){const _=pI(o),B=yield function(_t,_a){const _h=pI(_t),_g=pI(_h.Bs);return _h.persistence.runTransaction("Lookup mutation documents","readonly",l_=>_g.fn(l_,_a).next(f_=>f_?_h.fi.Ks(l_,f_):x0.resolve(null)))}(_.localStore,e);var _a;null!==B?("pending"===i?yield rG(_.remoteStore):"acknowledged"===i||"rejected"===i?(yle(_,e,d||null),sG(_,e),_a=e,pI(pI(_.localStore).Bs)._n(_a)):PI(),yield Q6(_,B)):nI("SyncEngine","Cannot apply mutation batch with id: "+e)}),ble.apply(this,arguments)}function H6(){return H6=(0,C0.Z)(function*(o,e){const i=pI(o);if(Rle(i),Lie(i),!0===e&&!0!==i.da){const d=i.sharedClientState.getAllActiveQueryTargets(),_=yield xie(i,d.toArray());i.da=!0,yield ale(i.remoteStore,!0);for(const B of _)d2(i.remoteStore,B)}else if(!1===e&&!1!==i.da){const d=[];let _=Promise.resolve();i.ra.forEach((B,_t)=>{i.sharedClientState.isLocalQueryTarget(_t)?d.push(_t):_=_.then(()=>(ZK(i,_t),YQ(i.localStore,_t,!0))),jS(i.remoteStore,_t)}),yield _,yield xie(i,d),function(B){const _t=pI(B);_t.aa.forEach((_a,_h)=>{jS(_t.remoteStore,_h)}),_t.ca.Si(),_t.aa=new Map,_t.ua=new fR(fI.comparator)}(i),i.da=!1,yield ale(i.remoteStore,!1)}}),H6.apply(this,arguments)}function xie(o,e,i){return Cle.apply(this,arguments)}function Cle(){return Cle=(0,C0.Z)(function*(o,e,i){const d=pI(o),_=[],B=[];for(const _t of e){let _a;const _h=d.ra.get(_t);if(_h&&0!==_h.length){_a=yield zQ(d.localStore,UM(_h[0]));for(const _g of _h){const l_=d.ia.get(_g),f_=yield xge(d,l_);f_.snapshot&&B.push(f_.snapshot)}}else{const _g=yield Kue(d.localStore,_t);_a=yield zQ(d.localStore,_g),yield Tie(d,wle(_g),_t,!1)}_.push(_a)}return d.sa.zo(B),_}),Cle.apply(this,arguments)}function wle(o){return vpe(o.path,o.collectionGroup,o.orderBy,o.filters,o.limit,"F",o.startAt,o.endAt)}function Mge(o){const e=pI(o);return pI(pI(e.localStore).persistence).Fs()}function Jve(o,e,i,d){return Tle.apply(this,arguments)}function Tle(){return Tle=(0,C0.Z)(function*(o,e,i,d){const _=pI(o);if(_.da)return void nI("SyncEngine","Ignoring unexpected query state notification.");const B=_.ra.get(e);if(B&&B.length>0)switch(i){case"current":case"not-current":{const _t=yield zue(_.localStore,VZ(B[0])),_a=zZ.createSynthesizedRemoteEventForCurrentChange(e,"current"===i);yield Q6(_,_t,_a);break}case"rejected":yield YQ(_.localStore,e,!0),ZK(_,e,d);break;default:PI()}}),Tle.apply(this,arguments)}function Bge(o,e,i){return Sle.apply(this,arguments)}function Sle(){return Sle=(0,C0.Z)(function*(o,e,i){const d=Rle(o);if(d.da){for(const _ of e){if(d.ra.has(_)){nI("SyncEngine","Adding an already active target "+_);continue}const B=yield Kue(d.localStore,_),_t=yield zQ(d.localStore,B);yield Tie(d,wle(B),_t.targetId,!1),d2(d.remoteStore,_t)}for(const _ of i)d.ra.has(_)&&(yield YQ(d.localStore,_,!1).then(()=>{jS(d.remoteStore,_),ZK(d,_)}).catch(zO))}}),Sle.apply(this,arguments)}function Rle(o){const e=pI(o);return e.remoteStore.remoteSyncer.applyRemoteEvent=Rie.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ele.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Wve.bind(null,e),e.sa.zo=Cge.bind(null,e.eventManager),e.sa.wa=wge.bind(null,e.eventManager),e}function Lie(o){const e=pI(o);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kge.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Kve.bind(null,e),e}class Uge{constructor(){this.synchronizeTabs=!1}initialize(e){var i=this;return(0,C0.Z)(function*(){i.M=fX(e.databaseInfo.databaseId),i.sharedClientState=i.ga(e),i.persistence=i.ya(e),yield i.persistence.start(),i.gcScheduler=i.pa(e),i.localStore=i.Ia(e)})()}pa(e){return null}Ia(e){return Que(this.persistence,new Gue,e.initialUser,this.M)}ya(e){return new dge(die.Yi,this.M)}ga(e){return new fge}terminate(){var e=this;return(0,C0.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class Fge extends Uge{constructor(e,i,d){super(),this.Ta=e,this.cacheSizeBytes=i,this.forceOwnership=d,this.synchronizeTabs=!1}initialize(e){var i=()=>super.initialize,d=this;return(0,C0.Z)(function*(){yield i().call(d,e),yield d.Ta.initialize(d,e),yield Lie(d.Ta.syncEngine),yield rG(d.Ta.remoteStore),yield d.persistence.Ts(()=>(d.gcScheduler&&!d.gcScheduler.started&&d.gcScheduler.start(d.localStore),Promise.resolve()))})()}Ia(e){return Que(this.persistence,new Gue,e.initialUser,this.M)}pa(e){return new iie(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue)}ya(e){const i=aie(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),d=void 0!==this.cacheSizeBytes?oP.withCacheSize(this.cacheSizeBytes):oP.DEFAULT;return new sie(this.synchronizeTabs,i,e.clientId,d,e.asyncQueue,XQ(),pR(),this.M,this.sharedClientState,!!this.forceOwnership)}ga(e){return new fge}}class jge extends Fge{constructor(e,i){super(e,i,!1),this.Ta=e,this.cacheSizeBytes=i,this.synchronizeTabs=!0}initialize(e){var i=()=>super.initialize,d=this;return(0,C0.Z)(function*(){yield i().call(d,e);const _=d.Ta.syncEngine;d.sharedClientState instanceof hX&&(d.sharedClientState.syncEngine={$r:Yve.bind(null,_),Br:Jve.bind(null,_),Lr:Bge.bind(null,_),Fs:Mge.bind(null,_),Fr:zve.bind(null,_)},yield d.sharedClientState.start()),yield d.persistence.Ts(function(){var B=(0,C0.Z)(function*(_t){yield function Lge(o,e){return H6.apply(this,arguments)}(d.Ta.syncEngine,_t),d.gcScheduler&&(_t&&!d.gcScheduler.started?d.gcScheduler.start(d.localStore):_t||d.gcScheduler.stop())});return function(_t){return B.apply(this,arguments)}}())})()}ga(e){const i=XQ();if(!hX.vt(i))throw new W0(T0.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const d=aie(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new hX(i,e.asyncQueue,d,e.clientId,e.initialUser)}}class AX{initialize(e,i){var d=this;return(0,C0.Z)(function*(){d.localStore||(d.localStore=e.localStore,d.sharedClientState=e.sharedClientState,d.datastore=d.createDatastore(i),d.remoteStore=d.createRemoteStore(i),d.eventManager=d.createEventManager(i),d.syncEngine=d.createSyncEngine(i,!e.synchronizeTabs),d.sharedClientState.onlineStateHandler=_=>Nge(d.syncEngine,_,1),d.remoteStore.remoteSyncer.handleCredentialChange=kie.bind(null,d.syncEngine),yield ale(d.remoteStore,d.syncEngine.isPrimaryClient))})()}createEventManager(e){return new bge}createDatastore(e){const i=fX(e.databaseInfo.databaseId),d=new ZQ(e.databaseInfo);return new e9(e.authCredentials,e.appCheckCredentials,d,i)}createRemoteStore(e){return i=this.localStore,d=this.datastore,_=e.asyncQueue,B=_a=>Nge(this.syncEngine,_a,0),_t=pge.vt()?new pge:new Jue,new wT(i,d,_,B,_t);var i,d,_,B,_t}createSyncEngine(e,i){return function(d,_,B,_t,_a,_h,_g){const l_=new Cie(d,_,B,_t,_a,_h);return _g&&(l_.da=!0),l_}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,i)}terminate(){return(e=(0,C0.Z)(function*(i){const d=pI(i);nI("RemoteStore","RemoteStore shutting down."),d.wu.add(5),yield nG(d),d.gu.shutdown(),d.yu.set("Unknown")}),function(i){return e.apply(this,arguments)})(this.remoteStore);var e}}function Ole(o,e=10240){let i=0;return{read:()=>(0,C0.Z)(function*(){if(i<o.byteLength){const d={value:o.slice(i,i+e),done:!1};return i+=e,d}return{done:!0}})(),cancel:()=>(0,C0.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class s9{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ea(this.observer.next,e)}error(e){this.observer.error?this.Ea(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Aa(){this.muted=!0}Ea(e,i){this.muted||setTimeout(()=>{this.muted||e(i)},0)}}class _X{constructor(e,i){this.Ra=e,this.M=i,this.metadata=new sO,this.buffer=new Uint8Array,this.ba=new TextDecoder("utf-8"),this.Pa().then(d=>{d&&d.Mu()?this.metadata.resolve(d.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==d?void 0:d.payload)}`))},d=>this.metadata.reject(d))}close(){return this.Ra.cancel()}getMetadata(){var e=this;return(0,C0.Z)(function*(){return e.metadata.promise})()}ma(){var e=this;return(0,C0.Z)(function*(){return yield e.getMetadata(),e.Pa()})()}Pa(){var e=this;return(0,C0.Z)(function*(){const i=yield e.Va();if(null===i)return null;const d=e.ba.decode(i),_=Number(d);isNaN(_)&&e.va(`length string (${d}) is not valid number`);const B=yield e.Sa(_);return new Hve(JSON.parse(B),i.length+_)})()}Da(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}Va(){var e=this;return(0,C0.Z)(function*(){for(;e.Da()<0&&!(yield e.Ca()););if(0===e.buffer.length)return null;const i=e.Da();i<0&&e.va("Reached the end of bundle when a length string is expected.");const d=e.buffer.slice(0,i);return e.buffer=e.buffer.slice(i),d})()}Sa(e){var i=this;return(0,C0.Z)(function*(){for(;i.buffer.length<e;)(yield i.Ca())&&i.va("Reached the end of bundle when more is expected.");const d=i.ba.decode(i.buffer.slice(0,e));return i.buffer=i.buffer.slice(e),d})()}va(e){throw this.Ra.cancel(),new Error(`Invalid bundle format: ${e}`)}Ca(){var e=this;return(0,C0.Z)(function*(){const i=yield e.Ra.read();if(!i.done){const d=new Uint8Array(e.buffer.length+i.value.length);d.set(e.buffer),d.set(i.value,e.buffer.length),e.buffer=d}return i.done})()}}class Zve{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var i=this;return(0,C0.Z)(function*(){if(i.ensureCommitNotCalled(),i.mutations.length>0)throw new W0(T0.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const d=yield(_=(0,C0.Z)(function*(B,_t){const _a=pI(B),_h=FM(_a.M)+"/documents",_g={documents:_t.map(H_=>JZ(_a.M,H_))},l_=yield _a._o("BatchGetDocuments",_h,_g),f_=new Map;l_.forEach(H_=>{const W_=function uve(o,e){return"found"in e?function(i,d){QI(!!d.found);const _=G4(i,d.found.name),B=bO(d.found.updateTime),_t=new CN({mapValue:{fields:d.found.fields}});return mS.newFoundDocument(_,B,_t)}(o,e):"missing"in e?function(i,d){QI(!!d.missing),QI(!!d.readTime);const _=G4(i,d.missing),B=bO(d.readTime);return mS.newNoDocument(_,B)}(o,e):PI()}(_a.M,H_);f_.set(W_.key.toString(),W_)});const R_=[];return _t.forEach(H_=>{const W_=f_.get(H_.toString());QI(!!W_),R_.push(W_)}),R_}),function(B,_t){return _.apply(this,arguments)})(i.datastore,e);var _;return d.forEach(_=>i.recordVersion(_)),d})()}set(e,i){this.write(i.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,i){try{this.write(i.toMutation(e,this.preconditionForUpdate(e)))}catch(d){this.lastWriteError=d}this.writtenDocs.add(e.toString())}delete(e){this.write(new WZ(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,C0.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const i=e.readVersions;var d;e.mutations.forEach(d=>{i.delete(d.key.toString())}),i.forEach((d,_)=>{const B=fI.fromPath(_);e.mutations.push(new Wre(B,e.precondition(B)))}),yield(d=(0,C0.Z)(function*(_,B){const _t=pI(_),_a=FM(_t.M)+"/documents",_h={writes:B.map(_g=>$Z(_t.M,_g))};yield _t.co("Commit",_a,_h)}),function(_,B){return d.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let i;if(e.isFoundDocument())i=e.version;else{if(!e.isNoDocument())throw PI();i=a1.min()}const d=this.readVersions.get(e.key.toString());if(d){if(!i.isEqual(d))throw new W0(T0.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),i)}precondition(e){const i=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&i?xR.updateTime(i):xR.none()}preconditionForUpdate(e){const i=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&i){if(i.isEqual(a1.min()))throw new W0(T0.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return xR.updateTime(i)}return xR.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Xve{constructor(e,i,d,_,B){this.asyncQueue=e,this.datastore=i,this.options=d,this.updateFunction=_,this.deferred=B,this.xa=d.maxAttempts,this.No=new VT(this.asyncQueue,"transaction_retry")}run(){this.xa-=1,this.Na()}Na(){var e=this;this.No.Ro((0,C0.Z)(function*(){const i=new Zve(e.datastore),d=e.ka(i);d&&d.then(_=>{e.asyncQueue.enqueueAndForget(()=>i.commit().then(()=>{e.deferred.resolve(_)}).catch(B=>{e.Ma(B)}))}).catch(_=>{e.Ma(_)})}))}ka(e){try{const i=this.updateFunction(e);return!t3(i)&&i.catch&&i.then?i:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(i){return this.deferred.reject(i),null}}Ma(e){this.xa>0&&this.Oa(e)?(this.xa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Na(),Promise.resolve()))):this.deferred.reject(e)}Oa(e){if("FirebaseError"===e.name){const i=e.code;return"aborted"===i||"failed-precondition"===i||!Kre(i)}return!1}}class Vge{constructor(e,i,d,_){var B=this;this.authCredentials=e,this.appCheckCredentials=i,this.asyncQueue=d,this.databaseInfo=_,this.user=qO.UNAUTHENTICATED,this.clientId=PQ.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(d,function(){var _t=(0,C0.Z)(function*(_a){nI("FirestoreClient","Received user=",_a.uid),yield B.authCredentialListener(_a),B.user=_a});return function(_a){return _t.apply(this,arguments)}}()),this.appCheckCredentials.start(d,_t=>(nI("FirestoreClient","Received new app check token=",_t),this.appCheckCredentialListener(_t,this.user)))}getConfiguration(){var e=this;return(0,C0.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new W0(T0.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const i=new sO;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,C0.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),i.resolve()}catch(d){const _=i9(d,"Failed to shutdown persistence");i.reject(_)}})),i.promise}}function Mie(o,e){return XP.apply(this,arguments)}function XP(){return XP=(0,C0.Z)(function*(o,e){o.asyncQueue.verifyOperationInProgress(),nI("FirestoreClient","Initializing OfflineComponentProvider");const i=yield o.getConfiguration();yield e.initialize(i);let d=i.initialUser;o.setCredentialChangeListener(function(){var _=(0,C0.Z)(function*(B){d.isEqual(B)||(yield Hue(e.localStore,B),d=B)});return function(B){return _.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>o.terminate()),o.offlineComponents=e}),XP.apply(this,arguments)}function Gge(o,e){return Dle.apply(this,arguments)}function Dle(){return Dle=(0,C0.Z)(function*(o,e){o.asyncQueue.verifyOperationInProgress();const i=yield vX(o);nI("FirestoreClient","Initializing OnlineComponentProvider");const d=yield o.getConfiguration();yield e.initialize(i,d),o.setCredentialChangeListener(_=>Ege(e.remoteStore,_)),o.setAppCheckTokenChangeListener((_,B)=>Ege(e.remoteStore,B)),o.onlineComponents=e}),Dle.apply(this,arguments)}function vX(o){return Nle.apply(this,arguments)}function Nle(){return Nle=(0,C0.Z)(function*(o){return o.offlineComponents||(nI("FirestoreClient","Using default OfflineComponentProvider"),yield Mie(o,new Uge)),o.offlineComponents}),Nle.apply(this,arguments)}function XK(o){return Bie.apply(this,arguments)}function Bie(){return Bie=(0,C0.Z)(function*(o){return o.onlineComponents||(nI("FirestoreClient","Using default OnlineComponentProvider"),yield Gge(o,new AX)),o.onlineComponents}),Bie.apply(this,arguments)}function zL(o){return vX(o).then(e=>e.persistence)}function kle(o){return vX(o).then(e=>e.localStore)}function yX(o){return XK(o).then(e=>e.remoteStore)}function Ple(o){return XK(o).then(e=>e.syncEngine)}function cG(o){return EX.apply(this,arguments)}function EX(){return EX=(0,C0.Z)(function*(o){const e=yield XK(o),i=e.eventManager;return i.onListen=z4.bind(null,e.syncEngine),i.onUnlisten=qve.bind(null,e.syncEngine),i}),EX.apply(this,arguments)}function Qge(o,e,i={}){const d=new sO;return o.asyncQueue.enqueueAndForget((0,C0.Z)(function*(){return function(_,B,_t,_a,_h){const _g=new s9({next:f_=>{B.enqueueAndForget(()=>oG(_,l_));const R_=f_.docs.has(_t);!R_&&f_.fromCache?_h.reject(new W0(T0.UNAVAILABLE,"Failed to get document because the client is offline.")):R_&&f_.fromCache&&_a&&"server"===_a.source?_h.reject(new W0(T0.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):_h.resolve(f_)},error:f_=>_h.reject(f_)}),l_=new dle(DK(_t.path),_g,{includeMetadataChanges:!0,ku:!0});return Eie(_,l_)}(yield cG(o),o.asyncQueue,e,i,d)})),d.promise}function Hge(o,e,i={}){const d=new sO;return o.asyncQueue.enqueueAndForget((0,C0.Z)(function*(){return function(_,B,_t,_a,_h){const _g=new s9({next:f_=>{B.enqueueAndForget(()=>oG(_,l_)),f_.fromCache&&"server"===_a.source?_h.reject(new W0(T0.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):_h.resolve(f_)},error:f_=>_h.reject(f_)}),l_=new dle(_t,_g,{includeMetadataChanges:!0,ku:!0});return Eie(_,l_)}(yield cG(o),o.asyncQueue,e,i,d)})),d.promise}const Kge=new Map;function xle(o,e,i){if(!i)throw new W0(T0.INVALID_ARGUMENT,`Function ${o}() cannot be called with an empty ${e}.`)}function eY(o,e,i,d){if(!0===e&&!0===d)throw new W0(T0.INVALID_ARGUMENT,`${o} and ${i} cannot be used together.`)}function Fie(o){if(!fI.isDocumentKey(o))throw new W0(T0.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${o} has ${o.length}.`)}function IX(o){if(fI.isDocumentKey(o))throw new W0(T0.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${o} has ${o.length}.`)}function jie(o){if(void 0===o)return"undefined";if(null===o)return"null";if("string"==typeof o)return o.length>20&&(o=`${o.substring(0,20)}...`),JSON.stringify(o);if("number"==typeof o||"boolean"==typeof o)return""+o;if("object"==typeof o){if(o instanceof Array)return"an array";{const e=(i=o).constructor?i.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var i;return"function"==typeof o?"a function":PI()}function tT(o,e){if("_delegate"in o&&(o=o._delegate),!(o instanceof e)){if(e.name===o.constructor.name)throw new W0(T0.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const i=jie(o);throw new W0(T0.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${i}`)}}return o}function YL(o,e){if(e<=0)throw new W0(T0.INVALID_ARGUMENT,`Function ${o}() requires a positive number, but it was: ${e}.`)}class GM{constructor(e){var i;if(void 0===e.host){if(void 0!==e.ssl)throw new W0(T0.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(i=e.ssl)||void 0===i||i;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new W0(T0.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,eY("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class W6{constructor(e,i,d){this._authCredentials=i,this._appCheckCredentials=d,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new GM({}),this._settingsFrozen=!1,e instanceof N6?this._databaseId=e:(this._app=e,this._databaseId=function(_){if(!Object.prototype.hasOwnProperty.apply(_.options,["projectId"]))throw new W0(T0.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new N6(_.options.projectId)}(e))}get app(){if(!this._app)throw new W0(T0.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new W0(T0.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new GM(e),void 0!==e.credentials&&(this._authCredentials=function(i){if(!i)return new ope;switch(i.type){case"gapi":const d=i.client;return QI(!("object"!=typeof d||null===d||!d.auth||!d.auth.getAuthHeaderValueForFirstParty)),new V_e(d,i.sessionIndex||"0",i.iamToken||null);case"provider":return i.client;default:throw new W0(T0.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const i=Kge.get(e);i&&(nI("ComponentProvider","Removing Datastore"),Kge.delete(e),i.terminate())}(this),Promise.resolve()}}class vS{constructor(e,i,d){this.converter=i,this._key=d,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new a3(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vS(this.firestore,e,this._key)}}class MR{constructor(e,i,d){this.converter=i,this._query=d,this.type="query",this.firestore=e}withConverter(e){return new MR(this.firestore,e,this._query)}}class a3 extends MR{constructor(e,i,d){super(e,i,DK(d)),this._path=d,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vS(this.firestore,null,new fI(e))}withConverter(e){return new a3(this.firestore,e,this._path)}}function zge(o,e,...i){if(o=(0,M_.m9)(o),xle("collection","path",e),o instanceof W6){const d=eT.fromString(e,...i);return IX(d),new a3(o,null,d)}{if(!(o instanceof vS||o instanceof a3))throw new W0(T0.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const d=o._path.child(eT.fromString(e,...i));return IX(d),new a3(o.firestore,null,d)}}function uG(o,e,...i){if(o=(0,M_.m9)(o),1===arguments.length&&(e=PQ.R()),xle("doc","path",e),o instanceof W6){const d=eT.fromString(e,...i);return Fie(d),new vS(o,null,new fI(d))}{if(!(o instanceof vS||o instanceof a3))throw new W0(T0.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const d=o._path.child(eT.fromString(e,...i));return Fie(d),new vS(o.firestore,o instanceof a3?o.converter:null,new fI(d))}}function bX(o,e){return o=(0,M_.m9)(o),e=(0,M_.m9)(e),(o instanceof vS||o instanceof a3)&&(e instanceof vS||e instanceof a3)&&o.firestore===e.firestore&&o.path===e.path&&o.converter===e.converter}function Yge(o,e){return o=(0,M_.m9)(o),e=(0,M_.m9)(e),o instanceof MR&&e instanceof MR&&o.firestore===e.firestore&&NK(o._query,e._query)&&o.converter===e.converter}class Lle{constructor(){this.Fa=Promise.resolve(),this.$a=[],this.Ba=!1,this.La=[],this.Ua=null,this.qa=!1,this.Ka=!1,this.Ga=[],this.No=new VT(this,"async_queue_retry"),this.Qa=()=>{const i=pR();i&&nI("AsyncQueue","Visibility state changed to "+i.visibilityState),this.No.Po()};const e=pR();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Qa)}get isShuttingDown(){return this.Ba}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ja(),this.Wa(e)}enterRestrictedMode(e){if(!this.Ba){this.Ba=!0,this.Ka=e||!1;const i=pR();i&&"function"==typeof i.removeEventListener&&i.removeEventListener("visibilitychange",this.Qa)}}enqueue(e){if(this.ja(),this.Ba)return new Promise(()=>{});const i=new sO;return this.Wa(()=>this.Ba&&this.Ka?Promise.resolve():(e().then(i.resolve,i.reject),i.promise)).then(()=>i.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.$a.push(e),this.za()))}za(){var e=this;return(0,C0.Z)(function*(){if(0!==e.$a.length){try{yield e.$a[0](),e.$a.shift(),e.No.reset()}catch(i){if(!U6(i))throw i;nI("AsyncQueue","Operation failed with retryable error: "+i)}e.$a.length>0&&e.No.Ro(()=>e.za())}})()}Wa(e){const i=this.Fa.then(()=>(this.qa=!0,e().catch(d=>{throw this.Ua=d,this.qa=!1,kR("INTERNAL UNHANDLED ERROR: ",function(B){let _t=B.message||"";return B.stack&&(_t=B.stack.includes(B.message)?B.stack:B.message+"\n"+B.stack),_t}(d)),d}).then(d=>(this.qa=!1,d))));return this.Fa=i,i}enqueueAfterDelay(e,i,d){this.ja(),this.Ga.indexOf(e)>-1&&(i=0);const _=ule.createAndSchedule(this,e,i,d,B=>this.Ha(B));return this.La.push(_),_}ja(){this.Ua&&PI()}verifyOperationInProgress(){}Ja(){var e=this;return(0,C0.Z)(function*(){let i;do{i=e.Fa,yield i}while(i!==e.Fa)})()}Ya(e){for(const i of this.La)if(i.timerId===e)return!0;return!1}Xa(e){return this.Ja().then(()=>{this.La.sort((i,d)=>i.targetTimeMs-d.targetTimeMs);for(const i of this.La)if(i.skipDelay(),"all"!==e&&i.timerId===e)break;return this.Ja()})}Za(e){this.Ga.push(e)}Ha(e){const i=this.La.indexOf(e);this.La.splice(i,1)}}function K6(o){return function(e,i){if("object"!=typeof e||null===e)return!1;const d=e;for(const _ of["next","error","complete"])if(_ in d&&"function"==typeof d[_])return!0;return!1}(o)}class Jge{constructor(){this._progressObserver={},this._taskCompletionResolver=new sO,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,i,d){this._progressObserver={next:e,error:i,complete:d}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,i){return this._taskCompletionResolver.promise.then(e,i)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class VS extends W6{constructor(e,i,d){super(e,i,d),this.type="firestore",this._queue=new Lle,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Xge(this),this._firestoreClient.terminate()}}function uO(o){return o._firestoreClient||Xge(o),o._firestoreClient.verifyNotTerminated(),o._firestoreClient}function Xge(o){var e;const i=o._freezeSettings(),d=(B=(null===(e=o._app)||void 0===e?void 0:e.options.appId)||"",new G_e(o._databaseId,B,o._persistenceKey,(_a=i).host,_a.ssl,_a.experimentalForceLongPolling,_a.experimentalAutoDetectLongPolling,_a.useFetchStreams));var B,_a;o._firestoreClient=new Vge(o._authCredentials,o._appCheckCredentials,o._queue,d)}function tme(o,e,i){const d=new sO;return o.asyncQueue.enqueue((0,C0.Z)(function*(){try{yield Mie(o,i),yield Gge(o,e),d.resolve()}catch(_){if(!("FirebaseError"===(B=_).name?B.code===T0.FAILED_PRECONDITION||B.code===T0.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&B instanceof DOMException)||22===B.code||20===B.code||11===B.code))throw _;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+_),d.reject(_)}var B})).then(()=>d.promise)}function z6(o){if(o._initialized||o._terminated)throw new W0(T0.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class QM{constructor(...e){for(let i=0;i<e.length;++i)if(0===e[i].length)throw new W0(T0.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new PR(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class c3{constructor(e){this._byteString=e}static fromBase64String(e){try{return new c3(aO.fromBase64String(e))}catch(i){throw new W0(T0.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+i)}}static fromUint8Array(e){return new c3(aO.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class a9{constructor(e){this._methodName=e}}class tY{constructor(e,i){if(!isFinite(e)||e<-90||e>90)throw new W0(T0.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(i)||i<-180||i>180)throw new W0(T0.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+i);this._lat=e,this._long=i}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return R1(this._lat,e._lat)||R1(this._long,e._long)}}const rme=/^__.*__$/;class Ble{constructor(e,i,d){this.data=e,this.fieldMask=i,this.fieldTransforms=d}toMutation(e,i){return null!==this.fieldMask?new GQ(e,this.data,this.fieldMask,i,this.fieldTransforms):new qZ(e,this.data,i,this.fieldTransforms)}}class Ule{constructor(e,i,d){this.data=e,this.fieldMask=i,this.fieldTransforms=d}toMutation(e,i){return new GQ(e,this.data,this.fieldMask,i,this.fieldTransforms)}}function Fle(o){switch(o){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw PI()}}class nY{constructor(e,i,d,_,B,_t){this.settings=e,this.databaseId=i,this.M=d,this.ignoreUndefinedProperties=_,void 0===B&&this.tc(),this.fieldTransforms=B||[],this.fieldMask=_t||[]}get path(){return this.settings.path}get ec(){return this.settings.ec}nc(e){return new nY(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.M,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}sc(e){var i;const d=null===(i=this.path)||void 0===i?void 0:i.child(e),_=this.nc({path:d,ic:!1});return _.rc(e),_}oc(e){var i;const d=null===(i=this.path)||void 0===i?void 0:i.child(e),_=this.nc({path:d,ic:!1});return _.tc(),_}uc(e){return this.nc({path:void 0,ic:!0})}ac(e){return RX(e,this.settings.methodName,this.settings.cc||!1,this.path,this.settings.hc)}contains(e){return void 0!==this.fieldMask.find(i=>e.isPrefixOf(i))||void 0!==this.fieldTransforms.find(i=>e.isPrefixOf(i.field))}tc(){if(this.path)for(let e=0;e<this.path.length;e++)this.rc(this.path.get(e))}rc(e){if(0===e.length)throw this.ac("Document fields must not be empty");if(Fle(this.ec)&&rme.test(e))throw this.ac('Document fields cannot begin and end with "__"')}}class ime{constructor(e,i,d){this.databaseId=e,this.ignoreUndefinedProperties=i,this.M=d||fX(e)}lc(e,i,d,_=!1){return new nY({ec:e,methodName:i,hc:d,path:PR.emptyPath(),ic:!1,cc:_},this.databaseId,this.M,this.ignoreUndefinedProperties)}}function lG(o){const e=o._freezeSettings(),i=fX(o._databaseId);return new ime(o._databaseId,!!e.ignoreUndefinedProperties,i)}function c9(o,e,i,d,_,B={}){const _t=o.lc(B.merge||B.mergeFields?2:0,e,i,_);SX("Data must be an object, but it was:",_t,d);const _a=pG(d,_t);let _h,_g;if(B.merge)_h=new K8(_t.fieldMask),_g=_t.fieldTransforms;else if(B.mergeFields){const l_=[];for(const f_ of B.mergeFields){const R_=gG(e,f_,i);if(!_t.contains(R_))throw new W0(T0.INVALID_ARGUMENT,`Field '${R_}' is specified in your field mask but missing from your input data.`);Gle(l_,R_)||l_.push(R_)}_h=new K8(l_),_g=_t.fieldTransforms.filter(f_=>_h.covers(f_.field))}else _h=null,_g=_t.fieldTransforms;return new Ble(new CN(_a),_h,_g)}class dG extends a9{_toFieldTransform(e){if(2!==e.ec)throw e.ac(1===e.ec?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof dG}}function Qie(o,e,i){return new nY({ec:3,hc:e.settings.hc,methodName:o._methodName,ic:i},e.databaseId,e.M,e.ignoreUndefinedProperties)}class wX extends a9{_toFieldTransform(e){return new HZ(e.path,new PK)}isEqual(e){return e instanceof wX}}class jle extends a9{constructor(e,i){super(e),this.fc=i}_toFieldTransform(e){const i=Qie(this,e,!0),d=this.fc.map(B=>fG(B,i)),_=new Y8(d);return new HZ(e.path,_)}isEqual(e){return this===e}}class Vle extends a9{constructor(e,i){super(e),this.fc=i}_toFieldTransform(e){const i=Qie(this,e,!0),d=this.fc.map(B=>fG(B,i)),_=new M6(d);return new HZ(e.path,_)}isEqual(e){return this===e}}class ome extends a9{constructor(e,i){super(e),this.dc=i}_toFieldTransform(e){const i=new xK(e.M,due(e.M,this.dc));return new HZ(e.path,i)}isEqual(e){return this===e}}function TX(o,e,i,d){const _=o.lc(1,e,i);SX("Data must be an object, but it was:",_,d);const B=[],_t=CN.empty();u2(d,(_h,_g)=>{const l_=lP(e,_h,i);_g=(0,M_.m9)(_g);const f_=_.oc(l_);if(_g instanceof dG)B.push(l_);else{const R_=fG(_g,f_);null!=R_&&(B.push(l_),_t.set(l_,R_))}});const _a=new K8(B);return new Ule(_t,_a,_.fieldTransforms)}function hG(o,e,i,d,_,B){const _t=o.lc(1,e,i),_a=[gG(e,d,i)],_h=[_];if(B.length%2!=0)throw new W0(T0.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let R_=0;R_<B.length;R_+=2)_a.push(gG(e,B[R_])),_h.push(B[R_+1]);const _g=[],l_=CN.empty();for(let R_=_a.length-1;R_>=0;--R_)if(!Gle(_g,_a[R_])){const H_=_a[R_];let W_=_h[R_];W_=(0,M_.m9)(W_);const R0=_t.oc(H_);if(W_ instanceof dG)_g.push(H_);else{const H0=fG(W_,R0);null!=H0&&(_g.push(H_),l_.set(H_,H0))}}const f_=new K8(_g);return new Ule(l_,f_,_t.fieldTransforms)}function u3(o,e,i,d=!1){return fG(i,o.lc(d?4:3,e))}function fG(o,e){if(Y4(o=(0,M_.m9)(o)))return SX("Unsupported field value:",e,o),pG(o,e);if(o instanceof a9)return function(i,d){if(!Fle(d.ec))throw d.ac(`${i._methodName}() can only be used with update() and set()`);if(!d.path)throw d.ac(`${i._methodName}() is not currently supported inside arrays`);const _=i._toFieldTransform(d);_&&d.fieldTransforms.push(_)}(o,e),null;if(void 0===o&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),o instanceof Array){if(e.settings.ic&&4!==e.ec)throw e.ac("Nested arrays are not supported");return function(i,d){const _=[];let B=0;for(const _t of i){let _a=fG(_t,d.uc(B));null==_a&&(_a={nullValue:"NULL_VALUE"}),_.push(_a),B++}return{arrayValue:{values:_}}}(o,e)}return function(i,d){if(null===(i=(0,M_.m9)(i)))return{nullValue:"NULL_VALUE"};if("number"==typeof i)return due(d.M,i);if("boolean"==typeof i)return{booleanValue:i};if("string"==typeof i)return{stringValue:i};if(i instanceof Date){const _=XS.fromDate(i);return{timestampValue:YZ(d.M,_)}}if(i instanceof XS){const _=new XS(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:YZ(d.M,_)}}if(i instanceof tY)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof c3)return{bytesValue:vue(d.M,i._byteString)};if(i instanceof vS){const _=d.databaseId,B=i.firestore._databaseId;if(!B.isEqual(_))throw d.ac(`Document reference is for database ${B.projectId}/${B.database} but should be for database ${_.projectId}/${_.database}`);return{referenceValue:yue(i.firestore._databaseId||d.databaseId,i._key.path)}}throw d.ac(`Unsupported field value: ${jie(i)}`)}(o,e)}function pG(o,e){const i={};return MM(o)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):u2(o,(d,_)=>{const B=fG(_,e.sc(d));null!=B&&(i[d]=B)}),{mapValue:{fields:i}}}function Y4(o){return!("object"!=typeof o||null===o||o instanceof Array||o instanceof Date||o instanceof XS||o instanceof tY||o instanceof c3||o instanceof vS||o instanceof a9)}function SX(o,e,i){if(!Y4(i)||"object"!=typeof(d=i)||null===d||Object.getPrototypeOf(d)!==Object.prototype&&null!==Object.getPrototypeOf(d)){const d=jie(i);throw e.ac("an object"===d?o+" a custom object":o+" "+d)}var d}function gG(o,e,i){if((e=(0,M_.m9)(e))instanceof QM)return e._internalPath;if("string"==typeof e)return lP(o,e);throw RX("Field path arguments must be of type string or ",o,!1,void 0,i)}const Hie=new RegExp("[~\\*/\\[\\]]");function lP(o,e,i){if(e.search(Hie)>=0)throw RX(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,o,!1,void 0,i);try{return new QM(...e.split("."))._internalPath}catch(d){throw RX(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,o,!1,void 0,i)}}function RX(o,e,i,d,_){const B=d&&!d.isEmpty(),_t=void 0!==_;let _a=`Function ${e}() called with invalid data`;i&&(_a+=" (via `toFirestore()`)"),_a+=". ";let _h="";return(B||_t)&&(_h+=" (found",B&&(_h+=` in field ${d}`),_t&&(_h+=` in document ${_}`),_h+=")"),new W0(T0.INVALID_ARGUMENT,_a+o+_h)}function Gle(o,e){return o.some(i=>i.isEqual(e))}class rY{constructor(e,i,d,_,B){this._firestore=e,this._userDataWriter=i,this._key=d,this._document=_,this._converter=B}get id(){return this._key.path.lastSegment()}get ref(){return new vS(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new cye(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const i=this._document.data.field(mG("DocumentSnapshot.get",e));if(null!==i)return this._userDataWriter.convertValue(i)}}}class cye extends rY{data(){return super.data()}}function mG(o,e){return"string"==typeof e?lP(o,e):e instanceof QM?e._internalPath:e._delegate._internalPath}class u9{constructor(e,i){this.hasPendingWrites=e,this.fromCache=i}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class l3 extends rY{constructor(e,i,d,_,B,_t){super(e,i,d,_,_t),this._firestore=e,this._firestoreImpl=e,this.metadata=B}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const i=new iY(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(i,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,i={}){if(this._document){const d=this._document.data.field(mG("DocumentSnapshot.get",e));if(null!==d)return this._userDataWriter.convertValue(d,i.serverTimestamps)}}}class iY extends l3{data(e={}){return super.data(e)}}class AG{constructor(e,i,d,_){this._firestore=e,this._userDataWriter=i,this._snapshot=_,this.metadata=new u9(_.hasPendingWrites,_.fromCache),this.query=d}get docs(){const e=[];return this.forEach(i=>e.push(i)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,i){this._snapshot.docs.forEach(d=>{e.call(i,new iY(this._firestore,this._userDataWriter,d.key,d,new u9(this._snapshot.mutatedKeys.has(d.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const i=!!e.includeMetadataChanges;if(i&&this._snapshot.excludesMetadataChanges)throw new W0(T0.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===i||(this._cachedChanges=function(d,_){if(d._snapshot.oldDocs.isEmpty()){let B=0;return d._snapshot.docChanges.map(_t=>({type:"added",doc:new iY(d._firestore,d._userDataWriter,_t.doc.key,_t.doc,new u9(d._snapshot.mutatedKeys.has(_t.doc.key),d._snapshot.fromCache),d.query.converter),oldIndex:-1,newIndex:B++}))}{let B=d._snapshot.oldDocs;return d._snapshot.docChanges.filter(_t=>_||3!==_t.type).map(_t=>{const _a=new iY(d._firestore,d._userDataWriter,_t.doc.key,_t.doc,new u9(d._snapshot.mutatedKeys.has(_t.doc.key),d._snapshot.fromCache),d.query.converter);let _h=-1,_g=-1;return 0!==_t.type&&(_h=B.indexOf(_t.doc.key),B=B.delete(_t.doc.key)),1!==_t.type&&(B=B.add(_t.doc),_g=B.indexOf(_t.doc.key)),{type:Qle(_t.type),doc:_a,oldIndex:_h,newIndex:_g}})}}(this,i),this._cachedChangesIncludeMetadataChanges=i),this._cachedChanges}}function Qle(o){switch(o){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return PI()}}function J4(o,e){return o instanceof l3&&e instanceof l3?o._firestore===e._firestore&&o._key.isEqual(e._key)&&(null===o._document?null===e._document:o._document.isEqual(e._document))&&o._converter===e._converter:o instanceof AG&&e instanceof AG&&o._firestore===e._firestore&&Yge(o.query,e.query)&&o.metadata.isEqual(e.metadata)&&o._snapshot.isEqual(e._snapshot)}function sme(o){if("L"===o.limitType&&0===o.explicitOrderBy.length)throw new W0(T0.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class l9{}function Y6(o,...e){for(const i of e)o=i._apply(o);return o}class uye extends l9{constructor(e,i,d){super(),this._c=e,this.wc=i,this.mc=d,this.type="where"}_apply(e){const i=lG(e.firestore),d=function(_,B,_t,_a,_h,_g,l_){let f_;if(_h.isKeyField()){if("array-contains"===_g||"array-contains-any"===_g)throw new W0(T0.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_g}' queries on documentId().`);if("in"===_g||"not-in"===_g){d9(l_,_g);const H_=[];for(const W_ of l_)H_.push(Wle(_a,_,W_));f_={arrayValue:{values:H_}}}else f_=Wle(_a,_,l_)}else"in"!==_g&&"not-in"!==_g&&"array-contains-any"!==_g||d9(l_,_g),f_=u3(_t,"where",l_,"in"===_g||"not-in"===_g);const R_=IO.create(_h,_g,f_);return function(H_,W_){if(W_.S()){const H0=sue(H_);if(null!==H0&&!H0.isEqual(W_.field))throw new W0(T0.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${H0.toString()}' and '${W_.field.toString()}'`);const CI=Vre(H_);null!==CI&&Kie(0,W_.field,CI)}const R0=function(H0,CI){for(const LI of H0.filters)if(CI.indexOf(LI.op)>=0)return LI.op;return null}(H_,function(H0){switch(H0){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(W_.op));if(null!==R0)throw new W0(T0.INVALID_ARGUMENT,R0===W_.op?`Invalid query. You cannot use more than one '${W_.op.toString()}' filter.`:`Invalid query. You cannot use '${W_.op.toString()}' filters with '${R0.toString()}' filters.`)}(_,R_),R_}(e._query,0,i,e.firestore._databaseId,this._c,this.wc,this.mc);return new MR(e.firestore,e.converter,function(_,B){const _t=_.filters.concat([B]);return new n3(_.path,_.collectionGroup,_.explicitOrderBy.slice(),_t,_.limit,_.limitType,_.startAt,_.endAt)}(e._query,d))}}class dye extends l9{constructor(e,i){super(),this._c=e,this.gc=i,this.type="orderBy"}_apply(e){const i=function(d,_,B){if(null!==d.startAt)throw new W0(T0.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==d.endAt)throw new W0(T0.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const _t=new VQ(_,B);return function(_a,_h){if(null===Vre(_a)){const _g=sue(_a);null!==_g&&Kie(0,_g,_h.field)}}(d,_t),_t}(e._query,this._c,this.gc);return new MR(e.firestore,e.converter,function(d,_){const B=d.explicitOrderBy.concat([_]);return new n3(d.path,d.collectionGroup,B,d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(e._query,i))}}class qie extends l9{constructor(e,i,d){super(),this.type=e,this.yc=i,this.Ic=d}_apply(e){return new MR(e.firestore,e.converter,cue(e._query,this.yc,this.Ic))}}class Hle extends l9{constructor(e,i,d){super(),this.type=e,this.Tc=i,this.Ec=d}_apply(e){const i=qle(e,this.type,this.Tc,this.Ec);return new MR(e.firestore,e.converter,(_=i,new n3((d=e._query).path,d.collectionGroup,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,_,d.endAt)));var d,_}}class cme extends l9{constructor(e,i,d){super(),this.type=e,this.Tc=i,this.Ec=d}_apply(e){const i=qle(e,this.type,this.Tc,this.Ec);return new MR(e.firestore,e.converter,(_=i,new n3((d=e._query).path,d.collectionGroup,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,_)));var d,_}}function qle(o,e,i,d){if(i[0]=(0,M_.m9)(i[0]),i[0]instanceof rY)return function(_,B,_t,_a,_h){if(!_a)throw new W0(T0.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${_t}().`);const _g=[];for(const l_ of L6(_))if(l_.field.isKeyField())_g.push(MQ(B,_a.key));else{const f_=_a.data.field(l_.field);if(Pre(f_))throw new W0(T0.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+l_.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===f_){const R_=l_.field.canonicalString();throw new W0(T0.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${R_}' (used as the orderBy) does not exist.`)}_g.push(f_)}return new x6(_g,_h)}(o._query,o.firestore._databaseId,e,i[0]._document,d);{const _=lG(o.firestore);return function(B,_t,_a,_h,_g,l_){const f_=B.explicitOrderBy;if(_g.length>f_.length)throw new W0(T0.INVALID_ARGUMENT,`Too many arguments provided to ${_h}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const R_=[];for(let H_=0;H_<_g.length;H_++){const W_=_g[H_];if(f_[H_].field.isKeyField()){if("string"!=typeof W_)throw new W0(T0.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${_h}(), but got a ${typeof W_}`);if(!aue(B)&&-1!==W_.indexOf("/"))throw new W0(T0.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${_h}() must be a plain document ID, but '${W_}' contains a slash.`);const R0=B.path.child(eT.fromString(W_));if(!fI.isDocumentKey(R0))throw new W0(T0.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${_h}() must result in a valid document path, but '${R0}' is not because it contains an odd number of segments.`);const H0=new fI(R0);R_.push(MQ(_t,H0))}else{const R0=u3(_a,_h,W_);R_.push(R0)}}return new x6(R_,l_)}(o._query,o.firestore._databaseId,_,e,i,d)}}function Wle(o,e,i){if("string"==typeof(i=(0,M_.m9)(i))){if(""===i)throw new W0(T0.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!aue(e)&&-1!==i.indexOf("/"))throw new W0(T0.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${i}' contains a '/' character.`);const d=e.path.child(eT.fromString(i));if(!fI.isDocumentKey(d))throw new W0(T0.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${d}' is not because it has an odd number of segments (${d.length}).`);return MQ(o,new fI(d))}if(i instanceof vS)return MQ(o,i._key);throw new W0(T0.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${jie(i)}.`)}function d9(o,e){if(!Array.isArray(o)||0===o.length)throw new W0(T0.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(o.length>10)throw new W0(T0.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function Kie(o,e,i){if(!i.isEqual(e))throw new W0(T0.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${i.toString()}' instead.`)}const mye={maxAttempts:5};class zie{convertValue(e,i="none"){switch(LQ(e)){case 0:return null;case 1:return e.booleanValue;case 2:return eR(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,i);case 5:return e.stringValue;case 6:return this.convertBytes(QL(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,i);case 10:return this.convertObject(e.mapValue,i);default:throw PI()}}convertObject(e,i){const d={};return u2(e.fields,(_,B)=>{d[_]=this.convertValue(B,i)}),d}convertGeoPoint(e){return new tY(eR(e.latitude),eR(e.longitude))}convertArray(e,i){return(e.values||[]).map(d=>this.convertValue(d,i))}convertServerTimestamp(e,i){switch(i){case"previous":const d=xre(e);return null==d?null:this.convertValue(d,i);case"estimate":return this.convertTimestamp(PZ(e));default:return null}}convertTimestamp(e){const i=j4(e);return new XS(i.seconds,i.nanos)}convertDocumentKey(e,i){const d=eT.fromString(e);QI(jpe(d));const _=new N6(d.get(1),d.get(3)),B=new fI(d.popFirst(5));return _.isEqual(i)||kR(`Document ${B} contains a document reference within a different database (${_.projectId}/${_.database}) which is not supported. It will be treated as a reference in the current database (${i.projectId}/${i.database}) instead.`),B}}function OX(o,e,i){let d;return d=o?i&&(i.merge||i.mergeFields)?o.toFirestore(e,i):o.toFirestore(e):e,d}class Kle extends zie{constructor(e){super(),this.firestore=e}convertBytes(e){return new c3(e)}convertReference(e){const i=this.convertDocumentKey(e,this.firestore._databaseId);return new vS(this.firestore,null,i)}}class lme{constructor(e,i){this._firestore=e,this._commitHandler=i,this._mutations=[],this._committed=!1,this._dataReader=lG(e)}set(e,i,d){this._verifyNotCommitted();const _=$4(e,this._firestore),B=OX(_.converter,i,d),_t=c9(this._dataReader,"WriteBatch.set",_._key,B,null!==_.converter,d);return this._mutations.push(_t.toMutation(_._key,xR.none())),this}update(e,i,d,..._){this._verifyNotCommitted();const B=$4(e,this._firestore);let _t;return _t="string"==typeof(i=(0,M_.m9)(i))||i instanceof QM?hG(this._dataReader,"WriteBatch.update",B._key,i,d,_):TX(this._dataReader,"WriteBatch.update",B._key,i),this._mutations.push(_t.toMutation(B._key,xR.exists(!0))),this}delete(e){this._verifyNotCommitted();const i=$4(e,this._firestore);return this._mutations=this._mutations.concat(new WZ(i._key,xR.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new W0(T0.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function $4(o,e){if((o=(0,M_.m9)(o)).firestore!==e)throw new W0(T0.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return o}class _G extends zie{constructor(e){super(),this.firestore=e}convertBytes(e){return new c3(e)}convertReference(e){const i=this.convertDocumentKey(e,this.firestore._databaseId);return new vS(this.firestore,null,i)}}function oY(o,e,i){o=tT(o,vS);const d=tT(o.firestore,VS),_=OX(o.converter,e,i);return d3(d,[c9(lG(d),"setDoc",o._key,_,null!==o.converter,i).toMutation(o._key,xR.none())])}function gme(o,e,i,...d){o=tT(o,vS);const _=tT(o.firestore,VS),B=lG(_);let _t;return _t="string"==typeof(e=(0,M_.m9)(e))||e instanceof QM?hG(B,"updateDoc",o._key,e,i,d):TX(B,"updateDoc",o._key,e),d3(_,[_t.toMutation(o._key,xR.exists(!0))])}function Yle(o,...e){var i,d,_;o=(0,M_.m9)(o);let B={includeMetadataChanges:!1},_t=0;"object"!=typeof e[_t]||K6(e[_t])||(B=e[_t],_t++);const _a={includeMetadataChanges:B.includeMetadataChanges};if(K6(e[_t])){const f_=e[_t];e[_t]=null===(i=f_.next)||void 0===i?void 0:i.bind(f_),e[_t+1]=null===(d=f_.error)||void 0===d?void 0:d.bind(f_),e[_t+2]=null===(_=f_.complete)||void 0===_?void 0:_.bind(f_)}let _h,_g,l_;if(o instanceof vS)_g=tT(o.firestore,VS),l_=DK(o._key.path),_h={next:f_=>{e[_t]&&e[_t](DX(_g,o,f_))},error:e[_t+1],complete:e[_t+2]};else{const f_=tT(o,MR);_g=tT(f_.firestore,VS),l_=f_._query;const R_=new _G(_g);_h={next:H_=>{e[_t]&&e[_t](new AG(_g,R_,f_,H_))},error:e[_t+1],complete:e[_t+2]},sme(o._query)}return function(f_,R_,H_,W_){const R0=new s9(W_),H0=new dle(R_,R0,H_);return f_.asyncQueue.enqueueAndForget((0,C0.Z)(function*(){return Eie(yield cG(f_),H0)})),()=>{R0.Aa(),f_.asyncQueue.enqueueAndForget((0,C0.Z)(function*(){return oG(yield cG(f_),H0)}))}}(uO(_g),l_,_a,_h)}function d3(o,e){return function(i,d){const _=new sO;return i.asyncQueue.enqueueAndForget((0,C0.Z)(function*(){return function gle(o,e,i){return Sie.apply(this,arguments)}(yield Ple(i),d,_)})),_.promise}(uO(o),e)}function DX(o,e,i){const d=i.docs.get(e._key),_=new _G(o);return new l3(o,_,e._key,d,new u9(i.hasPendingWrites,i.fromCache),e.converter)}class Jle extends class{constructor(e,i){this._firestore=e,this._transaction=i,this._dataReader=lG(e)}get(e){const i=$4(e,this._firestore),d=new Kle(this._firestore);return this._transaction.lookup([i._key]).then(_=>{if(!_||1!==_.length)return PI();const B=_[0];if(B.isFoundDocument())return new rY(this._firestore,d,B.key,B,i.converter);if(B.isNoDocument())return new rY(this._firestore,d,i._key,null,i.converter);throw PI()})}set(e,i,d){const _=$4(e,this._firestore),B=OX(_.converter,i,d),_t=c9(this._dataReader,"Transaction.set",_._key,B,null!==_.converter,d);return this._transaction.set(_._key,_t),this}update(e,i,d,..._){const B=$4(e,this._firestore);let _t;return _t="string"==typeof(i=(0,M_.m9)(i))||i instanceof QM?hG(this._dataReader,"Transaction.update",B._key,i,d,_):TX(this._dataReader,"Transaction.update",B._key,i),this._transaction.update(B._key,_t),this}delete(e){const i=$4(e,this._firestore);return this._transaction.delete(i._key),this}}{constructor(e,i){super(e,i),this._firestore=e}get(e){const i=$4(e,this._firestore),d=new _G(this._firestore);return super.get(e).then(_=>new l3(this._firestore,d,i._key,_._document,new u9(!1,!1),i.converter))}}function nde(o,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new W0("invalid-argument",`Invalid options passed to function ${o}(): You cannot specify both "merge" and "mergeFields".`);return e}function Zie(){if("undefined"==typeof Uint8Array)throw new W0("unimplemented","Uint8Arrays are not available in this environment.")}function _me(){if(!function O6(){return"undefined"!=typeof atob}())throw new W0("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(o,e=!0){NQ=uN.SDK_VERSION,(0,uN._registerComponent)(new bL.wA("firestore",(i,{options:d})=>{const _=i.getProvider("app").getImmediate(),B=new VS(_,new kQ(i.getProvider("auth-internal")),new $ce(i.getProvider("app-check-internal")));return d=Object.assign({useFetchStreams:e},d),B._setSettings(d),B},"PUBLIC")),(0,uN.registerVersion)(ipe,"3.4.9",o),(0,uN.registerVersion)(ipe,"3.4.9","esm2017")}();class h9{constructor(e){this._delegate=e}static fromBase64String(e){return _me(),new h9(c3.fromBase64String(e))}static fromUint8Array(e){return Zie(),new h9(c3.fromUint8Array(e))}toBase64(){return _me(),this._delegate.toBase64()}toUint8Array(){return Zie(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Xie(o){return function vme(o,e){if("object"!=typeof o||null===o)return!1;const i=o;for(const d of e)if(d in i&&"function"==typeof i[d])return!0;return!1}(o,["next","error","complete"])}class yme{enableIndexedDbPersistence(e,i){return function eme(o,e){z6(o=tT(o,VS));const i=uO(o),d=o._freezeSettings(),_=new AX;return tme(i,_,new Fge(_,d.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(e._delegate,{forceOwnership:i})}enableMultiTabIndexedDbPersistence(e){return function iye(o){z6(o=tT(o,VS));const e=uO(o),i=o._freezeSettings(),d=new AX;return tme(e,d,new jge(d,i.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function oye(o){if(o._initialized&&!o._terminated)throw new W0(T0.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new sO;return o._queue.enqueueAndForgetEvenWhileRestricted((0,C0.Z)(function*(){try{yield(i=(0,C0.Z)(function*(d){if(!r3.vt())return Promise.resolve();const _=d+"main";yield r3.delete(_)}),function(d){return i.apply(this,arguments)})(aie(o._databaseId,o._persistenceKey)),e.resolve()}catch(i){e.reject(i)}var i})),e.promise}(e._delegate)}}class Eme{constructor(e,i,d){this._delegate=i,this._persistenceProvider=d,this.INTERNAL={delete:()=>this.terminate()},e instanceof N6||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const i=this._delegate._getSettings();!e.merge&&i.host!==e.host&&bK("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},i),e)).merge,this._delegate._setSettings(e)}useEmulator(e,i,d={}){!function nye(o,e,i,d={}){var _;const B=(o=tT(o,W6))._getSettings();if("firestore.googleapis.com"!==B.host&&B.host!==e&&bK("Host has been set in both settings() and useEmulator(), emulator host will be used"),o._setSettings(Object.assign(Object.assign({},B),{host:`${e}:${i}`,ssl:!1})),d.mockUserToken){let _t,_a;if("string"==typeof d.mockUserToken)_t=d.mockUserToken,_a=qO.MOCK_USER;else{_t=(0,M_.Sg)(d.mockUserToken,null===(_=o._app)||void 0===_?void 0:_.options.projectId);const _h=d.mockUserToken.sub||d.mockUserToken.user_id;if(!_h)throw new W0(T0.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_a=new qO(_h)}o._authCredentials=new Yce(new c2(_t,_a))}}(this._delegate,e,i,d)}enableNetwork(){return function CX(o){return function _z(o){return o.asyncQueue.enqueue((0,C0.Z)(function*(){const e=yield zL(o),i=yield yX(o);return e.setNetworkEnabled(!0),function(d){const _=pI(d);return _.wu.delete(0),o3(_)}(i)}))}(uO(o=tT(o,VS)))}(this._delegate)}disableNetwork(){return function Vie(o){return function s3(o){return o.asyncQueue.enqueue((0,C0.Z)(function*(){const e=yield zL(o),i=yield yX(o);return e.setNetworkEnabled(!1),(d=(0,C0.Z)(function*(_){const B=pI(_);B.wu.add(0),yield nG(B),B.yu.set("Offline")}),function(_){return d.apply(this,arguments)})(i);var d}))}(uO(o=tT(o,VS)))}(this._delegate)}enablePersistence(e){let i=!1,d=!1;return e&&(i=!!e.synchronizeTabs,d=!!e.experimentalForceOwningTab,eY("synchronizeTabs",i,"experimentalForceOwningTab",d)),i?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,d)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function sye(o){return function(e){const i=new sO;return e.asyncQueue.enqueueAndForget((0,C0.Z)(function*(){return function _le(o,e){return vle.apply(this,arguments)}(yield Ple(e),i)})),i.promise}(uO(o=tT(o,VS)))}(this._delegate)}onSnapshotsInSync(e){return function vye(o,e){return function qge(o,e){const i=new s9(e);return o.asyncQueue.enqueueAndForget((0,C0.Z)(function*(){return d=yield cG(o),_=i,pI(d).bu.add(_),void _.next();var d,_})),()=>{i.Aa(),o.asyncQueue.enqueueAndForget((0,C0.Z)(function*(){return d=yield cG(o),_=i,void pI(d).bu.delete(_);var d,_}))}}(uO(o=tT(o,VS)),K6(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new W0("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new aY(this,zge(this._delegate,e))}catch(i){throw h2(i,"collection()","Firestore.collection()")}}doc(e){try{return new HM(this,uG(this._delegate,e))}catch(i){throw h2(i,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new f2(this,function rye(o,e){if(o=tT(o,W6),xle("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new W0(T0.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new MR(o,null,(i=e,new n3(eT.emptyPath(),i)));var i}(this._delegate,e))}catch(i){throw h2(i,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function $le(o,e,i){o=tT(o,VS);const d=Object.assign(Object.assign({},mye),i);return function(_){if(_.maxAttempts<1)throw new W0(T0.INVALID_ARGUMENT,"Max attempts must be at least 1")}(d),function Wge(o,e,i){const d=new sO;return o.asyncQueue.enqueueAndForget((0,C0.Z)(function*(){const _=yield(B=o,XK(B).then(_t=>_t.datastore));var B;new Xve(o.asyncQueue,_,i,e,d).run()})),d.promise}(uO(o),_=>e(new Jle(o,_)),d)}(this._delegate,i=>e(new Ime(this,i)))}batch(){return uO(this._delegate),new rde(new lme(this._delegate,e=>d3(this._delegate,e)))}loadBundle(e){return function nme(o,e){const i=uO(o=tT(o,VS)),d=new Jge;return function tye(o,e,i,d){const _=function(B,_t){let _a;return _a="string"==typeof B?(new TextEncoder).encode(B):B,_h=function(_h,_g){if(_h instanceof Uint8Array)return Ole(_h,void 0);if(_h instanceof ArrayBuffer)return Ole(new Uint8Array(_h),void 0);if(_h instanceof ReadableStream)return _h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(_a),new _X(_h,_t);var _h}(i,fX(e));o.asyncQueue.enqueueAndForget((0,C0.Z)(function*(){!function $ve(o,e,i){const d=pI(o);var _;(_=(0,C0.Z)(function*(B,_t,_a){try{const _h=yield _t.getMetadata();if(yield function(R_,H_){const W_=pI(R_),R0=bO(H_.createTime);return W_.persistence.runTransaction("hasNewerBundle","readonly",H0=>W_._s.getBundleMetadata(H0,H_.id)).then(H0=>!!H0&&H0.createTime.compareTo(R0)>=0)}(B.localStore,_h))return yield _t.close(),_a._completeWith({taskState:"Success",documentsLoaded:(R_=_h).totalDocuments,bytesLoaded:R_.totalBytes,totalDocuments:R_.totalDocuments,totalBytes:R_.totalBytes}),Promise.resolve(new Set);_a._updateProgress(Rge(_h));const _g=new Sge(_h,B.localStore,_t.M);let l_=yield _t.ma();for(;l_;){const R_=yield _g.Fu(l_);R_&&_a._updateProgress(R_),l_=yield _t.ma()}const f_=yield _g.complete();return yield Q6(B,f_.Lu,void 0),yield function(R_,H_){const W_=pI(R_);return W_.persistence.runTransaction("Save bundle","readwrite",R0=>W_._s.saveBundleMetadata(R0,H_))}(B.localStore,_h),_a._completeWith(f_.progress),Promise.resolve(f_.Bu)}catch(_h){return bK("SyncEngine",`Loading bundle failed with ${_h}`),_a._failWith(_h),Promise.resolve(new Set)}var R_}),function(B,_t,_a){return _.apply(this,arguments)})(d,e,i).then(_=>{d.sharedClientState.notifyBundleLoaded(_)})}(yield Ple(o),_,d)}))}(i,o._databaseId,e,d),d}(this._delegate,e)}namedQuery(e){return function Mle(o,e){return function Uie(o,e){return o.asyncQueue.enqueue((0,C0.Z)(function*(){return function(i,d){const _=pI(i);return _.persistence.runTransaction("Get named query","readonly",B=>_._s.getNamedQuery(B,d))}(yield kle(o),e)}))}(uO(o=tT(o,VS)),e).then(i=>i?new MR(o,null,i.query):null)}(this._delegate,e).then(i=>i?new f2(this,i):null)}}class NX extends zie{constructor(e){super(),this.firestore=e}convertBytes(e){return new h9(new c3(e))}convertReference(e){const i=this.convertDocumentKey(e,this.firestore._databaseId);return HM.forKey(i,this.firestore,null)}}class Ime{constructor(e,i){this._firestore=e,this._delegate=i,this._userDataWriter=new NX(e)}get(e){const i=f9(e);return this._delegate.get(i).then(d=>new PX(this._firestore,new l3(this._firestore._delegate,this._userDataWriter,d._key,d._document,d.metadata,i.converter)))}set(e,i,d){const _=f9(e);return d?(nde("Transaction.set",d),this._delegate.set(_,i,d)):this._delegate.set(_,i),this}update(e,i,d,..._){const B=f9(e);return 2===arguments.length?this._delegate.update(B,i):this._delegate.update(B,i,d,..._),this}delete(e){const i=f9(e);return this._delegate.delete(i),this}}class rde{constructor(e){this._delegate=e}set(e,i,d){const _=f9(e);return d?(nde("WriteBatch.set",d),this._delegate.set(_,i,d)):this._delegate.set(_,i),this}update(e,i,d,..._){const B=f9(e);return 2===arguments.length?this._delegate.update(B,i):this._delegate.update(B,i,d,..._),this}delete(e){const i=f9(e);return this._delegate.delete(i),this}commit(){return this._delegate.commit()}}class tR{constructor(e,i,d){this._firestore=e,this._userDataWriter=i,this._delegate=d}fromFirestore(e,i){const d=new iY(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new sY(this._firestore,d),null!=i?i:{})}toFirestore(e,i){return i?this._delegate.toFirestore(e,i):this._delegate.toFirestore(e)}static getInstance(e,i){const d=tR.INSTANCES;let _=d.get(e);_||(_=new WeakMap,d.set(e,_));let B=_.get(i);return B||(B=new tR(e,new NX(e),i),_.set(i,B)),B}}tR.INSTANCES=new WeakMap;class HM{constructor(e,i){this.firestore=e,this._delegate=i,this._userDataWriter=new NX(e)}static forPath(e,i,d){if(e.length%2!=0)throw new W0("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new HM(i,new vS(i._delegate,d,new fI(e)))}static forKey(e,i,d){return new HM(i,new vS(i._delegate,d,e))}get id(){return this._delegate.id}get parent(){return new aY(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new aY(this.firestore,zge(this._delegate,e))}catch(i){throw h2(i,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,M_.m9)(e))instanceof vS&&bX(this._delegate,e)}set(e,i){i=nde("DocumentReference.set",i);try{return i?oY(this._delegate,e,i):oY(this._delegate,e)}catch(d){throw h2(d,"setDoc()","DocumentReference.set()")}}update(e,i,...d){try{return 1===arguments.length?gme(this._delegate,e):gme(this._delegate,e,i,...d)}catch(_){throw h2(_,"updateDoc()","DocumentReference.update()")}}delete(){return function Yie(o){return d3(tT(o.firestore,VS),[new WZ(o._key,xR.none())])}(this._delegate)}onSnapshot(...e){const i=ide(e),d=bme(e,_=>new PX(this.firestore,new l3(this.firestore._delegate,this._userDataWriter,_._key,_._document,_.metadata,this._delegate.converter)));return Yle(this._delegate,i,d)}get(e){let i;return i="cache"===(null==e?void 0:e.source)?function hme(o){o=tT(o,vS);const e=tT(o.firestore,VS),i=uO(e),d=new _G(e);return function eye(o,e){const i=new sO;return o.asyncQueue.enqueueAndForget((0,C0.Z)(function*(){return(d=(0,C0.Z)(function*(_,B,_t){try{const _a=yield function(_h,_g){const l_=pI(_h);return l_.persistence.runTransaction("read document","readonly",f_=>l_.fi.Ls(f_,_g))}(_,B);_a.isFoundDocument()?_t.resolve(_a):_a.isNoDocument()?_t.resolve(null):_t.reject(new W0(T0.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(_a){const _h=i9(_a,`Failed to get document '${B} from cache`);_t.reject(_h)}}),function(_,B,_t){return d.apply(this,arguments)})(yield kle(o),e,i);var d})),i.promise}(i,o._key).then(_=>new l3(e,d,o._key,_,new u9(null!==_&&_.hasLocalMutations,!0),o.converter))}(this._delegate):"server"===(null==e?void 0:e.source)?function fme(o){o=tT(o,vS);const e=tT(o.firestore,VS);return Qge(uO(e),o._key,{source:"server"}).then(i=>DX(e,o,i))}(this._delegate):function dme(o){o=tT(o,vS);const e=tT(o.firestore,VS);return Qge(uO(e),o._key).then(i=>DX(e,o,i))}(this._delegate),i.then(d=>new PX(this.firestore,new l3(this.firestore._delegate,this._userDataWriter,d._key,d._document,d.metadata,this._delegate.converter)))}withConverter(e){return new HM(this.firestore,this._delegate.withConverter(e?tR.getInstance(this.firestore,e):null))}}function h2(o,e,i){return o.message=o.message.replace(e,i),o}function ide(o){for(const e of o)if("object"==typeof e&&!Xie(e))return e;return{}}function bme(o,e){var i,d;let _;return _=Xie(o[0])?o[0]:Xie(o[1])?o[1]:"function"==typeof o[0]?{next:o[0],error:o[1],complete:o[2]}:{next:o[1],error:o[2],complete:o[3]},{next:B=>{_.next&&_.next(e(B))},error:null===(i=_.error)||void 0===i?void 0:i.bind(_),complete:null===(d=_.complete)||void 0===d?void 0:d.bind(_)}}class PX{constructor(e,i){this._firestore=e,this._delegate=i}get ref(){return new HM(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,i){return this._delegate.get(e,i)}isEqual(e){return J4(this._delegate,e._delegate)}}class sY extends PX{data(e){const i=this._delegate.data(e);return function CK(o,e){o||PI()}(void 0!==i),i}}class f2{constructor(e,i){this.firestore=e,this._delegate=i,this._userDataWriter=new NX(e)}where(e,i,d){try{return new f2(this.firestore,Y6(this._delegate,function lye(o,e,i){const d=e,_=mG("where",o);return new uye(_,d,i)}(e,i,d)))}catch(_){throw h2(_,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,i){try{return new f2(this.firestore,Y6(this._delegate,function hye(o,e="asc"){const i=e,d=mG("orderBy",o);return new dye(d,i)}(e,i)))}catch(d){throw h2(d,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new f2(this.firestore,Y6(this._delegate,function fye(o){return YL("limit",o),new qie("limit",o,"F")}(e)))}catch(i){throw h2(i,"limit()","Query.limit()")}}limitToLast(e){try{return new f2(this.firestore,Y6(this._delegate,function pye(o){return YL("limitToLast",o),new qie("limitToLast",o,"L")}(e)))}catch(i){throw h2(i,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new f2(this.firestore,Y6(this._delegate,function ame(...o){return new Hle("startAt",o,!0)}(...e)))}catch(i){throw h2(i,"startAt()","Query.startAt()")}}startAfter(...e){try{return new f2(this.firestore,Y6(this._delegate,function Wie(...o){return new Hle("startAfter",o,!1)}(...e)))}catch(i){throw h2(i,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new f2(this.firestore,Y6(this._delegate,function ume(...o){return new cme("endBefore",o,!1)}(...e)))}catch(i){throw h2(i,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new f2(this.firestore,Y6(this._delegate,function gye(...o){return new cme("endAt",o,!0)}(...e)))}catch(i){throw h2(i,"endAt()","Query.endAt()")}}isEqual(e){return Yge(this._delegate,e._delegate)}get(e){let i;return i="cache"===(null==e?void 0:e.source)?function pme(o){o=tT(o,MR);const e=tT(o.firestore,VS),i=uO(e),d=new _G(e);return function q6(o,e){const i=new sO;return o.asyncQueue.enqueueAndForget((0,C0.Z)(function*(){return(d=(0,C0.Z)(function*(_,B,_t){try{const _a=yield CO(_,B,!0),_h=new Iie(B,_a._i),_g=_h.Wu(_a.documents),l_=_h.applyChanges(_g,!1);_t.resolve(l_.snapshot)}catch(_a){const _h=i9(_a,`Failed to execute query '${B} against cache`);_t.reject(_h)}}),function(_,B,_t){return d.apply(this,arguments)})(yield kle(o),e,i);var d})),i.promise}(i,o._query).then(_=>new AG(e,d,o,_))}(this._delegate):"server"===(null==e?void 0:e.source)?function _ye(o){o=tT(o,MR);const e=tT(o.firestore,VS),i=uO(e),d=new _G(e);return Hge(i,o._query,{source:"server"}).then(_=>new AG(e,d,o,_))}(this._delegate):function Aye(o){o=tT(o,MR);const e=tT(o.firestore,VS),i=uO(e),d=new _G(e);return sme(o._query),Hge(i,o._query).then(_=>new AG(e,d,o,_))}(this._delegate),i.then(d=>new eoe(this.firestore,new AG(this.firestore._delegate,this._userDataWriter,this._delegate,d._snapshot)))}onSnapshot(...e){const i=ide(e),d=bme(e,_=>new eoe(this.firestore,new AG(this.firestore._delegate,this._userDataWriter,this._delegate,_._snapshot)));return Yle(this._delegate,i,d)}withConverter(e){return new f2(this.firestore,this._delegate.withConverter(e?tR.getInstance(this.firestore,e):null))}}class Cme{constructor(e,i){this._firestore=e,this._delegate=i}get type(){return this._delegate.type}get doc(){return new sY(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class eoe{constructor(e,i){this._firestore=e,this._delegate=i}get query(){return new f2(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new sY(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(i=>new Cme(this._firestore,i))}forEach(e,i){this._delegate.forEach(d=>{e.call(i,new sY(this._firestore,d))})}isEqual(e){return J4(this._delegate,e._delegate)}}class aY extends f2{constructor(e,i){super(e,i),this.firestore=e,this._delegate=i}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new HM(this.firestore,e):null}doc(e){try{return new HM(this.firestore,void 0===e?uG(this._delegate):uG(this._delegate,e))}catch(i){throw h2(i,"doc()","CollectionReference.doc()")}}add(e){return function zle(o,e){const i=tT(o.firestore,VS),d=uG(o),_=OX(o.converter,e);return d3(i,[c9(lG(o.firestore),"addDoc",d._key,_,null!==o.converter,{}).toMutation(d._key,xR.exists(!1))]).then(()=>d)}(this._delegate,e).then(i=>new HM(this.firestore,i))}isEqual(e){return bX(this._delegate,e._delegate)}withConverter(e){return new aY(this.firestore,this._delegate.withConverter(e?tR.getInstance(this.firestore,e):null))}}function f9(o){return tT(o,vS)}class toe{constructor(...e){this._delegate=new QM(...e)}static documentId(){return new toe(PR.keyField().canonicalString())}isEqual(e){return(e=(0,M_.m9)(e))instanceof QM&&this._delegate._internalPath.isEqual(e._internalPath)}}class p9{constructor(e){this._delegate=e}static serverTimestamp(){const e=function Xle(){return new wX("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new p9(e)}static delete(){const e=function Zle(){return new dG("deleteField")}();return e._methodName="FieldValue.delete",new p9(e)}static arrayUnion(...e){const i=function Jie(...o){return new jle("arrayUnion",o)}(...e);return i._methodName="FieldValue.arrayUnion",new p9(i)}static arrayRemove(...e){const i=function ede(...o){return new Vle("arrayRemove",o)}(...e);return i._methodName="FieldValue.arrayRemove",new p9(i)}static increment(e){const i=function yye(o){return new ome("increment",o)}(e);return i._methodName="FieldValue.increment",new p9(i)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const wme={Firestore:Eme,GeoPoint:tY,Timestamp:XS,Blob:h9,Transaction:Ime,WriteBatch:rde,DocumentReference:HM,DocumentSnapshot:PX,Query:f2,QueryDocumentSnapshot:sY,QuerySnapshot:eoe,CollectionReference:aY,FieldPath:toe,FieldValue:p9,setLogLevel:function kX(o){!function Kce(o){W8.setLogLevel(o)}(o)},CACHE_SIZE_UNLIMITED:-1};function Sme(o,e){return function J6(o,e=sH.z){return new LT.y(i=>{let d;return null!=e?e.schedule(()=>{d=o.onSnapshot({includeMetadataChanges:!0},i)}):d=o.onSnapshot({includeMetadataChanges:!0},i),()=>{null!=d&&d()}})}(o,e)}function ode(o,e){return Sme(o,e).pipe((0,RI.U)(i=>({payload:i,type:"query"})))}function noe(o,e){return ode(o,e).pipe(GN(void 0),TR(),(0,RI.U)(([i,d])=>{const _=d.payload.docChanges(),B=_.map(_t=>({type:_t.type,payload:_t}));return i&&JSON.stringify(i.payload.metadata)!==JSON.stringify(d.payload.metadata)&&d.payload.docs.forEach((_t,_a)=>{const _h=_.find(l_=>l_.doc.ref.isEqual(_t.ref)),_g=null==i?void 0:i.payload.docs.find(l_=>l_.ref.isEqual(_t.ref));_h&&JSON.stringify(_h.doc.metadata)===JSON.stringify(_t.metadata)||!_h&&_g&&JSON.stringify(_g.metadata)===JSON.stringify(_t.metadata)||B.push({type:"modified",payload:{oldIndex:_a,newIndex:_a,type:"modified",doc:_t}})}),B}))}function Rme(o,e,i){return noe(o,i).pipe(xO((d,_)=>function Cye(o,e,i){return e.forEach(d=>{i.indexOf(d.type)>-1&&(o=function wye(o,e){switch(e.type){case"added":if(!o[e.newIndex]||!o[e.newIndex].doc.ref.isEqual(e.doc.ref))return sde(o,e.newIndex,0,e);break;case"modified":if(null==o[e.oldIndex]||o[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const i=o.slice();return i.splice(e.oldIndex,1),i.splice(e.newIndex,0,e),i}return sde(o,e.newIndex,1,e)}break;case"removed":if(o[e.oldIndex]&&o[e.oldIndex].doc.ref.isEqual(e.doc.ref))return sde(o,e.oldIndex,1)}return o}(o,d))}),o}(d,_.map(B=>B.payload),e),[]),uee(),(0,RI.U)(d=>d.map(_=>({type:_.type,payload:_}))))}function sde(o,e,i,...d){const _=o.slice();return _.splice(e,i,...d),_}function ade(o){return(!o||0===o.length)&&(o=["added","removed","modified"]),o}!function Tme(o){(function Iye(o,e){o.INTERNAL.registerComponent(new bL.wA("firestore-compat",i=>{const d=i.getProvider("app-compat").getImmediate(),_=i.getProvider("firestore").getImmediate();return e(d,_)},"PUBLIC").setServiceProps(Object.assign({},wme)))})(o,(e,i)=>new Eme(e,i,new yme)),o.registerVersion("@firebase/firestore-compat","0.1.18")}(k5.Z);class Ome{constructor(e,i,d){this.ref=e,this.query=i,this.afs=d}stateChanges(e){let i=noe(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(i=i.pipe((0,RI.U)(d=>d.filter(_=>e.indexOf(_.type)>-1)))),i.pipe(GN(void 0),TR(),zS(([d,_])=>_.length>0||!d),(0,RI.U)(([d,_])=>_),H1.iC)}auditTrail(e){return this.stateChanges(e).pipe(xO((i,d)=>[...i,...d],[]))}snapshotChanges(e){const i=ade(e);return Rme(this.query,i,this.afs.schedulers.outsideAngular).pipe(H1.iC)}valueChanges(e={}){return ode(this.query,this.afs.schedulers.outsideAngular).pipe((0,RI.U)(i=>i.payload.docs.map(d=>e.idField?Object.assign(Object.assign({},d.data()),{[e.idField]:d.id}):d.data())),H1.iC)}get(e){return(0,uT.D)(this.query.get(e)).pipe(H1.iC)}add(e){return this.ref.add(e)}doc(e){return new Dme(this.ref.doc(e),this.afs)}}class Dme{constructor(e,i){this.ref=e,this.afs=i}set(e,i){return this.ref.set(e,i)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,i){const d=this.ref.collection(e),{ref:_,query:B}=ude(d,i);return new Ome(_,B,this.afs)}snapshotChanges(){return function bye(o,e){return Sme(o,e).pipe(GN(void 0),TR(),(0,RI.U)(([i,d])=>d.exists?(null==i?void 0:i.exists)?{payload:d,type:"modified"}:{payload:d,type:"added"}:{payload:d,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(H1.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,RI.U)(({payload:i})=>e.idField?Object.assign(Object.assign({},i.data()),{[e.idField]:i.id}):i.data()))}get(e){return(0,uT.D)(this.ref.get(e)).pipe(H1.iC)}}class Tye{constructor(e,i){this.query=e,this.afs=i}stateChanges(e){return e&&0!==e.length?noe(this.query,this.afs.schedulers.outsideAngular).pipe((0,RI.U)(i=>i.filter(d=>e.indexOf(d.type)>-1)),zS(i=>i.length>0),H1.iC):noe(this.query,this.afs.schedulers.outsideAngular).pipe(H1.iC)}auditTrail(e){return this.stateChanges(e).pipe(xO((i,d)=>[...i,...d],[]))}snapshotChanges(e){const i=ade(e);return Rme(this.query,i,this.afs.schedulers.outsideAngular).pipe(H1.iC)}valueChanges(e={}){return ode(this.query,this.afs.schedulers.outsideAngular).pipe((0,RI.U)(d=>d.payload.docs.map(_=>e.idField?Object.assign({[e.idField]:_.id},_.data()):_.data())),H1.iC)}get(e){return(0,uT.D)(this.query.get(e)).pipe(H1.iC)}}const Nme=new f.OlP("angularfire2.enableFirestorePersistence"),kme=new f.OlP("angularfire2.firestore.persistenceSettings"),cde=new f.OlP("angularfire2.firestore.settings"),Sye=new f.OlP("angularfire2.firestore.use-emulator");function ude(o,e=(i=>i)){return{query:e(o),ref:o}}let cY=(()=>{class o{constructor(i,d,_,B,_t,_a,_h,_g,l_,f_,R_,H_,W_,R0,H0,CI,LI){this.schedulers=_h;const xI=(0,lR.on)(i,_a,d),DI=l_;f_&&N8(xI,_a,R_,W_,R0,H0,H_,CI),[this.firestore,this.persistenceEnabled$]=(0,lR.cc)(`${xI.name}.firestore`,"AngularFirestore",xI.name,()=>{const _C=_a.runOutsideAngular(()=>xI.firestore());if(B&&_C.settings(B),DI&&_C.useEmulator(...DI),_&&!rL(_t)){const G1=()=>{try{return(0,uT.D)(_C.enablePersistence(_g||void 0).then(()=>!0,()=>!1))}catch(BR){return"undefined"!=typeof console&&console.warn(BR),hI(!1)}};return[_C,_a.runOutsideAngular(G1)]}return[_C,hI(!1)]},[B,DI,_])}collection(i,d){let _;_="string"==typeof i?this.firestore.collection(i):i;const{ref:B,query:_t}=ude(_,d),_a=this.schedulers.ngZone.run(()=>B);return new Ome(_a,_t,this)}collectionGroup(i,d){const _=d||(_t=>_t),B=this.firestore.collectionGroup(i);return new Tye(_(B),this)}doc(i){let d;d="string"==typeof i?this.firestore.doc(i):i;const _=this.schedulers.ngZone.run(()=>d);return new Dme(_,this)}createId(){return this.firestore.collection("_").doc().id}}return o.\u0275fac=function(i){return new(i||o)(f.LFG(lR.Dh),f.LFG(lR.xv,8),f.LFG(Nme,8),f.LFG(cde,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(H1.HU),f.LFG(kme,8),f.LFG(Sye,8),f.LFG(iI,8),f.LFG(P$,8),f.LFG(KW,8),f.LFG(fQ,8),f.LFG(p6,8),f.LFG(x$,8),f.LFG(D8,8),f.LFG(f6,8))},o.\u0275prov=f.Yz7({token:o,factory:o.\u0275fac,providedIn:"any"}),o})(),roe=(()=>{class o{constructor(){hQ.Z.registerVersion("angularfire",H1.q4.full,"fst-compat")}static enablePersistence(i){return{ngModule:o,providers:[{provide:Nme,useValue:!0},{provide:kme,useValue:i}]}}}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=f.oAB({type:o}),o.\u0275inj=f.cJS({providers:[cY]}),o})(),Pme=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=f.oAB({type:o,bootstrap:[Vhe]}),o.\u0275inj=f.cJS({providers:[oH,iH,XM],imports:[[oU,jhe,XX,$$,lR.hO.initializeApp(Dae_firebaseConfig),Wse,roe,II,Q_,boe.forRoot(),j2.forRoot()]]}),o})();(0,f.G48)(),T3().bootstrapModule(Pme).catch(o=>console.error(o))},3890:function(h,l,g){var f=g(8926).default;h.exports=function(){"use strict";var k="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},q=function(s){return s&&s.Math==Math&&s},_r=q("object"==typeof globalThis&&globalThis)||q("object"==typeof window&&window)||q("object"==typeof self&&self)||q("object"==typeof k&&k)||function(){return this}()||Function("return this")(),_s={},ga=function(s){try{return!!s()}catch(p){return!0}},_l=!ga(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),bh=!ga(function(){var s=function(){}.bind();return"function"!=typeof s||s.hasOwnProperty("prototype")}),_A=Function.prototype.call,r_=bh?_A.bind(_A):function(){return _A.apply(_A,arguments)},p_={},I_={}.propertyIsEnumerable,v_=Object.getOwnPropertyDescriptor,S_=v_&&!I_.call({1:2},1);p_.f=S_?function(s){var p=v_(this,s);return!!p&&p.enumerable}:I_;var x_,B_,V_=function(s,p){return{enumerable:!(1&s),configurable:!(2&s),writable:!(4&s),value:p}},_0=bh,c0=Function.prototype,h0=c0.call,I0=_0&&c0.bind.bind(h0,h0),G_=_0?function(s){return s&&I0(s)}:function(s){return s&&function(){return h0.apply(s,arguments)}},e0=G_,P_=e0({}.toString),_v=e0("".slice),E_=function(s){return _v(P_(s),8,-1)},F_=ga,J_=E_,Y_=_r.Object,D0=G_("".split),O0=F_(function(){return!Y_("z").propertyIsEnumerable(0)})?function(s){return"String"==J_(s)?D0(s,""):Y_(s)}:Y_,EI=_r.TypeError,eI=function(s){if(null==s)throw EI("Can't call method on "+s);return s},Y0=O0,x1=eI,_1=function(s){return Y0(x1(s))},UI=function(s){return"function"==typeof s},Z1=UI,sT=function(s){return"object"==typeof s?null!==s:Z1(s)},L1=_r,w1=UI,SN=function(s){return w1(s)?s:void 0},_T=function(s,p){return arguments.length<2?SN(L1[s]):L1[s]&&L1[s][p]},NT=G_({}.isPrototypeOf),YT=_T("navigator","userAgent")||"",RN=YT,jR=_r.process,ZO=_r.Deno,KI=jR&&jR.versions||ZO&&ZO.version,dO=KI&&KI.v8;dO&&(B_=(x_=dO.split("."))[0]>0&&x_[0]<4?1:+(x_[0]+x_[1])),!B_&&RN&&(!(x_=RN.match(/Edge\/(\d+)/))||x_[1]>=74)&&(x_=RN.match(/Chrome\/(\d+)/))&&(B_=+x_[1]);var TT=B_,GT=TT,VR=!!Object.getOwnPropertySymbols&&!ga(function(){var s=Symbol();return!String(s)||!(Object(s)instanceof Symbol)||!Symbol.sham&&GT&&GT<41}),IS=VR&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,JT=_T,SO=UI,_x=NT,kI=_r.Object,JI=IS?function(s){return"symbol"==typeof s}:function(s){var p=JT("Symbol");return SO(p)&&_x(p.prototype,kI(s))},gR=_r.String,rR=function(s){try{return gR(s)}catch(p){return"Object"}},D1=UI,eL=rR,mR=_r.TypeError,$T=function(s){if(D1(s))return s;throw mR(eL(s)+" is not a function")},$_=$T,_E=function(s,p){var A=s[p];return null==A?void 0:$_(A)},r0=r_,M0=UI,_y=sT,m0=_r.TypeError,G0={exports:{}},yI=_r,qI=Object.defineProperty,XI=function(s,p){try{qI(yI,s,{value:p,configurable:!0,writable:!0})}catch(A){yI[s]=p}return p},_b="__core-js_shared__",ZT=_r[_b]||XI(_b,{}),AR=ZT;(G0.exports=function(s,p){return AR[s]||(AR[s]=void 0!==p?p:{})})("versions",[]).push({version:"3.20.3",mode:"global",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"});var g3=eI,YM=_r.Object,ON=function(s){return YM(g3(s))},JM=ON,bS=G_({}.hasOwnProperty),X1=Object.hasOwn||function(s,p){return bS(JM(s),p)},g2=G_,CS=0,hO=Math.random(),Z6=g2(1..toString),m2=function(s){return"Symbol("+(void 0===s?"":s)+")_"+Z6(++CS+hO,36)},$M=_r,QS=X1,$L=m2,GR=VR,dI=IS,NI=(0,G0.exports)("wks"),B1=$M.Symbol,QR=B1&&B1.for,DN=dI?B1:B1&&B1.withoutSetter||$L,E1=function(s){if(!QS(NI,s)||!GR&&"string"!=typeof NI[s]){var p="Symbol."+s;NI[s]=GR&&QS(B1,s)?B1[s]:dI&&QR?QR(p):DN(p)}return NI[s]},NN=r_,fT=sT,RO=JI,XT=_E,fP=_r.TypeError,m3=E1("toPrimitive"),pP=function(s,p){if(!fT(s)||RO(s))return s;var A,y=XT(s,m3);if(y){if(void 0===p&&(p="default"),A=NN(y,s,p),!fT(A)||RO(A))return A;throw fP("Can't convert object to primitive value")}return void 0===p&&(p="number"),function(s,p){var A,y;if("string"===p&&M0(A=s.toString)&&!_y(y=r0(A,s))||M0(A=s.valueOf)&&!_y(y=r0(A,s))||"string"!==p&&M0(A=s.toString)&&!_y(y=r0(A,s)))return y;throw m0("Can't convert object to primitive value")}(s,p)},HS=JI,kN=function(s){var p=pP(s,"string");return HS(p)?p:p+""},A2=sT,QT=_r.document,cT=A2(QT)&&A2(QT.createElement),tL=function(s){return cT?QT.createElement(s):{}},ZM=tL,HR=!_l&&!ga(function(){return 7!=Object.defineProperty(ZM("div"),"a",{get:function(){return 7}}).a}),A3=r_,X6=p_,xN=V_,LN=_1,mj=kN,_9=X1,eV=HR,iR=Object.getOwnPropertyDescriptor;_s.f=_l?iR:function(s,p){if(s=LN(s),p=mj(p),eV)try{return iR(s,p)}catch(A){}if(_9(s,p))return xN(!A3(X6.f,s,p),s[p])};var yT={},_j=_l&&ga(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),_2=sT,v9=_r.String,tV=_r.TypeError,wS=function(s){if(_2(s))return s;throw tV(v9(s)+" is not an object")},y9=HR,XM=wS,EG=kN,rV=_r.TypeError,mP=Object.defineProperty,IG=Object.getOwnPropertyDescriptor;yT.f=_l?_j?function(s,p,A){if(XM(s),p=EG(p),XM(A),"function"==typeof s&&"prototype"===p&&"value"in A&&"writable"in A&&!A.writable){var y=IG(s,p);y&&y.writable&&(s[p]=A.value,A={configurable:"configurable"in A?A.configurable:y.configurable,enumerable:"enumerable"in A?A.enumerable:y.enumerable,writable:!1})}return mP(s,p,A)}:mP:function(s,p,A){if(XM(s),p=EG(p),XM(A),y9)try{return mP(s,p,A)}catch(y){}if("get"in A||"set"in A)throw rV("Accessors not supported");return"value"in A&&(s[p]=A.value),s};var oV=yT,_R=V_,TS=_l?function(s,p,A){return oV.f(s,p,_R(1,A))}:function(s,p,A){return s[p]=A,s},eS={exports:{}},XL=UI,v3=ZT,CG=G_(Function.toString);XL(v3.inspectSource)||(v3.inspectSource=function(s){return CG(s)});var nL,XO,v2,qS=v3.inspectSource,qR=qS,rL=_r.WeakMap,OO=UI(rL)&&/native code/.test(qR(rL)),aV=m2,y3=(0,G0.exports)("keys"),AP=function(s){return y3[s]||(y3[s]=aV(s))},eU={},nT=G_,tU=sT,iL=TS,K1=X1,E3=AP,_P=eU,WS="Object already initialized",nU=_r.TypeError;if(OO||ZT.state){var oR=ZT.state||(ZT.state=new(0,_r.WeakMap)),sR=nT(oR.get),vP=nT(oR.has),y2=nT(oR.set);nL=function(s,p){if(vP(oR,s))throw new nU(WS);return p.facade=s,y2(oR,s,p),p},XO=function(s){return sR(oR,s)||{}},v2=function(s){return vP(oR,s)}}else{var BN=E3("state");_P[BN]=!0,nL=function(s,p){if(K1(s,BN))throw new nU(WS);return p.facade=s,iL(s,BN,p),p},XO=function(s){return K1(s,BN)?s[BN]:{}},v2=function(s){return K1(s,BN)}}var PT={set:nL,get:XO,has:v2,enforce:function(s){return v2(s)?XO(s):nL(s,{})},getterFor:function(s){return function(p){var A;if(!tU(p)||(A=XO(p)).type!==s)throw nU("Incompatible receiver, "+s+" required");return A}}},DO=_l,zI=Function.prototype,yP=DO&&Object.getOwnPropertyDescriptor,rU=X1(zI,"name"),sL={EXISTS:rU,PROPER:rU&&"something"===function(){}.name,CONFIGURABLE:rU&&(!DO||DO&&yP(zI,"name").configurable)},jj=_r,iU=UI,I3=X1,b3=TS,tM=XI,j0=qS,T1=sL.CONFIGURABLE,nM=PT.get,ST=PT.enforce,C3=String(String).split("String");(eS.exports=function(s,p,A,y){var w,$=!!y&&!!y.unsafe,j=!!y&&!!y.enumerable,_e=!!y&&!!y.noTargetGet,K=y&&void 0!==y.name?y.name:p;iU(A)&&("Symbol("===String(K).slice(0,7)&&(K="["+String(K).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!I3(A,"name")||T1&&A.name!==K)&&b3(A,"name",K),(w=ST(A)).source||(w.source=C3.join("string"==typeof K?K:""))),s!==jj?($?!_e&&s[p]&&(j=!0):delete s[p],j?s[p]=A:b3(s,p,A)):j?s[p]=A:tM(p,A)})(Function.prototype,"toString",function(){return iU(this)&&nM(this).source||j0(this)});var _D={},NO=Math.ceil,$j=Math.floor,UN=function(s){var p=+s;return p!=p||0===p?0:(p>0?$j:NO)(p)},e5=UN,uV=Math.max,E9=Math.min,kO=function(s,p){var A=e5(s);return A<0?uV(A+p,0):E9(A,p)},vR=UN,PO=Math.min,E2=function(s){return s>0?PO(vR(s),9007199254740991):0},EP=E2,SS=function(s){return EP(s.length)},t5=_1,w3=kO,T3=SS,S3=function(s){return function(p,A,y){var w,$=t5(p),j=T3($),_e=w3(y,j);if(s&&A!=A){for(;j>_e;)if((w=$[_e++])!=w)return!0}else for(;j>_e;_e++)if((s||_e in $)&&$[_e]===A)return s||_e||0;return!s&&-1}},oU={includes:S3(!0),indexOf:S3(!1)},rM=X1,R3=_1,lV=oU.indexOf,dV=eU,sU=G_([].push),IP=function(s,p){var A,y=R3(s),w=0,$=[];for(A in y)!rM(dV,A)&&rM(y,A)&&sU($,A);for(;p.length>w;)rM(y,A=p[w++])&&(~lV($,A)||sU($,A));return $},O3=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],iM=IP,hV=O3.concat("length","prototype");_D.f=Object.getOwnPropertyNames||function(s){return iM(s,hV)};var aU={};aU.f=Object.getOwnPropertySymbols;var fO=_T,wG=_D,n5=aU,KS=wS,aL=G_([].concat),cS=fO("Reflect","ownKeys")||function(s){var p=wG.f(KS(s)),A=n5.f;return A?aL(p,A(s)):p},r5=X1,FX=cS,I9=_s,fV=yT,pV=function(s,p,A){for(var y=FX(p),w=fV.f,$=I9.f,j=0;j<y.length;j++){var _e=y[j];r5(s,_e)||A&&r5(A,_e)||w(s,_e,$(p,_e))}},pY=ga,cU=UI,I2=/#|\.prototype\./,eN=function(s,p){var A=gV[RS(s)];return A==cL||A!=b9&&(cU(p)?pY(p):!!p)},RS=eN.normalize=function(s){return String(s).replace(I2,".").toLowerCase()},gV=eN.data={},b9=eN.NATIVE="N",cL=eN.POLYFILL="P",bP=eN,oM=_r,mV=_s.f,FN=TS,uU=eS.exports,C9=XI,uT=pV,sM=bP,hI=function(s,p){var A,y,w,$,j,_e=s.target,K=s.global,_i=s.stat;if(A=K?oM:_i?oM[_e]||C9(_e,{}):(oM[_e]||{}).prototype)for(y in p){if($=p[y],w=s.noTargetGet?(j=mV(A,y))&&j.value:A[y],!sM(K?y:_e+(_i?".":"#")+y,s.forced)&&void 0!==w){if(typeof $==typeof w)continue;uT($,w)}(s.sham||w&&w.sham)&&FN($,"sham",!0),uU(A,y,$,s)}},xT=_r.Promise,WR=eS.exports,LT=function(s,p,A){for(var y in p)WR(s,y,p[y],A);return s},AV=UI,cM=_r.String,CP=_r.TypeError,tS=G_,wP=wS,RI=Object.setPrototypeOf||("__proto__"in{}?function(){var s,p=!1,A={};try{(s=tS(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(A,[]),p=A instanceof Array}catch(y){}return function(y,w){return wP(y),function(s){if("object"==typeof s||AV(s))return s;throw CP("Can't set "+cM(s)+" as a prototype")}(w),p?s(y,w):y.__proto__=w,y}}():void 0),_V=yT.f,vV=X1,D3=E1("toStringTag"),uL=function(s,p,A){s&&!A&&(s=s.prototype),s&&!vV(s,D3)&&_V(s,D3,{configurable:!0,value:p})},nS=_T,TP=yT,uM=_l,SP=E1("species"),uS=function(s){var p=nS(s);uM&&p&&!p[SP]&&(0,TP.f)(p,SP,{configurable:!0,get:function(){return this}})},lL=NT,RP=_r.TypeError,jN=function(s,p){if(lL(p,s))return s;throw RP("Incorrect invocation")},OP=$T,lM=bh,DP=G_(G_.bind),VN=function(s,p){return OP(s),void 0===p?s:lM?DP(s,p):function(){return s.apply(p,arguments)}},NP={},lU=NP,b2=E1("iterator"),dL=Array.prototype,rS=function(s){return void 0!==s&&(lU.Array===s||dL[b2]===s)},N3={};N3[E1("toStringTag")]="z";var kP=_r,HT="[object z]"===String(N3),hL=UI,GN=E_,C2=E1("toStringTag"),xO=kP.Object,zS="Arguments"==GN(function(){return arguments}()),aR=HT?GN:function(s){var p,A,y;return void 0===s?"Undefined":null===s?"Null":"string"==typeof(A=function(w,$){try{return w[$]}catch(j){}}(p=xO(s),C2))?A:zS?GN(p):"Object"==(y=GN(p))&&hL(p.callee)?"Arguments":y},OS=aR,LO=_E,k3=NP,i5=E1("iterator"),RT=function(s){if(null!=s)return LO(s,i5)||LO(s,"@@iterator")||k3[OS(s)]},TG=r_,gY=$T,dM=wS,pO=rR,yV=RT,PP=_r.TypeError,o5=function(s,p){var A=arguments.length<2?yV(s):p;if(gY(A))return dM(TG(A,s));throw PP(pO(s)+" is not iterable")},w2=r_,P3=wS,lS=_E,dU=VN,x3=r_,EV=wS,SG=rR,yR=rS,KR=SS,hM=NT,fM=o5,T2=RT,S2=function(s,p,A){var y,w;P3(s);try{if(!(y=lS(s,"return"))){if("throw"===p)throw A;return A}y=w2(y,s)}catch($){w=!0,y=$}if("throw"===p)throw A;if(w)throw y;return P3(y),A},R2=_r.TypeError,O2=function(s,p){this.stopped=s,this.result=p},v1=O2.prototype,s5=E1("iterator"),fL=!1;try{var ER=0,pM={next:function(){return{done:!!ER++}},return:function(){fL=!0}};pM[s5]=function(){return this},Array.from(pM,function(){throw 2})}catch(s){}var pL=function(s,p){if(!p&&!fL)return!1;var A=!1;try{var y={};y[s5]=function(){return{next:function(){return{done:A=!0}}}},s(y)}catch(w){}return A},w9=G_,D2=ga,MO=UI,L3=aR,IV=qS,nN=function(){},bV=[],pT=_T("Reflect","construct"),DS=/^\s*(?:class|function)\b/,a5=w9(DS.exec),RG=!DS.exec(nN),BO=function(s){if(!MO(s))return!1;try{return pT(nN,bV,s),!0}catch(p){return!1}},gL=function(s){if(!MO(s))return!1;switch(L3(s)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return RG||!!a5(DS,IV(s))}catch(p){return!0}};gL.sham=!0;var N2,c_,d_,T_,K_=!pT||D2(function(){var s;return BO(BO.call)||!BO(Object)||!BO(function(){s=!0})||s})?gL:BO,p0=K_,E0=rR,k0=_r.TypeError,vI=function(s){if(p0(s))return s;throw k0(E0(s)+" is not a constructor")},SI=wS,jI=vI,Q1=E1("species"),t1=function(s,p){var A,y=SI(s).constructor;return void 0===y||null==(A=SI(y)[Q1])?p:jI(A)},NS=Function.prototype,QN=NS.apply,rN=NS.call,zR="object"==typeof Reflect&&Reflect.apply||(bh?rN.bind(QN):function(){return rN.apply(QN,arguments)}),cR=_T("document","documentElement"),k2=G_([].slice),P2=/(?:ipad|iphone|ipod).*applewebkit/i.test(YT),gM="process"==E_(_r.process),YR=_r,c5=zR,CV=VN,wV=UI,OG=X1,TV=ga,hU=cR,u5=k2,SV=tL,jX=P2,T9=gM,l5=YR.setImmediate,RV=YR.clearImmediate,M3=YR.process,x2=YR.Dispatch,B3=YR.Function,U3=YR.MessageChannel,OV=YR.String,mM=0,iN={};try{N2=YR.location}catch(s){}var R9=function(s){if(OG(iN,s)){var p=iN[s];delete iN[s],p()}},L2=function(s){return function(){R9(s)}},d5=function(s){R9(s.data)},h5=function(s){YR.postMessage(OV(s),N2.protocol+"//"+N2.host)};l5&&RV||(l5=function(s){var p=u5(arguments,1);return iN[++mM]=function(){c5(wV(s)?s:B3(s),void 0,p)},c_(mM),mM},RV=function(s){delete iN[s]},T9?c_=function(s){M3.nextTick(L2(s))}:x2&&x2.now?c_=function(s){x2.now(L2(s))}:U3&&!jX?(T_=(d_=new U3).port2,d_.port1.onmessage=d5,c_=CV(T_.postMessage,T_)):YR.addEventListener&&wV(YR.postMessage)&&!YR.importScripts&&N2&&"file:"!==N2.protocol&&!TV(h5)?(c_=h5,YR.addEventListener("message",d5,!1)):c_="onreadystatechange"in SV("script")?function(s){hU.appendChild(SV("script")).onreadystatechange=function(){hU.removeChild(this),R9(s)}}:function(s){setTimeout(L2(s),0)});var fU,xP,oN,pU,gU,DG,NG,O9,gO={set:l5,clear:RV},LP=_r,F3=/ipad|iphone|ipod/i.test(YT)&&void 0!==LP.Pebble,D9=/web0s(?!.*chrome)/i.test(YT),mL=_r,N9=VN,kG=gO.set,PG=P2,k9=F3,P9=D9,j3=gM,x9=mL.MutationObserver||mL.WebKitMutationObserver,L9=mL.document,AM=mL.process,AL=mL.Promise,DV=(0,_s.f)(mL,"queueMicrotask"),sN=DV&&DV.value;sN||(fU=function(){var s,p;for(j3&&(s=AM.domain)&&s.exit();xP;){p=xP.fn,xP=xP.next;try{p()}catch(A){throw xP?pU():oN=void 0,A}}oN=void 0,s&&s.enter()},PG||j3||P9||!x9||!L9?!k9&&AL&&AL.resolve?((NG=AL.resolve(void 0)).constructor=AL,O9=N9(NG.then,NG),pU=function(){O9(fU)}):j3?pU=function(){AM.nextTick(fU)}:(kG=N9(kG,mL),pU=function(){kG(fU)}):(gU=!0,DG=L9.createTextNode(""),new x9(fU).observe(DG,{characterData:!0}),pU=function(){DG.data=gU=!gU}));var p5=sN||function(s){var p={fn:s,next:void 0};oN&&(oN.next=p),xP||(xP=p,pU()),oN=p},V3={},g5=$T,_L=function(s){var p,A;this.promise=new s(function(y,w){if(void 0!==p||void 0!==A)throw TypeError("Bad Promise constructor");p=y,A=w}),this.resolve=g5(p),this.reject=g5(A)};V3.f=function(s){return new _L(s)};var M9=wS,G3=sT,VX=V3,Q3=function(s,p){if(M9(s),G3(p)&&p.constructor===s)return p;var A=VX.f(s);return(0,A.resolve)(p),A.promise},xG=_r,NV=function(){this.head=null,this.tail=null};NV.prototype={add:function(s){var p={item:s,next:null};this.head?this.tail.next=p:this.head=p,this.tail=p},get:function(){var s=this.head;if(s)return this.head=s.next,this.tail===s&&(this.tail=null),s.item}};var H3,m5,LG,mU,mY="object"==typeof window,_5=hI,aN=_r,q3=_T,MP=r_,_M=xT,JR=eS.exports,iS=LT,kV=RI,PV=uL,AU=uS,xV=$T,v5=UI,AY=sT,_Y=jN,_U=qS,MG=function(s,p,A){var y,w,$,j,_e,K,_i,_u=!(!A||!A.AS_ENTRIES),ch=!(!A||!A.IS_ITERATOR),_f=!(!A||!A.INTERRUPTED),o_=dU(p,A&&A.that),i_=function(g_){return y&&S2(y,"normal",g_),new O2(!0,g_)},u_=function(g_){return _u?(EV(g_),_f?o_(g_[0],g_[1],i_):o_(g_[0],g_[1])):_f?o_(g_,i_):o_(g_)};if(ch)y=s;else{if(!(w=T2(s)))throw R2(SG(s)+" is not iterable");if(yR(w)){for($=0,j=KR(s);j>$;$++)if((_e=u_(s[$]))&&hM(v1,_e))return _e;return new O2(!1)}y=fM(s,w)}for(K=y.next;!(_i=x3(K,y)).done;){try{_e=u_(_i.value)}catch(g_){S2(y,"throw",g_)}if("object"==typeof _e&&_e&&hM(v1,_e))return _e}return new O2(!1)},B9=pL,BG=t1,vU=gO.set,hS=p5,LV=Q3,y5=V3,kS=function(s){try{return{error:!1,value:s()}}catch(p){return{error:!0,value:p}}},W3=NV,E5=PT,I5=bP,vY=mY,uR=gM,vL=TT,FG=E1("species"),BP="Promise",vM=E5.getterFor(BP),jG=E5.set,b5=E5.getterFor(BP),UP=_M&&_M.prototype,FP=_M,$R=UP,C5=aN.TypeError,VG=aN.document,GG=aN.process,yL=y5.f,U9=yL,UO=!!(VG&&VG.createEvent&&aN.dispatchEvent),MV=v5(aN.PromiseRejectionEvent),BV="unhandledrejection",F9=!1,mO=I5(BP,function(){var s=_U(FP),p=s!==String(FP);if(!p&&66===vL)return!0;if(vL>=51&&/native code/.test(s))return!1;var A=new FP(function(w){w(1)}),y=function(w){w(function(){},function(){})};return(A.constructor={})[FG]=y,!(F9=A.then(function(){})instanceof y)||!p&&vY&&!MV}),w5=mO||!B9(function(s){FP.all(s).catch(function(){})}),QG=function(s){var p;return!(!AY(s)||!v5(p=s.then))&&p},HG=function(s,p){var A,y,w,$=p.value,j=1==p.state,_e=j?s.ok:s.fail,K=s.resolve,_i=s.reject,_o=s.domain;try{_e?(j||(2===p.rejection&&G9(p),p.rejection=1),!0===_e?A=$:(_o&&_o.enter(),A=_e($),_o&&(_o.exit(),w=!0)),A===s.promise?_i(C5("Promise-chain cycle")):(y=QG(A))?MP(y,A,K,_i):K(A)):_i($)}catch(_u){_o&&!w&&_o.exit(),_i(_u)}},j9=function(s,p){s.notified||(s.notified=!0,hS(function(){for(var A,y=s.reactions;A=y.get();)HG(A,s);s.notified=!1,p&&!s.rejection&&V9(s)}))},UV=function(s,p,A){var y,w;UO?((y=VG.createEvent("Event")).promise=p,y.reason=A,y.initEvent(s,!1,!0),aN.dispatchEvent(y)):y={promise:p,reason:A},!MV&&(w=aN["on"+s])?w(y):s===BV&&function(s,p){var A=xG.console;A&&A.error&&(1==arguments.length?A.error(s):A.error(s,p))}("Unhandled promise rejection",A)},V9=function(s){MP(vU,aN,function(){var p,A=s.facade,y=s.value;if(yY(s)&&(p=kS(function(){uR?GG.emit("unhandledRejection",y,A):UV(BV,A,y)}),s.rejection=uR||yY(s)?2:1,p.error))throw p.value})},yY=function(s){return 1!==s.rejection&&!s.parent},G9=function(s){MP(vU,aN,function(){var p=s.facade;uR?GG.emit("rejectionHandled",p):UV("rejectionhandled",p,s.value)})},HN=function(s,p,A){return function(y){s(p,y,A)}},Nf=function(s,p,A){s.done||(s.done=!0,A&&(s=A),s.value=p,s.state=2,j9(s,!0))},_c=function(s,p,A){if(!s.done){s.done=!0,A&&(s=A);try{if(s.facade===p)throw C5("Promise can't be resolved itself");var y=QG(p);y?hS(function(){var w={done:!1};try{MP(y,p,HN(_c,w,s),HN(Nf,w,s))}catch($){Nf(w,$,s)}}):(s.value=p,s.state=1,j9(s,!1))}catch(w){Nf({done:!1},w,s)}}};if(mO&&($R=(FP=function(s){_Y(this,$R),xV(s),MP(H3,this);var p=vM(this);try{s(HN(_c,p),HN(Nf,p))}catch(A){Nf(p,A)}}).prototype,(H3=function(s){jG(this,{type:BP,done:!1,notified:!1,parent:!1,reactions:new W3,rejection:!1,state:0,value:void 0})}).prototype=iS($R,{then:function(s,p){var A=b5(this),y=yL(BG(this,FP));return A.parent=!0,y.ok=!v5(s)||s,y.fail=v5(p)&&p,y.domain=uR?GG.domain:void 0,0==A.state?A.reactions.add(y):hS(function(){HG(y,A)}),y.promise},catch:function(s){return this.then(void 0,s)}}),m5=function(){var s=new H3,p=vM(s);this.promise=s,this.resolve=HN(_c,p),this.reject=HN(Nf,p)},y5.f=yL=function(s){return s===FP||s===LG?new m5(s):U9(s)},v5(_M)&&UP!==Object.prototype)){mU=UP.then,F9||(JR(UP,"then",function(s,p){var A=this;return new FP(function(y,w){MP(mU,A,y,w)}).then(s,p)},{unsafe:!0}),JR(UP,"catch",$R.catch,{unsafe:!0}));try{delete UP.constructor}catch(s){}kV&&kV(UP,$R)}_5({global:!0,wrap:!0,forced:mO},{Promise:FP}),PV(FP,BP,!1),AU(BP),LG=q3(BP),_5({target:BP,stat:!0,forced:mO},{reject:function(s){var p=yL(this);return MP(p.reject,void 0,s),p.promise}}),_5({target:BP,stat:!0,forced:mO},{resolve:function(s){return LV(this,s)}}),_5({target:BP,stat:!0,forced:w5},{all:function(s){var p=this,A=yL(p),y=A.resolve,w=A.reject,$=kS(function(){var j=xV(p.resolve),_e=[],K=0,_i=1;MG(s,function(_o){var _u=K++,ch=!1;_i++,MP(j,p,_o).then(function(_f){ch||(ch=!0,_e[_u]=_f,--_i||y(_e))},w)}),--_i||y(_e)});return $.error&&w($.value),A.promise},race:function(s){var p=this,A=yL(p),y=A.reject,w=kS(function(){var $=xV(p.resolve);MG(s,function(j){MP($,p,j).then(A.resolve,y)})});return w.error&&y(w.value),A.promise}});var ah=hI,m_=zR,O_=G_,s0=ga,N0=_r.Array,tI=_T("JSON","stringify"),AI=O_(/./.exec),VI=O_("".charAt),GI=O_("".charCodeAt),oS=O_("".replace),FO=O_(1..toString),K3=/[\uD800-\uDFFF]/g,FV=/^[\uD800-\uDBFF]$/,qG=/^[\uDC00-\uDFFF]$/,yU=function(s,p,A){var y=VI(A,p-1),w=VI(A,p+1);return AI(FV,s)&&!AI(qG,w)||AI(qG,s)&&!AI(FV,y)?"\\u"+FO(GI(s,0),16):s},T5=s0(function(){return'"\\udf06\\ud834"'!==tI("\udf06\ud834")||'"\\udead"'!==tI("\udead")});tI&&ah({target:"JSON",stat:!0,forced:T5},{stringify:function(s,p,A){for(var y=0,w=arguments.length,$=N0(w);y<w;y++)$[y]=arguments[y];var j=m_(tI,null,$);return"string"==typeof j?oS(j,K3,yU):j}});var OT=function(s){try{return!!s()}catch(p){return!0}},S5=!OT(function(){var s=function(){}.bind();return"function"!=typeof s||s.hasOwnProperty("prototype")}),qT=S5,jV=Function.prototype,z3=jV.call,R5=qT&&jV.bind.bind(z3,z3),rT=qT?function(s){return s&&R5(s)}:function(s){return s&&function(){return z3.apply(s,arguments)}},M2=rT({}.isPrototypeOf),KG=function(s){return s&&s.Math==Math&&s},n1=KG("object"==typeof globalThis&&globalThis)||KG("object"==typeof window&&window)||KG("object"==typeof self&&self)||KG("object"==typeof k&&k)||function(){return this}()||Function("return this")(),zG=Function.prototype,EY=zG.apply,Q9=zG.call,IY="object"==typeof Reflect&&Reflect.apply||(S5?Q9.bind(EY):function(){return Q9.apply(EY,arguments)}),MT=function(s){return"function"==typeof s},jP={},B2=!OT(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),YG=Function.prototype.call,AO=S5?YG.bind(YG):function(){return YG.apply(YG,arguments)},H9={},bY={}.propertyIsEnumerable,q9=Object.getOwnPropertyDescriptor,HX=q9&&!bY.call({1:2},1);H9.f=HX?function(s){var p=q9(this,s);return!!p&&p.enumerable}:bY;var yM,JG,U2=function(s,p){return{enumerable:!(1&s),configurable:!(2&s),writable:!(4&s),value:p}},$G=rT,qX=$G({}.toString),W9=$G("".slice),VV=function(s){return W9(qX(s),8,-1)},C0=OT,KX=VV,ZG=n1.Object,EU=rT("".split),K9=C0(function(){return!ZG("z").propertyIsEnumerable(0)})?function(s){return"String"==KX(s)?EU(s,""):ZG(s)}:ZG,zX=n1.TypeError,GV=function(s){if(null==s)throw zX("Can't call method on "+s);return s},YX=K9,coe=GV,EM=function(s){return YX(coe(s))},VP=MT,F2=function(s){return"object"==typeof s?null!==s:VP(s)},IU={},CY=IU,qN=n1,JX=MT,z9=function(s){return JX(s)?s:void 0},EL=function(s,p){return arguments.length<2?z9(CY[s])||z9(qN[s]):CY[s]&&CY[s][p]||qN[s]&&qN[s][p]},IL=EL("navigator","userAgent")||"",XG=IL,e7=n1.process,t7=n1.Deno,wY=e7&&e7.versions||t7&&t7.version,Y9=wY&&wY.v8;Y9&&(JG=(yM=Y9.split("."))[0]>0&&yM[0]<4?1:+(yM[0]+yM[1])),!JG&&XG&&(!(yM=XG.match(/Edge\/(\d+)/))||yM[1]>=74)&&(yM=XG.match(/Chrome\/(\d+)/))&&(JG=+yM[1]);var r1=JG,J9=r1,$9=!!Object.getOwnPropertySymbols&&!OT(function(){var s=Symbol();return!String(s)||!(Object(s)instanceof Symbol)||!Symbol.sham&&J9&&J9<41}),Z9=$9&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,IM=EL,uoe=MT,Ede=M2,Y3=n1.Object,X9=Z9?function(s){return"symbol"==typeof s}:function(s){var p=IM("Symbol");return uoe(p)&&Ede(p.prototype,Y3(s))},loe=n1.String,QV=function(s){try{return loe(s)}catch(p){return"Object"}},Ide=MT,SY=QV,ZX=n1.TypeError,WN=function(s){if(Ide(s))return s;throw ZX(SY(s)+" is not a function")},n7=WN,r7=function(s,p){var A=s[p];return null==A?void 0:n7(A)},O5=AO,i7=MT,doe=F2,bde=n1.TypeError,eH={exports:{}},XX=n1,Cde=Object.defineProperty,foe="__core-js_shared__",HV=n1[foe]||function(s,p){try{Cde(XX,s,{value:p,configurable:!0,writable:!0})}catch(A){XX[s]=p}return p}(foe,{}),wde=HV;(eH.exports=function(s,p){return wde[s]||(wde[s]=void 0!==p?p:{})})("versions",[]).push({version:"3.20.3",mode:"pure",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"});var poe=GV,goe=n1.Object,bM=function(s){return goe(poe(s))},tH=bM,Xme=rT({}.hasOwnProperty),cN=Object.hasOwn||function(s,p){return Xme(tH(s),p)},eee=rT,tee=0,eAe=Math.random(),moe=eee(1..toString),Aoe=function(s){return"Symbol("+(void 0===s?"":s)+")_"+moe(++tee+eAe,36)},tAe=n1,Tde=cN,D5=Aoe,o7=$9,_oe=Z9,s7=(0,eH.exports)("wks"),J3=tAe.Symbol,nH=J3&&J3.for,RY=_oe?J3:J3&&J3.withoutSetter||D5,PS=function(s){if(!Tde(s7,s)||!o7&&"string"!=typeof s7[s]){var p="Symbol."+s;s7[s]=o7&&Tde(J3,s)?J3[s]:_oe&&nH?nH(p):RY(p)}return s7[s]},$3=AO,OY=F2,nee=X9,DY=r7,yoe=n1.TypeError,Eoe=PS("toPrimitive"),a7=function(s,p){if(!OY(s)||nee(s))return s;var A,y=DY(s,Eoe);if(y){if(void 0===p&&(p="default"),A=$3(y,s,p),!OY(A)||nee(A))return A;throw yoe("Can't convert object to primitive value")}return void 0===p&&(p="number"),function(s,p){var A,y;if("string"===p&&i7(A=s.toString)&&!doe(y=O5(A,s))||i7(A=s.valueOf)&&!doe(y=O5(A,s))||"string"!==p&&i7(A=s.toString)&&!doe(y=O5(A,s)))return y;throw bde("Can't convert object to primitive value")}(s,p)},qV=X9,c7=function(s){var p=a7(s,"string");return qV(p)?p:p+""},WV=F2,N5=n1.document,KV=WV(N5)&&WV(N5.createElement),zV=function(s){return KV?N5.createElement(s):{}},NY=zV,u7=!B2&&!OT(function(){return 7!=Object.defineProperty(NY("div"),"a",{get:function(){return 7}}).a}),PY=AO,iee=H9,rH=U2,Ioe=EM,oee=c7,xY=cN,see=u7,LY=Object.getOwnPropertyDescriptor;jP.f=B2?LY:function(s,p){if(s=Ioe(s),p=oee(p),see)try{return LY(s,p)}catch(A){}if(xY(s,p))return rH(!PY(iee.f,s,p),s[p])};var boe=OT,Coe=MT,woe=/#|\.prototype\./,l7=function(s,p){var A=iH[j2(s)];return A==Sde||A!=aee&&(Coe(p)?boe(p):!!p)},j2=l7.normalize=function(s){return String(s).replace(woe,".").toLowerCase()},iH=l7.data={},aee=l7.NATIVE="N",Sde=l7.POLYFILL="P",Toe=l7,oH=WN,Rde=S5,Soe=rT(rT.bind),CM=function(s,p){return oH(s),void 0===p?s:Rde?Soe(s,p):function(){return s.apply(p,arguments)}},GP={},cee=B2&&OT(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),MY=F2,BY=n1.String,uee=n1.TypeError,KN=function(s){if(MY(s))return s;throw uee(BY(s)+" is not an object")},Ooe=u7,H1=KN,lR=c7,bU=n1.TypeError,k5=Object.defineProperty,bL=Object.getOwnPropertyDescriptor;GP.f=B2?cee?function(s,p,A){if(H1(s),p=lR(p),H1(A),"function"==typeof s&&"prototype"===p&&"value"in A&&"writable"in A&&!A.writable){var y=bL(s,p);y&&y.writable&&(s[p]=A.value,A={configurable:"configurable"in A?A.configurable:y.configurable,enumerable:"enumerable"in A?A.enumerable:y.enumerable,writable:!1})}return k5(s,p,A)}:k5:function(s,p,A){if(H1(s),p=lR(p),H1(A),Ooe)try{return k5(s,p,A)}catch(y){}if("get"in A||"set"in A)throw bU("Accessors not supported");return"value"in A&&(s[p]=A.value),s};var dee=GP,hee=U2,CU=B2?function(s,p,A){return dee.f(s,p,hee(1,A))}:function(s,p,A){return s[p]=A,s},P5=n1,Doe=IY,Noe=rT,d7=MT,wU=jP.f,UY=Toe,V2=IU,aH=CM,Z3=CU,h7=cN,YV=function(s){var p=function(A,y,w){if(this instanceof p){switch(arguments.length){case 0:return new s;case 1:return new s(A);case 2:return new s(A,y)}return new s(A,y,w)}return Doe(s,this,arguments)};return p.prototype=s.prototype,p},xS=function(s,p){var A,y,w,$,j,_e,K,_i,_o=s.target,_u=s.global,ch=s.stat,_f=s.proto,o_=_u?P5:ch?P5[_o]:(P5[_o]||{}).prototype,i_=_u?V2:V2[_o]||Z3(V2,_o,{})[_o],u_=i_.prototype;for(w in p)A=!UY(_u?w:_o+(ch?".":"#")+w,s.forced)&&o_&&h7(o_,w),j=i_[w],A&&(_e=s.noTargetGet?(_i=wU(o_,w))&&_i.value:o_[w]),$=A&&_e?_e:p[w],A&&typeof j==typeof $||(K=s.bind&&A?aH($,P5):s.wrap&&A?YV($):_f&&d7($)?Noe($):$,(s.sham||$&&$.sham||j&&j.sham)&&Z3(K,"sham",!0),Z3(i_,w,K),_f&&(h7(V2,y=_o+"Prototype")||Z3(V2,y,{}),Z3(V2[y],w,$),s.real&&u_&&!u_[w]&&Z3(u_,w,$)))},koe=Math.ceil,ZR=Math.floor,X3=function(s){var p=+s;return p!=p||0===p?0:(p>0?ZR:koe)(p)},cH=X3,CL=Math.min,wM=function(s){return function(s){return s>0?CL(cH(s),9007199254740991):0}(s.length)},HP=WN,uH=bM,TU=K9,TM=wM,JV=n1.TypeError,lH=function(s){return function(p,A,y,w){HP(A);var $=uH(p),j=TU($),_e=TM($),K=s?_e-1:0,_i=s?-1:1;if(y<2)for(;;){if(K in j){w=j[K],K+=_i;break}if(K+=_i,s?K<0:_e<=K)throw JV("Reduce of empty array with no initial value")}for(;s?K>=0:_e>K;K+=_i)K in j&&(w=A(w,j[K],K,$));return w}},$V={left:lH(!1),right:lH(!0)},f7=OT,e4=function(s,p){var A=[][s];return!!A&&f7(function(){A.call(null,p||function(){throw 1},1)})},JS="process"==VV(n1.process),dH=$V.left,FY=r1,fee=JS;xS({target:"Array",proto:!0,forced:!e4("reduce")||!fee&&FY>79&&FY<83},{reduce:function(s){var p=arguments.length;return dH(this,s,p,p>1?arguments[1]:void 0)}});var pee=IU,t4=function(s){return pee[s+"Prototype"]},hH=t4("Array").reduce,jY=M2,fH=hH,SU=Array.prototype,x5=function(s){var p=s.reduce;return s===SU||jY(SU,s)&&p===SU.reduce?fH:p},qP=x5,Poe=aR,xoe=_r.String,lN=function(s){if("Symbol"===Poe(s))throw TypeError("Cannot convert a Symbol value to a string");return xoe(s)},pH=wS,VY=function(){var s=pH(this),p="";return s.global&&(p+="g"),s.ignoreCase&&(p+="i"),s.multiline&&(p+="m"),s.dotAll&&(p+="s"),s.unicode&&(p+="u"),s.sticky&&(p+="y"),p},gH=ga,mH=_r.RegExp,G2=gH(function(){var s=mH("a","y");return s.lastIndex=2,null!=s.exec("abcd")}),AH=G2||gH(function(){return!mH("a","y").sticky}),_H={BROKEN_CARET:G2||gH(function(){var s=mH("^r","gy");return s.lastIndex=2,null!=s.exec("str")}),MISSED_STICKY:AH,UNSUPPORTED_Y:G2},p7={},vH=IP,GY=O3,mee=yT,Aee=wS,_ee=_1,yH=Object.keys||function(s){return vH(s,GY)};p7.f=_l&&!_j?Object.defineProperties:function(s,p){Aee(s);for(var A,y=_ee(p),w=yH(p),$=w.length,j=0;$>j;)mee.f(s,A=w[j++],y[A]);return s};var ZV,Moe=wS,Ode=p7,vee=O3,HY=eU,Boe=cR,yee=tL,EH=AP("IE_PROTO"),qY=function(){},Q2=function(s){return"<script>"+s+"<\/script>"},Uoe=function(s){s.write(Q2("")),s.close();var p=s.parentWindow.Object;return s=null,p},WY=function(){try{ZV=new ActiveXObject("htmlfile")}catch(y){}var s,p;WY="undefined"!=typeof document?document.domain&&ZV?Uoe(ZV):((p=yee("iframe")).style.display="none",Boe.appendChild(p),p.src=String("javascript:"),(s=p.contentWindow.document).open(),s.write(Q2("document.F=Object")),s.close(),s.F):Uoe(ZV);for(var A=vee.length;A--;)delete WY.prototype[vee[A]];return WY()};HY[EH]=!0;var s,p,L5=Object.create||function(s,p){var A;return null!==s?(qY.prototype=Moe(s),A=new qY,qY.prototype=null,A[EH]=s):A=WY(),void 0===p?A:Ode.f(A,p)},Iee=_r.RegExp,IH=ga(function(){var s=Iee(".","s");return!(s.dotAll&&s.exec("\n")&&"s"===s.flags)}),bee=_r.RegExp,bH=ga(function(){var s=bee("(?<a>b)","g");return"b"!==s.exec("b").groups.a||"bc"!=="b".replace(s,"$<a>c")}),XV=r_,H2=G_,KY=lN,joe=VY,Voe=_H,e8=L5,Cee=PT.get,wH=IH,t8=bH,Goe=(0,G0.exports)("native-string-replace",String.prototype.replace),n4=RegExp.prototype.exec,g7=n4,wee=H2("".charAt),zY=H2("".indexOf),wL=H2("".replace),M5=H2("".slice),IR=(p=/b*/g,XV(n4,s=/a/,"a"),XV(n4,p,"a"),0!==s.lastIndex||0!==p.lastIndex),RU=Voe.BROKEN_CARET,B5=void 0!==/()??/.exec("")[1];(IR||B5||RU||wH||t8)&&(g7=function(s){var p,A,y,w,$,j,_e,K=this,_i=Cee(K),_o=KY(s),_u=_i.raw;if(_u)return _u.lastIndex=K.lastIndex,p=XV(g7,_u,_o),K.lastIndex=_u.lastIndex,p;var ch=_i.groups,_f=RU&&K.sticky,o_=XV(joe,K),i_=K.source,u_=0,g_=_o;if(_f&&(o_=wL(o_,"y",""),-1===zY(o_,"g")&&(o_+="g"),g_=M5(_o,K.lastIndex),K.lastIndex>0&&(!K.multiline||K.multiline&&"\n"!==wee(_o,K.lastIndex-1))&&(i_="(?: "+i_+")",g_=" "+g_,u_++),A=new RegExp("^(?:"+i_+")",o_)),B5&&(A=new RegExp("^"+i_+"$(?!\\s)",o_)),IR&&(y=K.lastIndex),w=XV(n4,_f?A:K,g_),_f?w?(w.input=M5(w.input,u_),w[0]=M5(w[0],u_),w.index=K.lastIndex,K.lastIndex+=w[0].length):K.lastIndex=0:IR&&w&&(K.lastIndex=K.global?w.index+w[0].length:y),B5&&w&&w.length>1&&XV(Goe,w[0],A,function(){for($=1;$<arguments.length-2;$++)void 0===arguments[$]&&(w[$]=void 0)}),w&&ch)for(w.groups=j=e8(null),$=0;$<ch.length;$++)j[(_e=ch[$])[0]]=w[_e[1]];return w});var jO=g7;hI({target:"RegExp",proto:!0,forced:/./.exec!==jO},{exec:jO});var YY=L5,U5=yT,OU=E1("unscopables"),DU=Array.prototype;null==DU[OU]&&U5.f(DU,OU,{configurable:!0,value:YY(null)});var dN,r4,i4,z1=!ga(function(){function s(){}return s.prototype.constructor=null,Object.getPrototypeOf(new s)!==s.prototype}),U1=_r,y1=X1,NU=UI,ET=ON,TH=z1,JY=AP("IE_PROTO"),o4=U1.Object,$Y=o4.prototype,IT=TH?o4.getPrototypeOf:function(s){var p=ET(s);if(y1(p,JY))return p[JY];var A=p.constructor;return NU(A)&&p instanceof A?A.prototype:p instanceof o4?$Y:null},S1=ga,VO=UI,Tee=IT,SH=eS.exports,zN=E1("iterator"),See=!1;[].keys&&("next"in(i4=[].keys())?(r4=Tee(Tee(i4)))!==Object.prototype&&(dN=r4):See=!0),(null==dN||S1(function(){var s={};return dN[zN].call(s)!==s}))&&(dN={}),VO(dN[zN])||SH(dN,zN,function(){return this});var RH={IteratorPrototype:dN,BUGGY_SAFARI_ITERATORS:See},Qoe=RH.IteratorPrototype,Ree=L5,s4=V_,ZY=uL,n8=NP,Hoe=function(){return this},qoe=hI,Woe=r_,XY=UI,tJ=IT,F5=RI,F1=uL,nJ=TS,r8=eS.exports,rJ=NP,kU=sL.PROPER,OH=sL.CONFIGURABLE,vO=RH.IteratorPrototype,DH=RH.BUGGY_SAFARI_ITERATORS,bR=E1("iterator"),a4="values",j5="entries",Koe=function(){return this},iJ=_1,NH=function(s){DU[OU][s]=!0},oJ=NP,Nee=yT.f,Pee=_l,xee="Array Iterator",Lee=PT.set,DT=PT.getterFor(xee),sJ=function(s,p,A,y,w,$,j){!function(s,p,A,y){var w=p+" Iterator";s.prototype=Ree(Qoe,{next:s4(+!y,A)}),ZY(s,w,!1),n8[w]=Hoe}(A,p,y);var _e,K,_i,_o=function(g_){if(g_===w&&i_)return i_;if(!DH&&g_ in _f)return _f[g_];switch(g_){case"keys":case a4:case j5:return function(){return new A(this,g_)}}return function(){return new A(this)}},_u=p+" Iterator",ch=!1,_f=s.prototype,o_=_f[bR]||_f["@@iterator"]||w&&_f[w],i_=!DH&&o_||_o(w),u_="Array"==p&&_f.entries||o_;if(u_&&(_e=tJ(u_.call(new s)))!==Object.prototype&&_e.next&&(tJ(_e)!==vO&&(F5?F5(_e,vO):XY(_e[bR])||r8(_e,bR,Koe)),F1(_e,_u,!0)),kU&&w==a4&&o_&&o_.name!==a4&&(OH?nJ(_f,"name",a4):(ch=!0,i_=function(){return Woe(o_,this)})),w)if(K={values:_o(a4),keys:$?i_:_o("keys"),entries:_o(j5)},j)for(_i in K)(DH||ch||!(_i in _f))&&r8(_f,_i,K[_i]);else qoe({target:p,proto:!0,forced:DH||ch},K);return _f[bR]!==i_&&r8(_f,bR,i_,{name:w}),rJ[p]=i_,K}(Array,"Array",function(s,p){Lee(this,{type:xee,target:iJ(s),index:0,kind:p})},function(){var s=DT(this),p=s.target,A=s.kind,y=s.index++;return!p||y>=p.length?(s.target=void 0,{value:void 0,done:!0}):"keys"==A?{value:y,done:!1}:"values"==A?{value:p[y],done:!1}:{value:[y,p[y]],done:!1}},"values"),zoe=oJ.Arguments=oJ.Array;if(NH("keys"),NH("values"),NH("entries"),Pee&&"values"!==zoe.name)try{Nee(zoe,"name",{value:"values"})}catch(s){}var c4=tL("span").classList,kH=c4&&c4.constructor&&c4.constructor.prototype,YN=_r,G5={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},m1=kH===Object.prototype?void 0:kH,Q5=sJ,H5=TS,A7=E1,bT=A7("iterator"),i8=A7("toStringTag"),Mee=Q5.values,PH=function(s,p){if(s){if(s[bT]!==Mee)try{H5(s,bT,Mee)}catch(y){s[bT]=Mee}if(s[i8]||H5(s,i8,p),G5[p])for(var A in Q5)if(s[A]!==Q5[A])try{H5(s,A,Q5[A])}catch(y){s[A]=Q5[A]}}};for(var TL in G5)PH(YN[TL]&&YN[TL].prototype,TL);PH(m1,"DOMTokenList");var o8=UI,aJ=sT,xH=RI,s8=function(s,p,A){var y,w;return xH&&o8(y=p.constructor)&&y!==A&&aJ(w=y.prototype)&&w!==A.prototype&&xH(s,w),s},cJ=lN,a8=function(s,p){return void 0===s?arguments.length<2?"":p:cJ(s)},LH=sT,q5=TS,_7=G_("".replace),c8=String(Error("zxcasd").stack),uJ=/\n\s*at [^:]*:[^\n]*/,v7=uJ.test(c8),u4=function(s,p){if(v7&&"string"==typeof s)for(;p--;)s=_7(s,uJ,"");return s},Yoe=V_,MH=!ga(function(){var s=Error("a");return!("stack"in s)||(Object.defineProperty(s,"stack",Yoe(1,7)),7!==s.stack)}),Bee=_T,Uee=X1,y7=TS,BH=NT,lJ=RI,E7=pV,Fee=s8,I7=a8,dJ=function(s,p){LH(p)&&"cause"in p&&q5(s,"cause",p.cause)},hJ=u4,b7=MH,Joe=hI,q2=zR,W5=function(s,p,A,y){var w=y?2:1,$=s.split("."),j=$[$.length-1],_e=Bee.apply(null,$);if(_e){var K=_e.prototype;if(Uee(K,"cause")&&delete K.cause,!A)return _e;var _i=Bee("Error"),_o=p(function(_u,ch){var _f=I7(y?ch:_u,void 0),o_=y?new _e(_u):new _e;return void 0!==_f&&y7(o_,"message",_f),b7&&y7(o_,"stack",hJ(o_.stack,2)),this&&BH(K,this)&&Fee(o_,this,_o),arguments.length>w&&dJ(o_,arguments[w]),o_});_o.prototype=K,"Error"!==j&&(lJ?lJ(_o,_i):E7(_o,_i,{name:!0})),E7(_o,_e);try{K.name!==j&&y7(K,"name",j),K.constructor=_o}catch(_u){}return _o}},FH=_r.WebAssembly,LS=7!==Error("e",{cause:7}).cause,l4=function(s,p){var A={};A[s]=W5(s,p,LS),Joe({global:!0,forced:LS},A)},jH=function(s,p){if(FH&&FH[s]){var A={};A[s]=W5("WebAssembly."+s,p,LS),Joe({target:"WebAssembly",stat:!0,forced:LS},A)}};l4("Error",function(s){return function(p){return q2(s,this,arguments)}}),l4("EvalError",function(s){return function(p){return q2(s,this,arguments)}}),l4("RangeError",function(s){return function(p){return q2(s,this,arguments)}}),l4("ReferenceError",function(s){return function(p){return q2(s,this,arguments)}}),l4("SyntaxError",function(s){return function(p){return q2(s,this,arguments)}}),l4("TypeError",function(s){return function(p){return q2(s,this,arguments)}}),l4("URIError",function(s){return function(p){return q2(s,this,arguments)}}),jH("CompileError",function(s){return function(p){return q2(s,this,arguments)}}),jH("LinkError",function(s){return function(p){return q2(s,this,arguments)}}),jH("RuntimeError",function(s){return function(p){return q2(s,this,arguments)}});let jee=!0,fJ=!0;function C7(s,p,A){const y=s.match(p);return y&&y.length>=A&&parseInt(y[A],10)}function XR(s,p,A){if(!s.RTCPeerConnection)return;const y=s.RTCPeerConnection.prototype,w=y.addEventListener;y.addEventListener=function(j,_e){if(j!==p)return w.apply(this,arguments);const K=_i=>{const _o=A(_i);_o&&(_e.handleEvent?_e.handleEvent(_o):_e(_o))};return this._eventMap=this._eventMap||{},this._eventMap[p]||(this._eventMap[p]=new Map),this._eventMap[p].set(_e,K),w.apply(this,[j,K])};const $=y.removeEventListener;y.removeEventListener=function(j,_e){if(j!==p||!this._eventMap||!this._eventMap[p])return $.apply(this,arguments);if(!this._eventMap[p].has(_e))return $.apply(this,arguments);const K=this._eventMap[p].get(_e);return this._eventMap[p].delete(_e),0===this._eventMap[p].size&&delete this._eventMap[p],0===Object.keys(this._eventMap).length&&delete this._eventMap,$.apply(this,[j,K])},Object.defineProperty(y,"on"+p,{get(){return this["_on"+p]},set(j){this["_on"+p]&&(this.removeEventListener(p,this["_on"+p]),delete this["_on"+p]),j&&this.addEventListener(p,this["_on"+p]=j)},enumerable:!0,configurable:!0})}function VH(s){return"boolean"!=typeof s?new Error("Argument type: "+typeof s+". Please use a boolean."):(jee=s,s?"adapter.js logging disabled":"adapter.js logging enabled")}function d4(s){return"boolean"!=typeof s?new Error("Argument type: "+typeof s+". Please use a boolean."):(fJ=!s,"adapter.js deprecation warnings "+(s?"disabled":"enabled"))}function w7(){if("object"==typeof window){if(jee)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function K5(s,p){fJ&&console.warn(s+" is deprecated, please use "+p+" instead.")}function u8(s){const p={browser:null,version:null};if(void 0===s||!s.navigator)return p.browser="Not a browser.",p;const{navigator:A}=s;if(A.mozGetUserMedia)p.browser="firefox",p.version=C7(A.userAgent,/Firefox\/(\d+)\./,1);else if(A.webkitGetUserMedia||!1===s.isSecureContext&&s.webkitRTCPeerConnection&&!s.RTCIceGatherer)p.browser="chrome",p.version=C7(A.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(A.mediaDevices&&A.userAgent.match(/Edge\/(\d+).(\d+)$/))p.browser="edge",p.version=C7(A.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!s.RTCPeerConnection||!A.userAgent.match(/AppleWebKit\/(\d+)\./))return p.browser="Not a supported browser.",p;p.browser="safari",p.version=C7(A.userAgent,/AppleWebKit\/(\d+)\./,1),p.supportsUnifiedPlan=s.RTCRtpTransceiver&&"currentDirection"in s.RTCRtpTransceiver.prototype}return p}function h4(s){return"[object Object]"===Object.prototype.toString.call(s)}function f4(s){var p;return h4(s)?qP(p=Object.keys(s)).call(p,function(A,y){const w=h4(s[y]),$=w?f4(s[y]):s[y],j=w&&!Object.keys($).length;return void 0===$||j?A:Object.assign(A,{[y]:$})},{}):s}function p4(s,p,A){const y=A?"outbound-rtp":"inbound-rtp",w=new Map;if(null===p)return w;const $=[];return s.forEach(j=>{"track"===j.type&&j.trackIdentifier===p.id&&$.push(j)}),$.forEach(j=>{s.forEach(_e=>{_e.type===y&&_e.trackId===j.id&&function K(_i,_o,_u){_o&&!_u.has(_o.id)&&(_u.set(_o.id,_o),Object.keys(_o).forEach(ch=>{ch.endsWith("Id")?K(_i,_i.get(_o[ch]),_u):ch.endsWith("Ids")&&_o[ch].forEach(_f=>{K(_i,_i.get(_f),_u)})}))}(s,_e,w)})}),w}var gJ=Aoe,hN=(0,eH.exports)("keys"),GH=function(s){return hN[s]||(hN[s]=gJ(s))},Vee=!OT(function(){function s(){}return s.prototype.constructor=null,Object.getPrototypeOf(new s)!==s.prototype}),W2=n1,fN=cN,WP=MT,T7=bM,g4=Vee,QH=GH("IE_PROTO"),mJ=W2.Object,BT=mJ.prototype,K2=g4?mJ.getPrototypeOf:function(s){var p=T7(s);if(fN(p,QH))return p[QH];var A=p.constructor;return WP(A)&&p instanceof A?A.prototype:p instanceof mJ?BT:null},z5=MT,Gee=n1.String,HH=n1.TypeError,Y5=rT,AJ=KN,l8=Object.setPrototypeOf||("__proto__"in{}?function(){var s,p=!1,A={};try{(s=Y5(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(A,[]),p=A instanceof Array}catch(y){}return function(y,w){return AJ(y),function(s){if("object"==typeof s||z5(s))return s;throw HH("Can't set "+Gee(s)+" as a prototype")}(w),p?s(y,w):y.__proto__=w,y}}():void 0),xU={},_J=X3,S7=Math.max,vJ=Math.min,d8=function(s,p){var A=_J(s);return A<0?S7(A+p,0):vJ(A,p)},Qee=EM,Hee=d8,qee=wM,yJ=function(s){return function(p,A,y){var w,$=Qee(p),j=qee($),_e=Hee(y,j);if(s&&A!=A){for(;j>_e;)if((w=$[_e++])!=w)return!0}else for(;j>_e;_e++)if((s||_e in $)&&$[_e]===A)return s||_e||0;return!s&&-1}},Wee={includes:yJ(!0),indexOf:yJ(!1)},h8={},R7=cN,Kee=EM,$oe=Wee.indexOf,Zoe=h8,zee=rT([].push),Yee=function(s,p){var A,y=Kee(s),w=0,$=[];for(A in y)!R7(Zoe,A)&&R7(y,A)&&zee($,A);for(;p.length>w;)R7(y,A=p[w++])&&(~$oe($,A)||zee($,A));return $},EJ=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],qH=Yee,IJ=EJ.concat("length","prototype");xU.f=Object.getOwnPropertyNames||function(s){return qH(s,IJ)};var O7={};O7.f=Object.getOwnPropertySymbols;var WH=EL,Xoe=xU,bJ=O7,Jee=KN,$ee=rT([].concat),ese=WH("Reflect","ownKeys")||function(s){var p=Xoe.f(Jee(s)),A=bJ.f;return A?$ee(p,A(s)):p},Zee=cN,Xee=ese,CJ=jP,tse=GP,D7={},ete=Yee,tte=EJ,f8=Object.keys||function(s){return ete(s,tte)},wJ=GP,nte=KN,TJ=EM,zH=f8;D7.f=B2&&!cee?Object.defineProperties:function(s,p){nte(s);for(var A,y=TJ(p),w=zH(p),$=w.length,j=0;$>j;)wJ.f(s,A=w[j++],y[A]);return s};var p8,A4=EL("document","documentElement"),nse=KN,rse=D7,J5=EJ,Dde=h8,SJ=A4,ise=zV,RJ=GH("IE_PROTO"),k7=function(){},rte=function(s){return"<script>"+s+"<\/script>"},$I=function(s){s.write(rte("")),s.close();var p=s.parentWindow.Object;return s=null,p},P7=function(){try{p8=new ActiveXObject("htmlfile")}catch(y){}var s,p;P7="undefined"!=typeof document?document.domain&&p8?$I(p8):((p=ise("iframe")).style.display="none",SJ.appendChild(p),p.src=String("javascript:"),(s=p.contentWindow.document).open(),s.write(rte("document.F=Object")),s.close(),s.F):$I(p8);for(var A=J5.length;A--;)delete P7.prototype[J5[A]];return P7()};Dde[RJ]=!0;var _4=Object.create||function(s,p){var A;return null!==s?(k7.prototype=nse(s),A=new k7,k7.prototype=null,A[RJ]=s):A=P7(),void 0===p?A:rse.f(A,p)},ite=rT("".replace),YH=String(Error("zxcasd").stack),ote=/\n\s*at [^:]*:[^\n]*/,JH=ote.test(YH),g8=F2,fS=CU,x7={},ste=x7,ate=PS("iterator"),v4=Array.prototype,$H=function(s){return void 0!==s&&(ste.Array===s||v4[ate]===s)},ZH={};ZH[PS("toStringTag")]="z";var SL="[object z]"===String(ZH),L7=n1,XH=SL,ose=MT,_q=VV,M7=PS("toStringTag"),cte=L7.Object,OJ="Arguments"==_q(function(){return arguments}()),LU=XH?_q:function(s){var p,A,y;return void 0===s?"Undefined":null===s?"Null":"string"==typeof(A=function(w,$){try{return w[$]}catch(j){}}(p=cte(s),M7))?A:OJ?_q(p):"Object"==(y=_q(p))&&ose(p.callee)?"Arguments":y},RL=LU,$5=r7,ute=x7,lte=PS("iterator"),eW=function(s){if(null!=s)return $5(s,lte)||$5(s,"@@iterator")||ute[RL(s)]},Z5=AO,B7=WN,sse=KN,dte=QV,tW=eW,hte=n1.TypeError,MU=function(s,p){var A=arguments.length<2?tW(s):p;if(B7(A))return sse(Z5(A,s));throw hte(dte(s)+" is not iterable")},DJ=AO,NJ=KN,kJ=r7,U7=function(s,p,A){var y,w;NJ(s);try{if(!(y=kJ(s,"return"))){if("throw"===p)throw A;return A}y=DJ(y,s)}catch($){w=!0,y=$}if("throw"===p)throw A;if(w)throw y;return NJ(y),A},nW=CM,fte=AO,pte=KN,gte=QV,Nde=$H,m8=wM,F7=M2,ase=MU,cse=eW,j7=U7,X5=n1.TypeError,rW=function(s,p){this.stopped=s,this.result=p},PJ=rW.prototype,iW=function(s,p,A){var y,w,$,j,_e,K,_i,_u=!(!A||!A.AS_ENTRIES),ch=!(!A||!A.IS_ITERATOR),_f=!(!A||!A.INTERRUPTED),o_=nW(p,A&&A.that),i_=function(g_){return y&&j7(y,"normal",g_),new rW(!0,g_)},u_=function(g_){return _u?(pte(g_),_f?o_(g_[0],g_[1],i_):o_(g_[0],g_[1])):_f?o_(g_,i_):o_(g_)};if(ch)y=s;else{if(!(w=cse(s)))throw X5(gte(s)+" is not iterable");if(Nde(w)){for($=0,j=m8(s);j>$;$++)if((_e=u_(s[$]))&&F7(PJ,_e))return _e;return new rW(!1)}y=ase(s,w)}for(K=y.next;!(_i=fte(K,y)).done;){try{_e=u_(_i.value)}catch(g_){j7(y,"throw",g_)}if("object"==typeof _e&&_e&&F7(PJ,_e))return _e}return new rW(!1)},use=LU,mte=n1.String,OL=function(s){if("Symbol"===use(s))throw TypeError("Cannot convert a Symbol value to a string");return mte(s)},xJ=OL,LJ=U2,BU=!OT(function(){var s=Error("a");return!("stack"in s)||(Object.defineProperty(s,"stack",LJ(1,7)),7!==s.stack)}),e6=xS,oW=n1,Ate=M2,_te=K2,t6=l8,vte=_4,SM=CU,V7=U2,yte=function(s,p){if(JH&&"string"==typeof s)for(;p--;)s=ite(s,ote,"");return s},Ete=function(s,p){g8(p)&&"cause"in p&&fS(s,"cause",p.cause)},lse=iW,BJ=function(s,p){return void 0===s?arguments.length<2?"":p:xJ(s)},sW=BU,aW=PS("toStringTag"),cW=oW.Error,A8=[].push,JN=function(s,p){var A,y=arguments.length>2?arguments[2]:void 0,w=Ate(n6,this);t6?A=t6(new cW,w?_te(this):n6):(A=w?this:vte(n6),SM(A,aW,"Error")),void 0!==p&&SM(A,"message",BJ(p)),sW&&SM(A,"stack",yte(A.stack,1)),Ete(A,y);var $=[];return lse(s,A8,{that:$}),SM(A,"errors",$),A};t6?t6(JN,cW):function(s,p,A){for(var y=Xee(p),w=tse.f,$=CJ.f,j=0;j<y.length;j++){var _e=y[j];Zee(s,_e)||A&&Zee(A,_e)||w(s,_e,$(p,_e))}}(JN,cW,{name:!0});var n6=JN.prototype=vte(cW.prototype,{constructor:V7(1,JN),message:V7(1,""),name:V7(1,"AggregateError")});e6({global:!0},{AggregateError:JN});var dse=MT,uW=HV,UJ=rT(Function.toString);dse(uW.inspectSource)||(uW.inspectSource=function(s){return UJ(s)});var y4,UU,lW,pN=uW.inspectSource,hse=pN,G7=n1.WeakMap,dW=MT(G7)&&/native code/.test(hse(G7)),hW=rT,fse=F2,fW=CU,Q7=cN,jJ=GH,Ite=h8,_8="Object already initialized",v8=n1.TypeError;if(dW||HV.state){var E4=HV.state||(HV.state=new(0,n1.WeakMap)),VJ=hW(E4.get),y8=hW(E4.has),pse=hW(E4.set);y4=function(s,p){if(y8(E4,s))throw new v8(_8);return p.facade=s,pse(E4,s,p),p},UU=function(s){return VJ(E4,s)||{}},lW=function(s){return y8(E4,s)}}else{var FU=jJ("state");Ite[FU]=!0,y4=function(s,p){if(Q7(s,FU))throw new v8(_8);return p.facade=s,fW(s,FU,p),p},UU=function(s){return Q7(s,FU)?s[FU]:{}},lW=function(s){return Q7(s,FU)}}var E8,Cte,H7,r6={set:y4,get:UU,has:lW,enforce:function(s){return lW(s)?UU(s):y4(s,{})},getterFor:function(s){return function(p){var A;if(!fse(p)||(A=UU(p)).type!==s)throw v8("Incompatible receiver, "+s+" required");return A}}},I4=B2,wte=Function.prototype,Tte=I4&&Object.getOwnPropertyDescriptor,W7=cN(wte,"name"),Ste={EXISTS:W7,PROPER:W7&&"something"===function(){}.name,CONFIGURABLE:W7&&(!I4||I4&&Tte(wte,"name").configurable)},I8=CU,Y2=function(s,p,A,y){y&&y.enumerable?s[p]=A:I8(s,p,A)},gse=OT,gW=MT,K7=_4,mW=K2,jU=Y2,i6=PS("iterator"),GJ=!1;[].keys&&("next"in(H7=[].keys())?(Cte=mW(mW(H7)))!==Object.prototype&&(E8=Cte):GJ=!0);var QJ=null==E8||gse(function(){var s={};return E8[i6].call(s)!==s});gW((E8=QJ?{}:K7(E8))[i6])||jU(E8,i6,function(){return this});var AW={IteratorPrototype:E8,BUGGY_SAFARI_ITERATORS:GJ},_W=LU,z7=SL,mse=GP.f,kde=CU,qJ=cN,Ase=SL?{}.toString:function(){return"[object "+_W(this)+"]"},b4=PS("toStringTag"),VU=function(s,p,A,y){if(s){var w=A?s:s.prototype;qJ(w,b4)||mse(w,b4,{configurable:!0,value:p}),y&&!z7&&kde(w,"toString",Ase)}},o6=AW.IteratorPrototype,_se=_4,gN=U2,vW=VU,s6=x7,Y7=function(){return this},KP=function(s,p,A,y){var w=p+" Iterator";return s.prototype=_se(o6,{next:gN(+!y,A)}),vW(s,w,!1,!0),s6[w]=Y7,s},C4=xS,yW=AO,Rte=KP,a6=K2,vse=VU,Ote=Y2,Dte=x7,WJ=Ste.PROPER,EW=AW.BUGGY_SAFARI_ITERATORS,KJ=PS("iterator"),IW="values",GU="entries",J7=function(){return this},c6=function(s,p,A,y,w,$,j){Rte(A,p,y);var _e,K,_i,_o=function(g_){if(g_===w&&i_)return i_;if(!EW&&g_ in _f)return _f[g_];switch(g_){case"keys":case IW:case GU:return function(){return new A(this,g_)}}return function(){return new A(this)}},_u=p+" Iterator",ch=!1,_f=s.prototype,o_=_f[KJ]||_f["@@iterator"]||w&&_f[w],i_=!EW&&o_||_o(w),u_="Array"==p&&_f.entries||o_;if(u_&&(_e=a6(u_.call(new s)))!==Object.prototype&&_e.next&&(vse(_e,_u,!0,!0),Dte[_u]=J7),WJ&&w==IW&&o_&&o_.name!==IW&&(ch=!0,i_=function(){return yW(o_,this)}),w)if(K={values:_o(IW),keys:$?i_:_o("keys"),entries:_o(GU)},j)for(_i in K)(EW||ch||!(_i in _f))&&Ote(_f,_i,K[_i]);else C4({target:p,proto:!0,forced:EW||ch},K);return j&&_f[KJ]!==i_&&Ote(_f,KJ,i_,{name:w}),Dte[p]=i_,K},bW=EM,CW=x7,kte=c6,zJ="Array Iterator",Pte=r6.set,DL=r6.getterFor(zJ);kte(Array,"Array",function(s,p){Pte(this,{type:zJ,target:bW(s),index:0,kind:p})},function(){var s=DL(this),p=s.target,A=s.kind,y=s.index++;return!p||y>=p.length?(s.target=void 0,{value:void 0,done:!0}):"keys"==A?{value:y,done:!1}:"values"==A?{value:p[y],done:!1}:{value:[y,p[y]],done:!1}},"values"),CW.Arguments=CW.Array;var YJ=n1.Promise,yse=Y2,xte=function(s,p,A){for(var y in p)A&&A.unsafe&&s[y]?s[y]=p[y]:yse(s,y,p[y],A);return s},$7=EL,Lte=GP,JJ=B2,NL=PS("species"),Ese=M2,$J=n1.TypeError,u6=function(s,p){if(Ese(p,s))return s;throw $J("Incorrect invocation")},Mte=PS("iterator"),Bte=!1;try{var Ise=0,Z7={next:function(){return{done:!!Ise++}},return:function(){Bte=!0}};Z7[Mte]=function(){return this},Array.from(Z7,function(){throw 2})}catch(s){}var TW=rT,bse=OT,Ute=MT,Fte=LU,jte=pN,SW=function(){},Vte=[],Gte=EL("Reflect","construct"),J2=/^\s*(?:class|function)\b/,Pde=TW(J2.exec),X7=!J2.exec(SW),w4=function(s){if(!Ute(s))return!1;try{return Gte(SW,Vte,s),!0}catch(p){return!1}},ZJ=function(s){if(!Ute(s))return!1;switch(Fte(s)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return X7||!!Pde(J2,jte(s))}catch(p){return!0}};ZJ.sham=!0;var T4,S4,Qte,XJ,RW=!Gte||bse(function(){var s;return w4(w4.call)||!w4(Object)||!w4(function(){s=!0})||s})?ZJ:w4,Hte=RW,qte=QV,e$=n1.TypeError,Wte=KN,Kte=PS("species"),t$=function(s,p){var A,y=Wte(s).constructor;return void 0===y||null==(A=Wte(y)[Kte])?p:function(s){if(Hte(s))return s;throw e$(qte(s)+" is not a constructor")}(A)},n$=rT([].slice),r$=/(?:ipad|iphone|ipod).*applewebkit/i.test(IL),$N=n1,wse=IY,zte=CM,Yte=MT,mN=cN,eQ=OT,Tse=A4,Sse=n$,Rse=zV,tQ=r$,Jte=JS,nQ=$N.setImmediate,i$=$N.clearImmediate,$te=$N.process,o$=$N.Dispatch,R4=$N.Function,dR=$N.MessageChannel,ZN=$N.String,O4=0,D4={};try{T4=$N.location}catch(s){}var Zte=function(s){if(mN(D4,s)){var p=D4[s];delete D4[s],p()}},OW=function(s){return function(){Zte(s)}},rQ=function(s){Zte(s.data)},a$=function(s){$N.postMessage(ZN(s),T4.protocol+"//"+T4.host)};nQ&&i$||(nQ=function(s){var p=Sse(arguments,1);return D4[++O4]=function(){wse(Yte(s)?s:R4(s),void 0,p)},S4(O4),O4},i$=function(s){delete D4[s]},Jte?S4=function(s){$te.nextTick(OW(s))}:o$&&o$.now?S4=function(s){o$.now(OW(s))}:dR&&!tQ?(XJ=(Qte=new dR).port2,Qte.port1.onmessage=rQ,S4=zte(XJ.postMessage,XJ)):$N.addEventListener&&Yte($N.postMessage)&&!$N.importScripts&&T4&&"file:"!==T4.protocol&&!eQ(a$)?(S4=a$,$N.addEventListener("message",rQ,!1)):S4="onreadystatechange"in Rse("script")?function(s){Tse.appendChild(Rse("script")).onreadystatechange=function(){Tse.removeChild(this),Zte(s)}}:function(s){setTimeout(OW(s),0)});var N4,QU,b8,RM,C8,iQ,c$,Ose,u$={set:nQ,clear:i$},DW=n1,xde=/ipad|iphone|ipod/i.test(IL)&&void 0!==DW.Pebble,Dse=/web0s(?!.*chrome)/i.test(IL),k4=n1,Xte=CM,l$=u$.set,Mde=r$,Nse=xde,kse=Dse,d$=JS,ene=k4.MutationObserver||k4.WebKitMutationObserver,Pse=k4.document,h$=k4.process,f$=k4.Promise,p$=(0,jP.f)(k4,"queueMicrotask"),eO=p$&&p$.value;eO||(N4=function(){var s,p;for(d$&&(s=h$.domain)&&s.exit();QU;){p=QU.fn,QU=QU.next;try{p()}catch(A){throw QU?RM():b8=void 0,A}}b8=void 0,s&&s.enter()},Mde||d$||kse||!ene||!Pse?!Nse&&f$&&f$.resolve?((c$=f$.resolve(void 0)).constructor=f$,Ose=Xte(c$.then,c$),RM=function(){Ose(N4)}):d$?RM=function(){h$.nextTick(N4)}:(l$=Xte(l$,k4),RM=function(){l$(N4)}):(C8=!0,iQ=Pse.createTextNode(""),new ene(N4).observe(iQ,{characterData:!0}),RM=function(){iQ.data=C8=!C8}));var OM=eO||function(s){var p={fn:s,next:void 0};b8&&(b8.next=p),QU||(QU=p,RM()),b8=p},P4={},g$=WN,Bde=function(s){var p,A;this.promise=new s(function(y,w){if(void 0!==p||void 0!==A)throw TypeError("Bad Promise constructor");p=y,A=w}),this.resolve=g$(p),this.reject=g$(A)};P4.f=function(s){return new Bde(s)};var Ude=KN,Fde=F2,xse=P4,oQ=function(s,p){if(Ude(s),Fde(p)&&p.constructor===s)return p;var A=xse.f(s);return(0,A.resolve)(p),A.promise},jde=n1,sQ=function(s){try{return{error:!1,value:s()}}catch(p){return{error:!0,value:p}}},NW=function(){this.head=null,this.tail=null};NW.prototype={add:function(s){var p={item:s,next:null};this.head?this.tail.next=p:this.head=p,this.tail=p},get:function(){var s=this.head;if(s)return this.head=s.next,this.tail===s&&(this.tail=null),s.item}};var tO,w8,m$,A$="object"==typeof window,l6=xS,zP=n1,kW=EL,HU=AO,_$=YJ,Lse=xte,v$=VU,tne=WN,d6=MT,Bse=F2,PW=u6,nne=pN,rne=iW,Use=t$,xW=u$.set,LW=OM,$2=oQ,T8=P4,MW=sQ,aQ=NW,cQ=r6,BW=Toe,y$=A$,UW=JS,uQ=r1,one=PS("species"),kL="Promise",FW=cQ.getterFor(kL),E$=cQ.set,h6=cQ.getterFor(kL),XN=_$,S8=_$&&_$.prototype,I$=zP.TypeError,lQ=zP.document,jW=zP.process,R8=T8.f,b$=R8,VW=!!(lQ&&lQ.createEvent&&zP.dispatchEvent),ane=d6(zP.PromiseRejectionEvent),Fse="unhandledrejection",O8=BW(kL,function(){var s=nne(XN),p=s!==String(XN);if(!p&&66===uQ||!S8.finally)return!0;if(uQ>=51&&/native code/.test(s))return!1;var A=new XN(function(w){w(1)}),y=function(w){w(function(){},function(){})};return(A.constructor={})[one]=y,!(A.then(function(){})instanceof y)||!p&&y$&&!ane}),cne=O8||!function(s,p){if(!p&&!Bte)return!1;var A=!1;try{var y={};y[Mte]=function(){return{next:function(){return{done:A=!0}}}},s(y)}catch(w){}return A}(function(s){XN.all(s).catch(function(){})}),une=function(s){var p;return!(!Bse(s)||!d6(p=s.then))&&p},lne=function(s,p){var A,y,w,$=p.value,j=1==p.state,_e=j?s.ok:s.fail,K=s.resolve,_i=s.reject,_o=s.domain;try{_e?(j||(2===p.rejection&&QW(p),p.rejection=1),!0===_e?A=$:(_o&&_o.enter(),A=_e($),_o&&(_o.exit(),w=!0)),A===s.promise?_i(I$("Promise-chain cycle")):(y=une(A))?HU(y,A,K,_i):K(A)):_i($)}catch(_u){_o&&!w&&_o.exit(),_i(_u)}},C$=function(s,p){s.notified||(s.notified=!0,LW(function(){for(var A,y=s.reactions;A=y.get();)lne(A,s);s.notified=!1,p&&!s.rejection&&w$(s)}))},GW=function(s,p,A){var y,w;VW?((y=lQ.createEvent("Event")).promise=p,y.reason=A,y.initEvent(s,!1,!0),zP.dispatchEvent(y)):y={promise:p,reason:A},!ane&&(w=zP["on"+s])?w(y):s===Fse&&function(s,p){var A=jde.console;A&&A.error&&(1==arguments.length?A.error(s):A.error(s,p))}("Unhandled promise rejection",A)},w$=function(s){HU(xW,zP,function(){var p,A=s.facade,y=s.value;if(T$(s)&&(p=MW(function(){UW?jW.emit("unhandledRejection",y,A):GW(Fse,A,y)}),s.rejection=UW||T$(s)?2:1,p.error))throw p.value})},T$=function(s){return 1!==s.rejection&&!s.parent},QW=function(s){HU(xW,zP,function(){var p=s.facade;UW?jW.emit("rejectionHandled",p):GW("rejectionhandled",p,s.value)})},x4=function(s,p,A){return function(y){s(p,y,A)}},L4=function(s,p,A){s.done||(s.done=!0,A&&(s=A),s.value=p,s.state=2,C$(s,!0))},dQ=function(s,p,A){if(!s.done){s.done=!0,A&&(s=A);try{if(s.facade===p)throw I$("Promise can't be resolved itself");var y=une(p);y?LW(function(){var w={done:!1};try{HU(y,p,x4(dQ,w,s),x4(L4,w,s))}catch($){L4(w,$,s)}}):(s.value=p,s.state=1,C$(s,!1))}catch(w){L4({done:!1},w,s)}}};O8&&(S8=(XN=function(s){PW(this,S8),tne(s),HU(tO,this);var p=FW(this);try{s(x4(dQ,p),x4(L4,p))}catch(A){L4(p,A)}}).prototype,(tO=function(s){E$(this,{type:kL,done:!1,notified:!1,parent:!1,reactions:new aQ,rejection:!1,state:0,value:void 0})}).prototype=Lse(S8,{then:function(s,p){var A=h6(this),y=R8(Use(this,XN));return A.parent=!0,y.ok=!d6(s)||s,y.fail=d6(p)&&p,y.domain=UW?jW.domain:void 0,0==A.state?A.reactions.add(y):LW(function(){lne(y,A)}),y.promise},catch:function(s){return this.then(void 0,s)}}),w8=function(){var s=new tO,p=FW(s);this.promise=s,this.resolve=x4(dQ,p),this.reject=x4(L4,p)},T8.f=R8=function(s){return s===XN||s===m$?new w8(s):b$(s)}),l6({global:!0,wrap:!0,forced:O8},{Promise:XN}),v$(XN,kL,!1,!0),function(s){var p=$7(s);JJ&&p&&!p[NL]&&(0,Lte.f)(p,NL,{configurable:!0,get:function(){return this}})}(kL),m$=kW(kL),l6({target:kL,stat:!0,forced:O8},{reject:function(s){var p=R8(this);return HU(p.reject,void 0,s),p.promise}}),l6({target:kL,stat:!0,forced:!0},{resolve:function(s){return $2(this===m$?XN:this,s)}}),l6({target:kL,stat:!0,forced:cne},{all:function(s){var p=this,A=R8(p),y=A.resolve,w=A.reject,$=MW(function(){var j=tne(p.resolve),_e=[],K=0,_i=1;rne(s,function(_o){var _u=K++,ch=!1;_i++,HU(j,p,_o).then(function(_f){ch||(ch=!0,_e[_u]=_f,--_i||y(_e))},w)}),--_i||y(_e)});return $.error&&w($.value),A.promise},race:function(s){var p=this,A=R8(p),y=A.reject,w=MW(function(){var $=tne(p.resolve);rne(s,function(j){HU($,p,j).then(A.resolve,y)})});return w.error&&y(w.value),A.promise}});var jse=AO,Gde=WN,Qde=P4,S$=sQ,dne=iW;xS({target:"Promise",stat:!0},{allSettled:function(s){var p=this,A=Qde.f(p),y=A.resolve,w=A.reject,$=S$(function(){var j=Gde(p.resolve),_e=[],K=0,_i=1;dne(s,function(_o){var _u=K++,ch=!1;_i++,jse(j,p,_o).then(function(_f){ch||(ch=!0,_e[_u]={status:"fulfilled",value:_f},--_i||y(_e))},function(_f){ch||(ch=!0,_e[_u]={status:"rejected",reason:_f},--_i||y(_e))})}),--_i||y(_e)});return $.error&&w($.value),A.promise}});var hne=WN,fne=EL,Vse=AO,rAe=P4,Hde=sQ,iAe=iW,qde="No one promise resolved";xS({target:"Promise",stat:!0},{any:function(s){var p=this,A=fne("AggregateError"),y=rAe.f(p),w=y.resolve,$=y.reject,j=Hde(function(){var _e=hne(p.resolve),K=[],_i=0,_o=1,_u=!1;iAe(s,function(ch){var _f=_i++,o_=!1;_o++,Vse(_e,p,ch).then(function(i_){o_||_u||(_u=!0,w(i_))},function(i_){o_||_u||(o_=!0,K[_f]=i_,--_o||$(new A(K,qde)))})}),--_o||$(new A(K,qde))});return j.error&&$(j.value),y.promise}});var HW=YJ,R$=EL,Gse=MT,pne=t$,O$=oQ;xS({target:"Promise",proto:!0,real:!0,forced:!!HW&&OT(function(){HW.prototype.finally.call({then:function(){}},function(){})})},{finally:function(s){var p=pne(this,R$("Promise")),A=Gse(s);return this.then(A?function(y){return O$(p,s()).then(function(){return y})}:s,A?function(y){return O$(p,s()).then(function(){throw y})}:s)}});var DM=rT,qW=X3,f6=OL,gne=GV,D$=DM("".charAt),N$=DM("".charCodeAt),k$=DM("".slice),WW=function(s){return function(p,A){var y,w,$=f6(gne(p)),j=qW(A),_e=$.length;return j<0||j>=_e?s?"":void 0:(y=N$($,j))<55296||y>56319||j+1===_e||(w=N$($,j+1))<56320||w>57343?s?D$($,j):y:s?k$($,j,j+2):w-56320+(y-55296<<10)+65536}},Qse={codeAt:WW(!1),charAt:WW(!0)},Wde=Qse.charAt,oAe=OL,mne=c6,Hse="String Iterator",zde=r6.set,Yde=r6.getterFor(Hse);mne(String,"String",function(s){zde(this,{type:Hse,string:oAe(s),index:0})},function(){var s,p=Yde(this),A=p.string,y=p.index;return y>=A.length?{value:void 0,done:!0}:(s=Wde(A,y),p.index+=s.length,{value:s,done:!1})});var Jde=IU.Promise,hQ=n1,Ane=LU,P$=CU,KW=x7,fQ=PS("toStringTag");for(var p6 in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var x$=hQ[p6],D8=x$&&x$.prototype;D8&&Ane(D8)!==fQ&&P$(D8,fQ,p6),KW[p6]=KW.Array}var N8=Jde,iI=N8,Wse=gM,$de=_l,_ne=wS,vne=L5,yne=a8,zW=Error.prototype.toString,YW=ga(function(){if($de){var s=vne(Object.defineProperty({},"name",{get:function(){return this===s}}));if("true"!==zW.call(s))return!0}return"2: 1"!==zW.call({message:1,name:2})||"Error"!==zW.call({})})?function(){var s=_ne(this),p=yne(s.name,"Error"),A=yne(s.message);return p?A?p+": "+A:p:A}:zW,Kse={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}},zse=hI,L$=_T,M$=ga,Jse=L5,B$=V_,I=yT.f,b=p7.f,F=eS.exports,_n=X1,ca=jN,_d=wS,_p=YW,t_=a8,s_=Kse,A_=u4,C_=PT,Q_=_l,Qv="DOMException",P0=L$("Error"),Q0=L$(Qv)||function(){try{(new(L$("MessageChannel")||function(s){try{if(Wse)return Function('return require("'+s+'")')()}catch(p){}}("worker_threads").MessageChannel)).port1.postMessage(new WeakMap)}catch(s){if("DATA_CLONE_ERR"==s.name&&25==s.code)return s.constructor}}(),wI=P0.prototype,V0=C_.set,YI=C_.getterFor(Qv),j1="stack"in P0(Qv),_w=function(s){return _n(s_,s)&&s_[s].m?s_[s].c:0},MS=function(){ca(this,NM);var s=arguments.length,p=t_(s<1?void 0:arguments[0]),A=t_(s<2?void 0:arguments[1],"Error"),y=_w(A);if(V0(this,{type:Qv,name:A,message:p,code:y}),Q_||(this.name=A,this.message=p,this.code=y),j1){var w=P0(p);w.name=Qv,I(this,"stack",B$(1,A_(w.stack,1)))}},NM=MS.prototype=Jse(wI),CR=function(s){return{enumerable:!0,configurable:!0,get:s}},YP=function(s){return CR(function(){return YI(this)[s]})};Q_&&b(NM,{name:YP("name"),message:YP("message"),code:YP("code")}),I(NM,"constructor",B$(1,MS));var g6=M$(function(){return!(new Q0 instanceof P0)}),Ene=g6||M$(function(){return wI.toString!==_p||"2: 1"!==String(new Q0(1,2))}),JW=g6||M$(function(){return 25!==new Q0(1,"DataCloneError").code});zse({global:!0,forced:g6},{DOMException:g6?MS:Q0});var M4=L$(Qv),m6=M4.prototype;for(var pQ in Ene&&Q0===M4&&F(m6,"toString",_p),JW&&Q_&&Q0===M4&&I(m6,"code",CR(function(){return _w(_d(this).name)})),s_)if(_n(s_,pQ)){var gQ=s_[pQ],U$=gQ.s,$se=B$(6,gQ.c);_n(M4,U$)||I(M4,U$,$se),_n(m6,U$)||I(m6,U$,$se)}var Xde=hI,$W=_T,Ine=V_,bne=yT.f,Zse=X1,ehe=jN,sAe=s8,Xse=a8,Cne=Kse,eae=u4,F$="DOMException",wne=$W("Error"),j$=$W(F$),Tne=function(){ehe(this,the);var s=arguments.length,p=Xse(s<1?void 0:arguments[0]),A=Xse(s<2?void 0:arguments[1],"Error"),y=new j$(p,A),w=wne(p);return w.name=F$,bne(y,"stack",Ine(1,eae(w.stack,1))),sAe(y,this,Tne),y},the=Tne.prototype=j$.prototype,tae="stack"in wne(F$),Sne="stack"in new j$(1,2),nae=tae&&!Sne;Xde({global:!0,forced:nae},{DOMException:nae?Tne:j$});var ZW=$W(F$),rae=ZW.prototype;if(rae.constructor!==ZW)for(var A6 in bne(rae,"constructor",Ine(1,ZW)),Cne)if(Zse(Cne,A6)){var e2=Cne[A6],iae=e2.s;Zse(ZW,iae)||bne(ZW,iae,Ine(6,e2.c))}var aAe="DOMException";uL(_T(aAe),aAe);var cAe=G_,oae=eS.exports,uAe=jO,Rne=ga,V$=E1,lAe=TS,sae=V$("species"),aae=RegExp.prototype,nhe=G_,iEe=UN,oEe=lN,sEe=eI,aEe=nhe("".charAt),dAe=nhe("".charCodeAt),hAe=nhe("".slice),cae=function(s){return function(p,A){var y,w,$=oEe(sEe(p)),j=iEe(A),_e=$.length;return j<0||j>=_e?s?"":void 0:(y=dAe($,j))<55296||y>56319||j+1===_e||(w=dAe($,j+1))<56320||w>57343?s?aEe($,j):y:s?hAe($,j,j+2):w-56320+(y-55296<<10)+65536}},fAe=(cae(!1),cae(!0)),uae=G_,pAe=ON,One=Math.floor,mQ=uae("".charAt),Dne=uae("".replace),XW=uae("".slice),gAe=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,lae=/\$([$&'`]|\d{1,2})/g,G$=r_,mAe=wS,AAe=UI,rhe=E_,_Ae=jO,ihe=_r.TypeError,vAe=zR,yAe=r_,Nne=G_,cEe=ga,dae=wS,EAe=UI,she=UN,hae=E2,k8=lN,uEe=eI,fae=function(s,p,A){return p+(A?fAe(s,p).length:1)},Q$=_E,kne=function(s,p,A,y,w,$){var j=A+s.length,_e=y.length,K=lae;return void 0!==w&&(w=pAe(w),K=gAe),Dne($,K,function(_i,_o){var _u;switch(mQ(_o,0)){case"$":return"$";case"&":return s;case"`":return XW(p,0,A);case"'":return XW(p,j);case"<":_u=w[XW(_o,1,-1)];break;default:var ch=+_o;if(0===ch)return _i;if(ch>_e){var _f=One(ch/10);return 0===_f?_i:_f<=_e?void 0===y[_f-1]?mQ(_o,1):y[_f-1]+mQ(_o,1):_i}_u=y[ch-1]}return void 0===_u?"":_u})},eK=function(s,p){var A=s.exec;if(AAe(A)){var y=G$(A,s,p);return null!==y&&mAe(y),y}if("RegExp"===rhe(s))return G$(_Ae,s,p);throw ihe("RegExp#exec called on incompatible receiver")},AQ=E1("replace"),IAe=Math.max,pae=Math.min,ahe=Nne([].concat),H$=Nne([].push),gae=Nne("".indexOf),q$=Nne("".slice),che="$0"==="a".replace(/./,"$0"),Pne=!!/./[AQ]&&""===/./[AQ]("a","$0");!function(s,p,A,y){var w=V$(s),$=!Rne(function(){var _i={};return _i[w]=function(){return 7},7!=""[s](_i)}),j=$&&!Rne(function(){var _i=!1,_o=/a/;return"split"===s&&((_o={}).constructor={},_o.constructor[sae]=function(){return _o},_o.flags="",_o[w]=/./[w]),_o.exec=function(){return _i=!0,null},_o[w](""),!_i});if(!$||!j||A){var _e=cAe(/./[w]),K=p(w,""[s],function(_i,_o,_u,ch,_f){var o_=cAe(_i),i_=_o.exec;return i_===uAe||i_===aae.exec?$&&!_f?{done:!0,value:_e(_o,_u,ch)}:{done:!0,value:o_(_u,_o,ch)}:{done:!1}});oae(String.prototype,s,K[0]),oae(aae,w,K[1])}y&&lAe(aae[w],"sham",!0)}("replace",function(s,p,A){var y=Pne?"$":"$0";return[function(w,$){var j=uEe(this),_e=null==w?void 0:Q$(w,AQ);return _e?yAe(_e,w,j,$):yAe(p,k8(j),w,$)},function(w,$){var j=dae(this),_e=k8(w);if("string"==typeof $&&-1===gae($,y)&&-1===gae($,"$<")){var K=A(p,j,_e,$);if(K.done)return K.value}var _i=EAe($);_i||($=k8($));var _o=j.global;if(_o){var _u=j.unicode;j.lastIndex=0}for(var ch=[];;){var _f=eK(j,_e);if(null===_f||(H$(ch,_f),!_o))break;""===k8(_f[0])&&(j.lastIndex=fae(_e,hae(j.lastIndex),_u))}for(var o_,i_="",u_=0,g_=0;g_<ch.length;g_++){for(var __=k8((_f=ch[g_])[0]),w_=IAe(pae(she(_f.index),_e.length),0),k_=[],Rv=1;Rv<_f.length;Rv++)H$(k_,void 0===(o_=_f[Rv])?o_:String(o_));var f0=_f.groups;if(_i){var y0=ahe([__],k_,w_,_e);void 0!==f0&&H$(y0,f0);var b0=k8(vAe($,void 0,y0))}else b0=kne(__,_e,w_,k_,f0,$);w_>=u_&&(i_+=q$(_e,u_,w_)+b0,u_=w_+__.length)}return i_+q$(_e,u_)}]},!!cEe(function(){var s=/./;return s.exec=function(){var p=[];return p.groups={a:"7"},p},"7"!=="".replace(s,"$<a>")})||!che||Pne);var bAe=sT,uhe=E_,lhe=E1("match"),dhe=_l,W$=_r,_Q=G_,mae=bP,CAe=s8,wAe=TS,K$=yT.f,Aae=_D.f,_ae=NT,TAe=lN,dEe=VY,SAe=_H,RAe=eS.exports,hhe=ga,OAe=X1,fhe=PT.enforce,vae=uS,phe=IH,ghe=bH,mhe=E1("match"),_6=W$.RegExp,z$=_6.prototype,Ahe=W$.SyntaxError,DAe=_Q(dEe),_he=_Q(z$.exec),xne=_Q("".charAt),yae=_Q("".replace),Eae=_Q("".indexOf),NAe=_Q("".slice),vhe=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,vQ=/a/g,Y$=/a/g,kAe=new _6(vQ)!==vQ,Lne=SAe.MISSED_STICKY,PAe=SAe.UNSUPPORTED_Y;if(mae("RegExp",dhe&&(!kAe||Lne||phe||ghe||hhe(function(){return Y$[mhe]=!1,_6(vQ)!=vQ||_6(Y$)==Y$||"/a/i"!=_6(vQ,"i")})))){for(var v6=function(s,p){var A,y,w,$,j,_e,K=_ae(z$,this),_i=function(s){var p;return bAe(s)&&(void 0!==(p=s[lhe])?!!p:"RegExp"==uhe(s))}(s),_o=void 0===p,_u=[],ch=s;if(!K&&_i&&_o&&s.constructor===v6)return s;if((_i||_ae(z$,s))&&(s=s.source,_o&&(p="flags"in ch?ch.flags:DAe(ch))),s=void 0===s?"":TAe(s),p=void 0===p?"":TAe(p),ch=s,phe&&"dotAll"in vQ&&(y=!!p&&Eae(p,"s")>-1)&&(p=yae(p,/s/g,"")),A=p,Lne&&"sticky"in vQ&&(w=!!p&&Eae(p,"y")>-1)&&PAe&&(p=yae(p,/y/g,"")),ghe&&(s=($=function(_f){for(var o_,i_=_f.length,u_=0,g_="",__=[],w_={},k_=!1,Rv=!1,f0=0,y0="";u_<=i_;u_++){if("\\"===(o_=xne(_f,u_)))o_+=xne(_f,++u_);else if("]"===o_)k_=!1;else if(!k_)switch(!0){case"["===o_:k_=!0;break;case"("===o_:_he(vhe,NAe(_f,u_+1))&&(u_+=2,Rv=!0),g_+=o_,f0++;continue;case">"===o_&&Rv:if(""===y0||OAe(w_,y0))throw new Ahe("Invalid capture group name");w_[y0]=!0,__[__.length]=[y0,f0],Rv=!1,y0="";continue}Rv?y0+=o_:g_+=o_}return[g_,__]}(s))[0],_u=$[1]),j=CAe(_6(s,p),K?this:z$,v6),(y||w||_u.length)&&(_e=fhe(j),y&&(_e.dotAll=!0,_e.raw=v6(function(_f){for(var o_,i_=_f.length,u_=0,g_="",__=!1;u_<=i_;u_++)"\\"!==(o_=xne(_f,u_))?__||"."!==o_?("["===o_?__=!0:"]"===o_&&(__=!1),g_+=o_):g_+="[\\s\\S]":g_+=o_+xne(_f,++u_);return g_}(s),A)),w&&(_e.sticky=!0),_u.length&&(_e.groups=_u)),s!==ch)try{wAe(j,"source",""===ch?"(?:)":ch)}catch(_f){}return j},xAe=function(s){s in v6||K$(v6,s,{configurable:!0,get:function(){return _6[s]},set:function(p){_6[s]=p}})},bae=Aae(_6),yhe=0;bae.length>yhe;)xAe(bae[yhe++]);z$.constructor=v6,v6.prototype=z$,RAe(W$,"RegExp",v6)}vae("RegExp");var MAe=E_,Ihe=PT.get,bhe=RegExp.prototype,hEe=_r.TypeError;_l&&IH&&(0,yT.f)(bhe,"dotAll",{configurable:!0,get:function(){if(this!==bhe){if("RegExp"===MAe(this))return!!Ihe(this).dotAll;throw hEe("Incompatible receiver, RegExp required")}}});const Mne=w7;function Che(s,p){const A=s&&s.navigator;if(!A.mediaDevices)return;const y=function(j){if("object"!=typeof j||j.mandatory||j.optional)return j;const _e={};return Object.keys(j).forEach(K=>{if("require"===K||"advanced"===K||"mediaSource"===K)return;const _i="object"==typeof j[K]?j[K]:{ideal:j[K]};void 0!==_i.exact&&"number"==typeof _i.exact&&(_i.min=_i.max=_i.exact);const _o=function(_u,ch){return _u?_u+ch.charAt(0).toUpperCase()+ch.slice(1):"deviceId"===ch?"sourceId":ch};if(void 0!==_i.ideal){_e.optional=_e.optional||[];let _u={};"number"==typeof _i.ideal?(_u[_o("min",K)]=_i.ideal,_e.optional.push(_u),_u={},_u[_o("max",K)]=_i.ideal,_e.optional.push(_u)):(_u[_o("",K)]=_i.ideal,_e.optional.push(_u))}void 0!==_i.exact&&"number"!=typeof _i.exact?(_e.mandatory=_e.mandatory||{},_e.mandatory[_o("",K)]=_i.exact):["min","max"].forEach(_u=>{void 0!==_i[_u]&&(_e.mandatory=_e.mandatory||{},_e.mandatory[_o(_u,K)]=_i[_u])})}),j.advanced&&(_e.optional=(_e.optional||[]).concat(j.advanced)),_e},w=function(j,_e){if(p.version>=61)return _e(j);if((j=JSON.parse(JSON.stringify(j)))&&"object"==typeof j.audio){const K=function(_i,_o,_u){_o in _i&&!(_u in _i)&&(_i[_u]=_i[_o],delete _i[_o])};K((j=JSON.parse(JSON.stringify(j))).audio,"autoGainControl","googAutoGainControl"),K(j.audio,"noiseSuppression","googNoiseSuppression"),j.audio=y(j.audio)}if(j&&"object"==typeof j.video){let K=j.video.facingMode;K=K&&("object"==typeof K?K:{ideal:K});const _i=p.version<66;if(K&&("user"===K.exact||"environment"===K.exact||"user"===K.ideal||"environment"===K.ideal)&&(!A.mediaDevices.getSupportedConstraints||!A.mediaDevices.getSupportedConstraints().facingMode||_i)){let _o;if(delete j.video.facingMode,"environment"===K.exact||"environment"===K.ideal?_o=["back","rear"]:"user"!==K.exact&&"user"!==K.ideal||(_o=["front"]),_o)return A.mediaDevices.enumerateDevices().then(_u=>{let ch=(_u=_u.filter(_f=>"videoinput"===_f.kind)).find(_f=>_o.some(o_=>_f.label.toLowerCase().includes(o_)));return!ch&&_u.length&&_o.includes("back")&&(ch=_u[_u.length-1]),ch&&(j.video.deviceId=K.exact?{exact:ch.deviceId}:{ideal:ch.deviceId}),j.video=y(j.video),Mne("chrome: "+JSON.stringify(j)),_e(j)})}j.video=y(j.video)}return Mne("chrome: "+JSON.stringify(j)),_e(j)},$=function(j){return p.version>=64?j:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[j.name]||j.name,message:j.message,constraint:j.constraint||j.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(A.getUserMedia=function(j,_e,K){w(j,_i=>{A.webkitGetUserMedia(_i,_e,_o=>{K&&K($(_o))})})}.bind(A),A.mediaDevices.getUserMedia){const j=A.mediaDevices.getUserMedia.bind(A.mediaDevices);A.mediaDevices.getUserMedia=function(_e){return w(_e,K=>j(K).then(_i=>{if(K.audio&&!_i.getAudioTracks().length||K.video&&!_i.getVideoTracks().length)throw _i.getTracks().forEach(_o=>{_o.stop()}),new DOMException("","NotFoundError");return _i},_i=>iI.reject($(_i))))}}}function wae(s){s.MediaStream=s.MediaStream||s.webkitMediaStream}function whe(s){if("object"==typeof s&&s.RTCPeerConnection&&!("ontrack"in s.RTCPeerConnection.prototype)){Object.defineProperty(s.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(A){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=A)},enumerable:!0,configurable:!0});const p=s.RTCPeerConnection.prototype.setRemoteDescription;s.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=A=>{A.stream.addEventListener("addtrack",y=>{let w;w=s.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(j=>j.track&&j.track.id===y.track.id):{track:y.track};const $=new Event("track");$.track=y.track,$.receiver=w,$.transceiver={receiver:w},$.streams=[A.stream],this.dispatchEvent($)}),A.stream.getTracks().forEach(y=>{let w;w=s.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(j=>j.track&&j.track.id===y.id):{track:y};const $=new Event("track");$.track=y,$.receiver=w,$.transceiver={receiver:w},$.streams=[A.stream],this.dispatchEvent($)})},this.addEventListener("addstream",this._ontrackpoly)),p.apply(this,arguments)}}else XR(s,"track",p=>(p.transceiver||Object.defineProperty(p,"transceiver",{value:{receiver:p.receiver}}),p))}function Tae(s){if("object"==typeof s&&s.RTCPeerConnection&&!("getSenders"in s.RTCPeerConnection.prototype)&&"createDTMFSender"in s.RTCPeerConnection.prototype){const p=function(w,$){return{track:$,get dtmf(){return void 0===this._dtmf&&(this._dtmf="audio"===$.kind?w.createDTMFSender($):null),this._dtmf},_pc:w}};if(!s.RTCPeerConnection.prototype.getSenders){s.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const w=s.RTCPeerConnection.prototype.addTrack;s.RTCPeerConnection.prototype.addTrack=function(j,_e){let K=w.apply(this,arguments);return K||(K=p(this,j),this._senders.push(K)),K};const $=s.RTCPeerConnection.prototype.removeTrack;s.RTCPeerConnection.prototype.removeTrack=function(j){$.apply(this,arguments);const _e=this._senders.indexOf(j);-1!==_e&&this._senders.splice(_e,1)}}const A=s.RTCPeerConnection.prototype.addStream;s.RTCPeerConnection.prototype.addStream=function(w){this._senders=this._senders||[],A.apply(this,[w]),w.getTracks().forEach($=>{this._senders.push(p(this,$))})};const y=s.RTCPeerConnection.prototype.removeStream;s.RTCPeerConnection.prototype.removeStream=function(w){this._senders=this._senders||[],y.apply(this,[w]),w.getTracks().forEach($=>{const j=this._senders.find(_e=>_e.track===$);j&&this._senders.splice(this._senders.indexOf(j),1)})}}else if("object"==typeof s&&s.RTCPeerConnection&&"getSenders"in s.RTCPeerConnection.prototype&&"createDTMFSender"in s.RTCPeerConnection.prototype&&s.RTCRtpSender&&!("dtmf"in s.RTCRtpSender.prototype)){const p=s.RTCPeerConnection.prototype.getSenders;s.RTCPeerConnection.prototype.getSenders=function(){const A=p.apply(this,[]);return A.forEach(y=>y._pc=this),A},Object.defineProperty(s.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null),this._dtmf}})}}function P8(s){if(!s.RTCPeerConnection)return;const p=s.RTCPeerConnection.prototype.getStats;s.RTCPeerConnection.prototype.getStats=function(){const[A,y,w]=arguments;if(arguments.length>0&&"function"==typeof A)return p.apply(this,arguments);if(0===p.length&&(0===arguments.length||"function"!=typeof A))return p.apply(this,[]);const $=function(_e){const K={};return _e.result().forEach(_i=>{const _o={id:_i.id,timestamp:_i.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[_i.type]||_i.type};_i.names().forEach(_u=>{_o[_u]=_i.stat(_u)}),K[_o.id]=_o}),K},j=function(_e){return new Map(Object.keys(_e).map(K=>[K,_e[K]]))};return arguments.length>=2?p.apply(this,[function(K){y(j($(K)))},A]):new iI((_e,K)=>{p.apply(this,[function(_i){_e(j($(_i)))},K])}).then(y,w)}}function The(s){if(!("object"==typeof s&&s.RTCPeerConnection&&s.RTCRtpSender&&s.RTCRtpReceiver))return;if(!("getStats"in s.RTCRtpSender.prototype)){const A=s.RTCPeerConnection.prototype.getSenders;A&&(s.RTCPeerConnection.prototype.getSenders=function(){const w=A.apply(this,[]);return w.forEach($=>$._pc=this),w});const y=s.RTCPeerConnection.prototype.addTrack;y&&(s.RTCPeerConnection.prototype.addTrack=function(){const w=y.apply(this,arguments);return w._pc=this,w}),s.RTCRtpSender.prototype.getStats=function(){const w=this;return this._pc.getStats().then($=>p4($,w.track,!0))}}if(!("getStats"in s.RTCRtpReceiver.prototype)){const A=s.RTCPeerConnection.prototype.getReceivers;A&&(s.RTCPeerConnection.prototype.getReceivers=function(){const y=A.apply(this,[]);return y.forEach(w=>w._pc=this),y}),XR(s,"track",y=>(y.receiver._pc=y.srcElement,y)),s.RTCRtpReceiver.prototype.getStats=function(){const y=this;return this._pc.getStats().then(w=>p4(w,y.track,!1))}}if(!("getStats"in s.RTCRtpSender.prototype)||!("getStats"in s.RTCRtpReceiver.prototype))return;const p=s.RTCPeerConnection.prototype.getStats;s.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof s.MediaStreamTrack){const A=arguments[0];let y,w,$;return this.getSenders().forEach(j=>{j.track===A&&(y?$=!0:y=j)}),this.getReceivers().forEach(j=>(j.track===A&&(w?$=!0:w=j),j.track===A)),$||y&&w?iI.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):y?y.getStats():w?w.getStats():iI.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return p.apply(this,arguments)}}function Sae(s){s.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map($=>this._shimmedLocalStreams[$][0])};const p=s.RTCPeerConnection.prototype.addTrack;s.RTCPeerConnection.prototype.addTrack=function($,j){if(!j)return p.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const _e=p.apply(this,arguments);return this._shimmedLocalStreams[j.id]?-1===this._shimmedLocalStreams[j.id].indexOf(_e)&&this._shimmedLocalStreams[j.id].push(_e):this._shimmedLocalStreams[j.id]=[j,_e],_e};const A=s.RTCPeerConnection.prototype.addStream;s.RTCPeerConnection.prototype.addStream=function($){this._shimmedLocalStreams=this._shimmedLocalStreams||{},$.getTracks().forEach(K=>{if(this.getSenders().find(_i=>_i.track===K))throw new DOMException("Track already exists.","InvalidAccessError")});const j=this.getSenders();A.apply(this,arguments);const _e=this.getSenders().filter(K=>-1===j.indexOf(K));this._shimmedLocalStreams[$.id]=[$].concat(_e)};const y=s.RTCPeerConnection.prototype.removeStream;s.RTCPeerConnection.prototype.removeStream=function($){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[$.id],y.apply(this,arguments)};const w=s.RTCPeerConnection.prototype.removeTrack;s.RTCPeerConnection.prototype.removeTrack=function($){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},$&&Object.keys(this._shimmedLocalStreams).forEach(j=>{const _e=this._shimmedLocalStreams[j].indexOf($);-1!==_e&&this._shimmedLocalStreams[j].splice(_e,1),1===this._shimmedLocalStreams[j].length&&delete this._shimmedLocalStreams[j]}),w.apply(this,arguments)}}function She(s,p){if(!s.RTCPeerConnection)return;if(s.RTCPeerConnection.prototype.addTrack&&p.version>=65)return Sae(s);const A=s.RTCPeerConnection.prototype.getLocalStreams;s.RTCPeerConnection.prototype.getLocalStreams=function(){const _i=A.apply(this);return this._reverseStreams=this._reverseStreams||{},_i.map(_o=>this._reverseStreams[_o.id])};const y=s.RTCPeerConnection.prototype.addStream;s.RTCPeerConnection.prototype.addStream=function(_i){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},_i.getTracks().forEach(_o=>{if(this.getSenders().find(_u=>_u.track===_o))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[_i.id]){const _o=new s.MediaStream(_i.getTracks());this._streams[_i.id]=_o,this._reverseStreams[_o.id]=_i,_i=_o}y.apply(this,[_i])};const w=s.RTCPeerConnection.prototype.removeStream;function $(_i,_o){let _u=_o.sdp;return Object.keys(_i._reverseStreams||[]).forEach(ch=>{const _f=_i._reverseStreams[ch];_u=_u.replace(new RegExp(_i._streams[_f.id].id,"g"),_f.id)}),new RTCSessionDescription({type:_o.type,sdp:_u})}function j(_i,_o){let _u=_o.sdp;return Object.keys(_i._reverseStreams||[]).forEach(ch=>{const _f=_i._reverseStreams[ch],o_=_i._streams[_f.id];_u=_u.replace(new RegExp(_f.id,"g"),o_.id)}),new RTCSessionDescription({type:_o.type,sdp:_u})}s.RTCPeerConnection.prototype.removeStream=function(_i){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},w.apply(this,[this._streams[_i.id]||_i]),delete this._reverseStreams[this._streams[_i.id]?this._streams[_i.id].id:_i.id],delete this._streams[_i.id]},s.RTCPeerConnection.prototype.addTrack=function(_i,_o){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const _u=[].slice.call(arguments,1);if(1!==_u.length||!_u[0].getTracks().find(o_=>o_===_i))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(o_=>o_.track===_i))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const _f=this._streams[_o.id];if(_f)_f.addTrack(_i),iI.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const o_=new s.MediaStream([_i]);this._streams[_o.id]=o_,this._reverseStreams[o_.id]=_o,this.addStream(o_)}return this.getSenders().find(o_=>o_.track===_i)},["createOffer","createAnswer"].forEach(function(_i){const _o=s.RTCPeerConnection.prototype[_i],_u={[_i](){const ch=arguments;return arguments.length&&"function"==typeof arguments[0]?_o.apply(this,[_f=>{const o_=$(this,_f);ch[0].apply(null,[o_])},_f=>{ch[1]&&ch[1].apply(null,_f)},arguments[2]]):_o.apply(this,arguments).then(_f=>$(this,_f))}};s.RTCPeerConnection.prototype[_i]=_u[_i]});const _e=s.RTCPeerConnection.prototype.setLocalDescription;s.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=j(this,arguments[0]),_e.apply(this,arguments)):_e.apply(this,arguments)};const K=Object.getOwnPropertyDescriptor(s.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(s.RTCPeerConnection.prototype,"localDescription",{get(){const _i=K.get.apply(this);return""===_i.type?_i:$(this,_i)}}),s.RTCPeerConnection.prototype.removeTrack=function(_i){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!_i._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(_i._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let _o;this._streams=this._streams||{},Object.keys(this._streams).forEach(_u=>{this._streams[_u].getTracks().find(ch=>_i.track===ch)&&(_o=this._streams[_u])}),_o&&(1===_o.getTracks().length?this.removeStream(this._reverseStreams[_o.id]):_o.removeTrack(_i.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Bne(s,p){!s.RTCPeerConnection&&s.webkitRTCPeerConnection&&(s.RTCPeerConnection=s.webkitRTCPeerConnection),s.RTCPeerConnection&&p.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(A){const y=s.RTCPeerConnection.prototype[A],w={[A](){return arguments[0]=new("addIceCandidate"===A?s.RTCIceCandidate:s.RTCSessionDescription)(arguments[0]),y.apply(this,arguments)}};s.RTCPeerConnection.prototype[A]=w[A]})}function Rhe(s,p){XR(s,"negotiationneeded",A=>{const y=A.target;if(!(p.version<72||y.getConfiguration&&"plan-b"===y.getConfiguration().sdpSemantics)||"stable"===y.signalingState)return A})}var Ohe=Object.freeze({__proto__:null,shimMediaStream:wae,shimOnTrack:whe,shimGetSendersWithDtmf:Tae,shimGetStats:P8,shimSenderReceiverGetStats:The,shimAddTrackRemoveTrackWithNative:Sae,shimAddTrackRemoveTrack:She,shimPeerConnection:Bne,fixNegotiationNeeded:Rhe,shimGetUserMedia:Che,shimGetDisplayMedia:function(s,p){s.navigator.mediaDevices&&"getDisplayMedia"in s.navigator.mediaDevices||s.navigator.mediaDevices&&("function"==typeof p?s.navigator.mediaDevices.getDisplayMedia=function(A){return p(A).then(y=>{const w=A.video&&A.video.width,$=A.video&&A.video.height;return A.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:y,maxFrameRate:A.video&&A.video.frameRate||3}},w&&(A.video.mandatory.maxWidth=w),$&&(A.video.mandatory.maxHeight=$),s.navigator.mediaDevices.getUserMedia(A)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}}),Une={exports:{}};!function(s){var p={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};p.localCName=p.generateIdentifier(),p.splitLines=function(A){return A.trim().split("\n").map(function(y){return y.trim()})},p.splitSections=function(A){return A.split("\nm=").map(function(y,w){return(w>0?"m="+y:y).trim()+"\r\n"})},p.getDescription=function(A){var y=p.splitSections(A);return y&&y[0]},p.getMediaSections=function(A){var y=p.splitSections(A);return y.shift(),y},p.matchPrefix=function(A,y){return p.splitLines(A).filter(function(w){return 0===w.indexOf(y)})},p.parseCandidate=function(A){for(var y,w={foundation:(y=0===A.indexOf("a=candidate:")?A.substring(12).split(" "):A.substring(10).split(" "))[0],component:parseInt(y[1],10),protocol:y[2].toLowerCase(),priority:parseInt(y[3],10),ip:y[4],address:y[4],port:parseInt(y[5],10),type:y[7]},$=8;$<y.length;$+=2)switch(y[$]){case"raddr":w.relatedAddress=y[$+1];break;case"rport":w.relatedPort=parseInt(y[$+1],10);break;case"tcptype":w.tcpType=y[$+1];break;case"ufrag":w.ufrag=y[$+1],w.usernameFragment=y[$+1];break;default:w[y[$]]=y[$+1]}return w},p.writeCandidate=function(A){var y=[];y.push(A.foundation),y.push(A.component),y.push(A.protocol.toUpperCase()),y.push(A.priority),y.push(A.address||A.ip),y.push(A.port);var w=A.type;return y.push("typ"),y.push(w),"host"!==w&&A.relatedAddress&&A.relatedPort&&(y.push("raddr"),y.push(A.relatedAddress),y.push("rport"),y.push(A.relatedPort)),A.tcpType&&"tcp"===A.protocol.toLowerCase()&&(y.push("tcptype"),y.push(A.tcpType)),(A.usernameFragment||A.ufrag)&&(y.push("ufrag"),y.push(A.usernameFragment||A.ufrag)),"candidate:"+y.join(" ")},p.parseIceOptions=function(A){return A.substr(14).split(" ")},p.parseRtpMap=function(A){var y=A.substr(9).split(" "),w={payloadType:parseInt(y.shift(),10)};return y=y[0].split("/"),w.name=y[0],w.clockRate=parseInt(y[1],10),w.channels=3===y.length?parseInt(y[2],10):1,w.numChannels=w.channels,w},p.writeRtpMap=function(A){var y=A.payloadType;void 0!==A.preferredPayloadType&&(y=A.preferredPayloadType);var w=A.channels||A.numChannels||1;return"a=rtpmap:"+y+" "+A.name+"/"+A.clockRate+(1!==w?"/"+w:"")+"\r\n"},p.parseExtmap=function(A){var y=A.substr(9).split(" ");return{id:parseInt(y[0],10),direction:y[0].indexOf("/")>0?y[0].split("/")[1]:"sendrecv",uri:y[1]}},p.writeExtmap=function(A){return"a=extmap:"+(A.id||A.preferredId)+(A.direction&&"sendrecv"!==A.direction?"/"+A.direction:"")+" "+A.uri+"\r\n"},p.parseFmtp=function(A){for(var y,w={},$=A.substr(A.indexOf(" ")+1).split(";"),j=0;j<$.length;j++)w[(y=$[j].trim().split("="))[0].trim()]=y[1];return w},p.writeFmtp=function(A){var y="",w=A.payloadType;if(void 0!==A.preferredPayloadType&&(w=A.preferredPayloadType),A.parameters&&Object.keys(A.parameters).length){var $=[];Object.keys(A.parameters).forEach(function(j){$.push(A.parameters[j]?j+"="+A.parameters[j]:j)}),y+="a=fmtp:"+w+" "+$.join(";")+"\r\n"}return y},p.parseRtcpFb=function(A){var y=A.substr(A.indexOf(" ")+1).split(" ");return{type:y.shift(),parameter:y.join(" ")}},p.writeRtcpFb=function(A){var y="",w=A.payloadType;return void 0!==A.preferredPayloadType&&(w=A.preferredPayloadType),A.rtcpFeedback&&A.rtcpFeedback.length&&A.rtcpFeedback.forEach(function($){y+="a=rtcp-fb:"+w+" "+$.type+($.parameter&&$.parameter.length?" "+$.parameter:"")+"\r\n"}),y},p.parseSsrcMedia=function(A){var y=A.indexOf(" "),w={ssrc:parseInt(A.substr(7,y-7),10)},$=A.indexOf(":",y);return $>-1?(w.attribute=A.substr(y+1,$-y-1),w.value=A.substr($+1)):w.attribute=A.substr(y+1),w},p.parseSsrcGroup=function(A){var y=A.substr(13).split(" ");return{semantics:y.shift(),ssrcs:y.map(function(w){return parseInt(w,10)})}},p.getMid=function(A){var y=p.matchPrefix(A,"a=mid:")[0];if(y)return y.substr(6)},p.parseFingerprint=function(A){var y=A.substr(14).split(" ");return{algorithm:y[0].toLowerCase(),value:y[1]}},p.getDtlsParameters=function(A,y){return{role:"auto",fingerprints:p.matchPrefix(A+y,"a=fingerprint:").map(p.parseFingerprint)}},p.writeDtlsParameters=function(A,y){var w="a=setup:"+y+"\r\n";return A.fingerprints.forEach(function($){w+="a=fingerprint:"+$.algorithm+" "+$.value+"\r\n"}),w},p.getIceParameters=function(A,y){var w=p.splitLines(A);return{usernameFragment:(w=w.concat(p.splitLines(y))).filter(function($){return 0===$.indexOf("a=ice-ufrag:")})[0].substr(12),password:w.filter(function($){return 0===$.indexOf("a=ice-pwd:")})[0].substr(10)}},p.writeIceParameters=function(A){return"a=ice-ufrag:"+A.usernameFragment+"\r\na=ice-pwd:"+A.password+"\r\n"},p.parseRtpParameters=function(A){for(var y={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},w=p.splitLines(A)[0].split(" "),$=3;$<w.length;$++){var j=w[$],_e=p.matchPrefix(A,"a=rtpmap:"+j+" ")[0];if(_e){var K=p.parseRtpMap(_e),_i=p.matchPrefix(A,"a=fmtp:"+j+" ");switch(K.parameters=_i.length?p.parseFmtp(_i[0]):{},K.rtcpFeedback=p.matchPrefix(A,"a=rtcp-fb:"+j+" ").map(p.parseRtcpFb),y.codecs.push(K),K.name.toUpperCase()){case"RED":case"ULPFEC":y.fecMechanisms.push(K.name.toUpperCase())}}}return p.matchPrefix(A,"a=extmap:").forEach(function(_o){y.headerExtensions.push(p.parseExtmap(_o))}),y},p.writeRtpDescription=function(A,y){var w="";w+="m="+A+" ",w+=y.codecs.length>0?"9":"0",w+=" UDP/TLS/RTP/SAVPF ",w+=y.codecs.map(function(j){return void 0!==j.preferredPayloadType?j.preferredPayloadType:j.payloadType}).join(" ")+"\r\n",w+="c=IN IP4 0.0.0.0\r\n",w+="a=rtcp:9 IN IP4 0.0.0.0\r\n",y.codecs.forEach(function(j){w+=p.writeRtpMap(j),w+=p.writeFmtp(j),w+=p.writeRtcpFb(j)});var $=0;return y.codecs.forEach(function(j){j.maxptime>$&&($=j.maxptime)}),$>0&&(w+="a=maxptime:"+$+"\r\n"),w+="a=rtcp-mux\r\n",y.headerExtensions&&y.headerExtensions.forEach(function(j){w+=p.writeExtmap(j)}),w},p.parseRtpEncodingParameters=function(A){var y,w=[],$=p.parseRtpParameters(A),j=-1!==$.fecMechanisms.indexOf("RED"),_e=-1!==$.fecMechanisms.indexOf("ULPFEC"),K=p.matchPrefix(A,"a=ssrc:").map(function(ch){return p.parseSsrcMedia(ch)}).filter(function(ch){return"cname"===ch.attribute}),_i=K.length>0&&K[0].ssrc,_o=p.matchPrefix(A,"a=ssrc-group:FID").map(function(ch){return ch.substr(17).split(" ").map(function(_f){return parseInt(_f,10)})});_o.length>0&&_o[0].length>1&&_o[0][0]===_i&&(y=_o[0][1]),$.codecs.forEach(function(ch){if("RTX"===ch.name.toUpperCase()&&ch.parameters.apt){var _f={ssrc:_i,codecPayloadType:parseInt(ch.parameters.apt,10)};_i&&y&&(_f.rtx={ssrc:y}),w.push(_f),j&&((_f=JSON.parse(JSON.stringify(_f))).fec={ssrc:_i,mechanism:_e?"red+ulpfec":"red"},w.push(_f))}}),0===w.length&&_i&&w.push({ssrc:_i});var _u=p.matchPrefix(A,"b=");return _u.length&&(_u=0===_u[0].indexOf("b=TIAS:")?parseInt(_u[0].substr(7),10):0===_u[0].indexOf("b=AS:")?1e3*parseInt(_u[0].substr(5),10)*.95-16e3:void 0,w.forEach(function(ch){ch.maxBitrate=_u})),w},p.parseRtcpParameters=function(A){var y={},w=p.matchPrefix(A,"a=ssrc:").map(function(_e){return p.parseSsrcMedia(_e)}).filter(function(_e){return"cname"===_e.attribute})[0];w&&(y.cname=w.value,y.ssrc=w.ssrc);var $=p.matchPrefix(A,"a=rtcp-rsize");y.reducedSize=$.length>0,y.compound=0===$.length;var j=p.matchPrefix(A,"a=rtcp-mux");return y.mux=j.length>0,y},p.parseMsid=function(A){var y,w=p.matchPrefix(A,"a=msid:");if(1===w.length)return{stream:(y=w[0].substr(7).split(" "))[0],track:y[1]};var $=p.matchPrefix(A,"a=ssrc:").map(function(j){return p.parseSsrcMedia(j)}).filter(function(j){return"msid"===j.attribute});return $.length>0?{stream:(y=$[0].value.split(" "))[0],track:y[1]}:void 0},p.generateSessionId=function(){return Math.random().toString().substr(2,21)},p.writeSessionBoilerplate=function(A,y,w){var $=void 0!==y?y:2;return"v=0\r\no="+(w||"thisisadapterortc")+" "+(A||p.generateSessionId())+" "+$+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},p.writeMediaSection=function(A,y,w,$){var j=p.writeRtpDescription(A.kind,y);if(j+=p.writeIceParameters(A.iceGatherer.getLocalParameters()),j+=p.writeDtlsParameters(A.dtlsTransport.getLocalParameters(),"offer"===w?"actpass":"active"),j+="a=mid:"+A.mid+"\r\n",j+=A.direction?"a="+A.direction+"\r\n":A.rtpSender&&A.rtpReceiver?"a=sendrecv\r\n":A.rtpSender?"a=sendonly\r\n":A.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",A.rtpSender){var _e="msid:"+$.id+" "+A.rtpSender.track.id+"\r\n";j+="a="+_e,j+="a=ssrc:"+A.sendEncodingParameters[0].ssrc+" "+_e,A.sendEncodingParameters[0].rtx&&(j+="a=ssrc:"+A.sendEncodingParameters[0].rtx.ssrc+" "+_e,j+="a=ssrc-group:FID "+A.sendEncodingParameters[0].ssrc+" "+A.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return j+="a=ssrc:"+A.sendEncodingParameters[0].ssrc+" cname:"+p.localCName+"\r\n",A.rtpSender&&A.sendEncodingParameters[0].rtx&&(j+="a=ssrc:"+A.sendEncodingParameters[0].rtx.ssrc+" cname:"+p.localCName+"\r\n"),j},p.getDirection=function(A,y){for(var w=p.splitLines(A),$=0;$<w.length;$++)switch(w[$]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return w[$].substr(2)}return y?p.getDirection(y):"sendrecv"},p.getKind=function(A){return p.splitLines(A)[0].split(" ")[0].substr(2)},p.isRejected=function(A){return"0"===A.split(" ",2)[1]},p.parseMLine=function(A){var y=p.splitLines(A)[0].substr(2).split(" ");return{kind:y[0],port:parseInt(y[1],10),protocol:y[2],fmt:y.slice(3).join(" ")}},p.parseOLine=function(A){var y=p.matchPrefix(A,"o=")[0].substr(2).split(" ");return{username:y[0],sessionId:y[1],sessionVersion:parseInt(y[2],10),netType:y[3],addressType:y[4],address:y[5]}},p.isValidSDP=function(A){if("string"!=typeof A||0===A.length)return!1;for(var y=p.splitLines(A),w=0;w<y.length;w++)if(y[w].length<2||"="!==y[w].charAt(1))return!1;return!0},s.exports=p}(Une);var c1=Une.exports;function Dhe(s,p,A,y,w){var $=c1.writeRtpDescription(s.kind,p);if($+=c1.writeIceParameters(s.iceGatherer.getLocalParameters()),$+=c1.writeDtlsParameters(s.dtlsTransport.getLocalParameters(),"offer"===A?"actpass":w||"active"),$+="a=mid:"+s.mid+"\r\n",$+=s.rtpSender&&s.rtpReceiver?"a=sendrecv\r\n":s.rtpSender?"a=sendonly\r\n":s.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",s.rtpSender){var j=s.rtpSender._initialTrackId||s.rtpSender.track.id;s.rtpSender._initialTrackId=j;var _e="msid:"+(y?y.id:"-")+" "+j+"\r\n";$+="a="+_e,$+="a=ssrc:"+s.sendEncodingParameters[0].ssrc+" "+_e,s.sendEncodingParameters[0].rtx&&($+="a=ssrc:"+s.sendEncodingParameters[0].rtx.ssrc+" "+_e,$+="a=ssrc-group:FID "+s.sendEncodingParameters[0].ssrc+" "+s.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return $+="a=ssrc:"+s.sendEncodingParameters[0].ssrc+" cname:"+c1.localCName+"\r\n",s.rtpSender&&s.sendEncodingParameters[0].rtx&&($+="a=ssrc:"+s.sendEncodingParameters[0].rtx.ssrc+" cname:"+c1.localCName+"\r\n"),$}function J$(s,p){var A={codecs:[],headerExtensions:[],fecMechanisms:[]},y=function($,j){$=parseInt($,10);for(var _e=0;_e<j.length;_e++)if(j[_e].payloadType===$||j[_e].preferredPayloadType===$)return j[_e]},w=function($,j,_e,K){var _i=y($.parameters.apt,_e),_o=y(j.parameters.apt,K);return _i&&_o&&_i.name.toLowerCase()===_o.name.toLowerCase()};return s.codecs.forEach(function($){for(var j=0;j<p.codecs.length;j++){var _e=p.codecs[j];if($.name.toLowerCase()===_e.name.toLowerCase()&&$.clockRate===_e.clockRate){if("rtx"===$.name.toLowerCase()&&$.parameters&&_e.parameters.apt&&!w($,_e,s.codecs,p.codecs))continue;(_e=JSON.parse(JSON.stringify(_e))).numChannels=Math.min($.numChannels,_e.numChannels),A.codecs.push(_e),_e.rtcpFeedback=_e.rtcpFeedback.filter(function(K){for(var _i=0;_i<$.rtcpFeedback.length;_i++)if($.rtcpFeedback[_i].type===K.type&&$.rtcpFeedback[_i].parameter===K.parameter)return!0;return!1});break}}}),s.headerExtensions.forEach(function($){for(var j=0;j<p.headerExtensions.length;j++){var _e=p.headerExtensions[j];if($.uri===_e.uri){A.headerExtensions.push(_e);break}}}),A}function Nhe(s,p,A){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[p][s].indexOf(A)}function Fne(s,p){var A=s.getRemoteCandidates().find(function(y){return p.foundation===y.foundation&&p.ip===y.ip&&p.port===y.port&&p.priority===y.priority&&p.protocol===y.protocol&&p.type===y.type});return A||s.addRemoteCandidate(p),!A}function t2(s,p){var A=new Error(p);return A.name=s,A.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[s],A}function Phe(s){const p=s&&s.navigator,A=p.mediaDevices.getUserMedia.bind(p.mediaDevices);p.mediaDevices.getUserMedia=function(y){return A(y).catch(w=>{return iI.reject({name:{PermissionDeniedError:"NotAllowedError"}[($=w).name]||$.name,message:$.message,constraint:$.constraint,toString(){return this.name}});var $})}}function Rae(s){"getDisplayMedia"in s.navigator&&s.navigator.mediaDevices&&(s.navigator.mediaDevices&&"getDisplayMedia"in s.navigator.mediaDevices||(s.navigator.mediaDevices.getDisplayMedia=s.navigator.getDisplayMedia.bind(s.navigator)))}function xhe(s,p){if(s.RTCIceGatherer&&(s.RTCIceCandidate||(s.RTCIceCandidate=function(y){return y}),s.RTCSessionDescription||(s.RTCSessionDescription=function(y){return y}),p.version<15025)){const y=Object.getOwnPropertyDescriptor(s.MediaStreamTrack.prototype,"enabled");Object.defineProperty(s.MediaStreamTrack.prototype,"enabled",{set(w){y.set.call(this,w);const $=new Event("enabled");$.enabled=w,this.dispatchEvent($)}})}s.RTCRtpSender&&!("dtmf"in s.RTCRtpSender.prototype)&&Object.defineProperty(s.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new s.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),s.RTCDtmfSender&&!s.RTCDTMFSender&&(s.RTCDTMFSender=s.RTCDtmfSender);const A=function(s,p){function A(j,_e){_e.addTrack(j),_e.dispatchEvent(new s.MediaStreamTrackEvent("addtrack",{track:j}))}function y(j,_e,K,_i){var _o=new Event("track");_o.track=_e,_o.receiver=K,_o.transceiver={receiver:K},_o.streams=_i,s.setTimeout(function(){j._dispatchEvent("track",_o)})}var w=function(j){var _o,_u,ch,_e=this,K=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(_o){_e[_o]=K[_o].bind(K)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",j=JSON.parse(JSON.stringify(j||{})),this.usingBundle="max-bundle"===j.bundlePolicy,"negotiate"===j.rtcpMuxPolicy)throw t2("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(j.rtcpMuxPolicy||(j.rtcpMuxPolicy="require"),j.iceTransportPolicy){case"all":case"relay":break;default:j.iceTransportPolicy="all"}switch(j.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:j.bundlePolicy="balanced"}if(j.iceServers=(_o=j.iceServers||[],_u=p,ch=!1,(_o=JSON.parse(JSON.stringify(_o))).filter(function(_f){if(_f&&(_f.urls||_f.url)){var o_=_f.urls||_f.url;_f.url&&!_f.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i_="string"==typeof o_;return i_&&(o_=[o_]),o_=o_.filter(function(u_){return 0!==u_.indexOf("turn:")||-1===u_.indexOf("transport=udp")||-1!==u_.indexOf("turn:[")||ch?0===u_.indexOf("stun:")&&_u>=14393&&-1===u_.indexOf("?transport=udp"):(ch=!0,!0)}),delete _f.url,_f.urls=i_?o_[0]:o_,!!o_.length}})),this._iceGatherers=[],j.iceCandidatePoolSize)for(var _i=j.iceCandidatePoolSize;_i>0;_i--)this._iceGatherers.push(new s.RTCIceGatherer({iceServers:j.iceServers,gatherPolicy:j.iceTransportPolicy}));else j.iceCandidatePoolSize=0;this._config=j,this.transceivers=[],this._sdpSessionId=c1.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(w.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(w.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),w.prototype.onicecandidate=null,w.prototype.onaddstream=null,w.prototype.ontrack=null,w.prototype.onremovestream=null,w.prototype.onsignalingstatechange=null,w.prototype.oniceconnectionstatechange=null,w.prototype.onconnectionstatechange=null,w.prototype.onicegatheringstatechange=null,w.prototype.onnegotiationneeded=null,w.prototype.ondatachannel=null,w.prototype._dispatchEvent=function(j,_e){this._isClosed||(this.dispatchEvent(_e),"function"==typeof this["on"+j]&&this["on"+j](_e))},w.prototype._emitGatheringStateChange=function(){var j=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",j)},w.prototype.getConfiguration=function(){return this._config},w.prototype.getLocalStreams=function(){return this.localStreams},w.prototype.getRemoteStreams=function(){return this.remoteStreams},w.prototype._createTransceiver=function(j,_e){var _i={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:j,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&this.transceivers.length>0)_i.iceTransport=this.transceivers[0].iceTransport,_i.dtlsTransport=this.transceivers[0].dtlsTransport;else{var _o=this._createIceAndDtlsTransports();_i.iceTransport=_o.iceTransport,_i.dtlsTransport=_o.dtlsTransport}return _e||this.transceivers.push(_i),_i},w.prototype.addTrack=function(j,_e){if(this._isClosed)throw t2("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var K;if(this.transceivers.find(function(_o){return _o.track===j}))throw t2("InvalidAccessError","Track already exists.");for(var _i=0;_i<this.transceivers.length;_i++)this.transceivers[_i].track||this.transceivers[_i].kind!==j.kind||(K=this.transceivers[_i]);return K||(K=this._createTransceiver(j.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(_e)&&this.localStreams.push(_e),K.track=j,K.stream=_e,K.rtpSender=new s.RTCRtpSender(j,K.dtlsTransport),K.rtpSender},w.prototype.addStream=function(j){var _e=this;if(p>=15025)j.getTracks().forEach(function(_i){_e.addTrack(_i,j)});else{var K=j.clone();j.getTracks().forEach(function(_i,_o){var _u=K.getTracks()[_o];_i.addEventListener("enabled",function(ch){_u.enabled=ch.enabled})}),K.getTracks().forEach(function(_i){_e.addTrack(_i,K)})}},w.prototype.removeTrack=function(j){if(this._isClosed)throw t2("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(j instanceof s.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var _e=this.transceivers.find(function(_i){return _i.rtpSender===j});if(!_e)throw t2("InvalidAccessError","Sender was not created by this connection.");var K=_e.stream;_e.rtpSender.stop(),_e.rtpSender=null,_e.track=null,_e.stream=null,-1===this.transceivers.map(function(_i){return _i.stream}).indexOf(K)&&this.localStreams.indexOf(K)>-1&&this.localStreams.splice(this.localStreams.indexOf(K),1),this._maybeFireNegotiationNeeded()},w.prototype.removeStream=function(j){var _e=this;j.getTracks().forEach(function(K){var _i=_e.getSenders().find(function(_o){return _o.track===K});_i&&_e.removeTrack(_i)})},w.prototype.getSenders=function(){return this.transceivers.filter(function(j){return!!j.rtpSender}).map(function(j){return j.rtpSender})},w.prototype.getReceivers=function(){return this.transceivers.filter(function(j){return!!j.rtpReceiver}).map(function(j){return j.rtpReceiver})},w.prototype._createIceGatherer=function(j,_e){var K=this;if(_e&&j>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var _i=new s.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(_i,"state",{value:"new",writable:!0}),this.transceivers[j].bufferedCandidateEvents=[],this.transceivers[j].bufferCandidates=function(_o){var _u=!_o.candidate||0===Object.keys(_o.candidate).length;_i.state=_u?"completed":"gathering",null!==K.transceivers[j].bufferedCandidateEvents&&K.transceivers[j].bufferedCandidateEvents.push(_o)},_i.addEventListener("localcandidate",this.transceivers[j].bufferCandidates),_i},w.prototype._gather=function(j,_e){var K=this,_i=this.transceivers[_e].iceGatherer;if(!_i.onlocalcandidate){var _o=this.transceivers[_e].bufferedCandidateEvents;this.transceivers[_e].bufferedCandidateEvents=null,_i.removeEventListener("localcandidate",this.transceivers[_e].bufferCandidates),_i.onlocalcandidate=function(_u){if(!(K.usingBundle&&_e>0)){var ch=new Event("icecandidate");ch.candidate={sdpMid:j,sdpMLineIndex:_e};var _f=_u.candidate,o_=!_f||0===Object.keys(_f).length;if(o_)"new"!==_i.state&&"gathering"!==_i.state||(_i.state="completed");else{"new"===_i.state&&(_i.state="gathering"),_f.component=1,_f.ufrag=_i.getLocalParameters().usernameFragment;var i_=c1.writeCandidate(_f);ch.candidate=Object.assign(ch.candidate,c1.parseCandidate(i_)),ch.candidate.candidate=i_,ch.candidate.toJSON=function(){return{candidate:ch.candidate.candidate,sdpMid:ch.candidate.sdpMid,sdpMLineIndex:ch.candidate.sdpMLineIndex,usernameFragment:ch.candidate.usernameFragment}}}var u_=c1.getMediaSections(K._localDescription.sdp);u_[ch.candidate.sdpMLineIndex]+=o_?"a=end-of-candidates\r\n":"a="+ch.candidate.candidate+"\r\n",K._localDescription.sdp=c1.getDescription(K._localDescription.sdp)+u_.join("");var g_=K.transceivers.every(function(__){return __.iceGatherer&&"completed"===__.iceGatherer.state});"gathering"!==K.iceGatheringState&&(K.iceGatheringState="gathering",K._emitGatheringStateChange()),o_||K._dispatchEvent("icecandidate",ch),g_&&(K._dispatchEvent("icecandidate",new Event("icecandidate")),K.iceGatheringState="complete",K._emitGatheringStateChange())}},s.setTimeout(function(){_o.forEach(function(_u){_i.onlocalcandidate(_u)})},0)}},w.prototype._createIceAndDtlsTransports=function(){var j=this,_e=new s.RTCIceTransport(null);_e.onicestatechange=function(){j._updateIceConnectionState(),j._updateConnectionState()};var K=new s.RTCDtlsTransport(_e);return K.ondtlsstatechange=function(){j._updateConnectionState()},K.onerror=function(){Object.defineProperty(K,"state",{value:"failed",writable:!0}),j._updateConnectionState()},{iceTransport:_e,dtlsTransport:K}},w.prototype._disposeIceAndDtlsTransports=function(j){var _e=this.transceivers[j].iceGatherer;_e&&(delete _e.onlocalcandidate,delete this.transceivers[j].iceGatherer);var K=this.transceivers[j].iceTransport;K&&(delete K.onicestatechange,delete this.transceivers[j].iceTransport);var _i=this.transceivers[j].dtlsTransport;_i&&(delete _i.ondtlsstatechange,delete _i.onerror,delete this.transceivers[j].dtlsTransport)},w.prototype._transceive=function(j,_e,K){var _i=J$(j.localCapabilities,j.remoteCapabilities);_e&&j.rtpSender&&(_i.encodings=j.sendEncodingParameters,_i.rtcp={cname:c1.localCName,compound:j.rtcpParameters.compound},j.recvEncodingParameters.length&&(_i.rtcp.ssrc=j.recvEncodingParameters[0].ssrc),j.rtpSender.send(_i)),K&&j.rtpReceiver&&_i.codecs.length>0&&("video"===j.kind&&j.recvEncodingParameters&&p<15019&&j.recvEncodingParameters.forEach(function(_o){delete _o.rtx}),_i.encodings=j.recvEncodingParameters.length?j.recvEncodingParameters:[{}],_i.rtcp={compound:j.rtcpParameters.compound},j.rtcpParameters.cname&&(_i.rtcp.cname=j.rtcpParameters.cname),j.sendEncodingParameters.length&&(_i.rtcp.ssrc=j.sendEncodingParameters[0].ssrc),j.rtpReceiver.receive(_i))},w.prototype.setLocalDescription=function(j){var _e,K,_i=this;if(-1===["offer","answer"].indexOf(j.type))return Promise.reject(t2("TypeError",'Unsupported type "'+j.type+'"'));if(!Nhe("setLocalDescription",j.type,_i.signalingState)||_i._isClosed)return Promise.reject(t2("InvalidStateError","Can not set local "+j.type+" in state "+_i.signalingState));if("offer"===j.type)_e=c1.splitSections(j.sdp),K=_e.shift(),_e.forEach(function(_u,ch){var _f=c1.parseRtpParameters(_u);_i.transceivers[ch].localCapabilities=_f}),_i.transceivers.forEach(function(_u,ch){_i._gather(_u.mid,ch)});else if("answer"===j.type){_e=c1.splitSections(_i._remoteDescription.sdp),K=_e.shift();var _o=c1.matchPrefix(K,"a=ice-lite").length>0;_e.forEach(function(_u,ch){var _f=_i.transceivers[ch],o_=_f.iceGatherer,i_=_f.iceTransport,u_=_f.dtlsTransport,g_=_f.localCapabilities,__=_f.remoteCapabilities;if(!(c1.isRejected(_u)&&0===c1.matchPrefix(_u,"a=bundle-only").length||_f.rejected)){var w_=c1.getIceParameters(_u,K),k_=c1.getDtlsParameters(_u,K);_o&&(k_.role="server"),_i.usingBundle&&0!==ch||(_i._gather(_f.mid,ch),"new"===i_.state&&i_.start(o_,w_,_o?"controlling":"controlled"),"new"===u_.state&&u_.start(k_));var Rv=J$(g_,__);_i._transceive(_f,Rv.codecs.length>0,!1)}})}return _i._localDescription={type:j.type,sdp:j.sdp},_i._updateSignalingState("offer"===j.type?"have-local-offer":"stable"),Promise.resolve()},w.prototype.setRemoteDescription=function(j){var _e=this;if(-1===["offer","answer"].indexOf(j.type))return Promise.reject(t2("TypeError",'Unsupported type "'+j.type+'"'));if(!Nhe("setRemoteDescription",j.type,_e.signalingState)||_e._isClosed)return Promise.reject(t2("InvalidStateError","Can not set remote "+j.type+" in state "+_e.signalingState));var K={};_e.remoteStreams.forEach(function(i_){K[i_.id]=i_});var _i=[],_o=c1.splitSections(j.sdp),_u=_o.shift(),ch=c1.matchPrefix(_u,"a=ice-lite").length>0,_f=c1.matchPrefix(_u,"a=group:BUNDLE ").length>0;_e.usingBundle=_f;var o_=c1.matchPrefix(_u,"a=ice-options:")[0];return _e.canTrickleIceCandidates=!!o_&&o_.substr(14).split(" ").indexOf("trickle")>=0,_o.forEach(function(i_,u_){var g_=c1.splitLines(i_),__=c1.getKind(i_),w_=c1.isRejected(i_)&&0===c1.matchPrefix(i_,"a=bundle-only").length,k_=g_[0].substr(2).split(" ")[2],Rv=c1.getDirection(i_,_u),f0=c1.parseMsid(i_),y0=c1.getMid(i_)||c1.generateIdentifier();if(w_||"application"===__&&("DTLS/SCTP"===k_||"UDP/DTLS/SCTP"===k_))_e.transceivers[u_]={mid:y0,kind:__,protocol:k_,rejected:!0};else{var b0,rI,q0,Z0,a0,j_,Z_,o0,z0;!w_&&_e.transceivers[u_]&&_e.transceivers[u_].rejected&&(_e.transceivers[u_]=_e._createTransceiver(__,!0));var q_,X_,u0=c1.parseRtpParameters(i_);w_||(q_=c1.getIceParameters(i_,_u),(X_=c1.getDtlsParameters(i_,_u)).role="client"),Z_=c1.parseRtpEncodingParameters(i_);var B0=c1.parseRtcpParameters(i_),$0=c1.matchPrefix(i_,"a=end-of-candidates",_u).length>0,A0=c1.matchPrefix(i_,"a=candidate:").map(function(D_){return c1.parseCandidate(D_)}).filter(function(D_){return 1===D_.component});if(("offer"===j.type||"answer"===j.type)&&!w_&&_f&&u_>0&&_e.transceivers[u_]&&(_e._disposeIceAndDtlsTransports(u_),_e.transceivers[u_].iceGatherer=_e.transceivers[0].iceGatherer,_e.transceivers[u_].iceTransport=_e.transceivers[0].iceTransport,_e.transceivers[u_].dtlsTransport=_e.transceivers[0].dtlsTransport,_e.transceivers[u_].rtpSender&&_e.transceivers[u_].rtpSender.setTransport(_e.transceivers[0].dtlsTransport),_e.transceivers[u_].rtpReceiver&&_e.transceivers[u_].rtpReceiver.setTransport(_e.transceivers[0].dtlsTransport)),"offer"!==j.type||w_)"answer"===j.type&&!w_&&(rI=(b0=_e.transceivers[u_]).iceGatherer,q0=b0.iceTransport,Z0=b0.dtlsTransport,a0=b0.rtpReceiver,j_=b0.sendEncodingParameters,o0=b0.localCapabilities,_e.transceivers[u_].recvEncodingParameters=Z_,_e.transceivers[u_].remoteCapabilities=u0,_e.transceivers[u_].rtcpParameters=B0,A0.length&&"new"===q0.state&&(!ch&&!$0||_f&&0!==u_?A0.forEach(function(D_){Fne(b0.iceTransport,D_)}):q0.setRemoteCandidates(A0)),_f&&0!==u_||("new"===q0.state&&q0.start(rI,q_,"controlling"),"new"===Z0.state&&Z0.start(X_)),!J$(b0.localCapabilities,b0.remoteCapabilities).codecs.filter(function(D_){return"rtx"===D_.name.toLowerCase()}).length&&b0.sendEncodingParameters[0].rtx&&delete b0.sendEncodingParameters[0].rtx,_e._transceive(b0,"sendrecv"===Rv||"recvonly"===Rv,"sendrecv"===Rv||"sendonly"===Rv),!a0||"sendrecv"!==Rv&&"sendonly"!==Rv?delete b0.rtpReceiver:(z0=a0.track,f0?(K[f0.stream]||(K[f0.stream]=new s.MediaStream),A(z0,K[f0.stream]),_i.push([z0,a0,K[f0.stream]])):(K.default||(K.default=new s.MediaStream),A(z0,K.default),_i.push([z0,a0,K.default]))));else{(b0=_e.transceivers[u_]||_e._createTransceiver(__)).mid=y0,b0.iceGatherer||(b0.iceGatherer=_e._createIceGatherer(u_,_f)),A0.length&&"new"===b0.iceTransport.state&&(!$0||_f&&0!==u_?A0.forEach(function(D_){Fne(b0.iceTransport,D_)}):b0.iceTransport.setRemoteCandidates(A0)),o0=s.RTCRtpReceiver.getCapabilities(__),p<15019&&(o0.codecs=o0.codecs.filter(function(D_){return"rtx"!==D_.name})),j_=b0.sendEncodingParameters||[{ssrc:1001*(2*u_+2)}];var e_,y_=!1;"sendrecv"===Rv||"sendonly"===Rv?(y_=!b0.rtpReceiver,a0=b0.rtpReceiver||new s.RTCRtpReceiver(b0.dtlsTransport,__),y_&&(z0=a0.track,f0&&"-"===f0.stream||(f0?(K[f0.stream]||(K[f0.stream]=new s.MediaStream,Object.defineProperty(K[f0.stream],"id",{get:function(){return f0.stream}})),Object.defineProperty(z0,"id",{get:function(){return f0.track}}),e_=K[f0.stream]):(K.default||(K.default=new s.MediaStream),e_=K.default)),e_&&(A(z0,e_),b0.associatedRemoteMediaStreams.push(e_)),_i.push([z0,a0,e_]))):b0.rtpReceiver&&b0.rtpReceiver.track&&(b0.associatedRemoteMediaStreams.forEach(function(D_){var K0,FI,d0=D_.getTracks().find(function(K0){return K0.id===b0.rtpReceiver.track.id});d0&&((FI=D_).removeTrack(K0=d0),FI.dispatchEvent(new s.MediaStreamTrackEvent("removetrack",{track:K0})))}),b0.associatedRemoteMediaStreams=[]),b0.localCapabilities=o0,b0.remoteCapabilities=u0,b0.rtpReceiver=a0,b0.rtcpParameters=B0,b0.sendEncodingParameters=j_,b0.recvEncodingParameters=Z_,_e._transceive(_e.transceivers[u_],!1,y_)}}}),void 0===_e._dtlsRole&&(_e._dtlsRole="offer"===j.type?"active":"passive"),_e._remoteDescription={type:j.type,sdp:j.sdp},_e._updateSignalingState("offer"===j.type?"have-remote-offer":"stable"),Object.keys(K).forEach(function(i_){var u_=K[i_];if(u_.getTracks().length){if(-1===_e.remoteStreams.indexOf(u_)){_e.remoteStreams.push(u_);var g_=new Event("addstream");g_.stream=u_,s.setTimeout(function(){_e._dispatchEvent("addstream",g_)})}_i.forEach(function(__){u_.id===__[2].id&&y(_e,__[0],__[1],[u_])})}}),_i.forEach(function(i_){i_[2]||y(_e,i_[0],i_[1],[])}),s.setTimeout(function(){_e&&_e.transceivers&&_e.transceivers.forEach(function(i_){i_.iceTransport&&"new"===i_.iceTransport.state&&i_.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),i_.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},w.prototype.close=function(){this.transceivers.forEach(function(j){j.iceTransport&&j.iceTransport.stop(),j.dtlsTransport&&j.dtlsTransport.stop(),j.rtpSender&&j.rtpSender.stop(),j.rtpReceiver&&j.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},w.prototype._updateSignalingState=function(j){this.signalingState=j;var _e=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",_e)},w.prototype._maybeFireNegotiationNeeded=function(){var j=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,s.setTimeout(function(){if(j.needNegotiation){j.needNegotiation=!1;var _e=new Event("negotiationneeded");j._dispatchEvent("negotiationneeded",_e)}},0))},w.prototype._updateIceConnectionState=function(){var j,_e={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(_i){_i.iceTransport&&!_i.rejected&&_e[_i.iceTransport.state]++}),j="new",_e.failed>0?j="failed":_e.checking>0?j="checking":_e.disconnected>0?j="disconnected":_e.new>0?j="new":_e.connected>0?j="connected":_e.completed>0&&(j="completed"),j!==this.iceConnectionState){this.iceConnectionState=j;var K=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",K)}},w.prototype._updateConnectionState=function(){var j,_e={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(_i){_i.iceTransport&&_i.dtlsTransport&&!_i.rejected&&(_e[_i.iceTransport.state]++,_e[_i.dtlsTransport.state]++)}),_e.connected+=_e.completed,j="new",_e.failed>0?j="failed":_e.connecting>0?j="connecting":_e.disconnected>0?j="disconnected":_e.new>0?j="new":_e.connected>0&&(j="connected"),j!==this.connectionState){this.connectionState=j;var K=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",K)}},w.prototype.createOffer=function(){var j=this;if(j._isClosed)return Promise.reject(t2("InvalidStateError","Can not call createOffer after close"));var _e=j.transceivers.filter(function(ch){return"audio"===ch.kind}).length,K=j.transceivers.filter(function(ch){return"video"===ch.kind}).length,_i=arguments[0];if(_i){if(_i.mandatory||_i.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==_i.offerToReceiveAudio&&(_e=!0===_i.offerToReceiveAudio?1:!1===_i.offerToReceiveAudio?0:_i.offerToReceiveAudio),void 0!==_i.offerToReceiveVideo&&(K=!0===_i.offerToReceiveVideo?1:!1===_i.offerToReceiveVideo?0:_i.offerToReceiveVideo)}for(j.transceivers.forEach(function(ch){"audio"===ch.kind?--_e<0&&(ch.wantReceive=!1):"video"===ch.kind&&--K<0&&(ch.wantReceive=!1)});_e>0||K>0;)_e>0&&(j._createTransceiver("audio"),_e--),K>0&&(j._createTransceiver("video"),K--);var _o=c1.writeSessionBoilerplate(j._sdpSessionId,j._sdpSessionVersion++);j.transceivers.forEach(function(ch,_f){var o_=ch.track,i_=ch.kind,u_=ch.mid||c1.generateIdentifier();ch.mid=u_,ch.iceGatherer||(ch.iceGatherer=j._createIceGatherer(_f,j.usingBundle));var g_=s.RTCRtpSender.getCapabilities(i_);p<15019&&(g_.codecs=g_.codecs.filter(function(w_){return"rtx"!==w_.name})),g_.codecs.forEach(function(w_){"H264"===w_.name&&void 0===w_.parameters["level-asymmetry-allowed"]&&(w_.parameters["level-asymmetry-allowed"]="1"),ch.remoteCapabilities&&ch.remoteCapabilities.codecs&&ch.remoteCapabilities.codecs.forEach(function(k_){w_.name.toLowerCase()===k_.name.toLowerCase()&&w_.clockRate===k_.clockRate&&(w_.preferredPayloadType=k_.payloadType)})}),g_.headerExtensions.forEach(function(w_){(ch.remoteCapabilities&&ch.remoteCapabilities.headerExtensions||[]).forEach(function(k_){w_.uri===k_.uri&&(w_.id=k_.id)})});var __=ch.sendEncodingParameters||[{ssrc:1001*(2*_f+1)}];o_&&p>=15019&&"video"===i_&&!__[0].rtx&&(__[0].rtx={ssrc:__[0].ssrc+1}),ch.wantReceive&&(ch.rtpReceiver=new s.RTCRtpReceiver(ch.dtlsTransport,i_)),ch.localCapabilities=g_,ch.sendEncodingParameters=__}),"max-compat"!==j._config.bundlePolicy&&(_o+="a=group:BUNDLE "+j.transceivers.map(function(ch){return ch.mid}).join(" ")+"\r\n"),_o+="a=ice-options:trickle\r\n",j.transceivers.forEach(function(ch,_f){_o+=Dhe(ch,ch.localCapabilities,"offer",ch.stream,j._dtlsRole),_o+="a=rtcp-rsize\r\n",!ch.iceGatherer||"new"===j.iceGatheringState||0!==_f&&j.usingBundle||(ch.iceGatherer.getLocalCandidates().forEach(function(o_){o_.component=1,_o+="a="+c1.writeCandidate(o_)+"\r\n"}),"completed"===ch.iceGatherer.state&&(_o+="a=end-of-candidates\r\n"))});var _u=new s.RTCSessionDescription({type:"offer",sdp:_o});return Promise.resolve(_u)},w.prototype.createAnswer=function(){var j=this;if(j._isClosed)return Promise.reject(t2("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==j.signalingState&&"have-local-pranswer"!==j.signalingState)return Promise.reject(t2("InvalidStateError","Can not call createAnswer in signalingState "+j.signalingState));var _e=c1.writeSessionBoilerplate(j._sdpSessionId,j._sdpSessionVersion++);j.usingBundle&&(_e+="a=group:BUNDLE "+j.transceivers.map(function(_o){return _o.mid}).join(" ")+"\r\n"),_e+="a=ice-options:trickle\r\n";var K=c1.getMediaSections(j._remoteDescription.sdp).length;j.transceivers.forEach(function(_o,_u){if(!(_u+1>K)){if(_o.rejected)return"application"===_o.kind?_e+="DTLS/SCTP"===_o.protocol?"m=application 0 DTLS/SCTP 5000\r\n":"m=application 0 "+_o.protocol+" webrtc-datachannel\r\n":"audio"===_o.kind?_e+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===_o.kind&&(_e+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(_e+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+_o.mid+"\r\n");var ch;_o.stream&&("audio"===_o.kind?ch=_o.stream.getAudioTracks()[0]:"video"===_o.kind&&(ch=_o.stream.getVideoTracks()[0]),ch&&p>=15019&&"video"===_o.kind&&!_o.sendEncodingParameters[0].rtx&&(_o.sendEncodingParameters[0].rtx={ssrc:_o.sendEncodingParameters[0].ssrc+1}));var _f=J$(_o.localCapabilities,_o.remoteCapabilities);!_f.codecs.filter(function(o_){return"rtx"===o_.name.toLowerCase()}).length&&_o.sendEncodingParameters[0].rtx&&delete _o.sendEncodingParameters[0].rtx,_e+=Dhe(_o,_f,"answer",_o.stream,j._dtlsRole),_o.rtcpParameters&&_o.rtcpParameters.reducedSize&&(_e+="a=rtcp-rsize\r\n")}});var _i=new s.RTCSessionDescription({type:"answer",sdp:_e});return Promise.resolve(_i)},w.prototype.addIceCandidate=function(j){var _e,K=this;return j&&void 0===j.sdpMLineIndex&&!j.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(_i,_o){if(!K._remoteDescription)return _o(t2("InvalidStateError","Can not add ICE candidate without a remote description"));if(j&&""!==j.candidate){var _u=j.sdpMLineIndex;if(j.sdpMid)for(var ch=0;ch<K.transceivers.length;ch++)if(K.transceivers[ch].mid===j.sdpMid){_u=ch;break}var _f=K.transceivers[_u];if(!_f)return _o(t2("OperationError","Can not add ICE candidate"));if(_f.rejected)return _i();var o_=Object.keys(j.candidate).length>0?c1.parseCandidate(j.candidate):{};if("tcp"===o_.protocol&&(0===o_.port||9===o_.port)||o_.component&&1!==o_.component)return _i();if((0===_u||_u>0&&_f.iceTransport!==K.transceivers[0].iceTransport)&&!Fne(_f.iceTransport,o_))return _o(t2("OperationError","Can not add ICE candidate"));var i_=j.candidate.trim();0===i_.indexOf("a=")&&(i_=i_.substr(2)),(_e=c1.getMediaSections(K._remoteDescription.sdp))[_u]+="a="+(o_.type?i_:"end-of-candidates")+"\r\n",K._remoteDescription.sdp=c1.getDescription(K._remoteDescription.sdp)+_e.join("")}else for(var u_=0;u_<K.transceivers.length&&(K.transceivers[u_].rejected||(K.transceivers[u_].iceTransport.addRemoteCandidate({}),(_e=c1.getMediaSections(K._remoteDescription.sdp))[u_]+="a=end-of-candidates\r\n",K._remoteDescription.sdp=c1.getDescription(K._remoteDescription.sdp)+_e.join(""),!K.usingBundle));u_++);_i()})},w.prototype.getStats=function(j){if(j&&j instanceof s.MediaStreamTrack){var _e=null;if(this.transceivers.forEach(function(_i){_i.rtpSender&&_i.rtpSender.track===j?_e=_i.rtpSender:_i.rtpReceiver&&_i.rtpReceiver.track===j&&(_e=_i.rtpReceiver)}),!_e)throw t2("InvalidAccessError","Invalid selector.");return _e.getStats()}var K=[];return this.transceivers.forEach(function(_i){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(_o){_i[_o]&&K.push(_i[_o].getStats())})}),Promise.all(K).then(function(_i){var _o=new Map;return _i.forEach(function(_u){_u.forEach(function(ch){_o.set(ch.id,ch)})}),_o})},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(j){var _e=s[j];if(_e&&_e.prototype&&_e.prototype.getStats){var K=_e.prototype.getStats;_e.prototype.getStats=function(){return K.apply(this).then(function(_i){var _o=new Map;return Object.keys(_i).forEach(function(_u){var ch;_i[_u].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(ch=_i[_u]).type]||ch.type,_o.set(_u,_i[_u])}),_o})}}});var $=["createOffer","createAnswer"];return $.forEach(function(j){var _e=w.prototype[j];w.prototype[j]=function(){var K=arguments;return"function"==typeof K[0]||"function"==typeof K[1]?_e.apply(this,[arguments[2]]).then(function(_i){"function"==typeof K[0]&&K[0].apply(null,[_i])},function(_i){"function"==typeof K[1]&&K[1].apply(null,[_i])}):_e.apply(this,arguments)}}),($=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(j){var _e=w.prototype[j];w.prototype[j]=function(){var K=arguments;return"function"==typeof K[1]||"function"==typeof K[2]?_e.apply(this,arguments).then(function(){"function"==typeof K[1]&&K[1].apply(null)},function(_i){"function"==typeof K[2]&&K[2].apply(null,[_i])}):_e.apply(this,arguments)}}),["getStats"].forEach(function(j){var _e=w.prototype[j];w.prototype[j]=function(){var K=arguments;return"function"==typeof K[1]?_e.apply(this,arguments).then(function(){"function"==typeof K[1]&&K[1].apply(null)}):_e.apply(this,arguments)}}),w}(s,p.version);s.RTCPeerConnection=function(y){return y&&y.iceServers&&(y.iceServers=function(w,$){let j=!1;return(w=JSON.parse(JSON.stringify(w))).filter(_e=>{if(_e&&(_e.urls||_e.url)){let K=_e.urls||_e.url;_e.url&&!_e.urls&&K5("RTCIceServer.url","RTCIceServer.urls");const _i="string"==typeof K;return _i&&(K=[K]),K=K.filter(_o=>{if(0===_o.indexOf("stun:"))return!1;const _u=_o.startsWith("turn")&&!_o.startsWith("turn:[")&&_o.includes("transport=udp");return _u&&!j?(j=!0,!0):_u&&!j}),delete _e.url,_e.urls=_i?K[0]:K,!!K.length}})}(y.iceServers),w7("ICE servers after filtering:",y.iceServers)),new A(y)},s.RTCPeerConnection.prototype=A.prototype}function UAe(s){s.RTCRtpSender&&!("replaceTrack"in s.RTCRtpSender.prototype)&&(s.RTCRtpSender.prototype.replaceTrack=s.RTCRtpSender.prototype.setTrack)}var FAe=Object.freeze({__proto__:null,shimPeerConnection:xhe,shimReplaceTrack:UAe,shimGetUserMedia:Phe,shimGetDisplayMedia:Rae}),$$=xT,VAe=_T,GAe=UI,pEe=t1,Lhe=Q3,QAe=eS.exports;if(hI({target:"Promise",proto:!0,real:!0,forced:!!$$&&ga(function(){$$.prototype.finally.call({then:function(){}},function(){})})},{finally:function(s){var p=pEe(this,VAe("Promise")),A=GAe(s);return this.then(A?function(y){return Lhe(p,s()).then(function(){return y})}:s,A?function(y){return Lhe(p,s()).then(function(){throw y})}:s)}}),GAe($$)){var Mhe=VAe("Promise").prototype.finally;$$.prototype.finally!==Mhe&&QAe($$.prototype,"finally",Mhe,{unsafe:!0})}function Oae(s,p){const A=s&&s.navigator,y=s&&s.MediaStreamTrack;if(A.getUserMedia=function(w,$,j){K5("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),A.mediaDevices.getUserMedia(w).then($,j)},!(p.version>55&&"autoGainControl"in A.mediaDevices.getSupportedConstraints())){const w=function(j,_e,K){_e in j&&!(K in j)&&(j[K]=j[_e],delete j[_e])},$=A.mediaDevices.getUserMedia.bind(A.mediaDevices);if(A.mediaDevices.getUserMedia=function(j){return"object"==typeof j&&"object"==typeof j.audio&&(j=JSON.parse(JSON.stringify(j)),w(j.audio,"autoGainControl","mozAutoGainControl"),w(j.audio,"noiseSuppression","mozNoiseSuppression")),$(j)},y&&y.prototype.getSettings){const j=y.prototype.getSettings;y.prototype.getSettings=function(){const _e=j.apply(this,arguments);return w(_e,"mozAutoGainControl","autoGainControl"),w(_e,"mozNoiseSuppression","noiseSuppression"),_e}}if(y&&y.prototype.applyConstraints){const j=y.prototype.applyConstraints;y.prototype.applyConstraints=function(_e){return"audio"===this.kind&&"object"==typeof _e&&(_e=JSON.parse(JSON.stringify(_e)),w(_e,"autoGainControl","mozAutoGainControl"),w(_e,"noiseSuppression","mozNoiseSuppression")),j.apply(this,[_e])}}}}function Bhe(s){"object"==typeof s&&s.RTCTrackEvent&&"receiver"in s.RTCTrackEvent.prototype&&!("transceiver"in s.RTCTrackEvent.prototype)&&Object.defineProperty(s.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Uhe(s,p){if("object"!=typeof s||!s.RTCPeerConnection&&!s.mozRTCPeerConnection)return;!s.RTCPeerConnection&&s.mozRTCPeerConnection&&(s.RTCPeerConnection=s.mozRTCPeerConnection),p.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(w){const $=s.RTCPeerConnection.prototype[w],j={[w](){return arguments[0]=new("addIceCandidate"===w?s.RTCIceCandidate:s.RTCSessionDescription)(arguments[0]),$.apply(this,arguments)}};s.RTCPeerConnection.prototype[w]=j[w]});const A={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},y=s.RTCPeerConnection.prototype.getStats;s.RTCPeerConnection.prototype.getStats=function(){const[w,$,j]=arguments;return y.apply(this,[w||null]).then(_e=>{if(p.version<53&&!$)try{_e.forEach(K=>{K.type=A[K.type]||K.type})}catch(K){if("TypeError"!==K.name)throw K;_e.forEach((_i,_o)=>{_e.set(_o,Object.assign({},_i,{type:A[_i.type]||_i.type}))})}return _e}).then($,j)}}function Fhe(s){if("object"!=typeof s||!s.RTCPeerConnection||!s.RTCRtpSender||s.RTCRtpSender&&"getStats"in s.RTCRtpSender.prototype)return;const p=s.RTCPeerConnection.prototype.getSenders;p&&(s.RTCPeerConnection.prototype.getSenders=function(){const y=p.apply(this,[]);return y.forEach(w=>w._pc=this),y});const A=s.RTCPeerConnection.prototype.addTrack;A&&(s.RTCPeerConnection.prototype.addTrack=function(){const y=A.apply(this,arguments);return y._pc=this,y}),s.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):iI.resolve(new Map)}}function jhe(s){if("object"!=typeof s||!s.RTCPeerConnection||!s.RTCRtpSender||s.RTCRtpSender&&"getStats"in s.RTCRtpReceiver.prototype)return;const p=s.RTCPeerConnection.prototype.getReceivers;p&&(s.RTCPeerConnection.prototype.getReceivers=function(){const A=p.apply(this,[]);return A.forEach(y=>y._pc=this),A}),XR(s,"track",A=>(A.receiver._pc=A.srcElement,A)),s.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function HAe(s){s.RTCPeerConnection&&!("removeStream"in s.RTCPeerConnection.prototype)&&(s.RTCPeerConnection.prototype.removeStream=function(p){K5("removeStream","removeTrack"),this.getSenders().forEach(A=>{A.track&&p.getTracks().includes(A.track)&&this.removeTrack(A)})})}function qAe(s){s.DataChannel&&!s.RTCDataChannel&&(s.RTCDataChannel=s.DataChannel)}function WAe(s){if("object"!=typeof s||!s.RTCPeerConnection)return;const p=s.RTCPeerConnection.prototype.addTransceiver;p&&(s.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const A=arguments[1],y=A&&"sendEncodings"in A;y&&A.sendEncodings.forEach($=>{if("rid"in $&&!/^[a-z0-9]{0,16}$/i.test($.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in $&&!(parseFloat($.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in $&&!(parseFloat($.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const w=p.apply(this,arguments);if(y){const{sender:$}=w,j=$.getParameters();(!("encodings"in j)||1===j.encodings.length&&0===Object.keys(j.encodings[0]).length)&&(j.encodings=A.sendEncodings,$.sendEncodings=A.sendEncodings,this.setParametersPromises.push($.setParameters(j).then(()=>{delete $.sendEncodings}).catch(()=>{delete $.sendEncodings})))}return w})}function Vhe(s){if("object"!=typeof s||!s.RTCRtpSender)return;const p=s.RTCRtpSender.prototype.getParameters;p&&(s.RTCRtpSender.prototype.getParameters=function(){const A=p.apply(this,arguments);return"encodings"in A||(A.encodings=[].concat(this.sendEncodings||[{}])),A})}function Dae(s){if("object"!=typeof s||!s.RTCPeerConnection)return;const p=s.RTCPeerConnection.prototype.createOffer;s.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?iI.all(this.setParametersPromises).then(()=>p.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):p.apply(this,arguments)}}function Ghe(s){if("object"!=typeof s||!s.RTCPeerConnection)return;const p=s.RTCPeerConnection.prototype.createAnswer;s.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?iI.all(this.setParametersPromises).then(()=>p.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):p.apply(this,arguments)}}var Nae=Object.freeze({__proto__:null,shimOnTrack:Bhe,shimPeerConnection:Uhe,shimSenderGetStats:Fhe,shimReceiverGetStats:jhe,shimRemoveStream:HAe,shimRTCDataChannel:qAe,shimAddTransceiver:WAe,shimGetParameters:Vhe,shimCreateOffer:Dae,shimCreateAnswer:Ghe,shimGetUserMedia:Oae,shimGetDisplayMedia:function(s,p){s.navigator.mediaDevices&&"getDisplayMedia"in s.navigator.mediaDevices||s.navigator.mediaDevices&&(s.navigator.mediaDevices.getDisplayMedia=function(A){if(!A||!A.video){const y=new DOMException("getDisplayMedia without video constraints is undefined");return y.name="NotFoundError",y.code=8,iI.reject(y)}return!0===A.video?A.video={mediaSource:p}:A.video.mediaSource=p,s.navigator.mediaDevices.getUserMedia(A)})}});function kae(s){if("object"==typeof s&&s.RTCPeerConnection){if("getLocalStreams"in s.RTCPeerConnection.prototype||(s.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in s.RTCPeerConnection.prototype)){const p=s.RTCPeerConnection.prototype.addTrack;s.RTCPeerConnection.prototype.addStream=function(A){this._localStreams||(this._localStreams=[]),this._localStreams.includes(A)||this._localStreams.push(A),A.getAudioTracks().forEach(y=>p.call(this,y,A)),A.getVideoTracks().forEach(y=>p.call(this,y,A))},s.RTCPeerConnection.prototype.addTrack=function(A){for(var y=arguments.length,w=new Array(y>1?y-1:0),$=1;$<y;$++)w[$-1]=arguments[$];return w&&w.forEach(j=>{this._localStreams?this._localStreams.includes(j)||this._localStreams.push(j):this._localStreams=[j]}),p.apply(this,arguments)}}"removeStream"in s.RTCPeerConnection.prototype||(s.RTCPeerConnection.prototype.removeStream=function(p){this._localStreams||(this._localStreams=[]);const A=this._localStreams.indexOf(p);if(-1===A)return;this._localStreams.splice(A,1);const y=p.getTracks();this.getSenders().forEach(w=>{y.includes(w.track)&&this.removeTrack(w)})})}}function Qhe(s){if("object"==typeof s&&s.RTCPeerConnection&&("getRemoteStreams"in s.RTCPeerConnection.prototype||(s.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in s.RTCPeerConnection.prototype))){Object.defineProperty(s.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(A){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=A),this.addEventListener("track",this._onaddstreampoly=y=>{y.streams.forEach(w=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(w))return;this._remoteStreams.push(w);const $=new Event("addstream");$.stream=w,this.dispatchEvent($)})})}});const p=s.RTCPeerConnection.prototype.setRemoteDescription;s.RTCPeerConnection.prototype.setRemoteDescription=function(){const A=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(y){y.streams.forEach(w=>{if(A._remoteStreams||(A._remoteStreams=[]),A._remoteStreams.indexOf(w)>=0)return;A._remoteStreams.push(w);const $=new Event("addstream");$.stream=w,A.dispatchEvent($)})}),p.apply(A,arguments)}}}function Hhe(s){if("object"!=typeof s||!s.RTCPeerConnection)return;const p=s.RTCPeerConnection.prototype,A=p.createOffer,y=p.createAnswer,w=p.setLocalDescription,$=p.setRemoteDescription,j=p.addIceCandidate;p.createOffer=function(K,_i){const _u=A.apply(this,[arguments.length>=2?arguments[2]:arguments[0]]);return _i?(_u.then(K,_i),iI.resolve()):_u},p.createAnswer=function(K,_i){const _u=y.apply(this,[arguments.length>=2?arguments[2]:arguments[0]]);return _i?(_u.then(K,_i),iI.resolve()):_u};let _e=function(K,_i,_o){const _u=w.apply(this,[K]);return _o?(_u.then(_i,_o),iI.resolve()):_u};p.setLocalDescription=_e,_e=function(K,_i,_o){const _u=$.apply(this,[K]);return _o?(_u.then(_i,_o),iI.resolve()):_u},p.setRemoteDescription=_e,_e=function(K,_i,_o){const _u=j.apply(this,[K]);return _o?(_u.then(_i,_o),iI.resolve()):_u},p.addIceCandidate=_e}function $S(s){const p=s&&s.navigator;if(p.mediaDevices&&p.mediaDevices.getUserMedia){const A=p.mediaDevices,y=A.getUserMedia.bind(A);p.mediaDevices.getUserMedia=w=>y(jne(w))}!p.getUserMedia&&p.mediaDevices&&p.mediaDevices.getUserMedia&&(p.getUserMedia=function(A,y,w){p.mediaDevices.getUserMedia(A).then(y,w)}.bind(p))}function jne(s){return s&&void 0!==s.video?Object.assign({},s,{video:f4(s.video)}):s}function Vne(s){if(!s.RTCPeerConnection)return;const p=s.RTCPeerConnection;s.RTCPeerConnection=function(A,y){if(A&&A.iceServers){const w=[];for(let $=0;$<A.iceServers.length;$++){let j=A.iceServers[$];!j.hasOwnProperty("urls")&&j.hasOwnProperty("url")?(K5("RTCIceServer.url","RTCIceServer.urls"),j=JSON.parse(JSON.stringify(j)),j.urls=j.url,delete j.url,w.push(j)):w.push(A.iceServers[$])}A.iceServers=w}return new p(A,y)},s.RTCPeerConnection.prototype=p.prototype,"generateCertificate"in p&&Object.defineProperty(s.RTCPeerConnection,"generateCertificate",{get:()=>p.generateCertificate})}function qhe(s){"object"==typeof s&&s.RTCTrackEvent&&"receiver"in s.RTCTrackEvent.prototype&&!("transceiver"in s.RTCTrackEvent.prototype)&&Object.defineProperty(s.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Whe(s){const p=s.RTCPeerConnection.prototype.createOffer;s.RTCPeerConnection.prototype.createOffer=function(A){if(A){void 0!==A.offerToReceiveAudio&&(A.offerToReceiveAudio=!!A.offerToReceiveAudio);const y=this.getTransceivers().find($=>"audio"===$.receiver.track.kind);!1===A.offerToReceiveAudio&&y?"sendrecv"===y.direction?y.setDirection?y.setDirection("sendonly"):y.direction="sendonly":"recvonly"===y.direction&&(y.setDirection?y.setDirection("inactive"):y.direction="inactive"):!0!==A.offerToReceiveAudio||y||this.addTransceiver("audio"),void 0!==A.offerToReceiveVideo&&(A.offerToReceiveVideo=!!A.offerToReceiveVideo);const w=this.getTransceivers().find($=>"video"===$.receiver.track.kind);!1===A.offerToReceiveVideo&&w?"sendrecv"===w.direction?w.setDirection?w.setDirection("sendonly"):w.direction="sendonly":"recvonly"===w.direction&&(w.setDirection?w.setDirection("inactive"):w.direction="inactive"):!0!==A.offerToReceiveVideo||w||this.addTransceiver("video")}return p.apply(this,arguments)}}function Khe(s){"object"!=typeof s||s.AudioContext||(s.AudioContext=s.webkitAudioContext)}var zhe=Object.freeze({__proto__:null,shimLocalStreamsAPI:kae,shimRemoteStreamsAPI:Qhe,shimCallbacksAPI:Hhe,shimGetUserMedia:$S,shimConstraints:jne,shimRTCIceServerUrls:Vne,shimTrackEventTransceiver:qhe,shimCreateOfferLegacy:Whe,shimAudioContext:Khe}),zAe=GV,Yhe=OL,Jhe=rT("".replace),Gne="[\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]",YAe=RegExp("^"+Gne+Gne+"*"),$he=RegExp(Gne+Gne+"*$"),Pae=function(s){return function(p){var A=Yhe(zAe(p));return 1&s&&(A=Jhe(A,YAe,"")),2&s&&(A=Jhe(A,$he,"")),A}},JAe={start:Pae(1),end:Pae(2),trim:Pae(3)},tK=Ste.PROPER,Zhe=OT,xae="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",Z$=JAe.trim;xS({target:"String",proto:!0,forced:function(s){return Zhe(function(){return!!xae[s]()||"\u200b\x85\u180e"!=="\u200b\x85\u180e"[s]()||tK&&xae[s].name!==s})}("trim")},{trim:function(){return Z$(this)}});var X$=t4("String").trim,n2=M2,$Ae=X$,Lae=String.prototype,yQ=function(s){var p=s.trim;return"string"==typeof s||s===Lae||n2(Lae,s)&&p===Lae.trim?$Ae:p},ZAe=r_;hI({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return ZAe(URL.prototype.toString,this)}});var Xhe={exports:{}};!function(s){var p={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};p.localCName=p.generateIdentifier(),p.splitLines=function(A){return yQ(A).call(A).split("\n").map(function(y){return yQ(y).call(y)})},p.splitSections=function(A){return A.split("\nm=").map(function(y,w){var $;return yQ($=w>0?"m="+y:y).call($)+"\r\n"})},p.getDescription=function(A){var y=p.splitSections(A);return y&&y[0]},p.getMediaSections=function(A){var y=p.splitSections(A);return y.shift(),y},p.matchPrefix=function(A,y){return p.splitLines(A).filter(function(w){return 0===w.indexOf(y)})},p.parseCandidate=function(A){for(var y,w={foundation:(y=0===A.indexOf("a=candidate:")?A.substring(12).split(" "):A.substring(10).split(" "))[0],component:parseInt(y[1],10),protocol:y[2].toLowerCase(),priority:parseInt(y[3],10),ip:y[4],address:y[4],port:parseInt(y[5],10),type:y[7]},$=8;$<y.length;$+=2)switch(y[$]){case"raddr":w.relatedAddress=y[$+1];break;case"rport":w.relatedPort=parseInt(y[$+1],10);break;case"tcptype":w.tcpType=y[$+1];break;case"ufrag":w.ufrag=y[$+1],w.usernameFragment=y[$+1];break;default:w[y[$]]=y[$+1]}return w},p.writeCandidate=function(A){var y=[];y.push(A.foundation),y.push(A.component),y.push(A.protocol.toUpperCase()),y.push(A.priority),y.push(A.address||A.ip),y.push(A.port);var w=A.type;return y.push("typ"),y.push(w),"host"!==w&&A.relatedAddress&&A.relatedPort&&(y.push("raddr"),y.push(A.relatedAddress),y.push("rport"),y.push(A.relatedPort)),A.tcpType&&"tcp"===A.protocol.toLowerCase()&&(y.push("tcptype"),y.push(A.tcpType)),(A.usernameFragment||A.ufrag)&&(y.push("ufrag"),y.push(A.usernameFragment||A.ufrag)),"candidate:"+y.join(" ")},p.parseIceOptions=function(A){return A.substr(14).split(" ")},p.parseRtpMap=function(A){var y=A.substr(9).split(" "),w={payloadType:parseInt(y.shift(),10)};return y=y[0].split("/"),w.name=y[0],w.clockRate=parseInt(y[1],10),w.channels=3===y.length?parseInt(y[2],10):1,w.numChannels=w.channels,w},p.writeRtpMap=function(A){var y=A.payloadType;void 0!==A.preferredPayloadType&&(y=A.preferredPayloadType);var w=A.channels||A.numChannels||1;return"a=rtpmap:"+y+" "+A.name+"/"+A.clockRate+(1!==w?"/"+w:"")+"\r\n"},p.parseExtmap=function(A){var y=A.substr(9).split(" ");return{id:parseInt(y[0],10),direction:y[0].indexOf("/")>0?y[0].split("/")[1]:"sendrecv",uri:y[1]}},p.writeExtmap=function(A){return"a=extmap:"+(A.id||A.preferredId)+(A.direction&&"sendrecv"!==A.direction?"/"+A.direction:"")+" "+A.uri+"\r\n"},p.parseFmtp=function(A){for(var y,w={},$=A.substr(A.indexOf(" ")+1).split(";"),j=0;j<$.length;j++){var _e,K;y=yQ(_e=$[j]).call(_e).split("="),w[yQ(K=y[0]).call(K)]=y[1]}return w},p.writeFmtp=function(A){var y="",w=A.payloadType;if(void 0!==A.preferredPayloadType&&(w=A.preferredPayloadType),A.parameters&&Object.keys(A.parameters).length){var $=[];Object.keys(A.parameters).forEach(function(j){$.push(A.parameters[j]?j+"="+A.parameters[j]:j)}),y+="a=fmtp:"+w+" "+$.join(";")+"\r\n"}return y},p.parseRtcpFb=function(A){var y=A.substr(A.indexOf(" ")+1).split(" ");return{type:y.shift(),parameter:y.join(" ")}},p.writeRtcpFb=function(A){var y="",w=A.payloadType;return void 0!==A.preferredPayloadType&&(w=A.preferredPayloadType),A.rtcpFeedback&&A.rtcpFeedback.length&&A.rtcpFeedback.forEach(function($){y+="a=rtcp-fb:"+w+" "+$.type+($.parameter&&$.parameter.length?" "+$.parameter:"")+"\r\n"}),y},p.parseSsrcMedia=function(A){var y=A.indexOf(" "),w={ssrc:parseInt(A.substr(7,y-7),10)},$=A.indexOf(":",y);return $>-1?(w.attribute=A.substr(y+1,$-y-1),w.value=A.substr($+1)):w.attribute=A.substr(y+1),w},p.parseSsrcGroup=function(A){var y=A.substr(13).split(" ");return{semantics:y.shift(),ssrcs:y.map(function(w){return parseInt(w,10)})}},p.getMid=function(A){var y=p.matchPrefix(A,"a=mid:")[0];if(y)return y.substr(6)},p.parseFingerprint=function(A){var y=A.substr(14).split(" ");return{algorithm:y[0].toLowerCase(),value:y[1]}},p.getDtlsParameters=function(A,y){return{role:"auto",fingerprints:p.matchPrefix(A+y,"a=fingerprint:").map(p.parseFingerprint)}},p.writeDtlsParameters=function(A,y){var w="a=setup:"+y+"\r\n";return A.fingerprints.forEach(function($){w+="a=fingerprint:"+$.algorithm+" "+$.value+"\r\n"}),w},p.parseCryptoLine=function(A){var y=A.substr(9).split(" ");return{tag:parseInt(y[0],10),cryptoSuite:y[1],keyParams:y[2],sessionParams:y.slice(3)}},p.writeCryptoLine=function(A){return"a=crypto:"+A.tag+" "+A.cryptoSuite+" "+("object"==typeof A.keyParams?p.writeCryptoKeyParams(A.keyParams):A.keyParams)+(A.sessionParams?" "+A.sessionParams.join(" "):"")+"\r\n"},p.parseCryptoKeyParams=function(A){if(0!==A.indexOf("inline:"))return null;var y=A.substr(7).split("|");return{keyMethod:"inline",keySalt:y[0],lifeTime:y[1],mkiValue:y[2]?y[2].split(":")[0]:void 0,mkiLength:y[2]?y[2].split(":")[1]:void 0}},p.writeCryptoKeyParams=function(A){return A.keyMethod+":"+A.keySalt+(A.lifeTime?"|"+A.lifeTime:"")+(A.mkiValue&&A.mkiLength?"|"+A.mkiValue+":"+A.mkiLength:"")},p.getCryptoParameters=function(A,y){return p.matchPrefix(A+y,"a=crypto:").map(p.parseCryptoLine)},p.getIceParameters=function(A,y){var w=p.matchPrefix(A+y,"a=ice-ufrag:")[0],$=p.matchPrefix(A+y,"a=ice-pwd:")[0];return w&&$?{usernameFragment:w.substr(12),password:$.substr(10)}:null},p.writeIceParameters=function(A){return"a=ice-ufrag:"+A.usernameFragment+"\r\na=ice-pwd:"+A.password+"\r\n"},p.parseRtpParameters=function(A){for(var y={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},w=p.splitLines(A)[0].split(" "),$=3;$<w.length;$++){var j=w[$],_e=p.matchPrefix(A,"a=rtpmap:"+j+" ")[0];if(_e){var K=p.parseRtpMap(_e),_i=p.matchPrefix(A,"a=fmtp:"+j+" ");switch(K.parameters=_i.length?p.parseFmtp(_i[0]):{},K.rtcpFeedback=p.matchPrefix(A,"a=rtcp-fb:"+j+" ").map(p.parseRtcpFb),y.codecs.push(K),K.name.toUpperCase()){case"RED":case"ULPFEC":y.fecMechanisms.push(K.name.toUpperCase())}}}return p.matchPrefix(A,"a=extmap:").forEach(function(_o){y.headerExtensions.push(p.parseExtmap(_o))}),y},p.writeRtpDescription=function(A,y){var w="";w+="m="+A+" ",w+=y.codecs.length>0?"9":"0",w+=" UDP/TLS/RTP/SAVPF ",w+=y.codecs.map(function(j){return void 0!==j.preferredPayloadType?j.preferredPayloadType:j.payloadType}).join(" ")+"\r\n",w+="c=IN IP4 0.0.0.0\r\n",w+="a=rtcp:9 IN IP4 0.0.0.0\r\n",y.codecs.forEach(function(j){w+=p.writeRtpMap(j),w+=p.writeFmtp(j),w+=p.writeRtcpFb(j)});var $=0;return y.codecs.forEach(function(j){j.maxptime>$&&($=j.maxptime)}),$>0&&(w+="a=maxptime:"+$+"\r\n"),w+="a=rtcp-mux\r\n",y.headerExtensions&&y.headerExtensions.forEach(function(j){w+=p.writeExtmap(j)}),w},p.parseRtpEncodingParameters=function(A){var y,w=[],$=p.parseRtpParameters(A),j=-1!==$.fecMechanisms.indexOf("RED"),_e=-1!==$.fecMechanisms.indexOf("ULPFEC"),K=p.matchPrefix(A,"a=ssrc:").map(function(ch){return p.parseSsrcMedia(ch)}).filter(function(ch){return"cname"===ch.attribute}),_i=K.length>0&&K[0].ssrc,_o=p.matchPrefix(A,"a=ssrc-group:FID").map(function(ch){return ch.substr(17).split(" ").map(function(_f){return parseInt(_f,10)})});_o.length>0&&_o[0].length>1&&_o[0][0]===_i&&(y=_o[0][1]),$.codecs.forEach(function(ch){if("RTX"===ch.name.toUpperCase()&&ch.parameters.apt){var _f={ssrc:_i,codecPayloadType:parseInt(ch.parameters.apt,10)};_i&&y&&(_f.rtx={ssrc:y}),w.push(_f),j&&((_f=JSON.parse(JSON.stringify(_f))).fec={ssrc:_i,mechanism:_e?"red+ulpfec":"red"},w.push(_f))}}),0===w.length&&_i&&w.push({ssrc:_i});var _u=p.matchPrefix(A,"b=");return _u.length&&(_u=0===_u[0].indexOf("b=TIAS:")?parseInt(_u[0].substr(7),10):0===_u[0].indexOf("b=AS:")?1e3*parseInt(_u[0].substr(5),10)*.95-16e3:void 0,w.forEach(function(ch){ch.maxBitrate=_u})),w},p.parseRtcpParameters=function(A){var y={},w=p.matchPrefix(A,"a=ssrc:").map(function(_e){return p.parseSsrcMedia(_e)}).filter(function(_e){return"cname"===_e.attribute})[0];w&&(y.cname=w.value,y.ssrc=w.ssrc);var $=p.matchPrefix(A,"a=rtcp-rsize");y.reducedSize=$.length>0,y.compound=0===$.length;var j=p.matchPrefix(A,"a=rtcp-mux");return y.mux=j.length>0,y},p.parseMsid=function(A){var y,w=p.matchPrefix(A,"a=msid:");if(1===w.length)return{stream:(y=w[0].substr(7).split(" "))[0],track:y[1]};var $=p.matchPrefix(A,"a=ssrc:").map(function(j){return p.parseSsrcMedia(j)}).filter(function(j){return"msid"===j.attribute});return $.length>0?{stream:(y=$[0].value.split(" "))[0],track:y[1]}:void 0},p.parseSctpDescription=function(A){var y,w=p.parseMLine(A),$=p.matchPrefix(A,"a=max-message-size:");$.length>0&&(y=parseInt($[0].substr(19),10)),isNaN(y)&&(y=65536);var j=p.matchPrefix(A,"a=sctp-port:");if(j.length>0)return{port:parseInt(j[0].substr(12),10),protocol:w.fmt,maxMessageSize:y};if(p.matchPrefix(A,"a=sctpmap:").length>0){var _e=p.matchPrefix(A,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(_e[0],10),protocol:_e[1],maxMessageSize:y}}},p.writeSctpDescription=function(A,y){var w=[];return w="DTLS/SCTP"!==A.protocol?["m="+A.kind+" 9 "+A.protocol+" "+y.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+y.port+"\r\n"]:["m="+A.kind+" 9 "+A.protocol+" "+y.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+y.port+" "+y.protocol+" 65535\r\n"],void 0!==y.maxMessageSize&&w.push("a=max-message-size:"+y.maxMessageSize+"\r\n"),w.join("")},p.generateSessionId=function(){return Math.random().toString().substr(2,21)},p.writeSessionBoilerplate=function(A,y,w){var $=void 0!==y?y:2;return"v=0\r\no="+(w||"thisisadapterortc")+" "+(A||p.generateSessionId())+" "+$+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},p.writeMediaSection=function(A,y,w,$){var j=p.writeRtpDescription(A.kind,y);if(j+=p.writeIceParameters(A.iceGatherer.getLocalParameters()),j+=p.writeDtlsParameters(A.dtlsTransport.getLocalParameters(),"offer"===w?"actpass":"active"),j+="a=mid:"+A.mid+"\r\n",j+=A.direction?"a="+A.direction+"\r\n":A.rtpSender&&A.rtpReceiver?"a=sendrecv\r\n":A.rtpSender?"a=sendonly\r\n":A.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",A.rtpSender){var _e="msid:"+$.id+" "+A.rtpSender.track.id+"\r\n";j+="a="+_e,j+="a=ssrc:"+A.sendEncodingParameters[0].ssrc+" "+_e,A.sendEncodingParameters[0].rtx&&(j+="a=ssrc:"+A.sendEncodingParameters[0].rtx.ssrc+" "+_e,j+="a=ssrc-group:FID "+A.sendEncodingParameters[0].ssrc+" "+A.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return j+="a=ssrc:"+A.sendEncodingParameters[0].ssrc+" cname:"+p.localCName+"\r\n",A.rtpSender&&A.sendEncodingParameters[0].rtx&&(j+="a=ssrc:"+A.sendEncodingParameters[0].rtx.ssrc+" cname:"+p.localCName+"\r\n"),j},p.getDirection=function(A,y){for(var w=p.splitLines(A),$=0;$<w.length;$++)switch(w[$]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return w[$].substr(2)}return y?p.getDirection(y):"sendrecv"},p.getKind=function(A){return p.splitLines(A)[0].split(" ")[0].substr(2)},p.isRejected=function(A){return"0"===A.split(" ",2)[1]},p.parseMLine=function(A){var y=p.splitLines(A)[0].substr(2).split(" ");return{kind:y[0],port:parseInt(y[1],10),protocol:y[2],fmt:y.slice(3).join(" ")}},p.parseOLine=function(A){var y=p.matchPrefix(A,"o=")[0].substr(2).split(" ");return{username:y[0],sessionId:y[1],sessionVersion:parseInt(y[2],10),netType:y[3],addressType:y[4],address:y[5]}},p.isValidSDP=function(A){if("string"!=typeof A||0===A.length)return!1;for(var y=p.splitLines(A),w=0;w<y.length;w++)if(y[w].length<2||"="!==y[w].charAt(1))return!1;return!0},s.exports=p}(Xhe);var Qne=Xhe.exports;function EQ(s){if(!s.RTCIceCandidate||s.RTCIceCandidate&&"foundation"in s.RTCIceCandidate.prototype)return;const p=s.RTCIceCandidate;s.RTCIceCandidate=function(A){if("object"==typeof A&&A.candidate&&0===A.candidate.indexOf("a=")&&((A=JSON.parse(JSON.stringify(A))).candidate=A.candidate.substr(2)),A.candidate&&A.candidate.length){const y=new p(A),w=Qne.parseCandidate(A.candidate),$=Object.assign(y,w);return $.toJSON=function(){return{candidate:$.candidate,sdpMid:$.sdpMid,sdpMLineIndex:$.sdpMLineIndex,usernameFragment:$.usernameFragment}},$}return new p(A)},s.RTCIceCandidate.prototype=p.prototype,XR(s,"icecandidate",A=>(A.candidate&&Object.defineProperty(A,"candidate",{value:new s.RTCIceCandidate(A.candidate),writable:"false"}),A))}function nK(s,p){if(!s.RTCPeerConnection)return;"sctp"in s.RTCPeerConnection.prototype||Object.defineProperty(s.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const A=function(_e){if(!_e||!_e.sdp)return!1;const K=Qne.splitSections(_e.sdp);return K.shift(),K.some(_i=>{const _o=Qne.parseMLine(_i);return _o&&"application"===_o.kind&&-1!==_o.protocol.indexOf("SCTP")})},y=function(_e){const K=_e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===K||K.length<2)return-1;const _i=parseInt(K[1],10);return _i!=_i?-1:_i},w=function(_e){let K=65536;return"firefox"===p.browser&&(K=p.version<57?-1===_e?16384:2147483637:p.version<60?57===p.version?65535:65536:2147483637),K},$=function(_e,K){let _i=65536;"firefox"===p.browser&&57===p.version&&(_i=65535);const _o=Qne.matchPrefix(_e.sdp,"a=max-message-size:");return _o.length>0?_i=parseInt(_o[0].substr(19),10):"firefox"===p.browser&&-1!==K&&(_i=2147483637),_i},j=s.RTCPeerConnection.prototype.setRemoteDescription;s.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===p.browser&&p.version>=76){const{sdpSemantics:_e}=this.getConfiguration();"plan-b"===_e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(A(arguments[0])){const _e=y(arguments[0]),K=w(_e),_i=$(arguments[0],_e);let _o;_o=0===K&&0===_i?Number.POSITIVE_INFINITY:0===K||0===_i?Math.max(K,_i):Math.min(K,_i);const _u={};Object.defineProperty(_u,"maxMessageSize",{get:()=>_o}),this._sctp=_u}return j.apply(this,arguments)}}function IQ(s){if(!s.RTCPeerConnection||!("createDataChannel"in s.RTCPeerConnection.prototype))return;function p(y,w){const $=y.send;y.send=function(){const j=arguments[0];if("open"===y.readyState&&w.sctp&&(j.length||j.size||j.byteLength)>w.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+w.sctp.maxMessageSize+" bytes)");return $.apply(y,arguments)}}const A=s.RTCPeerConnection.prototype.createDataChannel;s.RTCPeerConnection.prototype.createDataChannel=function(){const y=A.apply(this,arguments);return p(y,this),y},XR(s,"datachannel",y=>(p(y.channel,y.target),y))}function eZ(s){if(!s.RTCPeerConnection||"connectionState"in s.RTCPeerConnection.prototype)return;const p=s.RTCPeerConnection.prototype;Object.defineProperty(p,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(p,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(A){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),A&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=A)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(A=>{const y=p[A];p[A]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=w=>{const $=w.target;if($._lastConnectionState!==$.connectionState){$._lastConnectionState=$.connectionState;const j=new Event("connectionstatechange",w);$.dispatchEvent(j)}return w},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),y.apply(this,arguments)}})}function qU(s,p){if(!s.RTCPeerConnection||"chrome"===p.browser&&p.version>=71||"safari"===p.browser&&p.version>=605)return;const A=s.RTCPeerConnection.prototype.setRemoteDescription;s.RTCPeerConnection.prototype.setRemoteDescription=function(y){if(y&&y.sdp&&-1!==y.sdp.indexOf("\na=extmap-allow-mixed")){const w=y.sdp.split("\n").filter($=>"a=extmap-allow-mixed"!==yQ($).call($)).join("\n");s.RTCSessionDescription&&y instanceof s.RTCSessionDescription?arguments[0]=new s.RTCSessionDescription({type:y.type,sdp:w}):y.sdp=w}return A.apply(this,arguments)}}function tZ(s,p){if(!s.RTCPeerConnection||!s.RTCPeerConnection.prototype)return;const A=s.RTCPeerConnection.prototype.addIceCandidate;A&&0!==A.length&&(s.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===p.browser&&p.version<78||"firefox"===p.browser&&p.version<68||"safari"===p.browser)&&arguments[0]&&""===arguments[0].candidate?iI.resolve():A.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),iI.resolve())})}var x8=Object.freeze({__proto__:null,shimRTCIceCandidate:EQ,shimMaxMessageSize:nK,shimSendThrowTypeError:IQ,shimConnectionState:eZ,removeExtmapAllowMixed:qU,shimAddIceCandidateNullOrEmpty:tZ});let wR,C1;(function(){let{window:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};const A=w7,y=u8(s),w={browserDetails:y,commonShim:x8,extractVersion:C7,disableLog:VH,disableWarnings:d4};switch(y.browser){case"chrome":if(!Ohe||!Bne||!p.shimChrome)return A("Chrome shim is not included in this adapter release."),w;if(null===y.version)return A("Chrome shim can not determine version, not shimming."),w;A("adapter.js shimming chrome."),w.browserShim=Ohe,tZ(s,y),Che(s,y),wae(s),Bne(s,y),whe(s),She(s,y),Tae(s),P8(s),The(s),Rhe(s,y),EQ(s),eZ(s),nK(s,y),IQ(s),qU(s,y);break;case"firefox":if(!Nae||!Uhe||!p.shimFirefox)return A("Firefox shim is not included in this adapter release."),w;A("adapter.js shimming firefox."),w.browserShim=Nae,tZ(s,y),Oae(s,y),Uhe(s,y),Bhe(s),HAe(s),Fhe(s),jhe(s),qAe(s),WAe(s),Vhe(s),Dae(s),Ghe(s),EQ(s),eZ(s),nK(s,y),IQ(s);break;case"edge":if(!FAe||!xhe||!p.shimEdge)return A("MS edge shim is not included in this adapter release."),w;A("adapter.js shimming edge."),w.browserShim=FAe,Phe(s),Rae(s),xhe(s,y),UAe(s),nK(s,y),IQ(s);break;case"safari":if(!zhe||!p.shimSafari)return A("Safari shim is not included in this adapter release."),w;A("adapter.js shimming safari."),w.browserShim=zhe,tZ(s,y),Vne(s),Whe(s),Hhe(s),kae(s),Qhe(s),qhe(s),$S(s),Khe(s),EQ(s),nK(s,y),IQ(s),qU(s,y);break;default:A("Unsupported browser!")}})({window:"undefined"==typeof window?void 0:window}),function(s){s.WIN_10="Windows 10",s.WIN_81="Windows 8.1",s.WIN_8="Windows 8",s.WIN_7="Windows 7",s.WIN_VISTA="Windows Vista",s.WIN_SERVER_2003="Windows Server 2003",s.WIN_XP="Windows XP",s.WIN_2000="Windows 2000",s.ANDROID="Android",s.OPEN_BSD="Open BSD",s.SUN_OS="Sun OS",s.LINUX="Linux",s.IOS="iOS",s.MAC_OS="Mac OS",s.QNX="QNX",s.UNIX="UNIX",s.BEOS="BeOS",s.OS_2="OS/2",s.SEARCH_BOT="Search Bot"}(wR||(wR={})),function(s){s.CHROME="Chrome",s.SAFARI="Safari",s.EDGE="Edge",s.FIREFOX="Firefox",s.OPERA="OPR",s.QQ="QQBrowser",s.WECHAT="MicroMessenger"}(C1||(C1={}));var Mae={exports:{}};!function(s,p){!function(A,y){var w="function",$="object",j="string",_e="model",K="name",_i="type",_o="vendor",_u="version",ch="architecture",_f="console",o_="mobile",i_="tablet",u_="smarttv",g_="wearable",__="embedded",w_={extend:function(q0,Z0){var a0={};for(var j_ in q0)a0[j_]=Z0[j_]&&Z0[j_].length%2==0?Z0[j_].concat(q0[j_]):q0[j_];return a0},has:function(q0,Z0){return typeof q0===j&&-1!==Z0.toLowerCase().indexOf(q0.toLowerCase())},lowerize:function(q0){return q0.toLowerCase()},major:function(q0){return typeof q0===j?q0.replace(/[^\d\.]/g,"").split(".")[0]:y},trim:function(q0,Z0){return q0=q0.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),void 0===Z0?q0:q0.substring(0,255)}},k_={rgx:function(q0,Z0){for(var a0,j_,Z_,o0,z0,q_,X_=0;X_<Z0.length&&!z0;){var u0=Z0[X_],B0=Z0[X_+1];for(a0=j_=0;a0<u0.length&&!z0;)if(z0=u0[a0++].exec(q0))for(Z_=0;Z_<B0.length;Z_++)q_=z0[++j_],typeof(o0=B0[Z_])===$&&o0.length>0?2==o0.length?this[o0[0]]=typeof o0[1]==w?o0[1].call(this,q_):o0[1]:3==o0.length?this[o0[0]]=typeof o0[1]!==w||o0[1].exec&&o0[1].test?q_?q_.replace(o0[1],o0[2]):y:q_?o0[1].call(this,q_,o0[2]):y:4==o0.length&&(this[o0[0]]=q_?o0[3].call(this,q_.replace(o0[1],o0[2])):y):this[o0]=q_||y;X_+=2}},str:function(q0,Z0){for(var a0 in Z0)if(typeof Z0[a0]===$&&Z0[a0].length>0){for(var j_=0;j_<Z0[a0].length;j_++)if(w_.has(Z0[a0][j_],q0))return"?"===a0?y:a0}else if(w_.has(Z0[a0],q0))return"?"===a0?y:a0;return q0}},Rv={browser:{oldSafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}},oldEdge:{version:{.1:"12.",21:"13.",31:"14.",39:"15.",41:"16.",42:"17.",44:"18."}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},f0={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[_u,[K,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[_u,[K,"Edge"]],[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6})\b.+version\/([\w\.-]+)/i,/(opera)(?:.+version\/|[\/\s]+)([\w\.]+)/i],[K,_u],[/opios[\/\s]+([\w\.]+)/i],[_u,[K,"Opera Mini"]],[/\sopr\/([\w\.]+)/i],[_u,[K,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(ba?idubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i,/(rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([\w\.]+)/i,/(weibo)__([\d\.]+)/i],[K,_u],[/(?:[\s\/]uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[_u,[K,"UCBrowser"]],[/(?:windowswechat)?\sqbcore\/([\w\.]+)\b.*(?:windowswechat)?/i],[_u,[K,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[_u,[K,"WeChat"]],[/konqueror\/([\w\.]+)/i],[_u,[K,"Konqueror"]],[/trident.+rv[:\s]([\w\.]{1,9})\b.+like\sgecko/i],[_u,[K,"IE"]],[/yabrowser\/([\w\.]+)/i],[_u,[K,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[K,/(.+)/,"$1 Secure Browser"],_u],[/focus\/([\w\.]+)/i],[_u,[K,"Firefox Focus"]],[/opt\/([\w\.]+)/i],[_u,[K,"Opera Touch"]],[/coc_coc_browser\/([\w\.]+)/i],[_u,[K,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[_u,[K,"Dolphin"]],[/coast\/([\w\.]+)/i],[_u,[K,"Opera Coast"]],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[_u,[K,"MIUI Browser"]],[/fxios\/([\w\.-]+)/i],[_u,[K,"Firefox"]],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[K,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[K,/(.+)/,"$1 Browser"],_u],[/(comodo_dragon)\/([\w\.]+)/i],[[K,/_/g," "],_u],[/\s(electron)\/([\w\.]+)\ssafari/i,/(tesla)(?:\sqtcarbrowser|\/(20[12]\d\.[\w\.-]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/\s]?([\w\.]+)/i],[K,_u],[/(MetaSr)[\/\s]?([\w\.]+)/i,/(LBBROWSER)/i],[K],[/;fbav\/([\w\.]+);/i],[_u,[K,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[K,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/\s]([\w\.-]+)/i],[K,_u],[/\bgsa\/([\w\.]+)\s.*safari\//i],[_u,[K,"GSA"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[_u,[K,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[K,"Chrome WebView"],_u],[/droid.+\sversion\/([\w\.]+)\b.+(?:mobile\ssafari|safari)/i],[_u,[K,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[K,_u],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[_u,[K,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[_u,K],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[K,[_u,k_.str,Rv.browser.oldSafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[K,_u],[/(navigator|netscape)\/([\w\.-]+)/i],[[K,"Netscape"],_u],[/ile\svr;\srv:([\w\.]+)\).+firefox/i],[_u,[K,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[K,_u]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[ch,"amd64"]],[/(ia32(?=;))/i],[[ch,w_.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[ch,"ia32"]],[/\b(aarch64|armv?8e?l?)\b/i],[[ch,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[ch,"armhf"]],[/windows\s(ce|mobile);\sppc;/i],[[ch,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[ch,/ower/,"",w_.lowerize]],[/(sun4\w)[;\)]/i],[[ch,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?:64|(?=v(?:[1-7]|[5-7]1)l?|;|eabi))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[ch,w_.lowerize]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus\s10)/i],[_e,[_o,"Samsung"],[_i,i_]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy\snexus)/i,/\ssamsung[\s-]([\w-]+)/i,/sec-(sgh\w+)/i],[_e,[_o,"Samsung"],[_i,o_]],[/\((ip(?:hone|od)[\s\w]*);/i],[_e,[_o,"Apple"],[_i,o_]],[/\((ipad);[\w\s\),;-]+apple/i,/applecoremedia\/[\w\.]+\s\((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[_e,[_o,"Apple"],[_i,i_]],[/\b((?:agr|ags[23]|bah2?|sht?)-a?[lw]\d{2})/i],[_e,[_o,"Huawei"],[_i,i_]],[/d\/huawei([\w\s-]+)[;\)]/i,/\b(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?|ele-l\d\d)/i,/\b(\w{2,4}-[atu][ln][01259][019])[;\)\s]/i],[_e,[_o,"Huawei"],[_i,o_]],[/\b(poco[\s\w]+)(?:\sbuild|\))/i,/\b;\s(\w+)\sbuild\/hm\1/i,/\b(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/\b(redmi[\s\-_]?(?:note|k)?[\w\s_]+)(?:\sbuild|\))/i,/\b(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[_e,/_/g," "],[_o,"Xiaomi"],[_i,o_]],[/\b(mi[\s\-_]?(?:pad)(?:[\w\s_]+))(?:\sbuild|\))/i],[[_e,/_/g," "],[_o,"Xiaomi"],[_i,i_]],[/;\s(\w+)\sbuild.+\soppo/i,/\s(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[_e,[_o,"OPPO"],[_i,o_]],[/\svivo\s(\w+)(?:\sbuild|\))/i,/\s(v[12]\d{3}\w?[at])(?:\sbuild|;)/i],[_e,[_o,"Vivo"],[_i,o_]],[/\s(rmx[12]\d{3})(?:\sbuild|;)/i],[_e,[_o,"Realme"],[_i,o_]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)\b[\w\s]+build\//i,/\smot(?:orola)?[\s-](\w*)/i,/((?:moto[\s\w\(\)]+|xt\d{3,4}|nexus\s6)(?=\sbuild|\)))/i],[_e,[_o,"Motorola"],[_i,o_]],[/\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[_e,[_o,"Motorola"],[_i,i_]],[/((?=lg)?[vl]k\-?\d{3})\sbuild|\s3\.[\s\w;-]{10}lg?-([06cv9]{3,4})/i],[_e,[_o,"LG"],[_i,i_]],[/(lm-?f100[nv]?|nexus\s[45])/i,/lg[e;\s\/-]+((?!browser|netcast)\w+)/i,/\blg(\-?[\d\w]+)\sbuild/i],[_e,[_o,"LG"],[_i,o_]],[/(ideatab[\w\-\s]+)/i,/lenovo\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+)|yt[\d\w-]{6}|tb[\d\w-]{6})/i],[_e,[_o,"Lenovo"],[_i,i_]],[/(?:maemo|nokia).*(n900|lumia\s\d+)/i,/nokia[\s_-]?([\w\.-]*)/i],[[_e,/_/g," "],[_o,"Nokia"],[_i,o_]],[/droid.+;\s(pixel\sc)[\s)]/i],[_e,[_o,"Google"],[_i,i_]],[/droid.+;\s(pixel[\s\daxl]{0,6})(?:\sbuild|\))/i],[_e,[_o,"Google"],[_i,o_]],[/droid.+\s([c-g]\d{4}|so[-l]\w+|xq-a\w[4-7][12])(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[_e,[_o,"Sony"],[_i,o_]],[/sony\stablet\s[ps]\sbuild\//i,/(?:sony)?sgp\w+(?:\sbuild\/|\))/i],[[_e,"Xperia Tablet"],[_o,"Sony"],[_i,i_]],[/\s(kb2005|in20[12]5|be20[12][59])\b/i,/\ba000(1)\sbuild/i,/\boneplus\s(a\d{4})[\s)]/i],[_e,[_o,"OnePlus"],[_i,o_]],[/(alexa)webm/i,/(kf[a-z]{2}wi)(\sbuild\/|\))/i,/(kf[a-z]+)(\sbuild\/|\)).+silk\//i],[_e,[_o,"Amazon"],[_i,i_]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[_e,"Fire Phone"],[_o,"Amazon"],[_i,o_]],[/\((playbook);[\w\s\),;-]+(rim)/i],[_e,_o,[_i,i_]],[/((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10;\s(\w+)/i],[_e,[_o,"BlackBerry"],[_i,o_]],[/(?:\b|asus_)(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus\s7|padfone|p00[cj])/i],[_e,[_o,"ASUS"],[_i,i_]],[/\s(z[es]6[027][01][km][ls]|zenfone\s\d\w?)\b/i],[_e,[_o,"ASUS"],[_i,o_]],[/(nexus\s9)/i],[_e,[_o,"HTC"],[_i,i_]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[_o,[_e,/_/g," "],[_i,o_]],[/droid[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[_e,[_o,"Acer"],[_i,i_]],[/droid.+;\s(m[1-5]\snote)\sbuild/i,/\bmz-([\w-]{2,})/i],[_e,[_o,"Meizu"],[_i,o_]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i,/(microsoft);\s(lumia[\s\w]+)/i,/(lenovo)[_\s-]?([\w-]+)/i,/linux;.+(jolla);/i,/droid.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[_o,_e,[_i,o_]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i,/[;\/]\s?(le[\s\-]+pan)[\s\-]+(\w{1,9})\sbuild/i,/[;\/]\s?(trinity)[\-\s]*(t\d{3})\sbuild/i,/\b(gigaset)[\s\-]+(q\w{1,9})\sbuild/i,/\b(vodafone)\s([\w\s]+)(?:\)|\sbuild)/i],[_o,_e,[_i,i_]],[/\s(surface\sduo)\s/i],[_e,[_o,"Microsoft"],[_i,i_]],[/droid\s[\d\.]+;\s(fp\du?)\sbuild/i],[_e,[_o,"Fairphone"],[_i,o_]],[/\s(u304aa)\sbuild/i],[_e,[_o,"AT&T"],[_i,o_]],[/sie-(\w*)/i],[_e,[_o,"Siemens"],[_i,o_]],[/[;\/]\s?(rct\w+)\sbuild/i],[_e,[_o,"RCA"],[_i,i_]],[/[;\/\s](venue[\d\s]{2,7})\sbuild/i],[_e,[_o,"Dell"],[_i,i_]],[/[;\/]\s?(q(?:mv|ta)\w+)\sbuild/i],[_e,[_o,"Verizon"],[_i,i_]],[/[;\/]\s(?:barnes[&\s]+noble\s|bn[rt])([\w\s\+]*)\sbuild/i],[_e,[_o,"Barnes & Noble"],[_i,i_]],[/[;\/]\s(tm\d{3}\w+)\sbuild/i],[_e,[_o,"NuVision"],[_i,i_]],[/;\s(k88)\sbuild/i],[_e,[_o,"ZTE"],[_i,i_]],[/;\s(nx\d{3}j)\sbuild/i],[_e,[_o,"ZTE"],[_i,o_]],[/[;\/]\s?(gen\d{3})\sbuild.*49h/i],[_e,[_o,"Swiss"],[_i,o_]],[/[;\/]\s?(zur\d{3})\sbuild/i],[_e,[_o,"Swiss"],[_i,i_]],[/[;\/]\s?((zeki)?tb.*\b)\sbuild/i],[_e,[_o,"Zeki"],[_i,i_]],[/[;\/]\s([yr]\d{2})\sbuild/i,/[;\/]\s(dragon[\-\s]+touch\s|dt)(\w{5})\sbuild/i],[[_o,"Dragon Touch"],_e,[_i,i_]],[/[;\/]\s?(ns-?\w{0,9})\sbuild/i],[_e,[_o,"Insignia"],[_i,i_]],[/[;\/]\s?((nxa|Next)-?\w{0,9})\sbuild/i],[_e,[_o,"NextBook"],[_i,i_]],[/[;\/]\s?(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05]))\sbuild/i],[[_o,"Voice"],_e,[_i,o_]],[/[;\/]\s?(lvtel\-)?(v1[12])\sbuild/i],[[_o,"LvTel"],_e,[_i,o_]],[/;\s(ph-1)\s/i],[_e,[_o,"Essential"],[_i,o_]],[/[;\/]\s?(v(100md|700na|7011|917g).*\b)\sbuild/i],[_e,[_o,"Envizen"],[_i,i_]],[/[;\/]\s?(trio[\s\w\-\.]+)\sbuild/i],[_e,[_o,"MachSpeed"],[_i,i_]],[/[;\/]\s?tu_(1491)\sbuild/i],[_e,[_o,"Rotor"],[_i,i_]],[/(shield[\w\s]+)\sbuild/i],[_e,[_o,"Nvidia"],[_i,i_]],[/(sprint)\s(\w+)/i],[_o,_e,[_i,o_]],[/(kin\.[onetw]{3})/i],[[_e,/\./g," "],[_o,"Microsoft"],[_i,o_]],[/droid\s[\d\.]+;\s(cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[_e,[_o,"Zebra"],[_i,i_]],[/droid\s[\d\.]+;\s(ec30|ps20|tc[2-8]\d[kx])\)/i],[_e,[_o,"Zebra"],[_i,o_]],[/\s(ouya)\s/i,/(nintendo)\s([wids3utch]+)/i],[_o,_e,[_i,_f]],[/droid.+;\s(shield)\sbuild/i],[_e,[_o,"Nvidia"],[_i,_f]],[/(playstation\s[345portablevi]+)/i],[_e,[_o,"Sony"],[_i,_f]],[/[\s\(;](xbox(?:\sone)?(?!;\sxbox))[\s\);]/i],[_e,[_o,"Microsoft"],[_i,_f]],[/smart-tv.+(samsung)/i],[_o,[_i,u_]],[/hbbtv.+maple;(\d+)/i],[[_e,/^/,"SmartTV"],[_o,"Samsung"],[_i,u_]],[/(?:linux;\snetcast.+smarttv|lg\snetcast\.tv-201\d)/i],[[_o,"LG"],[_i,u_]],[/(apple)\s?tv/i],[_o,[_e,"Apple TV"],[_i,u_]],[/crkey/i],[[_e,"Chromecast"],[_o,"Google"],[_i,u_]],[/droid.+aft([\w])(\sbuild\/|\))/i],[_e,[_o,"Amazon"],[_i,u_]],[/\(dtv[\);].+(aquos)/i],[_e,[_o,"Sharp"],[_i,u_]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[_o,w_.trim],[_e,w_.trim],[_i,u_]],[/[\s\/\(](android\s|smart[-\s]?|opera\s)tv[;\)\s]/i],[[_i,u_]],[/((pebble))app\/[\d\.]+\s/i],[_o,_e,[_i,g_]],[/droid.+;\s(glass)\s\d/i],[_e,[_o,"Google"],[_i,g_]],[/droid\s[\d\.]+;\s(wt63?0{2,3})\)/i],[_e,[_o,"Zebra"],[_i,g_]],[/(tesla)(?:\sqtcarbrowser|\/20[12]\d\.[\w\.-]+)/i],[_o,[_i,__]],[/droid .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[_e,[_i,o_]],[/droid .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[_e,[_i,i_]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[_i,w_.lowerize]],[/(android[\w\.\s\-]{0,9});.+build/i],[_e,[_o,"Generic"]],[/(phone)/i],[[_i,o_]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[_u,[K,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[_u,[K,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[K,_u],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[_u,K]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[K,_u],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)(?!.+xbox)/i],[K,[_u,k_.str,Rv.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[K,"Windows"],[_u,k_.str,Rv.os.windows.version]],[/ip[honead]{2,4}\b(?:.*os\s([\w]+)\slike\smac|;\sopera)/i,/cfnetwork\/.+darwin/i],[[_u,/_/g,"."],[K,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)(?!.+haiku)/i],[[K,"Mac OS"],[_u,/_/g,"."]],[/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/\((series40);/i],[K,_u],[/\(bb(10);/i],[_u,[K,"BlackBerry"]],[/(?:symbian\s?os|symbos|s60(?=;)|series60)[\/\s-]?([\w\.]*)/i],[_u,[K,"Symbian"]],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[K,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[_u,[K,"webOS"]],[/crkey\/([\d\.]+)/i],[_u,[K,"Chromecast"]],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[K,"Chromium OS"],_u],[/(nintendo|playstation)\s([wids345portablevuch]+)/i,/(xbox);\s+xbox\s([^\);]+)/i,/(mint)[\/\s\(\)]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?=\slinux)|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus|raspbian)(?:\sgnu\/linux)?(?:\slinux)?[\/\s-]?(?!chrom|package)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i,/\s([frentopc-]{0,4}bsd|dragonfly)\s?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku)\s(\w+)/i],[K,_u],[/(sunos)\s?([\w\.\d]*)/i],[[K,"Solaris"],_u],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[K,_u]]},y0=function(q0,Z0){if("object"==typeof q0&&(Z0=q0,q0=y),!(this instanceof y0))return new y0(q0,Z0).getResult();var a0=q0||(void 0!==A&&A.navigator&&A.navigator.userAgent?A.navigator.userAgent:""),j_=Z0?w_.extend(f0,Z0):f0;return this.getBrowser=function(){var Z_={name:y,version:y};return k_.rgx.call(Z_,a0,j_.browser),Z_.major=w_.major(Z_.version),Z_},this.getCPU=function(){var Z_={architecture:y};return k_.rgx.call(Z_,a0,j_.cpu),Z_},this.getDevice=function(){var Z_={vendor:y,model:y,type:y};return k_.rgx.call(Z_,a0,j_.device),Z_},this.getEngine=function(){var Z_={name:y,version:y};return k_.rgx.call(Z_,a0,j_.engine),Z_},this.getOS=function(){var Z_={name:y,version:y};return k_.rgx.call(Z_,a0,j_.os),Z_},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return a0},this.setUA=function(Z_){return a0=typeof Z_===j&&Z_.length>255?w_.trim(Z_,255):Z_,this},this.setUA(a0),this};y0.VERSION="0.7.28",y0.BROWSER={NAME:K,MAJOR:"major",VERSION:_u},y0.CPU={ARCHITECTURE:ch},y0.DEVICE={MODEL:_e,VENDOR:_o,TYPE:_i,CONSOLE:_f,MOBILE:o_,SMARTTV:u_,TABLET:i_,WEARABLE:g_,EMBEDDED:__},y0.ENGINE={NAME:K,VERSION:_u},y0.OS={NAME:K,VERSION:_u},s.exports&&(p=s.exports=y0),p.UAParser=y0;var b0=void 0!==A&&(A.jQuery||A.Zepto);if(b0&&!b0.ua){var rI=new y0;b0.ua=rI.getResult(),b0.ua.get=function(){return rI.getUA()},b0.ua.set=function(q0){rI.setUA(q0);var Z0=rI.getResult();for(var a0 in Z0)b0.ua[a0]=Z0[a0]}}}("object"==typeof window?window:k)}(Mae,Mae.exports);const Bae=new Mae.exports;let y6=Bae.getResult();function Y1(s){return s&&Bae.setUA(s),y6=Bae.getResult(),{name:XAe(y6),version:e_e(y6),os:t_e(y6),osVersion:y6.os.version}}function XAe(s){if("Blink"===s.engine.name&&"WeChat"!==s.browser.name)return C1.CHROME;switch(s.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return C1.CHROME;case"Safari":case"Mobile Safari":return C1.SAFARI;case"Edge":return C1.EDGE;case"Firefox":return C1.FIREFOX;case"QQBrowser":return C1.QQ;case"Opera":return C1.OPERA;case"WeChat":return C1.WECHAT;default:return s.browser.name||""}}function e_e(s){let p;return p="Blink"===s.engine.name?s.engine.version||"":s.browser.version||"",p.split(".")[0]}function t_e(s){return"Windows"===s.os.name?s.os.version?s.os.name+" "+s.os.version:s.os.name:s.os.name||""}function efe(){return Y1().os}function Hne(){const s=Y1();return!!("WebKit"===y6.engine.name&&s.os===wR.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&s.name!==C1.SAFARI||r2()&&s.name!==C1.SAFARI)}function nZ(){return Y1().name===C1.CHROME}function Z2(){return Y1().name===C1.SAFARI}function X2(){return Y1().name===C1.FIREFOX}function r2(){return Y1().os===wR.IOS}function Fae(){const s=Y1();if(s.os!==wR.IOS||!s.osVersion)return!1;const p=s.osVersion.split(".");return 13===Number(p[0])}function rK(){const s=Y1();if(s.os!==wR.IOS||!s.osVersion)return!1;const p=s.osVersion.split(".");return 15===Number(p[0])}function tfe(){const s=Y1();if(s.os!==wR.IOS||!s.osVersion)return!1;const p=s.osVersion.split(".");return 15===Number(p[0])&&0===Number(p[1])}function nfe(){const s=Y1();if(s.os!==wR.IOS||!s.osVersion)return!1;const p=s.osVersion.split(".");return 15===Number(p[0])&&Number(p[1])>=1}function kM(){const s=Y1();if(s.os!==wR.IOS||!s.osVersion)return!1;const p=s.osVersion.split(".");return 15===Number(p[0])&&Number(p[1])>=2}function WU(){return Z2()&&navigator.maxTouchPoints>0}function rfe(){return Y1().name===C1.WECHAT}function ife(){return window.navigator.appVersion&&null!==window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function bQ(){const s=Y1();return s.name!==C1.EDGE&&s.name!==C1.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function ofe(){return Y1().os===wR.ANDROID}var i2={exports:{}},iK=GP.f;xS({target:"Object",stat:!0,forced:Object.defineProperty!==iK,sham:!B2},{defineProperty:iK});var sfe=IU.Object,r_e=i2.exports=function(s,p,A){return sfe.defineProperty(s,p,A)};sfe.defineProperty.sham&&(r_e.sham=!0);var jae=i2.exports;function a_(s,p,A){return p in s?jae(s,p,{value:A,enumerable:!0,configurable:!0,writable:!0}):s[p]=A,s}var rZ={exports:{}},Vae=function(s,p){return function(){for(var A=new Array(arguments.length),y=0;y<A.length;y++)A[y]=arguments[y];return s.apply(p,A)}},afe=Vae,oK=Object.prototype.toString;function KU(s){return"[object Array]"===oK.call(s)}function zU(s){return null!==s&&"object"==typeof s}function iZ(s){return"[object Function]"===oK.call(s)}function Wne(s,p){if(null!=s)if("object"!=typeof s&&(s=[s]),KU(s))for(var A=0,y=s.length;A<y;A++)p.call(null,s[A],A,s);else for(var w in s)Object.prototype.hasOwnProperty.call(s,w)&&p.call(null,s[w],w,s)}var xL={isArray:KU,isArrayBuffer:function(s){return"[object ArrayBuffer]"===oK.call(s)},isBuffer:function(s){return null!=s&&null!=s.constructor&&"function"==typeof s.constructor.isBuffer&&s.constructor.isBuffer(s)},isFormData:function(s){return"undefined"!=typeof FormData&&s instanceof FormData},isArrayBufferView:function(s){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(s):s&&s.buffer&&s.buffer instanceof ArrayBuffer},isString:function(s){return"string"==typeof s},isNumber:function(s){return"number"==typeof s},isObject:zU,isUndefined:function(s){return void 0===s},isDate:function(s){return"[object Date]"===oK.call(s)},isFile:function(s){return"[object File]"===oK.call(s)},isBlob:function(s){return"[object Blob]"===oK.call(s)},isFunction:iZ,isStream:function(s){return zU(s)&&iZ(s.pipe)},isURLSearchParams:function(s){return"undefined"!=typeof URLSearchParams&&s instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:Wne,merge:function s(){var p={};function A($,j){p[j]="object"==typeof p[j]&&"object"==typeof $?s(p[j],$):$}for(var y=0,w=arguments.length;y<w;y++)Wne(arguments[y],A);return p},deepMerge:function s(){var p={};function A($,j){p[j]="object"==typeof p[j]&&"object"==typeof $?s(p[j],$):"object"==typeof $?s({},$):$}for(var y=0,w=arguments.length;y<w;y++)Wne(arguments[y],A);return p},extend:function(s,p,A){return Wne(p,function(y,w){s[w]=A&&"function"==typeof y?afe(y,A):y}),s},trim:function(s){return s.replace(/^\s*/,"").replace(/\s*$/,"")}},YU=xL;function sK(s){return encodeURIComponent(s).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var Gae=function(s,p,A){if(!p)return s;var y;if(A)y=A(p);else if(YU.isURLSearchParams(p))y=p.toString();else{var w=[];YU.forEach(p,function(j,_e){null!=j&&(YU.isArray(j)?_e+="[]":j=[j],YU.forEach(j,function(K){YU.isDate(K)?K=K.toISOString():YU.isObject(K)&&(K=JSON.stringify(K)),w.push(sK(_e)+"="+sK(K))}))}),y=w.join("&")}if(y){var $=s.indexOf("#");-1!==$&&(s=s.slice(0,$)),s+=(-1===s.indexOf("?")?"?":"&")+y}return s},o_e=xL;function oZ(){this.handlers=[]}oZ.prototype.use=function(s,p){return this.handlers.push({fulfilled:s,rejected:p}),this.handlers.length-1},oZ.prototype.eject=function(s){this.handlers[s]&&(this.handlers[s]=null)},oZ.prototype.forEach=function(s){o_e.forEach(this.handlers,function(p){null!==p&&s(p)})};var s_e=oZ,a_e=xL,cfe=function(s){return!(!s||!s.__CANCEL__)},c_e=xL,Qae=function(s,p,A,y,w){return function(s,p,A,y,w){return s.config=p,A&&(s.code=A),s.request=y,s.response=w,s.isAxiosError=!0,s.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},s}(new Error(s),p,A,y,w)},Kne=Qae,sZ=xL,u_e=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],lfe=xL,dfe=lfe.isStandardBrowserEnv()?function(){var s,p=/(msie|trident)/i.test(navigator.userAgent),A=document.createElement("a");function y(w){var $=w;return p&&(A.setAttribute("href",$),$=A.href),A.setAttribute("href",$),{href:A.href,protocol:A.protocol?A.protocol.replace(/:$/,""):"",host:A.host,search:A.search?A.search.replace(/^\?/,""):"",hash:A.hash?A.hash.replace(/^#/,""):"",hostname:A.hostname,port:A.port,pathname:"/"===A.pathname.charAt(0)?A.pathname:"/"+A.pathname}}return s=y(window.location.href),function(w){var $=lfe.isString(w)?y(w):w;return $.protocol===s.protocol&&$.host===s.host}}():function(){return!0},zne=xL,l_e=zne.isStandardBrowserEnv()?{write:function(s,p,A,y,w,$){var j=[];j.push(s+"="+encodeURIComponent(p)),zne.isNumber(A)&&j.push("expires="+new Date(A).toGMTString()),zne.isString(y)&&j.push("path="+y),zne.isString(w)&&j.push("domain="+w),!0===$&&j.push("secure"),document.cookie=j.join("; ")},read:function(s){var p=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return p?decodeURIComponent(p[3]):null},remove:function(s){this.write(s,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},AN=xL,d_e=Gae,hfe=dfe,qae=Qae,BS=xL,ffe=function(s,p){c_e.forEach(s,function(A,y){y!==p&&y.toUpperCase()===p.toUpperCase()&&(s[p]=A,delete s[y])})},f_e={"Content-Type":"application/x-www-form-urlencoded"};function pfe(s,p){!BS.isUndefined(s)&&BS.isUndefined(s["Content-Type"])&&(s["Content-Type"]=p)}var gfe,aZ={adapter:(("undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process)||"undefined"!=typeof XMLHttpRequest)&&(gfe=function(s){return new Promise(function(p,A){var y=s.data,w=s.headers;AN.isFormData(y)&&delete w["Content-Type"];var $=new XMLHttpRequest;if(s.auth&&(w.Authorization="Basic "+btoa((s.auth.username||"")+":"+(s.auth.password||""))),$.open(s.method.toUpperCase(),d_e(s.url,s.params,s.paramsSerializer),!0),$.timeout=s.timeout,$.onreadystatechange=function(){if($&&4===$.readyState&&(0!==$.status||$.responseURL&&0===$.responseURL.indexOf("file:"))){var _o="getAllResponseHeaders"in $?function(s){var p,A,y,w={};return s&&sZ.forEach(s.split("\n"),function($){if(y=$.indexOf(":"),p=sZ.trim($.substr(0,y)).toLowerCase(),A=sZ.trim($.substr(y+1)),p){if(w[p]&&u_e.indexOf(p)>=0)return;w[p]="set-cookie"===p?(w[p]?w[p]:[]).concat([A]):w[p]?w[p]+", "+A:A}}),w}($.getAllResponseHeaders()):null;(function(s,p,A){var y=A.config.validateStatus;!y||y(A.status)?s(A):p(Kne("Request failed with status code "+A.status,A.config,null,A.request,A))})(p,A,{data:s.responseType&&"text"!==s.responseType?$.response:$.responseText,status:$.status,statusText:$.statusText,headers:_o,config:s,request:$}),$=null}},$.onabort=function(){$&&(A(qae("Request aborted",s,"ECONNABORTED",$)),$=null)},$.onerror=function(){A(qae("Network Error",s,null,$)),$=null},$.ontimeout=function(){A(qae("timeout of "+s.timeout+"ms exceeded",s,"ECONNABORTED",$)),$=null},AN.isStandardBrowserEnv()){var K=l_e,_i=(s.withCredentials||hfe(s.url))&&s.xsrfCookieName?K.read(s.xsrfCookieName):void 0;_i&&(w[s.xsrfHeaderName]=_i)}if("setRequestHeader"in $&&AN.forEach(w,function(_o,_u){void 0===y&&"content-type"===_u.toLowerCase()?delete w[_u]:$.setRequestHeader(_u,_o)}),s.withCredentials&&($.withCredentials=!0),s.responseType)try{$.responseType=s.responseType}catch(_o){if("json"!==s.responseType)throw _o}"function"==typeof s.onDownloadProgress&&$.addEventListener("progress",s.onDownloadProgress),"function"==typeof s.onUploadProgress&&$.upload&&$.upload.addEventListener("progress",s.onUploadProgress),s.cancelToken&&s.cancelToken.promise.then(function(_o){$&&($.abort(),A(_o),$=null)}),void 0===y&&(y=null),$.send(y)})}),gfe),transformRequest:[function(s,p){return ffe(p,"Accept"),ffe(p,"Content-Type"),BS.isFormData(s)||BS.isArrayBuffer(s)||BS.isBuffer(s)||BS.isStream(s)||BS.isFile(s)||BS.isBlob(s)?s:BS.isArrayBufferView(s)?s.buffer:BS.isURLSearchParams(s)?(pfe(p,"application/x-www-form-urlencoded;charset=utf-8"),s.toString()):BS.isObject(s)?(pfe(p,"application/json;charset=utf-8"),JSON.stringify(s)):s}],transformResponse:[function(s){if("string"==typeof s)try{s=JSON.parse(s)}catch(p){}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};BS.forEach(["delete","get","head"],function(s){aZ.headers[s]={}}),BS.forEach(["post","put","patch"],function(s){aZ.headers[s]=BS.merge(f_e)});var L8=aZ,mfe=xL,Wae=function(s,p,A){return a_e.forEach(A,function(y){s=y(s,p)}),s},Afe=cfe,p_e=L8;function Yne(s){s.cancelToken&&s.cancelToken.throwIfRequested()}var E6=xL,Kae=function(s,p){p=p||{};var A={};return E6.forEach(["url","method","params","data"],function(y){void 0!==p[y]&&(A[y]=p[y])}),E6.forEach(["headers","auth","proxy"],function(y){E6.isObject(p[y])?A[y]=E6.deepMerge(s[y],p[y]):void 0!==p[y]?A[y]=p[y]:E6.isObject(s[y])?A[y]=E6.deepMerge(s[y]):void 0!==s[y]&&(A[y]=s[y])}),E6.forEach(["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"],function(y){void 0!==p[y]?A[y]=p[y]:void 0!==s[y]&&(A[y]=s[y])}),A},Jne=xL,A_e=Gae,_fe=s_e,__e=function(s){return Yne(s),s.baseURL&&!function(s){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(s)}(s.url)&&(s.url=function(s,p){return p?s.replace(/\/+$/,"")+"/"+p.replace(/^\/+/,""):s}(s.baseURL,s.url)),s.headers=s.headers||{},s.data=Wae(s.data,s.headers,s.transformRequest),s.headers=mfe.merge(s.headers.common||{},s.headers[s.method]||{},s.headers||{}),mfe.forEach(["delete","get","head","post","put","patch","common"],function(p){delete s.headers[p]}),(s.adapter||p_e.adapter)(s).then(function(p){return Yne(s),p.data=Wae(p.data,p.headers,s.transformResponse),p},function(p){return Afe(p)||(Yne(s),p&&p.response&&(p.response.data=Wae(p.response.data,p.response.headers,s.transformResponse))),Promise.reject(p)})},zae=Kae;function cZ(s){this.defaults=s,this.interceptors={request:new _fe,response:new _fe}}cZ.prototype.request=function(s){"string"==typeof s?(s=arguments[1]||{}).url=arguments[0]:s=s||{},(s=zae(this.defaults,s)).method=s.method?s.method.toLowerCase():"get";var p=[__e,void 0],A=Promise.resolve(s);for(this.interceptors.request.forEach(function(y){p.unshift(y.fulfilled,y.rejected)}),this.interceptors.response.forEach(function(y){p.push(y.fulfilled,y.rejected)});p.length;)A=A.then(p.shift(),p.shift());return A},cZ.prototype.getUri=function(s){return s=zae(this.defaults,s),A_e(s.url,s.params,s.paramsSerializer).replace(/^\?/,"")},Jne.forEach(["delete","get","head","options"],function(s){cZ.prototype[s]=function(p,A){return this.request(Jne.merge(A||{},{method:s,url:p}))}}),Jne.forEach(["post","put","patch"],function(s){cZ.prototype[s]=function(p,A,y){return this.request(Jne.merge(y||{},{method:s,url:p,data:A}))}});var v_e=cZ;function $ne(s){this.message=s}$ne.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},$ne.prototype.__CANCEL__=!0;var vfe=$ne,yfe=vfe;function Zne(s){if("function"!=typeof s)throw new TypeError("executor must be a function.");var p;this.promise=new Promise(function(y){p=y});var A=this;s(function(y){A.reason||(A.reason=new yfe(y),p(A.reason))})}Zne.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},Zne.source=function(){var s;return{token:new Zne(function(p){s=p}),cancel:s}};var Yae=Zne,Jae=xL,Efe=Vae,uZ=v_e,gEe=Kae;function y_e(s){var p=new uZ(s),A=Efe(uZ.prototype.request,p);return Jae.extend(A,uZ.prototype,p),Jae.extend(A,p),A}var I6=y_e(L8);I6.Axios=uZ,I6.create=function(s){return y_e(gEe(I6.defaults,s))},I6.Cancel=vfe,I6.CancelToken=Yae,I6.isCancel=cfe,I6.all=function(s){return Promise.all(s)},I6.spread=function(s){return function(p){return s.apply(null,p)}},rZ.exports=I6,rZ.exports.default=I6;var JU=rZ.exports;class E_e{constructor(p){a_(this,"logger",void 0),a_(this,"prefixLists",[]),this.logger=p}debug(){for(var p=arguments.length,A=new Array(p),y=0;y<p;y++)A[y]=arguments[y];this.logger.debug(...this.prefixLists,...A)}info(){for(var p=arguments.length,A=new Array(p),y=0;y<p;y++)A[y]=arguments[y];this.logger.info(...this.prefixLists,...A)}warning(){for(var p=arguments.length,A=new Array(p),y=0;y<p;y++)A[y]=arguments[y];this.logger.warning(...this.prefixLists,...A)}error(){for(var p=arguments.length,A=new Array(p),y=0;y<p;y++)A[y]=arguments[y];this.logger.error(...this.prefixLists,...A)}prefix(p){return this.prefixLists.push(p),this}popPrefix(){return this.prefixLists.pop(),this}}class sS{constructor(){a_(this,"_events",{}),a_(this,"addListener",this.on)}getListeners(p){return this._events[p]?this._events[p].map(A=>A.listener):[]}on(p,A){this._events[p]||(this._events[p]=[]);const y=this._events[p];-1===this._indexOfListener(y,A)&&y.push({listener:A,once:!1})}once(p,A){this._events[p]||(this._events[p]=[]);const y=this._events[p];-1===this._indexOfListener(y,A)&&y.push({listener:A,once:!0})}off(p,A){if(!this._events[p])return;const y=this._events[p],w=this._indexOfListener(y,A);-1!==w&&y.splice(w,1),0===this._events[p].length&&delete this._events[p]}removeAllListeners(p){p?delete this._events[p]:this._events={}}emit(p){this._events[p]||(this._events[p]=[]);const A=this._events[p].map(j=>j);for(var y=arguments.length,w=new Array(y>1?y-1:0),$=1;$<y;$++)w[$-1]=arguments[$];for(let j=0;j<A.length;j+=1){const _e=A[j];_e.once&&this.off(p,_e.listener),_e.listener.apply(this,w||[])}}_indexOfListener(p,A){let y=p.length;for(;y--;)if(p[y].listener===A)return y;return-1}}const Xne=new class extends sS{reportLogUploadError(s){this.emit("REPORT_LOG_UPLOAD",s)}};let N_;!function(s){s.UNEXPECTED_ERROR="UNEXPECTED_ERROR",s.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",s.TIMEOUT="TIMEOUT",s.INVALID_PARAMS="INVALID_PARAMS",s.NOT_READABLE="NOT_READABLE",s.NOT_SUPPORTED="NOT_SUPPORTED",s.INVALID_OPERATION="INVALID_OPERATION",s.OPERATION_ABORTED="OPERATION_ABORTED",s.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",s.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",s.NETWORK_ERROR="NETWORK_ERROR",s.NETWORK_TIMEOUT="NETWORK_TIMEOUT",s.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",s.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",s.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",s.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",s.ELECTRON_IS_NULL="ELECTRON_IS_NULL",s.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",s.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",s.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",s.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",s.PERMISSION_DENIED="PERMISSION_DENIED",s.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",s.TRACK_IS_DISABLED="TRACK_IS_DISABLED",s.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",s.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",s.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",s.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",s.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",s.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",s.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",s.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",s.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",s.UID_CONFLICT="UID_CONFLICT",s.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",s.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",s.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",s.INVALID_TRACK="INVALID_TRACK",s.SENDER_NOT_FOUND="SENDER_NOT_FOUND",s.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",s.SET_ANSWER_FAILED="SET_ANSWER_FAILED",s.ICE_FAILED="ICE_FAILED",s.PC_CLOSED="PC_CLOSED",s.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",s.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",s.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",s.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",s.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",s.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",s.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",s.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",s.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",s.INVALID_REMOTE_USER="INVALID_REMOTE_USER",s.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",s.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",s.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",s.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",s.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",s.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",s.WS_ABORT="WS_ABORT",s.WS_DISCONNECT="WS_DISCONNECT",s.WS_ERR="WS_ERR",s.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",s.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",s.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",s.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",s.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",s.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",s.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",s.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",s.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",s.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",s.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",s.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",s.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",s.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",s.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",s.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",s.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",s.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",s.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",s.INVALID_PLUGIN="INVALID_PLUGIN",s.DISCONNECT_P2P="DISCONNECT_P2P",s.INIT_WEBSOCKET_TIMEOUT="INIT_WEBSOCKET_TIMEOUT"}(N_||(N_={}));class U_ extends Error{constructor(p){let A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",y=arguments.length>2?arguments[2]:void 0;super(A),a_(this,"code",void 0),a_(this,"message",void 0),a_(this,"data",void 0),a_(this,"name","AgoraRTCException"),this.code=p,this.message="AgoraRTCError ".concat(this.code,": ").concat(A),this.data=y}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),"\n").concat(this.stack):"".concat(this.stack)}print(){let p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error";return"error"===p&&h_.error(this.toString()),"warning"===p&&h_.warning(this.toString()),this}throw(){throw this.print(),this}}const pS={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function ere(s,p){const A=Math.floor(p.timeout*Math.pow(p.timeoutFactor,s));return Math.min(p.maxRetryTimeout,A)}function LL(s,p,A,y){const w=Object.assign({},pS,y);let $=w.timeout;const j=function(){var _i=f(function*(){var _o;yield(_o=$,new iI(_u=>{window.setTimeout(_u,_o)})),$*=w.timeoutFactor,$=Math.min(w.maxRetryTimeout,$)});return function(){return _i.apply(this,arguments)}}();let _e=!1;const K=new iI(function(){var _i=f(function*(_o,_u){p=p||(()=>!1),A=A||(()=>!0);for(let ch=0;ch<w.maxRetryCount;ch+=1){if(_e)return _u(new U_(N_.OPERATION_ABORTED));try{const _f=yield s();if(!p(_f,ch)||ch+1===w.maxRetryCount)return _o(_f);yield j()}catch(_f){if(!A(_f,ch)||ch+1===w.maxRetryCount)return _u(_f);yield j()}}});return function(_o,_u){return _i.apply(this,arguments)}}());return K.cancel=()=>_e=!0,K}function Ife(){const s=new Date;return s.toTimeString().split(" ")[0]+":"+s.getMilliseconds()}const ML={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},$ae=Date.now(),bfe=s=>{for(const p in ML)if(Object.prototype.hasOwnProperty.call(ML,p)&&ML[p]===s)return p;return"DEFAULT"},h_=new class{constructor(){a_(this,"proxyServerURL",void 0),a_(this,"logLevel",ML.DEBUG),a_(this,"uploadState","collecting"),a_(this,"uploadLogWaitingList",[]),a_(this,"uploadLogUploadingList",[]),a_(this,"uploadErrorCount",0),a_(this,"currentLogID",0),a_(this,"url",void 0),a_(this,"extLog",(s,p)=>{this.appendLogToWaitingList(s,p)})}debug(){for(var s=arguments.length,p=new Array(s),A=0;A<s;A++)p[A]=arguments[A];const y=[ML.DEBUG].concat(p);this.log.apply(this,y)}info(){for(var s=arguments.length,p=new Array(s),A=0;A<s;A++)p[A]=arguments[A];const y=[ML.INFO].concat(p);this.log.apply(this,y)}warning(){for(var s=arguments.length,p=new Array(s),A=0;A<s;A++)p[A]=arguments[A];const y=[ML.WARNING].concat(p);this.log.apply(this,y)}error(){for(var s=arguments.length,p=new Array(s),A=0;A<s;A++)p[A]=arguments[A];const y=[ML.ERROR].concat(p);this.log.apply(this,y)}upload(){for(var s=arguments.length,p=new Array(s),A=0;A<s;A++)p[A]=arguments[A];const y=[ML.DEBUG].concat(p);this.uploadLog.apply(this,y)}setLogLevel(s){s=Math.min(Math.max(0,s),4),this.logLevel=s}enableLogUpload(){SR("UPLOAD_LOG",!0)}disableLogUpload(){SR("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(s){this.proxyServerURL=s}prefix(s){return new E_e(this).prefix(s)}log(){for(var s=arguments.length,p=new Array(s),A=0;A<s;A++)p[A]=arguments[A];if(Date.now()-$ae<100)return void setTimeout(()=>{this.log(...p)},Date.now()-$ae);const y=Math.max(0,Math.min(4,p[0]));if(p[0]=Ife()+" Agora-SDK [".concat(bfe(y),"]:"),this.appendLogToWaitingList(y,p),y<this.logLevel)return;const w=Ife()+" %cAgora-SDK [".concat(bfe(y),"]:");let $=[];if(!v0("USE_NEW_LOG"))switch(y){case ML.DEBUG:$=[w,"color: #64B5F6;"].concat(p.slice(1)),console.log.apply(console,$);break;case ML.INFO:$=[w,"color: #1E88E5; font-weight: bold;"].concat(p.slice(1)),console.log.apply(console,$);break;case ML.WARNING:$=[w,"color: #FB8C00; font-weight: bold;"].concat(p.slice(1)),console.warn.apply(console,$);break;case ML.ERROR:$=[w,"color: #B00020; font-weight: bold;"].concat(p.slice(1)),console.error.apply(console,$)}}uploadLog(){for(var s=arguments.length,p=new Array(s),A=0;A<s;A++)p[A]=arguments[A];if(Date.now()-$ae<100)return void setTimeout(()=>{this.uploadLog(...p)},Date.now()-$ae);const y=Math.max(0,Math.min(4,p[0]));p[0]=Ife()+" Agora-SDK [".concat(bfe(y),"]:"),this.appendLogToWaitingList(y,p)}appendLogToWaitingList(s){if(!v0("UPLOAD_LOG"))return;let p="";for(var A=arguments.length,y=new Array(A>1?A-1:0),w=1;w<A;w++)y[w-1]=arguments[w];y.forEach($=>{"object"==typeof $&&($=JSON.stringify($)),p+="".concat($," ")}),this.uploadLogWaitingList.push({payload_str:p,log_level:s,log_item_id:this.currentLogID++}),"uploading"===this.uploadState&&0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}uploadLogs(){var s=this;return f(function*(){const p=s.uploadLogUploadingList,A={sdk_version:GO,process_id:v0("PROCESS_ID"),payload:JSON.stringify(p)};return LL(f(function*(){const y=yield JU.post(s.url||(s.proxyServerURL?"https://".concat(s.proxyServerURL,"/ls/?h=").concat(v0("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(v0("LOG_UPLOAD_SERVER"),"/upload/v1")),A,{responseType:"text"});if("OK"!==y.data){const w=new Error("unexpected upload log response");throw w.response=y,w}}),()=>(s.uploadLogUploadingList=[],!1),y=>(Xne.reportLogUploadError(y.response?{status:y.response.status,data:y.response.data,headers:y.response.headers,message:y.message}:y.request?{status:y.request.status,message:y.message}:{status:-1,message:y.message}),!0),{timeout:2e3,maxRetryTimeout:2e4})})()}uploadLogInterval(){0===this.uploadLogUploadingList.length&&0===this.uploadLogWaitingList.length||(0===this.uploadLogUploadingList.length&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,10)),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),3e3)}).catch(s=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),200):window.setTimeout(()=>this.uploadLogInterval(),1e3)}))}},tre={debug:console.log,info:console.log,warning:console.warn,error:console.error},CQ={debug:"color: #64B5F6;",info:"color: #1E88E5; font-weight: bold;",warning:"color: #FB8C00; font-weight: bold;",error:"color: #B00020; font-weight: bold;"},Cfe={debug:0,info:1,warning:2,error:3},lZ=[];let $U,Zae=0,Xae=0,wfe=!1;function nre(){const s=new Date;return[s.getTime(),s.toTimeString().split(" ")[0]+":"+s.getMilliseconds()]}function rre(s){if(!v0("UPLOAD_LOG"))return;let p;switch(s.type){case J1.MISC:p=[s.timestamp,s.level,s.type,s.module,s.instanceId,[s.msg]];break;case J1.INTERNAL_EVENT:case J1.PUBLIC_EVENT:case J1.WEB_EVENT:p=[s.timestamp,s.level,s.type,s.module,s.instanceId,[s.event,s.msg]];break;case J1.INTERNAL_API:case J1.PUBLIC_API:case J1.WEB_API:p=[s.timestamp,s.level,s.type,s.module,s.instanceId,[s.api,s.args,s.result]]}lZ.push(p)}function Tfe(s,p){const[A,y]=nre(),w="warning",$="".concat(y," %cAgora-SDK [").concat(w,"] [INTERNAL API]:"),j={[J1.WEB_API]:"logWebAPI",[J1.PUBLIC_API]:"logPublicAPI",[J1.INTERNAL_API]:"logInternalAPI",[J1.WEB_EVENT]:"logWebEvent",[J1.PUBLIC_EVENT]:"logPublicEvent",[J1.INTERNAL_EVENT]:"logInternalEvent",[J1.MISC]:"logMisc"}[s],_e=[$,CQ.warning,"Log.".concat(j),p];v0("USE_NEW_LOG")&&(ire(w)&&tre.warning.apply(console,_e),rre({timestamp:A,level:w,module:"Log",instanceId:void 0,type:J1.INTERNAL_API,api:j,args:void 0,result:p.toString()}))}function ece(s){if(Array.isArray(s)){let[y,w]=s;return y||(y="Global"),{module:y,instanceId:w}}let p,A;if("string"!=typeof s.__moduleName)throw new Error("Cannot get __moduleName from log instance.");p=s.__moduleName;try{A=s.__instanceId}catch(y){throw new Error("Cannot get __instanceId from log instance.")}return{module:p,instanceId:A}}function ire(s){return Cfe[s]>=Xae}function ore(s,p,A,y,w,$){if(s===J1.PUBLIC_API||s===J1.WEB_API||s===J1.INTERNAL_API)try{const{module:j,instanceId:_e}=ece(A);w=w&&JSON.stringify(w),$=$ instanceof Error?$.toString():$&&JSON.stringify($);const[K,_i]=nre(),_o=["".concat(_i," %cAgora-SDK [").concat(p,"] [").concat({[J1.PUBLIC_API]:"PUBLIC API",[J1.WEB_API]:"WEB API",[J1.INTERNAL_API]:"INTERNAL API"}[s],"]:"),CQ[p],"".concat(j).concat(_e?"<".concat(_e,">"):"",".").concat(y),w,$];v0("USE_NEW_LOG")&&(ire(p)&&tre[p].apply(console,_o),rre({timestamp:K,level:p,module:j,instanceId:_e,type:s,api:y,args:w,result:$}))}catch(j){Tfe(s,j)}}function cK(s,p,A,y,w){if(s===J1.WEB_EVENT||s===J1.INTERNAL_EVENT||s===J1.PUBLIC_EVENT)try{const{module:$,instanceId:j}=ece(A);"string"!=typeof w&&(w=w instanceof Error?w.toString():JSON.stringify(w));const[_e,K]=nre(),_i=["".concat(K," %cAgora-SDK [").concat(p,"] [").concat({[J1.WEB_EVENT]:"WEB EVENT",[J1.PUBLIC_EVENT]:"PUBLIC EVENT",[J1.INTERNAL_EVENT]:"INTERNAL EVENT"}[s],"]:"),CQ[p],"".concat($).concat(j?"<".concat(j,">"):"",".on(").concat(y,")"),w||""];v0("USE_NEW_LOG")&&(ire(p)&&tre[p].apply(console,_i),rre({timestamp:_e,level:p,module:$,instanceId:j,type:s,event:y,msg:w}))}catch($){Tfe(s,$)}}function wQ(s){$U=s}function sI(s,p,A){try{const{module:y,instanceId:w}=ece(p),[$,j]=nre(),_e=["".concat(j," %cAgora-SDK [").concat(s,"] [MISC]:"),CQ[s],"".concat(y).concat(w?"<".concat(w,">"):""),'"'.concat(A,'"')];v0("USE_NEW_LOG")&&(ire(s)&&tre[s].apply(console,_e),rre({timestamp:$,level:s,module:y,instanceId:w,type:J1.MISC,msg:A}))}catch(y){S0("warning",["log"],"logMisc",void 0,y)}}function lT(s,p,A,y){cK(J1.INTERNAL_EVENT,s,p,A,y)}function BL(s,p,A,y){cK(J1.PUBLIC_EVENT,s,p,A,y)}function b6(s,p,A,y){cK(J1.WEB_EVENT,s,p,A,y)}function S0(s,p,A,y,w){ore(J1.INTERNAL_API,s,p,A,y,w)}function uK(s,p,A,y,w){ore(J1.WEB_API,s,p,A,y,w)}function II(s,p,A,y,w){ore(J1.PUBLIC_API,s,p,A,y,w)}function TR(s,p){return function(A){return class extends A{get __moduleName(){return s}get __instanceId(){if(p){if("function"==typeof this[p])return this[p]();{const y=p.split(".");return y.length>0?qP(y).call(y,(w,$)=>{try{return w&&w[$]}catch(j){return}},this):this[p]}}}}}}function sre(s){return ZU.apply(this,arguments)}function ZU(){return ZU=f(function*(s){if(!s&&wfe)return;if(wfe=!0,!v0("UPLOAD_LOG"))return void setTimeout(()=>sre(!0),5e3);if(0===lZ.length)return void setTimeout(()=>sre(!0),3e3);const p=lZ.slice(0,10),A={sdk_version:GO,log_version:v0("LOG_VERSION"),process_id:v0("PROCESS_ID"),index:Zae,logs:JSON.stringify(p)};yield LL(f(function*(){const y=yield JU.post($U?"https://".concat($U,"/ls/?h=").concat(v0("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(v0("LOG_UPLOAD_SERVER"),"/upload/v1"),A,{responseType:"text"});if("OK"!==y.data)throw new Error("Log service response error ".concat(y.data));return y}),void 0,void 0,{timeout:3e3,maxRetryTimeout:1e4}),lZ.splice(0,10),Zae+=p.length,setTimeout(()=>sre(!0),3e3)}),ZU.apply(this,arguments)}const TI="v4.11.1-0-gcd0777ab(5/9/2022, 6:52:38 PM)",GO=function(s){if(s.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return s;const p=s.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(p&&p[1]&&p[2]){const w=p[2];return"".concat(p[1],".").concat(w)}const A=s.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(A&&A[1]&&A[2]){const w=A[2];return"".concat(A[1],".").concat(100*(Number(w)+1))}return"4.0.0.999"}("4.11.1"),A1=function(){try{return!0===JSON.parse("true")}catch(s){return!0}}(),aS={username:"test",password:"111111",turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1},tce={"90p":s1(160,90),"90p_1":s1(160,90),"120p":s1(160,120,15,30,65),"120p_1":s1(160,120,15,30,65),"120p_3":s1(120,120,15,30,50),"120p_4":s1(212,120),"180p":s1(320,180,15,30,140),"180p_1":s1(320,180,15,30,140),"180p_3":s1(180,180,15,30,100),"180p_4":s1(240,180,15,30,120),"240p":s1(320,240,15,40,200),"240p_1":s1(320,240,15,40,200),"240p_3":s1(240,240,15,40,140),"240p_4":s1(424,240,15,40,220),"360p":s1(640,360,15,80,400),"360p_1":s1(640,360,15,80,400),"360p_3":s1(360,360,15,80,260),"360p_4":s1(640,360,30,80,600),"360p_6":s1(360,360,30,80,400),"360p_7":s1(480,360,15,80,320),"360p_8":s1(480,360,30,80,490),"360p_9":s1(640,360,15,80,800),"360p_10":s1(640,360,24,80,800),"360p_11":s1(640,360,24,80,1e3),"480p":s1(640,480,15,100,500),"480p_1":s1(640,480,15,100,500),"480p_2":s1(640,480,30,100,1e3),"480p_3":s1(480,480,15,100,400),"480p_4":s1(640,480,30,100,750),"480p_6":s1(480,480,30,100,600),"480p_8":s1(848,480,15,100,610),"480p_9":s1(848,480,30,100,930),"480p_10":s1(640,480,10,100,400),"720p":s1(1280,720,15,120,1130),"720p_1":s1(1280,720,15,120,1130),"720p_2":s1(1280,720,30,120,2e3),"720p_3":s1(1280,720,30,120,1710),"720p_5":s1(960,720,15,120,910),"720p_6":s1(960,720,30,120,1380),"1080p":s1(1920,1080,15,120,2080),"1080p_1":s1(1920,1080,15,120,2080),"1080p_2":s1(1920,1080,30,120,3e3),"1080p_3":s1(1920,1080,30,120,3150),"1080p_5":s1(1920,1080,60,120,4780),"1440p":s1(2560,1440,30,120,4850),"1440p_1":s1(2560,1440,30,120,4850),"1440p_2":s1(2560,1440,60,120,7350),"4k":s1(3840,2160,30,120,8910),"4k_1":s1(3840,2160,30,120,8910),"4k_3":s1(3840,2160,60,120,13500)},dZ={"480p":UL(640,480,5),"480p_1":UL(640,480,5),"480p_2":UL(640,480,30),"480p_3":UL(640,480,15),"720p":UL(1280,720,5),"720p_1":UL(1280,720,5),"720p_2":UL(1280,720,30),"720p_3":UL(1280,720,15),"1080p":UL(1920,1080,5),"1080p_1":UL(1920,1080,5),"1080p_2":UL(1920,1080,30),"1080p_3":UL(1920,1080,15)},I_e={"1SL1TL":ice(1,1),"3SL3TL":ice(3,3),"2SL3TL":ice(2,3)};function M8(s){return"string"==typeof s?Object.assign({},tce[s]):s}function nce(s){return"string"==typeof s?Object.assign({},dZ[s]):s}function are(s){return"string"==typeof s?Object.assign({},I_e[s]):s}const b_e={speech_low_quality:lK(16e3,!1),speech_standard:lK(32e3,!1,18),music_standard:lK(48e3,!1),standard_stereo:lK(48e3,!0,56),high_quality:lK(48e3,!1,128),high_quality_stereo:lK(48e3,!0,192)};function nO(s){return"string"==typeof s?Object.assign({},b_e[s]):s}function SR(s,p,A){Object.keys(ZS).includes(s)&&(!A&&Object.keys(rce).includes(s)||(ZS[s]=p))}function v0(s){return ZS[s]}const ZS={PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],SUBSCRIBE_TCC:!0,PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,USE_RTX:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_WITH_FALLBACK_PROXY_PENDING_DURATION:2e3,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!0,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},STATS_COLLECTOR_PORT:443},rce={};function lK(s,p,A){return{sampleRate:s,stereo:p,bitrate:A}}function s1(s,p,A,y,w){return{width:s,height:p,frameRate:A,bitrateMin:y,bitrateMax:w}}function UL(s,p,A,y,w){return{width:{max:s},height:{max:p},frameRate:A,bitrateMin:y,bitrateMax:w}}function ice(s,p){return{numSpatialLayers:s,numTemporalLayers:p}}A1||(ZS.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],ZS.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],ZS.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],ZS.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ZS.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],ZS.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],ZS.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",ZS.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",ZS.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",ZS.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",ZS.AREAS=["NORTH_AMERICA","OVERSEA"]);const Sfe=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],B8=[],U8=[];var Rfe=c7,_k=GP,oce=U2,QO=function(s,p,A){var y=Rfe(p);y in s?_k.f(s,y,oce(0,A)):s[y]=A},sce=d8,Ofe=wM,ace=QO,Dfe=n1.Array,Nfe=Math.max,cre=function(s,p,A){for(var y=Ofe(s),w=sce(p,y),$=sce(void 0===A?y:A,y),j=Dfe(Nfe($-w,0)),_e=0;w<$;w++,_e++)ace(j,_e,s[w]);return j.length=_e,j},ure=cre,C_e=Math.floor,cce=function(s,p){var A=s.length,y=C_e(A/2);return A<8?dK(s,p):kfe(s,cce(ure(s,0,y),p),cce(ure(s,y),p),p)},dK=function(s,p){for(var A,y,w=s.length,$=1;$<w;){for(y=$,A=s[$];y&&p(s[y-1],A)>0;)s[y]=s[--y];y!==$++&&(s[y]=A)}return s},kfe=function(s,p,A,y){for(var w=p.length,$=A.length,j=0,_e=0;j<w||_e<$;)s[j+_e]=j<w&&_e<$?y(p[j],A[_e])<=0?p[j++]:A[_e++]:j<w?p[j++]:A[_e++];return s},lre=cce,uce=IL.match(/firefox\/(\d+)/i),w_e=!!uce&&+uce[1],Pfe=/MSIE|Trident/.test(IL),hZ=IL.match(/AppleWebKit\/(\d+)\./),dce=xS,dre=rT,T_e=WN,S_e=bM,hce=wM,fce=OL,pce=OT,R_e=lre,o2=e4,hK=w_e,O_e=Pfe,fK=r1,xfe=!!hZ&&+hZ[1],F8=[],fZ=dre(F8.sort),hre=dre(F8.push),gce=pce(function(){F8.sort(void 0)}),mce=pce(function(){F8.sort(null)}),Ace=o2("sort"),fre=!pce(function(){if(fK)return fK<70;if(!(hK&&hK>3)){if(O_e)return!0;if(xfe)return xfe<603;var s,p,A,y,w="";for(s=65;s<76;s++){switch(p=String.fromCharCode(s),s){case 66:case 69:case 70:case 72:A=3;break;case 68:case 71:A=4;break;default:A=2}for(y=0;y<47;y++)F8.push({k:p+y,v:A})}for(F8.sort(function($,j){return j.v-$.v}),y=0;y<F8.length;y++)p=F8[y].k.charAt(0),w.charAt(w.length-1)!==p&&(w+=p);return"DGBEFHACIJK"!==w}});dce({target:"Array",proto:!0,forced:gce||!mce||!Ace||!fre},{sort:function(s){void 0!==s&&T_e(s);var p=S_e(this);if(fre)return void 0===s?fZ(p):fZ(p,s);var A,y,w=[],$=hce(p);for(y=0;y<$;y++)y in p&&hre(w,p[y]);for(R_e(w,function(j){return function(_e,K){return void 0===K?-1:void 0===_e?1:void 0!==j?+j(_e,K)||0:fce(_e)>fce(K)?1:-1}}(s)),A=w.length,y=0;y<A;)p[y]=w[y++];for(;y<$;)delete p[y++];return p}});var Lfe=t4("Array").sort,Mfe=M2,D_e=Lfe,pre=Array.prototype,gre=function(s){var p=s.sort;return s===pre||Mfe(pre,s)&&p===pre.sort?D_e:p};function pK(s,p){if("boolean"!=typeof s)throw new U_(N_.INVALID_PARAMS,"Invalid ".concat(p,": The value is of the boolean type."))}function RR(s,p,A){if(!A.includes(s))throw new U_(N_.INVALID_PARAMS,"".concat(p," can only be set as ").concat(JSON.stringify(A)))}function iT(s,p){let A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,y=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;if(s<A||s>y||(!(arguments.length>4&&void 0!==arguments[4])||arguments[4])&&!_ce(s))throw new U_(N_.INVALID_PARAMS,"invalid ".concat(p,": the value range is [").concat(A,", ").concat(y,"]. integer only"))}function rO(s,p){let A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,y=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255,w=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(null==s)throw new U_(N_.INVALID_PARAMS,"".concat(p||"param"," cannot be empty"));if(!gZ(s,A,y,w))throw new U_(N_.INVALID_PARAMS,"Invalid ".concat(p||"string param",": Length of the string: [").concat(A,",").concat(y,"].").concat(w?" ASCII characters only.":""))}function TQ(s,p){if(!Array.isArray(s))throw new U_(N_.INVALID_PARAMS,"".concat(p," should be an array"))}function pZ(s){if("string"!=typeof s||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(s))throw h_.error("Invalid Channel Name ".concat(s)),new U_(N_.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function iO(s){if(!("number"==typeof(p=s)&&Math.floor(p)===p&&0<=p&&p<=4294967295||gZ(s,1,255)))throw h_.error("Invalid UID ".concat(s," ").concat(typeof s)),new U_(N_.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var p;"string"==typeof s&&h_.warning("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}function l1(s){return null==s}function gZ(s){return"string"==typeof s&&s.length<=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:255)&&s.length>=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)&&(!(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])||N_e(s))}function _ce(s){return"number"==typeof s&&s%1==0}function N_e(s){if("string"!=typeof s)return!1;for(let p=0;p<s.length;p+=1){const A=s.charCodeAt(p);if(A<0||A>255)return!1}return!0}let Bfe,J1,yO;(function(s){s.FREE="free",s.UPLOADING="uploading"})(Bfe||(Bfe={})),function(s){s[s.MISC=0]="MISC",s[s.INTERNAL_EVENT=1]="INTERNAL_EVENT",s[s.PUBLIC_EVENT=2]="PUBLIC_EVENT",s[s.WEB_EVENT=3]="WEB_EVENT",s[s.INTERNAL_API=4]="INTERNAL_API",s[s.WEB_API=5]="WEB_API",s[s.PUBLIC_API=6]="PUBLIC_API"}(J1||(J1={})),function(s){s.NONE="none",s.INIT="init",s.CANPLAY="canplay",s.PLAYING="playing",s.PAUSED="paused",s.SUSPEND="suspend",s.STALLED="stalled",s.WAITING="waiting",s.ERROR="error",s.DESTROYED="destroyed",s.ABORT="abort",s.ENDED="ended",s.EMPTIED="emptied",s.LOADEDDATA="loadeddata"}(yO||(yO={}));const vce={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};function yce(s){return rO(s.reportId,"params.reportId",0,100,!1),rO(s.category,"params.category",0,100,!1),rO(s.event,"params.event",0,100,!1),rO(s.label,"params.label",0,100,!1),iT(s.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}const Ece={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let oO,gT,Ice,bI,lI,C6,XU,SQ,mZ,HO,OR,OI,mre,gS,d1,_N,WT,i1,h1,hR,V1,AZ,s2;function gK(s){return iT(s.timeout,"config.timeout",0,1e5),iT(s.timeoutFactor,"config.timeoutFactor",0,100,!1),iT(s.maxRetryCount,"config.maxRetryConfig",0,1/0),iT(s.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}function Ufe(s){return RR(s.codec,"config.codec",["vp8","vp9","av1","h264"]),RR(s.mode,"config.mode",["rtc","live"]),void 0!==s.audioCodec&&RR(s.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),void 0!==s.proxyServer&&rO(s.proxyServer,"config.proxyServer",1,1e4),void 0!==s.turnServer&&bce(s.turnServer),void 0!==s.httpRetryConfig&&gK(s.httpRetryConfig),void 0!==s.websocketRetryConfig&&gK(s.websocketRetryConfig),!0}function vN(s){if(!Array.isArray(s)||s.length<1)return!1;try{s.forEach(p=>{if(!p.urls)throw Error()})}catch(p){return!1}return!0}function bce(s){return rO(s.turnServerURL,"turnServerURL"),rO(s.username,"username"),rO(s.password,"password"),s.udpport&&iT(s.udpport,"udpport",1,99999,!0),s.forceturn&&pK(s.forceturn,"forceturn"),s.security&&pK(s.security,"security"),s.tcpport&&iT(s.tcpport,"tcpport",1,99999,!0),!0}function mK(s){return void 0!==s.level&&RR(s.level,"level",[1,2,3]),!0}(function(s){s.PUBLISH="publish",s.SUBSCRIBE="subscribe",s.WS_COMPRESSOR_INIT="ws_compressor_init",s.SESSION_INIT="session_init",s.JOIN_CHOOSE_SERVER="join_choose_server",s.REQ_USER_ACCOUNT="req_user_account",s.JOIN_GATEWAY="join_gateway",s.REJOIN_GATEWAY="rejoin_gateway",s.STREAM_SWITCH="stream_switch",s.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",s.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",s.FIRST_VIDEO_RECEIVED="first_video_received",s.FIRST_AUDIO_RECEIVED="first_audio_received",s.FIRST_VIDEO_DECODE="first_video_decode",s.FIRST_AUDIO_DECODE="first_audio_decode",s.ON_ADD_AUDIO_STREAM="on_add_audio_stream",s.ON_ADD_VIDEO_STREAM="on_add_video_stream",s.ON_UPDATE_STREAM="on_update_stream",s.ON_REMOVE_STREAM="on_remove_stream",s.USER_ANALYTICS="req_user_analytics"})(oO||(oO={})),function(s){s.SESSION="io.agora.pb.Wrtc.Session",s.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",s.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",s.JOIN_GATEWAT="io.agora.pb.Wrtc.JoinGateway",s.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",s.PUBLISH="io.agora.pb.Wrtc.Publish",s.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",s.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",s.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",s.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",s.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",s.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",s.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",s.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",s.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",s.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",s.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",s.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",s.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",s.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",s.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",s.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",s.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",s.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",s.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",s.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",s.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",s.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",s.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",s.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed"}(gT||(gT={})),function(s){s[s.WORKER_EVENT=156]="WORKER_EVENT",s[s.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}(Ice||(Ice={})),function(s){s.CREATE_CLIENT="createClient",s.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",s.SET_AREA="setArea",s.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",s.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",s.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",s.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",s.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",s.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",s.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",s.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",s.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",s.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",s.START_PROXY_SERVER="Client.startProxyServer",s.STOP_PROXY_SERVER="Client.stopProxyServer",s.SET_PROXY_SERVER="Client.setProxyServer",s.SET_TURN_SERVER="Client.setTurnServer",s.SET_CLIENT_ROLE="Client.setClientRole",s.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",s.ENABLE_DUAL_STREAM="Client.enableDualStream",s.DISABLE_DUAL_STREAM="Client.disableDualStream",s.JOIN="Client.join",s.LEAVE="Client.leave",s.PUBLISH="Client.publish",s.UNPUBLISH="Client.unpublish",s.SUBSCRIBE="Client.subscribe",s.MASS_SUBSCRIBE="Client.massSubscribe",s.MASS_UNSUBSCRIBE="Client.massUnsubscribe",s.UNSUBSCRIBE="Client.unsubscribe",s.RENEW_TOKEN="Client.renewToken",s.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",s.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",s.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",s.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",s.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",s.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",s.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",s.START_LIVE_STREAMING="Client.startLiveStreaming",s.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",s.STOP_LIVE_STREAMING="Client.stopLiveStreaming",s.ADD_INJECT_STREAM_URL="Client.addInjectStreamUrl",s.REMOVE_INJECT_STREAM_URL="Client.removeInjectStreamUrl",s.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",s.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",s.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",s.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",s.SET_CONFIG_DISTRIBUTE="_configDistribute",s.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",s.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",s.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",s.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",s.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",s.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",s.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",s.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",s.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",s.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",s.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",s.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",s.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",s.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",s.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",s.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",s.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",s.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",s.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",s.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",s.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",s.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",s.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",s.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",s.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",s.STREAM_TYPE_CHANGE="streamTypeChange",s.CONNECTION_STATE_CHANGE="connectionStateChange",s.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage"}(bI||(bI={})),function(s){s.TRACER="tracer"}(lI||(lI={})),function(s){s.IDLE="IDLE",s.INITING="INITING",s.INITEND="INITEND"}(C6||(C6={})),function(s){s.STATE_CHANGE="state_change",s.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",s.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",s.CAMERA_DEVICE_CHANGED="cameraDeviceChanged"}(XU||(XU={})),function(s){s[s.ACCESS_POINT=101]="ACCESS_POINT",s[s.UNILBS=201]="UNILBS",s[s.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR"}(SQ||(SQ={})),function(s){s[s.IIIEGAL_APPID=1]="IIIEGAL_APPID",s[s.IIIEGAL_UID=2]="IIIEGAL_UID",s[s.INTERNAL_ERROR=3]="INTERNAL_ERROR"}(mZ||(mZ={})),function(s){s[s.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",s[s.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",s[s.INTERNAL_ERROR=8]="INTERNAL_ERROR",s[s.NO_AUTHORIZED=9]="NO_AUTHORIZED",s[s.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",s[s.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",s[s.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",s[s.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",s[s.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",s[s.USER_OVERLOAD=16]="USER_OVERLOAD",s[s.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",s[s.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND"}(HO||(HO={})),function(s){s[s.NO_FLAG_SET=100]="NO_FLAG_SET",s[s.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",s[s.INVALID_FALG_SET=102]="INVALID_FALG_SET",s[s.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",s[s.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",s[s.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",s[s.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",s[s.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",s[s.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",s[s.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",s[s.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",s[s.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",s[s.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",s[s.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",s[s.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",s[s.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",s[s.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",s[s.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",s[s.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV"}(OR||(OR={})),function(s){s[s.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",s[s.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",s[s.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",s[s.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",s[s.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",s[s.K_TICKET_INVALID=7]="K_TICKET_INVALID",s[s.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",s[s.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",s[s.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",s[s.K_UID_BANNED=14]="K_UID_BANNED",s[s.K_IP_BANNED=15]="K_IP_BANNED",s[s.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",s[s.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",s[s.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",s[s.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",s[s.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",s[s.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",s[s.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",s[s.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",s[s.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",s[s.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",s[s.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",s[s.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",s[s.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",s[s.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",s[s.ERR_INVALID_UID=117]="ERR_INVALID_UID",s[s.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",s[s.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",s[s.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",s[s.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",s[s.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",s[s.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",s[s.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",s[s.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",s[s.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",s[s.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",s[s.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",s[s.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",s[s.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",s[s.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",s[s.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",s[s.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",s[s.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",s[s.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",s[s.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",s[s.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",s[s.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",s[s.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",s[s.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",s[s.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",s[s.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",s[s.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",s[s.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",s[s.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",s[s.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",s[s.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",s[s.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY"}(OI||(OI={})),function(s){s[s.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",s[s.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",s[s.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY"}(mre||(mre={})),function(s){s.LEAVE="LEAVE",s.NETWORK_ERROR="NETWORK_ERROR",s.SERVER_ERROR="SERVER_ERROR",s.UID_BANNED="UID_BANNED",s.IP_BANNED="IP_BANNED",s.CHANNEL_BANNED="CHANNEL_BANNED",s.FALLBACK="FALLBACK"}(gS||(gS={})),function(s){s.CONNECTION_STATE_CHANGE="connection-state-change",s.MEDIA_RECONNECT_START="media-reconnect-start",s.MEDIA_RECONNECT_END="media-reconnect-end",s.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",s.USER_JOINED="user-joined",s.USER_LEAVED="user-left",s.USER_PUBLISHED="user-published",s.USER_UNPUBLISHED="user-unpublished",s.USER_INFO_UPDATED="user-info-updated",s.CLIENT_BANNED="client-banned",s.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",s.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",s.VOLUME_INDICATOR="volume-indicator",s.CRYPT_ERROR="crypt-error",s.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",s.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",s.NETWORK_QUALITY="network-quality",s.STREAM_TYPE_CHANGED="stream-type-changed",s.STREAM_FALLBACK="stream-fallback",s.RECEIVE_METADATA="receive-metadata",s.STREAM_MESSAGE="stream-message",s.LIVE_STREAMING_ERROR="live-streaming-error",s.LIVE_STREAMING_WARNING="live-streaming-warning",s.INJECT_STREAM_STATUS="stream-inject-status",s.EXCEPTION="exception",s.ERROR="error",s.P2P_LOST="p2p_lost",s.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",s.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",s.PUBLISHED_USER_LIST="published-user-list"}(d1||(d1={})),function(s){s.NETWORK_ERROR="NETWORK_ERROR",s.SERVER_ERROR="SERVER_ERROR",s.MULTI_IP="MULTI_IP",s.TIMEOUT="TIMEOUT",s.OFFLINE="OFFLINE",s.LEAVE="LEAVE",s.P2P_FAILED="P2P_FAILED",s.FALLBACK="FALLBACK"}(_N||(_N={})),function(s){s.CONNECTING="connecting",s.CONNECTED="connected",s.RECONNECTING="reconnecting",s.CLOSED="closed"}(WT||(WT={})),function(s){s.WS_CONNECTED="ws_connected",s.WS_RECONNECTING="ws_reconnecting",s.WS_CLOSED="ws_closed",s.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",s.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",s.ON_BINARY_DATA="on_binary_data",s.REQUEST_RECOVER="request_recover",s.REQUEST_JOIN_INFO="request_join_info",s.REQUEST_REJOIN_INFO="req_rejoin_info",s.IS_P2P_DISCONNECTED="is_p2p_dis",s.DISCONNECT_P2P="dis_p2p",s.ABORT_P2P_EXECUTION="abort_p2p_execution",s.NEED_RENEW_SESSION="need-sid",s.REPORT_JOIN_GATEWAY="report_join_gateway",s.REQUEST_TIMEOUT="request_timeout",s.REQUEST_SUCCESS="request_success",s.JOIN_RESPONSE="join_response"}(i1||(i1={})),function(s){s.PING="ping",s.PING_BACK="ping_back",s.JOIN="join_v3",s.REJOIN="rejoin_v3",s.LEAVE="leave",s.SET_CLIENT_ROLE="set_client_role",s.PUBLISH="publish",s.UNPUBLISH="unpublish",s.SUBSCRIBE="subscribe",s.SUBSCRIBE_STREAMS="subscribe_streams",s.UNSUBSCRIBE="unsubscribe",s.UNSUBSCRIBE_STREAMS="unsubscribe_streams",s.SUBSCRIBE_CHANGE="subscribe_change",s.TRAFFIC_STATS="traffic_stats",s.RENEW_TOKEN="renew_token",s.SWITCH_VIDEO_STREAM="switch_video_stream",s.DEFAULT_VIDEO_STREAM="default_video_stream",s.SET_FALLBACK_OPTION="set_fallback_option",s.GATEWAY_INFO="gateway_info",s.CONTROL="control",s.SEND_METADATA="send_metadata",s.DATA_STREAM="data_stream",s.PICK_SVC_LAYER="pick_svc_layer",s.RESTART_ICE="restart_ice",s.CONNECT_PC="connect_pc",s.SET_VIDEO_PROFILE="set_video_profile"}(h1||(h1={})),function(s){s.PUBLISH_STATS="publish_stats",s.PUBLISH_RELATED_STATS="publish_related_stats",s.SUBSCRIBE_STATS="subscribe_stats",s.SUBSCRIBE_RELATED_STATS="subscribe_related_stats",s.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",s.DENOISER_STATS="denoiser_stats",s.TRANSPORT_STATS="transport_stats"}(hR||(hR={})),function(s){s.ON_USER_ONLINE="on_user_online",s.ON_USER_OFFLINE="on_user_offline",s.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",s.ON_PUBLISH_STREAM="on_publish_stream",s.ON_UPLINK_STATS="on_uplink_stats",s.ON_P2P_LOST="on_p2p_lost",s.ON_REMOVE_STREAM="on_remove_stream",s.ON_ADD_AUDIO_STREAM="on_add_audio_stream",s.ON_ADD_VIDEO_STREAM="on_add_video_stream",s.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",s.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",s.ON_USER_BANNED="on_user_banned",s.ON_NOTIFICATION="on_notification",s.ON_CRYPT_ERROR="on_crypt_error",s.MUTE_AUDIO="mute_audio",s.MUTE_VIDEO="mute_video",s.UNMUTE_AUDIO="unmute_audio",s.UNMUTE_VIDEO="unmute_video",s.ON_P2P_OK="on_p2p_ok",s.RECEIVE_METADATA="receive_metadata",s.ON_DATA_STREAM="on_data_stream",s.ENABLE_LOCAL_VIDEO="enable_local_video",s.DISABLE_LOCAL_VIDEO="disable_local_video",s.ENABLE_LOCAL_AUDIO="enable_local_audio",s.DISABLE_LOCAL_AUDIO="disable_local_audio",s.ON_PUBLISHED_USER_LIST="on_published_user_list"}(V1||(V1={})),function(s){s.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",s.NEED_ANSWER="NEED_ANSWER",s.NEED_RENEGOTIATE="NEED_RENEGOTIATE",s.P2P_LOST="P2P_LOST",s.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",s.NEED_UNPUB="NEED_UNPUB",s.NEED_UNSUB="NEED_UNSUB",s.NEED_UPLOAD="NEED_UPLOAD",s.NEED_CONTROL="NEED_CONTROL",s.START_RECONNECT="START_RECONNECT",s.END_RECONNECT="END_RECONNECT",s.NEED_SIGNAL_RTT="NEED_SIGNAL_RTT"}(AZ||(AZ={})),function(s){s.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",s.RECEIVE_TRACK_BUFFER="receive_track_buffer",s.ON_AUDIO_BUFFER="on_audio_buffer",s.UPDATE_SOURCE="update_source"}(s2||(s2={}));const AK={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,currentPacketLossRate:0},Are={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},_re={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},Ffe={uplinkNetworkQuality:0,downlinkNetworkQuality:0},Cce={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let p1,UT,B4;(function(s){s.CONNECTED="websocket:connected",s.RECONNECTING="websocket:reconnecting",s.WILL_RECONNECT="websocket:will_reconnect",s.CLOSED="websocket:closed",s.FAILED="websocket:failed",s.ON_MESSAGE="websocket:on_message",s.REQUEST_NEW_URLS="websocket:request_new_urls",s.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",s.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection"})(p1||(p1={})),function(s){s.TRANSCODE="mix_streaming",s.RAW="raw_streaming",s.INJECT="inject_streaming"}(UT||(UT={})),function(s){s[s.INJECT_STREAM_STATUS_START_SUCCESS=0]="INJECT_STREAM_STATUS_START_SUCCESS",s[s.INJECT_STREAM_STATUS_START_ALREADY_EXISTS=1]="INJECT_STREAM_STATUS_START_ALREADY_EXISTS",s[s.INJECT_STREAM_STATUS_START_UNAUTHORIZED=2]="INJECT_STREAM_STATUS_START_UNAUTHORIZED",s[s.INJECT_STREAM_STATUS_START_TIMEOUT=3]="INJECT_STREAM_STATUS_START_TIMEOUT",s[s.INJECT_STREAM_STATUS_START_FAILED=4]="INJECT_STREAM_STATUS_START_FAILED",s[s.INJECT_STREAM_STATUS_STOP_SUCCESS=5]="INJECT_STREAM_STATUS_STOP_SUCCESS",s[s.INJECT_STREAM_STATUS_STOP_NOT_FOUND=6]="INJECT_STREAM_STATUS_STOP_NOT_FOUND",s[s.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED=7]="INJECT_STREAM_STATUS_STOP_UNAUTHORIZED",s[s.INJECT_STREAM_STATUS_STOP_TIMEOUT=8]="INJECT_STREAM_STATUS_STOP_TIMEOUT",s[s.INJECT_STREAM_STATUS_STOP_FAILED=9]="INJECT_STREAM_STATUS_STOP_FAILED",s[s.INJECT_STREAM_STATUS_BROKEN=10]="INJECT_STREAM_STATUS_BROKEN"}(B4||(B4={}));const wce={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},_K={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function RQ(s,p){rO(s.url,"".concat(p,".url"),1,1e3,!1),l1(s.x)||iT(s.x,"".concat(p,".x"),0,1e4),l1(s.y)||iT(s.y,"".concat(p,".y"),0,1e4),l1(s.width)||iT(s.width,"".concat(p,".width"),0,1e4),l1(s.height)||iT(s.height,"".concat(p,".height"),0,1e4),l1(s.zOrder)||iT(s.zOrder,"".concat(p,".zOrder"),0,255),l1(s.alpha)||iT(s.alpha,"".concat(p,".alpha"),0,1,!1)}const jfe={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},k_e={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30};let JP,w6,mT,Tce,EO,PM,yN,xM,KT,FT,dT,mI,DR,Sce,_Z,FL,j8,u1;function Rce(s){if(!s.channelName)throw new U_(N_.INVALID_PARAMS,"invalid channelName in info");if(!s.uid||"number"!=typeof s.uid)throw new U_(N_.INVALID_PARAMS,"invalid uid in info, uid must be a number");return s.token&&rO(s.token,"info.token",1,2047),iO(s.uid),pZ(s.channelName),!0}function Vfe(s){return RR(s,"mediaSource",["screen","window","application"]),!0}(function(s){s.WARNING="@live_uap-warning",s.ERROR="@line_uap-error",s.PUBLISH_STREAM_STATUS="@live_uap-publish-status",s.INJECT_STREAM_STATUS="@live_uap-inject-status",s.WORKER_STATUS="@live_uap-worker-status",s.REQUEST_NEW_ADDRESS="@live_uap-request-address"})(JP||(JP={})),function(s){s.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(w6||(w6={})),function(s){s[s.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",s[s.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",s[s.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",s[s.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",s[s.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",s[s.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",s[s.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",s[s.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",s[s.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",s[s.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",s[s.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",s[s.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",s[s.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",s[s.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",s[s.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",s[s.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",s[s.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",s[s.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",s[s.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",s[s.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",s[s.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(mT||(mT={})),function(s){s.CONNECT_FAILED="connect failed",s.CONNECT_TIMEOUT="connect timeout",s.WS_DISCONNECTED="websocket disconnected",s.REQUEST_TIMEOUT="request timeout",s.REQUEST_FAILED="request failed",s.WAIT_STATUS_TIMEOUT="wait status timeout",s.WAIT_STATUS_ERROR="wait status error",s.BAD_STATE="bad state",s.WS_ABORT="ws abort",s.AP_REQUEST_TIMEOUT="AP request timeout",s.AP_JSON_PARSE_ERROR="AP json parse error",s.AP_REQUEST_ERROR="AP request error",s.AP_REQUEST_ABORT="AP request abort"}(Tce||(Tce={})),function(s){s[s.SetSdkProfile=0]="SetSdkProfile",s[s.SetSourceChannel=1]="SetSourceChannel",s[s.SetSourceUserId=2]="SetSourceUserId",s[s.SetDestChannel=3]="SetDestChannel",s[s.StartPacketTransfer=4]="StartPacketTransfer",s[s.StopPacketTransfer=5]="StopPacketTransfer",s[s.UpdateDestChannel=6]="UpdateDestChannel",s[s.Reconnect=7]="Reconnect",s[s.SetVideoProfile=8]="SetVideoProfile"}(EO||(EO={})),function(s){s.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",s.NETWORK_CONNECTED="NETWORK_CONNECTED",s.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",s.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",s.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",s.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",s.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",s.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",s.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",s.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(PM||(PM={})),function(s){s.RELAY_STATE_IDLE="RELAY_STATE_IDLE",s.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",s.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",s.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE"}(yN||(yN={})),function(s){s.RELAY_OK="RELAY_OK",s.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",s.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",s.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED"}(xM||(xM={})),function(s){s.High="high",s.Low="low",s.Audio="audio",s.Screen="screen",s.ScreenLow="screen_low"}(KT||(KT={})),function(s){s.DISCONNECT="disconnect",s.CONNECTION_STATE_CHANGE="connection-state-change",s.NETWORK_QUALITY="network-quality",s.STREAM_TYPE_CHANGE="stream-type-change",s.IS_P2P_DISCONNECTED="is-p2p-dis",s.DISCONNECT_P2P="dis-p2p",s.REQUEST_NEW_GATEWAY_LIST="req-gate-url",s.NEED_RENEW_SESSION="need-sid",s.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",s.JOIN_RESPONSE="join-response"}(FT||(FT={})),function(s){s[s.Nothing=0]="Nothing",s[s.Audio=1]="Audio",s[s.LwoVideo=2]="LwoVideo",s[s.Video=4]="Video",s[s.Data=8]="Data"}(dT||(dT={})),function(s){s.NEED_RENEGOTIATE="@need_renegotiate",s.NEED_REPLACE_TRACK="@need_replace_track",s.NEED_CLOSE="@need_close",s.NEED_ENABLE_TRACK="@need_enable_track",s.NEED_DISABLE_TRACK="@need_disable_track",s.NEED_SESSION_ID="@need_sid",s.SET_OPTIMIZATION_MODE="@set_optimization_mode",s.GET_STATS="@get_stats",s.GET_LOW_VIDEO_TRACK="@get_low_video_track",s.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",s.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",s.NEED_MUTE_TRACK="@need_mute_track",s.NEED_UNMUTE_TRACK="@need_unmute_track"}(mI||(mI={})),function(s){s.SCREEN_TRACK="screen_track",s.LOW_STREAM="low_stream"}(DR||(DR={})),function(s){s[s.HIGH_STREAM=0]="HIGH_STREAM",s[s.LOW_STREAM=1]="LOW_STREAM"}(Sce||(Sce={})),function(s){s[s.DISABLE=0]="DISABLE",s[s.LOW_STREAM=1]="LOW_STREAM",s[s.AUDIO_ONLY=2]="AUDIO_ONLY"}(_Z||(_Z={})),function(s){s.SOURCE_STATE_CHANGE="source-state-change",s.TRACK_ENDED="track-ended",s.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",s.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",s.CLOSED="closed"}(FL||(FL={})),function(s){s.FIRST_FRAME_DECODED="first-frame-decoded",s.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status"}(j8||(j8={})),function(s){s.CHINA="CHINA",s.ASIA="ASIA",s.NORTH_AMERICA="NORTH_AMERICA",s.EUROPE="EUROPE",s.JAPAN="JAPAN",s.INDIA="INDIA",s.KOREA="KOREA",s.HKMC="HKMC",s.US="US",s.OCEANIA="OCEANIA",s.SOUTH_AMERICA="SOUTH_AMERICA",s.AFRICA="AFRICA",s.OVERSEA="OVERSEA",s.GLOBAL="GLOBAL"}(u1||(u1={}));const OQ=[u1.AFRICA,u1.ASIA,u1.CHINA,u1.EUROPE,u1.GLOBAL,u1.INDIA,u1.JAPAN,u1.NORTH_AMERICA,u1.OCEANIA,u1.OVERSEA,u1.SOUTH_AMERICA];let AT;!function(s){s.CHINA="CN",s.ASIA="AS",s.NORTH_AMERICA="NA",s.EUROPE="EU",s.JAPAN="JP",s.INDIA="IN",s.KOREA="KR",s.HKMC="HK",s.US="US",s.OCEANIA="OC",s.SOUTH_AMERICA="SA",s.AFRICA="AF",s.OVERSEA="OVERSEA",s.GLOBAL="GLOBAL"}(AT||(AT={}));const vK={CHINA:{},ASIA:{CODE:AT.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:AT.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:AT.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:AT.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","\tuap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:AT.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:AT.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:AT.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:AT.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:AT.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:AT.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:AT.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:AT.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:AT.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]}};let V8,vZ,o1,U0,EN,I1,eP,_F;A1&&(vK.CHINA={CODE:AT.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),function(s){s.UPDATE_BITRATE_LIMIT="update_bitrate_limit"}(V8||(V8={}));class yK extends sS{constructor(p,A){super(),a_(this,"onICEConnectionStateChange",void 0),a_(this,"onConnectionStateChange",void 0),a_(this,"onDTLSTransportStateChange",void 0),a_(this,"onDTLSTransportError",void 0),a_(this,"onICETransportStateChange",void 0),a_(this,"onFirstAudioReceived",void 0),a_(this,"onFirstVideoReceived",void 0),a_(this,"onFirstAudioDecoded",void 0),a_(this,"onFirstVideoDecoded",void 0),a_(this,"onSelectedLocalCandidateChanged",void 0),a_(this,"onSelectedRemoteCandidateChanged",void 0)}}(function(s){s.SEND="sendonly",s.RECV="recvonly",s.SENDRECV="sendrecv",s.INACTIVE="inactive"})(vZ||(vZ={})),function(s){s.VIDEO="video",s.AUDIO="audio"}(o1||(o1={})),function(s){s.LocalVideoTrack="videoTrack",s.LocalAudioTrack="audioTrack",s.LocalVideoLowTrack="videoLowTrack"}(U0||(U0={})),function(s){s.New="new",s.Connected="connected",s.Reconnecting="reconnecting",s.Disconnected="disconnected"}(EN||(EN={})),function(s){s.StateChange="stateChange",s.IceConnectionStateChange="iceConnectionStateChange",s.RequestMuteLocal="requestMuteLocal",s.RequestUnmuteLocal="requestUnmuteLocal",s.RequestRePublish="requestRePublish",s.RequestReSubscribe="requestReSubscribe",s.RequestUploadStats="requestUploadStats",s.MediaReconnectStart="MediaReconnectStart",s.MediaReconnectEnd="MediaReconnectEnd",s.NeedSignalRTT="NeedSignalRTT",s.RequestRestartICE="RequestRestartIce",s.PeerConnectionStateChange="PeerConnectionStateChange",s.RequestReconnect="RequestReconnect",s.RequestReconnectPC="RequestReconnectPC",s.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",s.P2PLost="P2PLost",s.UpdateVideoEncoder="UpdateVideoEncoder",s.ConnectionTypeChange="ConnectionTypeChange"}(I1||(I1={})),function(s){s.ONLINE="ONLINE",s.OFFLINE="OFFLINE"}(eP||(eP={})),function(s){s.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",s.ONLINE="ONLINE",s.OFFLINE="OFFLINE"}(_F||(_F={}));const P_e={join:["startJoin","startRequestAp","startJoinGateway","finishJoin"],publish:["startPublish"]};let tP,a2;(function(s){s.ON_TRACK="on_track",s.ON_NODE="on_node"})(tP||(tP={})),function(s){s.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",s.REQUEST_CONSTRAINTS="request_constraints"}(a2||(a2={}));const IN={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1};function bN(){return IN}var Gfe="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,yZ=UN,G8=E2,Qfe=_r.RangeError,Oce=function(s){if(void 0===s)return 0;var p=yZ(s),A=G8(p);if(p!==A)throw Qfe("Wrong length or index");return A},Hfe=_r.Array,EK=Math.abs,T6=Math.pow,x_e=Math.floor,qfe=Math.log,L_e=Math.LN2,Kfe=ON,vre=kO,Dce=SS,zfe=kN,Yfe=yT,Nce=V_,Jfe=kO,M_e=SS,B_e=function(s,p,A){var y=zfe(p);y in s?Yfe.f(s,y,Nce(0,A)):s[y]=A},yre=_r.Array,EZ=Math.max,IZ=function(s,p,A){for(var y=M_e(s),w=Jfe(p,y),$=Jfe(void 0===A?y:A,y),j=yre(EZ($-w,0)),_e=0;w<$;w++,_e++)B_e(j,_e,s[w]);return j.length=_e,j},Ere=G_,DQ=_l,bZ=Gfe,NR=TS,kce=LT,Pce=ga,Ire=jN,U_e=UN,F_e=E2,CZ=Oce,xce_pack=function(s,p,A){var y,w,$,j=Hfe(A),_e=8*A-p-1,K=(1<<_e)-1,_i=K>>1,_o=23===p?T6(2,-24)-T6(2,-77):0,_u=s<0||0===s&&1/s<0?1:0,ch=0;for((s=EK(s))!=s||s===1/0?(w=s!=s?1:0,y=K):(y=x_e(qfe(s)/L_e),s*($=T6(2,-y))<1&&(y--,$*=2),(s+=y+_i>=1?_o/$:_o*T6(2,1-_i))*$>=2&&(y++,$/=2),y+_i>=K?(w=0,y=K):y+_i>=1?(w=(s*$-1)*T6(2,p),y+=_i):(w=s*T6(2,_i-1)*T6(2,p),y=0));p>=8;)j[ch++]=255&w,w/=256,p-=8;for(y=y<<p|w,_e+=p;_e>0;)j[ch++]=255&y,y/=256,_e-=8;return j[--ch]|=128*_u,j},xce_unpack=function(s,p){var A,y=s.length,w=8*y-p-1,$=(1<<w)-1,j=$>>1,_e=w-7,K=y-1,_i=s[K--],_o=127&_i;for(_i>>=7;_e>0;)_o=256*_o+s[K--],_e-=8;for(A=_o&(1<<-_e)-1,_o>>=-_e,_e+=p;_e>0;)A=256*A+s[K--],_e-=8;if(0===_o)_o=1-j;else{if(_o===$)return A?NaN:_i?-1/0:1/0;A+=T6(2,p),_o-=j}return(_i?-1:1)*A*T6(2,_o-p)},Zfe=IT,wZ=RI,Xfe=_D.f,S6=yT.f,j_e=IZ,bre=uL,TZ=sL.PROPER,Lce=sL.CONFIGURABLE,Q8=PT.get,SZ=PT.set,Cre="ArrayBuffer",RZ="Wrong index",e3=_r.ArrayBuffer,LM=e3,U4=LM&&LM.prototype,F4=_r.DataView,H8=F4&&F4.prototype,wre=Object.prototype,Bce=_r.Array,OZ=_r.RangeError,Tre=Ere(function(s){for(var p=Kfe(this),A=Dce(p),y=arguments.length,w=vre(y>1?arguments[1]:void 0,A),$=y>2?arguments[2]:void 0,j=void 0===$?A:vre($,A);j>w;)p[w++]=s;return p}),tpe=Ere([].reverse),Uce=xce_pack,q8=xce_unpack,Fce=function(s){return[255&s]},jce=function(s){return[255&s,s>>8&255]},Vce=function(s){return[255&s,s>>8&255,s>>16&255,s>>24&255]},Gce=function(s){return s[3]<<24|s[2]<<16|s[1]<<8|s[0]},Sre=function(s){return Uce(s,23,4)},jL=function(s){return Uce(s,52,8)},DZ=function(s,p){S6(s.prototype,p,{get:function(){return Q8(this)[p]}})},R6=function(s,p,A,y){var w=CZ(A),$=Q8(s);if(w+p>$.byteLength)throw OZ(RZ);var j=Q8($.buffer).bytes,_e=w+$.byteOffset,K=j_e(j,_e,_e+p);return y?K:tpe(K)},VL=function(s,p,A,y,w,$){var j=CZ(A),_e=Q8(s);if(j+p>_e.byteLength)throw OZ(RZ);for(var K=Q8(_e.buffer).bytes,_i=j+_e.byteOffset,_o=y(+w),_u=0;_u<p;_u++)K[_i+_u]=_o[$?_u:p-_u-1]};if(bZ){var npe=TZ&&e3.name!==Cre;if(Pce(function(){e3(1)})&&Pce(function(){new e3(-1)})&&!Pce(function(){return new e3,new e3(1.5),new e3(NaN),npe&&!Lce}))npe&&Lce&&NR(e3,"name",Cre);else{(LM=function(s){return Ire(this,U4),new e3(CZ(s))}).prototype=U4;for(var Qce,Rre=Xfe(e3),rpe=0;Rre.length>rpe;)(Qce=Rre[rpe++])in LM||NR(LM,Qce,e3[Qce]);U4.constructor=LM}wZ&&Zfe(H8)!==wre&&wZ(H8,wre);var Ore=new F4(new LM(2)),Hce=Ere(H8.setInt8);Ore.setInt8(0,2147483648),Ore.setInt8(1,2147483649),!Ore.getInt8(0)&&Ore.getInt8(1)||kce(H8,{setInt8:function(s,p){Hce(this,s,p<<24>>24)},setUint8:function(s,p){Hce(this,s,p<<24>>24)}},{unsafe:!0})}else U4=(LM=function(s){Ire(this,U4);var p=CZ(s);SZ(this,{bytes:Tre(Bce(p),0),byteLength:p}),DQ||(this.byteLength=p)}).prototype,H8=(F4=function(s,p,A){Ire(this,H8),Ire(s,U4);var y=Q8(s).byteLength,w=U_e(p);if(w<0||w>y)throw OZ("Wrong offset");if(w+(A=void 0===A?y-w:F_e(A))>y)throw OZ("Wrong length");SZ(this,{buffer:s,byteLength:A,byteOffset:w}),DQ||(this.buffer=s,this.byteLength=A,this.byteOffset=w)}).prototype,DQ&&(DZ(LM,"byteLength"),DZ(F4,"buffer"),DZ(F4,"byteLength"),DZ(F4,"byteOffset")),kce(H8,{getInt8:function(s){return R6(this,1,s)[0]<<24>>24},getUint8:function(s){return R6(this,1,s)[0]},getInt16:function(s){var p=R6(this,2,s,arguments.length>1?arguments[1]:void 0);return(p[1]<<8|p[0])<<16>>16},getUint16:function(s){var p=R6(this,2,s,arguments.length>1?arguments[1]:void 0);return p[1]<<8|p[0]},getInt32:function(s){return Gce(R6(this,4,s,arguments.length>1?arguments[1]:void 0))},getUint32:function(s){return Gce(R6(this,4,s,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(s){return q8(R6(this,4,s,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(s){return q8(R6(this,8,s,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(s,p){VL(this,1,s,Fce,p)},setUint8:function(s,p){VL(this,1,s,Fce,p)},setInt16:function(s,p){VL(this,2,s,jce,p,arguments.length>2?arguments[2]:void 0)},setUint16:function(s,p){VL(this,2,s,jce,p,arguments.length>2?arguments[2]:void 0)},setInt32:function(s,p){VL(this,4,s,Vce,p,arguments.length>2?arguments[2]:void 0)},setUint32:function(s,p){VL(this,4,s,Vce,p,arguments.length>2?arguments[2]:void 0)},setFloat32:function(s,p){VL(this,4,s,Sre,p,arguments.length>2?arguments[2]:void 0)},setFloat64:function(s,p){VL(this,8,s,jL,p,arguments.length>2?arguments[2]:void 0)}});bre(LM,Cre),bre(F4,"DataView");var Dre={ArrayBuffer:LM,DataView:F4},Nre=hI,qce=G_,ipe=ga,qO=wS,NQ=kO,W8=E2,Wce=t1,Kce=Dre.ArrayBuffer,nI=Dre.DataView,kR=nI.prototype,bK=qce(Kce.prototype.slice),zce=qce(kR.getUint8),PI=qce(kR.setUint8);Nre({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:ipe(function(){return!new Kce(2).slice(1,void 0).byteLength})},{slice:function(s,p){if(bK&&void 0===p)return bK(qO(this),s);for(var A=qO(this).byteLength,y=NQ(s,A),w=NQ(void 0===p?A:p,A),$=new(Wce(this,Kce))(W8(w-y)),j=new nI(this),_e=new nI($),K=0;y<w;)PI(_e,K++,zce(j,y++));return $}});var QI,CK,pI,T0={exports:{}},W0=Gfe,sO=_l,c2=_r,ope=UI,Yce=sT,kQ=X1,Jce=aR,V_e=rR,kre=TS,$ce=eS.exports,mEe=yT.f,GL=NT,Zce=IT,PQ=RI,R1=E1,xQ=m2,NZ=c2.Int8Array,XS=NZ&&NZ.prototype,a1=c2.Uint8ClampedArray,Xce=a1&&a1.prototype,u2=NZ&&Zce(NZ),MM=XS&&Zce(XS),kZ=Object.prototype,eT=c2.TypeError,spe=R1("toStringTag"),PR=xQ("TYPED_ARRAY_TAG"),K8=xQ("TYPED_ARRAY_CONSTRUCTOR"),O6=W0&&!!PQ&&"Opera"!==Jce(c2.opera),aO=!1,D6={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},j4={BigInt64Array:8,BigUint64Array:8},eR=function(s){if(!Yce(s))return!1;var p=Jce(s);return kQ(D6,p)||kQ(j4,p)};for(QI in D6)(pI=(CK=c2[QI])&&CK.prototype)?kre(pI,K8,CK):O6=!1;for(QI in j4)(pI=(CK=c2[QI])&&CK.prototype)&&kre(pI,K8,CK);if((!O6||!ope(u2)||u2===Function.prototype)&&(u2=function(){throw eT("Incorrect invocation")},O6))for(QI in D6)c2[QI]&&PQ(c2[QI],u2);if((!O6||!MM||MM===kZ)&&(MM=u2.prototype,O6))for(QI in D6)c2[QI]&&PQ(c2[QI].prototype,MM);if(O6&&Zce(Xce)!==MM&&PQ(Xce,MM),sO&&!kQ(MM,spe))for(QI in aO=!0,mEe(MM,spe,{get:function(){return Yce(this)?this[PR]:void 0}}),D6)c2[QI]&&kre(c2[QI],PR,QI);var QL={NATIVE_ARRAY_BUFFER_VIEWS:O6,TYPED_ARRAY_CONSTRUCTOR:K8,TYPED_ARRAY_TAG:aO&&PR,aTypedArray:function(s){if(eR(s))return s;throw eT("Target is not a typed array")},aTypedArrayConstructor:function(s){if(ope(s)&&(!PQ||GL(u2,s)))return s;throw eT(V_e(s)+" is not a typed array constructor")},exportTypedArrayMethod:function(s,p,A,y){if(sO){if(A)for(var w in D6){var $=c2[w];if($&&kQ($.prototype,s))try{delete $.prototype[s]}catch(j){try{$.prototype[s]=p}catch(_e){}}}MM[s]&&!A||$ce(MM,s,A?p:O6&&XS[s]||p,y)}},exportTypedArrayStaticMethod:function(s,p,A){var y,w;if(sO){if(PQ){if(A)for(y in D6)if((w=c2[y])&&kQ(w,s))try{delete w[s]}catch($){}if(u2[s]&&!A)return;try{return $ce(u2,s,A?p:O6&&u2[s]||p)}catch($){}}for(y in D6)!(w=c2[y])||w[s]&&!A||$ce(w,s,p)}},isView:function(s){if(!Yce(s))return!1;var p=Jce(s);return"DataView"===p||kQ(D6,p)||kQ(j4,p)},isTypedArray:eR,TypedArray:u2,TypedArrayPrototype:MM},xre=ga,PZ=pL,N6=_r.ArrayBuffer,t3=_r.Int8Array,xZ=!QL.NATIVE_ARRAY_BUFFER_VIEWS||!xre(function(){t3(1)})||!xre(function(){new t3(-1)})||!PZ(function(s){new t3,new t3(null),new t3(1.5),new t3(s)},!0)||xre(function(){return 1!==new t3(new N6(2),1,void 0).length}),ape=sT,fI=Math.floor,z8=Number.isInteger||function(s){return!ape(s)&&isFinite(s)&&fI(s)===s},Lre=UN,LQ=_r.RangeError,LZ=_r.RangeError,k6=function(s,p){var A=function(s){var p=Lre(s);if(p<0)throw LQ("The argument can't be less than 0");return p}(s);if(A%p)throw LZ("Wrong offset");return A},cpe=VN,wK=r_,eue=vI,MQ=ON,tue=SS,MZ=o5,upe=RT,lpe=rS,Mre=QL.aTypedArrayConstructor,BZ=E_,dpe=_r,hpe=Array.isArray||function(s){return"Array"==BZ(s)},Q_e=K_,fpe=sT,ppe=E1("species"),CN=dpe.Array,mS=VN,Bre=O0,nue=ON,BQ=SS,Ure=function(s,p){return new(function(s){var p;return hpe(s)&&(Q_e(p=s.constructor)&&(p===CN||hpe(p.prototype))||fpe(p)&&null===(p=p[ppe]))&&(p=void 0),void 0===p?CN:p}(s))(0===p?0:p)},TK=G_([].push),P6=function(s){var p=1==s,A=2==s,y=3==s,w=4==s,$=6==s,j=7==s,_e=5==s||$;return function(K,_i,_o,_u){for(var ch,_f,o_=nue(K),i_=Bre(o_),u_=mS(_i,_o),g_=BQ(i_),__=0,w_=_u||Ure,k_=p?w_(K,g_):A||j?w_(K,0):void 0;g_>__;__++)if((_e||__ in i_)&&(_f=u_(ch=i_[__],__,o_),s))if(p)k_[__]=_f;else if(_f)switch(s){case 3:return!0;case 5:return ch;case 6:return __;case 2:TK(k_,ch)}else switch(s){case 4:return!1;case 7:TK(k_,ch)}return $?-1:y||w?w:k_}},H_e={forEach:P6(0),map:P6(1),filter:P6(2),some:P6(3),every:P6(4),find:P6(5),findIndex:P6(6),filterReject:P6(7)},BM=hI,rue=_r,fR=r_,wN=xZ,UQ=jN,q_e=V_,FQ=TS,jQ=z8,W_e=E2,SK=Oce,RK=k6,UZ=kN,OK=X1,mpe=aR,IO=sT,K_e=JI,z_e=L5,Y_e=NT,FZ=RI,J_e=_D.f,Ape=function(s){var p,A,y,w,$,j,_e=eue(this),K=MQ(s),_i=arguments.length,_o=_i>1?arguments[1]:void 0,_u=void 0!==_o,ch=upe(K);if(ch&&!lpe(ch))for(j=($=MZ(K,ch)).next,K=[];!(w=wK(j,$)).done;)K.push(w.value);for(_u&&_i>2&&(_o=cpe(_o,arguments[2])),A=tue(K),y=new(Mre(_e))(A),p=0;A>p;p++)y[p]=_u?_o(K[p],p):K[p];return y},$_e=H_e.forEach,Z_e=uS,x6=yT,X_e=s8,jre=PT.get,_pe=PT.set,n3=x6.f,vpe=_s.f,DK=Math.round,oue=rue.RangeError,Vre=Dre.ArrayBuffer,sue=Vre.prototype,aue=Dre.DataView,L6=QL.NATIVE_ARRAY_BUFFER_VIEWS,UM=QL.TYPED_ARRAY_CONSTRUCTOR,cue=QL.TYPED_ARRAY_TAG,NK=QL.TypedArray,kK=QL.TypedArrayPrototype,uue=QL.aTypedArrayConstructor,jZ=QL.isTypedArray,VZ="BYTES_PER_ELEMENT",Gre="Wrong length",ype=function(s,p){uue(s);for(var A=0,y=p.length,w=new s(y);y>A;)w[A]=p[A++];return w},GZ=function(s,p){n3(s,p,{get:function(){return jre(this)[p]}})},lue=function(s){var p;return Y_e(sue,s)||"ArrayBuffer"==(p=mpe(s))||"SharedArrayBuffer"==p},due=function(s,p){return jZ(s)&&!K_e(p)&&p in s&&jQ(+p)&&p>=0},QZ=function(s,p){return p=UZ(p),due(s,p)?q_e(2,s[p]):vpe(s,p)},Epe=function(s,p,A){return p=UZ(p),!(due(s,p)&&IO(A)&&OK(A,"value"))||OK(A,"get")||OK(A,"set")||A.configurable||OK(A,"writable")&&!A.writable||OK(A,"enumerable")&&!A.enumerable?n3(s,p,A):(s[p]=A.value,s)};_l?(L6||(_s.f=QZ,x6.f=Epe,GZ(kK,"buffer"),GZ(kK,"byteOffset"),GZ(kK,"byteLength"),GZ(kK,"length")),BM({target:"Object",stat:!0,forced:!L6},{getOwnPropertyDescriptor:QZ,defineProperty:Epe}),T0.exports=function(s,p,A){var y=s.match(/\d+$/)[0]/8,w=s+(A?"Clamped":"")+"Array",$="get"+s,j="set"+s,_e=rue[w],K=_e,_i=K&&K.prototype,_o={},_u=function(ch,_f){n3(ch,_f,{get:function(){return i_=_f,(u_=jre(this)).view[$](i_*y+u_.byteOffset,!0);var i_,u_},set:function(o_){return u_=_f,g_=o_,__=jre(this),A&&(g_=(g_=DK(g_))<0?0:g_>255?255:255&g_),void __.view[j](u_*y+__.byteOffset,g_,!0);var u_,g_,__},enumerable:!0})};L6?wN&&(K=p(function(ch,_f,o_,i_){return UQ(ch,_i),X_e(IO(_f)?lue(_f)?void 0!==i_?new _e(_f,RK(o_,y),i_):void 0!==o_?new _e(_f,RK(o_,y)):new _e(_f):jZ(_f)?ype(K,_f):fR(Ape,K,_f):new _e(SK(_f)),ch,K)}),FZ&&FZ(K,NK),$_e(J_e(_e),function(ch){ch in K||FQ(K,ch,_e[ch])}),K.prototype=_i):(K=p(function(ch,_f,o_,i_){UQ(ch,_i);var u_,g_,__,w_=0,k_=0;if(IO(_f)){if(!lue(_f))return jZ(_f)?ype(K,_f):fR(Ape,K,_f);u_=_f,k_=RK(o_,y);var Rv=_f.byteLength;if(void 0===i_){if(Rv%y||(g_=Rv-k_)<0)throw oue(Gre)}else if((g_=W_e(i_)*y)+k_>Rv)throw oue(Gre);__=g_/y}else __=SK(_f),u_=new Vre(g_=__*y);for(_pe(ch,{buffer:u_,byteOffset:k_,byteLength:g_,length:__,view:new aue(u_)});w_<__;)_u(ch,w_++)}),FZ&&FZ(K,NK),_i=K.prototype=z_e(kK)),_i.constructor!==K&&FQ(_i,"constructor",K),FQ(_i,UM,K),cue&&FQ(_i,cue,w),_o[w]=K,BM({global:!0,forced:K!=_e,sham:!L6},_o),VZ in K||FQ(K,VZ,y),VZ in _i||FQ(_i,VZ,y),Z_e(w)}):T0.exports=function(){},(0,T0.exports)("Uint8",function(s){return function(p,A,y){return s(this,p,A,y)}});var eve=SS,Ipe=UN,PK=QL.aTypedArray;(0,QL.exportTypedArrayMethod)("at",function(s){var p=PK(this),A=eve(p),y=Ipe(s),w=y>=0?y:A+y;return w<0||w>=A?void 0:p[w]});var hue=r_,M6=QL,bpe=SS,xK=k6,Cpe=ON,fue=ga,HZ=_r.RangeError,pue=_r.Int8Array,wpe=pue&&pue.prototype,xR=wpe&&wpe.set,Qre=M6.aTypedArray,Hre=M6.exportTypedArrayMethod,gue=!fue(function(){var s=new Uint8ClampedArray(2);return hue(xR,s,{length:1,0:3},1),3!==s[1]}),mue=gue&&M6.NATIVE_ARRAY_BUFFER_VIEWS&&fue(function(){var s=new pue(2);return s.set(1),s.set("2",1),0!==s[0]||2!==s[1]});Hre("set",function(s){Qre(this);var p=xK(arguments.length>1?arguments[1]:void 0,1),A=Cpe(s);if(gue)return hue(xR,this,A,p);var y=this.length,w=bpe(A),$=0;if(w+p>y)throw HZ("Wrong length");for(;$<w;)this[p+$]=A[$++]},!gue||mue);var Tpe=IZ,Spe=Math.floor,qre=function(s,p){var A=s.length,y=Spe(A/2);return A<8?qZ(s,p):GQ(s,qre(Tpe(s,0,y),p),qre(Tpe(s,y),p),p)},qZ=function(s,p){for(var A,y,w=s.length,$=1;$<w;){for(y=$,A=s[$];y&&p(s[y-1],A)>0;)s[y]=s[--y];y!==$++&&(s[y]=A)}return s},GQ=function(s,p,A,y){for(var w=p.length,$=A.length,j=0,_e=0;j<w||_e<$;)s[j+_e]=j<w&&_e<$?y(p[j],A[_e])<=0?p[j++]:A[_e++]:j<w?p[j++]:A[_e++];return s},Rpe=qre,Aue=YT.match(/firefox\/(\d+)/i),Ope=!!Aue&&+Aue[1],WZ=/MSIE|Trident/.test(YT),Wre=YT.match(/AppleWebKit\/(\d+)\./),Kre=ga,Dpe=$T,J8=Rpe,HL=Ope,nve=WZ,zre=TT,LK=!!Wre&&+Wre[1],rve=_r.Array,ive=QL.aTypedArray,CT=QL.exportTypedArrayMethod,KZ=_r.Uint16Array,B6=KZ&&G_(KZ.prototype.sort),zZ=!(!B6||Kre(function(){B6(new KZ(2),null)})&&Kre(function(){B6(new KZ(2),{})})),MK=!!B6&&!Kre(function(){if(zre)return zre<74;if(HL)return HL<67;if(nve)return!0;if(LK)return LK<602;var s,p,A=new KZ(516),y=rve(516);for(s=0;s<516;s++)p=s%4,A[s]=515-s,y[s]=s-2*p+3;for(B6(A,function(w,$){return(w/4|0)-($/4|0)}),s=0;s<516;s++)if(A[s]!==y[s])return!0});CT("sort",function(s){return void 0!==s&&Dpe(s),MK?B6(this,s):J8(ive(this),function(p){return function(A,y){return void 0!==p?+p(A,y)||0:y!=y?-1:A!=A?1:0===A&&0===y?1/A>0&&1/y<0?1:-1:A>y}}(s))},!MK||zZ);var Yre=uS,_ue=Dre.ArrayBuffer;let AS;hI({global:!0,forced:_r.ArrayBuffer!==_ue},{ArrayBuffer:_ue}),Yre("ArrayBuffer"),function(s){s[s.CHOOSE_SERVER=11]="CHOOSE_SERVER",s[s.CLOUD_PROXY=18]="CLOUD_PROXY",s[s.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",s[s.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK"}(AS||(AS={}));var ove=VV,BK=Array.isArray||function(s){return"Array"==ove(s)},Ppe=n1,xpe=BK,sve=RW,ave=F2,YZ=PS("species"),vue=Ppe.Array,bO=function(s,p){return new(function(s){var p;return xpe(s)&&(sve(p=s.constructor)&&(p===vue||xpe(p.prototype))||ave(p)&&null===(p=p[YZ]))&&(p=void 0),void 0===p?vue:p}(s))(0===p?0:p)},yue=CM,Lpe=K9,JZ=bM,G4=wM,Eue=bO,Iue=rT([].push),FM=function(s){var p=1==s,A=2==s,y=3==s,w=4==s,$=6==s,j=7==s,_e=5==s||$;return function(K,_i,_o,_u){for(var ch,_f,o_=JZ(K),i_=Lpe(o_),u_=yue(_i,_o),g_=G4(i_),__=0,w_=_u||Eue,k_=p?w_(K,g_):A||j?w_(K,0):void 0;g_>__;__++)if((_e||__ in i_)&&(_f=u_(ch=i_[__],__,o_),s))if(p)k_[__]=_f;else if(_f)switch(s){case 3:return!0;case 5:return ch;case 6:return __;case 2:Iue(k_,ch)}else switch(s){case 4:return!1;case 7:Iue(k_,ch)}return $?-1:y||w?w:k_}},bue={forEach:FM(0),map:FM(1),filter:FM(2),some:FM(3),every:FM(4),find:FM(5),findIndex:FM(6),filterReject:FM(7)},Mpe=bue.forEach,Cue=e4("forEach")?[].forEach:function(s){return Mpe(this,s,arguments.length>1?arguments[1]:void 0)};xS({target:"Array",proto:!0,forced:[].forEach!=Cue},{forEach:Cue});var uve=t4("Array").forEach,lve=LU,$Z=cN,wue=M2,dve=uve,Jre=Array.prototype,Bpe={DOMTokenList:!0,NodeList:!0},hve=bM,Tue=f8;xS({target:"Object",stat:!0,forced:OT(function(){Tue(1)})},{keys:function(s){return Tue(hve(s))}});var fve=IU.Object.keys,pve=x5,UK=xS,FK=BK,gve=rT([].reverse),Fpe=[1,2];UK({target:"Array",proto:!0,forced:String(Fpe)===String(Fpe.reverse())},{reverse:function(){return FK(this)&&(this.length=this.length),gve(this)}});var mve=t4("Array").reverse,jpe=M2,nP=mve,Sue=Array.prototype,Q4=OT,Gpe=r1,$re=PS("species"),Rue=function(s){return Gpe>=51||!Q4(function(){var p=[];return(p.constructor={})[$re]=function(){return{foo:1}},1!==p[s](Boolean).foo})},Ave=xS,_ve=n1,Qpe=BK,vve=RW,yve=F2,Hpe=d8,Eve=wM,Ive=EM,bve=QO,Cve=PS,wve=n$,Tve=Rue("slice"),Sve=Cve("species"),Oue=_ve.Array,Rve=Math.max;Ave({target:"Array",proto:!0,forced:!Tve},{slice:function(s,p){var A,y,w,$=Ive(this),j=Eve($),_e=Hpe(s,j),K=Hpe(void 0===p?j:p,j);if(Qpe($)&&((vve(A=$.constructor)&&(A===Oue||Qpe(A.prototype))||yve(A)&&null===(A=A[Sve]))&&(A=void 0),A===Oue||void 0===A))return wve($,_e,K);for(y=new(void 0===A?Oue:A)(Rve(K-_e,0)),w=0;_e<K;_e++,w++)_e in $&&bve(y,w,$[_e]);return y.length=w,y}});var qpe=t4("Array").slice,Ove=M2,Wpe=qpe,Due=Array.prototype;function gI(s,p,A,y,w){var $,j,_e,K={};return function(s){var p=s.forEach;return s===Jre||wue(Jre,s)&&p===Jre.forEach||$Z(Bpe,lve(s))?dve:p}($=fve(y)).call($,function(_i){K[_i]=y[_i]}),K.enumerable=!!K.enumerable,K.configurable=!!K.configurable,("value"in K||K.initializer)&&(K.writable=!0),K=pve(j=function(s){var p=s.reverse;return s===Sue||jpe(Sue,s)&&p===Sue.reverse?nP:p}(_e=function(s){var p=s.slice;return s===Due||Ove(Due,s)&&p===Due.slice?Wpe:p}(A).call(A)).call(_e)).call(j,function(_i,_o){return _o(s,p,_i)||_i},K),w&&void 0!==K.initializer&&(K.value=K.initializer?K.initializer.call(w):void 0,K.initializer=void 0),void 0===K.initializer&&(jae(s,p,K),K=null),K}var x0=t4("Array").values,Zre=LU,r3=cN,Dve=M2,ZZ=x0,U6=Array.prototype,Nve={DOMTokenList:!0,NodeList:!0},rP=function(s){var p=s.values;return s===U6||Dve(U6,s)&&p===U6.values||r3(Nve,Zre(s))?ZZ:p},zpe=t4("Array").keys,Nue=LU,Ype=cN,WO=M2,kue=zpe,XZ=Array.prototype,Pue={DOMTokenList:!0,NodeList:!0},$P=function(s){var p=s.keys;return s===XZ||WO(XZ,s)&&p===XZ.keys||Ype(Pue,Nue(s))?kue:p};function xue(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function Jpe(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?xue(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):xue(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}let eX=0,jK=0;function KO(s,p,A){return new iI((y,w)=>{p.timeout=p.timeout||v0("HTTP_CONNECT_TIMEOUT"),p.responseType=p.responseType||"json",p.data&&!A?(p.data=JSON.stringify(p.data),eX+=XQ(p.data)):A&&(p.data.size?eX+=p.data.size:p.data instanceof FormData?eX+=function($){let j=0;return/DingTalk/i.test(navigator.userAgent)&&$.realFormData&&($=$.realFormData),$.forEach(_e=>{j+="string"==typeof _e?XQ(_e):_e.size}),j+138}(p.data):eX+=XQ(JSON.stringify(p.data))),p.headers=p.headers||{},p.headers["Content-Type"]=p.headers["Content-Type"]||"application/json",p.method="POST",p.url=s,JU.request(p).then($=>{"string"==typeof $.data?jK+=XQ($.data):$.data instanceof ArrayBuffer||$.data instanceof Uint8Array?jK+=$.data.byteLength:jK+=XQ(JSON.stringify($.data)),y($.data)}).catch($=>{JU.isCancel($)?w(new U_(N_.OPERATION_ABORTED,"cancel token canceled")):w("ECONNABORTED"===$.code?new U_(N_.NETWORK_TIMEOUT,$.message):$.response?new U_(N_.NETWORK_RESPONSE_ERROR,$.response.status):new U_(N_.NETWORK_ERROR,$.message))})})}function QQ(s,p){return $8.apply(this,arguments)}function $8(){return $8=f(function*(s,p){const A=new Blob([p.data],{type:"buffer"});return yield KO(s,Jpe(Jpe({},p),{},{data:A,headers:{"Content-Type":"application/octet-stream"}}),!0)}),$8.apply(this,arguments)}const _S=new class extends sS{set networkState(s){h_.info("[".concat(this._moduleName,"]")+"network state changed, "+this._networkState+" -> "+s),this.emit(_F.NETWORK_STATE_CHANGE,s,this._networkState),s===eP.ONLINE?this.emit(_F.ONLINE):s===eP.OFFLINE&&(this.onlineWaiter=new iI(p=>{this.once(_F.ONLINE,()=>{this.onlineWaiter=void 0,p(eP.ONLINE)})}),this.emit(_F.OFFLINE)),this._networkState=s}get networkState(){return this._networkState}constructor(){super(),a_(this,"_moduleName","network-indicator"),a_(this,"_networkState",eP.ONLINE),a_(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=eP.ONLINE}),window.addEventListener("offline",()=>{this.networkState=eP.OFFLINE})}};let Xre=!1;const l2=new class extends sS{constructor(){super(...arguments),a_(this,"onAutoplayFailed",void 0),a_(this,"onAudioAutoplayFailed",void 0)}};function eie(){const s=Y1();if(!Xre){const p=A=>{A.preventDefault(),Xre=!1,"Android"!==s.os||"Chrome"!==s.name&&s.name!==C1.WECHAT?(document.body.removeEventListener("touchstart",p,!0),document.body.removeEventListener("mousedown",p,!0)):document.body.removeEventListener("click",p,!0)};Xre=!0,"Android"!==s.os||"Chrome"!==s.name&&s.name!==C1.WECHAT?(document.body.addEventListener("touchstart",p,!0),document.body.addEventListener("mousedown",p,!0)):document.body.addEventListener("click",p,!0),h_.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),l2.onAutoplayFailed?l2.onAutoplayFailed():h_.warning(l2.onAudioAutoplayFailed?"AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.\n\n  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .":"We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.\n\n  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.\n\n  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web ."),l2.emit("autoplay-failed")}}var Lue;function $pe(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function Pb(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?$pe(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):$pe(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}function HQ(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{report:w0};return function(p,A,y){const w=p[A];if("function"==typeof w){const $="AgoraRTCClient"===p.constructor.name?"Client":p.constructor.name;y.value=function(){for(var j=arguments.length,_e=new Array(j),K=0;K<j;K++)_e[K]=arguments[K];const _i=s.report.reportApiInvoke(this._sessionId||null,{name:"".concat($,".").concat(A),options:_e,tag:lI.TRACER,reportResult:s.reportResult});try{const _o=w.apply(this,_e);return _i.onSuccess(s.reportResult&&_o),_o}catch(_o){throw _i.onError(_o),_o}}}return y}}function VK(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{report:w0};return function(p,A,y){const w=p[A];if("function"==typeof w){const $="AgoraRTCClient"===p.constructor.name?"Client":p.constructor.name;y.value=f(function*(){for(var j=arguments.length,_e=new Array(j),K=0;K<j;K++)_e[K]=arguments[K];const _i=s.report.reportApiInvoke(this._sessionId||null,{name:"".concat($,".").concat(A),options:_e,tag:lI.TRACER});try{const _o=yield w.apply(this,_e);return _i.onSuccess(),_o}catch(_o){throw _i.onError(_o),_o}})}return y}}const w0=new(TR("AgoraRTCEventReport")(Lue=class{constructor(){var s=this;a_(this,"baseInfoMap",new Map),a_(this,"proxyServer",void 0),a_(this,"clientList",B8),a_(this,"eventUploadTimer",void 0),a_(this,"setSessionIdTimer",void 0),a_(this,"url",void 0),a_(this,"backupUrl",void 0),a_(this,"keyEventUploadPendingItems",[]),a_(this,"normalEventUploadPendingItems",[]),a_(this,"apiInvokeUploadPendingItems",[]),a_(this,"apiInvokeCount",0),a_(this,"ltsList",[]),a_(this,"lastSendNormalEventTime",Date.now()),a_(this,"customReportCounterTimer",void 0),a_(this,"customReportCount",0),a_(this,"extApiInvoke",function(){var p=f(function*(A){for(const y of A){const w=Pb(Pb({},y),{},{sid:null,invokeId:++s.apiInvokeCount,tag:lI.TRACER});s.sendApiInvoke(w)}});return function(A){return p.apply(this,arguments)}}()),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),v0("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),v0("EVENT_REPORT_SEND_INTERVAL"))}adjustSessionStartTime(s){if(!this.baseInfoMap.has(s)&&!this.baseInfoMap.get(s))return h_.error("adjust session ".concat(s," start time, sid is not exist or info is undefined")),void S0("error",this,"adjustSessionStartTime","adjust session ".concat(s," start time, sid is not exist or info is undefined"));const p=this.baseInfoMap.get(s),A=Date.now(),y=p.startTime;p.startTime=A,h_.debug("rewrite session ".concat(s," startTime: ").concat(A," , ").concat(A-y,"ms")),S0("debug",this,"adjustSessionStartTime",void 0,"rewrite session ".concat(s," startTime: ").concat(A," , ").concat(A-y,"ms")),this.baseInfoMap.set(s,p)}reportApiInvoke(s,p,A){p.timeout=p.timeout||6e4,p.reportResult=void 0===p.reportResult||p.reportResult;const y=Date.now();this.apiInvokeCount+=1;const w=this.apiInvokeCount,$=()=>({tag:p.tag,invokeId:w,sid:s,name:p.name,apiInvokeTime:y,options:p.options,states:p.states||null}),j=!!v0("SHOW_REPORT_INVOKER_LOG");j&&h_.info("".concat(p.name," start"),p.options);let _e=!1;pR(p.timeout).then(()=>{_e||(this.sendApiInvoke(Pb(Pb({},$()),{},{error:N_.API_INVOKE_TIMEOUT,success:!1})),h_.debug("".concat(p.name," timeout")))});const K=new U_(N_.UNEXPECTED_ERROR,"".concat(p.name,": this api invoke is end"));return{onSuccess:_i=>{const _o=()=>{if(_e)throw K;return _e=!0,this.sendApiInvoke(Pb(Pb({},$()),{},{success:!0},p.reportResult&&{result:_i})),j&&h_.info("".concat(p.name," onSuccess")),_i};return A?Zue(_o,p.name+"Success",A,()=>_e=!0):_o()},onError:_i=>{const _o=()=>{if(_e)throw _i;_e=!0,this.sendApiInvoke(Pb(Pb({},$()),{},{success:!1,error:_i.toString()})),j&&h_.info("".concat(p.name," onFailure"),_i.toString())};return A?Zue(_o,p.name+"Error",A,()=>_e=!0):_o()}}}sessionInit(s,p){if(this.baseInfoMap.has(s))return;const A=Date.now(),y=this.createBaseInfo(s,A);y.cname=p.cname;const w=Object.assign({},{willUploadConsoleLog:v0("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:A1?"global":"oversea",areas:v0("AREAS")&&v0("AREAS").join(",")},p.extend),$=Date.now(),j=Pb(Pb({},y),{},{eventType:oO.SESSION_INIT,appid:p.appid,browser:navigator.userAgent,build:TI,lts:$,elapse:$-A,extend:JSON.stringify(w),mode:p.mode,process:v0("PROCESS_ID"),success:!0,version:GO});this.send({type:gT.SESSION,data:j},!0)}joinChooseServer(s,p){const A=this.baseInfoMap.get(s);if(!A)return;const y=A.info,w=Date.now(),$=Pb(Pb({},y),{},{eventType:oO.JOIN_CHOOSE_SERVER,lts:w,eventElapse:w-p.lts,chooseServerAddr:p.csAddr,errorCode:p.ec,elapse:w-A.startTime,success:p.succ,chooseServerAddrList:JSON.stringify(p.serverList),uid:p.uid?parseInt(p.uid):null,cid:p.cid?parseInt(p.cid):null,chooseServerIp:p.csIp||"",opid:p.opid,unilbsServerIds:p.unilbsServerIds,extend:p.extend||void 0});this.send({type:gT.JOIN_CHOOSE_SERVER,data:$},!0)}reqUserAccount(s,p){const A=this.baseInfoMap.get(s);if(!A)return;const y=A.info,w=Date.now(),$=Pb(Pb({},y),{},{eventType:oO.REQ_USER_ACCOUNT,lts:w,success:p.success,serverAddress:p.serverAddr,stringUid:p.stringUid,uid:p.uid,errorCode:p.errorCode,elapse:w-A.startTime,eventElapse:w-p.lts,extend:JSON.stringify(p.extend)});this.send({type:gT.REQ_USER_ACCOUNT,data:$},!0)}joinGateway(s,p){const A=this.baseInfoMap.get(s);if(!A)return;const y=A.info;p.vid&&(y.vid=p.vid),y.uid=p.uid,y.cid=p.cid;const w=Date.now(),{firstSuccess:$,avoidJoinStartTime:j,isProxy:_e,addr:K}=p,_i=w-($&&j?j:A.startTime),_o=Pb(Pb({},y),{},{eventType:oO.JOIN_GATEWAY,lts:w,gatewayAddr:p.addr,success:p.succ,errorCode:p.ec,elapse:_i,eventElapse:w-p.lts,firstSuccess:$}),_u=_o.success?1:0;if(p.succ&&(A.lastJoinSuccessTime=w),$)this.send({type:gT.JOIN_GATEWAT,data:_o},!0);else{let ch;if(K)if(_e){const o_=K.match(/h=(\d{1,3}-){3}\d{1,3}/g),i_=K.match(/p=[0-9]{1,6}/g);ch={isSuccess:_u,gatewayIp:o_&&o_.length?o_[0].split("=")[1].replace(/-/g,"."):"",port:i_&&i_.length?i_[0].split("=")[1]:"",isProxy:_e?1:0}}else{const o_=K.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),i_=K.match(/:[0-9]{1,6}/g);ch={isSuccess:_u,gatewayIp:o_&&o_.length?o_[0].split("//")[1].replace(/-/g,"."):"",port:i_&&i_.length?i_[0].split(":")[1]:"",isProxy:_e?1:0}}else ch={isSuccess:_u,gatewayIp:"",port:"",isProxy:_e?1:0};delete _o.success,delete _o.eventType,delete _o.firstSuccess,_o.vid=Number(_o.vid);const _f=Object.assign({},_o,ch,{eventType:oO.REJOIN_GATEWAY});this.send({type:gT.RE_JOIN_GATEWAY,data:_f},!0)}}joinChannelTimeout(s,p){const A=this.baseInfoMap.get(s);if(!A)return;const y=Date.now(),w=Pb(Pb({},A.info),{},{lts:y,timeout:p,elapse:y-A.startTime});this.send({type:gT.JOIN_CHANNEL_TIMEOUT,data:w},!0)}publish(s,p){const A=this.baseInfoMap.get(s);if(!A)return;const y=A.info,w=Date.now(),$=Pb(Pb({},y),{},{eventType:oO.PUBLISH,lts:w,eventElapse:p.eventElapse,elapse:w-A.startTime,success:p.succ,errorCode:p.ec,videoName:p.videoName,audioName:p.audioName,screenName:p.screenName,screenshare:p.screenshare,audio:p.audio,video:p.video,p2pid:p.p2pid,publishRequestid:p.publishRequestid});this.send({type:gT.PUBLISH,data:$},!0)}subscribe(s,p,A){const y=this.baseInfoMap.get(s);if(!y)return;const w=y.info,$=Date.now(),j=Pb(Pb({},w),{},{eventType:oO.SUBSCRIBE,lts:$,eventElapse:p.eventElapse,elapse:$-y.startTime,success:p.succ,errorCode:p.ec,video:p.video,audio:p.audio,subscribeRequestid:p.subscribeRequestid,p2pid:p.p2pid},A&&{extend:JSON.stringify({isMassSubscribe:!0})});"string"==typeof p.peerid?j.peerSuid=p.peerid:j.peer=p.peerid,this.send({type:gT.SUBSCRIBE,data:j},!0)}wsCompressorInit(s){var p;const A=[...$P(p=this.baseInfoMap).call(p)],w=this.baseInfoMap.get(A.length?A[0]:"UnableToGetSid");if(!w)return;const $=w.info,j=Date.now(),_e=Pb(Pb({},$),{},{eventType:oO.WS_COMPRESSOR_INIT,lts:j,eventElapse:s.eventElapse,elapse:j-w.startTime,status:s.status?1:2});this.send({type:gT.WS_COMPRESSOR_INIT,data:_e},!0)}firstRemoteFrame(s,p,A,y){const w=this.baseInfoMap.get(s);if(!w)return;const $=w.info,j=Date.now(),_e=Pb(Pb(Pb({},$),y),{},{elapse:j-w.startTime,eventType:p,lts:j});this.send({type:A,data:_e},!0)}onGatewayStream(s,p,A,y){const w=this.baseInfoMap.get(s);if(!w)return;const $=w.info,j=Date.now(),_e=Pb(Pb(Pb({},$),y),{},{eventType:p,lts:j});this.send({type:A,data:_e},!0)}streamSwitch(s,p){const A=this.baseInfoMap.get(s);if(!A)return;const y=A.info,w=Date.now(),$=Pb(Pb({},y),{},{eventType:oO.STREAM_SWITCH,lts:w,isDual:p.isdual,elapse:w-A.startTime,success:p.succ});this.send({type:gT.STREAM_SWITCH,data:$},!0)}requestProxyAppCenter(s,p){const A=this.baseInfoMap.get(s);if(!A)return;const y=A.info,w=Date.now(),$=Pb(Pb({},y),{},{eventType:oO.REQUEST_PROXY_APPCENTER,lts:w,eventElapse:w-p.lts,elapse:w-A.startTime,APAddr:p.APAddr,workerManagerList:p.workerManagerList,response:p.response,errorCode:p.ec,success:p.succ});this.send({type:gT.REQUEST_PROXY_APPCENTER,data:$},!0)}requestProxyWorkerManager(s,p){const A=this.baseInfoMap.get(s);if(!A)return;const y=A.info,w=Date.now(),$=Pb(Pb({},y),{},{eventType:oO.REQUEST_PROXY_WORKER_MANAGER,lts:w,eventElapse:w-p.lts,elapse:w-A.startTime,workerManagerAddr:p.workerManagerAddr,response:p.response,errorCode:p.ec,success:p.succ});this.send({type:gT.REQUEST_PROXY_WORKER_MANAGER,data:$},!0)}setProxyServer(s){this.proxyServer=s,h_.debug(s?"reportProxyServerurl: ".concat(s):"disable reportProxyServerurl: ".concat(s)),S0("debug",this,"setProxyServer",s)}peerPublishStatus(s,p){const A=this.baseInfoMap.get(s);if(!A)return;const y=A.info,w=Date.now(),$=Pb(Pb({},y),{},{subscribeElapse:p.subscribeElapse,peer:p.peer,peerPublishDuration:Math.max(p.audioPublishDuration,p.videoPublishDuration),audiotag:p.audioPublishDuration>0?1:-1,videotag:p.videoPublishDuration>0?1:-1,lts:w,elapse:w-A.startTime,joinChannelSuccessElapse:w-(A.lastJoinSuccessTime||w)});this.send({type:gT.PEER_PUBLISH_STATUS,data:$},!0)}workerEvent(s,p){const A=this.baseInfoMap.get(s);if(!A)return;const y=A.info,w=Date.now();(function($,j,_e){const K=$[j];if(!K||"string"!=typeof K)return[$];$[j]="";const _i=XQ(JSON.stringify($));let _o=0;const _u=[];let ch=0;for(let _f=0;_f<K.length;_f++)ch+=K.charCodeAt(_f)<=127?1:3,ch<=1300-_i||(_u[_u.length]=ZQ(ZQ({},$),{},{[j]:K.substring(_o,_f)}),_o=_f,ch=K.charCodeAt(_f)<=127?1:3);return _o!==K.length-1&&(_u[_u.length]=ZQ(ZQ({},$),{},{[j]:K.substring(_o)})),_u})(Pb(Pb(Pb({},y),p),{},{elapse:w-A.startTime,lts:w,productType:"WebRTC"}),"payload").forEach($=>this.send({type:gT.WORKER_EVENT,data:$},!0))}apworkerEvent(s,p){const A=this.baseInfoMap.get(s);if(!A)return;const y=A.info,w=Date.now(),$=Pb(Pb(Pb({},y),p),{},{elapse:w-A.startTime,lts:w});this.send({type:gT.AP_WORKER_EVENT,data:$},!0)}joinWebProxyAP(s,p){const A=this.baseInfoMap.get(s);if(!A)return;const y=A.info,w=Date.now(),$=Pb(Pb(Pb({},y),p),{},{elapse:w-A.startTime,lts:w,extend:p.extend||void 0});this.send({type:gT.JOIN_WEB_PROXY_AP,data:$},!0)}WebSocketQuit(s,p){const A=this.baseInfoMap.get(s);if(!A)return;const y=A.info,w=Date.now(),$=Pb(Pb(Pb({},y),p),{},{elapse:w-A.startTime,lts:w});this.send({type:gT.WEBSOCKET_QUIT,data:$},!0)}sendCustomReportMessage(s,p){var A=this;return f(function*(){if(A.customReportCount+=p.length,A.customReportCount>v0("CUSTOM_REPORT_LIMIT"))throw new U_(N_.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);A.customReportCounterTimer||(A.customReportCounterTimer=window.setInterval(()=>{A.customReportCount=0},5e3));const y=p.map($=>({type:gT.USER_ANALYTICS,data:Pb({sid:s},$)})),w={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:y.map($=>JSON.stringify($))};try{yield A.postDataToStatsCollector(w)}catch($){throw h_.error("send custom report message failed",$.toString()),new U_(N_.CUSTOM_REPORT_SEND_FAILED,$.message)}})()}autoplayFailed(s,p,A,y){if(!s)return;const w=this.baseInfoMap.get(s);if(!w)return;const $=w.info,j=Date.now(),_e=Pb(Pb({},$),{},{vid:void 0===$.vid?0:Number($.vid),lts:j,elapse:j-w.startTime,cbRegistered:l2.onAutoplayFailed||l2.onAudioAutoplayFailed?1:-1,errorMsg:A,mediaType:p,trackId:y,extend:void 0});this.send({type:gT.AUTOPLAY_FAILED,data:_e},!0)}sendApiInvoke(s){const p=v0("NOT_REPORT_EVENT");if(s.tag&&p.includes&&p.includes(s.tag))return!1;if(null===s.sid)return this.apiInvokeUploadPendingItems.push(s),!1;const A=this.baseInfoMap.get(s.sid);if(!A)return this.apiInvokeUploadPendingItems.push(s),!1;const{cname:y,uid:w,cid:$}=A.info;s.lts=s.lts||Date.now();const j={invokeId:s.invokeId,sid:s.sid,cname:y,cid:$,uid:w,lts:s.lts,success:s.success,elapse:s.lts-A.startTime,execElapse:s.lts-s.apiInvokeTime,apiName:s.name,options:s.options?JSON.stringify(s.options):void 0,execStates:s.states?JSON.stringify(s.states):void 0,execResult:s.result?JSON.stringify(s.result):void 0,errorCode:s.error?JSON.stringify(s.error):void 0};return this.send({type:gT.API_INVOKE,data:j},!1),!0}appendSessionId(){this.clientList.forEach(s=>{if(s._sessionId){const p=this.apiInvokeUploadPendingItems.length;for(let A=0;A<p;A++){const y=this.apiInvokeUploadPendingItems.shift();y&&(y.sid=s._sessionId,this.sendApiInvoke(Object.assign({},y)))}}})}send(s,p){if(p)return this.keyEventUploadPendingItems.push(s),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(s),this.normalEventUploadPendingItems.length>v0("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(s,p){const A=[],y=[];for(;s.length;){const j=s.shift();A.length<20?A.push(j):y.push(j)}s.push(...y);for(const j of[...A]){var w;-1!==this.ltsList.indexOf(j.data.lts)?(j.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(j.data.lts)):(this.ltsList.push(j.data.lts),gre(w=this.ltsList).call(w,(_e,K)=>_e-K))}p||(this.lastSendNormalEventTime=Date.now());const $={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:A.map(j=>JSON.stringify(j)),vid:(j=>{const _e=j&&j.data.sid&&this.baseInfoMap.get(j.data.sid);return _e&&_e.info.vid&&+_e.info.vid||0})(A[0])};return A.length&&this.postDataToStatsCollector($).catch((j=>_e=>{v0("EVENT_REPORT_RETRY")&&(p?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(j):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(j),this.normalEventUploadPendingItems.length>v0("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-v0("NORMAL_EVENT_QUEUE_CAPACITY")),h_.warning("report: drop normal events"))))})(A)),s}postDataToStatsCollector(s){var p=arguments,A=this;return f(function*(){let y=p.length>1&&void 0!==p[1]&&p[1];_S.networkState===eP.OFFLINE&&(yield iI.race([_S.onlineWaiter,pR(2*pS.maxRetryTimeout)]));const w=y?"/events/proto-raws":"/events/messages";let $=A.url||(A.proxyServer?"https://".concat(A.proxyServer,"/rs/?h=").concat(v0("EVENT_REPORT_DOMAIN"),"&p=").concat(v0("STATS_COLLECTOR_PORT"),"&d=").concat(w):"https://".concat(v0("EVENT_REPORT_DOMAIN"),":").concat(v0("STATS_COLLECTOR_PORT")).concat(w));for(let j=0;j<2;j+=1){1===j&&($=A.backupUrl||(A.proxyServer?"https://".concat(A.proxyServer,"/rs/?h=").concat(v0("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(v0("STATS_COLLECTOR_PORT"),"&d=").concat(w):"https://".concat(v0("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(v0("STATS_COLLECTOR_PORT")).concat(w)));try{y?yield QQ($,{timeout:1e4,data:s}):yield KO($,{timeout:1e4,data:s})}catch(_e){if(1===j)throw _e;continue}return}})()}createBaseInfo(s,p){const A=Object.assign({},Ece);return A.sid=s,this.baseInfoMap.set(s,{info:A,startTime:p}),A}reportResourceTiming(s,p){const A=performance.getEntriesByName(s),y=A[A.length-1];y&&this.reportApiInvoke(p,{name:"Client.resourceTiming",options:y,tag:lI.TRACER}).onSuccess()}})||Lue);Xne.on("REPORT_LOG_UPLOAD",s=>{s.networkState=_S.networkState,w0.reportApiInvoke(null,{name:"logUploadError",options:s,tag:lI.TRACER})});class Z8 extends sS{constructor(p,A){super(),a_(this,"trackMediaType",void 0),a_(this,"_ID",void 0),a_(this,"_hints",[]),a_(this,"_isClosed",!1),a_(this,"_originMediaStreamTrack",void 0),a_(this,"_mediaStreamTrack",void 0),a_(this,"_external",{}),this._ID=A||VT(8,"track-"),this._originMediaStreamTrack=p,this._mediaStreamTrack=p,U8.includes(this)||U8.push(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(p){if(!p){w0.reportApiInvoke(null,{name:bI.GET_MEDIA_STREAM_TRACK,options:[],tag:lI.TRACER}).onSuccess(this._mediaStreamTrack&&"string"==typeof this._mediaStreamTrack.label?this._mediaStreamTrack.label:"")}return this._mediaStreamTrack}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,function(p){const A=U8.indexOf(p);-1!==A&&U8.splice(A,1)}(this),this.emit(FL.CLOSED)}}let US,tie,Zpe,kve=1;class iP{constructor(p){a_(this,"lockingPromise",iI.resolve()),a_(this,"locks",0),a_(this,"name",""),a_(this,"lockId",void 0),this.lockId=kve++,p&&(this.name=p),h_.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(p){let A;this.locks+=1,h_.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat("string"==typeof p?p:""));const y=new iI($=>{A=()=>{this.locks-=1,h_.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat("string"==typeof p?p:"")),$()}}),w=this.lockingPromise.then(()=>A);return this.lockingPromise=this.lockingPromise.then(()=>y),w}}function H4(s,p){return function(A,y,w){const $=A[y];if("function"!=typeof $)throw new Error("Cannot use mutex on object property.");return w.value=f(function*(){const j=this[p];if(!j)throw new Error("mutex property key ".concat(p," doesn't exist on ").concat(s));const _e=yield j.lock("From ".concat(s,".").concat(y));try{for(var K=arguments.length,_i=new Array(K),_o=0;_o<K;_o++)_i[_o]=arguments[_o];return yield $.apply(this,_i)}finally{_e()}}),w}}class F6 extends Z8{get muted(){return this._muted}get enabled(){return this._enabled}constructor(p,A){super(p,A),a_(this,"_enabled",!0),a_(this,"_muted",!1),a_(this,"_isClosed",!1),a_(this,"_trackProcessors",[]),a_(this,"_enabledMutex",void 0),a_(this,"processor",void 0),a_(this,"processorContext",void 0),a_(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new iP("".concat(A)),p.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){return this._originMediaStreamTrack.label}close(){this._isClosed||(this.stop(),this._trackProcessors.forEach(p=>p.destroy()),this._trackProcessors=[],this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,h_.debug("[".concat(this.getTrackId(),"] close")),S0("debug",this,"close"),this.emit(mI.NEED_CLOSE),super.close())}_registerTrackProcessor(p){var A=this;return f(function*(){if(-1!==A._trackProcessors.indexOf(p))return;const y=A._trackProcessors[A._trackProcessors.length-1];A._trackProcessors.push(p),p.onOutputChange=f(function*(){A._mediaStreamTrack=p.output||A._originMediaStreamTrack,A._updatePlayerSource(),yield wT(A,mI.NEED_REPLACE_TRACK,A)}),y?(y.onOutputChange=f(function*(){y.output&&(yield p.setInput(y.output))}),yield p.setInput(y.output||y.input||A._originMediaStreamTrack)):yield p.setInput(A._originMediaStreamTrack)})()}_getOutputFromProcessors(){if(0===this._trackProcessors.length)return this._originMediaStreamTrack;const p=this._trackProcessors[this._trackProcessors.length-1];return p.output||p.input||this._originMediaStreamTrack}_updateOriginMediaStreamTrack(p,A){var y=this;return f(function*(){if(p!==y._originMediaStreamTrack){if(y._originMediaStreamTrack.removeEventListener("ended",y._handleTrackEnded),A&&y._originMediaStreamTrack.stop(),p.addEventListener("ended",y._handleTrackEnded),y._originMediaStreamTrack=p,y._trackProcessors.length>0){yield y._trackProcessors[0].setInput(p);const w=y._getOutputFromProcessors();y._mediaStreamTrack=w}else y._mediaStreamTrack=y._originMediaStreamTrack;y._updatePlayerSource(),yield wT(y,mI.NEED_REPLACE_TRACK,y),y.processor&&y.processor.updateInput({track:y._originMediaStreamTrack,context:y.processorContext})}})()}_getDefaultPlayerConfig(){return{}}onTrackEnded(){h_.debug("[".concat(this.getTrackId(),"] track ended")),b6("debug",["MediaStreamTrack",this.getTrackId()],"ended"),this.emit(FL.TRACK_ENDED)}stateCheck(p,A){if(h_.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(p,": ").concat(A,"]")),S0("debug",this,"stateCheck",{stateName:p,state:A,muted:this._muted,enabled:this._enabled}),pK(A,p),this._enabled&&this._muted&&"enabled"===p&&!1===A)throw new U_(N_.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print();if(!this._enabled&&!this._muted&&"muted"===p&&!0===A)throw new U_(N_.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print()}getProcessorStats(){return this.processorContext.gatherStats()}}(function(s){s.IOS_15_INTERRUPTION_START="ios15-interruption-start",s.IOS_15_INTERRUPTION_END="ios15-interruption-end",s.IOS_INTERRUPTION_START="ios-interruption-start",s.IOS_INTERRUPTION_END="ios-interruption-end",s.STATE_CHANGE="state-change"})(US||(US={})),function(s){s.AUDIO_CONTEXT_CREATED="audio_context_created"}(tie||(tie={})),function(s){s.AIDenoiser="AIDenoiser"}(Zpe||(Zpe={}));const j6={audioContextInitOptions:{}},tX=new class extends sS{constructor(){super(),a_(this,"registeredPlugins",[])}setOptions(s,p){j6[s]&&(j6[s]=p)}getOptions(s){return j6[s]}installPlugin(s){s instanceof Object&&s.name&&this.registeredPlugins.push(s.name)}},Xpe=window.AudioContext||window.webkitAudioContext;let qL=null;const g1=new class extends sS{constructor(){var s;super(...arguments),s=this,a_(this,"prevState",void 0),a_(this,"curState",void 0),a_(this,"interruptDetectorTrack",void 0),a_(this,"onLocalAudioTrackMute",()=>{h_.info("ios15-interruption-start"),lT("info",["WebAudio"],"ios15-interruption-start"),this.emit(US.IOS_15_INTERRUPTION_START)}),a_(this,"onLocalAudioTrackUnmute",f(function*(){h_.info("ios15-interruption-end"),lT("info",["WebAudio"],"ios15-interruption-end"),"running"!==s.curState||s.duringInterruption?h_.info("ios15-interruption-end-canceled"):(qL&&(yield qL.suspend()),s.emit(US.IOS_15_INTERRUPTION_END))}))}get duringInterruption(){return"running"===this.prevState&&"interrupted"===this.curState}bindInterruptDetectorTrack(s){h_.debug("webaudio bindInterruptDetectorTrack ".concat(s.getTrackId())),S0("debug",["WebAudio"],"bindInterruptDetectorTrack",s.getTrackId()),this.interruptDetectorTrack||(this.interruptDetectorTrack=s,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(s){h_.debug("webaudio unbindInterruptDetectorTrack ".concat(s.getTrackId())),S0("debug",["WebAudio"],"unbindInterruptDetectorTrack",s.getTrackId()),this.interruptDetectorTrack&&this.interruptDetectorTrack===s&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function nX(){if(!qL){if(function nie(){if(!Xpe)return h_.error("your browser is not support web audio"),void sI("error",["WebAudio"],"your browser is not support web audio");h_.info("create audio context"),uK("info",["WebAudio"],"WebAudioContext");const s=tX.getOptions("audioContextInitOptions");h_.debug("audio content init option:",JSON.stringify(s)),qL=new Xpe(s),tX.emit(tie.AUDIO_CONTEXT_CREATED,qL),g1.curState=qL.state,qL.onstatechange=()=>{g1.prevState=g1.curState,g1.curState=qL?qL.state:void 0,(r2()||WU())&&"running"===g1.prevState&&"interrupted"===g1.curState&&(h_.info("ios-interruption-start"),lT("info",["AudioState"],"ios-interruption-start"),g1.emit(US.IOS_INTERRUPTION_START)),(r2()||WU())&&"interrupted"===g1.prevState&&"running"===g1.curState&&(h_.info("ios-interruption-end"),lT("info",["AudioState"],"ios-interruption-end"),g1.emit(US.IOS_INTERRUPTION_END)),g1.prevState!==g1.curState&&(h_.debug("AudioContext State Change","".concat(g1.prevState,"=>").concat(g1.curState)),b6("debug",["AudioContext",void 0],"statechange","".concat(g1.prevState,"=>").concat(g1.curState)),g1.emit(US.STATE_CHANGE))},function(){var p=f(function*(A){const y=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let w,$=!1,j=!1,_e=!1;function K(g_){"running"===A.state?_i(!1):r2()||WU()?"suspended"===A.state&&(_i(!0),g_&&A.resume().then(_u,_u)):"closed"!==A.state&&(_i(!0),g_&&A.resume().then(_u,_u))}function _i(g_){if($!==g_){$=g_;for(let __=0,w_=y;__<w_.length;__+=1){const k_=w_[__];g_?window.addEventListener(k_,ch,{capture:!0,passive:!0}):window.removeEventListener(k_,ch,{capture:!0,passive:!0})}}}function _u(){K(!1)}function ch(){K(!0)}function _f(g_){if(!_e)if(w.paused)if(g_){let __;o_(!1),_e=!0;try{__=w.play(),__?__.then(i_,i_):(w.addEventListener("playing",i_),w.addEventListener("abort",i_),w.addEventListener("error",i_))}catch(w_){i_()}}else o_(!0);else o_(!1)}function o_(g_){if(j!==g_){j=g_;for(let __=0,w_=y;__<w_.length;__++){const k_=w_[__];g_?window.addEventListener(k_,u_,{capture:!0,passive:!0}):window.removeEventListener(k_,u_,{capture:!0,passive:!0})}}}function i_(){w.removeEventListener("playing",i_),w.removeEventListener("abort",i_),w.removeEventListener("error",i_),_e=!1,_f(!1)}function u_(){_f(!0)}if(r2()){const g_=A.createMediaStreamDestination(),__=document.createElement("div");__.innerHTML="<audio x-webkit-airplay='deny'></audio>",w=__.children.item(0),w.controls=!1,w.disableRemotePlayback=!0,w.preload="auto",w.srcObject=g_.stream,_f(!0)}g1.on(US.STATE_CHANGE,function _o(){K(!0)}),K(!1)});return function(A){return p.apply(this,arguments)}}()(qL)}(),!qL)throw new U_(N_.NOT_SUPPORTED,"can not create audio context");return qL}return qL}function GK(s){if(function(){if(null!==qQ)return qQ;const y=nX(),w=y.createBufferSource(),$=y.createGain(),j=y.createGain();w.connect($),w.connect(j),w.disconnect($);let _e=!1;try{w.disconnect($)}catch(K){_e=!0}return w.disconnect(),qQ=_e,_e}())return;S0("debug",["WebAudio"],"polyfillAudioNode");const p=s.connect,A=s.disconnect;s.connect=(y,w,$)=>(s._inputNodes||(s._inputNodes=[]),s._inputNodes.includes(y)||(y instanceof AudioNode?(s._inputNodes.push(y),p.call(s,y,w,$)):p.call(s,y,w)),s),s.disconnect=(y,w,$)=>{A.call(s),y?nG(s._inputNodes,y):s._inputNodes=[];for(const j of s._inputNodes)p.call(s,j)}}let qQ=null;function QK(s,p){const A=1/p,y=nX();let w=y.createGain();w.gain.value=0,w.connect(y.destination);let $=!1;const j=()=>{if($)return void(w=null);const _e=y.createOscillator();_e.onended=j,_e.connect(w),_e.start(0),_e.stop(y.currentTime+A),s(y.currentTime)};return j(),()=>{$=!0}}const i3=h_.prefix("[inject-node]");class ege{constructor(){a_(this,"nodeLists",[]),a_(this,"prevNode",void 0),a_(this,"nextNode",void 0)}get firstNode(){return this.nodeLists[0]}get lastNode(){return this.nodeLists[this.nodeLists.length-1]}get isActive(){return!!this.nodeLists.length}get isConnected(){return!(!this.prevNode||!this.nextNode)}connect(p,A){i3.debug("connect audio node, current list:"+this.nodeLists.length),this.nodeLists.length?(this.prevNode&&this.prevNode.disconnect(),p.connect(this.firstNode),this.nextNode&&this.lastNode&&this.lastNode.disconnect(),this.lastNode.connect(A),this.nodeLists.forEach((y,w)=>{const $=this.nodeLists[w+1];$&&y.connect($)})):p.connect(A),this.nextNode=A,this.prevNode=p}disconnect(){var p;i3.debug("disconnect audio node, current list:"+this.nodeLists.length),this.nodeLists.forEach(A=>{A.disconnect()}),null===(p=this.prevNode)||void 0===p||p.disconnect(),this.prevNode=void 0,this.nextNode=void 0}addNode(p){i3.debug("add node in inject node, current list:",this.nodeLists.length),this.prevNode&&this.nextNode?(this.firstNode||(i3.debug("new node is the first node"),this.prevNode.disconnect(),this.prevNode.connect(p),p.connect(this.nextNode)),this.nextNode&&this.lastNode&&(this.lastNode.disconnect(this.nextNode),this.lastNode.connect(p),p.connect(this.nextNode)),this.nodeLists.push(p)):i3.debug("add node is called before inject node connected")}removeNode(p){i3.debug("remove node in inject node, current list:",this.nodeLists.length);const A=this.nodeLists.indexOf(p);if(-1===A)return void i3.debug("$[inject-node] cannot find the node to be removed");const y=this.nodeLists[A+1],w=this.nodeLists[A-1];0===A&&this.prevNode&&this.nextNode&&(this.prevNode.disconnect(p),this.prevNode.connect(y||this.nextNode)),A===this.nodeLists.length-1&&this.nextNode&&w&&(w.disconnect(p),w.connect(this.nextNode)),0!==A&&A!==this.nodeLists.length-1&&(w.disconnect(p),w.connect(y)),i3.debug("remove node in inject node success, current list:",this.nodeLists.length)}}class oP extends sS{get processSourceNode(){return this.sourceNode}set processedNode(p){var A;if(!this.isDestroyed&&this._processedNode!==p){try{var y;null===(y=this.sourceNode)||void 0===y||y.disconnect(this.outputNode)}catch(w){}null===(A=this._processedNode)||void 0===A||A.disconnect(),this._processedNode=p,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),a_(this,"outputNode",void 0),a_(this,"outputTrack",void 0),a_(this,"isPlayed",!1),a_(this,"sourceNode",void 0),a_(this,"analyserNode",void 0),a_(this,"context",void 0),a_(this,"audioBufferNode",void 0),a_(this,"destNode",void 0),a_(this,"injectNode",void 0),a_(this,"audioOutputLevel",0),a_(this,"_processedNode",void 0),a_(this,"playNode",void 0),a_(this,"isDestroyed",!1),a_(this,"onNoAudioInput",void 0),a_(this,"isNoAudioInput",!1),a_(this,"_noAudioInputCount",0),this.context=nX(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),GK(this.outputNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.smoothingTimeConstant=.4,this.analyserNode.fftSize=2048,this.injectNode=new ege}startGetAudioBuffer(p){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(p),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=A=>{this.emit(s2.ON_AUDIO_BUFFER,function(y){for(let w=0;w<y.outputBuffer.numberOfChannels;w+=1){const $=y.outputBuffer.getChannelData(w);for(let j=0;j<$.length;j+=1)$[j]=0}return y.inputBuffer}(A))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!bN().webAudioMediaStreamDest)throw new U_(N_.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(p){"running"!==this.context.state&&d2(()=>{g1.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=p||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch(p){}this.isPlayed=!1}getAccurateVolumeLevel(){if(!this.context||r2()||WU()||"running"!==this.context.state&&this.context.resume(),!this.analyserNode)return 0;const p=new Uint8Array(this.analyserNode.frequencyBinCount);this.analyserNode.getByteFrequencyData(p);let A=0;for(let y=0;y<p.length;y++)A+=y<64?Math.abs(10*p[y]):Math.abs(6*p[y]/15);return A/p.length/255}checkHasAudioInput(){var p=arguments,A=this;return f(function*(){let y=p.length>0&&void 0!==p[0]?p[0]:0;if(y>5)return A.isNoAudioInput=!0,A.onNoAudioInput&&A.onNoAudioInput(),!1;if(r2()||WU()?"suspended"===A.context.state&&A.context.resume():"running"!==A.context.state&&A.context.resume(),!A.analyserNode)return!1;const w=new Uint8Array(A.analyserNode.frequencyBinCount);A.analyserNode.getByteFrequencyData(w);let $=!1;for(let j=0;j<w.length;j++)0!==w[j]&&($=!0);return $?(A.isNoAudioInput=!1,!0):(yield pR(200),(yield A.checkHasAudioInput(y?y+1:1))&&$)})()}getAudioVolume(){return this.outputNode.gain.value}setVolume(p){this.outputNode.gain.setValueAtTime(p,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}injectAudioNode(p){this.injectNode.addNode(p)}removeAudioNode(p){this.injectNode.removeNode(p)}disconnect(){var p,A;null===(p=this.processedNode)||void 0===p||p.disconnect(),null===(A=this.sourceNode)||void 0===A||A.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var p;this.processedNode?null===(p=this.processedNode)||void 0===p||p.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.outputNode.connect(this.analyserNode)}}class Mue extends oP{get isFreeze(){return!1}constructor(p,A){var y,w;if(super(),y=this,a_(this,"sourceNode",void 0),a_(this,"track",void 0),a_(this,"audioElement",void 0),a_(this,"isCurrentTrackCloned",!1),a_(this,"isRemoteTrack",!1),a_(this,"rebuildWebAudio",f(function*(){if(h_.debug("ready to rebuild web audio, state:",y.context.state),y.isNoAudioInput&&(yield y.checkHasAudioInput()),!y.isNoAudioInput||y.isDestroyed)return document.body.removeEventListener("click",y.rebuildWebAudio,!0),void h_.debug("rebuild web audio success, current volume status",y.getAccurateVolumeLevel());y.context.resume().then(()=>h_.info("resume success")),h_.debug("rebuild web audio because of ios 12 bugs"),y.disconnect();const _e=y.track;y.track=y.track.clone(),y.isCurrentTrackCloned?_e.stop():y.isCurrentTrackCloned=!0;const K=new MediaStream([y.track]);y.sourceNode=y.context.createMediaStreamSource(K),GK(y.sourceNode),y.analyserNode=y.context.createAnalyser();const _i=y.outputNode.gain.value;y.outputNode=y.context.createGain(),y.outputNode.gain.setValueAtTime(_i,y.context.currentTime),GK(y.outputNode),y.emit(s2.UPDATE_SOURCE),y.connect(),y.audioElement.srcObject=K,y.isPlayed&&y.play(y.playNode),y.checkHasAudioInput()})),"audio"!==p.kind)throw new U_(N_.UNEXPECTED_ERROR);this.track=p;const $=new MediaStream([this.track]);this.isRemoteTrack=!!A,this.sourceNode=this.context.createMediaStreamSource($),GK(this.sourceNode),this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=$;const j=Y1();A&&j.os===wR.IOS&&Number(null===(w=j.osVersion)||void 0===w?void 0:w.split(".")[0])<15&&(g1.on(US.STATE_CHANGE,()=>{"suspended"===this.context.state?document.body.addEventListener("click",this.rebuildWebAudio,!0):"running"===this.context.state&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(_e=>{_e||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(p){this.sourceNode.disconnect(),this.track=p,this.isCurrentTrackCloned=!1;const A=new MediaStream([p]);this.sourceNode=this.context.createMediaStreamSource(A),GK(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(s2.UPDATE_SOURCE),this.audioElement.srcObject=A}destroy(){this.audioElement.srcObject=null,this.audioElement.remove(),g1.off("state-change",this.rebuildWebAudio),super.destroy()}}function rX(s,p){return iX.apply(this,arguments)}function iX(){return iX=f(function*(s,p){const A=(w,$)=>w?"number"!=typeof w?w.max||w.exact||w.ideal||w.min||$:w:$,y={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:s,maxHeight:A(p.height,1080),maxWidth:A(p.width,1920)}}};return p.frameRate&&"number"!=typeof p.frameRate?(y.video.mandatory.maxFrameRate=p.frameRate.max,y.video.mandatory.minFrameRate=p.frameRate.min):"number"==typeof p.frameRate&&(y.video.mandatory.maxFrameRate=p.frameRate),yield navigator.mediaDevices.getUserMedia(y)}),iX.apply(this,arguments)}function tge(s){return q4.apply(this,arguments)}function q4(){return q4=f(function*(s){const p=yield WQ(s.mediaSource),A=yield(y=p,new iI((w,$)=>{const j=document.createElement("div");j.innerText="share screen",j.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const _e=document.createElement("div");_e.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const K=document.createElement("div");K.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",K.setAttribute("style","height: 12%;");const _i=document.createElement("div");_i.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const _o=document.createElement("div");_o.setAttribute("style","text-align: right; padding: 16px 0;");const _u=document.createElement("button");_u.innerHTML="cancel",_u.setAttribute("style","width: 85px;"),_u.onclick=()=>{document.body.removeChild(ch);const _f=new Error("NotAllowedError");_f.name="NotAllowedError",$(_f)},_o.appendChild(_u),_e.appendChild(K),_e.appendChild(_i),_e.appendChild(_o);const ch=document.createElement("div");ch.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),ch.appendChild(j),ch.appendChild(_e),document.body.appendChild(ch),y.map(_f=>{if(_f.id){const o_=document.createElement("div");o_.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let i_=_f.thumbnail;const{width:u_}=i_.getSize();u_>1920&&(i_=i_.resize({width:1920})),o_.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+i_.toDataURL()+' /></div><span style="\theight: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+_f.name.replace(/[\u00A0-\u9999<>\&]/g,function(g_){return"&#"+g_.charCodeAt(0)+";"})+"</span>",o_.onclick=()=>{document.body.removeChild(ch),w(_f.id)},_i.appendChild(o_)}})}));var y;return yield rX(A,s)}),q4.apply(this,arguments)}function WQ(s){return rie.apply(this,arguments)}function rie(){return rie=f(function*(s){let p=["window","screen"];"application"!==s&&"window"!==s||(p=["window"]),"screen"===s&&(p=["screen"]);const A=nge();if(!A)throw new U_(N_.ELECTRON_IS_NULL);let y=null;try{y=A.desktopCapturer.getSources({types:p})}catch(w){y=null}y&&y.then||(y=new iI((w,$)=>{A.desktopCapturer.getSources({types:p},(j,_e)=>{j?$(j):w(_e)})}));try{return yield y}catch(w){throw new U_(N_.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,w.toString())}}),rie.apply(this,arguments)}let W4=null;function nge(){if(W4)return W4;try{return W4=window.require("electron"),W4}catch(s){return null}}const X8=new iP("safari");let Bue=!1,V6=!1;function zO(s,p){return oX.apply(this,arguments)}function oX(){return oX=f(function*(s,p){let A=0,y=null;for(;A<2;)try{y=yield rge(s,p,A>0);break}catch(w){if(w instanceof U_)throw h_.error("[".concat(p,"] ").concat(w.toString())),S0("error",[],"getLocalStream",{config:s,id:p},w.toString()),w;const $=iie(w.name||w.code||w,w.message);if($.code===N_.MEDIA_OPTION_INVALID){h_.debug("[".concat(p,"] detect media option invalid, retry")),sI("debug",[],"[".concat(p,"] detect media option invalid, retry")),A+=1,yield pR(500);continue}throw h_.error("[".concat(p,"] ").concat($.toString())),S0("error",[],"getLocalStream",{config:s,id:p},$.toString()),$}if(!y)throw new U_(N_.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return y}),oX.apply(this,arguments)}function rge(s,p,A){return Uue.apply(this,arguments)}function Uue(){return Uue=f(function*(s,p,A){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new U_(N_.NOT_SUPPORTED,"can not find getUserMedia");A&&(s.video&&(delete s.video.width,delete s.video.height),s.screen&&(delete s.screen.width,delete s.screen.height));const y=bN(),w=new MediaStream;if(s.audioSource&&w.addTrack(s.audioSource),s.videoSource&&w.addTrack(s.videoSource),!s.audio&&!s.video&&!s.screen)return h_.debug("Using Video Source/ Audio Source"),sI("debug",[],"Using Video Source/ Audio Source"),w;if(s.screen)if(nge())HK(w,s.screen.sourceId?yield rX(s.screen.sourceId,s.screen):yield tge(s.screen));else if(nZ()&&s.screen.extensionId&&s.screen.mandatory){if(!y.getStreamFromExtension)throw new U_(N_.NOT_SUPPORTED,"This browser does not support screen sharing");h_.debug("[".concat(p,'] Screen access on chrome stable, looking for extension"')),sI("debug",[],"[".concat(p,'] Screen access on chrome stable, looking for extension"'));const _u=yield($=s.screen.extensionId,j=p,new iI((ch,_f)=>{try{chrome.runtime.sendMessage($,{getStream:!0},o_=>{if(!o_||!o_.streamId)return h_.error("[".concat(j,"] No response from Chrome Plugin. Plugin not installed properly"),o_),S0("error",[],"getSourceIdFromExtension",{extensionId:$,streamId:j},"No response from Chrome Plugin. Plugin not installed properly, ".concat(o_)),void _f(new U_(N_.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));ch(o_.streamId)})}catch(o_){h_.error("[".concat(j,"] AgoraRTC screensharing plugin is not accessible(").concat($,")"),o_.toString()),S0("error",[],"getSourceIdFromExtension",{extensionId:$,streamId:j},"AgoraRTC screensharing plugin is not accessible(".concat($,"), ").concat(o_.toString())),_f(new U_(N_.CHROME_PLUGIN_NOT_INSTALL))}}));s.screen.mandatory.chromeMediaSourceId=_u,HK(w,yield navigator.mediaDevices.getUserMedia({video:{mandatory:s.screen.mandatory}}))}else if(y.getDisplayMedia){s.screen.mediaSource&&Vfe(s.screen.mediaSource);const _u={width:s.screen.width,height:s.screen.height,frameRate:s.screen.frameRate,displaySurface:"screen"===s.screen.mediaSource?"monitor":s.screen.mediaSource};h_.debug("[".concat(p,"] getDisplayMedia:"),JSON.stringify({video:_u,audio:!!s.screenAudio})),uK("debug",["mediaDevices",p],"getDisplayMedia",{video:_u,audio:!!s.screenAudio,trackId:p}),HK(w,yield navigator.mediaDevices.getDisplayMedia({video:_u,audio:!!s.screenAudio}))}else{if(!X2())throw h_.error("[".concat(p,"] This browser does not support screenSharing")),new U_(N_.NOT_SUPPORTED,"This browser does not support screen sharing");{s.screen.mediaSource&&Vfe(s.screen.mediaSource);const _u={video:{mediaSource:s.screen.mediaSource,width:s.screen.width,height:s.screen.height,frameRate:s.screen.frameRate}};h_.debug("[".concat(p,"] getUserMedia: ").concat(JSON.stringify(_u))),uK("debug",["mediaDevices",p],"getUserMedia",_u),HK(w,yield navigator.mediaDevices.getUserMedia(_u))}}var $,j;if(!s.video&&!s.audio)return w;let _e={video:s.video,audio:s.audio},K=v0("MEDIA_DEVICE_CONSTRAINTS");if(K)try{"string"==typeof K&&(K=JSON.parse(K)),_e=function _u(ch,_f){if(!Aie(ch)||!Aie(_f)||Array.isArray(ch)&&!Array.isArray(_f)||!Array.isArray(ch)&&Array.isArray(_f))return _f;if(Array.isArray(_f)&&Array.isArray(ch)){const o_=[...ch];for(let i_=0;i_<_f.length;i_++)o_[i_]=_u(ch[i_],_f[i_]);return o_}{const o_=ZQ({},ch);for(const i_ in _f)Object.prototype.hasOwnProperty.call(_f,i_)&&(o_[i_]=Object.prototype.hasOwnProperty.call(ch,i_)?_u(ch[i_],_f[i_]):_f[i_]);return o_}}(_e,K),sI("debug",["mediaDevices",p],"merge configConstraints ".concat(JSON.stringify(K)))}catch(_u){}h_.debug("[".concat(p,"] GetUserMedia"),JSON.stringify(_e)),uK("debug",["mediaDevices",p],"getUserMedia",_e),Y1();let _i,_o=null;(Z2()||r2()||Hne())&&(_o=yield X8.lock());try{_i=yield navigator.mediaDevices.getUserMedia(_e)}catch(_u){throw _o&&_o(),_u}return _e.audio&&(Bue=!0),_e.video&&(V6=!0),HK(w,_i),_o&&_o(),w}),Uue.apply(this,arguments)}function iie(s,p){switch(s){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new U_(N_.MEDIA_OPTION_INVALID,"".concat(s,": ").concat(p));case"NotFoundError":case"DevicesNotFoundError":return new U_(N_.DEVICE_NOT_FOUND,"".concat(s,": ").concat(p));case"NotSupportedError":return new U_(N_.NOT_SUPPORTED,"".concat(s,": ").concat(p));case"NotReadableError":return new U_(N_.NOT_READABLE,"".concat(s,": ").concat(p));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new U_(N_.PERMISSION_DENIED,"".concat(s,": ").concat(p));case"ConstraintNotSatisfiedError":return new U_(N_.CONSTRAINT_NOT_SATISFIED,"".concat(s,": ").concat(p));default:return h_.error("getUserMedia unexpected error",s),S0("error",[],"handleGetUserMediaError",void 0,s),new U_(N_.UNEXPECTED_ERROR,"".concat(s,": ").concat(p))}}function HK(s,p){const A=s.getVideoTracks()[0],y=s.getAudioTracks()[0],w=p.getVideoTracks()[0],$=p.getAudioTracks()[0];$&&(y&&s.removeTrack(y),s.addTrack($)),w&&(A&&s.removeTrack(A),s.addTrack(w))}const sP=new class extends sS{get state(){return this._state}set state(s){s!==this._state&&(this.emit(XU.STATE_CHANGE,s),this._state=s)}constructor(){super(),a_(this,"_state",C6.IDLE),a_(this,"isAccessMicrophonePermission",!1),a_(this,"isAccessCameraPermission",!1),a_(this,"lastAccessMicrophonePermission",!1),a_(this,"lastAccessCameraPermission",!1),a_(this,"checkdeviceMatched",!1),a_(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(v0("ENUMERATE_DEVICES_INTERVAL")||ofe()&&bQ())&&this.updateDevicesInfo()},v0("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(s=>h_.error(s.toString()))}enumerateDevices(s,p){var A=arguments,y=this;return f(function*(){let w=A.length>2&&void 0!==A[2]&&A[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new U_(N_.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const $=yield navigator.mediaDevices.enumerateDevices(),j=y.checkMediaDeviceInfoIsOk($);let _e=!y.isAccessMicrophonePermission&&s,K=!y.isAccessCameraPermission&&p;j.audio&&(_e=!1),j.video&&(K=!1);let _i=null,_o=null,_u=null;if(!w&&(_e||K)){if(X8.isLocked&&(h_.debug("[device manager] wait GUM lock"),(yield X8.lock())(),h_.debug("[device manager] GUM unlock")),Bue&&(_e=!1,y.isAccessMicrophonePermission=!0),V6&&(K=!1,y.isAccessCameraPermission=!0),h_.debug("[device manager] check media device permissions",s,p,_e,K),_e&&K){try{_u=yield navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(ch){const _f=iie(ch.name||ch.code||ch,ch.message);if(_f.code===N_.PERMISSION_DENIED)throw _f;h_.warning("getUserMedia failed in getDevices",_f)}y.isAccessCameraPermission=!0,y.isAccessMicrophonePermission=!0}else if(_e){try{_i=yield navigator.mediaDevices.getUserMedia({audio:s})}catch(ch){const _f=iie(ch.name||ch.code||ch,ch.message);if(_f.code===N_.PERMISSION_DENIED)throw _f;h_.warning("getUserMedia failed in getDevices",_f)}y.isAccessMicrophonePermission=!0}else if(K){try{_o=yield navigator.mediaDevices.getUserMedia({video:p})}catch(ch){const _f=iie(ch.name||ch.code||ch,ch.message);if(_f.code===N_.PERMISSION_DENIED)throw _f;h_.warning("getUserMedia failed in getDevices",_f)}y.isAccessCameraPermission=!0}h_.debug("[device manager] mic permission",s,"cam permission",p)}try{const ch=yield navigator.mediaDevices.enumerateDevices();return _i&&_i.getTracks().forEach(_f=>_f.stop()),_o&&_o.getTracks().forEach(_f=>_f.stop()),_u&&_u.getTracks().forEach(_f=>_f.stop()),_i=null,_o=null,_u=null,ch}catch(ch){return _i&&_i.getTracks().forEach(_f=>_f.stop()),_o&&_o.getTracks().forEach(_f=>_f.stop()),_u&&_u.getTracks().forEach(_f=>_f.stop()),_i=null,_o=null,_u=null,new U_(N_.ENUMERATE_DEVICES_FAILED,ch.toString()).throw()}})()}getRecordingDevices(){var s=arguments,p=this;return f(function*(){let A=s.length>0&&void 0!==s[0]&&s[0];return(yield p.enumerateDevices(!0,!1,A)).filter(y=>"audioinput"===y.kind)})()}getCamerasDevices(){var s=arguments,p=this;return f(function*(){let A=s.length>0&&void 0!==s[0]&&s[0];return(yield p.enumerateDevices(!1,!0,A)).filter(y=>"videoinput"===y.kind)})()}getSpeakers(){var s=arguments,p=this;return f(function*(){let A=s.length>0&&void 0!==s[0]&&s[0];return(yield p.enumerateDevices(!0,!1,A)).filter(y=>"audiooutput"===y.kind)})()}searchDeviceIdByName(s){let p=null;return this.deviceInfoMap.forEach(A=>{A.device.label===s&&(p=A.device.deviceId)}),p}getDeviceById(s){var p=this;return f(function*(){const A=(yield p.enumerateDevices(!0,!0,!0)).find(y=>y.deviceId===s);if(!A)throw new U_(N_.DEVICE_NOT_FOUND,"deviceId: ".concat(s));return A})()}init(){var s=this;return f(function*(){s.state=C6.INITING;try{yield s.updateDevicesInfo(),s.state=C6.INITEND}catch(p){throw h_.warning("Device Detection functionality cannot start properly.",p.toString()),s.state=C6.IDLE,!("boolean"==typeof isSecureContext?isSecureContext:"https:"===location.protocol||"file:"===location.protocol||"localhost"===location.hostname||"127.0.0.1"===location.hostname||"::1"===location.hostname)&&new U_(N_.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),p}})()}updateDevicesInfo(){var s=this;return f(function*(){const p=yield s.enumerateDevices(!0,!0,!0),A=Date.now(),y=[];if(p[0]&&p[0].label&&!1===s.checkdeviceMatched){s.checkdeviceMatched=!0;const $=p.find(_e=>"audioinput"===_e.kind&&"default"===_e.deviceId),j=p.find(_e=>"audiooutput"===_e.kind&&"default"===_e.deviceId);$&&j?j.groupId===$.groupId?h_.debug("[device-check] default input ".concat($.label," and output ").concat(j.label," is the same group")):h_.warning("[device-check] default input ".concat($.label," and output ").concat(j.label," is not the same group")):h_.debug("[device-check] default input or output not found")}const w=s.checkMediaDeviceInfoIsOk(p);if(p.forEach($=>{if(!$.deviceId)return;const j=s.deviceInfoMap.get("".concat($.kind,"_").concat($.deviceId));if("ACTIVE"!==(j?j.state:"INACTIVE")){const _e={initAt:A,updateAt:A,device:$,state:"ACTIVE"};s.deviceInfoMap.set("".concat($.kind,"_").concat($.deviceId),_e),y.push(_e)}j&&(j.updateAt=A)}),s.deviceInfoMap.forEach(($,j)=>{"ACTIVE"===$.state&&$.updateAt!==A&&($.state="INACTIVE",y.push($))}),s.state!==C6.INITEND)return w.audio&&(s.lastAccessMicrophonePermission=!0,s.isAccessMicrophonePermission=!0),void(w.video&&(s.lastAccessCameraPermission=!0,s.isAccessCameraPermission=!0));y.forEach($=>{switch($.device.kind){case"audioinput":s.lastAccessMicrophonePermission&&s.isAccessMicrophonePermission&&s.emit(XU.RECORDING_DEVICE_CHANGED,$);break;case"videoinput":s.lastAccessCameraPermission&&s.isAccessCameraPermission&&s.emit(XU.CAMERA_DEVICE_CHANGED,$);break;case"audiooutput":s.lastAccessMicrophonePermission&&s.isAccessMicrophonePermission&&s.emit(XU.PLAYOUT_DEVICE_CHANGED,$)}}),w.audio&&(s.lastAccessMicrophonePermission=!0,s.isAccessMicrophonePermission=!0),w.video&&(s.lastAccessCameraPermission=!0,s.isAccessCameraPermission=!0)})()}checkMediaDeviceInfoIsOk(s){const p=s.filter(w=>"audioinput"===w.kind),A=s.filter(w=>"videoinput"===w.kind),y={audio:!1,video:!1};for(const w of p)if(w.label&&w.deviceId){y.audio=!0;break}for(const w of A)if(w.label&&w.deviceId){y.video=!0;break}return y}};var sX;let ige=TR("AudioElementPlayCenter")(sX=class{constructor(){a_(this,"onAutoplayFailed",void 0),a_(this,"elementMap",new Map),a_(this,"elementStateMap",new Map),a_(this,"elementsNeedToResume",[]),a_(this,"sinkIdMap",new Map),a_(this,"autoResumeAfterInterruption",()=>{Array.from(this.elementMap.entries()).forEach(s=>{let[p,A]=s;const y=this.elementStateMap.get(p),w=A.srcObject.getAudioTracks()[0];rK()?w&&"live"===w.readyState&&"running"===g1.curState&&(h_.debug("auto resume after interruption for iOS 15"),sI("debug",["AudioElementPlayCenter",p],"auto resume after interruption for iOS15"),A.pause(),A.play()):y&&"paused"===y&&w&&"live"===w.readyState&&"running"===g1.curState&&(h_.debug("auto resume after interruption for iOS"),sI("debug",["AudioElementPlayCenter",p],"auto resume after interruption for iOS"),A.play())})}),a_(this,"autoResumeAfterInterruptionOnIOS15",()=>{Array.from(this.elementMap.entries()).forEach(s=>{let[p,A]=s;const y=A.srcObject.getAudioTracks()[0];y&&"live"===y.readyState&&(h_.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),S0("debug",["AudioElementPlayCenter",p],"autoResumeAfterInterruptionOnIOS15"),A.pause(),A.play())})}),this.autoResumeAudioElement(),g1.on(US.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),g1.on(US.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15),g1.on(US.STATE_CHANGE,()=>{r2()&&"suspended"===g1.prevState&&"running"===g1.curState&&this.autoResumeAfterInterruption()})}setSinkID(s,p){var A=this;return f(function*(){const y=A.elementMap.get(s);if(A.sinkIdMap.set(s,p),y)try{yield y.setSinkId(p)}catch(w){throw new U_(N_.PERMISSION_DENIED,"can not set sink id: "+w.toString())}})()}play(s,p,A,y){if(this.elementMap.has(p))return;const w=document.createElement("audio");w.autoplay=!0,w.srcObject=new MediaStream([s]),this.bindAudioElementEvents(p,w),this.elementMap.set(p,w),this.elementStateMap.set(p,yO.INIT),this.setVolume(p,A);const $=this.sinkIdMap.get(p);if($)try{w.setSinkId($).catch(_e=>{h_.warning("[".concat(p,"] set sink id failed"),_e.toString()),uK("warning",["HTMLAudioElement",p],"setSinkId",_e.toString())})}catch(_e){h_.warning("[".concat(p,"] set sink id failed"),_e.toString())}const j=w.play();j&&j.then&&j.catch(_e=>{y&&w0.autoplayFailed(y,"audio",_e.message,p),h_.warning("audio element play warning",_e.toString()),uK("warning",["HTMLAudioElement",p],"play",_e.toString()),this.elementMap.has(p)&&"NotAllowedError"===_e.name&&(h_.warning("detected audio element autoplay failed"),S0("warning",["AudioElementPlayCenter",p],"play",_e.toString()),this.elementsNeedToResume.push(w),d2(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),eie()}))})}updateTrack(s,p){const A=this.elementMap.get(s);A&&(A.srcObject=new MediaStream([p]))}isPlaying(s){return this.elementMap.has(s)}setVolume(s,p){const A=this.elementMap.get(s);A&&(p=Math.max(0,Math.min(100,p)),A.volume=p/100)}stop(s){const p=this.elementMap.get(s);if(this.sinkIdMap.delete(s),!p)return;const A=this.elementsNeedToResume.indexOf(p);this.elementsNeedToResume.splice(A,1),p.srcObject=null,p.remove(),this.elementMap.delete(s),this.elementStateMap.delete(s)}bindAudioElementEvents(s,p){Pve.forEach(A=>{p.addEventListener(A,y=>{const w=this.elementStateMap.get(s),$="pause"===y.type?"paused":y.type;h_.debug("[".concat(s,"] audio-element-status change ").concat(w," => ").concat($)),b6("debug",["HTMLAudioElement",s],"statusChange","".concat(w," => ").concat($)),this.elementStateMap.set(s,$)})})}getPlayerState(s){return this.elementStateMap.get(s)||"uninit"}autoResumeAudioElement(){const s=()=>{this.elementsNeedToResume.forEach(p=>{p.play().then(A=>{h_.debug("Auto resume audio element success"),S0("debug",["AudioElementPlayCenter"],"autoResumeAudioElement")}).catch(A=>{h_.warning("Auto resume audio element failed!",A),S0("warning",["AudioElementPlayCenter"],"autoResumeAudioElement",A.toString())})}),this.elementsNeedToResume=[]};new iI(p=>{document.body?p():window.addEventListener("load",()=>p())}).then(()=>{const p=Y1();"Android"!==p.os||"Chrome"!==p.name&&p.name!==C1.WECHAT?(document.body.addEventListener("touchstart",s,!0),document.body.addEventListener("mousedown",s,!0)):document.body.addEventListener("click",s,!0)})}})||sX;const Pve=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended"],aP=new ige;function jT(){return function(s,p,A){const y=s[p];"function"==typeof y&&(A.value=function(){this._isClosed&&new U_(N_.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning");for(var w=arguments.length,$=new Array(w),j=0;j<w;j++)$[j]=arguments[j];const _e=y.apply(this,$);return _e instanceof iI?new iI((K,_i)=>{_e.then(K).catch(_i)}):_e})}}var eG,qK,Fue,jue,oge,Vue,oie,sie,WK,aX,aie,sge,FS,Gue,age,Que,Hue,cie,KQ,que,cge,Wue,uge,zQ,YQ,uie,CO,Kue;function zue(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function lie(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?zue(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):zue(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}let cO=(eG=TR("LocalAudioTrack","getTrackId"),qK=jT(),Fue=H4("LocalAudioTrack","_enabledMutex"),jue=jT(),oge=H4("LocalAudioTrack","_enabledMutex"),Vue=jT(),oie=VK({report:w0}),sie=jT(),WK=jT(),aX=jT(),aie=jT(),eG((gI((FS=class extends F6{get isPlaying(){return this._useAudioElement?aP.isPlaying(this.getTrackId()):this._source.isPlayed}constructor(s,p,A){super(s,A),a_(this,"trackMediaType","audio"),a_(this,"_encoderConfig",void 0),a_(this,"_source",void 0),a_(this,"_enabled",!0),a_(this,"_volume",100),a_(this,"_useAudioElement",!1),a_(this,"_bypassWebAudio",!1),a_(this,"processor",void 0),a_(this,"processorContext",void 0),a_(this,"processorDestination",void 0),this._encoderConfig=p,this._source=new Mue(s),v0("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")||(this._useAudioElement=!0),this.processorContext=new Mve(this._source.context,this.getTrackId()),this.processorDestination=new Lve(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(s2.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setVolume(s){iT(s,"volume",0,1e3);const p=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.LOCAL_AUDIO_TRACK_SET_VOLUME,options:[this.getTrackId(),s]},300);this._volume=s,this._source.setVolume(s/100),this._useAudioElement&&aP.setVolume(this.getTrackId(),s);try{if(this._bypassWebAudio)return h_.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio.")),void p.onSuccess();const A=this._source.createOutputTrack();this._mediaStreamTrack!==A&&(this._mediaStreamTrack=A,wT(this,mI.NEED_REPLACE_TRACK,this).then(()=>{h_.debug("[".concat(this.getTrackId(),"] replace web audio track success")),sI("debug",this,"replace web audio track success")}).catch(y=>{h_.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),y),sI("warning",this,"replace web audio track failed ".concat(y.toString()))}))}catch(A){}p.onSuccess()}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}setPlaybackDevice(s){var p=this;return f(function*(){const A=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.REMOTE_AUDIO_SET_OUTPUT_DEVICE,options:[p.getTrackId(),s]});if(!p._useAudioElement)throw new U_(N_.NOT_SUPPORTED,"your browser does not support setting the audio output device");try{yield aP.setSinkID(p.getTrackId(),s)}catch(y){throw A.onError(y),y}A.onSuccess()})()}setEnabled(s,p,A){var y=this;return f(function*(){if(!A){if(s===y._enabled)return;y.stateCheck("enabled",s)}if(h_.info("[".concat(y.getTrackId(),"] start setEnabled"),s),S0("info",y,"setEnabled",s),s){y._originMediaStreamTrack.enabled=!0;try{A||(y._enabled=!0),yield wT(y,mI.NEED_ENABLE_TRACK,y),h_.info("[".concat(y.getTrackId(),"] setEnabled to ").concat(s," success")),S0("info",y,"setEnabled",s,"success")}catch(w){throw A||(y._enabled=!1),h_.error("[".concat(y.getTrackId(),"] setEnabled to true error"),w.toString()),S0("error",y,"setEnabled",s,w.toString()),w}}else{y._originMediaStreamTrack.enabled=!1,A||(y._enabled=!1);try{yield wT(y,mI.NEED_DISABLE_TRACK,y)}catch(w){throw A||(y._enabled=!0),h_.error("[".concat(y.getTrackId(),"] setEnabled to false error"),w.toString()),S0("info",y,"setEnabled",s,w.toString()),w}}})()}setMuted(s){var p=this;return f(function*(){s!==p._muted&&(p.stateCheck("muted",s),p._muted=s,p._mediaStreamTrack.enabled=!s,h_.debug("[".concat(p.getTrackId(),"] start set muted: ").concat(s)),S0("debug",p,"setMuted",s),s?yield wT(p,mI.NEED_MUTE_TRACK,p):yield wT(p,mI.NEED_UNMUTE_TRACK,p))})()}getStats(){return YK(()=>{h_.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead"),sI("warning",this,"LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),o3(this,mI.GET_STATS)||lie({},AK)}setAudioFrameCallback(s){let p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!s)return this._source.removeAllListeners(s2.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(p),this._source.removeAllListeners(s2.ON_AUDIO_BUFFER),this._source.on(s2.ON_AUDIO_BUFFER,A=>s(A))}play(){const s=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.LOCAL_AUDIO_TRACK_PLAY,options:[this.getTrackId()]});h_.debug("[".concat(this.getTrackId(),"] start audio playback")),S0("debug",this,"play"),this._useAudioElement?(h_.debug("[".concat(this.getTrackId(),"] start audio playback in element")),sI("debug",this,"start audio playback in element"),aP.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play(),s.onSuccess()}stop(){const s=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.LOCAL_AUDIO_TRACK_STOP,options:[this.getTrackId()]});h_.debug("[".concat(this.getTrackId(),"] stop audio playback")),S0("debug",this,"stop"),this._useAudioElement?aP.stop(this.getTrackId()):this._source.stop(),s.onSuccess()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){h_.debug("[".concat(this.getTrackId(),"] update player source track")),S0("debug",this,"_updatePlayerSource"),this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&aP.updateTrack(this.getTrackId(),this._mediaStreamTrack)}_updateOriginMediaStreamTrack(s,p){var A=this;return f(function*(){A._originMediaStreamTrack!==s&&(A._originMediaStreamTrack.removeEventListener("ended",A._handleTrackEnded),s.addEventListener("ended",A._handleTrackEnded),p&&A._originMediaStreamTrack.stop(),A._originMediaStreamTrack=s,A.processor&&A.processor.updateInput({track:s,context:A.processorContext}),A._mediaStreamTrack!==A._source.outputTrack?(A._mediaStreamTrack=A._originMediaStreamTrack,A._updatePlayerSource(),yield wT(A,mI.NEED_REPLACE_TRACK,A)):A._source.updateTrack(A._originMediaStreamTrack))})()}renewMediaStreamTrack(s){return iI.resolve(void 0)}pipe(s){if(this._bypassWebAudio)throw new U_(N_.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===s)return s;if(s._source)throw new U_(N_.INVALID_OPERATION,"Processor ".concat(s.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=s,this.processor._source=this,s.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),s}unpipe(){var s;if(!this.processor)return;const p=this.processor;null===(s=this._source.processSourceNode)||void 0===s||s.disconnect(),this.processor._source=!1,this.processor=void 0,p.reset()}bindProcessorDestinationEvents(){var s=this;this.processorDestination.on(tP.ON_TRACK,function(){var p=f(function*(A){A?A!==s._mediaStreamTrack&&(s._mediaStreamTrack=A,s._updatePlayerSource(),yield wT(s,mI.NEED_REPLACE_TRACK,s)):s._mediaStreamTrack!==s._originMediaStreamTrack&&(s._mediaStreamTrack=s._originMediaStreamTrack,s._updatePlayerSource(),yield wT(s,mI.NEED_REPLACE_TRACK,s))});return function(A){return p.apply(this,arguments)}}()),this.processorDestination.on(tP.ON_NODE,p=>{this._source.processedNode=p})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(tP.ON_TRACK),this.processorDestination.removeAllListeners(tP.ON_NODE)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(a2.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(a2.REQUEST_CONSTRAINTS)}}).prototype,"setPlaybackDevice",[qK],Object.getOwnPropertyDescriptor(FS.prototype,"setPlaybackDevice"),FS.prototype),gI(FS.prototype,"setEnabled",[Fue,jue],Object.getOwnPropertyDescriptor(FS.prototype,"setEnabled"),FS.prototype),gI(FS.prototype,"setMuted",[oge,Vue,oie],Object.getOwnPropertyDescriptor(FS.prototype,"setMuted"),FS.prototype),gI(FS.prototype,"getStats",[sie],Object.getOwnPropertyDescriptor(FS.prototype,"getStats"),FS.prototype),gI(FS.prototype,"setAudioFrameCallback",[WK],Object.getOwnPropertyDescriptor(FS.prototype,"setAudioFrameCallback"),FS.prototype),gI(FS.prototype,"play",[aX],Object.getOwnPropertyDescriptor(FS.prototype,"play"),FS.prototype),gI(FS.prototype,"stop",[aie],Object.getOwnPropertyDescriptor(FS.prototype,"stop"),FS.prototype),sge=FS))||sge),JQ=(Gue=TR("MicrophoneAudioTrack","getTrackId"),age=jT(),Que=H4("MicrophoneAudioTrack","_enabledMutex"),Hue=jT(),Gue((gI((KQ=class extends cO{constructor(s,p,A,y){super(s,p.encoderConfig?nO(p.encoderConfig):{},y),a_(this,"_config",void 0),a_(this,"_deviceName","default"),a_(this,"_constraints",void 0),a_(this,"_originalConstraints",void 0),a_(this,"_enabled",!0),II("info",this,"constructor",{trackId:y,deviceId:s.label,constraints:A}),this._config=p,this._constraints=A,this._originalConstraints=A,this._deviceName=s.label,"boolean"==typeof p.bypassWebAudio&&(this._bypassWebAudio=p.bypassWebAudio),rK()&&g1.bindInterruptDetectorTrack(this),this.bindProcessorContextEvents()}setDevice(s){var p=this;return f(function*(){const A=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.MIC_AUDIO_TRACK_SET_DEVICE,options:[p.getTrackId(),s]});if(h_.info("[".concat(p.getTrackId(),"] start set device to ").concat(s)),S0("info",p,"setDevice",s),p._enabled)try{const y=yield sP.getDeviceById(s),w={};w.audio=lie({},p._constraints),w.audio.deviceId={exact:s},p._originMediaStreamTrack.stop();let $=null;try{$=yield zO(w,p.getTrackId())}catch(j){throw h_.error("[".concat(p.getTrackId(),"] setDevice failed"),j.toString()),S0("error",p,"setDevice",s,j.toString()),$=yield zO({video:p._constraints},p.getTrackId()),yield p._updateOriginMediaStreamTrack($.getAudioTracks()[0],!1),j}yield p._updateOriginMediaStreamTrack($.getAudioTracks()[0],!1),p._deviceName=y.label,p._config.microphoneId=s,p._constraints.deviceId={exact:s}}catch(y){throw A.onError(y),h_.error("[".concat(p.getTrackId(),"] setDevice error"),y.toString()),S0("error",p,"setDevice",s,y.toString()),y}else try{const y=yield sP.getDeviceById(s);p._deviceName=y.label,p._config.microphoneId=s,p._constraints.deviceId={exact:s}}catch(y){throw A.onError(y),h_.error("[".concat(p.getTrackId(),"] setDevice error"),y.toString()),S0("error",p,"setDevice",s,y.toString()),y}A.onSuccess(),h_.info("[".concat(p.getTrackId(),"] set device to ").concat(s," success")),S0("info",p,"setDevice",s,"success")})()}setEnabled(s,p,A){var y=()=>super.setEnabled,w=this;return f(function*(){if(p)return h_.debug("[".concat(w.getTrackId,"] setEnabled false (do not close microphone)")),sI("debug",w,"setEnabled false (do not close microphone)"),yield y().call(w,s);if(!A){if(s===w._enabled)return;w.stateCheck("enabled",s)}if(h_.info("[".concat(w.getTrackId(),"] start setEnabled"),s),S0("info",w,"setEnabled",s),!s){w._originMediaStreamTrack.onended=null,w._originMediaStreamTrack.stop(),A||(w._enabled=!1);try{yield wT(w,mI.NEED_DISABLE_TRACK,w)}catch(_e){throw h_.error("[".concat(w.getTrackId(),"] setEnabled false failed"),_e.toString()),S0("error",w,"setEnabled",s,_e.toString()),_e}return}const $=lie({},w._constraints),j=sP.searchDeviceIdByName(w._deviceName);j&&!$.deviceId&&($.deviceId=j);try{A||(w._enabled=!0);const _e=yield zO({audio:w._constraints},w.getTrackId());yield w._updateOriginMediaStreamTrack(_e.getAudioTracks()[0],!1),yield wT(w,mI.NEED_ENABLE_TRACK,w)}catch(_e){throw A||(w._enabled=!1),h_.error("[".concat(w.getTrackId(),"] setEnabled true failed"),_e.toString()),S0("error",w,"setEnabled",s,_e.toString()),_e}h_.info("[".concat(w.getTrackId(),"] setEnabled success")),S0("info",w,"setEnabled",s,"success")})()}close(){super.close(),rK()&&g1.unbindInterruptDetectorTrack(this)}onTrackEnded(){var s=this;if((r2()||WU())&&this._enabled&&!this._isClosed&&g1.duringInterruption){const p=function(){var A=f(function*(){g1.off(US.IOS_INTERRUPTION_END,p),s._enabled&&!s._isClosed&&(h_.debug("[".concat(s.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),sI("debug",s,"try capture microphone media device for interrupted iOS device"),yield s.setEnabled(!1),yield s.setEnabled(!0))});return function(){return A.apply(this,arguments)}}();g1.on(US.IOS_INTERRUPTION_END,p)}else h_.debug("[".concat(this.getTrackId(),"] track ended")),b6("debug",["MediaStreamTrack",this.getTrackId()],"ended"),this.emit(FL.TRACK_ENDED)}renewMediaStreamTrack(s){var p=this;return f(function*(){const A=s||p._constraints,y=sP.searchDeviceIdByName(p._deviceName);y&&!A.deviceId&&(A.deviceId=y),p._constraints=A,p._originMediaStreamTrack.stop();const w=yield zO({audio:p._constraints},p.getTrackId());yield p._updateOriginMediaStreamTrack(w.getAudioTracks()[0],!0)})()}bindProcessorContextEvents(){var s=this;this.processorContext.on(a2.REQUEST_UPDATE_CONSTRAINTS,function(){var p=f(function*(A,y,w){try{const $=Object.assign({},s._originalConstraints,...A);yield s.renewMediaStreamTrack($),y()}catch($){w($)}});return function(A,y,w){return p.apply(this,arguments)}}()),this.processorContext.on(a2.REQUEST_CONSTRAINTS,function(){var p=f(function*(A){A(s._originMediaStreamTrack.getSettings())});return function(A){return p.apply(this,arguments)}}())}}).prototype,"setDevice",[age],Object.getOwnPropertyDescriptor(KQ.prototype,"setDevice"),KQ.prototype),gI(KQ.prototype,"setEnabled",[Que,Hue],Object.getOwnPropertyDescriptor(KQ.prototype,"setEnabled"),KQ.prototype),cie=KQ))||cie),xve=(que=TR("BufferSourceAudioTrack","getTrackId"),cge=jT(),Wue=jT(),uge=jT(),zQ=jT(),YQ=jT(),que((gI((CO=class extends cO{constructor(s,p,A,y){super(p.createOutputTrack(),A,y),a_(this,"source",void 0),a_(this,"_bufferSource",void 0),II("info",this,"constructor",{trackId:y}),this.source=s,this._bufferSource=p,this._bufferSource.on(s2.AUDIO_SOURCE_STATE_CHANGE,w=>{this.emit(FL.SOURCE_STATE_CHANGE,w)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(w){}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(s){const p=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.BUFFER_AUDIO_TRACK_START,options:[this.getTrackId(),s,this.duration]});s&&this._bufferSource.updateOptions(s),this._bufferSource.startProcessAudioBuffer(),p.onSuccess()}pauseProcessAudioBuffer(){const s=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.BUFFER_AUDIO_TRACK_PAUSE,options:[this.getTrackId()]});this._bufferSource.pauseProcessAudioBuffer(),s.onSuccess()}seekAudioBuffer(s){const p=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.BUFFER_AUDIO_TRACK_SEEK,options:[this.getTrackId()]});this._bufferSource.seekAudioBuffer(s),p.onSuccess()}resumeProcessAudioBuffer(){const s=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.BUFFER_AUDIO_TRACK_RESUME,options:[this.getTrackId()]});this._bufferSource.resumeProcessAudioBuffer(),s.onSuccess()}stopProcessAudioBuffer(){const s=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.BUFFER_AUDIO_TRACK_STOP,options:[this.getTrackId()]});this._bufferSource.stopProcessAudioBuffer(),s.onSuccess()}}).prototype,"startProcessAudioBuffer",[cge],Object.getOwnPropertyDescriptor(CO.prototype,"startProcessAudioBuffer"),CO.prototype),gI(CO.prototype,"pauseProcessAudioBuffer",[Wue],Object.getOwnPropertyDescriptor(CO.prototype,"pauseProcessAudioBuffer"),CO.prototype),gI(CO.prototype,"seekAudioBuffer",[uge],Object.getOwnPropertyDescriptor(CO.prototype,"seekAudioBuffer"),CO.prototype),gI(CO.prototype,"resumeProcessAudioBuffer",[zQ],Object.getOwnPropertyDescriptor(CO.prototype,"resumeProcessAudioBuffer"),CO.prototype),gI(CO.prototype,"stopProcessAudioBuffer",[YQ],Object.getOwnPropertyDescriptor(CO.prototype,"stopProcessAudioBuffer"),CO.prototype),uie=CO))||uie),cP=TR("MixingAudioTrack","getTrackId")(Kue=class extends cO{get isActive(){for(const s of this.trackList)if(s._enabled&&!s._isClosed&&!s.muted)return!0;return!1}constructor(){const s=nX().createMediaStreamDestination();super(s.stream.getAudioTracks()[0],void 0,VT(8,"track-mix-")),a_(this,"trackList",void 0),a_(this,"destNode",void 0);try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(p){}this.destNode=s,this.trackList=[]}hasAudioTrack(s){return-1!==this.trackList.indexOf(s)}addAudioTrack(s){if(-1!==this.trackList.indexOf(s))return h_.debug("track ".concat(s.getTrackId()," is already added")),void sI("debug",this,"track already added");h_.debug("add ".concat(s.getTrackId()," to mixing track")),S0("debug",this,"addAudioTrack",s.getTrackId()),s._source.outputNode.connect(this.destNode),this.trackList.push(s),this.updateEncoderConfig()}removeAudioTrack(s){if(-1!==this.trackList.indexOf(s)){h_.debug("remove ".concat(s.getTrackId()," from mixing track")),S0("debug",this,"removeAudioTrack",s.getTrackId());try{s._source.outputNode.disconnect(this.destNode)}catch(p){}nG(this.trackList,s),this.updateEncoderConfig()}}updateEncoderConfig(){const s={};this.trackList.forEach(p=>{p._encoderConfig&&((p._encoderConfig.bitrate||0)>(s.bitrate||0)&&(s.bitrate=p._encoderConfig.bitrate),(p._encoderConfig.sampleRate||0)>(s.sampleRate||0)&&(s.sampleRate=p._encoderConfig.sampleRate),(p._encoderConfig.sampleSize||0)>(s.sampleSize||0)&&(s.sampleSize=p._encoderConfig.sampleSize),p._encoderConfig.stereo&&(s.stereo=!0))}),this._encoderConfig=s}})||Kue;class Lve extends sS{constructor(p){super(),a_(this,"name","AudioProcessorDestination"),a_(this,"ID","0"),a_(this,"inputTrack",void 0),a_(this,"inputNode",void 0),a_(this,"audioProcessorContext",void 0),a_(this,"_source",void 0),this.audioProcessorContext=p}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new U_(N_.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new U_(N_.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.emit(tP.ON_TRACK,void 0),this.emit(tP.ON_NODE,void 0)}updateInput(p){if(p.context!==this.audioProcessorContext)throw new Error("ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.\n        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).");p.track&&this.inputTrack!==p.track&&(this.inputTrack=p.track,this.emit(tP.ON_TRACK,this.inputTrack)),p.node&&this.inputNode!==p.node&&(this.inputNode=p.node,this.emit(tP.ON_NODE,this.inputNode))}}class Mve extends sS{constructor(p,A){super(),a_(this,"constraintsMap",new Map),a_(this,"statsRegistry",[]),a_(this,"audioContext",void 0),a_(this,"trackId",void 0),this.audioContext=p,this.trackId=A}getConstraints(){var p=this;return f(function*(){return ZP(p,a2.REQUEST_CONSTRAINTS)})()}getAudioContext(){return this.audioContext}requestApplyConstraints(p,A){var y=this;return f(function*(){var w;return h_.info("processor ".concat(A.name," requestApplyConstraints for ").concat(y.trackId)),p&&y.constraintsMap.set(A,p),wT(y,a2.REQUEST_UPDATE_CONSTRAINTS,Array.from(rP(w=y.constraintsMap).call(w)))})()}requestRevertConstraints(p){var A=this;return f(function*(){var y;if(A.constraintsMap.has(p))return A.constraintsMap.delete(p),wT(A,a2.REQUEST_UPDATE_CONSTRAINTS,Array.from(rP(y=A.constraintsMap).call(y)))})()}registerStats(p,A,y){this.statsRegistry.find(w=>w.processorID===p.ID&&w.processorName===p.name&&w.type===A)||this.statsRegistry.push({processorName:p.name,processorID:p.ID,type:A,cb:y})}unregisterStats(p,A){}gatherStats(){return this.statsRegistry.map(p=>{let{processorID:A,processorName:y,type:w,cb:$}=p;return{processorID:A,processorName:y,type:w,stats:$()}})}}class Yue extends sS{constructor(){super(...arguments),a_(this,"resultStorage",new Map)}setLocalAudioStats(p,A,y){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",p,this.checkAudioInputLevel(y,A)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",p,this.checkSendAudioBitrate(y,A))}setLocalVideoStats(p,A,y){this.record("SEND_VIDEO_BITRATE_TOO_LOW",p,this.checkSendVideoBitrate(y,A)),this.record("FRAMERATE_INPUT_TOO_LOW",p,this.checkFramerateInput(y,A)),this.record("FRAMERATE_SENT_TOO_LOW",p,this.checkFramerateSent(y))}setRemoteAudioStats(p,A){const y=p.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",y,this.checkAudioOutputLevel(A))}setRemoteVideoStats(p,A){const y=p.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",y,this.checkVideoDecode(A))}record(p,A,y){this.resultStorage.has(p)||this.resultStorage.set(p,{result:[],isPrevNormal:!0});const w=this.resultStorage.get(p);if(w&&(w.result.push(y),w.result.length>=5)){const $=w.result.includes(!0);w.isPrevNormal&&!$&&this.emit("exception",wO[p],p,A),!w.isPrevNormal&&$&&this.emit("exception",wO[p]+2e3,p+"_RECOVER",A),w.isPrevNormal=$,w.result=[]}}checkAudioOutputLevel(p){return!(p.receiveBitrate>0&&0===p.receiveLevel)}checkAudioInputLevel(p,A){return A instanceof cP&&!A.isActive||!!A.muted||0!==p.sendVolumeLevel}checkFramerateInput(p,A){let y=null;A._encoderConfig&&A._encoderConfig.frameRate&&(y=jM(A._encoderConfig.frameRate));const w=p.captureFrameRate;return!y||!w||!(y>10&&w<5||y<10&&y>=5&&w<=1)}checkFramerateSent(p){return!(p.captureFrameRate&&p.sendFrameRate&&p.captureFrameRate>5&&p.sendFrameRate<=1)}checkSendVideoBitrate(p,A){return!!A.muted||0!==p.sendBitrate}checkSendAudioBitrate(p,A){return A instanceof cP&&!A.isActive||!!A.muted||0!==p.sendBitrate}checkVideoDecode(p){return 0===p.receiveBitrate||0!==p.decodeFrameRate}}const wO={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},WL=new class{markSubscribeStart(s,p){performance.mark("agora-web-sdk/".concat(s,"/subscribe-").concat(p))}markPublishStart(s,p){performance.mark("agora-web-sdk/".concat(s,"/publish-").concat(p))}measureFromSubscribeStart(s,p){const A=performance.getEntriesByName("agora-web-sdk/".concat(s,"/subscribe-").concat(p));if(A.length>0){const y=A[A.length-1];return Math.round(performance.now()-y.startTime)}return 0}measureFromPublishStart(s,p){const A=performance.getEntriesByName("agora-web-sdk/".concat(s,"/publish-").concat(p));if(A.length>0){const y=A[A.length-1];return Math.round(performance.now()-y.startTime)}return 0}};function lge(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function $Q(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?lge(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):lge(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}class KK{constructor(p){a_(this,"store",void 0),a_(this,"onStatsException",void 0),a_(this,"onUploadPublishDuration",void 0),a_(this,"localStats",new Map),a_(this,"remoteStats",new Map),a_(this,"updateStatsInterval",void 0),a_(this,"trafficStats",void 0),a_(this,"trafficStatsPeerList",[]),a_(this,"uplinkStats",void 0),a_(this,"exceptionMonitor",void 0),a_(this,"p2pChannel",void 0),a_(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=p,this.updateStatsInterval=window.setInterval(this.updateStats,1e3),this.exceptionMonitor=new Yue,this.exceptionMonitor.on("exception",(A,y,w)=>{this.onStatsException&&this.onStatsException(A,y,w)})}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(U0.LocalAudioTrack)||$Q({},AK)}getLocalVideoTrackStats(){return this.localStats.get(U0.LocalVideoTrack)||$Q({},Are)}getRemoteAudioTrackStats(p){const A=($,j)=>{if(!this.trafficStats)return j;const _e=this.trafficStats.peer_delay.find(K=>K.peer_uid===$);return _e&&(j.publishDuration=_e.B_ppad+(Date.now()-this.trafficStats.timestamp)),j},y={};if(p){var w;const $=null===(w=this.remoteStats.get(p))||void 0===w?void 0:w.audioStats;$&&(y[p]=A(p,$))}else Array.from(this.remoteStats.entries()).forEach($=>{let[j,{audioStats:_e}]=$;_e&&(y[j]=A(j,_e))});return y}getRemoteNetworkQualityStats(p){const A={};if(p){var y;const w=null===(y=this.remoteStats.get(p))||void 0===y?void 0:y.networkStats;w&&(A[p]=w)}else Array.from(this.remoteStats.entries()).forEach(w=>{let[$,{networkStats:j}]=w;j&&(A[$]=j)});return A}getRemoteVideoTrackStats(p){const A=($,j)=>{if(!this.trafficStats)return j;const _e=this.trafficStats.peer_delay.find(K=>K.peer_uid===$);return _e&&(j.publishDuration=_e.B_ppvd+(Date.now()-this.trafficStats.timestamp)),j},y={};if(p){var w;const $=null===(w=this.remoteStats.get(p))||void 0===w?void 0:w.videoStats;$&&(y[p]=A(p,$))}else Array.from(this.remoteStats.entries()).forEach($=>{let[j,{videoStats:_e}]=$;_e&&(y[j]=A(j,_e))});return y}getRTCStats(){let p=0,A=0,y=0,w=0;const $=this.localStats.get(U0.LocalAudioTrack);$&&(p+=$.sendBytes,A+=$.sendBitrate);const j=this.localStats.get(U0.LocalVideoTrack);j&&(p+=j.sendBytes,A+=j.sendBitrate);const _e=this.localStats.get(U0.LocalVideoLowTrack);_e&&(p+=_e.sendBytes,A+=_e.sendBitrate),this.remoteStats.forEach(_i=>{let{audioStats:_o,videoStats:_u}=_i;_o&&(y+=_o.receiveBytes,w+=_o.receiveBitrate),_u&&(y+=_u.receiveBytes,w+=_u.receiveBitrate)});let K=1;return this.trafficStats&&(K+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:K,SendBitrate:A,SendBytes:p,RecvBytes:y,RecvBitrate:w,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(p){this.localStats.set(p,void 0)}removeLocalStats(p){p?this.localStats.delete(p):this.localStats.clear()}addRemoteStats(p){this.remoteStats.set(p,{})}removeRemoteStats(p){p?this.remoteStats.delete(p):this.remoteStats.clear()}addP2PChannel(p){this.p2pChannel=p}updateTrafficStats(p){p.peer_delay=p.peer_delay.filter(A=>void 0!==A.B_ppad||void 0!==A.B_ppvd),p.peer_delay.filter(A=>-1===this.trafficStatsPeerList.indexOf(A.peer_uid)).forEach(A=>{var y;const w=null===(y=this.p2pChannel)||void 0===y?void 0:y.getRemoteMedia(A.peer_uid),$=null!=w&&w.videoSSRC?WL.measureFromSubscribeStart(this.store.clientId,w.videoSSRC):0,j=null!=w&&w.audioSSRC?WL.measureFromSubscribeStart(this.store.clientId,w.audioSSRC):0;void 0!==A.B_ppad&&void 0!==A.B_ppvd&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(A.peer_uid,A.B_ppad,A.B_ppvd,$>j?$:j),this.trafficStatsPeerList.push(A.peer_uid))}),this.trafficStats=p}updateUplinkStats(p){this.uplinkStats&&this.uplinkStats.B_fir!==p.B_fir&&h_.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(p.B_fir)),this.uplinkStats=p}static isRemoteVideoFreeze(p,A,y){return!!p&&(!!y&&A.framesDecodeFreezeTime>y.framesDecodeFreezeTime||!(!y||A.framesDecodeCount>y.framesDecodeCount))}static isRemoteAudioFreeze(p){return!!p&&p._isFreeze()}isLocalVideoFreeze(p){return!(!p.inputFrame||!p.sentFrame)&&p.inputFrame.frameRate>5&&p.sentFrame.frameRate<3}updateLocalStats(p){Array.from(this.localStats.entries()).forEach(A=>{let[y,w]=A;switch(y){case U0.LocalVideoTrack:case U0.LocalVideoLowTrack:{const $=w,j=$Q({},Are),_e=p.getStats(),K=p.getLocalMedia(y);if(_e){const _i=_e.videoSend.find(_o=>_o.ssrc===(null==K?void 0:K.ssrcs[0].ssrcId));if(_i){const _o=p.getLocalVideoSize(),_u=p.getEncoderConfig(U0.LocalVideoTrack);"H264"!==_i.codec&&"VP8"!==_i.codec&&"VP9"!==_i.codec&&"AV1X"!==_i.codec&&"AV1"!==_i.codec||(j.codecType=_i.codec),j.sendBytes=_i.bytes,j.sendBitrate=$?8*Math.max(0,j.sendBytes-$.sendBytes):0,_i.inputFrame?(j.captureFrameRate=_i.inputFrame.frameRate,j.captureResolutionHeight=_i.inputFrame.height,j.captureResolutionWidth=_i.inputFrame.width):_o&&(j.captureResolutionWidth=_o.width,j.captureResolutionHeight=_o.height),_i.sentFrame?(j.sendFrameRate=_i.sentFrame.frameRate,j.sendResolutionHeight=_i.sentFrame.height,j.sendResolutionWidth=_i.sentFrame.width):_o&&(j.sendResolutionWidth=_o.width,j.sendResolutionHeight=_o.height),_i.avgEncodeMs&&(j.encodeDelay=_i.avgEncodeMs),_u&&_u.bitrateMax&&(j.targetSendBitrate=1e3*_u.bitrateMax),j.sendPackets=_i.packets,j.sendPacketsLost=_i.packetsLost,j.totalDuration=$?$.totalDuration+1:1,j.totalFreezeTime=$?$.totalFreezeTime:0,this.isLocalVideoFreeze(_i)&&(j.totalFreezeTime+=1)}this.trafficStats&&(j.sendPacketsLost=this.trafficStats.B_pvlr4/100)}this.localStats.set(y,j),j&&K&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,K.track,j);break}case U0.LocalAudioTrack:{const $=w,j=$Q({},AK),_e=p.getStats(),K=p.getLocalMedia(y);if(_e){const _i=_e.audioSend.find(_o=>_o.ssrc===(null==K?void 0:K.ssrcs[0].ssrcId));if(_i){if("opus"!==_i.codec&&"aac"!==_i.codec&&"PCMU"!==_i.codec&&"PCMA"!==_i.codec&&"G722"!==_i.codec||(j.codecType=_i.codec),_i.inputLevel)j.sendVolumeLevel=Math.round(32767*_i.inputLevel);else{const _o=p.getLocalAudioVolume();_o&&(j.sendVolumeLevel=Math.round(32767*_o))}j.sendBytes=_i.bytes,j.sendPackets=_i.packets,j.sendPacketsLost=_i.packetsLost,j.sendBitrate=$?8*Math.max(0,j.sendBytes-$.sendBytes):0}}this.trafficStats&&(j.sendPacketsLost=this.trafficStats.B_pvlr4/100),this.localStats.set(U0.LocalAudioTrack,j),j&&K&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,K.track,j);break}}})}updateRemoteStats(p){Array.from(this.remoteStats.entries()).forEach(A=>{let[y,{videoStats:w,audioStats:$,videoPcStats:j}]=A;const _e=$,K=w,_i=j,_o=$Q({},_re),_u=$Q({},Cce),ch=$Q({},Ffe),{audioTrack:_f,videoTrack:o_,audioSSRC:i_,videoSSRC:u_}=p.getRemoteMedia(y),g_=p.getStats(),__=null==g_?void 0:g_.audioRecv.find(Rv=>Rv.ssrc===i_),w_=null==g_?void 0:g_.videoRecv.find(Rv=>Rv.ssrc===u_),k_=this.trafficStats&&this.trafficStats.peer_delay.find(Rv=>Rv.peer_uid===y);if(__&&("opus"!==__.codec&&"aac"!==__.codec&&"PCMU"!==__.codec&&"PCMA"!==__.codec&&"G722"!==__.codec||(_o.codecType=__.codec),__.outputLevel?_o.receiveLevel=Math.round(32767*__.outputLevel):_f&&(_o.receiveLevel=Math.round(32767*_f.getVolumeLevel())),_o.receiveBytes=__.bytes,_o.receivePackets=__.packets,_o.receivePacketsLost=__.packetsLost,_o.packetLossRate=_o.receivePacketsLost/(_o.receivePackets+_o.receivePacketsLost),_o.receiveBitrate=_e?8*Math.max(0,_o.receiveBytes-_e.receiveBytes):0,_o.totalDuration=_e?_e.totalDuration+1:1,_o.totalFreezeTime=_e?_e.totalFreezeTime:0,_o.freezeRate=_o.totalFreezeTime/_o.totalDuration,_o.receiveDelay=__.jitterBufferMs,_o.totalDuration>10&&KK.isRemoteAudioFreeze(_f)&&(_o.totalFreezeTime+=1)),w_){"H264"!==w_.codec&&"VP8"!==w_.codec&&"VP9"!==w_.codec&&"AV1X"!==w_.codec&&"AV1"!==w_.codec||(_u.codecType=w_.codec),_u.receiveBytes=w_.bytes,_u.receiveBitrate=K?8*Math.max(0,_u.receiveBytes-K.receiveBytes):0,_u.decodeFrameRate=w_.decodeFrameRate<0?0:w_.decodeFrameRate,_u.renderFrameRate=w_.decodeFrameRate<0?0:w_.decodeFrameRate,w_.outputFrame&&(_u.renderFrameRate=w_.outputFrame.frameRate),w_.receivedFrame?(_u.receiveFrameRate=w_.receivedFrame.frameRate,_u.receiveResolutionHeight=w_.receivedFrame.height,_u.receiveResolutionWidth=w_.receivedFrame.width):o_&&(_u.receiveResolutionHeight=o_._videoHeight||0,_u.receiveResolutionWidth=o_._videoWidth||0),void 0!==w_.framesRateFirefox&&(_u.receiveFrameRate=Math.round(w_.framesRateFirefox)),_u.receivePackets=w_.packets,_u.receivePacketsLost=w_.packetsLost,_u.packetLossRate=_u.receivePacketsLost/(_u.receivePackets+_u.receivePacketsLost),_u.totalDuration=K?K.totalDuration+1:1,_u.totalFreezeTime=K?K.totalFreezeTime:0,_u.receiveDelay=w_.jitterBufferMs||0;const Rv=!!u_&&p.getRemoteVideoIsReady(u_);o_&&Rv&&KK.isRemoteVideoFreeze(o_,w_,_i)&&(_u.totalFreezeTime+=1),_u.freezeRate=_u.totalFreezeTime/_u.totalDuration}k_&&(_o.end2EndDelay=k_.B_ad,_u.end2EndDelay=k_.B_vd,_o.transportDelay=k_.B_ed,_u.transportDelay=k_.B_ed,_o.currentPacketLossRate=k_.B_ealr4/100,_u.currentPacketLossRate=k_.B_evlr4/100,ch.uplinkNetworkQuality=k_.B_punq?k_.B_punq:0,ch.downlinkNetworkQuality=k_.B_pdnq?k_.B_pdnq:0),this.remoteStats.set(y,{audioStats:_o,videoStats:_u,videoPcStats:w_,networkStats:ch}),_f&&this.exceptionMonitor.setRemoteAudioStats(_f,_o),o_&&this.exceptionMonitor.setRemoteVideoStats(o_,_u)})}}function dge(s){return(new TextEncoder).encode(s)}const Bve=function(){var s=f(function*(p){return function(A,y){let w="";return new Uint8Array(A).forEach($=>{w+=$.toString(16).padStart(2,"0")}),w}(yield crypto.subtle.digest("SHA-256",dge(p)))});return function(A){return s.apply(this,arguments)}}();function die(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function cX(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?die(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):die(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}function hge(s){if(!s.address||!s.tcp)throw new U_(N_.UNEXPECTED_RESPONSE,"Invalid address format ".concat(s));return s.address.match(/^[\.\:\d]+$/)?"".concat(s.address.replace(/[^\d]/g,"-"),".edge.agora.io"):(h_.info("Cannot recognized as IP address ".concat(s.address,". Used As Host instead")),"".concat(s.address,":").concat(s.tcp))}function uX(s){return s.match(/^[\.\:\d]+$/)?"".concat(s.replace(/[^\d]/g,"-"),".").concat(v0("TURN_DOMAIN")):(h_.info("Cannot recognized as IP address ".concat(s,". Used As Host instead")),s)}function lX(s,p){const A=v0("GATEWAY_DOMAINS");let y=A[1]&&-1!==p.indexOf(A[1])?1:0;return s.addresses=s.addresses||[],{gatewayAddrs:s.addresses.map(w=>w.domain_prefix?{address:"".concat(w.domain_prefix,".").concat(A[y++%A.length],":").concat(w.port)}:w.ip.match(/^[\.\:\d]+$/)?{ip:w.ip,port:w.port,address:"".concat(w.ip.replace(/[^\d]/g,"-"),".").concat(A[y++%A.length],":").concat(w.port)}:(h_.info("Cannot recognized as IP address ".concat(w.ip,". Used As Host instead")),{ip:w.ip,port:w.port,address:"".concat(w.ip,":").concat(w.port)})),uid:s.uid,cid:s.cid,vid:s.detail&&s.detail[8],uni_lbs_ip:s.detail&&s.detail[1],res:s,csIp:s.detail&&s.detail[502]}}function jM(s){return"number"==typeof s?s:s.exact||s.ideal||s.max||s.min||0}function dX(s){const p=s._encoderConfig;if(!p)return{};const A={resolution:p.width&&p.height?"".concat(jM(p.width),"x").concat(jM(p.height)):void 0,maxVideoBW:p.bitrateMax,minVideoBW:p.bitrateMin};return"number"==typeof p.frameRate?(A.maxFrameRate=p.frameRate,A.minFrameRate=p.frameRate):p.frameRate&&(A.maxFrameRate=p.frameRate.max||p.frameRate.ideal||p.frameRate.exact||p.frameRate.min,A.minFrameRate=p.frameRate.min||p.frameRate.ideal||p.frameRate.exact||p.frameRate.max),A}function hie(s,p,A){var y;const w=p.videoSend.find(_e=>_e.ssrc===s);if(!w)return null;const $=null==A||null===(y=A.videoSend.find(_e=>_e.ssrc===s))||void 0===y?void 0:y.inputFrame,j={id:VT(10,""),timestamp:new Date(p.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:w.ssrc.toString()};return w.inputFrame&&($&&w.inputFrame.height===$.height||(j.A_fhi=w.inputFrame.height?w.inputFrame.height.toString():"0"),$&&w.inputFrame.width===$.width||(j.A_fwi=w.inputFrame.width?w.inputFrame.width.toString():"0"),$&&w.inputFrame.frameRate===$.frameRate||(j.A_fri=w.inputFrame.frameRate?w.inputFrame.frameRate.toString():"0")),j}function fie(s){return s>=0&&s<.17?1:s>=.17&&s<.36?2:s>=.36&&s<.59?3:s>=.59&&s<=1?4:s>1?5:0}function hX(s,p){let A,y,w;switch(p){case AS.CHOOSE_SERVER:A=4096,y="choose server";break;case AS.CLOUD_PROXY:A=1048576,y="proxy";break;case AS.CLOUD_PROXY_5:A=4194304,y="proxy5";break;case AS.CLOUD_PROXY_FALLBACK:A=4194310,y="proxy fallback";break;default:throw new U_(N_.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:s.detail&&s.detail[502],retry:!1})}if(s.response_body.forEach($=>{$.buffer&&$.buffer.flag===A&&(w={code:$.buffer.code,addresses:($.buffer.edges_services||[]).map(j=>cX(cX({},j),{},{ticket:$.buffer.cert})),server_ts:s.enter_ts,uid:$.buffer.uid,cid:$.buffer.cid,cname:$.buffer.cname,detail:cX(cX({},$.buffer.detail),s.detail),flag:$.buffer.flag,opid:s.opid})}),!w)throw new U_(N_.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(y," from multi unilbs response"),{csIp:s.detail&&s.detail[502]});return w}function fge(s,p){return Jue.apply(this,arguments)}function Jue(){return Jue=f(function*(s,p){return yield iI.all(s.addresses.map(function(){var A=f(function*(y){return{address:uX(y.ip),tcpport:y.port,udpport:y.port,username:p&&v0("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?p.toString():aS.username,password:p&&v0("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?yield Bve(p.toString()):aS.password}});return function(y){return A.apply(this,arguments)}}()))}),Jue.apply(this,arguments)}function pge(s,p){const A=p._videoHeight||p.getMediaStreamTrack(!0).getSettings().height;return A?A/jM(s.height):4}function tG(s){let{candidateType:p,relayProtocol:A,type:y,address:w,port:$,protocol:j}=s;return"local-candidate"===y?{candidateType:p,relayProtocol:A,protocol:j}:{candidateType:p,relayProtocol:A,address:w,port:$,protocol:j}}function gge(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function ZQ(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?gge(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):gge(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}function XQ(s){return window.TextEncoder?(new TextEncoder).encode(s).length:s.length}function pR(s){return new iI(p=>{window.setTimeout(p,s)})}function fX(s){const p=new U_(N_.TIMEOUT,"timeout");return new iI((A,y)=>{window.setTimeout(()=>y(p),s)})}function VT(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,p=arguments.length>1?arguments[1]:void 0;const A=Math.random().toString(16).substr(2,s).toLowerCase();return A.length===s?"".concat(p).concat(A):"".concat(p).concat(A)+VT(s-A.length,"")}function $ue(){return VT(32,"").toUpperCase()}const pie=()=>{};function mge(s){return new iI((p,A)=>{let y=!1;const w=document.createElement("video");w.setAttribute("autoplay",""),w.setAttribute("muted",""),w.muted=!0,w.autoplay=!0,w.setAttribute("playsinline",""),w.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(w);const $=r2()?"canplay":"playing";w.addEventListener($,()=>{const j=w.videoWidth,_e=w.videoHeight;!j&&X2()||(y=!0,w.srcObject=null,w.remove(),p([j,_e]))}),w.srcObject=new MediaStream([s]),w.play().catch(pie),setTimeout(()=>{y||(w.srcObject=null,w.remove(),p([w.videoWidth,w.videoHeight]))},4e3)})}function e9(s){return iI.all(s.map(p=>p.then(A=>{throw A},A=>A))).then(p=>{throw p},p=>p)}function ZP(s,p){for(var A=arguments.length,y=new Array(A>2?A-2:0),w=2;w<A;w++)y[w-2]=arguments[w];return 0===s.getListeners(p).length?iI.reject(new U_(N_.UNEXPECTED_ERROR,"can not emit promise")):new iI(($,j)=>{s.emit(p,...y,$,j)})}function wT(s,p){if(0===s.getListeners(p).length)return iI.resolve();for(var A=arguments.length,y=new Array(A>2?A-2:0),w=2;w<A;w++)y[w-2]=arguments[w];return ZP(s,p,...y)}function o3(s,p){if(0===s.getListeners(p).length)return null;for(var A=arguments.length,y=new Array(A>2?A-2:0),w=2;w<A;w++)y[w-2]=arguments[w];return zK(s,p,...y)}function zK(s,p){let A=null,y=null;for(var w=arguments.length,$=new Array(w>2?w-2:0),j=2;j<w;j++)$[j-2]=arguments[j];if(s.emit(p,...$,_e=>{A=_e},_e=>{y=_e}),null!==y)throw y;if(null===A)throw new U_(N_.UNEXPECTED_ERROR,"handler is not sync");return A}function nG(s,p){const A=s.indexOf(p);-1!==A&&s.splice(A,1)}function gie(s){const p=[];return s.forEach(A=>{-1===p.indexOf(A)&&p.push(A)}),p}function d2(s){iI.resolve().then(s)}function jS(s){return JSON.parse(JSON.stringify(s))}const mie={};function YK(s,p){mie[p]||(mie[p]=!0,s())}function pX(s){const p=window.atob(s),A=new Uint8Array(new ArrayBuffer(p.length));for(let y=0;y<p.length;y+=1)A[y]=p.charCodeAt(y);return A}function JK(s){let p="";for(let A=0;A<s.length;A+=1)p+=String.fromCharCode(s[A]);return window.btoa(p)}const G6=new class{constructor(){a_(this,"fnMap",new Map)}throttleByKey(s,p,A,y){for(var w=arguments.length,$=new Array(w>4?w-4:0),j=4;j<w;j++)$[j-4]=arguments[j];if(this.fnMap.has(p)){const _e=this.fnMap.get(p);if(_e.threshold!==A){_e.fn(..._e.args),clearTimeout(_e.timer);const K=window.setTimeout(()=>{const _i=this.fnMap.get(p);_i&&_i.fn(..._i.args),this.fnMap.delete(p)},A);this.fnMap.set(p,{fn:s,threshold:A,timer:K,args:$,skipFn:y})}else _e.skipFn&&_e.skipFn(..._e.args),this.fnMap.set(p,ZQ(ZQ({},_e),{},{fn:s,args:$,skipFn:y}))}else{const _e=window.setTimeout(()=>{const K=this.fnMap.get(p);K&&K.fn(...K.args),this.fnMap.delete(p)},A);this.fnMap.set(p,{fn:s,threshold:A,timer:_e,args:$,skipFn:y})}}},Zue=G6.throttleByKey.bind(G6),t9=function(){var s=f(function*(p){let{fragementLength:A,referenceList:y,asyncMapHandler:w,allFailedhandler:$,promisesCollector:j}=p,_e=0;const K=A;let _i,_o=0;const _u=function(){var ch=f(function*(){const _f=(()=>{const o_=_e*K;return y.slice(o_,o_+K).map(w)})();j&&j.push(..._f);try{_i=yield e9(_f)}catch(o_){if(_o+=K,_e++,!(_o>=y.length))return void(yield _u());$(o_)}_f.forEach(o_=>o_.cancel())});return function(){return ch.apply(this,arguments)}}();return yield _u(),_i});return function(A){return s.apply(this,arguments)}}();function Aie(s){return"object"==typeof s&&null!==s&&!(s instanceof RegExp)}var Uve=OT,Xue=PS("iterator"),Age=!Uve(function(){var s=new URL("b?a=1&b=2&c=3","http://a"),p=s.searchParams,A="";return s.pathname="c%20d",p.forEach(function(y,w){p.delete("b"),A+=w+y}),!s.toJSON||!p.sort||"http://a/c%20d?a=1&c=3"!==s.href||"3"!==p.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!p[Xue]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://\u0442\u0435\u0441\u0442").host||"#%D0%B1"!==new URL("http://a#\u0431").hash||"a1c3"!==A||"x"!==new URL("http://x",void 0).host}),_ie=B2,ele=AO,_ge=OT,rG=f8,tle=O7,Fve=H9,jve=bM,vge=K9,n9=Object.assign,yge=Object.defineProperty,nle=rT([].concat),Vve=!n9||_ge(function(){if(_ie&&1!==n9({b:1},n9(yge({},"a",{enumerable:!0,get:function(){yge(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var s={},p={},A=Symbol(),y="abcdefghijklmnopqrst";return s[A]=7,y.split("").forEach(function(w){p[w]=w}),7!=n9({},s)[A]||rG(n9({},p)).join("")!=y})?function(s,p){for(var A=jve(s),y=arguments.length,w=1,$=tle.f,j=Fve.f;y>w;)for(var _e,K=vge(arguments[w++]),_i=$?nle(rG(K),$(K)):rG(K),_o=_i.length,_u=0;_o>_u;)_e=_i[_u++],_ie&&!ele(j,K,_e)||(A[_e]=K[_e]);return A}:n9,rle=KN,Gve=U7,ile=CM,Qve=AO,ole=bM,Ege=function(s,p,A,y){try{return y?p(rle(A)[0],A[1]):p(A)}catch(w){Gve(s,"throw",w)}},sle=$H,ale=RW,cle=wM,r9=QO,iG=MU,ule=eW,i9=n1.Array,VM=rT,yie=2147483647,$K=/[^\0-\u007E]/,Ige=/[.\u3002\uFF0E\uFF61]/g,bge="Overflow: input needs wider integers to process",Eie=n1.RangeError,lle=VM(Ige.exec),oG=Math.floor,gX=String.fromCharCode,Cge=VM("".charCodeAt),wge=VM([].join),K4=VM([].push),dle=VM("".replace),Hve=VM("".split),Tge=VM("".toLowerCase),Sge=function(s){return s+22+75*(s<26)},Rge=function(s,p,A){var y=0;for(s=A?oG(s/700):s>>1,s+=oG(s/p);s>455;)s=oG(s/35),y+=36;return oG(y+36*s/(s+38))},Oge=function(s){var p,A,y=[],w=(s=function(g_){for(var __=[],w_=0,k_=g_.length;w_<k_;){var Rv=Cge(g_,w_++);if(Rv>=55296&&Rv<=56319&&w_<k_){var f0=Cge(g_,w_++);56320==(64512&f0)?K4(__,((1023&Rv)<<10)+(1023&f0)+65536):(K4(__,Rv),w_--)}else K4(__,Rv)}return __}(s)).length,$=128,j=0,_e=72;for(p=0;p<s.length;p++)(A=s[p])<128&&K4(y,gX(A));var K=y.length,_i=K;for(K&&K4(y,"-");_i<w;){var _o=yie;for(p=0;p<s.length;p++)(A=s[p])>=$&&A<_o&&(_o=A);var _u=_i+1;if(_o-$>oG((yie-j)/_u))throw Eie(bge);for(j+=(_o-$)*_u,$=_o,p=0;p<s.length;p++){if((A=s[p])<$&&++j>yie)throw Eie(bge);if(A==$){for(var ch=j,_f=36;;){var o_=_f<=_e?1:_f>=_e+26?26:_f-_e;if(ch<o_)break;var i_=ch-o_,u_=36-o_;K4(y,gX(Sge(o_+i_%u_))),ch=oG(i_/u_),_f+=36}K4(y,gX(Sge(ch))),_e=Rge(j,_u,_i==K),j=0,_i++}}j++,$++}return wge(y,"")},Dge=n1.TypeError,Iie=xS,bie=n1,hle=EL,Cie=AO,z4=rT,wie=Age,Tie=Y2,fle=xte,qve=VU,ple=KP,gle=r6,Sie=u6,Rie=MT,mle=cN,Nge=CM,Wve=LU,Ale=KN,kge=F2,uP=OL,Kve=_4,Oie=U2,_le=MU,vle=eW,sG=function(s,p){if(s<p)throw Dge("Not enough arguments");return s},yle=lre,ZK=PS("iterator"),mX="URLSearchParams",Die="URLSearchParamsIterator",Pge=gle.set,KL=gle.getterFor(mX),Q6=gle.getterFor(Die),Nie=hle("fetch"),kie=hle("Request"),o9=hle("Headers"),Ele=kie&&kie.prototype,xge=o9&&o9.prototype,Ile=bie.RegExp,zve=bie.TypeError,Pie=bie.decodeURIComponent,Yve=bie.encodeURIComponent,ble=z4("".charAt),Lge=z4([].join),H6=z4([].push),xie=z4("".replace),Cle=z4([].shift),wle=z4([].splice),Mge=z4("".split),Jve=z4("".slice),Tle=/\+/g,Bge=Array(4),Sle=function(s){return Bge[s-1]||(Bge[s-1]=Ile("((?:%[\\da-f]{2}){"+s+"})","gi"))},Rle=function(s){try{return Pie(s)}catch(p){return s}},Lie=function(s){var p=xie(s,Tle," "),A=4;try{return Pie(p)}catch(y){for(;A;)p=xie(p,Sle(A--),Rle);return p}},$ve=/[!'()~]|%20/g,Uge={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Fge=function(s){return Uge[s]},jge=function(s){return xie(Yve(s),$ve,Fge)},AX=ple(function(s,p){Pge(this,{type:Die,iterator:_le(KL(s).entries),kind:p})},"Iterator",function(){var s=Q6(this),p=s.kind,A=s.iterator.next(),y=A.value;return A.done||(A.value="keys"===p?y.key:"values"===p?y.value:[y.key,y.value]),A},!0),Ole=function(s){this.entries=[],this.url=null,void 0!==s&&(kge(s)?this.parseObject(s):this.parseQuery("string"==typeof s?"?"===ble(s,0)?Jve(s,1):s:uP(s)))};Ole.prototype={type:mX,bindURL:function(s){this.url=s,this.update()},parseObject:function(s){var p,A,y,w,$,j,_e,K=vle(s);if(K)for(A=(p=_le(s,K)).next;!(y=Cie(A,p)).done;){if($=(w=_le(Ale(y.value))).next,(j=Cie($,w)).done||(_e=Cie($,w)).done||!Cie($,w).done)throw zve("Expected sequence with length 2");H6(this.entries,{key:uP(j.value),value:uP(_e.value)})}else for(var _i in s)mle(s,_i)&&H6(this.entries,{key:_i,value:uP(s[_i])})},parseQuery:function(s){if(s)for(var p,A,y=Mge(s,"&"),w=0;w<y.length;)(p=y[w++]).length&&(A=Mge(p,"="),H6(this.entries,{key:Lie(Cle(A)),value:Lie(Lge(A,"="))}))},serialize:function(){for(var s,p=this.entries,A=[],y=0;y<p.length;)s=p[y++],H6(A,jge(s.key)+"="+jge(s.value));return Lge(A,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var s9=function(){Sie(this,_X),Pge(this,new Ole(arguments.length>0?arguments[0]:void 0))},_X=s9.prototype;if(fle(_X,{append:function(s,p){sG(arguments.length,2);var A=KL(this);H6(A.entries,{key:uP(s),value:uP(p)}),A.updateURL()},delete:function(s){sG(arguments.length,1);for(var p=KL(this),A=p.entries,y=uP(s),w=0;w<A.length;)A[w].key===y?wle(A,w,1):w++;p.updateURL()},get:function(s){sG(arguments.length,1);for(var p=KL(this).entries,A=uP(s),y=0;y<p.length;y++)if(p[y].key===A)return p[y].value;return null},getAll:function(s){sG(arguments.length,1);for(var p=KL(this).entries,A=uP(s),y=[],w=0;w<p.length;w++)p[w].key===A&&H6(y,p[w].value);return y},has:function(s){sG(arguments.length,1);for(var p=KL(this).entries,A=uP(s),y=0;y<p.length;)if(p[y++].key===A)return!0;return!1},set:function(s,p){sG(arguments.length,1);for(var A,y=KL(this),w=y.entries,$=!1,j=uP(s),_e=uP(p),K=0;K<w.length;K++)(A=w[K]).key===j&&($?wle(w,K--,1):($=!0,A.value=_e));$||H6(w,{key:j,value:_e}),y.updateURL()},sort:function(){var s=KL(this);yle(s.entries,function(p,A){return p.key>A.key?1:-1}),s.updateURL()},forEach:function(s){for(var p,A=KL(this).entries,y=Nge(s,arguments.length>1?arguments[1]:void 0),w=0;w<A.length;)y((p=A[w++]).value,p.key,this)},keys:function(){return new AX(this,"keys")},values:function(){return new AX(this,"values")},entries:function(){return new AX(this,"entries")}},{enumerable:!0}),Tie(_X,ZK,_X.entries,{name:"entries"}),Tie(_X,"toString",function(){return KL(this).serialize()},{enumerable:!0}),qve(s9,mX),Iie({global:!0,forced:!wie},{URLSearchParams:s9}),!wie&&Rie(o9)){var Zve=z4(xge.has),Xve=z4(xge.set),Vge=function(s){if(kge(s)){var p,A=s.body;if(Wve(A)===mX)return p=s.headers?new o9(s.headers):new o9,Zve(p,"content-type")||Xve(p,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Kve(s,{body:Oie(0,uP(A)),headers:Oie(0,p)})}return s};if(Rie(Nie)&&Iie({global:!0,enumerable:!0,forced:!0},{fetch:function(s){return Nie(s,arguments.length>1?Vge(arguments[1]):{})}}),Rie(kie)){var Mie=function(s){return Sie(this,Ele),new kie(s,arguments.length>1?Vge(arguments[1]):{})};Ele.constructor=Mie,Mie.prototype=Ele,Iie({global:!0,forced:!0},{Request:Mie})}}var XP,Dle=xS,vX=B2,Nle=Age,XK=n1,Bie=CM,zL=rT,kle=D7.f,yX=Y2,Ple=u6,cG=cN,EX=Vve,_z=function(s){var p=ole(s),A=ale(this),y=arguments.length,w=y>1?arguments[1]:void 0,$=void 0!==w;$&&(w=ile(w,y>2?arguments[2]:void 0));var j,_e,K,_i,_o,_u,ch=ule(p),_f=0;if(!ch||this==i9&&sle(ch))for(j=cle(p),_e=A?new this(j):i9(j);j>_f;_f++)_u=$?w(p[_f],_f):p[_f],r9(_e,_f,_u);else for(_o=(_i=iG(p,ch)).next,_e=A?new this:[];!(K=Qve(_o,_i)).done;_f++)_u=$?Ege(_i,w,[K.value,_f],!0):K.value,r9(_e,_f,_u);return _e.length=_f,_e},s3=cre,eye=Qse.codeAt,q6=OL,Hge=VU,qge={URLSearchParams:s9,getState:KL},tye=r6.set,Uie=r6.getterFor("URL"),Kge=qge.URLSearchParams,xle=qge.getState,eY=XK.URL,Fie=XK.TypeError,IX=XK.parseInt,jie=Math.floor,tT=Math.pow,YL=zL("".charAt),GM=zL(/./.exec),W6=zL([].join),nye=zL(1..toString),vS=zL([].pop),MR=zL([].push),a3=zL("".replace),zge=zL([].shift),rye=zL("".split),uG=zL("".slice),bX=zL("".toLowerCase),Yge=zL([].unshift),Lle="Invalid scheme",K6="Invalid host",Jge="Invalid port",$ge=/[a-z]/i,VS=/[\d+-.a-z]/i,Zge=/\d/,AEe=/^0x/i,uO=/^[0-7]+$/,Xge=/^\d+$/,eme=/^[\da-f]+$/i,iye=/[\0\t\n\r #%/:<>?@[\\\]^|]/,tme=/[\0\t\n\r #/:<>?@[\\\]^|]/,oye=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,sye=/[\t\n\r]/g,CX=function(s){var p,A,y,w;if("number"==typeof s){for(p=[],A=0;A<4;A++)Yge(p,s%256),s=jie(s/256);return W6(p,".")}if("object"==typeof s){for(p="",y=function($){for(var j=null,_e=1,K=null,_i=0,_o=0;_o<8;_o++)0!==$[_o]?(_i>_e&&(j=K,_e=_i),K=null,_i=0):(null===K&&(K=_o),++_i);return _i>_e&&(j=K,_e=_i),j}(s),A=0;A<8;A++)w&&0===s[A]||(w&&(w=!1),y===A?(p+=A?":":"::",w=!0):(p+=nye(s[A],16),A<7&&(p+=":")));return"["+p+"]"}return s},Vie={},aye=EX({},Vie,{" ":1,'"':1,"<":1,">":1,"`":1}),nme=EX({},aye,{"#":1,"?":1,"{":1,"}":1}),Mle=EX({},nme,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),z6=function(s,p){var A=eye(s,0);return A>32&&A<127&&!cG(p,s)?s:encodeURIComponent(s)},QM={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Gie=function(s,p){var A;return 2==s.length&&GM($ge,YL(s,0))&&(":"==(A=YL(s,1))||!p&&"|"==A)},c3=function(s){var p;return s.length>1&&Gie(uG(s,0,2))&&(2==s.length||"/"===(p=YL(s,2))||"\\"===p||"?"===p||"#"===p)},a9=function(s){return"."===s||"%2e"===bX(s)},tY={},rme={},Ble={},Ule={},Fle={},nY={},ime={},lG={},c9={},dG={},Qie={},wX={},jle={},Vle={},ome={},TX={},hG={},u3={},fG={},pG={},Y4={},SX=function(s,p,A){var y,w,$,j=q6(s);if(p){if(w=this.parse(j))throw Fie(w);this.searchParams=null}else{if(void 0!==A&&(y=new SX(A,!0)),w=this.parse(j,null,y))throw Fie(w);($=xle(new Kge)).bindURL(this),this.searchParams=$}};SX.prototype={type:"URL",parse:function(s,p,A){var y,w,$,j,_e,K=this,_i=p||tY,_o=0,_u="",ch=!1,_f=!1,o_=!1;for(s=q6(s),p||(K.scheme="",K.username="",K.password="",K.host=null,K.port=null,K.path=[],K.query=null,K.fragment=null,K.cannotBeABaseURL=!1,s=a3(s,oye,"")),s=a3(s,sye,""),y=_z(s);_o<=y.length;){switch(w=y[_o],_i){case tY:if(!w||!GM($ge,w)){if(p)return Lle;_i=Ble;continue}_u+=bX(w),_i=rme;break;case rme:if(w&&(GM(VS,w)||"+"==w||"-"==w||"."==w))_u+=bX(w);else{if(":"!=w){if(p)return Lle;_u="",_i=Ble,_o=0;continue}if(p&&(K.isSpecial()!=cG(QM,_u)||"file"==_u&&(K.includesCredentials()||null!==K.port)||"file"==K.scheme&&!K.host))return;if(K.scheme=_u,p)return void(K.isSpecial()&&QM[K.scheme]==K.port&&(K.port=null));_u="","file"==K.scheme?_i=Vle:K.isSpecial()&&A&&A.scheme==K.scheme?_i=Ule:K.isSpecial()?_i=lG:"/"==y[_o+1]?(_i=Fle,_o++):(K.cannotBeABaseURL=!0,MR(K.path,""),_i=fG)}break;case Ble:if(!A||A.cannotBeABaseURL&&"#"!=w)return Lle;if(A.cannotBeABaseURL&&"#"==w){K.scheme=A.scheme,K.path=s3(A.path),K.query=A.query,K.fragment="",K.cannotBeABaseURL=!0,_i=Y4;break}_i="file"==A.scheme?Vle:nY;continue;case Ule:if("/"!=w||"/"!=y[_o+1]){_i=nY;continue}_i=c9,_o++;break;case Fle:if("/"==w){_i=dG;break}_i=u3;continue;case nY:if(K.scheme=A.scheme,w==XP)K.username=A.username,K.password=A.password,K.host=A.host,K.port=A.port,K.path=s3(A.path),K.query=A.query;else if("/"==w||"\\"==w&&K.isSpecial())_i=ime;else if("?"==w)K.username=A.username,K.password=A.password,K.host=A.host,K.port=A.port,K.path=s3(A.path),K.query="",_i=pG;else{if("#"!=w){K.username=A.username,K.password=A.password,K.host=A.host,K.port=A.port,K.path=s3(A.path),K.path.length--,_i=u3;continue}K.username=A.username,K.password=A.password,K.host=A.host,K.port=A.port,K.path=s3(A.path),K.query=A.query,K.fragment="",_i=Y4}break;case ime:if(!K.isSpecial()||"/"!=w&&"\\"!=w){if("/"!=w){K.username=A.username,K.password=A.password,K.host=A.host,K.port=A.port,_i=u3;continue}_i=dG}else _i=c9;break;case lG:if(_i=c9,"/"!=w||"/"!=YL(_u,_o+1))continue;_o++;break;case c9:if("/"!=w&&"\\"!=w){_i=dG;continue}break;case dG:if("@"==w){ch&&(_u="%40"+_u),ch=!0,$=_z(_u);for(var i_=0;i_<$.length;i_++){var u_=$[i_];if(":"!=u_||o_){var g_=z6(u_,Mle);o_?K.password+=g_:K.username+=g_}else o_=!0}_u=""}else if(w==XP||"/"==w||"?"==w||"#"==w||"\\"==w&&K.isSpecial()){if(ch&&""==_u)return"Invalid authority";_o-=_z(_u).length+1,_u="",_i=Qie}else _u+=w;break;case Qie:case wX:if(p&&"file"==K.scheme){_i=TX;continue}if(":"!=w||_f){if(w==XP||"/"==w||"?"==w||"#"==w||"\\"==w&&K.isSpecial()){if(K.isSpecial()&&""==_u)return K6;if(p&&""==_u&&(K.includesCredentials()||null!==K.port))return;if(j=K.parseHost(_u))return j;if(_u="",_i=hG,p)return;continue}"["==w?_f=!0:"]"==w&&(_f=!1),_u+=w}else{if(""==_u)return K6;if(j=K.parseHost(_u))return j;if(_u="",_i=jle,p==wX)return}break;case jle:if(!GM(Zge,w)){if(w==XP||"/"==w||"?"==w||"#"==w||"\\"==w&&K.isSpecial()||p){if(""!=_u){var __=IX(_u,10);if(__>65535)return Jge;K.port=K.isSpecial()&&__===QM[K.scheme]?null:__,_u=""}if(p)return;_i=hG;continue}return Jge}_u+=w;break;case Vle:if(K.scheme="file","/"==w||"\\"==w)_i=ome;else{if(!A||"file"!=A.scheme){_i=u3;continue}if(w==XP)K.host=A.host,K.path=s3(A.path),K.query=A.query;else if("?"==w)K.host=A.host,K.path=s3(A.path),K.query="",_i=pG;else{if("#"!=w){c3(W6(s3(y,_o),""))||(K.host=A.host,K.path=s3(A.path),K.shortenPath()),_i=u3;continue}K.host=A.host,K.path=s3(A.path),K.query=A.query,K.fragment="",_i=Y4}}break;case ome:if("/"==w||"\\"==w){_i=TX;break}A&&"file"==A.scheme&&!c3(W6(s3(y,_o),""))&&(Gie(A.path[0],!0)?MR(K.path,A.path[0]):K.host=A.host),_i=u3;continue;case TX:if(w==XP||"/"==w||"\\"==w||"?"==w||"#"==w){if(!p&&Gie(_u))_i=u3;else if(""==_u){if(K.host="",p)return;_i=hG}else{if(j=K.parseHost(_u))return j;if("localhost"==K.host&&(K.host=""),p)return;_u="",_i=hG}continue}_u+=w;break;case hG:if(K.isSpecial()){if(_i=u3,"/"!=w&&"\\"!=w)continue}else if(p||"?"!=w)if(p||"#"!=w){if(w!=XP&&(_i=u3,"/"!=w))continue}else K.fragment="",_i=Y4;else K.query="",_i=pG;break;case u3:if(w==XP||"/"==w||"\\"==w&&K.isSpecial()||!p&&("?"==w||"#"==w)){if(".."===(_e=bX(_e=_u))||"%2e."===_e||".%2e"===_e||"%2e%2e"===_e?(K.shortenPath(),"/"==w||"\\"==w&&K.isSpecial()||MR(K.path,"")):a9(_u)?"/"==w||"\\"==w&&K.isSpecial()||MR(K.path,""):("file"==K.scheme&&!K.path.length&&Gie(_u)&&(K.host&&(K.host=""),_u=YL(_u,0)+":"),MR(K.path,_u)),_u="","file"==K.scheme&&(w==XP||"?"==w||"#"==w))for(;K.path.length>1&&""===K.path[0];)zge(K.path);"?"==w?(K.query="",_i=pG):"#"==w&&(K.fragment="",_i=Y4)}else _u+=z6(w,nme);break;case fG:"?"==w?(K.query="",_i=pG):"#"==w?(K.fragment="",_i=Y4):w!=XP&&(K.path[0]+=z6(w,Vie));break;case pG:p||"#"!=w?w!=XP&&("'"==w&&K.isSpecial()?K.query+="%27":K.query+="#"==w?"%23":z6(w,Vie)):(K.fragment="",_i=Y4);break;case Y4:w!=XP&&(K.fragment+=z6(w,aye))}_o++}},parseHost:function(s){var p,A,y;if("["==YL(s,0)){if("]"!=YL(s,s.length-1)||!(p=function(w){var $,j,_e,K,_i,_o,_u,ch=[0,0,0,0,0,0,0,0],_f=0,o_=null,i_=0,u_=function(){return YL(w,i_)};if(":"==u_()){if(":"!=YL(w,1))return;i_+=2,o_=++_f}for(;u_();){if(8==_f)return;if(":"!=u_()){for($=j=0;j<4&&GM(eme,u_());)$=16*$+IX(u_(),16),i_++,j++;if("."==u_()){if(0==j||(i_-=j,_f>6))return;for(_e=0;u_();){if(K=null,_e>0){if(!("."==u_()&&_e<4))return;i_++}if(!GM(Zge,u_()))return;for(;GM(Zge,u_());){if(_i=IX(u_(),10),null===K)K=_i;else{if(0==K)return;K=10*K+_i}if(K>255)return;i_++}ch[_f]=256*ch[_f]+K,2!=++_e&&4!=_e||_f++}if(4!=_e)return;break}if(":"==u_()){if(i_++,!u_())return}else if(u_())return;ch[_f++]=$}else{if(null!==o_)return;i_++,o_=++_f}}if(null!==o_)for(_o=_f-o_,_f=7;0!=_f&&_o>0;)_u=ch[_f],ch[_f--]=ch[o_+_o-1],ch[o_+--_o]=_u;else if(8!=_f)return;return ch}(uG(s,1,-1))))return K6;this.host=p}else if(this.isSpecial()){if(s=function(s){var p,A,y=[],w=Hve(dle(Tge(s),Ige,"."),".");for(p=0;p<w.length;p++)K4(y,lle($K,A=w[p])?"xn--"+Oge(A):A);return wge(y,".")}(s),GM(iye,s)||null===(p=function(w){var $,j,_e,K,_i,_o,_u,ch=rye(w,".");if(ch.length&&""==ch[ch.length-1]&&ch.length--,($=ch.length)>4)return w;for(j=[],_e=0;_e<$;_e++){if(""==(K=ch[_e]))return w;if(_i=10,K.length>1&&"0"==YL(K,0)&&(_i=GM(AEe,K)?16:8,K=uG(K,8==_i?1:2)),""===K)_o=0;else{if(!GM(10==_i?Xge:8==_i?uO:eme,K))return w;_o=IX(K,_i)}MR(j,_o)}for(_e=0;_e<$;_e++)if(_o=j[_e],_e==$-1){if(_o>=tT(256,5-$))return null}else if(_o>255)return null;for(_u=vS(j),_e=0;_e<j.length;_e++)_u+=j[_e]*tT(256,3-_e);return _u}(s)))return K6;this.host=p}else{if(GM(tme,s))return K6;for(p="",A=_z(s),y=0;y<A.length;y++)p+=z6(A[y],Vie);this.host=p}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return cG(QM,this.scheme)},shortenPath:function(){var s=this.path,p=s.length;!p||"file"==this.scheme&&1==p&&Gie(s[0],!0)||s.length--},serialize:function(){var s=this,p=s.scheme,A=s.username,y=s.password,w=s.host,$=s.port,j=s.path,_e=s.query,K=s.fragment,_i=p+":";return null!==w?(_i+="//",s.includesCredentials()&&(_i+=A+(y?":"+y:"")+"@"),_i+=CX(w),null!==$&&(_i+=":"+$)):"file"==p&&(_i+="//"),_i+=s.cannotBeABaseURL?j[0]:j.length?"/"+W6(j,"/"):"",null!==_e&&(_i+="?"+_e),null!==K&&(_i+="#"+K),_i},setHref:function(s){var p=this.parse(s);if(p)throw Fie(p);this.searchParams.update()},getOrigin:function(){var s=this.scheme,p=this.port;if("blob"==s)try{return new gG(s.path[0]).origin}catch(A){return"null"}return"file"!=s&&this.isSpecial()?s+"://"+CX(this.host)+(null!==p?":"+p:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(s){this.parse(q6(s)+":",tY)},getUsername:function(){return this.username},setUsername:function(s){var p=_z(q6(s));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var A=0;A<p.length;A++)this.username+=z6(p[A],Mle)}},getPassword:function(){return this.password},setPassword:function(s){var p=_z(q6(s));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var A=0;A<p.length;A++)this.password+=z6(p[A],Mle)}},getHost:function(){var s=this.host,p=this.port;return null===s?"":null===p?CX(s):CX(s)+":"+p},setHost:function(s){this.cannotBeABaseURL||this.parse(s,Qie)},getHostname:function(){var s=this.host;return null===s?"":CX(s)},setHostname:function(s){this.cannotBeABaseURL||this.parse(s,wX)},getPort:function(){var s=this.port;return null===s?"":q6(s)},setPort:function(s){this.cannotHaveUsernamePasswordPort()||(""==(s=q6(s))?this.port=null:this.parse(s,jle))},getPathname:function(){var s=this.path;return this.cannotBeABaseURL?s[0]:s.length?"/"+W6(s,"/"):""},setPathname:function(s){this.cannotBeABaseURL||(this.path=[],this.parse(s,hG))},getSearch:function(){var s=this.query;return s?"?"+s:""},setSearch:function(s){""==(s=q6(s))?this.query=null:("?"==YL(s,0)&&(s=uG(s,1)),this.query="",this.parse(s,pG)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var s=this.fragment;return s?"#"+s:""},setHash:function(s){""!=(s=q6(s))?("#"==YL(s,0)&&(s=uG(s,1)),this.fragment="",this.parse(s,Y4)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var gG=function(s){var p=Ple(this,Hie),y=tye(p,new SX(s,!1,arguments.length>1?arguments[1]:void 0));vX||(p.href=y.serialize(),p.origin=y.getOrigin(),p.protocol=y.getProtocol(),p.username=y.getUsername(),p.password=y.getPassword(),p.host=y.getHost(),p.hostname=y.getHostname(),p.port=y.getPort(),p.pathname=y.getPathname(),p.search=y.getSearch(),p.searchParams=y.getSearchParams(),p.hash=y.getHash())},Hie=gG.prototype,lP=function(s,p){return{get:function(){return Uie(this)[s]()},set:p&&function(A){return Uie(this)[p](A)},configurable:!0,enumerable:!0}};if(vX&&kle(Hie,{href:lP("serialize","setHref"),origin:lP("getOrigin"),protocol:lP("getProtocol","setProtocol"),username:lP("getUsername","setUsername"),password:lP("getPassword","setPassword"),host:lP("getHost","setHost"),hostname:lP("getHostname","setHostname"),port:lP("getPort","setPort"),pathname:lP("getPathname","setPathname"),search:lP("getSearch","setSearch"),searchParams:lP("getSearchParams"),hash:lP("getHash","setHash")}),yX(Hie,"toJSON",function(){return Uie(this).serialize()},{enumerable:!0}),yX(Hie,"toString",function(){return Uie(this).serialize()},{enumerable:!0}),eY){var RX=eY.createObjectURL,Gle=eY.revokeObjectURL;RX&&yX(gG,"createObjectURL",Bie(RX,eY)),Gle&&yX(gG,"revokeObjectURL",Bie(Gle,eY))}Hge(gG,"URL"),Dle({global:!0,forced:!Nle,sham:!vX},{URL:gG});var rY=IU.URL;const cye={[SQ.ACCESS_POINT]:{[OR.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[OR.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[OR.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[OR.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[OR.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[OR.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[OR.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[OR.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voice service available",retry:!0},[OR.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[OR.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[OR.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[OR.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[OR.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[OR.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[OR.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[OR.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[OR.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[OR.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[SQ.UNILBS]:{[HO.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[HO.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[HO.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[HO.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[HO.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[HO.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[HO.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[HO.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[HO.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[HO.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[HO.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[HO.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[SQ.STRING_UID_ALLOCATOR]:{[mZ.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[mZ.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[mZ.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function mG(s){const p=cye[Math.floor(s/1e4)];if(!p)return{desc:"unkonw error",retry:!1};const A=p[s%1e4];if(!A){if(Math.floor(s/1e4)===SQ.ACCESS_POINT){const y=s%1e4;if("1"===y.toString()[0])return{desc:s.toString(),retry:!1};if("2"===y.toString()[0])return{desc:s.toString(),retry:!0}}return{desc:"unkonw error",retry:!1}}return A}const u9={[OI.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[OI.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[OI.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[OI.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[OI.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[OI.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[OI.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[OI.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[OI.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[OI.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[OI.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[OI.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[OI.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[OI.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[OI.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[OI.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[OI.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[OI.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[OI.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[OI.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[OI.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[OI.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[OI.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[OI.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[OI.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[OI.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[OI.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[OI.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[OI.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[OI.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[OI.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[OI.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[OI.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[OI.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[OI.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[OI.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[OI.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[OI.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[OI.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[OI.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[OI.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[OI.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[OI.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[OI.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[OI.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[OI.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[OI.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[OI.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[OI.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[OI.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[OI.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[OI.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[OI.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[OI.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[OI.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[OI.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[OI.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[OI.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"}};function l3(s){return u9[s]||{desc:"UNKNOW_ERROR_".concat(s),action:"failed"}}var iY={exports:{}};(function(s,p){s.exports=function(){var A={d:function(t0,b_){for(var z_ in b_)A.o(b_,z_)&&!A.o(t0,z_)&&Object.defineProperty(t0,z_,{enumerable:!0,get:b_[z_]})},o:function(t0,b_){return Object.prototype.hasOwnProperty.call(t0,b_)},r:function(t0){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t0,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t0,"__esModule",{value:!0})}},y={};A.r(y),A.d(y,{DataViewIndexOutOfBoundsError:function(){return d0},DecodeError:function(){return k_},Decoder:function(){return MI},EXT_TIMESTAMP:function(){return Rv},Encoder:function(){return o0},ExtData:function(){return __},ExtensionCodec:function(){return a0},decode:function(){return q1},decodeArrayStream:function(){return p3},decodeAsync:function(){return JL},decodeMulti:function(){return JO},decodeMultiStream:function(){return ES},decodeStream:function(){return nEe},decodeTimestampExtension:function(){return q0},decodeTimestampToTimeSpec:function(){return rI},encode:function(){return q_},encodeDateToTimeSpec:function(){return y0},encodeTimeSpecToTimestamp:function(){return f0},encodeTimestampExtension:function(){return b0}});var w=4294967295;function $(t0,b_,z_){var l0=Math.floor(z_/4294967296),n0=z_;t0.setUint32(b_,l0),t0.setUint32(b_+4,n0)}function j(t0,b_){return 4294967296*t0.getInt32(b_)+t0.getUint32(b_+4)}var _e=function(t0,b_){var z_="function"==typeof Symbol&&t0[Symbol.iterator];if(!z_)return t0;var l0,n0,F0=z_.call(t0),L0=[];try{for(;(void 0===b_||b_-- >0)&&!(l0=F0.next()).done;)L0.push(l0.value)}catch(oI){n0={error:oI}}finally{try{l0&&!l0.done&&(z_=F0.return)&&z_.call(F0)}finally{if(n0)throw n0.error}}return L0},K=function(t0,b_){for(var z_=0,l0=b_.length,n0=t0.length;z_<l0;z_++,n0++)t0[n0]=b_[z_];return t0},_i="undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;function _o(t0){for(var b_=t0.length,z_=0,l0=0;l0<b_;){var n0=t0.charCodeAt(l0++);if(0!=(4294967168&n0))if(0==(4294965248&n0))z_+=2;else{if(n0>=55296&&n0<=56319&&l0<b_){var F0=t0.charCodeAt(l0);56320==(64512&F0)&&(++l0,n0=((1023&n0)<<10)+(1023&F0)+65536)}z_+=0==(4294901760&n0)?3:4}else z_++}return z_}var _u=_i?new TextEncoder:void 0,ch=_i?"undefined"!=typeof process?200:0:w,_f=(null==_u?void 0:_u.encodeInto)?function(t0,b_,z_){_u.encodeInto(t0,b_.subarray(z_))}:function(t0,b_,z_){b_.set(_u.encode(t0),z_)};function o_(t0,b_,z_){for(var l0=b_,n0=l0+z_,F0=[],L0="";l0<n0;){var oI=t0[l0++];if(0==(128&oI))F0.push(oI);else if(192==(224&oI)){var HI=63&t0[l0++];F0.push((31&oI)<<6|HI)}else if(224==(240&oI)){HI=63&t0[l0++];var e1=63&t0[l0++];F0.push((31&oI)<<12|HI<<6|e1)}else if(240==(248&oI)){var J0=(7&oI)<<18|(HI=63&t0[l0++])<<12|(e1=63&t0[l0++])<<6|63&t0[l0++];J0>65535&&(F0.push((J0-=65536)>>>10&1023|55296),J0=56320|1023&J0),F0.push(J0)}else F0.push(oI);F0.length>=4096&&(L0+=String.fromCharCode.apply(String,K([],_e(F0))),F0.length=0)}return F0.length>0&&(L0+=String.fromCharCode.apply(String,K([],_e(F0)))),L0}var i_,u_=_i?new TextDecoder:null,g_=_i?"undefined"!=typeof process?200:0:w,__=function(t0,b_){this.type=t0,this.data=b_},w_=(i_=function(t0,b_){return(i_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(z_,l0){z_.__proto__=l0}||function(z_,l0){for(var n0 in l0)Object.prototype.hasOwnProperty.call(l0,n0)&&(z_[n0]=l0[n0])})(t0,b_)},function(t0,b_){if("function"!=typeof b_&&null!==b_)throw new TypeError("Class extends value "+String(b_)+" is not a constructor or null");function z_(){this.constructor=t0}i_(t0,b_),t0.prototype=null===b_?Object.create(b_):(z_.prototype=b_.prototype,new z_)}),k_=function(t0){function b_(z_){var l0=t0.call(this,z_)||this,n0=Object.create(b_.prototype);return Object.setPrototypeOf(l0,n0),Object.defineProperty(l0,"name",{configurable:!0,enumerable:!1,value:b_.name}),l0}return w_(b_,t0),b_}(Error),Rv=-1;function f0(t0){var b_,z_=t0.sec,l0=t0.nsec;if(z_>=0&&l0>=0&&z_<=17179869183){if(0===l0&&z_<=4294967295){var n0=new Uint8Array(4);return(b_=new DataView(n0.buffer)).setUint32(0,z_),n0}var F0=z_/4294967296,L0=4294967295&z_;return n0=new Uint8Array(8),(b_=new DataView(n0.buffer)).setUint32(0,l0<<2|3&F0),b_.setUint32(4,L0),n0}return n0=new Uint8Array(12),(b_=new DataView(n0.buffer)).setUint32(0,l0),$(b_,4,z_),n0}function y0(t0){var b_=t0.getTime(),z_=Math.floor(b_/1e3),l0=1e6*(b_-1e3*z_),n0=Math.floor(l0/1e9);return{sec:z_+n0,nsec:l0-1e9*n0}}function b0(t0){return t0 instanceof Date?f0(y0(t0)):null}function rI(t0){var b_=new DataView(t0.buffer,t0.byteOffset,t0.byteLength);switch(t0.byteLength){case 4:return{sec:b_.getUint32(0),nsec:0};case 8:var z_=b_.getUint32(0);return{sec:4294967296*(3&z_)+b_.getUint32(4),nsec:z_>>>2};case 12:return{sec:j(b_,4),nsec:b_.getUint32(0)};default:throw new k_("Unrecognized data size for timestamp (expected 4, 8, or 12): "+t0.length)}}function q0(t0){var b_=rI(t0);return new Date(1e3*b_.sec+b_.nsec/1e6)}var Z0={type:Rv,encode:b0,decode:q0},a0=function(){function t0(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(Z0)}return t0.prototype.register=function(b_){var z_=b_.type,l0=b_.encode,n0=b_.decode;if(z_>=0)this.encoders[z_]=l0,this.decoders[z_]=n0;else{var F0=1+z_;this.builtInEncoders[F0]=l0,this.builtInDecoders[F0]=n0}},t0.prototype.tryToEncode=function(b_,z_){for(var l0=0;l0<this.builtInEncoders.length;l0++)if(null!=(n0=this.builtInEncoders[l0])&&null!=(F0=n0(b_,z_)))return new __(-1-l0,F0);for(l0=0;l0<this.encoders.length;l0++){var n0,F0;if(null!=(n0=this.encoders[l0])&&null!=(F0=n0(b_,z_)))return new __(l0,F0)}return b_ instanceof __?b_:null},t0.prototype.decode=function(b_,z_,l0){var n0=z_<0?this.builtInDecoders[-1-z_]:this.decoders[z_];return n0?n0(b_,z_,l0):new __(z_,b_)},t0.defaultCodec=new t0,t0}();function j_(t0){return t0 instanceof Uint8Array?t0:ArrayBuffer.isView(t0)?new Uint8Array(t0.buffer,t0.byteOffset,t0.byteLength):t0 instanceof ArrayBuffer?new Uint8Array(t0):Uint8Array.from(t0)}var Z_=function(t0){var b_="function"==typeof Symbol&&Symbol.iterator,z_=b_&&t0[b_],l0=0;if(z_)return z_.call(t0);if(t0&&"number"==typeof t0.length)return{next:function(){return t0&&l0>=t0.length&&(t0=void 0),{value:t0&&t0[l0++],done:!t0}}};throw new TypeError(b_?"Object is not iterable.":"Symbol.iterator is not defined.")},o0=function(){function t0(b_,z_,l0,n0,F0,L0,oI,HI){void 0===b_&&(b_=a0.defaultCodec),void 0===z_&&(z_=void 0),void 0===l0&&(l0=100),void 0===n0&&(n0=2048),void 0===F0&&(F0=!1),void 0===L0&&(L0=!1),void 0===oI&&(oI=!1),void 0===HI&&(HI=!1),this.extensionCodec=b_,this.context=z_,this.maxDepth=l0,this.initialBufferSize=n0,this.sortKeys=F0,this.forceFloat32=L0,this.ignoreUndefined=oI,this.forceIntegerToFloat=HI,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return t0.prototype.getUint8Array=function(){return this.bytes.subarray(0,this.pos)},t0.prototype.reinitializeState=function(){this.pos=0},t0.prototype.encode=function(b_){return this.reinitializeState(),this.doEncode(b_,1),this.getUint8Array()},t0.prototype.doEncode=function(b_,z_){if(z_>this.maxDepth)throw new Error("Too deep objects in depth "+z_);null==b_?this.encodeNil():"boolean"==typeof b_?this.encodeBoolean(b_):"number"==typeof b_?this.encodeNumber(b_):"string"==typeof b_?this.encodeString(b_):this.encodeObject(b_,z_)},t0.prototype.ensureBufferSizeToWrite=function(b_){var z_=this.pos+b_;this.view.byteLength<z_&&this.resizeBuffer(2*z_)},t0.prototype.resizeBuffer=function(b_){var z_=new ArrayBuffer(b_),l0=new Uint8Array(z_),n0=new DataView(z_);l0.set(this.bytes),this.view=n0,this.bytes=l0},t0.prototype.encodeNil=function(){this.writeU8(192)},t0.prototype.encodeBoolean=function(b_){this.writeU8(!1===b_?194:195)},t0.prototype.encodeNumber=function(b_){Number.isSafeInteger(b_)&&!this.forceIntegerToFloat?b_>=0?b_<128?this.writeU8(b_):b_<256?(this.writeU8(204),this.writeU8(b_)):b_<65536?(this.writeU8(205),this.writeU16(b_)):b_<4294967296?(this.writeU8(206),this.writeU32(b_)):(this.writeU8(207),this.writeU64(b_)):b_>=-32?this.writeU8(224|b_+32):b_>=-128?(this.writeU8(208),this.writeI8(b_)):b_>=-32768?(this.writeU8(209),this.writeI16(b_)):b_>=-2147483648?(this.writeU8(210),this.writeI32(b_)):(this.writeU8(211),this.writeI64(b_)):this.forceFloat32?(this.writeU8(202),this.writeF32(b_)):(this.writeU8(203),this.writeF64(b_))},t0.prototype.writeStringHeader=function(b_){if(b_<32)this.writeU8(160+b_);else if(b_<256)this.writeU8(217),this.writeU8(b_);else if(b_<65536)this.writeU8(218),this.writeU16(b_);else{if(!(b_<4294967296))throw new Error("Too long string: "+b_+" bytes in UTF-8");this.writeU8(219),this.writeU32(b_)}},t0.prototype.encodeString=function(b_){if(b_.length>ch){var z_=_o(b_);this.ensureBufferSizeToWrite(5+z_),this.writeStringHeader(z_),_f(b_,this.bytes,this.pos),this.pos+=z_}else z_=_o(b_),this.ensureBufferSizeToWrite(5+z_),this.writeStringHeader(z_),function(l0,n0,F0){for(var L0=l0.length,oI=F0,HI=0;HI<L0;){var e1=l0.charCodeAt(HI++);if(0!=(4294967168&e1)){if(0==(4294965248&e1))n0[oI++]=e1>>6&31|192;else{if(e1>=55296&&e1<=56319&&HI<L0){var J0=l0.charCodeAt(HI);56320==(64512&J0)&&(++HI,e1=((1023&e1)<<10)+(1023&J0)+65536)}0==(4294901760&e1)?(n0[oI++]=e1>>12&15|224,n0[oI++]=e1>>6&63|128):(n0[oI++]=e1>>18&7|240,n0[oI++]=e1>>12&63|128,n0[oI++]=e1>>6&63|128)}n0[oI++]=63&e1|128}else n0[oI++]=e1}}(b_,this.bytes,this.pos),this.pos+=z_},t0.prototype.encodeObject=function(b_,z_){var l0=this.extensionCodec.tryToEncode(b_,this.context);if(null!=l0)this.encodeExtension(l0);else if(Array.isArray(b_))this.encodeArray(b_,z_);else if(ArrayBuffer.isView(b_))this.encodeBinary(b_);else{if("object"!=typeof b_)throw new Error("Unrecognized object: "+Object.prototype.toString.apply(b_));this.encodeMap(b_,z_)}},t0.prototype.encodeBinary=function(b_){var z_=b_.byteLength;if(z_<256)this.writeU8(196),this.writeU8(z_);else if(z_<65536)this.writeU8(197),this.writeU16(z_);else{if(!(z_<4294967296))throw new Error("Too large binary: "+z_);this.writeU8(198),this.writeU32(z_)}var l0=j_(b_);this.writeU8a(l0)},t0.prototype.encodeArray=function(b_,z_){var l0,n0,F0=b_.length;if(F0<16)this.writeU8(144+F0);else if(F0<65536)this.writeU8(220),this.writeU16(F0);else{if(!(F0<4294967296))throw new Error("Too large array: "+F0);this.writeU8(221),this.writeU32(F0)}try{for(var L0=Z_(b_),oI=L0.next();!oI.done;oI=L0.next())this.doEncode(oI.value,z_+1)}catch(e1){l0={error:e1}}finally{try{oI&&!oI.done&&(n0=L0.return)&&n0.call(L0)}finally{if(l0)throw l0.error}}},t0.prototype.countWithoutUndefined=function(b_,z_){var l0,n0,F0=0;try{for(var L0=Z_(z_),oI=L0.next();!oI.done;oI=L0.next())void 0!==b_[oI.value]&&F0++}catch(HI){l0={error:HI}}finally{try{oI&&!oI.done&&(n0=L0.return)&&n0.call(L0)}finally{if(l0)throw l0.error}}return F0},t0.prototype.encodeMap=function(b_,z_){var l0,n0,F0=Object.keys(b_);this.sortKeys&&F0.sort();var L0=this.ignoreUndefined?this.countWithoutUndefined(b_,F0):F0.length;if(L0<16)this.writeU8(128+L0);else if(L0<65536)this.writeU8(222),this.writeU16(L0);else{if(!(L0<4294967296))throw new Error("Too large map object: "+L0);this.writeU8(223),this.writeU32(L0)}try{for(var oI=Z_(F0),HI=oI.next();!HI.done;HI=oI.next()){var e1=HI.value,J0=b_[e1];this.ignoreUndefined&&void 0===J0||(this.encodeString(e1),this.doEncode(J0,z_+1))}}catch(cI){l0={error:cI}}finally{try{HI&&!HI.done&&(n0=oI.return)&&n0.call(oI)}finally{if(l0)throw l0.error}}},t0.prototype.encodeExtension=function(b_){var z_=b_.data.length;if(1===z_)this.writeU8(212);else if(2===z_)this.writeU8(213);else if(4===z_)this.writeU8(214);else if(8===z_)this.writeU8(215);else if(16===z_)this.writeU8(216);else if(z_<256)this.writeU8(199),this.writeU8(z_);else if(z_<65536)this.writeU8(200),this.writeU16(z_);else{if(!(z_<4294967296))throw new Error("Too large extension object: "+z_);this.writeU8(201),this.writeU32(z_)}this.writeI8(b_.type),this.writeU8a(b_.data)},t0.prototype.writeU8=function(b_){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,b_),this.pos++},t0.prototype.writeU8a=function(b_){var z_=b_.length;this.ensureBufferSizeToWrite(z_),this.bytes.set(b_,this.pos),this.pos+=z_},t0.prototype.writeI8=function(b_){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,b_),this.pos++},t0.prototype.writeU16=function(b_){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,b_),this.pos+=2},t0.prototype.writeI16=function(b_){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,b_),this.pos+=2},t0.prototype.writeU32=function(b_){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,b_),this.pos+=4},t0.prototype.writeI32=function(b_){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,b_),this.pos+=4},t0.prototype.writeF32=function(b_){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,b_),this.pos+=4},t0.prototype.writeF64=function(b_){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,b_),this.pos+=8},t0.prototype.writeU64=function(b_){var z_,l0,n0,L0;this.ensureBufferSizeToWrite(8),L0=n0=b_,(z_=this.view).setUint32(l0=this.pos,n0/4294967296),z_.setUint32(l0+4,L0),this.pos+=8},t0.prototype.writeI64=function(b_){this.ensureBufferSizeToWrite(8),$(this.view,this.pos,b_),this.pos+=8},t0}(),z0={};function q_(t0,b_){return void 0===b_&&(b_=z0),new o0(b_.extensionCodec,b_.context,b_.maxDepth,b_.initialBufferSize,b_.sortKeys,b_.forceFloat32,b_.ignoreUndefined,b_.forceIntegerToFloat).encode(t0)}function X_(t0){return(t0<0?"-":"")+"0x"+Math.abs(t0).toString(16).padStart(2,"0")}var u0=function(){function t0(b_,z_){void 0===b_&&(b_=16),void 0===z_&&(z_=16),this.maxKeyLength=b_,this.maxLengthPerKey=z_,this.hit=0,this.miss=0,this.caches=[];for(var l0=0;l0<this.maxKeyLength;l0++)this.caches.push([])}return t0.prototype.canBeCached=function(b_){return b_>0&&b_<=this.maxKeyLength},t0.prototype.find=function(b_,z_,l0){var n0,F0,L0=this.caches[l0-1];try{e:for(var oI=function(BI){var b1="function"==typeof Symbol&&Symbol.iterator,zT=b1&&BI[b1],TN=0;if(zT)return zT.call(BI);if(BI&&"number"==typeof BI.length)return{next:function(){return BI&&TN>=BI.length&&(BI=void 0),{value:BI&&BI[TN++],done:!BI}}};throw new TypeError(b1?"Object is not iterable.":"Symbol.iterator is not defined.")}(L0),HI=oI.next();!HI.done;HI=oI.next()){for(var e1=HI.value,J0=e1.bytes,cI=0;cI<l0;cI++)if(J0[cI]!==b_[z_+cI])continue e;return e1.str}}catch(BI){n0={error:BI}}finally{try{HI&&!HI.done&&(F0=oI.return)&&F0.call(oI)}finally{if(n0)throw n0.error}}return null},t0.prototype.store=function(b_,z_){var l0=this.caches[b_.length-1],n0={bytes:b_,str:z_};l0.length>=this.maxLengthPerKey?l0[Math.random()*l0.length|0]=n0:l0.push(n0)},t0.prototype.decode=function(b_,z_,l0){var n0=this.find(b_,z_,l0);if(null!=n0)return this.hit++,n0;this.miss++;var F0=o_(b_,z_,l0),L0=Uint8Array.prototype.slice.call(b_,z_,z_+l0);return this.store(L0,F0),F0},t0}(),B0=function(t0,b_){var z_,l0,n0,F0,L0={label:0,sent:function(){if(1&n0[0])throw n0[1];return n0[1]},trys:[],ops:[]};return F0={next:oI(0),throw:oI(1),return:oI(2)},"function"==typeof Symbol&&(F0[Symbol.iterator]=function(){return this}),F0;function oI(HI){return function(e1){return function(J0){if(z_)throw new TypeError("Generator is already executing.");for(;L0;)try{if(z_=1,l0&&(n0=2&J0[0]?l0.return:J0[0]?l0.throw||((n0=l0.return)&&n0.call(l0),0):l0.next)&&!(n0=n0.call(l0,J0[1])).done)return n0;switch(l0=0,n0&&(J0=[2&J0[0],n0.value]),J0[0]){case 0:case 1:n0=J0;break;case 4:return L0.label++,{value:J0[1],done:!1};case 5:L0.label++,l0=J0[1],J0=[0];continue;case 7:J0=L0.ops.pop(),L0.trys.pop();continue;default:if(!((n0=(n0=L0.trys).length>0&&n0[n0.length-1])||6!==J0[0]&&2!==J0[0])){L0=0;continue}if(3===J0[0]&&(!n0||J0[1]>n0[0]&&J0[1]<n0[3])){L0.label=J0[1];break}if(6===J0[0]&&L0.label<n0[1]){L0.label=n0[1],n0=J0;break}if(n0&&L0.label<n0[2]){L0.label=n0[2],L0.ops.push(J0);break}n0[2]&&L0.ops.pop(),L0.trys.pop();continue}J0=b_.call(t0,L0)}catch(cI){J0=[6,cI],l0=0}finally{z_=n0=0}if(5&J0[0])throw J0[1];return{value:J0[0]?J0[1]:void 0,done:!0}}([HI,e1])}}},$0=function(t0){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var b_,z_=t0[Symbol.asyncIterator];return z_?z_.call(t0):(t0="function"==typeof __values?__values(t0):t0[Symbol.iterator](),b_={},l0("next"),l0("throw"),l0("return"),b_[Symbol.asyncIterator]=function(){return this},b_);function l0(n0){b_[n0]=t0[n0]&&function(F0){return new Promise(function(L0,oI){var HI,e1,J0;HI=L0,e1=oI,J0=(F0=t0[n0](F0)).done,Promise.resolve(F0.value).then(function(BI){HI({value:BI,done:J0})},e1)})}}},A0=function(t0){return this instanceof A0?(this.v=t0,this):new A0(t0)},e_=function(t0,b_,z_){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l0,n0=z_.apply(t0,b_||[]),F0=[];return l0={},L0("next"),L0("throw"),L0("return"),l0[Symbol.asyncIterator]=function(){return this},l0;function L0(cI){n0[cI]&&(l0[cI]=function(BI){return new Promise(function(b1,zT){F0.push([cI,BI,b1,zT])>1||oI(cI,BI)})})}function oI(cI,BI){try{(b1=n0[cI](BI)).value instanceof A0?Promise.resolve(b1.value.v).then(HI,e1):J0(F0[0][2],b1)}catch(zT){J0(F0[0][3],zT)}var b1}function HI(cI){oI("next",cI)}function e1(cI){oI("throw",cI)}function J0(cI,BI){cI(BI),F0.shift(),F0.length&&oI(F0[0][0],F0[0][1])}},y_=new DataView(new ArrayBuffer(0)),D_=new Uint8Array(y_.buffer),d0=function(){try{y_.getInt8(0)}catch(t0){return t0.constructor}throw new Error("never reached")}(),K0=new d0("Insufficient data"),FI=new u0,MI=function(){function t0(b_,z_,l0,n0,F0,L0,oI,HI){void 0===b_&&(b_=a0.defaultCodec),void 0===z_&&(z_=void 0),void 0===l0&&(l0=w),void 0===n0&&(n0=w),void 0===F0&&(F0=w),void 0===L0&&(L0=w),void 0===oI&&(oI=w),void 0===HI&&(HI=FI),this.extensionCodec=b_,this.context=z_,this.maxStrLength=l0,this.maxBinLength=n0,this.maxArrayLength=F0,this.maxMapLength=L0,this.maxExtLength=oI,this.keyDecoder=HI,this.totalPos=0,this.pos=0,this.view=y_,this.bytes=D_,this.headByte=-1,this.stack=[]}return t0.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},t0.prototype.setBuffer=function(b_){this.bytes=j_(b_),this.view=function(z_){if(z_ instanceof ArrayBuffer)return new DataView(z_);var l0=j_(z_);return new DataView(l0.buffer,l0.byteOffset,l0.byteLength)}(this.bytes),this.pos=0},t0.prototype.appendBuffer=function(b_){if(-1!==this.headByte||this.hasRemaining(1)){var z_=this.bytes.subarray(this.pos),l0=j_(b_),n0=new Uint8Array(z_.length+l0.length);n0.set(z_),n0.set(l0,z_.length),this.setBuffer(n0)}else this.setBuffer(b_)},t0.prototype.hasRemaining=function(b_){return this.view.byteLength-this.pos>=b_},t0.prototype.createExtraByteError=function(b_){var z_=this.view;return new RangeError("Extra "+(z_.byteLength-this.pos)+" of "+z_.byteLength+" byte(s) found at buffer["+b_+"]")},t0.prototype.decode=function(b_){this.reinitializeState(),this.setBuffer(b_);var z_=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return z_},t0.prototype.decodeMulti=function(b_){return B0(this,function(z_){switch(z_.label){case 0:this.reinitializeState(),this.setBuffer(b_),z_.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return z_.sent(),[3,1];case 3:return[2]}})},t0.prototype.decodeAsync=function(b_){var z_,l0,n0,F0,L0,HI,e1;return L0=this,void 0,e1=function(){var J0,cI,BI,b1,zT,TN,X0,aI;return B0(this,function(ZI){switch(ZI.label){case 0:J0=!1,ZI.label=1;case 1:ZI.trys.push([1,6,7,12]),z_=$0(b_),ZI.label=2;case 2:return[4,z_.next()];case 3:if((l0=ZI.sent()).done)return[3,5];if(BI=l0.value,J0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(BI);try{cI=this.doDecodeSync(),J0=!0}catch(W1){if(!(W1 instanceof d0))throw W1}this.totalPos+=this.pos,ZI.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return b1=ZI.sent(),n0={error:b1},[3,12];case 7:return ZI.trys.push([7,,10,11]),l0&&!l0.done&&(F0=z_.return)?[4,F0.call(z_)]:[3,9];case 8:ZI.sent(),ZI.label=9;case 9:return[3,11];case 10:if(n0)throw n0.error;return[7];case 11:return[7];case 12:if(J0){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,cI]}throw TN=(zT=this).headByte,X0=zT.pos,aI=zT.totalPos,new RangeError("Insufficient data in parsing "+X_(TN)+" at "+aI+" ("+X0+" in the current buffer)")}})},new((HI=void 0)||(HI=Promise))(function(J0,cI){function BI(TN){try{zT(e1.next(TN))}catch(X0){cI(X0)}}function b1(TN){try{zT(e1.throw(TN))}catch(X0){cI(X0)}}function zT(TN){var X0;TN.done?J0(TN.value):(X0=TN.value,X0 instanceof HI?X0:new HI(function(aI){aI(X0)})).then(BI,b1)}zT((e1=e1.apply(L0,[])).next())})},t0.prototype.decodeArrayStream=function(b_){return this.decodeMultiAsync(b_,!0)},t0.prototype.decodeStream=function(b_){return this.decodeMultiAsync(b_,!1)},t0.prototype.decodeMultiAsync=function(b_,z_){return e_(this,arguments,function(){var l0,n0,F0,L0,oI,HI,e1,J0,cI;return B0(this,function(BI){switch(BI.label){case 0:l0=z_,n0=-1,BI.label=1;case 1:BI.trys.push([1,13,14,19]),F0=$0(b_),BI.label=2;case 2:return[4,A0(F0.next())];case 3:if((L0=BI.sent()).done)return[3,12];if(oI=L0.value,z_&&0===n0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(oI),l0&&(n0=this.readArraySize(),l0=!1,this.complete()),BI.label=4;case 4:BI.trys.push([4,9,,10]),BI.label=5;case 5:return[4,A0(this.doDecodeSync())];case 6:return[4,BI.sent()];case 7:return BI.sent(),0==--n0?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((HI=BI.sent())instanceof d0))throw HI;return[3,10];case 10:this.totalPos+=this.pos,BI.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return e1=BI.sent(),J0={error:e1},[3,19];case 14:return BI.trys.push([14,,17,18]),L0&&!L0.done&&(cI=F0.return)?[4,A0(cI.call(F0))]:[3,16];case 15:BI.sent(),BI.label=16;case 16:return[3,18];case 17:if(J0)throw J0.error;return[7];case 18:return[7];case 19:return[2]}})})},t0.prototype.doDecodeSync=function(){e:for(;;){var b_=this.readHeadByte(),z_=void 0;if(b_>=224)z_=b_-256;else if(b_<192)if(b_<128)z_=b_;else if(b_<144){if(0!=(n0=b_-128)){this.pushMapState(n0),this.complete();continue e}z_={}}else if(b_<160){if(0!=(n0=b_-144)){this.pushArrayState(n0),this.complete();continue e}z_=[]}else{var l0=b_-160;z_=this.decodeUtf8String(l0,0)}else if(192===b_)z_=null;else if(194===b_)z_=!1;else if(195===b_)z_=!0;else if(202===b_)z_=this.readF32();else if(203===b_)z_=this.readF64();else if(204===b_)z_=this.readU8();else if(205===b_)z_=this.readU16();else if(206===b_)z_=this.readU32();else if(207===b_)z_=this.readU64();else if(208===b_)z_=this.readI8();else if(209===b_)z_=this.readI16();else if(210===b_)z_=this.readI32();else if(211===b_)z_=this.readI64();else if(217===b_)l0=this.lookU8(),z_=this.decodeUtf8String(l0,1);else if(218===b_)l0=this.lookU16(),z_=this.decodeUtf8String(l0,2);else if(219===b_)l0=this.lookU32(),z_=this.decodeUtf8String(l0,4);else if(220===b_){if(0!==(n0=this.readU16())){this.pushArrayState(n0),this.complete();continue e}z_=[]}else if(221===b_){if(0!==(n0=this.readU32())){this.pushArrayState(n0),this.complete();continue e}z_=[]}else if(222===b_){if(0!==(n0=this.readU16())){this.pushMapState(n0),this.complete();continue e}z_={}}else if(223===b_){if(0!==(n0=this.readU32())){this.pushMapState(n0),this.complete();continue e}z_={}}else if(196===b_){var n0=this.lookU8();z_=this.decodeBinary(n0,1)}else if(197===b_)n0=this.lookU16(),z_=this.decodeBinary(n0,2);else if(198===b_)n0=this.lookU32(),z_=this.decodeBinary(n0,4);else if(212===b_)z_=this.decodeExtension(1,0);else if(213===b_)z_=this.decodeExtension(2,0);else if(214===b_)z_=this.decodeExtension(4,0);else if(215===b_)z_=this.decodeExtension(8,0);else if(216===b_)z_=this.decodeExtension(16,0);else if(199===b_)n0=this.lookU8(),z_=this.decodeExtension(n0,1);else if(200===b_)n0=this.lookU16(),z_=this.decodeExtension(n0,2);else{if(201!==b_)throw new k_("Unrecognized type byte: "+X_(b_));n0=this.lookU32(),z_=this.decodeExtension(n0,4)}this.complete();for(var F0=this.stack;F0.length>0;){var L0=F0[F0.length-1];if(0===L0.type){if(L0.array[L0.position]=z_,L0.position++,L0.position!==L0.size)continue e;F0.pop(),z_=L0.array}else{if(1===L0.type){if("string"!=(oI=typeof z_)&&"number"!==oI)throw new k_("The type of key must be string or number but "+typeof z_);if("__proto__"===z_)throw new k_("The key __proto__ is not allowed");L0.key=z_,L0.type=2;continue e}if(L0.map[L0.key]=z_,L0.readCount++,L0.readCount!==L0.size){L0.key=null,L0.type=1;continue e}F0.pop(),z_=L0.map}}return z_}var oI},t0.prototype.readHeadByte=function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte},t0.prototype.complete=function(){this.headByte=-1},t0.prototype.readArraySize=function(){var b_=this.readHeadByte();switch(b_){case 220:return this.readU16();case 221:return this.readU32();default:if(b_<160)return b_-144;throw new k_("Unrecognized array type byte: "+X_(b_))}},t0.prototype.pushMapState=function(b_){if(b_>this.maxMapLength)throw new k_("Max length exceeded: map length ("+b_+") > maxMapLengthLength ("+this.maxMapLength+")");this.stack.push({type:1,size:b_,key:null,readCount:0,map:{}})},t0.prototype.pushArrayState=function(b_){if(b_>this.maxArrayLength)throw new k_("Max length exceeded: array length ("+b_+") > maxArrayLength ("+this.maxArrayLength+")");this.stack.push({type:0,size:b_,array:new Array(b_),position:0})},t0.prototype.decodeUtf8String=function(b_,z_){var l0;if(b_>this.maxStrLength)throw new k_("Max length exceeded: UTF-8 byte length ("+b_+") > maxStrLength ("+this.maxStrLength+")");if(this.bytes.byteLength<this.pos+z_+b_)throw K0;var n0,oI,e1,F0=this.pos+z_;return n0=this.stateIsMapKey()&&(null===(l0=this.keyDecoder)||void 0===l0?void 0:l0.canBeCached(b_))?this.keyDecoder.decode(this.bytes,F0,b_):b_>g_?(e1=this.bytes.subarray(oI=F0,oI+b_),u_.decode(e1)):o_(this.bytes,F0,b_),this.pos+=z_+b_,n0},t0.prototype.stateIsMapKey=function(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type},t0.prototype.decodeBinary=function(b_,z_){if(b_>this.maxBinLength)throw new k_("Max length exceeded: bin length ("+b_+") > maxBinLength ("+this.maxBinLength+")");if(!this.hasRemaining(b_+z_))throw K0;var l0=this.pos+z_,n0=this.bytes.subarray(l0,l0+b_);return this.pos+=z_+b_,n0},t0.prototype.decodeExtension=function(b_,z_){if(b_>this.maxExtLength)throw new k_("Max length exceeded: ext length ("+b_+") > maxExtLength ("+this.maxExtLength+")");var l0=this.view.getInt8(this.pos+z_),n0=this.decodeBinary(b_,z_+1);return this.extensionCodec.decode(n0,l0,this.context)},t0.prototype.lookU8=function(){return this.view.getUint8(this.pos)},t0.prototype.lookU16=function(){return this.view.getUint16(this.pos)},t0.prototype.lookU32=function(){return this.view.getUint32(this.pos)},t0.prototype.readU8=function(){var b_=this.view.getUint8(this.pos);return this.pos++,b_},t0.prototype.readI8=function(){var b_=this.view.getInt8(this.pos);return this.pos++,b_},t0.prototype.readU16=function(){var b_=this.view.getUint16(this.pos);return this.pos+=2,b_},t0.prototype.readI16=function(){var b_=this.view.getInt16(this.pos);return this.pos+=2,b_},t0.prototype.readU32=function(){var b_=this.view.getUint32(this.pos);return this.pos+=4,b_},t0.prototype.readI32=function(){var b_=this.view.getInt32(this.pos);return this.pos+=4,b_},t0.prototype.readU64=function(){var b_,z_,l0=4294967296*(b_=this.view).getUint32(z_=this.pos)+b_.getUint32(z_+4);return this.pos+=8,l0},t0.prototype.readI64=function(){var b_=j(this.view,this.pos);return this.pos+=8,b_},t0.prototype.readF32=function(){var b_=this.view.getFloat32(this.pos);return this.pos+=4,b_},t0.prototype.readF64=function(){var b_=this.view.getFloat64(this.pos);return this.pos+=8,b_},t0}(),WI={};function q1(t0,b_){return void 0===b_&&(b_=WI),new MI(b_.extensionCodec,b_.context,b_.maxStrLength,b_.maxBinLength,b_.maxArrayLength,b_.maxMapLength,b_.maxExtLength).decode(t0)}function JO(t0,b_){return void 0===b_&&(b_=WI),new MI(b_.extensionCodec,b_.context,b_.maxStrLength,b_.maxBinLength,b_.maxArrayLength,b_.maxMapLength,b_.maxExtLength).decodeMulti(t0)}var UR=function(t0,b_){var z_,l0,n0,F0,L0={label:0,sent:function(){if(1&n0[0])throw n0[1];return n0[1]},trys:[],ops:[]};return F0={next:oI(0),throw:oI(1),return:oI(2)},"function"==typeof Symbol&&(F0[Symbol.iterator]=function(){return this}),F0;function oI(HI){return function(e1){return function(J0){if(z_)throw new TypeError("Generator is already executing.");for(;L0;)try{if(z_=1,l0&&(n0=2&J0[0]?l0.return:J0[0]?l0.throw||((n0=l0.return)&&n0.call(l0),0):l0.next)&&!(n0=n0.call(l0,J0[1])).done)return n0;switch(l0=0,n0&&(J0=[2&J0[0],n0.value]),J0[0]){case 0:case 1:n0=J0;break;case 4:return L0.label++,{value:J0[1],done:!1};case 5:L0.label++,l0=J0[1],J0=[0];continue;case 7:J0=L0.ops.pop(),L0.trys.pop();continue;default:if(!((n0=(n0=L0.trys).length>0&&n0[n0.length-1])||6!==J0[0]&&2!==J0[0])){L0=0;continue}if(3===J0[0]&&(!n0||J0[1]>n0[0]&&J0[1]<n0[3])){L0.label=J0[1];break}if(6===J0[0]&&L0.label<n0[1]){L0.label=n0[1],n0=J0;break}if(n0&&L0.label<n0[2]){L0.label=n0[2],L0.ops.push(J0);break}n0[2]&&L0.ops.pop(),L0.trys.pop();continue}J0=b_.call(t0,L0)}catch(cI){J0=[6,cI],l0=0}finally{z_=n0=0}if(5&J0[0])throw J0[1];return{value:J0[0]?J0[1]:void 0,done:!0}}([HI,e1])}}},aT=function(t0){return this instanceof aT?(this.v=t0,this):new aT(t0)},$1=function(t0,b_,z_){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l0,n0=z_.apply(t0,b_||[]),F0=[];return l0={},L0("next"),L0("throw"),L0("return"),l0[Symbol.asyncIterator]=function(){return this},l0;function L0(cI){n0[cI]&&(l0[cI]=function(BI){return new Promise(function(b1,zT){F0.push([cI,BI,b1,zT])>1||oI(cI,BI)})})}function oI(cI,BI){try{(b1=n0[cI](BI)).value instanceof aT?Promise.resolve(b1.value.v).then(HI,e1):J0(F0[0][2],b1)}catch(zT){J0(F0[0][3],zT)}var b1}function HI(cI){oI("next",cI)}function e1(cI){oI("throw",cI)}function J0(cI,BI){cI(BI),F0.shift(),F0.length&&oI(F0[0][0],F0[0][1])}};function nR(t0){if(null==t0)throw new Error("Assertion Failure: value must not be null nor undefined")}function f3(t0){return null!=t0[Symbol.asyncIterator]?t0:function(b_){return $1(this,arguments,function(){var z_,l0,F0;return UR(this,function(L0){switch(L0.label){case 0:z_=b_.getReader(),L0.label=1;case 1:L0.trys.push([1,,9,10]),L0.label=2;case 2:return[4,aT(z_.read())];case 3:return l0=L0.sent(),F0=l0.value,l0.done?[4,aT(void 0)]:[3,5];case 4:return[2,L0.sent()];case 5:return nR(F0),[4,aT(F0)];case 6:return[4,L0.sent()];case 7:return L0.sent(),[3,2];case 8:return[3,10];case 9:return z_.releaseLock(),[7];case 10:return[2]}})})}(t0)}function JL(t0,b_){return void 0===b_&&(b_=WI),z_=this,void 0,F0=function(){var L0;return function(oI,HI){var e1,J0,cI,BI,b1={label:0,sent:function(){if(1&cI[0])throw cI[1];return cI[1]},trys:[],ops:[]};return BI={next:zT(0),throw:zT(1),return:zT(2)},"function"==typeof Symbol&&(BI[Symbol.iterator]=function(){return this}),BI;function zT(TN){return function(X0){return function(aI){if(e1)throw new TypeError("Generator is already executing.");for(;b1;)try{if(e1=1,J0&&(cI=2&aI[0]?J0.return:aI[0]?J0.throw||((cI=J0.return)&&cI.call(J0),0):J0.next)&&!(cI=cI.call(J0,aI[1])).done)return cI;switch(J0=0,cI&&(aI=[2&aI[0],cI.value]),aI[0]){case 0:case 1:cI=aI;break;case 4:return b1.label++,{value:aI[1],done:!1};case 5:b1.label++,J0=aI[1],aI=[0];continue;case 7:aI=b1.ops.pop(),b1.trys.pop();continue;default:if(!((cI=(cI=b1.trys).length>0&&cI[cI.length-1])||6!==aI[0]&&2!==aI[0])){b1=0;continue}if(3===aI[0]&&(!cI||aI[1]>cI[0]&&aI[1]<cI[3])){b1.label=aI[1];break}if(6===aI[0]&&b1.label<cI[1]){b1.label=cI[1],cI=aI;break}if(cI&&b1.label<cI[2]){b1.label=cI[2],b1.ops.push(aI);break}cI[2]&&b1.ops.pop(),b1.trys.pop();continue}aI=HI.call(oI,b1)}catch(ZI){aI=[6,ZI],J0=0}finally{e1=cI=0}if(5&aI[0])throw aI[1];return{value:aI[0]?aI[1]:void 0,done:!0}}([TN,X0])}}}(this,function(oI){return L0=f3(t0),[2,new MI(b_.extensionCodec,b_.context,b_.maxStrLength,b_.maxBinLength,b_.maxArrayLength,b_.maxMapLength,b_.maxExtLength).decodeAsync(L0)]})},new((n0=void 0)||(n0=Promise))(function(L0,oI){function HI(cI){try{J0(F0.next(cI))}catch(BI){oI(BI)}}function e1(cI){try{J0(F0.throw(cI))}catch(BI){oI(BI)}}function J0(cI){var BI;cI.done?L0(cI.value):(BI=cI.value,BI instanceof n0?BI:new n0(function(b1){b1(BI)})).then(HI,e1)}J0((F0=F0.apply(z_,[])).next())});var z_,n0,F0}function p3(t0,b_){void 0===b_&&(b_=WI);var z_=f3(t0);return new MI(b_.extensionCodec,b_.context,b_.maxStrLength,b_.maxBinLength,b_.maxArrayLength,b_.maxMapLength,b_.maxExtLength).decodeArrayStream(z_)}function ES(t0,b_){void 0===b_&&(b_=WI);var z_=f3(t0);return new MI(b_.extensionCodec,b_.context,b_.maxStrLength,b_.maxBinLength,b_.maxArrayLength,b_.maxMapLength,b_.maxExtLength).decodeStream(z_)}function nEe(t0,b_){return void 0===b_&&(b_=WI),ES(t0,b_)}return y}()})(iY),(0,T0.exports)("Int8",function(s){return function(p,A,y){return s(this,p,A,y)}}),(0,T0.exports)("Int16",function(s){return function(p,A,y){return s(this,p,A,y)}}),(0,T0.exports)("Int32",function(s){return function(p,A,y){return s(this,p,A,y)}}),(0,T0.exports)("Uint16",function(s){return function(p,A,y){return s(this,p,A,y)}}),(0,T0.exports)("Uint32",function(s){return function(p,A,y){return s(this,p,A,y)}}),(0,T0.exports)("Float32",function(s){return function(p,A,y){return s(this,p,A,y)}}),(0,T0.exports)("Float64",function(s){return function(p,A,y){return s(this,p,A,y)}});const AG=()=>function(s){const p=window.atob("AGFzbQEAAAABMAlgA39/fwF/YAF/AGACf38AYAF/AX9gAn9/AX9gA39/fwBgBH9/f38AYAABf2AAAAI6AgNlbnYWZW1zY3JpcHRlbl9yZXNpemVfaGVhcAADA2VudhVlbXNjcmlwdGVuX21lbWNweV9iaWcAAAMjIggAAAAAAQEDAQEEBAQEAQEGAQYCBQUAAgAHAwEDAAIHAQMEBQFwAQYGBQYBAYACgAIGCQF/AUHQ48ACCweUAQoGbWVtb3J5AgARX193YXNtX2NhbGxfY3RvcnMAAhlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQAGbWFsbG9jABwEZnJlZQAdEF9fZXJybm9fbG9jYXRpb24AGwx6bGliQ29tcHJlc3MAGglzdGFja1NhdmUAIQxzdGFja1Jlc3RvcmUAIgpzdGFja0FsbG9jACMJCwEAQQELBRgZDA0PCq6FAiIDAAELpQcBBH8gAEH//wNxIQMgAEEQdiEEQQEhACACQQFGBEAgAyABLQAAaiIAQfH/A2sgACAAQfD/A0sbIgAgBGoiA0EQdCIEQYCAPGogBCADQfD/A0sbIAByDwsgAQR/IAJBEE8EQAJAAkACQCACQa8rSwRAA0AgAkGwK2shAkHbAiEFIAEhAANAIAMgAC0AAGoiAyAEaiADIAAtAAFqIgNqIAMgAC0AAmoiA2ogAyAALQADaiIDaiADIAAtAARqIgNqIAMgAC0ABWoiA2ogAyAALQAGaiIDaiADIAAtAAdqIgNqIAMgAC0ACGoiA2ogAyAALQAJaiIDaiADIAAtAApqIgNqIAMgAC0AC2oiA2ogAyAALQAMaiIDaiADIAAtAA1qIgNqIAMgAC0ADmoiA2ogAyAALQAPaiIDaiEEIABBEGohACAFQQFrIgUNAAsgBEHx/wNwIQQgA0Hx/wNwIQMgAUGwK2ohASACQa8rSw0ACyACRQ0DIAJBEEkNAQsDQCADIAEtAABqIgAgBGogACABLQABaiIAaiAAIAEtAAJqIgBqIAAgAS0AA2oiAGogACABLQAEaiIAaiAAIAEtAAVqIgBqIAAgAS0ABmoiAGogACABLQAHaiIAaiAAIAEtAAhqIgBqIAAgAS0ACWoiAGogACABLQAKaiIAaiAAIAEtAAtqIgBqIAAgAS0ADGoiAGogACABLQANaiIAaiAAIAEtAA5qIgBqIAAgAS0AD2oiA2ohBCABQRBqIQEgAkEQayICQQ9LDQALIAJFDQELIAJBAWshBiACQQNxIgUEQCABIQADQCACQQFrIQIgAyAALQAAaiIDIARqIQQgAEEBaiIBIQAgBUEBayIFDQALCyAGQQNJDQADQCADIAEtAABqIgAgAS0AAWoiBSABLQACaiIGIAEtAANqIgMgBiAFIAAgBGpqamohBCABQQRqIQEgAkEEayICDQALCyAEQfH/A3AhBCADQfH/A3AhAwsgBEEQdCADcg8LAkAgAkUNACACQQFrIQYgAkEDcSIFBEAgASEAA0AgAkEBayECIAMgAC0AAGoiAyAEaiEEIABBAWoiASEAIAVBAWsiBQ0ACwsgBkEDSQ0AA0AgAyABLQAAaiIAIAEtAAFqIgUgAS0AAmoiBiABLQADaiIDIAYgBSAAIARqampqIQQgAUEEaiEBIAJBBGsiAg0ACwsgBEHx/wNwQRB0IANB8f8DayADIANB8P8DSxtyBSAACwsKACAAIAEgAhADC4UJAQJ/IAFFBEBBAA8LIABBf3MhAAJAIAJFDQAgAUEDcUUNACABLQAAIABB/wFxc0ECdEGACGooAgAgAEEIdnMhACACQQFrIgRBACABQQFqIgNBA3EbRQRAIAMhASAEIQIMAQsgAS0AASAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUECaiEDAkAgAkECayIERQ0AIANBA3FFDQAgAS0AAiAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUEDaiEDAkAgAkEDayIERQ0AIANBA3FFDQAgAS0AAyAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAkEEayECIAFBBGohAQwCCyADIQEgBCECDAELIAMhASAEIQILIAJBH0sEQANAIAEoAhwgASgCGCABKAIUIAEoAhAgASgCDCABKAIIIAEoAgQgASgCACAAcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAc3MiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAc3MiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAcyEAIAFBIGohASACQSBrIgJBH0sNAAsLIAJBA0sEQANAIAEoAgAgAHMiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzIQAgAUEEaiEBIAJBBGsiAkEDSw0ACwsCQCACRQ0AIAJBAXEEfyABLQAAIABB/wFxc0ECdEGACGooAgAgAEEIdnMhACABQQFqIQEgAkEBawUgAgshAyACQQFGDQADQCABLQABIAEtAAAgAEH/AXFzQQJ0QYAIaigCACAAQQh2cyIAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUECaiEBIANBAmsiAw0ACwsgAEF/cwsKACAAIAEgAhAFC9wEAQN/AkBByN8ALQAAQTFHDQAgAEUNACAAQQA2AhggACgCICIBRQRAIABBADYCKCAAQQE2AiBBASEBCyAAKAIkRQRAIABBAjYCJAsgACgCKEEBQcQtIAERAAAiAUUNACAAIAE2AhwgAUEPNgIwIAFBADYCHCABQQA2AhggAUEqNgIEIAEgADYCACABQQs2AlAgAUGAgAI2AiwgAUH//wE2AjQgAUGAEDYCTCABQQQ2AlggAUH/DzYCVCABIAAoAihBgIACQQIgACgCIBEAADYCOCABIAAoAiggASgCLEECIAAoAiARAAA2AkAgACgCKCABKAJMQQIgACgCIBEAACECIAFBADYCwC0gASACNgJEIAFBgAg2ApwtIAEgACgCKEGACEEEIAAoAiARAAAiAjYCCCABIAEoApwtIgNBAnQ2AgwCQAJAIAEoAjhFDQAgASgCQEUNACACRQ0AIAEoAkQNAQsgAUGaBTYCBCAAQbjfACgCADYCGCAAEAgPCyABQQA2AogBIAFBCTYChAEgAUEIOgAkIAEgAiADQQNsajYCmC0gASACIANBfnFqNgKkLSAAEAkNACAAKAIcIgAgACgCLEEBdDYCPCAAKAJEIgEgACgCTEEBdEECayIDakEAOwEAIAEgAxAgIABBADYCtC0gAEKAgICAIDcCdCAAQgA3AmggAEKAgICAIDcCXCAAQQA2AkggACAAKAKEAUEMbCIBQYTIAGovAQA2ApABIAAgAUGAyABqLwEANgKMASAAIAFBgsgAai8BADYCgAEgACABQYbIAGovAQA2AnwLC6kCAQN/AkAgAEUNACAAKAIgRQ0AIAAoAiQiA0UNACAAKAIcIgFFDQAgASgCACAARw0AAkACQCABKAIEIgJBOWsOOQECAgICAgICAgICAgECAgIBAgICAgICAgICAgICAgICAgIBAgICAgICAgICAgIBAgICAgICAgICAQALIAJBmgVGDQAgAkEqRw0BCwJ/An8CfyABKAIIIgIEQCAAKAIoIAIgAxECACAAKAIcIQELIAEoAkQiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAEoAkAiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAEoAjgiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAAoAiggASAAKAIkEQIAIABBADYCHAsLlgIBA39BfiECAkAgAEUNACAAKAIgRQ0AIAAoAiRFDQAgACgCHCIBRQ0AIAEoAgAgAEcNAAJAAkAgASgCBCIDQTlrDjkBAgICAgICAgICAgIBAgICAQICAgICAgICAgICAgICAgICAQICAgICAgICAgICAQICAgICAgICAgEACyADQZoFRg0AIANBKkcNAQsgAEECNgIsIABBADYCCCAAQgA3AhQgAUEANgIUIAEgASgCCDYCECABKAIYIgJBf0wEQCABQQAgAmsiAjYCGAsgAUE5QSpB8QAgAhsgAkECRhs2AgQgAAJ/IAJBAkYEQEEAQQBBABAGDAELQQBBAEEAEAQLNgIwQQAhAiABQQA2AiggARAQCyACC9wIAQt/IAAoAiwiB0GGAmshCyAAKAJ0IQUgByEBA0AgACgCPCAFayAAKAJsIghrIQYgASALaiAITQRAIAAoAjgiASABIAdqIAcgBmsQHxogACAAKAJwIAdrNgJwIAAgACgCbCAHayIINgJsIAAgACgCXCAHazYCXCAAKAJMIgRBAWshCiAAKAJEIARBAXRqIQMgACgCLCEBIARBA3EiAgRAA0AgA0ECayIDQQAgAy8BACIFIAFrIgkgBSAJSRs7AQAgBEEBayEEIAJBAWsiAg0ACwsgCkEDTwRAA0AgA0ECayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EEayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EGayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EIayIDQQAgAy8BACICIAFrIgUgAiAFSRs7AQAgBEEEayIEDQALCyABQQFrIQogACgCQCABQQF0aiEDIAEhBCABQQNxIgIEQANAIANBAmsiA0EAIAMvAQAiBSABayIJIAUgCUkbOwEAIARBAWshBCACQQFrIgINAAsLIApBA08EQANAIANBAmsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBBGsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBBmsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBCGsiA0EAIAMvAQAiAiABayIFIAIgBUkbOwEAIARBBGsiBA0ACwsgBiAHaiEGCwJAIAAoAgAiASgCBCIERQ0AIAAoAnQhAiAGIAQgBCAGSxsiAwRAIAAoAjghBSABIAQgA2s2AgQgBSAIaiACaiABKAIAIAMQHyEEAkACQAJAIAEoAhwoAhhBAWsOAgABAgsgASABKAIwIAQgAxAENgIwDAELIAEgASgCMCAEIAMQBjYCMAsgASABKAIAIANqNgIAIAEgASgCCCADajYCCCAAKAJ0IQILIAAgAiADaiIFNgJ0AkAgACgCtC0iAyAFakEDSQ0AIAAgACgCOCIJIAAoAmwgA2siAWoiBC0AACICNgJIIAAgACgCVCIIIAQtAAEgAiAAKAJYIgZ0c3EiBDYCSANAIANFDQEgACABIAlqLQACIAQgBnRzIAhxIgQ2AkggACgCQCAAKAI0IAFxQQF0aiAAKAJEIARBAXRqIgIvAQA7AQAgAiABOwEAIAAgA0EBayIDNgK0LSABQQFqIQEgAyAFakECSw0ACwsgBUGFAksNACAAKAIAKAIERQ0AIAAoAiwhAQwBCwsCQCAAKAI8IgQgACgCwC0iAU0NACAAKAJ0IAAoAmxqIgMgAUsEQCAAKAI4IANqIAQgA2siAUGCAiABQYICSRsiARAgIAAgASADajYCwC0PCyADQYICaiIDIAFNDQAgACgCOCABaiAEIAFrIgQgAyABayIBIAEgBEsbIgEQICAAIAAoAsAtIAFqNgLALQsLsSwBCn8CQCAARQ0AIAAoAiBFDQAgACgCJEUNACAAKAIcIgFFDQAgASgCACAARw0AAkACQCABKAIEIgNBOWsOOQECAgICAgICAgICAgECAgIBAgICAgICAgICAgICAgICAgIBAgICAgICAgICAgIBAgICAgICAgICAQALIANBmgVGDQAgA0EqRw0BCwJAAkAgACgCDEUNACAAKAIEIgIEQCAAKAIARQ0BCyADQZoFRw0BCyAAQbDfACgCADYCGA8LIAAoAhBFBEAgAEG83wAoAgA2AhgPCyABKAIoIQUgAUEDNgIoAkAgASgCFARAIAEQEwJAIAAoAhAiAyABKAIUIgQgAyAESRsiAkUNACAAKAIMIAEoAhAgAhAfGiAAIAAoAgwgAmo2AgwgASABKAIQIAJqNgIQIAAgACgCFCACajYCFCAAIAAoAhAgAmsiAzYCECABIAEoAhQgAmsiBDYCFCAEDQAgASABKAIINgIQQQAhBAsgAwRAIAEoAgQhAwwCCyABQX82AigPCyACDQAgBUEBdEF3QQAgBUEEShtqQQZIDQAgAEG83wAoAgA2AhgPCwJAAkACQAJAAn8CQAJAAkACQAJAAkAgA0EqRwRAIANBmgVHDQEgACgCBEUNAiAAQbzfACgCADYCGA8LIAEoAjBBDHRBgPABayEDQQAhAgJAIAEoAogBQQFKDQAgASgChAEiBUECSA0AQcAAIQIgBUEGSA0AQYABQcABIAVBBkYbIQILIAEgBEEBajYCFCABKAIIIARqIAIgA3IiAkEgciACIAEoAmwbIgJBCHY6AAAgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQR9wIAJyQR9zOgAAIAEoAmwEQCAAKAIwIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQRh2OgAAIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAkEQdjoAACAAKAIwIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQQh2OgAAIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAjoAAAsgAEEAQQBBABAENgIwIAFB8QA2AgQgACgCHCICEBMCQCAAKAIQIgMgAigCFCIEIAMgBEkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQNBCABKAIEIQMLAkACQAJAAkACQAJAAkAgA0E5RgR/IABBAEEAQQAQBjYCMCABIAEoAhQiAkEBajYCFCACIAEoAghqQR86AAAgASABKAIUIgJBAWo2AhQgAiABKAIIakGLAToAACABIAEoAhQiAkEBajYCFCACIAEoAghqQQg6AAAgASgCHCICDQIgASABKAIUIgJBAWo2AhQgAiABKAIIakEAOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBADoAACABIAEoAhQiAkEBajYCFCACIAEoAghqQQA6AAAgASABKAIUIgJBAWo2AhQgAiABKAIIakEAOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBADoAAEECIQIgASgChAEiA0EJRwRAQQQgASgCiAFBAUpBAnQgA0ECSBshAgsgASABKAIUIgNBAWo2AhQgAyABKAIIaiACOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBAzoAACABQfEANgIEIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQCyABKAIUDQEgASgCBAUgAwtBxQBrDiMCBgYGAwYGBgYGBgYGBgYGBgYGBgYGBAYGBgYGBgYGBgYGBQYLIAFBfzYCKA8LIAIoAiQhAyACKAIcIQQgAigCECEFIAIoAiwhBiACKAIAIQggASABKAIUIgdBAWo2AhRBAiECIAcgASgCCGogBkEAR0EBdCAIQQBHciAFQQBHQQJ0ciAEQQBHQQN0ciADQQBHQQR0cjoAACABKAIcKAIEIQMgASABKAIUIgRBAWo2AhQgBCABKAIIaiADOgAAIAEoAhwoAgQhAyABIAEoAhQiBEEBajYCFCAEIAEoAghqIANBCHY6AAAgASgCHC8BBiEDIAEgASgCFCIEQQFqNgIUIAQgASgCCGogAzoAACABKAIcLQAHIQMgASABKAIUIgRBAWo2AhQgBCABKAIIaiADOgAAIAEoAoQBIgNBCUcEQEEEIAEoAogBQQFKQQJ0IANBAkgbIQILIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAjoAACABKAIcKAIMIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACOgAAIAEoAhwiAigCEAR/IAIoAhQhAiABIAEoAhQiA0EBajYCFCADIAEoAghqIAI6AAAgASgCHCgCFCECIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAkEIdjoAACABKAIcBSACCygCLARAIAAgACgCMCABKAIIIAEoAhQQBjYCMAsgAUHFADYCBCABQQA2AiALIAEoAhwiBCgCECIDBEAgASgCFCICIAQvARQgASgCICIGayIFaiABKAIMIgRLBEADQCABKAIIIAJqIAMgBmogBCACayIEEB8aIAEgASgCDCIDNgIUAkAgAiADTw0AIAEoAhwoAixFDQAgACAAKAIwIAEoAgggAmogAyACaxAGNgIwCyABIAEoAiAgBGo2AiAgACgCHCICEBMCQCAAKAIQIgMgAigCFCIGIAMgBkkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQEQCABQX82AigPCyABKAIgIQYgASgCHCgCECEDQQAhAiAFIARrIgUgASgCDCIESw0ACwsgASgCCCACaiADIAZqIAUQHxogASABKAIUIAVqIgM2AhQCQCACIANPDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCACaiADIAJrEAY2AjALIAFBADYCIAsgAUHJADYCBAsgASgCHCgCHARAIAEoAhQiAiEFA0ACQCACIAEoAgxHDQACQCACIAVNDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQC0EAIQJBACEFIAEoAhRFDQAgAUF/NgIoDwsgASgCHCgCHCEDIAEgASgCICIEQQFqNgIgIAMgBGotAAAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAMEQCABKAIUIQIMAQsLAkAgASgCHCgCLEUNACABKAIUIgIgBU0NACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAFBADYCIAsgAUHbADYCBAsCQCABKAIcKAIkRQ0AIAEoAhQiAiEFA0ACQCACIAEoAgxHDQACQCACIAVNDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQC0EAIQJBACEFIAEoAhRFDQAgAUF/NgIoDwsgASgCHCgCJCEDIAEgASgCICIEQQFqNgIgIAMgBGotAAAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAMEQCABKAIUIQIMAQsLIAEoAhwoAixFDQAgASgCFCICIAVNDQAgACAAKAIwIAEoAgggBWogAiAFaxAGNgIwCyABQecANgIECyABKAIcKAIsBEAgASgCDCABKAIUIgJBAmpJBEAgACgCHCICEBMCQCAAKAIQIgMgAigCFCIEIAMgBEkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQNBUEAIQILIAAoAjAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAAoAjAhAiABIAEoAhQiA0EBajYCFCADIAEoAghqIAJBCHY6AAAgAEEAQQBBABAGNgIwCyABQfEANgIEIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQCyABKAIURQ0AIAFBfzYCKA8LIAAoAgQNAQsgASgCdA0AIAEoAgRBmgVGDQgLIAEoAoQBIgJFBEAgAUEDEAwMBAsCQAJAIAEoAogBQQJrDgIAAQQLA0ACQAJAIAEoAnQNACABEAogASgCdA0AIAFBADYCtC0MAQsgAUEANgJgIAEoAjggASgCbGotAAAhAiABKAKkLSABKAKgLSIDQQF0akEAOwEAIAEgA0EBajYCoC0gAyABKAKYLWogAjoAACABIAJBAnRqQZQBaiICIAIvAQBBAWo7AQAgASABKAJ0QQFrNgJ0IAEgASgCbEEBaiICNgJsIAEoAqAtIAEoApwtQQFrRw0BIAEgASgCXCIEQQBOBH8gASgCOCAEagVBAAsgAiAEa0EAEBQgASABKAJsNgJcIAEoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALIAEoAgAoAhANAQwHCwsgASgCoC1FDQcgASABKAJcIgNBAE4EfyABKAI4IANqBUEACyABKAJsIANrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEEUNBQwHCwNAAkACQAJAIAEoAnQiAkGDAk8EQCABQQA2AmAMAQsgARAKIAEoAnQiAgRAIAFBADYCYCACQQJLDQEgASgCbCEDDAILIAFBADYCtC0gASgCoC1FDQogASABKAJcIgNBAE4EfyABKAI4IANqBUEACyABKAJsIANrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEEUNCAwKCyABKAJsIgNFBEBBACEDDAELIAEoAjggA2oiBkEBayIFLQAAIgQgBi0AAEcNACAEIAUtAAJHDQAgBCAFLQADRw0AIAZBggJqIQlBfyEIAkACQAJAAkACQAJAA0AgBiAIaiIFLQAEIARGBEAgBCAFLQAFRw0CIAQgBS0ABkcNAyAEIAUtAAdHDQQgBCAGIAhBCGoiCmoiBy0AAEcNByAEIAUtAAlHDQUgBCAFLQAKRw0GIAVBC2ohByAIQfYBSg0HIAohCCAEIActAABGDQEMBwsLIAVBBGohBwwFCyAFQQVqIQcMBAsgBUEGaiEHDAMLIAVBB2ohBwwCCyAFQQlqIQcMAQsgBUEKaiEHCyABIAIgByAJa0GCAmoiBCACIARJGyICNgJgIAJBA0kNACABKAKkLSABKAKgLSIDQQF0akEBOwEAIAEgA0EBajYCoC0gAyABKAKYLWogAkEDayICOgAAIAJB/wFxQYDNAGotAABBAnQgAWpBmAlqIgIgAi8BAEEBajsBACABQYDJAC0AAEECdGpBiBNqIgIgAi8BAEEBajsBACABKAJgIQIgAUEANgJgIAEgASgCdCACazYCdCABIAIgASgCbGoiAjYCbCABKAKgLSABKAKcLUEBa0cNAgwBCyABKAI4IANqLQAAIQIgASgCpC0gASgCoC0iA0EBdGpBADsBACABIANBAWo2AqAtIAMgASgCmC1qIAI6AAAgASACQQJ0akGUAWoiAiACLwEAQQFqOwEAIAEgASgCdEEBazYCdCABIAEoAmxBAWoiAjYCbCABKAKgLSABKAKcLUEBa0cNAQsgASABKAJcIgRBAE4EfyABKAI4IARqBUEACyACIARrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEA0ACwwECyABQX82AigPCyABQX82AigPCyABQQMgAkEMbEGIyABqKAIAEQQACyICQX5xQQJGBEAgAUGaBTYCBAsgAkF9cQ0BCyAAKAIQDQMgAUF/NgIoDwsgAkEBRw0BCyABQQBBAEEAEBIgASgCRCICIAEoAkxBAXRBAmsiA2pBADsBACACIAMQICABKAJ0RQRAIAFBADYCtC0gAUEANgJcIAFBADYCbAsgACgCHCICEBMCQCAAKAIQIgQgAigCFCIDIAMgBEsbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrIgQ2AhAgAiACKAIUIANrIgM2AhQgAw0AIAIgAigCCDYCEAsgBA0AIAFBfzYCKAsLC7YNAQt/IAAoAgAiBCgCBCEJQQEhCAJAIAQoAhAiAyAAKAK8LUEqakEDdSICSQ0AIAAoAiwiBSAAKAIMQQVrIgYgBSAGSRshCiABQQRHIQsDQCAKIAMgAmsiAyAAKAJsIAAoAlxrIgYgBCgCBGoiAkH//wMgAkH//wNJGyIFIAMgBUkbIgNLBEAgAiADRw0CIAFFDQIgCyADRXENAgsgAEEAQQAgAUEERiACIANGcSIHEBIgACgCFCAAKAIIakEEayADOgAAIAAoAhQgACgCCGpBA2sgA0EIdjoAACAAKAIUIAAoAghqQQJrIANBf3MiAjoAACAAKAIUIAAoAghqQQFrIAJBCHY6AAAgACgCACICKAIcIgQQEwJAIAIoAhAiBSAEKAIUIgwgBSAMSRsiBUUNACACKAIMIAQoAhAgBRAfGiACIAIoAgwgBWo2AgwgBCAEKAIQIAVqNgIQIAIgAigCFCAFajYCFCACIAIoAhAgBWs2AhAgBCAEKAIUIAVrIgI2AhQgAg0AIAQgBCgCCDYCEAsCfyAGBEAgACgCACgCDCAAKAI4IAAoAlxqIAMgBiADIAZJGyICEB8aIAAoAgAiBCAEKAIMIAJqNgIMIAQgBCgCECACazYCECAEIAQoAhQgAmo2AhQgACAAKAJcIAJqNgJcIAMgAmshAwsgAwsEQCAAKAIAIgIoAgwhBSADIAIoAgQiBiADIAZJGyIEBEAgAiAGIARrNgIEIAUgAigCACAEEB8hBQJAAkACQCACKAIcKAIYQQFrDgIAAQILIAIgAigCMCAFIAQQBDYCMAwBCyACIAIoAjAgBSAEEAY2AjALIAIgAigCACAEajYCACACIAIoAgggBGo2AgggACgCACICKAIMIQULIAIgAyAFajYCDCACIAIoAhAgA2s2AhAgAiACKAIUIANqNgIUCyAAKAIAIQQgBwRAQQAhCAwCCyAEKAIQIgMgACgCvC1BKmpBA3UiAk8NAAsLAkAgCSAEKAIEayIDRQRAIAAoAmwhAgwBCwJAIAAoAiwiAiADTQRAIABBAjYCsC0gACgCOCAEKAIAIAJrIAIQHxogACAAKAIsIgQ2AmwgBCECDAELAkAgACgCPCAAKAJsIgRrIANLDQAgACAEIAJrIgQ2AmwgACgCOCIFIAIgBWogBBAfGiAAKAKwLSICQQFLDQAgACACQQFqNgKwLQsgACgCOCAAKAJsaiAAKAIAKAIAIANrIAMQHxogACAAKAJsIANqIgI2AmwgACgCLCEECyAAIAI2AlwgACAEIAAoArQtIgVrIgQgAyADIARLGyAFajYCtC0LIAIgACgCwC1LBEAgACACNgLALQtBAyEDAkAgCEUNACAAKAIAIgQoAgQhAwJAAkAgAUF7cUUNACADDQBBASEDIAIgACgCXEYNAiAAKAI8IAJBf3NqIQVBACEDDAELIAMgACgCPCACQX9zaiIFTQ0AIAAoAlwiByAAKAIsIgZIDQAgACACIAZrIgM2AmwgACAHIAZrNgJcIAAoAjgiAiACIAZqIAMQHxogACgCsC0iA0EBTQRAIAAgA0EBajYCsC0LIAAoAiwgBWohBSAAKAIAIgQoAgQhAwsCQCADIAUgAyAFSRsiAkUEQCAAKAJsIQMMAQsgACgCbCEFIAAoAjghBiAEIAMgAms2AgQgBSAGaiAEKAIAIAIQHyEDAkACQAJAIAQoAhwoAhhBAWsOAgABAgsgBCAEKAIwIAMgAhAENgIwDAELIAQgBCgCMCADIAIQBjYCMAsgBCAEKAIAIAJqNgIAIAQgBCgCCCACajYCCCAAIAAoAmwgAmoiAzYCbAsgAyAAKALALUsEQCAAIAM2AsAtCyADIAAoAlwiBmsiBCAAKAIsIgMgACgCDCAAKAK8LUEqakEDdWsiAkH//wMgAkH//wNJGyICIAIgA0sbSQRAQQAhAyABRQ0BIAFBBEYgBEEAR3JFDQEgAiAESQ0BIAAoAgAoAgQNAQtBACEFIAAgACgCOCAGaiACIAQgAiAESRsiAwJ/IAFBBEYEQCAAKAIAKAIERSACIARPcSEFCyAFCxASIAAgACgCXCADajYCXCAAKAIAIgAoAhwiAxATAkAgACgCECICIAMoAhQiBCACIARJGyICRQ0AIAAoAgwgAygCECACEB8aIAAgACgCDCACajYCDCADIAMoAhAgAmo2AhAgACAAKAIUIAJqNgIUIAAgACgCECACazYCECADIAMoAhQgAmsiADYCFCAADQAgAyADKAIINgIQC0ECQQAgBRshAwsgAwu5CwENfwJAA0ACQAJAIAAoAnRBhQJNBEAgABAKIAAoAnQhAgJAIAENACACQYYCTw0AQQAPCyACRQ0EIAJBA0kNAQsgACAAKAJUIAAoAmwiAiAAKAI4ai0AAiAAKAJIIAAoAlh0c3EiAzYCSCAAKAJAIAIgACgCNHFBAXRqIAAoAkQgA0EBdGoiBC8BACIDOwEAIAQgAjsBACADRQ0AIAAoAixBhgJrIAIgA2tJDQAgACAAIAMQDiICNgJgDAELIAAoAmAhAgsCQCACQQNPBEAgACgCpC0gACgCoC0iA0EBdGogACgCbCAAKAJwayIEOwEAIAAgA0EBajYCoC0gAyAAKAKYLWogAkEDayICOgAAIAJB/wFxQYDNAGotAABBAnQgAGpBmAlqIgIgAi8BAEEBajsBACAAIARBAWtB//8DcSICIAJBB3ZBgAJqIAJBgAJJG0GAyQBqLQAAQQJ0akGIE2oiAiACLwEAQQFqOwEAIAAgACgCdCAAKAJgIgJrIgM2AnQgACgCnC1BAWshBiAAKAKgLSEHAkAgA0EDSQ0AIAIgACgCgAFLDQAgACACQQFrIgM2AmAgACgCSCEEIAAoAmwhAiAAKAI0IQggACgCQCEJIAAoAkQhCiAAKAJUIQsgACgCOCEMIAAoAlghDQNAIAAgAiIFQQFqIgI2AmwgACAFIAxqLQADIAQgDXRzIAtxIgQ2AkggCSACIAhxQQF0aiAKIARBAXRqIg4vAQA7AQAgDiACOwEAIAAgA0EBayIDNgJgIAMNAAsgACAFQQJqIgI2AmwgBiAHRw0DDAILIABBADYCYCAAIAAoAmwgAmoiAjYCbCAAIAAoAjggAmoiAy0AACIENgJIIAAgACgCVCADLQABIAQgACgCWHRzcTYCSCAGIAdHDQIMAQsgACgCOCAAKAJsai0AACECIAAoAqQtIAAoAqAtIgNBAXRqQQA7AQAgACADQQFqNgKgLSADIAAoApgtaiACOgAAIAAgAkECdGpBlAFqIgIgAi8BAEEBajsBACAAIAAoAnRBAWs2AnQgACAAKAJsQQFqIgI2AmwgACgCoC0gACgCnC1BAWtHDQELQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQCyAAKAIAKAIQDQALQQAPCyAAIAAoAmwiAkECIAJBAkkbNgK0LSABQQRGBEBBACEDIAAgACgCXCIEQQBOBH8gACgCOCAEagUgAwsgAiAEa0EBEBQgACAAKAJsNgJcIAAoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALQQNBAiAAKAIAKAIQGw8LAkAgACgCoC1FDQBBACEDIAAgACgCXCIEQQBOBH8gACgCOCAEagUgAwsgAiAEa0EAEBQgACAAKAJsNgJcIAAoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALIAAoAgAoAhANAEEADwtBAQukBAEQfyAAKAJ8IgMgA0ECdiAAKAJ4IgQgACgCjAFJGyEJQQAgACgCbCIDIAAoAixrQYYCaiICIAIgA0sbIQwgACgCdCIHIAAoApABIgIgAiAHSxshDSAAKAI4Ig4gA2oiBUGCAmohDyAEIAVqIgMtAAAhCiADQQFrLQAAIQsgACgCNCEQIAAoAkAhEQNAAkACQCABIA5qIgMgBGoiAi0AACAKRw0AIAJBAWstAAAgC0cNACADLQAAIAUtAABHDQBBAiEGIAMtAAEgBS0AAUcNAAJAAkACQAJAAkACQAJAA0AgBSAGaiICLQABIAMtAANHDQYgAi0AAiADLQAERw0FIAItAAMgAy0ABUcNBCACLQAEIAMtAAZHDQMgAi0ABSADLQAHRw0CIAItAAYgAy0ACEcNASACLQAHIAMtAAlGBEAgBkH5AUshCCAFIAZBCGoiBmohAiAIDQggAy0ACiEIIANBCGohAyACLQAAIAhGDQEMCAsLIAJBB2ohAgwGCyACQQZqIQIMBQsgAkEFaiECDAQLIAJBBGohAgwDCyACQQNqIQIMAgsgAkECaiECDAELIAJBAWohAgsgAiAPayICQYICaiIDIARMDQAgACABNgJwIAMgDU4EQCADIQQMAgsgAyAFai0AACEKIAIgBWotAIECIQsgAyEECyAJQQFrIglFDQAgDCARIAEgEHFBAXRqLwEAIgFJDQELCyAHIAQgBCAHSxsL3Q4BB38DQAJAAkACQCAAKAJ0QYUCSw0AIAAQCiAAKAJ0IQICQCABDQAgAkGGAk8NAEEADwsgAkUNAiACQQJLDQAgACAAKAJgIgI2AnggACAAKAJwNgJkQQIhAyAAQQI2AmAMAQtBAiEDIAAgACgCVCAAKAJsIgIgACgCOGotAAIgACgCSCAAKAJYdHNxIgQ2AkggACgCQCACIAAoAjRxQQF0aiAAKAJEIARBAXRqIgUvAQAiBDsBACAFIAI7AQAgACAAKAJgIgI2AnggACAAKAJwNgJkIABBAjYCYCAERQ0AAkAgAiAAKAKAAU8NACAAKAIsQYYCayAAKAJsIARrSQ0AIAAgACAEEA4iAzYCYCADQQVLDQAgACgCiAFBAUcEQCADQQNHDQFBAyEDIAAoAmwgACgCcGtBgSBJDQELQQIhAyAAQQI2AmALIAAoAnghAgsCQCACQQNJDQAgAiADSQ0AIAAoAnQhBCAAKAKkLSAAKAKgLSIDQQF0aiAAKAJsIgUgACgCZEF/c2oiBjsBACAAIANBAWo2AqAtIAMgACgCmC1qIAJBA2siAjoAACACQf8BcUGAzQBqLQAAQQJ0IABqQZgJaiICIAIvAQBBAWo7AQAgACAGQQFrQf//A3EiAiACQQd2QYACaiACQYACSRtBgMkAai0AAEECdGpBiBNqIgIgAi8BAEEBajsBACAAIAAoAngiAkECayIDNgJ4IAAgACgCdCACa0EBajYCdCAEIAVqQQNrIQUgACgCnC1BAWshByAAKAJsIQIgACgCoC0hCANAIAAgAiIEQQFqIgI2AmwgAiAFTQRAIAAgACgCVCAEIAAoAjhqLQADIAAoAkggACgCWHRzcSIGNgJIIAAoAkAgACgCNCACcUEBdGogACgCRCAGQQF0aiIGLwEAOwEAIAYgAjsBAAsgACADQQFrIgM2AnggAw0ACyAAQQI2AmAgAEEANgJoIAAgBEECaiICNgJsIAcgCEcNAkEAIQMgACAAKAJcIgRBAE4EfyAAKAI4IARqBSADCyACIARrQQAQFCAAIAAoAmw2AlwgACgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgACgCACgCEA0CQQAPCyAAKAJoBEAgACgCbCAAKAI4akEBay0AACECIAAoAqQtIAAoAqAtIgNBAXRqQQA7AQAgACADQQFqNgKgLSADIAAoApgtaiACOgAAIAAgAkECdGpBlAFqIgIgAi8BAEEBajsBAAJAIAAoAqAtIAAoApwtQQFrRw0AQQAhAyAAIAAoAlwiAkEATgR/IAAoAjggAmoFIAMLIAAoAmwgAmtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgACAAKAJsQQFqNgJsIAAgACgCdEEBazYCdCAAKAIAKAIQDQJBAA8FIABBATYCaCAAIAAoAmxBAWo2AmwgACAAKAJ0QQFrNgJ0DAILAAsLIAAoAmgEQCAAKAJsIAAoAjhqQQFrLQAAIQIgACgCpC0gACgCoC0iA0EBdGpBADsBACAAIANBAWo2AqAtIAMgACgCmC1qIAI6AAAgACACQQJ0akGUAWoiAiACLwEAQQFqOwEAIABBADYCaAsgACAAKAJsIgJBAiACQQJJGzYCtC0gAUEERgRAQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBARAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQC0EDQQIgACgCACgCEBsPCwJAIAAoAqAtRQ0AQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQCyAAKAIAKAIQDQBBAA8LQQELYQAgAEEANgK8LSAAQQA7AbgtIABBuBZqQajPADYCACAAIABB/BRqNgKwFiAAQawWakGUzwA2AgAgACAAQYgTajYCpBYgAEGgFmpBgM8ANgIAIAAgAEGUAWo2ApgWIAAQEQvwBAEDfyAAQZQBaiECA0AgAiABQQJ0IgNqQQA7AQAgAiADQQRyakEAOwEAIAFBAmoiAUGeAkcNAAsgAEEAOwH8FCAAQQA7AYgTIABBxBVqQQA7AQAgAEHAFWpBADsBACAAQbwVakEAOwEAIABBuBVqQQA7AQAgAEG0FWpBADsBACAAQbAVakEAOwEAIABBrBVqQQA7AQAgAEGoFWpBADsBACAAQaQVakEAOwEAIABBoBVqQQA7AQAgAEGcFWpBADsBACAAQZgVakEAOwEAIABBlBVqQQA7AQAgAEGQFWpBADsBACAAQYwVakEAOwEAIABBiBVqQQA7AQAgAEGEFWpBADsBACAAQYAVakEAOwEAIABB/BNqQQA7AQAgAEH4E2pBADsBACAAQfQTakEAOwEAIABB8BNqQQA7AQAgAEHsE2pBADsBACAAQegTakEAOwEAIABB5BNqQQA7AQAgAEHgE2pBADsBACAAQdwTakEAOwEAIABB2BNqQQA7AQAgAEHUE2pBADsBACAAQdATakEAOwEAIABBzBNqQQA7AQAgAEHIE2pBADsBACAAQcQTakEAOwEAIABBwBNqQQA7AQAgAEG8E2pBADsBACAAQbgTakEAOwEAIABBtBNqQQA7AQAgAEGwE2pBADsBACAAQawTakEAOwEAIABBqBNqQQA7AQAgAEGkE2pBADsBACAAQaATakEAOwEAIABBnBNqQQA7AQAgAEGYE2pBADsBACAAQZQTakEAOwEAIABBkBNqQQA7AQAgAEGME2pBADsBACAAQgA3AqwtIABBlAlqQQE7AQAgAEEANgKoLSAAQQA2AqAtC7IDAQJ/IAAgAC8BuC0gA0H//wNxIgUgACgCvC0iBHRyIgM7AbgtAkACQAJ/IARBDk4EQCAAIAAoAhQiBEEBajYCFCAEIAAoAghqIAM6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAAQbktai0AADoAACAAIAVBECAAKAK8LSIEa3YiAzsBuC0gBEENawwBCyAEQQNqCyIEQQlOBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiADOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGohBCAAQbktai0AACEDDAELIARBAUgNASAAIAAoAhQiBEEBajYCFCAEIAAoAghqIQQLIAQgAzoAAAsgAEEANgK8LSAAQQA7AbgtIAAgACgCFCIDQQFqNgIUIAMgACgCCGogAjoAACAAIAAoAhQiA0EBajYCFCADIAAoAghqIAJBCHY6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiACQX9zIgM6AAAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiADQQh2OgAAIAAoAgggACgCFGogASACEB8aIAAgACgCFCACajYCFAusAQEBfwJAIAACfyAAKAK8LSIBQRBGBEAgACAAKAIUIgFBAWo2AhQgASAAKAIIaiAALQC4LToAACAAIAAoAhQiAUEBajYCFCABIAAoAghqIABBuS1qLQAAOgAAIABBADsBuC1BAAwBCyABQQhIDQEgACAAKAIUIgFBAWo2AhQgASAAKAIIaiAALQC4LToAACAAIABBuS1qLQAAOwG4LSAAKAK8LUEIaws2ArwtCwuhEwENfwJ/AkACQAJAIAAoAoQBQQFOBEAgACgCACIGKAIsQQJHDQNB/4D/n38hBANAAkAgBEEBcUUNACAAIAVBAnRqLwGUAUUNAEEAIQQMBAsCQCAEQQJxRQ0AIAAgBUECdEEEcmovAZQBRQ0AQQAhBAwECyAEQQJ2IQQgBUECaiIFQSBHDQALDAELIAJBBWoiBQwDCwJAIAAvAbgBDQAgAC8BvAENACAALwHIAQ0AQSAhBQNAIAAgBUECdCIEai8BlAENASAAIARBBHJqLwGUAQ0BIAAgBEEIcmovAZQBDQEgACAEQQxyai8BlAENAUEAIQQgBUEEaiIFQYACRw0ACwwBC0EBIQQLIAYgBDYCLAsgACAAQZgWahAVIAAgAEGkFmoQFSAALwGWASEEIAAgAEGcFmooAgAiCkECdGpB//8DOwGaASAKQQBOBEBBB0GKASAEGyEJQQRBAyAEGyELIABBwBVqIQ4gAEHEFWohDyAAQbwVaiEQQX8hDANAIAQhBSAAIAgiDUEBaiIIQQJ0ai8BlgEhBAJAAkAgB0EBaiIGIAlODQAgBCAFRw0AIAYhBwwBCwJ/IAYgC0gEQCAAIAVBAnRqQfwUaiIHLwEAIAZqDAELIAUEQCAFIAxHBEAgACAFQQJ0akH8FGoiBiAGLwEAQQFqOwEACyAQIgcvAQBBAWoMAQsgB0EJTARAIA4iBy8BAEEBagwBCyAPIgcvAQBBAWoLIQYgByAGOwEAQQAhBwJ/IARFBEBBAyELQYoBDAELQQNBBCAEIAVGIgYbIQtBBkEHIAYbCyEJIAUhDAsgCiANRw0ACwsgAEGKE2ovAQAhBCAAIABBqBZqKAIAIgpBAnRqQY4TakH//wM7AQBBACEHIApBAE4EQEEHQYoBIAQbIQlBBEEDIAQbIQsgAEHAFWohDiAAQcQVaiEPIABBvBVqIRBBfyEMQQAhCANAIAQhBSAAIAgiDUEBaiIIQQJ0akGKE2ovAQAhBAJAAkAgB0EBaiIGIAlODQAgBCAFRw0AIAYhBwwBCwJ/IAYgC0gEQCAAIAVBAnRqQfwUaiIHLwEAIAZqDAELIAUEQCAFIAxHBEAgACAFQQJ0akH8FGoiBiAGLwEAQQFqOwEACyAQIgcvAQBBAWoMAQsgB0EJTARAIA4iBy8BAEEBagwBCyAPIgcvAQBBAWoLIQYgByAGOwEAQQAhBwJ/IARFBEBBAyELQYoBDAELQQNBBCAEIAVGIgYbIQtBBkEHIAYbCyEJIAUhDAsgCiANRw0ACwsgACAAQbAWahAVIAAgACgCqC0Cf0ESIABBuhVqLwEADQAaQREgAEGCFWovAQANABpBECAAQbYVai8BAA0AGkEPIABBhhVqLwEADQAaQQ4gAEGyFWovAQANABpBDSAAQYoVai8BAA0AGkEMIABBrhVqLwEADQAaQQsgAEGOFWovAQANABpBCiAAQaoVai8BAA0AGkEJIABBkhVqLwEADQAaQQggAEGmFWovAQANABpBByAAQZYVai8BAA0AGkEGIABBohVqLwEADQAaQQUgAEGaFWovAQANABpBBCAAQZ4Vai8BAA0AGkEDQQIgAEH+FGovAQAbCyIIQQNsaiIEQRFqNgKoLSAEQRtqQQN2IgQgACgCrC1BCmpBA3YiBSAEIAVJGwshBAJAAkAgAUUNACACQQRqIARLDQAgACABIAIgAxASDAELIAAoArwtIQYCQCAEIAVHBEAgACgCiAFBBEcNAQsgACAALwG4LSADQQJqQf//A3EiBCAGdHIiBTsBuC0gAAJ/IAZBDk4EQCAAIAAoAhQiBkEBajYCFCAGIAAoAghqIAU6AAAgACAAKAIUIgVBAWo2AhQgBSAAKAIIaiAAQbktai0AADoAACAAIARBECAAKAK8LSIFa3Y7AbgtIAVBDWsMAQsgBkEDags2ArwtIABBwM8AQcDYABAWDAELIAAvAbgtIANBBGpB//8DcSIHIAZ0ciEFAkAgBkEOTgRAIAAgBTsBuC0gACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAFOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAEG5LWotAAA6AAAgACgCvC0iBUENayEEIAdBECAFa3YhBQwBCyAGQQNqIQQLIAAgBDYCvC0gAEGcFmooAgAiCkGA/gNqQf//A3EiByAEdCEGIABBqBZqKAIAIQkCfyAEQQxOBEAgACAFIAZyIgQ7AbgtIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBDoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIABBuS1qLQAAOgAAIAAoArwtIgVBC2shBCAHQRAgBWt2DAELIARBBWohBCAFIAZyCyEFIAAgBDYCvC0gCUH//wNxIgcgBHQhBgJ/IARBDE4EQCAAIAUgBnIiBDsBuC0gACAAKAIUIgVBAWo2AhQgBSAAKAIIaiAEOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAEG5LWotAAA6AAAgACgCvC0iBUELayEEIAdBECAFa3YMAQsgBEEFaiEEIAUgBnILIQUgACAENgK8LSAIQf3/A2pB//8DcSIHIAR0IQYCfyAEQQ1OBEAgACAFIAZyIgQ7AbgtIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBDoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIABBuS1qLQAAOgAAIAAoArwtIgVBDGshBCAHQRAgBWt2DAELIARBBGohBCAFIAZyCyEGIAAgBDYCvC1BACEFIABBuS1qIQ0DQCAAIAYgACAFQZDcAGotAABBAnRqQf4Uai8BACIHIAR0ciIGOwG4LSAAAn8gBEEOTgRAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogBjoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIA0tAAA6AAAgACAHQRAgACgCvC0iBGt2IgY7AbgtIARBDWsMAQsgBEEDagsiBDYCvC0gBSAIRyEHIAVBAWohBSAHDQALIAAgAEGUAWoiBCAKEBcgACAAQYgTaiIFIAkQFyAAIAQgBRAWCyAAEBEgAwRAAkACfyAAKAK8LSIEQQlOBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAALQC4LToAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIQQgAEG5LWotAAAMAQsgBEEBSA0BIAAgACgCFCIEQQFqNgIUIAQgACgCCGohBCAALQC4LQshBSAEIAU6AAALIABBADYCvC0gAEEAOwG4LQsLsRUBFX8jAEEgayEKIAEoAgAhCSABKAIIIgIoAgAhBSACKAIMIQ0gAEKAgICA0McANwLQKEF/IRACQCANQQBKBEBBACECA0ACQCAJIAJBAnRqIgMvAQAEQCAAIAAoAtAoQQFqIgM2AtAoIAAgA0ECdGpB3BZqIAI2AgAgACACakHYKGpBADoAACACIRAMAQsgA0EAOwECCyACQQFqIgIgDUcNAAsgACgC0CgiBEEBSg0BCwNAIAAgBEEBaiICNgLQKCAAIAJBAnRqQdwWaiAQQQFqIgNBACAQQQJIIgQbIgI2AgAgCSACQQJ0IgdqQQE7AQAgACACakHYKGpBADoAACAAIAAoAqgtQQFrNgKoLSAFBEAgACAAKAKsLSAFIAdqLwECazYCrC0LIAMgECAEGyEQIAAoAtAoIgRBAkgNAAsLIAEgEDYCBCAEQQF2IQgDQCAAIAhBAnRqQdwWaigCACELAkAgCCICQQF0IgMgBEoNACAAIAtqQdgoaiEPIAkgC0ECdGohBiAIIQUDQAJAIAMgBE4EQCADIQIMAQsgCSAAQdwWaiICIANBAXIiBEECdGooAgAiDkECdGovAQAiByAJIAIgA0ECdGooAgAiDEECdGovAQAiAk8EQCACIAdHBEAgAyECDAILIAMhAiAAQdgoaiIDIA5qLQAAIAMgDGotAABLDQELIAQhAgsgBi8BACIEIAkgACACQQJ0akHcFmooAgAiA0ECdGovAQAiB0kEQCAFIQIMAgsCQCAEIAdHDQAgDy0AACAAIANqQdgoai0AAEsNACAFIQIMAgsgACAFQQJ0akHcFmogAzYCACACIQUgAkEBdCIDIAAoAtAoIgRMDQALCyAAIAJBAnRqQdwWaiALNgIAIAhBAk4EQCAIQQFrIQggACgC0CghBAwBCwsgACgC0CghAwNAIA0hCCAAIANBAWsiBDYC0CggACgC4BYhCyAAIAAgA0ECdGpB3BZqKAIAIg02AuAWQQEhAgJAIANBA0gNACAAIA1qQdgoaiEPQQIhAyAJIA1BAnRqIQZBASEFA0ACQCADIAROBEAgAyECDAELIAkgAEHcFmoiAiADQQFyIgRBAnRqKAIAIg5BAnRqLwEAIgcgCSACIANBAnRqKAIAIgxBAnRqLwEAIgJPBEAgAiAHRwRAIAMhAgwCCyADIQIgAEHYKGoiAyAOai0AACADIAxqLQAASw0BCyAEIQILIAYvAQAiBCAJIAAgAkECdGpB3BZqKAIAIgNBAnRqLwEAIgdJBEAgBSECDAILAkAgBCAHRw0AIA8tAAAgACADakHYKGotAABLDQAgBSECDAILIAAgBUECdGpB3BZqIAM2AgAgAiEFIAJBAXQiAyAAKALQKCIETA0ACwtBAiEDIABB3BZqIgYgAkECdGogDTYCACAAIAAoAtQoQQFrIgQ2AtQoIAAoAuAWIQIgBiAEQQJ0aiALNgIAIAAgACgC1ChBAWsiBDYC1CggBiAEQQJ0aiACNgIAIAkgCEECdGoiDiAJIAJBAnRqIgQvAQAgCSALQQJ0aiIFLwEAajsBACAAQdgoaiIMIAhqIg8gAiAMai0AACICIAsgDGotAAAiByACIAdLG0EBajoAACAEIAg7AQIgBSAIOwECIAAgCDYC4BZBASEFQQEhAgJAIAAoAtAoIgRBAkgNAANAAn8gAyADIARODQAaIAkgBiADQQFyIgRBAnRqKAIAIgtBAnRqLwEAIgIgCSAGIANBAnRqKAIAIg1BAnRqLwEAIgdPBEAgAyACIAdHDQEaIAMgCyAMai0AACAMIA1qLQAASw0BGgsgBAshAiAOLwEAIgQgCSAAIAJBAnRqQdwWaigCACIDQQJ0ai8BACIHSQRAIAUhAgwCCwJAIAQgB0cNACAPLQAAIAAgA2pB2ChqLQAASw0AIAUhAgwCCyAAIAVBAnRqQdwWaiADNgIAIAIhBSACQQF0IgMgACgC0CgiBEwNAAsLIAhBAWohDSAAIAJBAnRqQdwWaiAINgIAIAAoAtAoIgNBAUoNAAsgACAAKALUKEEBayICNgLUKCAAQdwWaiIDIAJBAnRqIAAoAuAWNgIAIAEoAgQhByABKAIIIgIoAhAhBiACKAIIIREgAigCBCETIAIoAgAhEiABKAIAIQwgAEHUFmoiAUIANwEAIABBzBZqIhRCADcBACAAQcQWaiIVQgA3AQAgAEG8FmoiFkIANwEAQQAhCCAMIAMgACgC1ChBAnRqKAIAQQJ0akEAOwECAkAgACgC1CgiAkG7BEoNACACQQFqIQJBACEOA0AgDCAAIAJBAnRqQdwWaigCACIEQQJ0Ig1qIgUgDCAFLwECQQJ0ai8BAiIDQQFqIAYgAyAGSBsiDzsBAiADIAZOIQMCQCAEIAdKDQAgACAPQQF0akG8FmoiCyALLwEAQQFqOwEAQQAhCyAEIBFOBEAgEyAEIBFrQQJ0aigCACELCyAAIAAoAqgtIAUvAQAiBCALIA9qbGo2AqgtIBJFDQAgACAAKAKsLSALIA0gEmovAQJqIARsajYCrC0LIAMgDmohDiACQQFqIgJBvQRHDQALIA5FDQAgACAGQQF0akG8FmohDwNAIAYhAgNAIAAgAiIDQQFrIgJBAXRqQbwWaiIELwEAIgVFDQALIAQgBUEBazsBACAAIANBAXRqQbwWaiICIAIvAQBBAmo7AQAgDyAPLwEAQQFrIgI7AQAgDkECSiEDIA5BAmshDiADDQALIAZFDQBBvQQhBQNAIAJB//8DcSEDIAUhAgNAIAMEQCAAIAJBAWsiAkECdGpB3BZqKAIAIgQgB0oNASAMIARBAnRqIgQvAQIiBSAGRwRAIAAgACgCqC0gBC8BACAGIAVrbGo2AqgtIAQgBjsBAgsgA0EBayEDIAIhBQwBCwsgBkEBayIGRQ0BIAAgBkEBdGpBvBZqLwEAIQIMAAsACyAKIBYvAQBBAXQiAjsBAiAKIAIgAEG+FmovAQBqQQF0IgI7AQQgCiACIABBwBZqLwEAakEBdCICOwEGIAogAiAAQcIWai8BAGpBAXQiAjsBCCAKIAIgFS8BAGpBAXQiAjsBCiAKIAIgAEHGFmovAQBqQQF0IgI7AQwgCiACIABByBZqLwEAakEBdCICOwEOIAogAiAAQcoWai8BAGpBAXQiAjsBECAKIAIgFC8BAGpBAXQiAjsBEiAKIAIgAEHOFmovAQBqQQF0IgI7ARQgCiACIABB0BZqLwEAakEBdCICOwEWIAogAiAAQdIWai8BAGpBAXQiAjsBGCAKIAEvAQAgAmpBAXQiAjsBGiAKIABB1hZqLwEAIAJqQQF0IgI7ARwgCiACIABB2BZqLwEAakEBdDsBHiAQQQBOBEADQCAJIAhBAnRqIgcvAQIiBARAIAogBEEBdGoiACAALwEAIgBBAWo7AQAgBEEDcSEDQQAhAiAEQQFrQQNPBEAgBEH8/wNxIQUDQCAAQQN2QQFxIABBAnZBAXEgAEECcSACIABBAXFyQQJ0cnJBAXRyIgRBAXQhAiAAQQR2IQAgBUEEayIFDQALCyADBEADQCACIABBAXFyIgRBAXQhAiAAQQF2IQAgA0EBayIDDQALCyAHIAQ7AQALIAggEEchACAIQQFqIQggAA0ACwsL2QgBCn8CQCAAKAKgLUUEQCAAKAK8LSEDDAELIABBuS1qIQgDQCAEQQFqIQogACgCmC0gBGotAAAhBQJAIAACfyAAKAKkLSAEQQF0ai8BACIHRQRAIAEgBUECdGoiAy8BAiEEIAAgAC8BuC0gAy8BACIFIAAoArwtIgN0ciIHOwG4LUEQIARrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAHOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIAMgBGpBEGsMAgsgAyAEagwBCyAFQYDNAGotAAAiC0ECdCIJQYAIciABaiIDLwEGIQQgACAALwG4LSADLwEEIgwgACgCvC0iBnRyIgM7AbgtIAACf0EQIARrIAZIBEAgACAAKAIUIgZBAWo2AhQgBiAAKAIIaiADOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAxBECAAKAK8LSIGa3YiAzsBuC0gBCAGakEQawwBCyAEIAZqCyIENgK8LSALQQhrQRNNBEAgACADIAUgCUGw3ABqKAIAa0H//wNxIgYgBHRyIgM7AbgtIAACf0EQIAlBwNkAaigCACIFayAESARAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAzoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIAgtAAA6AAAgACAGQRAgACgCvC0iBGt2IgM7AbgtIAQgBWpBEGsMAQsgBCAFagsiBDYCvC0LIAIgB0EBayIFIAVBB3ZBgAJqIAVBgAJJG0GAyQBqLQAAIgtBAnQiCWoiBi8BAiEHIAAgAyAGLwEAIgwgBHRyIgY7AbgtIAACf0EQIAdrIARIBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAGOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogCC0AADoAACAAIAxBECAAKAK8LSIEa3YiBjsBuC0gBCAHakEQawwBCyAEIAdqCyIDNgK8LSALQQRJDQEgACAGIAUgCUGw3QBqKAIAa0H//wNxIgUgA3RyIgc7AbgtQRAgCUHA2gBqKAIAIgRrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAHOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIAMgBGpBEGsMAQsgAyAEagsiAzYCvC0LIAoiBCAAKAKgLUkNAAsLIAFBgghqLwEAIQQgACAALwG4LSABLwGACCIKIAN0ciIFOwG4LUEQIARrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAFOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogAEG5LWotAAA6AAAgACAKQRAgACgCvC0iA2t2OwG4LSAAIAMgBGpBEGs2ArwtDwsgACADIARqNgK8LQuXCwEMfyACQQBOBEBBBEEDIAEvAQIiChshBkEHQYoBIAobIQMgAEG5LWohCEF/IQcDQCAKIQkgASALIgxBAWoiC0ECdGovAQIhCgJAAkAgBUEBaiIEIANODQAgCSAKRw0AIAQhBQwBCwJAIAQgBkgEQCAAIAlBAnRqIgVB/BRqIQ0gBUH+FGohDiAAKAK8LSEFA0AgDi8BACEDIAAgAC8BuC0gDS8BACIGIAV0ciIHOwG4LSAAAn9BECADayAFSARAIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBzoAACAAIAAoAhQiBUEBajYCFCAFIAAoAghqIAgtAAA6AAAgACAGQRAgACgCvC0iBWt2OwG4LSADIAVqQRBrDAELIAMgBWoLIgU2ArwtIARBAWsiBA0ACwwBCyAAAn8gCQRAAkAgByAJRgRAIAAoArwtIQMgBCEFDAELIAAgCUECdGoiBEH+FGovAQAhAyAAIAAvAbgtIARB/BRqLwEAIgYgACgCvC0iBHRyIgc7AbgtIAACf0EQIANrIARIBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAHOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogCC0AADoAACAAIAZBECAAKAK8LSIEa3Y7AbgtIAMgBGpBEGsMAQsgAyAEagsiAzYCvC0LIAAvAbgtIAAvAbwVIgcgA3RyIQQCQEEQIAAvAb4VIgZrIANIBEAgACAEOwG4LSAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAYgACgCvC0iBGpBEGshAyAHQRAgBGt2IQQMAQsgAyAGaiEDCyAAIAM2ArwtIAAgBCAFQf3/A2pB//8DcSIFIAN0ciIEOwG4LSADQQ9OBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAEOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIANBDmsMAgsgA0ECagwBCyAFQQlMBEAgAC8BuC0gAC8BwBUiByAAKAK8LSIDdHIhBAJAQRAgAC8BwhUiBmsgA0gEQCAAIAQ7AbgtIAAgACgCFCIDQQFqNgIUIAMgACgCCGogBDoAACAAIAAoAhQiA0EBajYCFCADIAAoAghqIAgtAAA6AAAgBiAAKAK8LSIEakEQayEDIAdBECAEa3YhBAwBCyADIAZqIQMLIAAgAzYCvC0gACAEIAVB/v8DakH//wNxIgUgA3RyIgQ7AbgtIANBDk4EQCAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAAgBUEQIAAoArwtIgNrdjsBuC0gA0ENawwCCyADQQNqDAELIAAvAbgtIAAvAcQVIgcgACgCvC0iA3RyIQQCQEEQIAAvAcYVIgZrIANIBEAgACAEOwG4LSAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAYgACgCvC0iBGpBEGshAyAHQRAgBGt2IQQMAQsgAyAGaiEDCyAAIAM2ArwtIAAgBCAFQfb/A2pB//8DcSIFIAN0ciIEOwG4LSADQQpOBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAEOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIANBCWsMAQsgA0EHags2ArwtC0EAIQUCfyAKRQRAQYoBIQNBAwwBC0EGQQcgCSAKRiIEGyEDQQNBBCAEGwshBiAJIQcLIAIgDEcNAAsLCwkAIAEgAmwQHAsGACABEB0LXwEBfyMAQUBqIgMkACADQQA2AjAgA0IANwMoIAMgADYCCCADIAI2AhQgAyABNgIMIAMgAUEDbDYCGCADQQhqEAcgA0EIahALIANBCGoQCCADKAIcIQEgA0FAayQAIAELBgBB1N8AC6QuAQx/IwBBEGsiDCQAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIABB9AFNBEBB2N8AKAIAIgZBECAAQQtqQXhxIABBC0kbIgRBA3YiAXYiAEEDcQRAIABBf3NBAXEgAWoiAkEDdCIDQYjgAGooAgAiAUEIaiEAAkAgASgCCCIEIANBgOAAaiIDRgRAQdjfACAGQX4gAndxNgIADAELIAQgAzYCDCADIAQ2AggLIAEgAkEDdCICQQNyNgIEIAEgAmoiASABKAIEQQFyNgIEDA0LIARB4N8AKAIAIghNDQEgAARAAkAgACABdEECIAF0IgBBACAAa3JxIgBBACAAa3FBAWsiACAAQQx2QRBxIgB2IgFBBXZBCHEiAiAAciABIAJ2IgBBAnZBBHEiAXIgACABdiIAQQF2QQJxIgFyIAAgAXYiAEEBdkEBcSIBciAAIAF2aiICQQN0IgNBiOAAaigCACIBKAIIIgAgA0GA4ABqIgNGBEBB2N8AIAZBfiACd3EiBjYCAAwBCyAAIAM2AgwgAyAANgIICyABQQhqIQAgASAEQQNyNgIEIAEgBGoiAyACQQN0IgUgBGsiAkEBcjYCBCABIAVqIAI2AgAgCARAIAhBA3YiBUEDdEGA4ABqIQRB7N8AKAIAIQECfyAGQQEgBXQiBXFFBEBB2N8AIAUgBnI2AgAgBAwBCyAEKAIICyEFIAQgATYCCCAFIAE2AgwgASAENgIMIAEgBTYCCAtB7N8AIAM2AgBB4N8AIAI2AgAMDQtB3N8AKAIAIglFDQEgCUEAIAlrcUEBayIAIABBDHZBEHEiAHYiAUEFdkEIcSICIAByIAEgAnYiAEECdkEEcSIBciAAIAF2IgBBAXZBAnEiAXIgACABdiIAQQF2QQFxIgFyIAAgAXZqQQJ0QYjiAGooAgAiAygCBEF4cSAEayEBIAMhAgNAAkAgAigCECIARQRAIAIoAhQiAEUNAQsgACgCBEF4cSAEayICIAEgASACSyICGyEBIAAgAyACGyEDIAAhAgwBCwsgAyAEaiILIANNDQIgAygCGCEKIAMgAygCDCIFRwRAIAMoAggiAEHo3wAoAgBJGiAAIAU2AgwgBSAANgIIDAwLIANBFGoiAigCACIARQRAIAMoAhAiAEUNBCADQRBqIQILA0AgAiEHIAAiBUEUaiICKAIAIgANACAFQRBqIQIgBSgCECIADQALIAdBADYCAAwLC0F/IQQgAEG/f0sNACAAQQtqIgBBeHEhBEHc3wAoAgAiCEUNAEEfIQcgBEH///8HTQRAIABBCHYiACAAQYD+P2pBEHZBCHEiAHQiASABQYDgH2pBEHZBBHEiAXQiAiACQYCAD2pBEHZBAnEiAnRBD3YgACABciACcmsiAEEBdCAEIABBFWp2QQFxckEcaiEHC0EAIARrIQECQAJAAkAgB0ECdEGI4gBqKAIAIgJFBEBBACEADAELQQAhACAEQQBBGSAHQQF2ayAHQR9GG3QhAwNAAkAgAigCBEF4cSAEayIGIAFPDQAgAiEFIAYiAQ0AQQAhASACIQAMAwsgACACKAIUIgYgBiACIANBHXZBBHFqKAIQIgJGGyAAIAYbIQAgA0EBdCEDIAINAAsLIAAgBXJFBEBBAiAHdCIAQQAgAGtyIAhxIgBFDQMgAEEAIABrcUEBayIAIABBDHZBEHEiAHYiAkEFdkEIcSIDIAByIAIgA3YiAEECdkEEcSICciAAIAJ2IgBBAXZBAnEiAnIgACACdiIAQQF2QQFxIgJyIAAgAnZqQQJ0QYjiAGooAgAhAAsgAEUNAQsDQCAAKAIEQXhxIARrIgYgAUkhAyAGIAEgAxshASAAIAUgAxshBSAAKAIQIgIEfyACBSAAKAIUCyIADQALCyAFRQ0AIAFB4N8AKAIAIARrTw0AIAQgBWoiByAFTQ0BIAUoAhghCSAFIAUoAgwiA0cEQCAFKAIIIgBB6N8AKAIASRogACADNgIMIAMgADYCCAwKCyAFQRRqIgIoAgAiAEUEQCAFKAIQIgBFDQQgBUEQaiECCwNAIAIhBiAAIgNBFGoiAigCACIADQAgA0EQaiECIAMoAhAiAA0ACyAGQQA2AgAMCQsgBEHg3wAoAgAiAE0EQEHs3wAoAgAhAQJAIAAgBGsiAkEQTwRAQeDfACACNgIAQezfACABIARqIgM2AgAgAyACQQFyNgIEIAAgAWogAjYCACABIARBA3I2AgQMAQtB7N8AQQA2AgBB4N8AQQA2AgAgASAAQQNyNgIEIAAgAWoiACAAKAIEQQFyNgIECyABQQhqIQAMCwsgBEHk3wAoAgAiA0kEQEHk3wAgAyAEayIBNgIAQfDfAEHw3wAoAgAiACAEaiICNgIAIAIgAUEBcjYCBCAAIARBA3I2AgQgAEEIaiEADAsLQQAhACAEQS9qIggCf0Gw4wAoAgAEQEG44wAoAgAMAQtBvOMAQn83AgBBtOMAQoCggICAgAQ3AgBBsOMAIAxBDGpBcHFB2KrVqgVzNgIAQcTjAEEANgIAQZTjAEEANgIAQYAgCyIBaiIGQQAgAWsiB3EiBSAETQ0KQZDjACgCACIBBEBBiOMAKAIAIgIgBWoiCSACTQ0LIAEgCUkNCwtBlOMALQAAQQRxDQUCQAJAQfDfACgCACIBBEBBmOMAIQADQCABIAAoAgAiAk8EQCACIAAoAgRqIAFLDQMLIAAoAggiAA0ACwtBABAeIgNBf0YNBiAFIQZBtOMAKAIAIgBBAWsiASADcQRAIAUgA2sgASADakEAIABrcWohBgsgBCAGTw0GIAZB/v///wdLDQZBkOMAKAIAIgAEQEGI4wAoAgAiASAGaiICIAFNDQcgACACSQ0HCyAGEB4iACADRw0BDAgLIAYgA2sgB3EiBkH+////B0sNBSAGEB4iAyAAKAIAIAAoAgRqRg0EIAMhAAsCQCAEQTBqIAZNDQAgAEF/Rg0AQbjjACgCACIBIAggBmtqQQAgAWtxIgFB/v///wdLBEAgACEDDAgLIAEQHkF/RwRAIAEgBmohBiAAIQMMCAtBACAGaxAeGgwFCyAAIQMgAEF/Rw0GDAQLAAtBACEFDAcLQQAhAwwFCyADQX9HDQILQZTjAEGU4wAoAgBBBHI2AgALIAVB/v///wdLDQEgBRAeIgNBABAeIgBPDQEgA0F/Rg0BIABBf0YNASAAIANrIgYgBEEoak0NAQtBiOMAQYjjACgCACAGaiIANgIAQYzjACgCACAASQRAQYzjACAANgIACwJAAkACQEHw3wAoAgAiAQRAQZjjACEAA0AgAyAAKAIAIgIgACgCBCIFakYNAiAAKAIIIgANAAsMAgtB6N8AKAIAIgBBACAAIANNG0UEQEHo3wAgAzYCAAtBACEAQZzjACAGNgIAQZjjACADNgIAQfjfAEF/NgIAQfzfAEGw4wAoAgA2AgBBpOMAQQA2AgADQCAAQQN0IgFBiOAAaiABQYDgAGoiAjYCACABQYzgAGogAjYCACAAQQFqIgBBIEcNAAtB5N8AIAZBKGsiAEF4IANrQQdxQQAgA0EIakEHcRsiAWsiAjYCAEHw3wAgASADaiIBNgIAIAEgAkEBcjYCBCAAIANqQSg2AgRB9N8AQcDjACgCADYCAAwCCyABIANPDQAgASACSQ0AIAAoAgxBCHENACAAIAUgBmo2AgRB8N8AIAFBeCABa0EHcUEAIAFBCGpBB3EbIgBqIgI2AgBB5N8AQeTfACgCACAGaiIDIABrIgA2AgAgAiAAQQFyNgIEIAEgA2pBKDYCBEH03wBBwOMAKAIANgIADAELQejfACgCACADSwRAQejfACADNgIACyADIAZqIQJBmOMAIQACQAJAAkACQAJAAkADQCACIAAoAgBHBEAgACgCCCIADQEMAgsLIAAtAAxBCHFFDQELQZjjACEAA0AgASAAKAIAIgJPBEAgAiAAKAIEaiICIAFLDQMLIAAoAgghAAwACwALIAAgAzYCACAAIAAoAgQgBmo2AgQgA0F4IANrQQdxQQAgA0EIakEHcRtqIgcgBEEDcjYCBCACQXggAmtBB3FBACACQQhqQQdxG2oiBiAHayAEayECIAQgB2ohBCABIAZGBEBB8N8AIAQ2AgBB5N8AQeTfACgCACACaiIANgIAIAQgAEEBcjYCBAwDCyAGQezfACgCAEYEQEHs3wAgBDYCAEHg3wBB4N8AKAIAIAJqIgA2AgAgBCAAQQFyNgIEIAAgBGogADYCAAwDCyAGKAIEIgBBA3FBAUYEQCAAQXhxIQgCQCAAQf8BTQRAIAYoAggiASAAQQN2IgVBA3RBgOAAakYaIAEgBigCDCIARgRAQdjfAEHY3wAoAgBBfiAFd3E2AgAMAgsgASAANgIMIAAgATYCCAwBCyAGKAIYIQkCQCAGIAYoAgwiA0cEQCAGKAIIIgAgAzYCDCADIAA2AggMAQsCQCAGQRRqIgAoAgAiAQ0AIAZBEGoiACgCACIBDQBBACEDDAELA0AgACEFIAEiA0EUaiIAKAIAIgENACADQRBqIQAgAygCECIBDQALIAVBADYCAAsgCUUNAAJAIAYgBigCHCIBQQJ0QYjiAGoiACgCAEYEQCAAIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiABd3E2AgAMAgsgCUEQQRQgCSgCECAGRhtqIAM2AgAgA0UNAQsgAyAJNgIYIAYoAhAiAARAIAMgADYCECAAIAM2AhgLIAYoAhQiAEUNACADIAA2AhQgACADNgIYCyAGIAhqIQYgAiAIaiECCyAGIAYoAgRBfnE2AgQgBCACQQFyNgIEIAIgBGogAjYCACACQf8BTQRAIAJBA3YiAUEDdEGA4ABqIQACf0HY3wAoAgAiAkEBIAF0IgFxRQRAQdjfACABIAJyNgIAIAAMAQsgACgCCAshASAAIAQ2AgggASAENgIMIAQgADYCDCAEIAE2AggMAwtBHyEAIAJB////B00EQCACQQh2IgAgAEGA/j9qQRB2QQhxIgB0IgEgAUGA4B9qQRB2QQRxIgF0IgMgA0GAgA9qQRB2QQJxIgN0QQ92IAAgAXIgA3JrIgBBAXQgAiAAQRVqdkEBcXJBHGohAAsgBCAANgIcIARCADcCECAAQQJ0QYjiAGohAQJAQdzfACgCACIDQQEgAHQiBXFFBEBB3N8AIAMgBXI2AgAgASAENgIAIAQgATYCGAwBCyACQQBBGSAAQQF2ayAAQR9GG3QhACABKAIAIQMDQCADIgEoAgRBeHEgAkYNAyAAQR12IQMgAEEBdCEAIAEgA0EEcWpBEGoiBSgCACIDDQALIAUgBDYCACAEIAE2AhgLIAQgBDYCDCAEIAQ2AggMAgtB5N8AIAZBKGsiAEF4IANrQQdxQQAgA0EIakEHcRsiBWsiBzYCAEHw3wAgAyAFaiIFNgIAIAUgB0EBcjYCBCAAIANqQSg2AgRB9N8AQcDjACgCADYCACABIAJBJyACa0EHcUEAIAJBJ2tBB3EbakEvayIAIAAgAUEQakkbIgVBGzYCBCAFQaDjACkCADcCECAFQZjjACkCADcCCEGg4wAgBUEIajYCAEGc4wAgBjYCAEGY4wAgAzYCAEGk4wBBADYCACAFQRhqIQADQCAAQQc2AgQgAEEIaiEDIABBBGohACACIANLDQALIAEgBUYNAyAFIAUoAgRBfnE2AgQgASAFIAFrIgZBAXI2AgQgBSAGNgIAIAZB/wFNBEAgBkEDdiICQQN0QYDgAGohAAJ/QdjfACgCACIDQQEgAnQiAnFFBEBB2N8AIAIgA3I2AgAgAAwBCyAAKAIICyECIAAgATYCCCACIAE2AgwgASAANgIMIAEgAjYCCAwEC0EfIQAgAUIANwIQIAZB////B00EQCAGQQh2IgAgAEGA/j9qQRB2QQhxIgB0IgIgAkGA4B9qQRB2QQRxIgJ0IgMgA0GAgA9qQRB2QQJxIgN0QQ92IAAgAnIgA3JrIgBBAXQgBiAAQRVqdkEBcXJBHGohAAsgASAANgIcIABBAnRBiOIAaiECAkBB3N8AKAIAIgNBASAAdCIFcUUEQEHc3wAgAyAFcjYCACACIAE2AgAgASACNgIYDAELIAZBAEEZIABBAXZrIABBH0YbdCEAIAIoAgAhAwNAIAMiAigCBEF4cSAGRg0EIABBHXYhAyAAQQF0IQAgAiADQQRxakEQaiIFKAIAIgMNAAsgBSABNgIAIAEgAjYCGAsgASABNgIMIAEgATYCCAwDCyABKAIIIgAgBDYCDCABIAQ2AgggBEEANgIYIAQgATYCDCAEIAA2AggLIAdBCGohAAwFCyACKAIIIgAgATYCDCACIAE2AgggAUEANgIYIAEgAjYCDCABIAA2AggLQeTfACgCACIAIARNDQBB5N8AIAAgBGsiATYCAEHw3wBB8N8AKAIAIgAgBGoiAjYCACACIAFBAXI2AgQgACAEQQNyNgIEIABBCGohAAwDC0HU3wBBMDYCAEEAIQAMAgsCQCAJRQ0AAkAgBSgCHCICQQJ0QYjiAGoiACgCACAFRgRAIAAgAzYCACADDQFB3N8AIAhBfiACd3EiCDYCAAwCCyAJQRBBFCAJKAIQIAVGG2ogAzYCACADRQ0BCyADIAk2AhggBSgCECIABEAgAyAANgIQIAAgAzYCGAsgBSgCFCIARQ0AIAMgADYCFCAAIAM2AhgLAkAgAUEPTQRAIAUgASAEaiIAQQNyNgIEIAAgBWoiACAAKAIEQQFyNgIEDAELIAUgBEEDcjYCBCAHIAFBAXI2AgQgASAHaiABNgIAIAFB/wFNBEAgAUEDdiIBQQN0QYDgAGohAAJ/QdjfACgCACICQQEgAXQiAXFFBEBB2N8AIAEgAnI2AgAgAAwBCyAAKAIICyEBIAAgBzYCCCABIAc2AgwgByAANgIMIAcgATYCCAwBC0EfIQAgAUH///8HTQRAIAFBCHYiACAAQYD+P2pBEHZBCHEiAHQiAiACQYDgH2pBEHZBBHEiAnQiBCAEQYCAD2pBEHZBAnEiBHRBD3YgACACciAEcmsiAEEBdCABIABBFWp2QQFxckEcaiEACyAHIAA2AhwgB0IANwIQIABBAnRBiOIAaiECAkACQCAIQQEgAHQiBHFFBEBB3N8AIAQgCHI2AgAgAiAHNgIAIAcgAjYCGAwBCyABQQBBGSAAQQF2ayAAQR9GG3QhACACKAIAIQQDQCAEIgIoAgRBeHEgAUYNAiAAQR12IQQgAEEBdCEAIAIgBEEEcWpBEGoiAygCACIEDQALIAMgBzYCACAHIAI2AhgLIAcgBzYCDCAHIAc2AggMAQsgAigCCCIAIAc2AgwgAiAHNgIIIAdBADYCGCAHIAI2AgwgByAANgIICyAFQQhqIQAMAQsCQCAKRQ0AAkAgAygCHCICQQJ0QYjiAGoiACgCACADRgRAIAAgBTYCACAFDQFB3N8AIAlBfiACd3E2AgAMAgsgCkEQQRQgCigCECADRhtqIAU2AgAgBUUNAQsgBSAKNgIYIAMoAhAiAARAIAUgADYCECAAIAU2AhgLIAMoAhQiAEUNACAFIAA2AhQgACAFNgIYCwJAIAFBD00EQCADIAEgBGoiAEEDcjYCBCAAIANqIgAgACgCBEEBcjYCBAwBCyADIARBA3I2AgQgCyABQQFyNgIEIAEgC2ogATYCACAIBEAgCEEDdiIEQQN0QYDgAGohAkHs3wAoAgAhAAJ/QQEgBHQiBCAGcUUEQEHY3wAgBCAGcjYCACACDAELIAIoAggLIQQgAiAANgIIIAQgADYCDCAAIAI2AgwgACAENgIIC0Hs3wAgCzYCAEHg3wAgATYCAAsgA0EIaiEACyAMQRBqJAAgAAvMDAEHfwJAIABFDQAgAEEIayICIABBBGsoAgAiAUF4cSIAaiEFAkAgAUEBcQ0AIAFBA3FFDQEgAiACKAIAIgFrIgJB6N8AKAIASQ0BIAAgAWohACACQezfACgCAEcEQCABQf8BTQRAIAIoAggiBCABQQN2IgdBA3RBgOAAakYaIAQgAigCDCIBRgRAQdjfAEHY3wAoAgBBfiAHd3E2AgAMAwsgBCABNgIMIAEgBDYCCAwCCyACKAIYIQYCQCACIAIoAgwiA0cEQCACKAIIIgEgAzYCDCADIAE2AggMAQsCQCACQRRqIgEoAgAiBA0AIAJBEGoiASgCACIEDQBBACEDDAELA0AgASEHIAQiA0EUaiIBKAIAIgQNACADQRBqIQEgAygCECIEDQALIAdBADYCAAsgBkUNAQJAIAIgAigCHCIEQQJ0QYjiAGoiASgCAEYEQCABIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiAEd3E2AgAMAwsgBkEQQRQgBigCECACRhtqIAM2AgAgA0UNAgsgAyAGNgIYIAIoAhAiAQRAIAMgATYCECABIAM2AhgLIAIoAhQiAUUNASADIAE2AhQgASADNgIYDAELIAUoAgQiAUEDcUEDRw0AQeDfACAANgIAIAUgAUF+cTYCBCACIABBAXI2AgQgACACaiAANgIADwsgAiAFTw0AIAUoAgQiAUEBcUUNAAJAIAFBAnFFBEAgBUHw3wAoAgBGBEBB8N8AIAI2AgBB5N8AQeTfACgCACAAaiIANgIAIAIgAEEBcjYCBCACQezfACgCAEcNA0Hg3wBBADYCAEHs3wBBADYCAA8LIAVB7N8AKAIARgRAQezfACACNgIAQeDfAEHg3wAoAgAgAGoiADYCACACIABBAXI2AgQgACACaiAANgIADwsgAUF4cSAAaiEAAkAgAUH/AU0EQCAFKAIIIgQgAUEDdiIHQQN0QYDgAGpGGiAEIAUoAgwiAUYEQEHY3wBB2N8AKAIAQX4gB3dxNgIADAILIAQgATYCDCABIAQ2AggMAQsgBSgCGCEGAkAgBSAFKAIMIgNHBEAgBSgCCCIBQejfACgCAEkaIAEgAzYCDCADIAE2AggMAQsCQCAFQRRqIgEoAgAiBA0AIAVBEGoiASgCACIEDQBBACEDDAELA0AgASEHIAQiA0EUaiIBKAIAIgQNACADQRBqIQEgAygCECIEDQALIAdBADYCAAsgBkUNAAJAIAUgBSgCHCIEQQJ0QYjiAGoiASgCAEYEQCABIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiAEd3E2AgAMAgsgBkEQQRQgBigCECAFRhtqIAM2AgAgA0UNAQsgAyAGNgIYIAUoAhAiAQRAIAMgATYCECABIAM2AhgLIAUoAhQiAUUNACADIAE2AhQgASADNgIYCyACIABBAXI2AgQgACACaiAANgIAIAJB7N8AKAIARw0BQeDfACAANgIADwsgBSABQX5xNgIEIAIgAEEBcjYCBCAAIAJqIAA2AgALIABB/wFNBEAgAEEDdiIBQQN0QYDgAGohAAJ/QdjfACgCACIEQQEgAXQiAXFFBEBB2N8AIAEgBHI2AgAgAAwBCyAAKAIICyEBIAAgAjYCCCABIAI2AgwgAiAANgIMIAIgATYCCA8LQR8hASACQgA3AhAgAEH///8HTQRAIABBCHYiASABQYD+P2pBEHZBCHEiAXQiBCAEQYDgH2pBEHZBBHEiBHQiAyADQYCAD2pBEHZBAnEiA3RBD3YgASAEciADcmsiAUEBdCAAIAFBFWp2QQFxckEcaiEBCyACIAE2AhwgAUECdEGI4gBqIQQCQAJAAkBB3N8AKAIAIgNBASABdCIFcUUEQEHc3wAgAyAFcjYCACAEIAI2AgAgAiAENgIYDAELIABBAEEZIAFBAXZrIAFBH0YbdCEBIAQoAgAhAwNAIAMiBCgCBEF4cSAARg0CIAFBHXYhAyABQQF0IQEgBCADQQRxakEQaiIFKAIAIgMNAAsgBSACNgIAIAIgBDYCGAsgAiACNgIMIAIgAjYCCAwBCyAEKAIIIgAgAjYCDCAEIAI2AgggAkEANgIYIAIgBDYCDCACIAA2AggLQfjfAEH43wAoAgBBAWsiAkF/IAIbNgIACwtVAQJ/QdDfACgCACIBIABBA2pBfHEiAmohAAJAIAJBAU5BACAAIAFNGw0APwBBEHQgAEkEQCAAEABFDQELQdDfACAANgIAIAEPC0HU3wBBMDYCAEF/C4IEAQN/IAJBgARPBEAgACABIAIQARogAA8LIAAgAmohAwJAIAAgAXNBA3FFBEACQCACQQFIBEAgACECDAELIABBA3FFBEAgACECDAELIAAhAgNAIAIgAS0AADoAACABQQFqIQEgAkEBaiICIANPDQEgAkEDcQ0ACwsCQCADQXxxIgRBwABJDQAgAiAEQUBqIgVLDQADQCACIAEoAgA2AgAgAiABKAIENgIEIAIgASgCCDYCCCACIAEoAgw2AgwgAiABKAIQNgIQIAIgASgCFDYCFCACIAEoAhg2AhggAiABKAIcNgIcIAIgASgCIDYCICACIAEoAiQ2AiQgAiABKAIoNgIoIAIgASgCLDYCLCACIAEoAjA2AjAgAiABKAI0NgI0IAIgASgCODYCOCACIAEoAjw2AjwgAUFAayEBIAJBQGsiAiAFTQ0ACwsgAiAETw0BA0AgAiABKAIANgIAIAFBBGohASACQQRqIgIgBEkNAAsMAQsgA0EESQRAIAAhAgwBCyAAIANBBGsiBEsEQCAAIQIMAQsgACECA0AgAiABLQAAOgAAIAIgAS0AAToAASACIAEtAAI6AAIgAiABLQADOgADIAFBBGohASACQQRqIgIgBE0NAAsLIAIgA0kEQANAIAIgAS0AADoAACABQQFqIQEgAkEBaiICIANHDQALCyAAC9YCAQJ/AkAgAUUNACAAIAFqIgJBAWtBADoAACAAQQA6AAAgAUEDSQ0AIAJBAmtBADoAACAAQQA6AAEgAkEDa0EAOgAAIABBADoAAiABQQdJDQAgAkEEa0EAOgAAIABBADoAAyABQQlJDQAgAEEAIABrQQNxIgNqIgJBADYCACACIAEgA2tBfHEiA2oiAUEEa0EANgIAIANBCUkNACACQQA2AgggAkEANgIEIAFBCGtBADYCACABQQxrQQA2AgAgA0EZSQ0AIAJBADYCGCACQQA2AhQgAkEANgIQIAJBADYCDCABQRBrQQA2AgAgAUEUa0EANgIAIAFBGGtBADYCACABQRxrQQA2AgAgAyACQQRxQRhyIgNrIgFBIEkNACACIANqIQIDQCACQgA3AxggAkIANwMQIAJCADcDCCACQgA3AwAgAkEgaiECIAFBIGsiAUEfSw0ACwsLBAAjAAsGACAAJAALEAAjACAAa0FwcSIAJAAgAAsLvVYIAEGECAvxQJYwB3csYQ7uulEJmRnEbQeP9GpwNaVj6aOVZJ4yiNsOpLjceR7p1eCI2dKXK0y2Cb18sX4HLbjnkR2/kGQQtx3yILBqSHG5895BvoR91Noa6+TdbVG11PTHhdODVphsE8Coa2R6+WL97Mllik9cARTZbAZjYz0P+vUNCI3IIG47XhBpTORBYNVycWei0eQDPEfUBEv9hQ3Sa7UKpfqotTVsmLJC1sm720D5vKzjbNgydVzfRc8N1txZPdGrrDDZJjoA3lGAUdfIFmHQv7X0tCEjxLNWmZW6zw+lvbieuAIoCIgFX7LZDMYk6Quxh3xvLxFMaFirHWHBPS1mtpBB3HYGcdsBvCDSmCoQ1e+JhbFxH7W2BqXkv58z1LjooskHeDT5AA+OqAmWGJgO4bsNan8tPW0Il2xkkQFcY+b0UWtrYmFsHNgwZYVOAGLy7ZUGbHulARvB9AiCV8QP9cbZsGVQ6bcS6ri+i3yIufzfHd1iSS3aFfN804xlTNT7WGGyTc5RtTp0ALyj4jC71EGl30rXldg9bcTRpPv01tNq6WlD/NluNEaIZ63QuGDacy0EROUdAzNfTAqqyXwN3TxxBVCqQQInEBALvoYgDMkltWhXs4VvIAnUZrmf5GHODvneXpjJ2SkimNCwtKjXxxc9s1mBDbQuO1y9t61susAgg7jttrO/mgzitgOa0rF0OUfV6q930p0VJtsEgxbccxILY+OEO2SUPmptDahaanoLzw7knf8JkyeuAAqxngd9RJMP8NKjCIdo8gEe/sIGaV1XYvfLZ2WAcTZsGecGa252G9T+4CvTiVp62hDMSt1nb9+5+fnvvo5DvrcX1Y6wYOij1tZ+k9GhxMLYOFLy30/xZ7vRZ1e8pt0GtT9LNrJI2isN2EwbCq/2SgM2YHoEQcPvYN9V32eo745uMXm+aUaMs2HLGoNmvKDSbyU24mhSlXcMzANHC7u5FgIiLyYFVb47usUoC72yklq0KwRqs1yn/9fCMc/QtYue2Swdrt5bsMJkmybyY+yco2p1CpNtAqkGCZw/Ng7rhWcHchNXAAWCSr+VFHq44q4rsXs4G7YMm47Skg2+1eW379x8Id/bC9TS04ZC4tTx+LPdaG6D2h/NFr6BWya59uF3sG93R7cY5loIiHBqD//KOwZmXAsBEf+eZY9prmL40/9rYUXPbBZ44gqg7tIN11SDBE7CswM5YSZnp/cWYNBNR2lJ23duPkpq0a7cWtbZZgvfQPA72DdTrrypxZ673n/Pskfp/7UwHPK9vYrCusowk7NTpqO0JAU20LqTBtfNKVfeVL9n2SMuemazuEphxAIbaF2UK28qN74LtKGODMMb3wVaje8CLQAAAABBMRsZgmI2MsNTLSsExWxkRfR3fYanWlbHlkFPCIrZyEm7wtGK6O/6y9n04wxPtaxNfq61ji2Dns8cmIdREsJKECPZU9Nw9HiSQe9hVdeuLhTmtTfXtZgcloSDBVmYG4IYqQCb2/otsJrLNqldXXfmHGxs/98/QdSeDlrNoiSEleMVn4wgRrKnYXepvqbh6PHn0PPoJIPew2Wyxdqqrl1d659GRCjMa29p/XB2rmsxOe9aKiAsCQcLbTgcEvM2Rt+yB13GcVRw7TBla/T38yq7tsIxonWRHIk0oAeQ+7yfF7qNhA553qklOO+yPP9583O+SOhqfRvFQTwq3lgFT3nwRH5i6YctT8LGHFTbAYoVlEC7Do2D6COmwtk4vw3FoDhM9Lshj6eWCs6WjRMJAMxcSDHXRYti+m7KU+F3VF27uhVsoKPWP42Ilw6WkVCY194RqczH0vrh7JPL+vVc12JyHeZ5a961VECfhE9ZWBIOFhkjFQ/acDgkm0EjPadr/WXmWuZ8JQnLV2Q40E6jrpEB4p+KGCHMpzNg/bwqr+Ekre7QP7QtgxKfbLIJhqskSMnqFVPQKUZ++2h3ZeL2eT8vt0gkNnQbCR01KhIE8rxTS7ONSFJw3mV5Me9+YP7z5ue/wv3+fJHQ1T2gy8z6NoqDuweRmnhUvLE5ZaeoS5iDOwqpmCLJ+rUJiMuuEE9d718ObPRGzT/ZbYwOwnRDElrzAiNB6sFwbMGAQXfYR9c2lwbmLY7FtQClhIQbvBqKQXFbu1pomOh3Q9nZbFoeTy0VX342DJwtGyfdHAA+EgCYuVMxg6CQYq6L0VO1khbF9N1X9O/ElKfC79WW2fbpvAeuqI0ct2veMZwq7yqF7XlryqxIcNNvG134LipG4eE23magB8V/Y1ToVCJl803l87ICpMKpG2eRhDAmoJ8puK7F5Pmf3v06zPPWe/3oz7xrqYD9WrKZPgmfsn84hKuwJBws8RUHNTJGKh5zdzEHtOFwSPXQa1E2g0Z6d7JdY07X+ssP5uHSzLXM+Y2E1+BKEpavCyONtshwoJ2JQbuERl0jAwdsOBrEPxUxhQ4OKEKYT2cDqVR+wPp5VYHLYkwfxTiBXvQjmJ2nDrPclhWqGwBU5VoxT/yZYmLX2FN5zhdP4UlWfvpQlS3Xe9QczGITio0tUruWNJHoux/Q2aAG7PN+Xq3CZUdukUhsL6BTdeg2EjqpBwkjalQkCCtlPxHkeaeWpUi8j2YbkaQnKoq94LzL8qGN0Oti3v3AI+/m2b3hvBT80KcNP4OKJn6ykT+5JNBw+BXLaTtG5kJ6d/1btWtl3PRafsU3CVPudjhI97GuCbjwnxKhM8w/inL9JJMAAAAAN2rCAW7UhANZvkYC3KgJB+vCywayfI0EhRZPBbhREw6PO9EP1oWXDeHvVQxk+RoJU5PYCAotngo9R1wLcKMmHEfJ5B0ed6IfKR1gHqwLLxubYe0awt+rGPW1aRnI8jUS/5j3E6YmsRGRTHMQFFo8FSMw/hR6jrgWTeR6F+BGTTjXLI85jpLJO7n4Czo87kQ/C4SGPlI6wDxlUAI9WBdeNm99nDc2w9o1AakYNIS/VzGz1ZUw6mvTMt0BETOQ5Wskp4+pJf4x7yfJWy0mTE1iI3snoCIimeYgFfMkISi0eCof3rorRmD8KXEKPij0HHEtw3azLJrI9S6tojcvwI2acPfnWHGuWR5zmTPcchwlk3crT1F2cvEXdEWb1XV43Il+T7ZLfxYIDX0hYs98pHSAeZMeQnjKoAR6/crGe7AuvGyHRH5t3vo4b+mQ+m5shrVrW+x3agJSMWg1OPNpCH+vYj8VbWNmqythUcHpYNTXpmXjvWRkugMiZo1p4Gcgy9dIF6EVSU4fU0t5dZFK/GPeT8sJHE6St1pMpd2YTZiaxEav8AZH9k5ARcEkgkREMs1Bc1gPQCrmSUIdjItDUGjxVGcCM1U+vHVXCda3VozA+FO7qjpS4hR8UNV+vlHoOeJa31MgW4btZlmxh6RYNJHrXQP7KVxaRW9ebS+tX4AbNeG3cffg7s+x4tmlc+Ncszzma9n+5zJnuOUFDXrkOEom7w8g5O5WnqLsYfRg7eTiL+jTiO3pijar671caerwuBP9x9LR/J5sl/6pBlX/LBAa+ht62PtCxJ75da5c+EjpAPN/g8LyJj2E8BFXRvGUQQn0oyvL9fqVjffN/0/2YF142Vc3utgOifzaOeM+27z1cd6Ln7Pf0iH13eVLN9zYDGvX72ap1rbY79SBsi3VBKRi0DPOoNFqcObTXRok0hD+XsUnlJzEfiraxklAGMfMVlfC+zyVw6KC08GV6BHAqK9Ny5/Fj8rGe8nI8RELyXQHRMxDbYbNGtPAzy25As5Alq+Rd/xtkC5CK5IZKOmTnD6mlqtUZJfy6iKVxYDglPjHvJ/PrX6elhM4nKF5+p0kb7WYEwV3mUq7MZt90fOaMDWJjQdfS4xe4Q2OaYvPj+ydgIrb90KLgkkEibUjxoiIZJqDvw5YguawHoDR2tyBVMyThGOmUYU6GBeHDXLVhqDQ4qmXuiCozgRmqvlupKt8eOuuSxIprxKsb60lxq2sGIHxpy/rM6Z2VXWkQT+3pcQp+KDzQzqhqv18o52XvqLQc8S15xkGtL6nQLaJzYK3DNvNsjuxD7NiD0mxVWWLsGgi17tfSBW6BvZTuDGckbm0it68g+AcvdpeWr/tNJi+AAAAAGVnvLiLyAmq7q+1EleXYo8y8N433F9rJbk4153vKLTFik8IfWTgvW8BhwHXuL/WSt3YavIzd9/gVhBjWJ9XGVD6MKXoFJ8Q+nH4rELIwHvfrafHZ0MIcnUmb87NcH+tlRUYES37t6Q/ntAYhyfozxpCj3OirCDGsMlHegg+rzKgW8iOGLVnOwrQAIeyaThQLwxf7Jfi8FmFh5flPdGHhmW04DrdWk+Pzz8oM3eGEOTq43dYUg3Y7UBov1H4ofgr8MSfl0gqMCJaT1ee4vZvSX+TCPXHfadA1RjA/G1O0J81K7cjjcUYlp+gfyonGUf9unwgQQKSj/QQ9+hIqD1YFJtYP6gjtpAdMdP3oYlqz3YUD6jKrOEHf76EYMMG0nCgXrcXHOZZuKn0PN8VTIXnwtHggH5pDi/Le2tId8OiDw3Lx2ixcynHBGFMoLjZ9ZhvRJD/0/x+UGbuGzfaVk0nuQ4oQAW2xu+wpKOIDBwasNuBf9dnOZF40iv0H26TA/cmO2aQmoOIPy+R7ViTKVRgRLQxB/gM36hNHrrP8abs35L+ibguRmcXm1QCcCfsu0jwcd4vTMkwgPnbVedFY5ygP2v5x4PTF2g2wXIPinnLN13krlDhXED/VE4lmOj2c4iLrhbvNxb4QIIEnSc+vCQf6SFBeFWZr9fgi8qwXDM7tlntXtHlVbB+UEfVGez/bCE7YglGh9rn6TLIgo6OcNSe7Six+VGQX1bkgjoxWDqDCY+n5m4zHwjBhg1tpjq1pOFAvcGG/AUvKUkXSk71r/N2IjKWEZ6KeL4rmB3ZlyBLyfR4Lq5IwMAB/dKlZkFqHF6W93k5Kk+Xlp9d8vEj5QUZa01gftf1jtFi5+u23l9SjgnCN+m1etlGAGi8IbzQ6jHfiI9WYzBh+dYiBJ5qmr2mvQfYwQG/Nm60rVMJCBWaTnId/ynOpRGGe7d04ccPzdkQkqi+rCpGERk4I3algHVmxtgQAXpg/q7PcpvJc8oi8aRXR5YY76k5rf3MXhFFBu5NdmOJ8c6NJkTc6EH4ZFF5L/k0HpNB2rEmU7/WmuvpxvmzjKFFC2IO8BkHaUyhvlGbPNs2J4Q1mZKWUP4uLpm5VCb83uieEnFdjHcW4TTOLjapq0mKEUXmPwMggYO7dpHg4xP2XFv9WelJmD5V8SEGgmxEYT7Uqs6Lxs+pN344QX/WXSbDbrOJdnzW7srEb9YdWQqxoeHkHhTzgXmoS9dpyxOyDnerXKHCuTnGfgGA/qmc5ZkVJAs2oDZuURyOpxZmhsJx2j4s3m8sSbnTlPCBBAmV5rixe0kNox4usRtIPtJDLVlu+8P22+mmkWdRH6mwzHrODHSUYblm8QYF3gAAAAB3BzCW7g5hLJkJUboHbcQZcGr0j+ljpTWeZJWjDtuIMnncuKTg1ekel9LZiAm2TCt+sXy957gtB5C/HZEdtxBkarAg8vO5cUiEvkHeGtrUfW3d5Ov01LVRg9OFxxNsmFZka6jA/WL5eoplyewUAVxPYwZs2foPPWONCA31O24gyExpEF7VYEHkomdxcjwD5NFLBNRH0g2F/aUKtWs1taj6QrKYbNu7ydasvPlAMths40XfXHXc1g3Pq9E9WSbZMKxR3gA6yNdRgL/QYRYhtPS1VrPEI8+6lZm4vaUPKAK4nl8FiAjGDNmysQvpJC9vfIdYaEwRwWEdq7ZmLT123EGQAdtxBpjSILzv1RAqcbGFiQa2tR+fv+Sl6LjUM3gHyaIPAPk0lgmojuEOmBh/ag27CG09LZFkbJfmY1wBa2tR9BxsYWKFZTDY8mIATmwGle0bAaV7ggj0wfUPxFdlsNnGErfpUIu+uOr8uYh8Yt0d3xXaLUmM03zz+9RMZU2yYVg6tVHOo7wAdNS7MOJK36VBPdiV16TRxG3T1vT7Q2npajRu2fytZ4hG2mC40EQELXMzAx3lqgpMX90NfMlQBXE8JwJBqr4LEBDJDCCGV2i1JSBvhbO5ZtQJzmHkn17e+Q4p2cmYsNCYIsfXqLRZsz0XLrQNgbe9XDvAumyt7biDIJq/s7YDtuIMdLHSmurVRzmd0nevBNsmFXPcFoPjYwsSlGQ7hA1taj56alqo5A7PC5MJ/50KAK4nfQeesfAPk0SHCKPSHgHyaGkGwv73YlddgGVnyxlsNnFuawbn/tQbdonTK+AQ2npaZ91KzPm532+Ovu/5F7e+Q2CwjtXW1qPoodGTfjjYwsRP3/JS0btn8aa8V2c/tQbdSLI2S9gNK9qvChtMNgNK9kEEemDfYO/DqGffVTFuju9Gab55y2GzjLxmgxolb9KgUmjiNswMd5W7C0cDIgIWuVUFJi/Fuju+sr0LKCu0WpJcs2oEwtf/p7XQzzEs2Z6LW96uHZtkwrDsY/ImdWqjnAJtkwqcCQap6w42P3IHZ4UFAFcTlb9KguK4ehR7sSuuDLYbOJLSjpvl1b4NfNzvtwvb3yGG09LU8dTiQmjds/gf2oNugb4Wzfa5JltvsHfhGLdHd4gIWub/D2pwZgY7yhEBC1yPZZ7/+GKuaWFr/9MWbM9FoArieNcN0u5OBINUOQOzwqdnJmHQYBb3SWlHTT5ud9uu0WpK2dZa3EDfC2Y32DvwqbyuU967nsVHss9/MLX/6b298hzKusKKU7OTMCS0o6a60DYFzdcGk1TeVykj2We/s2Z6LsRhSrhdaBsCKm8rlLQLvjfDDI6hWgXfGy0C740AAAAAGRsxQTI2YoIrLVPDZGzFBH139EVWWqeGT0GWx8jZigjRwrtJ+u/oiuP02custU8Mta5+TZ6DLY6HmBzPSsISUVPZIxB49HDTYe9Bki6u11U3teYUHJi11wWDhJaCG5hZmwCpGLAt+tupNsua5nddXf9sbBzUQT/fzVoOnpWEJKKMnxXjp7JGIL6pd2Hx6OGm6PPQ58PegyTaxbJlXV2uqkRGn+tva8wodnD9aTkxa64gKlrvCwcJLBIcOG3fRjbzxl0Hsu1wVHH0a2Uwuyrz96IxwraJHJF1kAegNBefvPsOhI26JaneeTyy7zhz83n/auhIvkHFG31Y3io88HlPBelifkTCTy2H21QcxpQVigGNDrtApiPog7842cI4oMUNIbv0TAqWp48TjZbOXMwACUXXMUhu+mKLd+FTyrq7XVSjoGwViI0/1pGWDpfe15hQx8ypEezh+tL1+suTcmLXXGt55h1AVLXeWU+EnxYOElgPFSMZJDhw2j0jQZtl/WunfOZa5lfLCSVO0DhkAZGuoxiKn+Izp8whKrz9YK0k4a+0P9DunxKDLYYJsmzJSCSr0FMV6vt+RiniZXdoLz959jYkSLcdCRt0BBIqNUtTvPJSSI2zeWXecGB+7zHn5vP+/v3Cv9XQkXzMy6A9g4o2+pqRB7uxvFR4qKdlOTuDmEsimKkKCbX6yRCuy4hf711PRvRsDm3ZP810wg6M81oSQ+pBIwLBbHDB2HdBgJc210eOLeYGpQC1xbwbhIRxQYoaaFq7W0N36JhabNnZFS1PHgw2fl8nGy2cPgAc3bmYABKggzFTi65ikJK1U9Hd9MUWxO/0V+/Cp5T22ZbVrge86bccjaicMd5rhSrvKspree3TcEis+F0bb+FGKi5m3jbhf8UHoFToVGNN82UiArLz5RupwqQwhJFnKZ+gJuTFrrj93p/51vPMOs/o/XuAqWu8mbJa/bKfCT6rhDh/LBwksDUHFfEeKkYyBzF3c0hw4bRRa9D1ekaDNmNdsnfL+tdO0uHmD/nMtczg14SNr5YSSraNIwudoHDIhLtBiQMjXUYaOGwHMRU/xCgODoVnT5hCflSpA1V5+sBMYsuBgTjFH5gj9F6zDqedqhWW3OVUABv8TzFa12Jimc55U9hJ4U8XUPp+VnvXLZVizBzULY2KEzSWu1Ifu+iRBqDZ0F5+8+xHZcKtbEiRbnVToC86EjboIwkHqQgkVGoRP2Urlqd55I+8SKWkkRtmvYoqJ/LLvODr0I2hwP3eYtnm7yMUvOG9DafQ/CaKgz8/kbJ+cNAkuWnLFfhC5kY7W/13etxla7XFflr07lMJN/dIOHa4Ca6xoRKf8Io/zDOTJP1yAAAAAAHCajcDhNRuAka+WQcJqNwGy8LrBI18sgVPFoUOE1G4D9E7jw2XhdYMVe/hCRr5ZAjYk1MKni0KC1xHPRwmo3Ad5MlHH6J3Hh5gHSkbLwusGu1hmxir38IZabX1EjXyyBP3mP8RsSamEHNMkRU8WhQU/jAjFriOehd65E04TUbgOY8s1zvJko46C/i5P0TuPD6GhAs8wDpSPQJQZTZeF1g3nH1vNdrDNjQYqQExV7+EMJXVszLTa+ozEQHdJGvlkCWpj6cn7zH+Ji1bySNiTUwioCd7IOaZIiEk8xUqeLQoK7reHyn8YEYoPgpxLXEc9CyzdsMu9ciaLzeirXCajcBxWOf3cx5ZrnLcM5l3kyUcdlFPK3QX8XJ11ZtFfonceH9Ltk99DQgWfM9iIXmAdKR4Qh6TegSgynvGyv1svC6wbX5Eh284+t5u+pDpa7WGbGp37FtoMVICafM4NWKvfwhjbRU/YSurZmDpwVFlptfUZGS942YiA7pn4GmNSNfLIEkVoRdLUx9OSpF1eU/eY/xOHAnLTFq3kk2Y3aVGxJqYRwbwr0VATvZEgiTBQc0yREAPWHNCSeYqQ4uMHVTxaFBVMwJnV3W8Pla31glT+MCMUjqqu1B8FOJRvn7VWuI56FsgU99ZZu2GWKSHsV3rkTRcKfsDXm9FWl+tL23hNRuA4Pdxt+Kxz+7jc6XZ5jyzXOf+2WvluGcy5HoNBe8mSjju5CAP7KKeVu1g9GHoL+Lk6e2I0+urNorqaVy9/RO48PzR0sf+l2ye/1UGqfoaECz72Hob+Z7EQvhcrnXzAOlI8sKDf/CEPSbxRlcR9AlBlPXLK6P3jZX69k//zdl4XWDYujdX2vyJDts+4znecfW837Ofi931IdLcN0vl12sM2NapZu/U79i21S2ygdBipATRoM4z0+ZwatIkGl3FXv4QxJyUJ8baKn7HGEBJwldWzMOVPPvB04KiwBHolctNr6jKj8WfyMl7xskLEfHMRAd0zYZtQ8/A0xrOArktka+WQJBt/HeSK0Iuk+koGZamPpyXZFSrlSLq8pTggMWfvMf4nn6tz5w4E5ad+nmhmLVvJJl3BRObMbtKmvPRfY2JNTCMS18Hjg3hXo/Pi2mKgJ3si0L324kESYKIxiO1g5pkiIJYDr+AHrDmgdza0YSTzFSFUaZjhxcYOobVcg2p4tCgqCC6l6pmBM6rpG75rut4fK8pEkutb6wSrK3GJafxgRimM+svpHVVdqW3P0Gg+CnEoTpD86N8/aqivpedtcRz0LQGGee2QKe+t4LNibLN2wyzD7E7sUkPYrCLZVW71yJouhVIX7hT9ga5kZwxvN6KtL0c4IO/Wl7avpg07QAAAAC4vGdlqgnIixK1r+6PYpdXN97wMiVrX9yd1zi5xbQo730IT4pvveBk1wGHAUrWv7jyatjd4N93M1hjEFZQGVef6KUw+voQnxRCrPhx33vAyGfHp611cghDzc5vJpWtf3AtERgVP6S3+4cY0J4az+gnonOPQrDGIKwIekfJoDKvPhiOyFsKO2e1socA0C9QOGmX7F8MhVnw4j3ll4dlhofR3TrgtM+PT1p3Myg/6uQQhlJYd+NA7dgN+FG/aPAr+KFIl5/EWiIwKuKeV09/SW/2x/UIk9VAp31t/MAYNZ/QTo0jtyuflhjFJyp/oLr9RxkCQSB8EPSPkqhI6PebFFg9I6g/WDEdkLaJoffTFHbPaqzKqA++fwfhBsNghF6gcNLmHBe39Km4WUwV3zzRwueFaX6A4HvLLw7Dd0hryw0PonOxaMdhBMcp2bigTERvmPX80/+Q7mZQflbaNxsOuSdNtgVAKKSw78YcDIijgduwGjln138r0niRk24f9Dsm9wODmpBmkS8/iCmTWO20RGBUDPgHMR5NqN+m8c+6/pLf7EYuuIlUmxdn7CdwAnHwSLvJTC/e2/mAMGNF51VrP6Cc04PH+cE2aBd5ig9y5F03y1zhUK5OVP9A9uiYJa6LiHMWN+8WBIJA+Lw+J50h6R8kmVV4QYvg168zXLDK7Vm2O1Xl0V5HUH6w/+wZ1WI7IWzah0YJyDLp53COjoIo7Z7UkFH5sYLkVl86WDE6p48Jgx8zbuYNhsEItTqmbb1A4aQF/IbBF0kpL6/1TkoyInbzip4Rlpgrvnggl9kdePTJS8BIri7S/QHAakFmpfeWXhxPKjl5XZ+Wl+Uj8fJNaxkF9dd+YOdi0Y5f3rbrwgmOUnq16TdoAEbZ0LwhvIjfMeowY1aPItb5YZpqngQHvaa9vwHB2K20bjYVCAlTHXJOmqXOKf+3e4YRD8fhdJIQ2c0qrL6oOBkRRoCldiPYxmZ1YHoBEHLPrv7Kc8mbV6TxIu8Ylkf9rTmpRRFezHZN7gbO8Ylj3EQmjWT4Qej5L3lRQZMeNFMmsdrrmta/s/nG6QtFoYwZ8A5ioUxpBzybUb6EJzbblpKZNS4u/lAmVLmZnuje/IxdcRI04RZ3qTYuzhGKSasDP+ZFu4OBIOPgkXZbXPYTSelZ/fFVPphsggYh1D5hRMaLzqp+N6nP1n9BOG7DJl18domzxMru1lkd1m/hobEK8xQe5EuoeYETy2nXq3cOsrnCoVwBfsY5nKn+gCQVmeU2oDYLjhxRboZmFqc+2nHCLG/eLJTTuUkJBIHwsbjmlaMNSXsbsS4eQ9I+SPtuWS3p2/bDUWeRpsywqR90DM56ZrlhlN4FBvEAAAAAAAAAAAMAAAAEAAQACAAEAAQAAAAEAAUAEAAIAAQAAAAEAAYAIAAgAAQAAAAEAAQAEAAQAAUAAAAIABAAIAAgAAUAAAAIABAAgACAAAUAAAAIACAAgAAAAQUAAAAgAIAAAgEABAUAAAAgAAIBAgEAEAUAQYHJAAu2EAECAwQEBQUGBgYGBwcHBwgICAgICAgICQkJCQkJCQkKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDwAAEBESEhMTFBQUFBUVFRUWFhYWFhYWFhcXFxcXFxcXGBgYGBgYGBgYGBgYGBgYGBkZGRkZGRkZGRkZGRkZGRkaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHB0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0AAQIDBAUGBwgICQkKCgsLDAwMDA0NDQ0ODg4ODw8PDxAQEBAQEBAQERERERERERESEhISEhISEhMTExMTExMTFBQUFBQUFBQUFBQUFBQUFBUVFRUVFRUVFRUVFRUVFRUWFhYWFhYWFhYWFhYWFhYWFxcXFxcXFxcXFxcXFxcXFxgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxscwCcAAMAsAAABAQAAHgEAAA8AAABALAAAQC0AAAAAAAAeAAAADwAAAAAAAADALQAAAAAAABMAAAAHAAAAAAAAAAwACACMAAgATAAIAMwACAAsAAgArAAIAGwACADsAAgAHAAIAJwACABcAAgA3AAIADwACAC8AAgAfAAIAPwACAACAAgAggAIAEIACADCAAgAIgAIAKIACABiAAgA4gAIABIACACSAAgAUgAIANIACAAyAAgAsgAIAHIACADyAAgACgAIAIoACABKAAgAygAIACoACACqAAgAagAIAOoACAAaAAgAmgAIAFoACADaAAgAOgAIALoACAB6AAgA+gAIAAYACACGAAgARgAIAMYACAAmAAgApgAIAGYACADmAAgAFgAIAJYACABWAAgA1gAIADYACAC2AAgAdgAIAPYACAAOAAgAjgAIAE4ACADOAAgALgAIAK4ACABuAAgA7gAIAB4ACACeAAgAXgAIAN4ACAA+AAgAvgAIAH4ACAD+AAgAAQAIAIEACABBAAgAwQAIACEACAChAAgAYQAIAOEACAARAAgAkQAIAFEACADRAAgAMQAIALEACABxAAgA8QAIAAkACACJAAgASQAIAMkACAApAAgAqQAIAGkACADpAAgAGQAIAJkACABZAAgA2QAIADkACAC5AAgAeQAIAPkACAAFAAgAhQAIAEUACADFAAgAJQAIAKUACABlAAgA5QAIABUACACVAAgAVQAIANUACAA1AAgAtQAIAHUACAD1AAgADQAIAI0ACABNAAgAzQAIAC0ACACtAAgAbQAIAO0ACAAdAAgAnQAIAF0ACADdAAgAPQAIAL0ACAB9AAgA/QAIABMACQATAQkAkwAJAJMBCQBTAAkAUwEJANMACQDTAQkAMwAJADMBCQCzAAkAswEJAHMACQBzAQkA8wAJAPMBCQALAAkACwEJAIsACQCLAQkASwAJAEsBCQDLAAkAywEJACsACQArAQkAqwAJAKsBCQBrAAkAawEJAOsACQDrAQkAGwAJABsBCQCbAAkAmwEJAFsACQBbAQkA2wAJANsBCQA7AAkAOwEJALsACQC7AQkAewAJAHsBCQD7AAkA+wEJAAcACQAHAQkAhwAJAIcBCQBHAAkARwEJAMcACQDHAQkAJwAJACcBCQCnAAkApwEJAGcACQBnAQkA5wAJAOcBCQAXAAkAFwEJAJcACQCXAQkAVwAJAFcBCQDXAAkA1wEJADcACQA3AQkAtwAJALcBCQB3AAkAdwEJAPcACQD3AQkADwAJAA8BCQCPAAkAjwEJAE8ACQBPAQkAzwAJAM8BCQAvAAkALwEJAK8ACQCvAQkAbwAJAG8BCQDvAAkA7wEJAB8ACQAfAQkAnwAJAJ8BCQBfAAkAXwEJAN8ACQDfAQkAPwAJAD8BCQC/AAkAvwEJAH8ACQB/AQkA/wAJAP8BCQAAAAcAQAAHACAABwBgAAcAEAAHAFAABwAwAAcAcAAHAAgABwBIAAcAKAAHAGgABwAYAAcAWAAHADgABwB4AAcABAAHAEQABwAkAAcAZAAHABQABwBUAAcANAAHAHQABwADAAgAgwAIAEMACADDAAgAIwAIAKMACABjAAgA4wAIAAAABQAQAAUACAAFABgABQAEAAUAFAAFAAwABQAcAAUAAgAFABIABQAKAAUAGgAFAAYABQAWAAUADgAFAB4ABQABAAUAEQAFAAkABQAZAAUABQAFABUABQANAAUAHQAFAAMABQATAAUACwAFABsABQAHAAUAFwAFAEHg2QALTQEAAAABAAAAAQAAAAEAAAACAAAAAgAAAAIAAAACAAAAAwAAAAMAAAADAAAAAwAAAAQAAAAEAAAABAAAAAQAAAAFAAAABQAAAAUAAAAFAEHQ2gALZQEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAUAAAAGAAAABgAAAAcAAAAHAAAACAAAAAgAAAAJAAAACQAAAAoAAAAKAAAACwAAAAsAAAAMAAAADAAAAA0AAAANAEGA3AALIwIAAAADAAAABwAAAAAAAAAQERIACAcJBgoFCwQMAw0CDgEPAEG03AALaQEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACgAAAAwAAAAOAAAAEAAAABQAAAAYAAAAHAAAACAAAAAoAAAAMAAAADgAAABAAAAAUAAAAGAAAABwAAAAgAAAAKAAAADAAAAA4ABBtN0AC5oCAQAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAAAAAEAAIABAAAAAgAAAAMAAAAEAAAABgAAAAgAAAAMAAAAEAAAABgAAAAgAAAAMAAAAEAAAABgAABuZWVkIGRpY3Rpb25hcnkAc3RyZWFtIGVuZAAAZmlsZSBlcnJvcgBzdHJlYW0gZXJyb3IAZGF0YSBlcnJvcgBpbnN1ZmZpY2llbnQgbWVtb3J5AGJ1ZmZlciBlcnJvcgBpbmNvbXBhdGlibGUgdmVyc2lvbgAAAAAoLwAAOC8AAEMvAABELwAATy8AAFwvAABnLwAAey8AAIgvAABDLwAAMS4yLjExAEHQ3wALA9AxUA==").split("").map(A=>A.charCodeAt(0));return new Uint8Array(p,0,p.length/Uint8Array.BYTES_PER_ELEMENT)}();let Qle,J4;function l9(){return l9=f(function*(){if(Qle)return Qle;const s={};let p,A={};for(p in s)Object.prototype.hasOwnProperty.call(s,p)&&(A[p]=s[p]);let y=!1,w=!1;y="object"==typeof window,w="function"==typeof importScripts,"object"==typeof process&&"object"==typeof process.versions&&process;let $="";(y||w)&&(w?$=self.location.href:"undefined"!=typeof document&&document.currentScript&&($=document.currentScript.src),$=0!==$.indexOf("blob:")?$.substr(0,$.lastIndexOf("/")+1):""),s.print||console.log.bind(console);const j=s.printErr||console.warn.bind(console);for(p in A)Object.prototype.hasOwnProperty.call(A,p)&&(s[p]=A[p]);let _e;A=null,"object"!=typeof WebAssembly&&Rv("no native wasm support detected");let K=!1;function _i(q_){const X_=s["_"+q_];return X_||Rv("Assertion failed: Cannot call unknown function "+q_+", make sure it is exported"),X_}function _o(q_,X_,u0,B0,$0){const A0={string:function(K0){let FI=0;if(null!=K0&&0!==K0){const MI=1+(K0.length<<2);FI=o0(MI),function(UR,aT,$1,nR){if(!(nR>0))return 0;const JL=$1+nR-1;for(let p3=0;p3<UR.length;++p3){let ES=UR.charCodeAt(p3);if(ES>=55296&&ES<=57343&&(ES=65536+((1023&ES)<<10)|1023&UR.charCodeAt(++p3)),ES<=127){if($1>=JL)break;aT[$1++]=ES}else if(ES<=2047){if($1+1>=JL)break;aT[$1++]=192|ES>>6,aT[$1++]=128|63&ES}else if(ES<=65535){if($1+2>=JL)break;aT[$1++]=224|ES>>12,aT[$1++]=128|ES>>6&63,aT[$1++]=128|63&ES}else{if($1+3>=JL)break;aT[$1++]=240|ES>>18,aT[$1++]=128|ES>>12&63,aT[$1++]=128|ES>>6&63,aT[$1++]=128|63&ES}}aT[$1]=0}(K0,_f,FI,MI)}return FI},array:function(K0){const FI=o0(K0.length);return ch.set(K0,FI),FI}},e_=_i(q_),y_=[];let D_=0;if(B0)for(let K0=0;K0<B0.length;K0++){const FI=A0[u0[K0]];FI?(0===D_&&(D_=j_()),y_[K0]=FI(B0[K0])):y_[K0]=B0[K0]}let d0=e_.apply(null,y_);return K0=d0,d0="string"===X_?(FI=K0)?function(WI,q1,JO){const UR=q1+undefined;let aT=q1,$1="";for(;WI[aT]&&!(aT>=UR);)++aT;if(aT-q1>16&&WI.subarray&&_u)return _u.decode(WI.subarray(q1,aT));for(;q1<aT;){let nR=WI[q1++];if(!(128&nR)){$1+=String.fromCharCode(nR);continue}const f3=63&WI[q1++];if(192==(224&nR)){$1+=String.fromCharCode((31&nR)<<6|f3);continue}const JL=63&WI[q1++];if(nR=224==(240&nR)?(15&nR)<<12|f3<<6|JL:(7&nR)<<18|f3<<12|JL<<6|63&WI[q1++],nR<65536)$1+=String.fromCharCode(nR);else{const p3=nR-65536;$1+=String.fromCharCode(55296|p3>>10,56320|1023&p3)}}return $1}(_f,FI):"":"boolean"===X_?Boolean(K0):K0,0!==D_&&Z_(D_),d0;var K0,FI}const _u="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;let ch,_f,o_;"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");const i_=[],u_=[],g_=[],__=[];u_.push({func:function(){q0()}});let w_=0,k_=null;function Rv(q_){throw s.onAbort&&s.onAbort(q_),j(q_+=""),K=!0,q_="abort("+q_+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(q_)}s.preloadedImages={},s.preloadedAudios={};let f0="deflate.wasm";var q_;function b0(q_){for(;q_.length>0;){const X_=q_.shift();if("function"==typeof X_){X_(s);continue}const u0=X_.func;"number"==typeof u0?void 0===X_.arg?o_.get(u0)():o_.get(u0)(X_.arg):u0(void 0===X_.arg?null:X_.arg)}}f0.startsWith("data:application/octet-stream;base64,")||(q_=f0,f0=s.locateFile?s.locateFile(q_,$):$+q_);const rI={emscripten_memcpy_big:function(q_,X_,u0){_f.copyWithin(q_,X_,X_+u0)},emscripten_resize_heap:function(q_){Rv("OOM")}};yield f(function*(){const q_={env:rI,wasi_snapshot_preview1:rI};function X_($0,A0){var y_;s.asm=$0.exports,_e=s.asm.memory,y_=_e.buffer,s.HEAP8=ch=new Int8Array(y_),s.HEAP16=new Int16Array(y_),s.HEAP32=new Int32Array(y_),s.HEAPU8=_f=new Uint8Array(y_),s.HEAPU16=new Uint16Array(y_),s.HEAPU32=new Uint32Array(y_),s.HEAPF32=new Float32Array(y_),s.HEAPF64=new Float64Array(y_),o_=s.asm.__indirect_function_table,function(D_){if(w_--,s.monitorRunDependencies&&s.monitorRunDependencies(w_),0==w_&&k_){const d0=k_;k_=null,d0()}}()}if(w_++,s.monitorRunDependencies&&s.monitorRunDependencies(w_),s.instantiateWasm)try{return s.instantiateWasm(q_,X_)}catch($0){return j("Module.instantiateWasm callback failed with error: "+$0),!1}return yield function B0($0){return new iI((A0,e_)=>{A0(AG().buffer)}).then(function(A0){return WebAssembly.instantiate(A0,q_)}).then($0,function(A0){j("failed to asynchronously prepare wasm: "+A0),Rv(A0)})}(function u0($0){X_($0.instance)}),{}})();let q0=s.___wasm_call_ctors=function(){return(q0=s.___wasm_call_ctors=s.asm.__wasm_call_ctors).apply(null,arguments)},Z0=s._malloc=function(){return(Z0=s._malloc=s.asm.malloc).apply(null,arguments)};s._free=function(){return(s._free=s.asm.free).apply(null,arguments)},s.___errno_location=function(){return(s.___errno_location=s.asm.__errno_location).apply(null,arguments)},s._zlibCompress=function(){return(s._zlibCompress=s.asm.zlibCompress).apply(null,arguments)};let a0,j_=s.stackSave=function(){return(j_=s.stackSave=s.asm.stackSave).apply(null,arguments)},Z_=s.stackRestore=function(){return(Z_=s.stackRestore=s.asm.stackRestore).apply(null,arguments)},o0=s.stackAlloc=function(){return(o0=s.stackAlloc=s.asm.stackAlloc).apply(null,arguments)};function z0(q_){function X_(){a0||(a0=!0,s.calledRun=!0,K||(b0(u_),b0(g_),s.onRuntimeInitialized&&s.onRuntimeInitialized(),function(){if(s.postRun)for("function"==typeof s.postRun&&(s.postRun=[s.postRun]);s.postRun.length;)u0=s.postRun.shift(),__.unshift(u0);var u0;b0(__)}()))}w_>0||(function(){if(s.preRun)for("function"==typeof s.preRun&&(s.preRun=[s.preRun]);s.preRun.length;)u0=s.preRun.shift(),i_.unshift(u0);var u0;b0(i_)}(),w_>0||(s.setStatus?(s.setStatus("Running..."),setTimeout(function(){setTimeout(function(){s.setStatus("")},1),X_()},1)):X_()))}if(s.ccall=_o,s.cwrap=function(q_,X_,u0,B0){const $0=(u0=u0||[]).every(function(A0){return"number"===A0});return"string"!==X_&&$0&&!B0?_i(q_):function(){return _o(q_,X_,u0,arguments)}},s.allocate=function(q_,X_){let u0;return u0=1==X_?o0(q_.length):Z0(q_.length),_f.set(q_.subarray||q_.slice?q_:new Uint8Array(q_),u0),u0},k_=function q_(){a0||z0(),a0||(k_=q_)},s.run=z0,s.preInit)for("function"==typeof s.preInit&&(s.preInit=[s.preInit]);s.preInit.length>0;)s.preInit.pop()();return z0(),Qle=s,s}),l9.apply(this,arguments)}const Y6=Uint8Array.BYTES_PER_ELEMENT,uye={bytesReceived:"br",frameDropped:"fd",frameReceived:"fr",googJitterReceived:"jr",isAudioMute:"am",isFreeze:"fz",mediaType:"mt",packetsLost:"pl",packetsReceived:"pr",peerId:"pid",id:"id",ssrc:"ssrc",timestamp:"ts",type:"tp",frameRateInput:"fi",frameRateSent:"fs",googRtt:"rt",isVideoMute:"vm"},lye={stats:"sts",state:"st",stream_id:"stid",session_id:"seid",stream_type:"stt",app_id:"aid",channel_key:"ck",channel_name:"cn",sdk_version:"sv",browser:"b",process_id:"pcid",mode:"m",codec:"c",role:"r",has_changed_gateway:"hcg",ap_response:"ar",extends:"es",details:"d",features:"ft",p2p_id:"ppid",sdp:"sdp",audio:"a",video:"v",attributes:"at",hq:"h",lq:"l",stereo:"str",speech:"spe",extend:"e",pingpongElapse:"ppe"},dye={_message:"m",_type:"t",_id:"id"},hye={join_v2:"j2",publish:"pub",publish_related_stats:"prs",ping:"pi",traffic_stats:"ts",ping_back:"pib",publish_stats:"pubs"};let qie;class fye{constructor(){a_(this,"zlibCompress",void 0)}init(){var p=this;return f(function*(){qie||(qie=(yield f(function*(){return J4||(J4=yield function sme(){return l9.apply(this,arguments)}()),{zlibCompress:y=>{const w=new Uint8Array(y),$=Y6*w.byteLength,j=J4._malloc($),_e=J4._malloc(3*$);for(let _o=0;_o<$;_o++)J4.HEAP8[j/Y6+_o]=w[_o];const K=J4._zlibCompress(j,$,_e),_i=new Uint8Array(J4.HEAP8.slice(_e,_e+K));return J4._free(j),J4._free(_e),_i}}})()).zlibCompress),p.zlibCompress=qie})()}msgPackCompress(p){return iY.exports.encode(p)}compress(p){const A=Date.now(),y=this.compressKeyAndValue(JSON.parse(JSON.stringify(p))),w=this.msgPackCompress(y),$=this.zlibCompress(w),j=new Uint8Array([49,49,49,50,...Array.from($)]);return{origin:Object.assign({},p),originLength:JSON.stringify(p).length,shortKeyAndValue:y,msgpackSer:w,compressed:j,compressedLength:j.length,time:Date.now()-A}}compressKeyAndValue(p){return this._ObjectKeyCompress(this._typeCompress(p))}_typeCompress(p){const A=p._type;return A?(p._type=hye[A]||A,p):p}_ObjectKeyCompress(p){const A=p._message;if(A){const y=A.stats;y&&(A.stats=this._statsCompress(y)),p._message=this._messageCompress(A)}return this._reportCompress(p)}_statsCompress(p){return this._keyCompress(p,uye)}_messageCompress(p){return this._keyCompress(p,lye)}_reportCompress(p){return this._keyCompress(p,dye)}_keyCompress(p,A){const y={},w=Object.keys(p);return qP(w).call(w,($,j)=>{const _e=p[j];return A[j]?y[A[j]]=_e:y[j]=_e,y},y),y}}class pye extends sS{get queue(){return[...this.highPriorityQueue,...this.lowPriorityQueue]}constructor(p){super(),a_(this,"lowPriorityQueue",[]),a_(this,"highPriorityQueue",[]),a_(this,"AgoraWebSocketManager",void 0),this.AgoraWebSocketManager=p}reset(){this.lowPriorityQueue=[],this.highPriorityQueue=[]}pushMessage(p){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.highPriorityQueue.push(p):this.lowPriorityQueue.push(p),this.sendMessage()}sendMessage(){const p=this.queue.length;let A=0;A=p<5?15*p:60+3*(p-4),setTimeout(()=>{this._sendMessage()},A)}_sendMessage(){if(!this.queue.length)return;const p=this.AgoraWebSocketManager.getConnection();if(!p||1!==p.readyState)return;const A=this.queue.shift();return this.lowPriorityQueue.includes(A)?this.lowPriorityQueue.shift():this.highPriorityQueue.shift(),p.send(A.compressed),A}}var Hle;function ame(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}let Wie=TR("AgoraWebSocketManager","connectionID")(Hle=class extends sS{get url(){return this.websocket?this.websocket.url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(s){["tryNext","recover"].includes(s)&&this.resetReconnectCount(s),this._reconnectMode=s}get state(){return this._state}set state(s){s!==this._state&&(this._state=s,"reconnecting"===this._state?this.emit(p1.RECONNECTING,this.reconnectReason):"connected"===this._state?this.emit(p1.CONNECTED):"closed"===this._state?this.emit(p1.CLOSED):"failed"===this._state&&this.emit(p1.FAILED))}resetReconnectCount(s){h_.debug("websocket reset reconnect count, reason: "+s),S0("debug",this,"resetReconnectCount",s,"websocket reset reconnect count, reason: "+s),this.reconnectCount=0}constructor(s,p){let A=arguments.length>2&&void 0!==arguments[2]&&arguments[2],y=arguments.length>3&&void 0!==arguments[3]&&arguments[3],w=arguments.length>4?arguments[4]:void 0;super(),a_(this,"connectionID",0),a_(this,"currentURLIndex",0),a_(this,"urls",void 0),a_(this,"_reconnectMode","tryNext"),a_(this,"reconnectReason",void 0),a_(this,"_initMutex",new iP("websocket")),a_(this,"name",void 0),a_(this,"_state","closed"),a_(this,"reconnectInterrupter",void 0),a_(this,"websocket",void 0),a_(this,"retryConfig",void 0),a_(this,"reconnectCount",0),a_(this,"onlineReconnectListener",void 0),a_(this,"compressor",new fye),a_(this,"compressorInitStatus","initializing"),a_(this,"compress",void 0),a_(this,"messageSender",void 0),a_(this,"useCompress",void 0),a_(this,"tryDoubleDomain",!1),a_(this,"wsInflateLength",0),a_(this,"wsDeflateLength",0),a_(this,"closeEstablishingWs",()=>{}),a_(this,"store",void 0),a_(this,"joinChannelServiceRecordIndex",void 0),this.store=w,this.name=s,this.retryConfig=function(_o){for(var _u=1;_u<arguments.length;_u++){var ch=null!=arguments[_u]?arguments[_u]:{};_u%2?ame(Object(ch),!0).forEach(function(_f){a_(_o,_f,ch[_f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_o,Object.getOwnPropertyDescriptors(ch)):ame(Object(ch)).forEach(function(_f){Object.defineProperty(_o,_f,Object.getOwnPropertyDescriptor(ch,_f))})}return _o}({},p),this.useCompress=A,this.tryDoubleDomain=y;const{timeout:$,timeoutFactor:j}=p,_e=Math.max(300,Math.floor(3*$/5)),K=Math.max(1.2,Math.floor(8*j)/10);eP.ONLINE&&(this.retryConfig.timeout=_e,this.retryConfig.timeoutFactor=K),_S.on(_F.NETWORK_STATE_CHANGE,(_o,_u)=>{_o!==_u&&(this.resetReconnectCount("network state change: ".concat(_u," -> ").concat(_o)),_o===eP.ONLINE?(this.retryConfig.timeout=_e,this.retryConfig.timeoutFactor=K):(this.retryConfig.timeout=$,this.retryConfig.timeoutFactor=j))});const _i=Date.now();this.compressor.init().then(()=>{this.compressorInitStatus="initialized";const _o=Date.now()-_i;h_.debug("websocket compressor initialized successfully in ".concat(_o,"ms")),S0("debug",this.compressor,"init",void 0,"websocket compressor initialized successfully in ".concat(_o,"ms")),w0.wsCompressorInit({status:!0,ec:null,eventElapse:_o}),this.compress=this.compressor.compress.bind(this.compressor)}).catch(_o=>{this.compressorInitStatus="failed";const _u=_o?_o.message||_o.toString():"Empty Error";h_.debug("websocket compressor failed to initialize because of ".concat(_u)),S0("debug",this.compressor,"init",void 0,"websocket compressor failed to initialize because of ".concat(_u)),w0.wsCompressorInit({status:!1,ec:_u,eventElapse:1})})}getConnection(){return this.websocket||void 0}init(s){const p=(A,y)=>{this.urls=s;const w=this.urls[this.currentURLIndex];this.state="connecting",this.messageSender=new pye(this),this.createWebSocketConnection(w).then(A).catch(y),this.once(p1.CLOSED,()=>y(new U_(N_.WS_DISCONNECT))),this.once(p1.CONNECTED,()=>A())};return this._initMutex.lock().then(A=>new iI((y,w)=>{p(y,w)}).then(()=>{A()}).catch(()=>{A()}))}close(s,p){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const A=this.websocket;p?setTimeout(()=>A.close(),500):A.close(),this.websocket=void 0}this.state=s?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(s,p){if(!this.websocket)return h_.warning("[".concat(this.name,"] can not reconnect, no websocket")),void S0("warning",this,"reconnect","can not reconnect, no websocket");var A;void 0!==s&&(this.reconnectMode=s),h_.debug("[".concat(this.name,"] reconnect is triggered initiative")),S0("debug",this,"reconnect"),"number"==typeof this.joinChannelServiceRecordIndex&&(null===(A=this.store)||void 0===A||A.recordJoinChannelService({status:"error",errors:[new Error(p)]},this.joinChannelServiceRecordIndex));const y=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),y&&y.bind(this.websocket)({code:9999,reason:p})}sendMessageWithJSON(s){const p=JSON.stringify(s);return{compressed:p,compressedLength:p.length,origin:s}}sendMessage(s){let p=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new U_(N_.WS_ABORT,"websocket is not ready");try{let A=null;if("initialized"===this.compressorInitStatus&&this.useCompress&&v0("WEBSOCKET_COMPRESS"))try{A=this.compress(s),this.setWsInflateData(A)}catch(y){A=this.sendMessageWithJSON(s)}else A=this.sendMessageWithJSON(s);p?this.websocket.send(A.compressed):this.messageSender.pushMessage(A)}catch(A){throw new U_(N_.WS_ERR,"send websocket message error"+A.toString())}}setWsInflateData(s){this.wsDeflateLength=this.wsDeflateLength+s.originLength,this.wsInflateLength=this.wsInflateLength+s.compressedLength}getWsInflateData(){const s=this.wsInflateLength,p=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:s,wsDeflateLength:p}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}createWebSocketConnection(s,p){var A=this;return f(function*(){return A.connectionID+=1,A.joinChannelServiceRecordIndex=void 0,new iI((y,w)=>{var $;const j=()=>{h_.debug("[".concat(A.name,"] websocket opened:"),s),b6("debug",["WebSocket",A.connectionID],"open",s),A.reconnectMode="retry",A.state="connected",A.resetReconnectCount("opened"),y()},_e=function(){var _o=f(function*(_u){if(h_.debug("[".concat(A.name,"] websocket close ").concat(A.websocket&&A.websocket.url,", code: ").concat(_u.code,", reason: ").concat(_u.reason,", current mode: ").concat(A.reconnectMode)),b6("debug",["WebSocket",A.connectionID],"close",{code:_u.code,reason:_u.reason,url:A.websocket&&A.websocket.url,reconnectMode:A.reconnectMode}),A.reconnectCount<A.retryConfig.maxRetryCount){"connected"===A.state&&(A.reconnectReason=_u.reason,A.state="reconnecting");const ch=o3(A,p1.WILL_RECONNECT,A.reconnectMode)||A.reconnectMode,_f=yield A.reconnectWithAction(ch);if("closed"===A.state)return h_.debug("[".concat(A.connectionID,"] ws is closed, no need to reconnect")),void sI("debug",A,"ws is closed, no need to reconnect");if(!_f)return w(new U_(N_.WS_DISCONNECT,"websocket reconnect failed: ".concat(_u.code))),void A.close(!0);y()}else w(new U_(N_.WS_DISCONNECT,"websocket close: ".concat(_u.code))),A.close()});return function(ch){return _o.apply(this,arguments)}}(),K=_o=>{A.emit(p1.ON_MESSAGE,_o)};A.websocket&&(A.websocket.onclose=null,A.websocket.close()),v0("GATEWAY_WSS_ADDRESS")&&A.name.startsWith("gateway")&&(s=v0("GATEWAY_WSS_ADDRESS")),h_.debug("[".concat(A.name,"] start connect, url: ").concat(s)),sI("debug",A,"start connect, url: ".concat(s));const _i=null===($=A.store)||void 0===$?void 0:$.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});A.chooseBestWebsocketConnection(s,!!p,_i).then(_o=>{var _u;A.websocket=_o,j&&j(),_o.onclose=_e,_o.onmessage=K,null===(_u=A.store)||void 0===_u||_u.recordJoinChannelService({endTs:Date.now(),status:"success"},_i),A.joinChannelServiceRecordIndex=_i}).catch(_o=>{var _u;if(null===(_u=A.store)||void 0===_u||_u.recordJoinChannelService({endTs:Date.now(),status:_o instanceof U_&&_o.code===N_.WS_ABORT?"aborted":"error",errors:[_o]},_i),"closed"!==A.state){if(_o instanceof U_&&_o.code===N_.WS_ERR){const ch=new U_(N_.WS_ERR,"init websocket failed! Error: ".concat(_o.toString()));return h_.error("[".concat(A.name,"]").concat(ch)),S0("error",A,"chooseBestWebsocketConnection",void 0,_o.toString()),void w(ch)}_e&&_e(_o)}else w(new U_(N_.WS_DISCONNECT,"websocket is closed: ".concat(_o.toString())))})})})()}reconnectWithAction(s){var p=arguments,A=this;return f(function*(){let y=!(p.length>1&&void 0!==p[1])||p[1];if(A.reconnectCount>=A.retryConfig.maxRetryCount||!A.urls||"closed"===A.state)return!1;A.onlineReconnectListener||_S.networkState!==eP.OFFLINE||(A.onlineReconnectListener=_S.onlineWaiter&&_S.onlineWaiter.then(()=>{A.onlineReconnectListener=void 0}));let w=!0;if(A.reconnectInterrupter=()=>{w=!1},y){const j=ere(A.reconnectCount,A.retryConfig);h_.debug("[".concat(A.name,"] wait ").concat(j,"ms to reconnect websocket, mode: ").concat(s)),S0("debug",A,"reconnectWithAction",{timeout:j,action:s}),yield iI.race([pR(j),A.onlineReconnectListener||new iI(()=>{})])}if("closed"===A.state||!w)return!1;A.reconnectCount+=1;const $=function(){var j=f(function*(_e,K){A.emit(p1.RECONNECT_CREATE_CONNECTION,K),yield A.createWebSocketConnection(_e)});return function(K,_i){return j.apply(this,arguments)}}();try{if("retry"===s){const j=A.urls[A.currentURLIndex];A.emit(p1.RECONNECT_WAITTING_FINISH,s),yield $(j,s)}else if("tryNext"===s){if(A.currentURLIndex+=1,A.currentURLIndex>=A.urls.length)return yield A.reconnectWithAction("recover",!1);h_.debug("[".concat(A.name,"] websocket url length: ").concat(A.urls.length," current index: ").concat(A.currentURLIndex)),sI("debug",A,"websocket url length: ".concat(A.urls.length," current index: ").concat(A.currentURLIndex));const j=A.urls[A.currentURLIndex];A.emit(p1.RECONNECT_WAITTING_FINISH,s),yield $(j,s)}else if("recover"===s){h_.debug("[".concat(A.name,"] request new urls")),sI("debug",A,"request new urls"),A.resetReconnectCount("recover mode"),A.emit(p1.RECONNECT_WAITTING_FINISH,s),A.urls=yield ZP(A,p1.REQUEST_NEW_URLS),A.currentURLIndex=0;const j=A.urls[A.currentURLIndex];yield $(j,s)}return!0}catch(j){return h_.error("[".concat(A.name,"] reconnect failed"),j.toString()),S0("error",A,"reconnectWithAction",void 0,j.toString()),yield A.reconnectWithAction(s,y)}})()}chooseBestWebsocketConnection(s,p,A){var y=this;return f(function*(){return new iI((w,$)=>{let j=!1;const _e=[];y.closeEstablishingWs=()=>{h_.debug("[choose-best-ws] close establishing websockets"),_e.forEach(i_=>{i_.onclose=null,i_.onopen=null,i_.onmessage=null,i_.close()}),$(new U_(N_.WS_ABORT,"choose best websocket aborted"))};const K=v0("GATEWAY_DOMAINS");let _i;const _o=s.indexOf("?h="),_u=K.find(i_=>-1!==_o?s.includes(i_,_o):s.includes(i_));h_.debug("[choose-best-ws] currentDomain: ",_u,", domains: ",K),S0("debug",y,"chooseBestWebsocketConnection",{currentDomain:_u,domains:K});let ch=!y.tryDoubleDomain||p||!_u;if(!ch&&_u){var _f;const i_=Date.now();try{K.forEach(u_=>{const g_=-1===_o?s.replace(_u,u_):s.substr(0,_o)+s.substr(_o).replace(_u,u_),__=new WebSocket(g_);__.binaryType="arraybuffer",_e.push(__),h_.debug("[choose-best-ws] ws is connecting:",__.url),sI("debug",y,"ws is connecting: ".concat(__.url))})}catch(u_){for(h_.debug("[choose-best-ws] ws create failed, fallback to single url"),sI("debug",y,"ws create failed, fallback to single url"),_e.forEach(g_=>g_.close());_e.length;)_e.pop();ch=!0}null===(_f=y.store)||void 0===_f||_f.recordJoinChannelService({urls:_e.map(u_=>u_.url),service:"gateway"},A),_e.forEach(u_=>{u_.onopen=()=>{if(j)return;const g_=Date.now()-i_;h_.debug("[choose-best-ws] ws open cost ".concat(g_,"ms")),_e.filter(__=>__!==u_).forEach(__=>{h_.debug("[choose-best-ws]close backup websocket: ".concat(__.url)),sI("debug",y,"close backup websocket: ".concat(__.url)),__.close()}),j=!0,w(u_)},u_.onclose=g_=>{_i=g_,!j&&(_e.find(__=>!(__.readyState===WebSocket.CLOSED||__.readyState===WebSocket.CLOSING))||(h_.debug("[choose-best-ws] all websocket is closed"),sI("debug",y,"all websocket is closed"),j=!0,$(_i)))},u_.onmessage=g_=>{h_.debug("[choose-best-ws]".concat(u_.url," onmessage: ").concat(g_.data)),sI("debug",y,"".concat(u_.url," onmessage: ").concat(g_.data))}}),pR(5e3).then(()=>{_e.forEach(u_=>{u_.readyState!==WebSocket.OPEN&&u_.close()})})}if(ch){var o_;let i_;h_.debug("[choose-best-ws] use single url: ",s),sI("debug",y,"use single url: ".concat(s)),null===(o_=y.store)||void 0===o_||o_.recordJoinChannelService({urls:[s],service:"gateway"},A);try{i_=new WebSocket(s),_e.push(i_),i_.binaryType="arraybuffer"}catch(u_){const g_=new U_(N_.WS_ERR,"init websocket failed! Error: ".concat(u_.toString()));return h_.error("[".concat(y.name,"]").concat(g_)),S0("error",y,"chooseBestWebsocketConnection",void 0,u_.toString()),void $(g_)}i_.onopen=()=>{w(i_)},i_.onclose=u_=>{$(u_)},i_.onmessage=u_=>{h_.debug("[choose-best-ws]".concat(i_.url," onmessage: ").concat(u_.data)),sI("debug",y,"".concat(i_.url," onmessage: ").concat(u_.data))},pR(5e3).then(()=>{i_&&i_.readyState!==WebSocket.OPEN&&i_.close()})}}).then(w=>(y.closeEstablishingWs=void 0,w)).catch(w=>{throw y.closeEstablishingWs=void 0,w})})()}})||Hle;class cme{constructor(p){a_(this,"input",[]),a_(this,"size",void 0),this.size=p}add(p){this.input.push(p),this.input.length>this.size&&this.input.splice(0,1)}mean(){var p;return 0===this.input.length?0:qP(p=this.input).call(p,(A,y)=>A+y)/this.input.length}}var ume;let gye=TR("AgoraRTCSignal","websocket.connectionID")(ume=class extends sS{get connectionState(){return this._connectionState}set connectionState(s){s!==this._connectionState&&(this._connectionState=s,s===WT.CONNECTED?this.emit(i1.WS_CONNECTED):s===WT.RECONNECTING?this.emit(i1.WS_RECONNECTING,this._websocketReconnectReason):s===WT.CLOSED&&this.emit(i1.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(s,p){super(),a_(this,"_disconnectedReason",void 0),a_(this,"_websocketReconnectReason",void 0),a_(this,"_connectionState",WT.CLOSED),a_(this,"reconnectToken",void 0),a_(this,"websocket",void 0),a_(this,"openConnectionTime",void 0),a_(this,"clientId",void 0),a_(this,"lastMsgTime",Date.now()),a_(this,"uploadCache",[]),a_(this,"uploadCacheInterval",void 0),a_(this,"rttRolling",new cme(5)),a_(this,"pingpongTimer",void 0),a_(this,"wsInflateDataTimer",void 0),a_(this,"pingpongTimeoutCount",0),a_(this,"joinResponse",void 0),a_(this,"multiIpOption",void 0),a_(this,"initError",void 0),a_(this,"spec",void 0),a_(this,"store",void 0),a_(this,"onWebsocketMessage",A=>{if(A.data instanceof ArrayBuffer)return void this.emit(i1.ON_BINARY_DATA,A.data);const y=JSON.parse(A.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(y,"_id")){const w="res-@".concat(y._id);this.emit(w,y._result,y._message)}else if(Object.prototype.hasOwnProperty.call(y,"_type")&&(this.emit(y._type,y._message),y._type===V1.ON_NOTIFICATION&&this.handleNotification(y._message),y._type===V1.ON_USER_BANNED))switch(y._message.error_code){case 14:this.close(gS.UID_BANNED);break;case 15:this.close(gS.IP_BANNED);break;case 16:this.close(gS.CHANNEL_BANNED)}}),this.clientId=s.clientId,this.spec=s,this.store=p,this.websocket=new Wie("gateway-".concat(this.clientId),this.spec.retryConfig,!0,!0,p),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===WT.CONNECTED&&this.reconnect("retry",_N.OFFLINE)})}request(s,p,A,y){var w=this;return f(function*(){const $=VT(6,""),j={_id:$,_type:s,_message:p},_e=w.websocket.connectionID,K=()=>new iI((o_,i_)=>{if(w.connectionState===WT.CONNECTED)return o_();const u_=()=>{w.off(i1.WS_CLOSED,g_),o_()},g_=()=>{w.off(i1.WS_CONNECTED,u_),i_(new U_(N_.WS_ABORT))};w.once(i1.WS_CONNECTED,u_),w.once(i1.WS_CLOSED,g_),s!==h1.PUBLISH&&s!==h1.SUBSCRIBE&&s!==h1.UNSUBSCRIBE&&s!==h1.UNPUBLISH&&s!==h1.CONTROL||w.once(i1.DISCONNECT_P2P,()=>{i_(new U_(N_.DISCONNECT_P2P))}),s===h1.PUBLISH&&w.once(i1.ABORT_P2P_EXECUTION,()=>{i_(new U_(N_.DISCONNECT_P2P))})});if(w.connectionState!==WT.CONNECTING&&w.connectionState!==WT.RECONNECTING||s===h1.JOIN||s===h1.REJOIN||(yield K()),w.websocket.sendMessage(j,!0),y)return;const _i=new iI((o_,i_)=>{let u_=!1;const g_=(w_,k_)=>{u_=!0,o_({isSuccess:"success"===w_,message:k_||{}}),w.off(i1.WS_CLOSED,__),w.off(i1.WS_RECONNECTING,__),w.emit(i1.REQUEST_SUCCESS,s,p)};w.once("res-@".concat($),g_);const __=()=>{i_(new U_(N_.WS_ABORT,"type: ".concat(s))),w.off(i1.WS_CLOSED,__),w.off(i1.WS_RECONNECTING,__),w.off("res-@".concat($),g_)};w.once(i1.WS_CLOSED,__),w.once(i1.WS_RECONNECTING,__),pR(v0("SIGNAL_REQUEST_TIMEOUT")).then(()=>{w.websocket.connectionID!==_e||u_||(h_.warning("ws request timeout, type: ".concat(s)),sI("warning",w,"ws request timeout, type: ".concat(s)),w.emit(i1.REQUEST_TIMEOUT,s,p))})});let _o=null;try{_o=yield _i}catch(o_){if(w.connectionState===WT.CLOSED||s===h1.LEAVE)throw new U_(N_.WS_ABORT);return!w.spec.forceWaitGatewayResponse||A?o_.throw():s===h1.JOIN||s===h1.REJOIN?null:(yield K(),yield w.request(s,p))}if(_o.isSuccess)return _o.message;const _u=Number(_o.message.error_code||_o.message.code),ch=l3(_u),_f=new U_(N_.UNEXPECTED_RESPONSE,"".concat(ch.desc,": ").concat(_o.message.error_str),{code:_u,data:_o.message});return"success"===ch.action?_o.message:(h_.warning("[".concat(w.websocket.connectionID,"] unexpected response from type ").concat(s,", error_code: ").concat(_u,", message: ").concat(ch.desc,", action: ").concat(ch.action)),sI("warning",w,"unexpected response from type ".concat(s,", error_code: ").concat(_u,", message: ").concat(ch.desc,", action: ").concat(ch.action)),_u===OI.ERR_TOO_MANY_BROADCASTERS?((s===h1.JOIN||s===h1.REJOIN)&&(w.initError=_f,w.close()),_f.throw()):"failed"===ch.action?_f.throw():"quit"===ch.action?(w.initError=_f,w.close(),_f.throw()):(_u===OI.ERR_JOIN_BY_MULTI_IP?(w.multiIpOption=_o.message.option,h_.warning("[".concat(w.clientId,"] detect multi ip, recover")),sI("warning",w,"detect multi ip, recover"),w.reconnect("recover",_N.MULTI_IP)):w.reconnect(ch.action,_N.SERVER_ERROR),s===h1.JOIN||s===h1.REJOIN?null:yield w.request(s,p)))})()}waitMessage(s,p){return new iI(A=>{const y=w=>{(!p||p(w))&&(this.off(s,y),A(w))};this.on(s,y)})}upload(s,p){const A={_type:s,_message:p};try{this.websocket.sendMessage(A)}catch(y){const w=v0("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(A),this.uploadCache.length>w&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==WT.CONNECTED)return;const $=this.uploadCache.splice(0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload($._type,$._message)},v0("UPLOAD_CACHE_INTERVAL")||2e3))}}send(s,p){this.websocket.sendMessage({_type:s,_message:p})}init(s,p){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new iI((A,y)=>{this.once(i1.WS_CONNECTED,()=>A(this.joinResponse)),this.once(i1.WS_CLOSED,()=>y(this.initError||new U_(N_.WS_ABORT))),this.connectionState=WT.CONNECTING,this.websocket.init(s).catch(y),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4),setTimeout(()=>{p&&void 0===this.openConnectionTime&&(h_.debug("[".concat(this.clientId,"] init websocket timeout while join with fallback to proxy")),y(new U_(N_.INIT_WEBSOCKET_TIMEOUT)))},v0("JOIN_WITH_FALLBACK_PROXY_PENDING_DURATION"))})}close(s){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=s||gS.LEAVE,this.connectionState=WT.CLOSED,h_.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),s===gS.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new Wie("gateway-".concat(this.clientId),this.spec.retryConfig,!0,!0,this.store),this.handleWebsocketEvents())}join(){var s=this;return f(function*(){if(!s.joinResponse){s.emit(i1.ABORT_P2P_EXECUTION);const p=yield ZP(s,i1.REQUEST_JOIN_INFO),A=yield s.request(h1.JOIN,p);if(!A)return s.emit(i1.REPORT_JOIN_GATEWAY,N_.TIMEOUT,s.url||""),!1;s.joinResponse=A,s.emit(i1.JOIN_RESPONSE,s.joinResponse),s.reconnectToken=s.joinResponse.rejoin_token}return s.connectionState=WT.CONNECTED,s.pingpongTimer&&window.clearInterval(s.pingpongTimer),s.pingpongTimer=window.setInterval(s.handlePingPong.bind(s),3e3),!0})()}rejoin(){var s=this;return f(function*(){if(!s.reconnectToken)throw new U_(N_.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const p=zK(s,i1.REQUEST_REJOIN_INFO);p.token=s.reconnectToken;const A=yield s.request(h1.REJOIN,p);return!!A&&(s.connectionState=WT.CONNECTED,s.pingpongTimer&&window.clearInterval(s.pingpongTimer),s.pingpongTimer=window.setInterval(s.handlePingPong.bind(s),3e3),A.peers&&A.peers.forEach(y=>{s.emit(V1.ON_USER_ONLINE,{uid:y.uid}),s.emit(y.audio_mute?V1.MUTE_AUDIO:V1.UNMUTE_AUDIO,{uid:y.uid}),s.emit(y.video_mute?V1.MUTE_VIDEO:V1.UNMUTE_VIDEO,{uid:y.uid}),s.emit(y.audio_enable_local?V1.ENABLE_LOCAL_AUDIO:V1.DISABLE_LOCAL_AUDIO,{uid:y.uid}),s.emit(y.video_enable_local?V1.ENABLE_LOCAL_VIDEO:V1.DISABLE_LOCAL_VIDEO,{uid:y.uid}),y.audio||y.video||s.emit(V1.ON_REMOVE_STREAM,{uid:y.uid,uint_id:y.uint_id}),y.audio&&s.emit(V1.ON_ADD_AUDIO_STREAM,{uid:y.uid,uint_id:y.uint_id,audio:!0,ssrcId:y.audio_ssrc}),y.video&&s.emit(V1.ON_ADD_VIDEO_STREAM,{uid:y.uid,uint_id:y.uint_id,video:!0,ssrcId:y.video_ssrc})}),!0)})()}reconnect(s,p){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(s,p)}handleNotification(s){h_.debug("[".concat(this.clientId,"] receive notification: "),s),S0("debug",this,"handleNotification",s);const p=l3(s.code);if("success"!==p.action)return"failed"===p.action?(h_.error("[".concat(this.clientId,"] ignore error: "),p.desc),void sI("error",this,"ignore error: ".concat(p.desc))):"quit"===p.action?("ERR_REPEAT_JOIN_CHANNEL"===p.desc&&this.close(gS.UID_BANNED),void this.close()):void this.reconnect(p.action,_N.SERVER_ERROR)}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const s=v0("PING_PONG_TIME_OUT"),p=Date.now();this.pingpongTimeoutCount>=s&&(h_.warning("PINGPONG Timeout. Last Socket Message: ".concat(p-this.lastMsgTime,"ms")),sI("warning",this,"PINGPONG Timeout. Last Socket Message: ".concat(p-this.lastMsgTime,"ms")),p-this.lastMsgTime>v0("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",_N.TIMEOUT):this.request(h1.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const A=Date.now()-p;this.rttRolling.add(A),v0("REPORT_STATS")&&this.send(h1.PING_BACK,{pingpongElapse:A})}).catch(A=>{})}handleWsInflateData(){const{wsInflateLength:s,wsDeflateLength:p}=this.websocket.getWsInflateData();0!==s&&0!==p&&this.upload(hR.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:p,ws_inflate_length:s})}handleWebsocketEvents(){this.websocket.on(p1.RECONNECT_WAITTING_FINISH,s=>{this.emit(i1.WS_RECONNECT_WAITTING_FINISH,s)}),this.websocket.on(p1.RECONNECT_CREATE_CONNECTION,s=>{this.emit(i1.WS_RECONNECT_CREATE_CONNECTION,s)}),this.websocket.on(p1.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(p1.CLOSED,()=>{this.connectionState=WT.CLOSED}),this.websocket.on(p1.FAILED,()=>{this._disconnectedReason=gS.NETWORK_ERROR,this.connectionState=WT.CLOSED}),this.websocket.on(p1.RECONNECTING,s=>{this._websocketReconnectReason=s,this.joinResponse=void 0,this.connectionState=this.connectionState===WT.CONNECTED?WT.RECONNECTING:WT.CONNECTING}),this.websocket.on(p1.WILL_RECONNECT,(s,p)=>{if(zK(this,i1.IS_P2P_DISCONNECTED)&&"retry"===s)return h_.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),sI("debug",this,"".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(i1.NEED_RENEW_SESSION),this.emit(i1.DISCONNECT_P2P),p("tryNext");"retry"!==s&&(h_.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(s)),sI("debug",this,"".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(s)),this.reconnectToken=void 0,this.emit(i1.NEED_RENEW_SESSION),this.emit(i1.DISCONNECT_P2P)),p(s)}),this.websocket.on(p1.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(s=>{h_.warning("[".concat(this.clientId,"] rejoin failed ").concat(s)),S0("warning",this,"rejoin",void 0,s.toString()),this.reconnect("tryNext",_N.SERVER_ERROR)}):this.join().catch(s=>{if(this.emit(i1.REPORT_JOIN_GATEWAY,s.message||s.code,this.url||""),s instanceof U_&&s.code===N_.UNEXPECTED_RESPONSE&&s.data.code===OI.ERR_NO_AUTHORIZED)return h_.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),sI("warning",this,"reconnect no authorized, recover"),void this.reconnect("recover",_N.SERVER_ERROR);h_.error("[".concat(this.clientId,"] join gateway request failed"),s.toString()),S0("error",this,"join",void 0,s.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",_N.SERVER_ERROR):(this.initError=s,this.close())})}),this.websocket.on(p1.REQUEST_NEW_URLS,(s,p)=>{ZP(this,i1.REQUEST_RECOVER,this.multiIpOption).then(s).catch(p)})}})||ume;var qle;function Wle(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function d9(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?Wle(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):Wle(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}const Kie=new Map;let mye=TR("AgoraRTCGateway","store.clientId")(qle=class extends sS{get state(){return this._state}set state(s){if(s===this._state)return;const p=this._state;this._state=s,"DISCONNECTED"===s&&this._disconnectedReason?this.emit(FT.CONNECTION_STATE_CHANGE,s,p,this._disconnectedReason):this.emit(FT.CONNECTION_STATE_CHANGE,s,p)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(s){h_.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(s)),S0("debug",this,"joinGatewayStartTime",s,"[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(s)),this._joinGatewayStartTime=s}constructor(s,p){super(),a_(this,"store",void 0),a_(this,"joinInfo",void 0),a_(this,"key",void 0),a_(this,"signal",void 0),a_(this,"role",void 0),a_(this,"inChannelInfo",{joinAt:null,duration:0}),a_(this,"spec",void 0),a_(this,"_state","DISCONNECTED"),a_(this,"_statsCollector",void 0),a_(this,"_disconnectedReason",void 0),a_(this,"isSignalRecover",!1),a_(this,"hasChangeBGPAddress",!1),a_(this,"trafficStatsInterval",void 0),a_(this,"networkQualityInterval",void 0),a_(this,"_joinGatewayStartTime",0),a_(this,"_signalTimeout",!1),a_(this,"_clientRoleOptions",void 0),a_(this,"_isProactiveJoin",!1),this.store=s,this.spec=p,this.signal=new gye(d9(d9({},p),{},{retryConfig:p.websocketRetryConfig}),s),this._statsCollector=p.statsCollector,this.role=p.role||"audience",this._clientRoleOptions=p.clientRoleOptions,this.handleSignalEvents()}join(s,p,A){var y=this;return f(function*(){y.store.joinGatewayStart(),"disabled"!==s.cloudProxyServer&&(y.hasChangeBGPAddress=!0);const w=Date.now();let $=Kie.get(s.cname);if($||($=new Map,Kie.set(s.cname,$)),y._isProactiveJoin=!0,$.has(s.uid)){const _i=new U_(N_.UID_CONFLICT);throw w0.joinGateway(s.sid,{lts:w,succ:!1,ec:_i.message,addr:null,uid:s.uid,cid:s.cid,firstSuccess:y._isProactiveJoin,avoidJoinStartTime:y.store.avoidJoinStart,isProxy:!!s.proxyServer}),y._isProactiveJoin=!1,_i}$.set(s.uid,!0),y.joinInfo=s,y.key=p;const j=s.proxyServer,_e=s.gatewayAddrs.map(j?_i=>{const _o=_i.address.split(":");return"wss://".concat(j,"/ws/?h=").concat(_o[0],"&p=").concat(_o[1])}:_i=>"wss://".concat(_i.address));let K=0;y.joinGatewayStartTime=w;try{K=(yield y.signal.init(_e,A)).uid}catch(_i){throw _i&&_i.code===N_.INIT_WEBSOCKET_TIMEOUT?(h_.warning("[".concat(y.store.clientId,"] User join failed"),_i.toString()),_i):(h_.error("[".concat(y.store.clientId,"] User join failed"),_i.toString()),S0("error",y,"join",void 0,_i.toString()),w0.joinGateway(s.sid,{lts:w,succ:!1,ec:_i.message,addr:y.signal.url,uid:s.uid,cid:s.cid,firstSuccess:y._isProactiveJoin,avoidJoinStartTime:y.store.avoidJoinStart,isProxy:!!j}),y._isProactiveJoin=!1,$.delete(s.uid),y.signal.close(),_i)}return y.state="CONNECTED",y.inChannelInfo.joinAt=Date.now(),h_.debug("[".concat(y.store.clientId,"] Connected to gateway server")),S0("debug",y,"join",void 0,"success"),y.trafficStatsInterval=window.setInterval(()=>{y.updateTrafficStats().catch(_i=>{h_.warning("[".concat(y.store.clientId,"] get traffic stats error"),_i.toString()),S0("warning",y,"trafficStatsInterval",void 0,_i.toString())})},3e3),y.networkQualityInterval=window.setInterval(()=>{navigator&&void 0!==navigator.onLine&&!navigator.onLine?y.emit(FT.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):y.emit(FT.NETWORK_QUALITY,y._signalTimeout?{downlinkNetworkQuality:5,uplinkNetworkQuality:5}:"CONNECTED"===y.state&&y._statsCollector.trafficStats?{uplinkNetworkQuality:fie(y._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:fie(y._statsCollector.trafficStats.B_dnq)}:{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),y.store.joinGatewayEnd(),K})()}leave(){var s=arguments,p=this;return f(function*(){let A=s.length>0&&void 0!==s[0]&&s[0],y=s.length>1?s[1]:void 0;if("DISCONNECTED"!==p.state){y!==gS.FALLBACK&&(p.state="DISCONNECTING");try{A||p.signal.connectionState!==WT.CONNECTED||(yield(w=p.signal.request(h1.LEAVE,void 0,!0),3e3,iI.race([w,fX(3e3)])))}catch(w){h_.warning("[".concat(p.store.clientId,"] leave request failed, ignore"),w),sI("warning",p,"leave request failed, ignore, ".concat(w.toString()))}p.signal.close(y),y!==gS.FALLBACK&&(p.state="DISCONNECTED"),p.reset()}var w})()}publish(s,p,A){var y=this;return f(function*(){if("CONNECTED"!==y.state&&"RECONNECTING"!==y.state)throw new U_(N_.INVALID_OPERATION,"can not publish when connection state is ".concat(y.state));const w={state:"offer",p2p_id:y.store.p2pId,ortc:p,mode:y.spec.mode,extend:v0("PUB_EXTEND")};try{return(yield y.signal.request(h1.PUBLISH,w,!0))._message}catch($){if(A&&$.data&&$.data.code===OI.ERR_PUBLISH_REQUEST_INVALID)return h_.warning("[".concat(y.store.clientId,"] receive publish error code, retry"),$.toString()),sI("warning",y,"receive publish error code, retry, ".concat($.toString())),yield y.tryUnpubBeforeRepub(s,p),y.publish(s,p,!1);throw $}})()}unpublish(s,p){var A=this;return f(function*(){try{if("CONNECTED"!==A.state&&"RECONNECTING"!==A.state)throw new U_(N_.INVALID_OPERATION,"can not publish when connection state is ".concat(A.state));yield A.signal.request(h1.UNPUBLISH,{stream_id:p,ortc:s},!0)}catch(y){h_.warning("unpublish warning: ",y),S0("warning",A,"unpublish",void 0,y.toString())}})()}subscribe(s,p,A){var y=this;return f(function*(){if("CONNECTED"!==y.state&&"RECONNECTING"!==y.state)throw new U_(N_.INVALID_OPERATION,"can not subscribe when connection state is ".concat(y.state));const w={stream_id:s,stream_type:p.stream_type,mode:y.spec.mode,codec:y.spec.codec,p2p_id:y.store.p2pId,tcc:!!v0("SUBSCRIBE_TCC"),extend:v0("SUB_EXTEND"),ssrcId:p.ssrcId};try{return(yield y.signal.request(h1.SUBSCRIBE,w,!0))._message}catch($){if(A&&$.data&&$.data.code===OI.ERR_SUBSCRIBE_REQUEST_INVALID)return h_.warning("[".concat(y.store.clientId,"] receiver subscribe error code, retry"),$.toString()),sI("warning",y,"receiver subscribe error code, retry"),yield y.tryUnsubBeforeResub(s,p),yield y.subscribe(s,p,!1);throw $}})()}subscribeAll(s,p){var A=this;return f(function*(){if("CONNECTED"!==A.state&&"RECONNECTING"!==A.state)throw new U_(N_.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(A.state));const y={p2p_id:A.store.p2pId,users:s,dtx:!1};try{return yield A.signal.request(h1.SUBSCRIBE_STREAMS,y,!0)}catch(w){if(p&&w.data&&w.data.code===OI.ERR_SUBSCRIBE_REQUEST_INVALID)return h_.warning("[".concat(A.store.clientId,"] receiver massSubscribe error code, retry"),w.toString()),sI("warning",A,"receiver massSubscribe error code, retry"),yield A.tryMassUnsubBeforeResub(s),yield A.subscribeAll(s,!1);throw w}})()}setVideoProfile(s){var p=this;return f(function*(){const A=function(y){if(!(y.bitrateMax&&y.bitrateMin&&y.frameRate&&y.height&&y.width))return;let w=y.frameRate,$=y.width,j=y.height,_e=!0;return"number"!=typeof w&&(w=w.exact||w.ideal||w.max||w.min||0,w||(_e=!1)),"number"!=typeof $&&($=$.exact||$.ideal||$.max||$.min||0,$||(_e=!1)),"number"!=typeof j&&(j=j.exact||j.ideal||j.max||j.min||0,w||(_e=!1)),_e?{stream_type:0,width:$,height:j,fps:w,start_bps:1e3*y.bitrateMax,min_bps:1e3*y.bitrateMin,target_bps:1e3*y.bitrateMax}:void 0}(s);return A?p.signal.request(h1.SET_VIDEO_PROFILE,A):(h_.debug("[".concat(p.store.clientId,"] encoder config is not complete, do not report to gateway")),void sI("debug",p,"encoder config is not complete, do not report to gateway"))})()}unsubscribe(s,p){var A=this;return f(function*(){try{yield A.signal.request(h1.UNSUBSCRIBE,{p2p_id:A.store.p2pId,ortc:s,stream_id:p},!0)}catch(y){h_.warning("unsubscribe warning: ",y),S0("warning",A,"unsubscribe",void 0,y.toString())}})()}massUnsubscribe(s){var p=this;return f(function*(){try{yield p.signal.request(h1.UNSUBSCRIBE_STREAMS,s,!0)}catch(A){h_.warning("unsubscribeAll warning: ",A),S0("warning",p,"unsubscribeAll",void 0,A.toString())}})()}reconnectPC(s){var p=this;return f(function*(){const{iceParameters:A,dtlsParameters:y,rtpCapabilities:w}=s,$=yield p.signal.request(h1.CONNECT_PC,{p2p_id:p.store.p2pId,stream_id:p.store.uid,ortc:{iceParameters:A,dtlsParameters:y,rtpCapabilities:w}},!0),j=p.getGatewayIpPort();return{gatewayEstablishParams:$,gatewayIP:null==j?void 0:j.ip,gatewayPort:null==j?void 0:j.port}})()}getGatewayInfo(){return this.signal.request(h1.GATEWAY_INFO)}renewToken(s){return this.signal.request(h1.RENEW_TOKEN,s)}setClientRole(s,p){var A=this;return f(function*(){if(p&&(A._clientRoleOptions=Object.assign({},p)),"CONNECTED"!==A.state)return void(A.role=s);let y;y="audience"===s?A._clientRoleOptions&&A._clientRoleOptions.level?A._clientRoleOptions.level:2:0,yield A.signal.request(h1.SET_CLIENT_ROLE,{role:s,level:y}),A.role=s})()}setRemoteVideoStreamType(s,p){var A=this;return f(function*(){yield A.signal.request(h1.SWITCH_VIDEO_STREAM,{stream_id:s,stream_type:p})})()}setDefaultRemoteVideoStreamType(s){var p=this;return f(function*(){yield p.signal.request(h1.DEFAULT_VIDEO_STREAM,{stream_type:s})})()}setStreamFallbackOption(s,p){var A=this;return f(function*(){yield A.signal.request(h1.SET_FALLBACK_OPTION,{stream_id:s,fallback_type:p})})()}pickSVCLayer(s,p){var A=this;return f(function*(){yield A.signal.request(h1.PICK_SVC_LAYER,{stream_id:s,spatial_layer:p.spatialLayer,temporal_layer:p.temporalLayer})})()}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),d9({},this.inChannelInfo)}getGatewayVersion(){var s=this;return f(function*(){return(yield s.signal.request(h1.GATEWAY_INFO)).version})()}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const s=Kie.get(this.joinInfo.cname);s&&s.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const s=function(p){const A=p.match(/(wss\:\/\/)?([^:]+):(\d+)/);return A?{username:aS.username,password:aS.password,turnServerURL:A[2],tcpport:parseInt(A[3])+30,udpport:parseInt(A[3])+30,forceturn:!1}:null}(("disabled"===this.joinInfo.cloudProxyServer?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],s&&"off"!==this.joinInfo.turnServer.mode&&"disabled"===this.joinInfo.cloudProxyServer&&this.joinInfo.turnServer.serversFromGateway.push(d9(d9({},aS),{},{turnServerURL:s.turnServerURL,tcpport:s.tcpport,udpport:s.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}updateTrafficStats(){var s=this;return f(function*(){if("CONNECTED"!==s.state)return;const p=yield s.signal.request(h1.TRAFFIC_STATS,void 0,!0);p.timestamp=Date.now(),p.peer_delay.forEach(A=>{const y=s._statsCollector.trafficStats&&s._statsCollector.trafficStats.peer_delay.find(w=>w.peer_uid===A.peer_uid);y&&y.B_st!==A.B_st&&d2(()=>{s.emit(FT.STREAM_TYPE_CHANGE,A.peer_uid,A.B_st)})}),s._statsCollector.updateTrafficStats(p)})()}getJoinMessage(s){if(!this.joinInfo||!this.key)throw new U_(N_.UNEXPECTED_ERROR,"can not generate join message, no join info");const p=Object.assign({},this.joinInfo.apResponse);let A=v0("REPORT_APP_SCENARIO");if("string"!=typeof A)try{A=JSON.stringify(A)}catch(w){A=void 0}A&&A.length>128&&(A=void 0);const y=d9({p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:GO,browser:navigator.userAgent,process_id:v0("PROCESS_ID"),mode:this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:p,extend:v0("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:"proxy3"===this.joinInfo.cloudProxyServer?"1":"proxy5"===this.joinInfo.cloudProxyServer?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:A,attributes:{userAttributes:{enablePublishedUserList:v0("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:v0("MAX_SUBSCRIPTION")}}},s);return this.joinInfo.stringUid&&(y.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(y.aes_mode=this.joinInfo.aesmode,v0("ENCRYPT_AES")?(y.aes_secret=this.joinInfo.aespassword,y.aes_encrypt=!0):y.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(y.aes_salt=this.joinInfo.aessalt)),p.addresses[this.signal.websocket.currentURLIndex]&&(y.ap_response.ticket=p.addresses[this.signal.websocket.currentURLIndex].ticket,delete p.addresses),void 0!==this.joinInfo.defaultVideoStream&&(y.default_video_stream=this.joinInfo.defaultVideoStream),y}getRejoinMessage(){if(!this.joinInfo)throw new U_(N_.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){var s=this;this.signal.on(i1.WS_RECONNECT_WAITTING_FINISH,p=>{["tryNext","recover"].includes(p)&&this.joinInfo&&w0.adjustSessionStartTime(this.joinInfo.sid)}),this.signal.on(i1.WS_RECONNECT_CREATE_CONNECTION,p=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(i1.WS_RECONNECTING,p=>{this.joinInfo&&w0.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:p||_N.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",w0.sessionInit(this.joinInfo.sid,{lts:(new Date).getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(i1.WS_CLOSED,p=>{let A;switch(p){case gS.LEAVE:A=_N.LEAVE;break;case gS.UID_BANNED:case gS.IP_BANNED:case gS.CHANNEL_BANNED:case gS.SERVER_ERROR:A=_N.SERVER_ERROR;break;case gS.FALLBACK:A=_N.FALLBACK;break;default:A=_N.NETWORK_ERROR}h_.debug("[signal] websocket closed, reason: ".concat(A||"undefined -> "+_N.NETWORK_ERROR)),lT("debug",this,"ws_closed","reason: ".concat(p)),this.joinInfo&&w0.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:p===gS.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:A}),this._disconnectedReason=p,p!==gS.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(i1.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&("audience"===this.role&&this._clientRoleOptions&&this._clientRoleOptions.level&&(h_.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions&&this._clientRoleOptions.level)),sI("debug",this,"patch to send set client role, role: ".concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions&&this._clientRoleOptions.level)),this.setClientRole(this.role,this._clientRoleOptions)),w0.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint)){const p=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!p)return h_.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(p)),void sI("error",this,"set local access point after joined failed: ".concat(p));SR("EVENT_REPORT_DOMAIN",p[1]),SR("EVENT_REPORT_BACKUP_DOMAIN",p[1]),SR("LOG_UPLOAD_SERVER","".concat(p[1],":6444"))}}),this.signal.on(V1.ON_UPLINK_STATS,p=>{this._statsCollector.updateUplinkStats(p)}),this.signal.on(i1.REQUEST_RECOVER,(p,A,y)=>{if(!this.joinInfo)return y(new U_(N_.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));p&&(this.joinInfo.multiIP=p,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,ZP(this,FT.REQUEST_NEW_GATEWAY_LIST).then(A).catch(y)}),this.signal.on(i1.REQUEST_JOIN_INFO,function(){var p=f(function*(A){var y;s.updateTurnConfigFromSignal();const{iceParameters:w,dtlsParameters:$,rtpCapabilities:j}=yield ZP(s,FT.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:null===(y=s.joinInfo)||void 0===y?void 0:y.turnServer});A(s.getJoinMessage({ortc:{iceParameters:w,dtlsParameters:$,rtpCapabilities:j,version:"2"}}))});return function(A){return p.apply(this,arguments)}}()),this.signal.on(i1.REQUEST_REJOIN_INFO,p=>{p(this.getRejoinMessage())}),this.signal.on(i1.REPORT_JOIN_GATEWAY,(p,A)=>{this.joinInfo&&(w0.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:p,addr:A,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer}),this._isProactiveJoin=!1)}),this.signal.on(i1.IS_P2P_DISCONNECTED,p=>{p(zK(this,FT.IS_P2P_DISCONNECTED))}),this.signal.on(i1.DISCONNECT_P2P,()=>{this.emit(FT.DISCONNECT_P2P)}),this.signal.on(i1.NEED_RENEW_SESSION,()=>{this.emit(FT.NEED_RENEW_SESSION)}),this.signal.on(i1.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(i1.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(i1.JOIN_RESPONSE,p=>{const A=this.getGatewayIpPort();A?this.emit(FT.JOIN_RESPONSE,p,A.ip,A.port):this.emit(FT.JOIN_RESPONSE,p)})}tryUnsubBeforeResub(s,p){var A=this;return f(function*(){try{yield A.signal.request(h1.UNSUBSCRIBE,{p2p_id:A.store.p2pId,stream_id:s,ortc:[p]},!0)}catch(y){throw h_.warning("unsubscribe warning",y),S0("warning",A,"tryUnsubBeforeResub",s,y.toString()),y}})()}tryUnpubBeforeRepub(s,p){var A=this;return f(function*(){try{yield A.signal.request(h1.UNPUBLISH,{stream_id:s,ortc:p},!0)}catch(y){throw h_.warning("unpublish warning: ",y),S0("warning",A,"tryUnpubBeforeRepub",s,y.toString()),y}})()}tryMassUnsubBeforeResub(s){var p=this;return f(function*(){const A={users:s.map(y=>({stream_id:y.stream_id,stream_type:y.stream_type}))};try{yield p.signal.request(h1.UNSUBSCRIBE_STREAMS,A,!0)}catch(y){throw h_.warning("massUnsubscribe warning",y),S0("warning",p,"tryUnsubAllBeforeResub",s.map(w=>w.stream_id),y.toString()),y}})()}muteLocal(s,p){var A=this;return f(function*(){const y={action:s.find(w=>w.stream_type===KT.Audio)?"mute_local_audio":"mute_local_video",p2p_id:A.store.p2pId,ortc:s,stream_id:p};try{yield A.signal.request(h1.CONTROL,y,!0,!0)}catch(w){throw h_.warning("gateway unmuteLocal warning: ",w),S0("warning",A,"muteLocal",p,w.toString()),w}})()}unmuteLocal(s,p){var A=this;return f(function*(){const y={action:s.find(w=>w.stream_type===KT.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:A.store.p2pId,ortc:s,stream_id:p};try{yield A.signal.request(h1.CONTROL,y,!0,!0)}catch(w){throw h_.warning("gateway muteLocal warning: ",w),S0("warning",A,"unmuteLocal",p,w.toString()),w}})()}uploadStats(s,p){this.signal.upload(s,p)}getSignalRTT(){return this.signal.rtt}restartICE(s){var p=this;return f(function*(){const A={p2p_id:p.store.p2pId,stream_id:p.store.uid,ortc:s};try{const y=yield p.signal.request(h1.RESTART_ICE,A,!0),w=p.getGatewayIpPort();return{restartICEResponse:y,gatewayIP:null==w?void 0:w.ip,gatewayPort:null==w?void 0:w.port}}catch(y){throw h_.warning("P2PChannel.restartICE warning: ",y),S0("warning",p,"restartICE",void 0,y.toString()),y}})()}reconnect(){"CONNECTED"===this.state&&this.signal.reconnect(void 0,_N.P2P_FAILED)}getGatewayIpPort(){var s;if(!v0("GATEWAY_WSS_ADDRESS")&&null!==(s=this.joinInfo)&&void 0!==s&&s.gatewayAddrs){const p=this.joinInfo.gatewayAddrs[this.signal.currentURLIndex];return(p.ip||p.ip6)&&p.port?p.ip6?{ip:p.ip6,port:p.port}:{ip:p.ip,port:p.port}:void 0}}})||qle;function zie(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function OX(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?zie(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):zie(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}!function(){var s;function p(q_){var X_=0;return function(){return X_<q_.length?{done:!1,value:q_[X_++]}:{done:!0}}}var y,A="function"==typeof Object.defineProperties?Object.defineProperty:function(q_,X_,u0){return q_==Array.prototype||q_==Object.prototype||(q_[X_]=u0.value),q_},w=function(q_){q_=["object"==typeof globalThis&&globalThis,q_,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof k&&k];for(var X_=0;X_<q_.length;++X_){var u0=q_[X_];if(u0&&u0.Math==Math)return u0}throw Error("Cannot find global object")}(this);function $(q_,X_){if(X_)e:{var u0=w;q_=q_.split(".");for(var B0=0;B0<q_.length-1;B0++){var $0=q_[B0];if(!($0 in u0))break e;u0=u0[$0]}(X_=X_(B0=u0[q_=q_[q_.length-1]]))!=B0&&null!=X_&&A(u0,q_,{configurable:!0,writable:!0,value:X_})}}function j(q_){return(q_={next:q_})[Symbol.iterator]=function(){return this},q_}function _e(q_){var X_="undefined"!=typeof Symbol&&Symbol.iterator&&q_[Symbol.iterator];return X_?X_.call(q_):{next:p(q_)}}if($("Symbol",function(q_){function X_($0,A0){this.A=$0,A(this,"description",{configurable:!0,writable:!0,value:A0})}if(q_)return q_;X_.prototype.toString=function(){return this.A};var u0="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",B0=0;return function $0(A0){if(this instanceof $0)throw new TypeError("Symbol is not a constructor");return new X_(u0+(A0||"")+"_"+B0++,A0)}}),$("Symbol.iterator",function(q_){if(q_)return q_;q_=Symbol("Symbol.iterator");for(var X_="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),u0=0;u0<X_.length;u0++){var B0=w[X_[u0]];"function"==typeof B0&&"function"!=typeof B0.prototype[q_]&&A(B0.prototype,q_,{configurable:!0,writable:!0,value:function(){return j(p(this))}})}return q_}),"function"==typeof Object.setPrototypeOf)y=Object.setPrototypeOf;else{var K;e:{var _i={};try{_i.__proto__={a:!0},K=_i.a;break e}catch(q_){}K=!1}y=K?function(q_,X_){if(q_.__proto__=X_,q_.__proto__!==X_)throw new TypeError(q_+" is not extensible");return q_}:null}var _o=y;function _u(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function ch(q_){if(q_.m)throw new TypeError("Generator is already running");q_.m=!0}function _f(q_,X_){return q_.h=3,{value:X_}}function o_(q_){this.g=new _u,this.G=q_}function i_(q_,X_,u0,B0){try{var $0=X_.call(q_.g.j,u0);if(!($0 instanceof Object))throw new TypeError("Iterator result "+$0+" is not an object");if(!$0.done)return q_.g.m=!1,$0;var A0=$0.value}catch(e_){return q_.g.j=null,q_.g.s(e_),u_(q_)}return q_.g.j=null,B0.call(q_.g,A0),u_(q_)}function u_(q_){for(;q_.g.h;)try{var X_=q_.G(q_.g);if(X_)return q_.g.m=!1,{value:X_.value,done:!1}}catch(u0){q_.g.v=void 0,q_.g.s(u0)}if(q_.g.m=!1,q_.g.l){if(X_=q_.g.l,q_.g.l=null,X_.F)throw X_.D;return{value:X_.return,done:!0}}return{value:void 0,done:!0}}function g_(q_){this.next=function(X_){return q_.o(X_)},this.throw=function(X_){return q_.s(X_)},this.return=function(X_){return function(u0,B0){ch(u0.g);var $0=u0.g.j;return $0?i_(u0,"return"in $0?$0.return:function(A0){return{value:A0,done:!0}},B0,u0.g.return):(u0.g.return(B0),u_(u0))}(q_,X_)},this[Symbol.iterator]=function(){return this}}function __(q_,X_){return X_=new g_(new o_(X_)),_o&&q_.prototype&&_o(X_,q_.prototype),X_}if(_u.prototype.o=function(q_){this.v=q_},_u.prototype.s=function(q_){this.l={D:q_,F:!0},this.h=this.C||this.u},_u.prototype.return=function(q_){this.l={return:q_},this.h=this.u},o_.prototype.o=function(q_){return ch(this.g),this.g.j?i_(this,this.g.j.next,q_,this.g.o):(this.g.o(q_),u_(this))},o_.prototype.s=function(q_){return ch(this.g),this.g.j?i_(this,this.g.j.throw,q_,this.g.o):(this.g.s(q_),u_(this))},$("Array.prototype.entries",function(q_){return q_||function(){return function(X_,u0){X_ instanceof String&&(X_+="");var B0=0,$0=!1,A0={next:function(){if(!$0&&B0<X_.length){var e_=B0++;return{value:u0(e_,X_[e_]),done:!1}}return $0=!0,{done:!0,value:void 0}}};return A0[Symbol.iterator]=function(){return A0},A0}(this,function(X_,u0){return[X_,u0]})}}),"undefined"!=typeof Blob&&("undefined"==typeof FormData||!FormData.prototype.keys)){var w_=function(q_,X_){for(var u0=0;u0<q_.length;u0++)X_(q_[u0])},k_=function(q_){return q_.replace(/\r?\n|\r/g,"\r\n")},Rv=function(q_,X_,u0){return X_ instanceof Blob?(u0=void 0!==u0?String(u0+""):"string"==typeof X_.name?X_.name:"blob",X_.name===u0&&"[object Blob]"!==Object.prototype.toString.call(X_)||(X_=new File([X_],u0)),[String(q_),X_]):[String(q_),String(X_)]},f0=function(q_,X_){if(q_.length<X_)throw new TypeError(X_+" argument required, but only "+q_.length+" present.")},y0="object"==typeof globalThis?globalThis:"object"==typeof window?window:"object"==typeof self?self:this,b0=y0.FormData,rI=y0.XMLHttpRequest&&y0.XMLHttpRequest.prototype.send,q0=y0.Request&&y0.fetch,Z0=y0.navigator&&y0.navigator.sendBeacon,a0=y0.Element&&y0.Element.prototype,j_=y0.Symbol&&Symbol.toStringTag;j_&&(Blob.prototype[j_]||(Blob.prototype[j_]="Blob"),"File"in y0&&!File.prototype[j_]&&(File.prototype[j_]="File"));try{new File([],"")}catch(q_){y0.File=function(X_,u0,B0){return X_=new Blob(X_,B0||{}),Object.defineProperties(X_,{name:{value:u0},lastModified:{value:+(B0&&void 0!==B0.lastModified?new Date(B0.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),j_&&Object.defineProperty(X_,j_,{value:"File"}),X_}}var Z_=function(q_){return q_.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},o0=function(q_){this.i=[];var X_=this;q_&&w_(q_.elements,function(u0){if(u0.name&&!u0.disabled&&"submit"!==u0.type&&"button"!==u0.type&&!u0.matches("form fieldset[disabled] *"))if("file"===u0.type){var B0=u0.files&&u0.files.length?u0.files:[new File([],"",{type:"application/octet-stream"})];w_(B0,function($0){X_.append(u0.name,$0)})}else"select-multiple"===u0.type||"select-one"===u0.type?w_(u0.options,function($0){!$0.disabled&&$0.selected&&X_.append(u0.name,$0.value)}):"checkbox"===u0.type||"radio"===u0.type?u0.checked&&X_.append(u0.name,u0.value):(B0="textarea"===u0.type?k_(u0.value):u0.value,X_.append(u0.name,B0))})};if((s=o0.prototype).append=function(q_,X_,u0){f0(arguments,2),this.i.push(Rv(q_,X_,u0))},s.delete=function(q_){f0(arguments,1);var X_=[];q_=String(q_),w_(this.i,function(u0){u0[0]!==q_&&X_.push(u0)}),this.i=X_},s.entries=function q_(){var X_,u0=this;return __(q_,function(B0){if(1==B0.h&&(X_=0),3!=B0.h)return X_<u0.i.length?B0=_f(B0,u0.i[X_]):(B0.h=0,B0=void 0),B0;X_++,B0.h=2})},s.forEach=function(q_,X_){f0(arguments,1);for(var u0=_e(this),B0=u0.next();!B0.done;B0=u0.next()){var $0=_e(B0.value);B0=$0.next().value,$0=$0.next().value,q_.call(X_,$0,B0,this)}},s.get=function(q_){f0(arguments,1);var X_=this.i;q_=String(q_);for(var u0=0;u0<X_.length;u0++)if(X_[u0][0]===q_)return X_[u0][1];return null},s.getAll=function(q_){f0(arguments,1);var X_=[];return q_=String(q_),w_(this.i,function(u0){u0[0]===q_&&X_.push(u0[1])}),X_},s.has=function(q_){f0(arguments,1),q_=String(q_);for(var X_=0;X_<this.i.length;X_++)if(this.i[X_][0]===q_)return!0;return!1},s.keys=function q_(){var X_,u0,A0=this;return __(q_,function(e_){if(1==e_.h&&(X_=_e(A0),u0=X_.next()),3!=e_.h)return u0.done?void(e_.h=0):_f(e_,_e(u0.value).next().value);u0=X_.next(),e_.h=2})},s.set=function(q_,X_,u0){f0(arguments,2),q_=String(q_);var B0=[],$0=Rv(q_,X_,u0),A0=!0;w_(this.i,function(e_){e_[0]===q_?A0&&(A0=!B0.push($0)):B0.push(e_)}),A0&&B0.push($0),this.i=B0},s.values=function q_(){var X_,u0,$0,A0=this;return __(q_,function(e_){if(1==e_.h&&(X_=_e(A0),u0=X_.next()),3!=e_.h)return u0.done?void(e_.h=0):(($0=_e(u0.value)).next(),_f(e_,$0.next().value));u0=X_.next(),e_.h=2})},o0.prototype._asNative=function(){for(var q_=new b0,X_=_e(this),u0=X_.next();!u0.done;u0=X_.next()){var B0=_e(u0.value);u0=B0.next().value,B0=B0.next().value,q_.append(u0,B0)}return q_},o0.prototype._blob=function(){var q_="----formdata-polyfill-"+Math.random(),X_=[],u0="--"+q_+'\r\nContent-Disposition: form-data; name="';return this.forEach(function(B0,$0){return"string"==typeof B0?X_.push(u0+Z_(k_($0))+'"\r\n\r\n'+k_(B0)+"\r\n"):X_.push(u0+Z_(k_($0))+'"; filename="'+Z_(B0.name)+'"\r\nContent-Type: '+(B0.type||"application/octet-stream")+"\r\n\r\n",B0,"\r\n")}),X_.push("--"+q_+"--"),new Blob(X_,{type:"multipart/form-data; boundary="+q_})},o0.prototype[Symbol.iterator]=function(){return this.entries()},o0.prototype.toString=function(){return"[object FormData]"},a0&&!a0.matches&&(a0.matches=a0.matchesSelector||a0.mozMatchesSelector||a0.msMatchesSelector||a0.oMatchesSelector||a0.webkitMatchesSelector||function(q_){for(var X_=(q_=(this.document||this.ownerDocument).querySelectorAll(q_)).length;0<=--X_&&q_.item(X_)!==this;);return-1<X_}),j_&&(o0.prototype[j_]="FormData"),rI){var z0=y0.XMLHttpRequest.prototype.setRequestHeader;y0.XMLHttpRequest.prototype.setRequestHeader=function(q_,X_){z0.call(this,q_,X_),"content-type"===q_.toLowerCase()&&(this.B=!0)},y0.XMLHttpRequest.prototype.send=function(q_){q_ instanceof o0?(q_=q_._blob(),this.B||this.setRequestHeader("Content-Type",q_.type),rI.call(this,q_)):rI.call(this,q_)}}q0&&(y0.fetch=function(q_,X_){return X_&&X_.body&&X_.body instanceof o0&&(X_.body=X_.body._blob()),q0.call(this,q_,X_)}),Z0&&(y0.navigator.sendBeacon=function(q_,X_){return X_ instanceof o0&&(X_=X_._asNative()),Z0.call(this,q_,X_)}),y0.FormData=o0}}();let Kle=1;function lme(s,p,A,y,w){Kle+=1;const $={sid:A.sid,command:"convergeAllocateEdge",uid:"666",appId:A.appId,ts:Math.floor(Date.now()/1e3),seq:Kle,requestId:Kle,version:GO,cname:A.cname},j={service_name:p,json_body:JSON.stringify($)};let _e,K,_i=s[0];return LL(f(function*(){_e=Date.now();const _o=yield KO(_i,{data:j,cancelToken:y,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(K=Date.now()-_e,0!==_o.code){const _f=new U_(N_.UNEXPECTED_RESPONSE,"live streaming ap error, code"+_o.code,{retry:!0,responseTime:K});throw h_.error(_f.toString()),S0("error",["AjaxAPI"],"requestLiveStreamingWorkerManager",void 0,_f.toString()),_f}const _u=JSON.parse(_o.json_body);if(200!==_u.code){const _f=new U_(N_.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(_u.code,", reason: ").concat(_u.reason),{code:_u.code,responseTime:K});throw h_.error(_f.toString()),S0("error",["AjaxAPI"],"requestLiveStreamingWorkerManager",void 0,_f.toString()),_f}if(!_u.servers||0===_u.servers.length){const _f=new U_(N_.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:_u.code,responseTime:K});throw h_.error(_f.toString()),S0("error",["AjaxAPI"],"requestLiveStreamingWorkerManager",void 0,_f.toString()),_f}const ch=(o_=p,{addressList:(_f=_u).servers.map(i_=>"wss://".concat(i_.address.replace(/\./g,"-"),".").concat(v0("WORKER_DOMAIN"),":").concat(i_.wss,"?serviceName=").concat(encodeURIComponent(o_))),workerToken:_f.workerToken,vid:_f.vid});var _f,o_;return v0("LIVE_STREAMING_ADDRESS")&&(ch.addressList=v0("LIVE_STREAMING_ADDRESS")instanceof Array?v0("LIVE_STREAMING_ADDRESS"):[v0("LIVE_STREAMING_ADDRESS")]),OX(OX({},ch),{},{responseTime:K})}),(_o,_u)=>(w0.apworkerEvent(A.sid,{success:!0,sc:200,serviceName:p,responseDetail:JSON.stringify(_o.addressList),firstSuccess:0===_u,responseTime:K,serverIp:s[_u%s.length]}),!1),(_o,_u)=>(w0.apworkerEvent(A.sid,{success:!1,sc:_o.data&&_o.data.code||200,serviceName:p,responseTime:K,serverIp:s[_u%s.length]}),!!(_o.code!==N_.OPERATION_ABORTED&&_o.code!==N_.UNEXPECTED_RESPONSE||_o.data&&_o.data.retry)&&(_i=s[(_u+1)%s.length],!0)),w)}let $4=1;function dme(s,p,A,y){let{url:w,areaCode:$}=s;S0("debug",["AjaxAPI",p.clientId],"requestChooseServer",{url:w,areaCode:$});const j=Date.now(),[_e,K]=pme(p,$,[AS.CHOOSE_SERVER]);let _i=_S.networkState;return LL(f(function*(){_i&&_S.networkState===eP.OFFLINE&&_S.onlineWaiter&&(yield iI.race([_S.onlineWaiter,pR(y&&y.maxRetryTimeout||pS.maxRetryTimeout)])),_i=_S.networkState;const _o=yield KO(w,{data:_e,cancelToken:A,headers:{"Content-Type":"multipart/form-data;"}},!0);w0.reportResourceTiming(w,p.sid),hme(_o,w,p,j,[AS.CHOOSE_SERVER]);const _u=hX(_o,AS.CHOOSE_SERVER);return fme(_u),lX(_u,w)}),_o=>(_o&&w0.joinChooseServer(p.sid,{lts:j,succ:!0,csAddr:w,opid:K,serverList:_o.gatewayAddrs.map(_u=>_u.address),ec:null,cid:_o.cid.toString(),uid:_o.uid.toString(),csIp:_o.csIp,unilbsServerIds:[AS.CHOOSE_SERVER].toString()}),!1),_o=>_o.code!==N_.OPERATION_ABORTED&&(_o.code===N_.CAN_NOT_GET_GATEWAY_SERVER?_o.data.retry:(w0.joinChooseServer(p.sid,{lts:j,succ:!1,csAddr:w,serverList:null,opid:K,ec:_o.code,csIp:_o.data&&_o.data.csIp,unilbsServerIds:[AS.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:_i})}),h_.warning("[".concat(p.clientId,"] Choose server network error, retry"),_o),sI("warning",["AjaxAPI",p.clientId],"Choose server network error, retry, ".concat(_o)),!0)),y)}function _G(s,p,A,y){let{url:w,areaCode:$,serviceIds:j}=s;S0("debug",["AjaxAPI",p.clientId],"requestMultiUnilbs",{url:w,areaCode:$,serviceIds:j});const _e=Date.now(),[K,_i]=pme(p,$,j);let _o;return LL(f(function*(){_o&&_S.networkState===eP.OFFLINE&&_S.onlineWaiter&&(yield iI.race([_S.onlineWaiter,pR(y&&y.maxRetryTimeout||pS.maxRetryTimeout)])),_o=_S.networkState;const _u=yield KO(w,{data:K,cancelToken:A,headers:{"Content-Type":"multipart/form-data;"}},!0);w0.reportResourceTiming(w,p.sid),hme(_u,w,p,_e,j);const ch=hX(_u,AS.CHOOSE_SERVER),_f=hX(_u,"proxy5"===p.cloudProxyServer?AS.CLOUD_PROXY_5:"proxy3"===p.cloudProxyServer||"proxy4"===p.cloudProxyServer?AS.CLOUD_PROXY:AS.CLOUD_PROXY_FALLBACK);return fme(ch),{gatewayInfo:lX(ch,w),proxyInfo:_f,url:w}}),_u=>(_u.gatewayInfo&&w0.joinChooseServer(p.sid,{lts:_e,succ:!0,csAddr:w,serverList:_u.gatewayInfo.gatewayAddrs.map(ch=>ch.address),ec:null,opid:_i,cid:_u.gatewayInfo.cid.toString(),uid:_u.gatewayInfo.uid.toString(),csIp:_u.gatewayInfo.csIp,unilbsServerIds:j.toString()}),_u.proxyInfo&&w0.joinWebProxyAP(p.sid,{lts:_e,sucess:1,apServerAddr:w,turnServerAddrList:_u.proxyInfo.addresses.map(ch=>ch.ip).join(","),errorCode:null,eventType:p.cloudProxyServer,unilbsServerIds:j.toString()}),!1),_u=>_u.code!==N_.OPERATION_ABORTED&&(_u.code===N_.CAN_NOT_GET_GATEWAY_SERVER?_u.data.retry:(w0.joinWebProxyAP(p.sid,{lts:_e,sucess:0,apServerAddr:w,turnServerAddrList:null,errorCode:_u.code,eventType:p.cloudProxyServer,unilbsServerIds:j.toString(),extend:JSON.stringify({networkState:_o})}),h_.warning("[".concat(p.clientId,"] multi unilbs network error, retry"),_u),sI("warning",["AjaxAPI",p.clientId],"multi unilbs network error, retry, ".concat(_u)),!0)),y)}const hme=(s,p,A,y,w)=>{const $=[],j=_e=>{4096===_e.flag?w0.joinChooseServer(A.sid,{lts:y,succ:!1,csAddr:p,opid:s.opid,serverList:null,ec:_e.error.message,csIp:_e.error.data&&_e.error.data.csIp,unilbsServerIds:w.toString()}):1048576!==_e.flag&&4194304!==_e.flag&&4194310!==_e.flag||w0.joinWebProxyAP(A.sid,{lts:y,sucess:0,apServerAddr:p,turnServerAddrList:null,errorCode:_e.error.code,eventType:A.cloudProxyServer,unilbsServerIds:w.toString()})};if(s.response_body.forEach(_e=>{const K=_e.buffer.code;if(23===_e.uri&&0===K&&!_e.buffer.edges_services)if(4194310===_e.buffer.flag)h_.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),_e.buffer.edges_services=[];else{const _i={error:new U_(N_.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:s.detail[502]}),flag:_e.buffer.flag};$.push(_i),j(_i)}if(0!==K){const _i=mG(K),_o={error:new U_(N_.CAN_NOT_GET_GATEWAY_SERVER,_i.desc,{retry:_i.retry,csIp:s.detail[502]}),flag:_e.buffer.flag};4194310===_e.buffer.flag?h_.warning(_o.error.toString()):$.push(_o),j(_o)}}),$.length)throw h_.warning("[".concat(A.clientId,"] multi unilbs ").concat(p," failed, ").concat($.map(_e=>"flag: ".concat(_e.flag,", message: ").concat(_e.error.message,", retry: ").concat(_e.error.data.retry)).join(" | "))),S0("warning",["AjaxAPI",A.clientId],"checkMultiUnilbsResponseValid",{url:p},$.map(_e=>({flag:_e.flag,message:_e.error.message,retry:_e.error.data.retry}))),new U_(N_.CAN_NOT_GET_GATEWAY_SERVER,$.map(_e=>"flag: ".concat(_e.flag,", message: ").concat(_e.error.message)).join(" | "),{retry:!!$.find(_e=>_e.error.data.retry),csIp:s.detail[502]})},fme=s=>{if(s.addresses&&0===s.addresses.length&&0===s.code)throw new U_(N_.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:s.detail&&s.detail[502]});if(v0("GATEWAY_ADDRESS")&&v0("GATEWAY_ADDRESS").length>0){h_.debug("assign gateway address to",v0("GATEWAY_ADDRESS")),sI("debug",["AjaxAPI"],"assign gateway address to ".concat(JSON.stringify(v0("GATEWAY_ADDRESS"))));const p=v0("GATEWAY_ADDRESS").map(A=>({ip:A.ip,port:A.port,ticket:s.addresses[0]&&s.addresses[0].ticket}));s.addresses=p}},Aye=(s,p)=>{if(s.response_body&&s.response_body.length){const A=s.response_body[0];if(0!==A.buffer.code){const y=mG(A.buffer.code);throw new U_(N_.UPDATE_TICKET_FAILED,"[".concat(A.buffer.code,"]: ").concat(y.desc),{retry:y.retry})}return A.buffer.ticket}throw h_.debug("update ticket request received ap response without response body:",p),sI("debug",["AjaxAPI"],"update ticket request received ap response without response body: ".concat(p)),new U_(N_.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},pme=(s,p,A)=>{const y=Math.floor(1e12*Math.random()),w={appid:s.appId,client_ts:Date.now(),opid:y,sid:s.sid,request_bodies:[{uri:22,buffer:{cname:s.cname,detail:{6:s.stringUid,11:p,12:v0("USE_NEW_TOKEN")?"1":void 0},key:s.token,service_ids:A,uid:s.uid||0}}]};w.request_bodies.forEach(j=>{s.multiIP&&s.multiIP.gateway_ip&&(j.buffer.detail[5]=JSON.stringify({vocs_ip:[s.multiIP.uni_lbs_ip],vos_ip:[s.multiIP.gateway_ip]}))});const $=new FormData;return $.append("request",JSON.stringify(w)),[$,y]},_ye=(s,p)=>{const A=Math.floor(1e12*Math.random()),y={appid:s.appId,client_ts:Date.now(),opid:A,sid:s.sid,request_bodies:[{uri:28,buffer:{cname:s.cname,detail:{1:"",6:s.stringUid,12:"1"},token:s.token,service_ids:p,uid:s.uid||0,edges_services:s.apResponse.addresses.map($=>({ip:$.ip,port:$.port}))}}]},w=new FormData;return w.append("request",JSON.stringify(y)),[w,A]},oY=()=>{const s=v0("AREAS");return 0===s.length&&s.push(u1.GLOBAL),qP(s).call(s,(p,A,y)=>{const w=gme(A);return w?0===y?w:"".concat(p,",").concat(w):p},"")},gme=s=>s===u1.OVERSEA?"".concat(AT.ASIA,",").concat(AT.EUROPE,",").concat(AT.AFRICA,",").concat(AT.NORTH_AMERICA,",").concat(AT.SOUTH_AMERICA,",").concat(AT.OCEANIA):AT[s],Yie={GLOBAL:{ASIA:[u1.CHINA,u1.JAPAN,u1.INDIA,u1.KOREA,u1.HKMC],EUROPE:[],NORTH_AMERICA:[u1.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},zle=Object.keys(Yie[u1.GLOBAL]),Yle=[u1.CHINA,u1.NORTH_AMERICA,u1.EUROPE,u1.ASIA,u1.JAPAN,u1.INDIA,u1.OCEANIA,u1.SOUTH_AMERICA,u1.AFRICA,u1.KOREA,u1.HKMC,u1.US];function d3(s,p,A,y){return DX.apply(this,arguments)}function DX(){return DX=f(function*(s,p,A,y){return{gatewayInfo:yield($=f(function*(j,_e,K,_i){let _o=null;const _u=[],ch=function(){var o_=f(function*(){const i_=v0("WEBCS_DOMAIN").slice(0,v0("AJAX_REQUEST_CONCURRENT")).map(__=>({url:j.proxyServer?"https://".concat(j.proxyServer,"/ap/?url=").concat(__+"/api/v2/transpond/webrtc?v=2"):"https://".concat(__,"/api/v2/transpond/webrtc?v=2"),areaCode:oY()})),u_=_i.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:i_.map(__=>__.url)}),g_=yield t9({fragementLength:v0("FRAGEMENT_LENGTH"),referenceList:i_,asyncMapHandler:__=>(h_.debug("[".concat(j.clientId,"] Connect to choose_server:"),__.url),dme(__,j,_e,K)),allFailedhandler:__=>{throw _i.recordJoinChannelService({endTs:Date.now(),status:"error",errors:__},u_),__[0]},promisesCollector:_u});return _i.recordJoinChannelService({endTs:Date.now(),status:"success"},u_),g_});return function(){return o_.apply(this,arguments)}}(),_f=function(){var o_=f(function*(){if(yield pR(1e3),null!==_o)return _o;const i_=v0("WEBCS_DOMAIN_BACKUP_LIST").map(__=>({url:j.proxyServer?"https://".concat(j.proxyServer,"/ap/?url=").concat(__+"/api/v2/transpond/webrtc?v=2"):"https://".concat(__,"/api/v2/transpond/webrtc?v=2"),areaCode:oY()})),u_=_i.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:i_.map(__=>__.url)}),g_=yield t9({fragementLength:v0("FRAGEMENT_LENGTH"),referenceList:i_,asyncMapHandler:__=>(h_.debug("[".concat(j.clientId,"] Connect to backup choose_server:"),__.url),dme(__,j,_e,K)),allFailedhandler:__=>{throw _i.recordJoinChannelService({endTs:Date.now(),status:"error",errors:__},u_),__[0]},promisesCollector:_u});return _i.recordJoinChannelService({endTs:Date.now(),status:"success"},u_),g_});return function(){return o_.apply(this,arguments)}}();try{return _o=yield e9([ch(),_f()]),_u.length&&_u.forEach(o_=>o_.cancel&&"function"==typeof o_.cancel&&o_.cancel()),_o}catch(o_){throw o_[0]}}),function(j,_e,K,_i){return $.apply(this,arguments)})(s,p,A,y)};var $}),DX.apply(this,arguments)}function Jle(s,p,A,y,w){return $le.apply(this,arguments)}function $le(){return $le=f(function*(s,p,A,y,w){const $=s.cloudProxyServer;if("disabled"===$){if(!y)return;if(s.useLocalAccessPoint)return yield d3(s,p,A,w);if(v0("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:_e,proxyInfo:K}=yield Eye(s,p,A,w);return s.turnServer&&"auto"!==s.turnServer.mode?(sI("debug",["Server",s.clientId],"do not set fallback turn because of already having turnserver"),{gatewayInfo:_e}):(s.turnServer={mode:"manual",servers:K.map(_i=>({turnServerURL:_i.address,tcpport:_i.tcpport||aS.tcpport,udpport:_i.udpport||aS.udpport,username:_i.username||aS.username,password:_i.password||aS.password,forceturn:v0("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE"),security:!0}))},{gatewayInfo:_e})}return yield d3(s,p,A,w)}let j;if(["443only","normal"].includes($)){let _e;y?"normal"!==$?[_e,j]=yield iI.all([Jie(s,p,A),d3(s,p,A,w)]):(_e=yield Jie(s,p,A),s.proxyServer=_e.addresses[0],w0.setProxyServer(s.proxyServer),h_.setProxyServer(s.proxyServer),wQ(s.proxyServer),j=yield d3(s,p,A,w)):(j=void 0,"normal"!==$?_e=yield Jie(s,p,A):(_e=yield Jie(s,p,A),s.proxyServer=_e.addresses[0],w0.setProxyServer(s.proxyServer),h_.setProxyServer(s.proxyServer),wQ(s.proxyServer))),s.turnServer={mode:"manual",servers:_e.addresses.map(K=>({turnServerURL:K,tcpport:_e.serverResponse.tcpport?_e.serverResponse.tcpport:aS.tcpport,udpport:_e.serverResponse.udpport?_e.serverResponse.udpport:aS.udpport,username:_e.serverResponse.username||aS.username,password:_e.serverResponse.password||aS.password,forceturn:!0,security:!1}))}}else{const{proxyInfo:_e,gatewayInfo:K}=yield Eye(s,p,A,w);j={gatewayInfo:K},s.turnServer={mode:"manual",servers:_e.map(_i=>({turnServerURL:_i.address,tcpport:"proxy3"===$?void 0:_i.tcpport?_i.tcpport:aS.tcpport,udpport:"proxy4"===$?void 0:_i.udpport?_i.udpport:aS.udpport,username:_i.username||aS.username,password:_i.password||aS.password,forceturn:"proxy4"!==$,security:"proxy5"===$}))}}return h_.debug("[".concat(s.clientId,"] set proxy server: ").concat(s.proxyServer,", mode: ").concat($)),S0("debug",["Server",s.clientId],"setCloudProxyServerAndGetServerInfo",{proxyServer:s.proxyServer,mode:s.cloudProxyServer}),j}),$le.apply(this,arguments)}function Zle(s,p,A,y,w){return Xle.apply(this,arguments)}function Xle(){return Xle=f(function*(s,p,A,y,w){let j=[];j=v0("ACCOUNT_REGISTER").slice(0,v0("AJAX_REQUEST_CONCURRENT")).map(p.proxyServer?K=>"https://".concat(p.proxyServer,"/ap/?url=").concat(K+"/api/v1"):K=>"https://".concat(K,"/api/v1"));const _e=null==w?void 0:w.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:j});try{const K=yield(_i=f(function*(_o,_u,ch,_f,o_){const i_=Date.now(),u_={sid:ch.sid,opid:10,appid:ch.appId,string_uid:_u};let g_=_o[0];const __=yield LL(()=>KO(g_+"".concat(-1===g_.indexOf("?")?"?":"&","action=stringuid"),{data:u_,cancelToken:_f,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(w_,k_)=>{if(0===w_.code){if(w_.uid<=0||w_.uid>=Math.pow(2,32))throw h_.error("Invalid Uint Uid ".concat(_u," => ").concat(w_.uid),w_),S0("error",["AjaxAPI"],"requestUserAccount","Invalid Uint Uid ".concat(_u," => ").concat(w_.uid,", ").concat(w_)),w0.reqUserAccount(u_.sid,{lts:i_,success:!1,serverAddr:g_,stringUid:u_.string_uid,uid:w_.uid,errorCode:N_.INVALID_UINT_UID_FROM_STRING_UID,extend:u_}),new U_(N_.INVALID_UINT_UID_FROM_STRING_UID);return w0.reqUserAccount(u_.sid,{lts:i_,success:!0,serverAddr:g_,stringUid:u_.string_uid,uid:w_.uid,errorCode:null,extend:u_}),!1}const Rv=mG(w_.code);return Rv.retry&&(g_=_o[(k_+1)%_o.length]),w0.reqUserAccount(u_.sid,{lts:i_,success:!1,serverAddr:g_,stringUid:u_.string_uid,uid:w_.uid,errorCode:Rv.desc,extend:u_}),Rv.retry},(w_,k_)=>w_.code!==N_.OPERATION_ABORTED&&(w0.reqUserAccount(u_.sid,{lts:i_,success:!1,serverAddr:g_,stringUid:u_.string_uid,uid:null,errorCode:w_.code,extend:u_}),g_=_o[(k_+1)%_o.length],!0),o_);if(0!==__.code){const w_=mG(__.code);throw new U_(N_.UNEXPECTED_RESPONSE,w_.desc)}return __}),function(_o,_u,ch,_f,o_){return _i.apply(this,arguments)})(j,s,p,A,y);return null==w||w.recordJoinChannelService({status:"success",endTs:Date.now()},_e),K.uid}catch(K){throw null==w||w.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[K]},_e),K}var _i}),Xle.apply(this,arguments)}function Jie(s,p,A){return ede.apply(this,arguments)}function ede(){return ede=f(function*(s,p,A){let y=Date.now();const w=s.cloudProxyServer,$=v0("normal"===w?"PROXY_CS":"WEBCS_DOMAIN").map(_o=>s.proxyServer?"https://".concat(s.proxyServer,"/ap/?url=").concat(_o+"/api/v1"):"https://".concat(_o,"/api/v1"));if(["proxy3","proxy4","proxy5"].includes(w)){const _o=$.map(_f=>({url:_f,areaCode:oY()}));let _u=null;_u=yield t9({fragementLength:v0("FRAGEMENT_LENGTH"),referenceList:_o,asyncMapHandler:_f=>function(o_,i_,u_,g_){let{url:__,areaCode:w_}=o_;const k_=Date.now(),Rv={opid:133,flag:"proxy5"===i_.cloudProxyServer?4194304:1048576,ts:+new Date,key:i_.token,cname:i_.cname,sid:i_.sid,detail:{6:i_.stringUid,11:w_},uid:i_.uid||0};return LL(f(function*(){return yield KO(__,{data:Rv,cancelToken:u_,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":69}})}),f0=>{if(0===f0.code)return w0.joinWebProxyAP(i_.sid,{lts:k_,sucess:1,apServerAddr:__,turnServerAddrList:f0.addresses.map(b0=>b0.ip).join(","),errorCode:null,eventType:i_.cloudProxyServer}),!1;const y0=mG(f0.code);throw new U_(N_.CAN_NOT_GET_GATEWAY_SERVER,y0.desc,{retry:y0.retry})},f0=>f0.code!==N_.OPERATION_ABORTED&&(f0.code===N_.CAN_NOT_GET_GATEWAY_SERVER?(w0.joinWebProxyAP(Rv.sid,{lts:k_,sucess:0,apServerAddr:__,turnServerAddrList:null,errorCode:f0.code,eventType:i_.cloudProxyServer}),h_.warning("[".concat(i_.clientId,"] proxy ap server ").concat(__," failed, message: ").concat(f0.message,", retry: ").concat(f0.data.retry)),sI("warning",["AjaxAPI",i_.clientId],"proxy ap server ".concat(__," failed, message: ").concat(f0.message,", retry: ").concat(f0.data.retry)),f0.data.retry):(w0.joinWebProxyAP(Rv.sid,{lts:k_,sucess:0,apServerAddr:__,turnServerAddrList:null,errorCode:f0.code,eventType:i_.cloudProxyServer}),!0)),g_)}(_f,s,p,A),allFailedhandler:()=>{throw h_.error("[".concat(s.clientId,"] can not get proxy server after trying several times")),new U_(N_.CAN_NOT_GET_PROXY_SERVER)}});const ch=_u.addresses;if(!ch||0===ch.length)throw h_.error("[".concat(s.clientId,"] can not get proxy server, empty proxy server list")),new U_(N_.CAN_NOT_GET_PROXY_SERVER,"empty proxy server list");return{addresses:ch.map(_f=>_f.ip).map(uX),serverResponse:{tcpport:ch[0].port||443,udpport:ch[0].port||aS.udpport,username:aS.username,password:aS.password}}}let j=null;j=yield t9({fragementLength:v0("FRAGEMENT_LENGTH"),referenceList:$,asyncMapHandler:_o=>function(_u,ch,_f,o_){const i_=Date.now(),u_={command:"convergeAllocateEdge",sid:ch.sid,appId:ch.appId,token:ch.token,uid:ch.uid,cname:ch.cname,ts:Math.floor(Date.now()/1e3),version:GO,seq:0,requestId:1};return LL(f(function*(){return{res:yield KO(_u,{data:{service_name:"webrtc_proxy",json_body:JSON.stringify(u_)},cancelToken:_f,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}}),url:_u}}),g_=>{if(!g_.res.json_body)throw h_.debug("[".concat(ch.clientId,"] Get proxy server failed: no json_body")),S0("error",["AjaxAPI",ch.clientId],"requestProxyServerList","Get proxy server failed: no json_body"),new U_(N_.UNEXPECTED_RESPONSE,JSON.stringify(g_.res));const __=JSON.parse(g_.res.json_body);if(200!==__.code)throw h_.debug("[".concat(ch.clientId,"] Get proxy server failed: response code [").concat(__.code,"], reason [").concat(__.reason,"]")),S0("error",["AjaxAPI",ch.clientId],"requestProxyServerList","Get proxy server failed: response code [".concat(__.code,"], reason [").concat(__.reason,"]")),new U_(N_.UNEXPECTED_RESPONSE,JSON.stringify(g_.res));return h_.debug("[".concat(ch.clientId,"] App return server length"),__.servers.length),S0("debug",["AjaxAPI",ch.clientId],"requestProxyServerList","",{length:__.servers.length}),!1},g_=>g_.code!==N_.OPERATION_ABORTED&&(w0.requestProxyAppCenter(u_.sid,{lts:i_,succ:!1,APAddr:_u,workerManagerList:null,ec:g_.code,response:g_.message}),!0),o_)}(_o,s,p,A),allFailedhandler:()=>{throw h_.error("[".concat(s.clientId,"] can not get proxy server after trying several times")),new U_(N_.CAN_NOT_GET_PROXY_SERVER)}});const _e=JSON.parse(j.res.json_body).servers.map(hge);if("443only"===s.cloudProxyServer)return{addresses:_e,serverResponse:{tcpport:443,udpport:aS.udpport,username:aS.username,password:aS.password}};w0.requestProxyAppCenter(s.sid,{lts:y,succ:!0,APAddr:j.url,workerManagerList:JSON.stringify(_e),ec:null,response:JSON.stringify(j.res)}),y=Date.now();const K=_e.map(_o=>function(_u,ch,_f,o_){const i_=Date.now();let u_=_u;_u.startsWith("http")||(u_="https://".concat(_u,":4000/v2/machine"));const g_={command:"request",gatewayType:"http",appId:ch.appId,cname:ch.cname,uid:(ch.uid||"").toString(),sdkVersion:"2.3.1",sid:ch.sid,seq:1,ts:Date.now(),requestId:3,clientRequest:{appId:ch.appId,cname:ch.cname,uid:(ch.uid||"").toString(),sid:ch.sid}};return LL(f(function*(){return{res:yield KO(u_,{data:g_,cancelToken:_f}),url:_u}}),__=>{if(!__.res.serverResponse)throw new U_(N_.UNEXPECTED_RESPONSE,"requeet worker manager server failed: serverResponse is undefined");return!1},__=>__.code!==N_.OPERATION_ABORTED&&(w0.requestProxyWorkerManager(g_.sid,{lts:i_,succ:!1,workerManagerAddr:_u,ec:__.code,response:__.message}),!0),o_)}(_o,s,p,A));let _i=null;try{_i=yield e9(K)}catch(_o){throw h_.error("[".concat(s.clientId,"] can not get worker manager after trying several times")),new U_(N_.CAN_NOT_GET_PROXY_SERVER)}return K.forEach(_o=>_o.cancel()),w0.requestProxyWorkerManager(s.sid,{lts:y,succ:!0,workerManagerAddr:_i.url,ec:null,response:JSON.stringify(_i.res)}),{addresses:[_i.url],serverResponse:_i.res.serverResponse}}),ede.apply(this,arguments)}function mme(){return mme=f(function*(s,p,A){const y=v0("CDS_AP").slice(0,v0("AJAX_REQUEST_CONCURRENT")).map(_e=>s.proxyServer?"https://".concat(s.proxyServer,"/ap/?url=").concat(_e+"/api/v1"):"https://".concat(_e,"/api/v1?action=config")).map(_e=>function(K,_i,_o,_u){const ch=Y1(),_f={flag:64,cipher_method:0,features:{device:ch.name,system:ch.os,system_general:navigator.userAgent,vendor:_i.appId,version:GO,cname:_i.cname,sid:_i.sid,session_id:_i.sid,detail:"",proxyServer:_i.proxyServer}};return LL(()=>KO(K,{data:_f,timeout:1e3,cancelToken:_o,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,o_=>o_.code!==N_.OPERATION_ABORTED,_u)}(_e,s,p,A));let w=null,$=null,j={};try{w=yield e9(y)}catch(_e){if(_e.code===N_.OPERATION_ABORTED)throw _e;$=_e}if(y.forEach(_e=>_e.cancel()),w0.reportApiInvoke(s.sid,{name:bI.REQUEST_CONFIG_DISTRIBUTE,options:{error:$,res:w}}).onSuccess(),w&&w.test_tags)try{j=function(_e){if(!_e.test_tags)return{};const K=_e.test_tags,_i=Object.keys(K),_o={};return _i.forEach(_u=>{var ch;const _f=yQ(ch=_u.slice(4)).call(ch),o_=JSON.parse(K[_u])[1];_o[_f]=o_}),_o}(w)}catch(_e){}return j}),mme.apply(this,arguments)}function Eye(s,p,A,y){return $ie.apply(this,arguments)}function $ie(){return $ie=f(function*(s,p,A,y){const w=v0("PROXY_SERVER_TYPE3"),$=(_f,o_)=>{let i_=w;return Array.isArray(i_)&&(i_=o_%2==0?w[1]:w[0]),"https://".concat(i_,"/ap/?url=").concat(_f)};let j=null;const _e=[],K=function(){var _f=f(function*(){const o_=v0("WEBCS_DOMAIN").slice(0,v0("AJAX_REQUEST_CONCURRENT")).map((g_,__)=>({url:"disabled"===s.cloudProxyServer||"fallback"===s.cloudProxyServer?"https://".concat(g_,"/api/v2/transpond/webrtc?v=2"):$("".concat(g_,"/api/v2/transpond/webrtc?v=2"),__),areaCode:oY(),serviceIds:[AS.CHOOSE_SERVER,"proxy5"===s.cloudProxyServer?AS.CLOUD_PROXY_5:"proxy3"===s.cloudProxyServer||"proxy4"===s.cloudProxyServer?AS.CLOUD_PROXY:AS.CLOUD_PROXY_FALLBACK]})),i_=y.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:o_.map(g_=>g_.url)}),u_=yield t9({fragementLength:v0("FRAGEMENT_LENGTH"),referenceList:o_,asyncMapHandler:g_=>(h_.debug("[".concat(s.clientId,"] Connect to choose_server:"),g_.url),_G(g_,s,p,A)),allFailedhandler:g_=>{throw y.recordJoinChannelService({endTs:Date.now(),status:"error",errors:g_},i_),g_[0]},promisesCollector:_e});return y.recordJoinChannelService({endTs:Date.now(),status:"success"},i_),u_});return function(){return _f.apply(this,arguments)}}(),_i=function(){var _f=f(function*(){if(yield pR(1e3),null!==j)return j;const o_=v0("WEBCS_DOMAIN_BACKUP_LIST").map((g_,__)=>({url:"disabled"===s.cloudProxyServer||"fallback"===s.cloudProxyServer?"https://".concat(g_,"/api/v2/transpond/webrtc?v=2"):$("".concat(g_,"/api/v2/transpond/webrtc?v=2"),__),areaCode:oY(),serviceIds:[AS.CHOOSE_SERVER,"proxy5"===s.cloudProxyServer?AS.CLOUD_PROXY_5:"proxy3"===s.cloudProxyServer||"proxy4"===s.cloudProxyServer?AS.CLOUD_PROXY:AS.CLOUD_PROXY_FALLBACK]})),i_=y.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:o_.map(g_=>g_.url)}),u_=yield t9({fragementLength:v0("FRAGEMENT_LENGTH"),referenceList:o_,asyncMapHandler:g_=>(h_.debug("[".concat(s.clientId,"] Connect to backup choose_server:"),g_.url),_G(g_,s,p,A)),allFailedhandler:g_=>{throw y.recordJoinChannelService({endTs:Date.now(),status:"error",errors:g_},i_),g_[0]},promisesCollector:_e});return y.recordJoinChannelService({endTs:Date.now(),status:"success"},i_),u_});return function(){return _f.apply(this,arguments)}}();let _o,_u,ch;try{({gatewayInfo:_o,proxyInfo:_u,url:ch}=yield e9([K(),_i()]))}catch(_f){throw _f[0]}if(_e.length&&_e.forEach(_f=>_f.cancel&&"function"==typeof _f.cancel&&_f.cancel()),!_o||!_u)throw new U_(N_.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(s.apUrl=ch,"disabled"!==s.cloudProxyServer&&Array.isArray(w)&&ch){const _f=new rY(ch).host;w.includes(_f)&&(s.proxyServer=_f,h_.setProxyServer(_f),w0.setProxyServer(_f),wQ(_f))}return j={gatewayInfo:_o,proxyInfo:yield fge(_u,_o.uid)},j}),$ie.apply(this,arguments)}function Ame(s,p,A,y){return tde.apply(this,arguments)}function tde(){return tde=f(function*(s,p,A,y){const w=v0("UAP_AP").slice(0,v0("AJAX_REQUEST_CONCURRENT")).map($=>p.proxyServer?"https://".concat(p.proxyServer,"/ap/?url=").concat($+"/api/v1?action=uap"):"https://".concat($,"/api/v1?action=uap"));return yield lme(w,s,p,A,y)}),tde.apply(this,arguments)}function Zie(){return Zie=f(function*(s,p,A){const y=v0("UAP_AP").slice(0,v0("AJAX_REQUEST_CONCURRENT")).map(w=>s.proxyServer?"https://".concat(s.proxyServer,"/ap/?url=").concat(w+"/api/v1?action=uap"):"https://".concat(w,"/api/v1?action=uap")).map(w=>function($,j,_e,K){const _i={command:"convergeAllocateEdge",sid:j.sid,appId:j.appId,token:j.token,ts:Date.now(),version:GO,cname:j.cname,uid:j.uid.toString(),requestId:$4,seq:$4};$4+=1;const _o={service_name:"tele_channel",json_body:JSON.stringify(_i)};return LL(f(function*(){const _u=yield KO($,{data:_o,cancelToken:_e,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(0!==_u.code){const _f=new U_(N_.UNEXPECTED_RESPONSE,"cross channel ap error, code"+_u.code,{retry:!0});throw h_.error(_f.toString()),S0("error",["AjaxAPI"],"requestChannelMediaRelayWorkerManager",void 0,_f.toString()),_f}const ch=JSON.parse(_u.json_body);if(200!==ch.code){const _f=new U_(N_.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(ch.code,", reason: ").concat(ch.reason));throw h_.error(_f.toString()),S0("error",["AjaxAPI"],"requestChannelMediaRelayWorkerManager",void 0,_f.toString()),_f}if(!ch.servers||0===ch.servers.length){const _f=new U_(N_.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw h_.error(_f.toString()),S0("error",["AjaxAPI"],"requestChannelMediaRelayWorkerManager",void 0,_f.toString()),_f}return{vid:ch.vid,workerToken:ch.workerToken,addressList:ch.servers.map(_f=>"wss://".concat(_f.address.replace(/\./g,"-"),".").concat(v0("WORKER_DOMAIN"),":").concat(_f.wss))}}),void 0,_u=>!!(_u.code!==N_.OPERATION_ABORTED&&_u.code!==N_.UNEXPECTED_RESPONSE||_u.data&&_u.data.retry),K)}(w,s,p,A));try{const w=yield e9(y);return y.forEach($=>$.cancel()),w}catch(w){throw w[0]}}),Zie.apply(this,arguments)}function h9(){return h9=f(function*(s,p,A){let y=null;const w=[],$=function(){var j=f(function*(_e){const K=v0(_e?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(_i=>s.proxyServer?"https://".concat(s.proxyServer,"/ap/?url=").concat(_i+"/api/v2/transpond/webrtc?v=2"):"https://".concat(_i,"/api/v2/transpond/webrtc?v=2"));return _e&&(yield pR(1e3),null!==y)?y:yield t9({fragementLength:v0("FRAGEMENT_LENGTH"),referenceList:K,asyncMapHandler:_i=>(h_.debug("[".concat(s.clientId,"] update ticket, Connect to ").concat(_e?"backup":""," choose_server:"),_i),function(_o,_u,ch,_f){const[o_]=_ye(_u,[AS.CHOOSE_SERVER]);let i_=_S.networkState;return LL(f(function*(){i_&&_S.networkState===eP.OFFLINE&&_S.onlineWaiter&&(yield iI.race([_S.onlineWaiter,pR(_f&&_f.maxRetryTimeout||pS.maxRetryTimeout)])),i_=_S.networkState;const u_=yield KO(_o,{data:o_,cancelToken:ch,headers:{"Content-Type":"multipart/form-data;"}},!0);return Aye(u_,_o)}),()=>!1,u_=>u_.code!==N_.OPERATION_ABORTED&&(u_.code===N_.UPDATE_TICKET_FAILED?u_.data.retry:(h_.warning("[".concat(_u.clientId,"] update ticket network error, retry"),u_),sI("warning",["AjaxAPI",_u.clientId],"update ticket network error, retry, ".concat(u_)),!0)),_f)}(_i,s,p,A)),allFailedhandler:_i=>{throw _i[0]},promisesCollector:w})});return function(K){return j.apply(this,arguments)}}();try{return y=yield e9([$(!1),$(!0)]),w.length&&w.forEach(j=>j.cancel&&"function"==typeof j.cancel&&j.cancel()),y}catch(j){throw j[0]}}),h9.apply(this,arguments)}var Xie;function vme(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function yme(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?vme(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):vme(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}let Eme=TR("ConfigDistributeManager")(Xie=class extends sS{constructor(){super(),a_(this,"configs",void 0),a_(this,"joinInfo",void 0),a_(this,"cancelToken",void 0),a_(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),a_(this,"interval",void 0),a_(this,"mutex",new iP("config-distribute")),a_(this,"mutableParamsRead",!1)}startGetConfigDistribute(s,p){this.joinInfo=s,this.cancelToken=p,this.interval&&this.stopGetConfigDistribute(),this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},v0("CONFIG_DISTRIBUTE_INTERVAL"))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}awaitConfigDistributeComplete(){var s=this;return f(function*(){!s.mutex.isLocked||(yield s.mutex.lock())()})()}updateConfigDistribute(){var s=this;return f(function*(){if(s.mutableParamsRead||(s.mutableParamsRead=!0,w0.reportApiInvoke(null,{options:void 0,name:bI.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:lI.TRACER}).onSuccess(JSON.stringify(rce))),!s.joinInfo||!s.cancelToken||!s.retryConfig)return h_.debug("[config-distribute] get config distribute interrupted have no joininfo"),void S0("debug",s,"updateConfigDistribute",void 0,"get config distribute interrupted have no joininfo");let p;const A=yield s.mutex.lock();try{p=yield function yye(s,p,A){return mme.apply(this,arguments)}(s.joinInfo,s.cancelToken,s.retryConfig),h_.debug("[config-distribute] get config distribute",JSON.stringify(p)),S0("debug",s,"updateConfigDistribute",p),p.limit_bitrate&&s.handleBitrateLimit(p.limit_bitrate),s.cacheGlobalParameterConfig(p),s.configs=p}catch(y){const w=new U_(N_.NETWORK_RESPONSE_ERROR,y);h_.warning("[config-distribute] ".concat(w.toString())),S0("warning",s,"updateConfigDistribute",void 0,y.toString())}finally{A()}})()}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(s){var p;(p=s)&&p.uplink&&p.id&&void 0!==p.uplink.max_bitrate&&void 0!==p.uplink.min_bitrate&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==s.id&&this.emit(V8.UPDATE_BITRATE_LIMIT,s):this.emit(V8.UPDATE_BITRATE_LIMIT,s))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&yme({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(s){var p;const A=gre(p=Object.keys(s).filter(w=>/^webrtc_ng_global_parameter/.test(w))).call(p);for(let w=0;w<A.length;w++)for(let $=A.length-1;$>w;$--){const j=A[$];if("number"==typeof s[j].__priority){const _e=s[j].__priority,K=A[$-1];if("number"==typeof s[K].__priority){if(!(_e>s[K].__priority))continue;{const _i=j;A[$]=A[$-1],A[$-1]=_i}}else{const _i=j;A[$]=A[$-1],A[$-1]=_i}}}const y={};A.forEach(w=>{const $=s[w],j=$.__expires;Object.keys($).forEach(_e=>{"__priority"===_e||"__expires"===_e||Object.prototype.hasOwnProperty.call(y,_e)||(y[_e]=yme({value:$[_e]},j&&{expires:j}))})});try{const w=JSON.stringify(y),$=window.btoa(w);window.localStorage.setItem("websdk_ng_global_parameter",$),h_.debug("Caching global parameters ".concat(w)),S0("debug",this,"cacheGlobalParameterConfig",w)}catch(w){h_.error("Error caching global parameters:",w.message),S0("error",this,"cacheGlobalParameterConfig",void 0,w.message)}}})||Xie;function NX(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function kX(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?NX(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):NX(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}class Ime extends sS{constructor(p,A,y,w){super(),a_(this,"spec",void 0),a_(this,"token",void 0),a_(this,"websocket",void 0),a_(this,"pingpongTimer",void 0),a_(this,"reconnectMode","retry"),a_(this,"serviceMode",void 0),a_(this,"reqId",0),a_(this,"commandReqId",0),a_(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),a_(this,"handleWebSocketMessage",$=>{if(!$.data)return;const j=JSON.parse($.data);j.requestId?this.emit("@".concat(j.requestId,"-").concat(j.sid),j):this.serviceMode===UT.INJECT?this.emit(JP.INJECT_STREAM_STATUS,j):(w0.workerEvent(this.spec.sid,{actionType:"status",serverCode:j.code,workerType:this.serviceMode===UT.TRANSCODE?1:2}),this.emit(JP.PUBLISH_STREAM_STATUS,j))}),this.spec=A,this.token=p,this.serviceMode=w,this.websocket=new Wie("live-streaming",y),this.websocket.on(p1.CONNECTED,this.handleWebSocketOpen),this.websocket.on(p1.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(p1.REQUEST_NEW_URLS,($,j)=>{ZP(this,JP.REQUEST_NEW_ADDRESS).then($).catch(j)}),this.websocket.on(p1.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(p){return this.websocket.init(p)}request(p,A,y,w){var $=this;return f(function*(){$.reqId+=1,"request"===p&&($.commandReqId+=1);const j=$.commandReqId,_e=$.reqId;if(!_e||!$.websocket)throw new U_(N_.UNEXPECTED_ERROR);const K=kX({command:p,sdkVersion:"4.11.1"===GO?"0.0.1":GO,seq:_e,requestId:_e,allocate:y,cname:$.spec.cname,appId:$.spec.appId,sid:$.spec.sid,uid:$.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},A);if("closed"===$.websocket.state)throw new U_(N_.WS_DISCONNECT);const _i=()=>new iI((_f,o_)=>{$.websocket.once(p1.CLOSED,()=>o_(new U_(N_.WS_ABORT))),$.websocket.once(p1.CONNECTED,_f)});"connected"!==$.websocket.state&&(yield _i()),K.clientRequest&&(K.clientRequest.workerToken=$.token);const _o=new iI((_f,o_)=>{const i_=()=>{o_(new U_(N_.WS_ABORT))};$.websocket.once(p1.RECONNECTING,i_),$.websocket.once(p1.CLOSED,i_),$.once("@".concat(_e,"-").concat($.spec.sid),u_=>{_f(u_)})});w&&w0.workerEvent($.spec.sid,kX(kX({},w),{},{requestId:j,actionType:"request",payload:JSON.stringify(A.clientRequest),serverCode:0,code:0}));const _u=Date.now();$.websocket.sendMessage(K);let ch=null;try{ch=yield _o}catch(_f){if("closed"===$.websocket.state)throw _f;return yield _i(),yield $.request(p,A,y)}return w&&w0.workerEvent($.spec.sid,kX(kX({},w),{},{requestId:j,actionType:"response",payload:JSON.stringify(ch.serverResponse),serverCode:ch.code,success:200===ch.code,responseTime:Date.now()-_u})),200!==ch.code&&$.handleResponseError(ch),ch})()}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const p="4.11.1"===GO?"0.0.1":GO;this.reqId+=1,"connected"===this.websocket.state?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:p,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(p){switch(p.code){case mT.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void h_.warning("live stream response already exists stream");case mT.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case mT.LIVE_STREAM_RESPONSE_BAD_STREAM:case mT.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new U_(N_.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:p.code}).throw();case mT.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if("UnpublishStream"===p.serverResponse.command||"UninjectStream"===p.serverResponse.command)return;throw new U_(N_.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case mT.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new U_(N_.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:p.code}).throw();case mT.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const A=new U_(N_.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(JP.WARNING,A,p.serverResponse.url)}case mT.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const A=new U_(N_.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(JP.WARNING,A,p.serverResponse.url)}case mT.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new U_(N_.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case mT.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new U_(N_.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:p.code}).throw();case mT.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const A=new U_(N_.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(JP.WARNING,A,p.serverResponse.url)}case mT.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new U_(N_.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:p.code}).throw();case mT.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new U_(N_.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case mT.LIVE_STREAM_RESPONSE_WORKER_LOST:case mT.LIVE_STREAM_RESPONSE_WORKER_QUIT:if("UnpublishStream"===p.serverResponse.command||"UninjectStream"===p.serverResponse.command)return;throw new U_(N_.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case mT.ERROR_FAIL_SEND_MESSAGE:if("UnpublishStream"===p.serverResponse.command||"UninjectStream"===p.serverResponse.command)return;if("UpdateTranscoding"===p.serverResponse.command||"ControlStream"===p.serverResponse.command)return new U_(N_.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:p.code}).throw();throw new U_(N_.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case mT.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case mT.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case mT.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case mT.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new U_(N_.LIVE_STREAMING_CDN_ERROR,"",{code:p.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{"connected"===this.websocket.state&&this.request("ping",{}).catch(pie)},6e3)}}function rde(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function tR(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?rde(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):rde(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}class HM extends sS{constructor(p){let A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pS,y=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pS;super(),a_(this,"onLiveStreamWarning",void 0),a_(this,"onLiveStreamError",void 0),a_(this,"onInjectStatusChange",void 0),a_(this,"spec",void 0),a_(this,"retryTimeout",1e4),a_(this,"connection",void 0),a_(this,"httpRetryConfig",void 0),a_(this,"wsRetryConfig",void 0),a_(this,"streamingTasks",new Map),a_(this,"isStartingStreamingTask",!1),a_(this,"taskMutex",new iP("live-streaming")),a_(this,"cancelToken",JU.CancelToken.source()),a_(this,"transcodingConfig",void 0),a_(this,"injectConfig",tR({},k_e)),a_(this,"injectLoopTimes",0),a_(this,"uapResponse",void 0),a_(this,"lastTaskId",1),a_(this,"statusError",new Map),this.spec=p,this.httpRetryConfig=y,this.wsRetryConfig=A}setTranscodingConfig(p){var A=this;return f(function*(){const y=tR(tR({},jfe),p);var _e;66!==y.videoCodecProfile&&77!==y.videoCodecProfile&&100!==y.videoCodecProfile&&(h_.debug("[".concat(A.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(y.videoCodecProfile," -> 100")),y.videoCodecProfile=100),y.transcodingUsers||(y.transcodingUsers=y.userConfigs),y.transcodingUsers&&(y.transcodingUsers=y.transcodingUsers.map(_e=>tR(tR(tR({},wce),_e),{},{zOrder:_e.zOrder?_e.zOrder+1:1}))),l1((_e=y).width)||iT(_e.width,"config.width",0,1e4),l1(_e.height)||iT(_e.height,"config.height",0,1e4),l1(_e.videoBitrate)||iT(_e.videoBitrate,"config.videoBitrate",1,1e6),l1(_e.videoFrameRate)||iT(_e.videoFrameRate,"config.videoFrameRate"),l1(_e.lowLatency)||pK(_e.lowLatency,"config.lowLatency"),l1(_e.audioSampleRate)||RR(_e.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),l1(_e.audioBitrate)||iT(_e.audioBitrate,"config.audioBitrate",1,128),l1(_e.audioChannels)||RR(_e.audioChannels,"config.audioChannels",[1,2,3,4,5]),l1(_e.videoGop)||iT(_e.videoGop,"config.videoGop"),l1(_e.videoCodecProfile)||RR(_e.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),l1(_e.userCount)||iT(_e.userCount,"config.userCount",0,17),l1(_e.backgroundColor)||iT(_e.backgroundColor,"config.backgroundColor",0,16777215),l1(_e.userConfigExtraInfo)||rO(_e.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),_e.transcodingUsers&&!l1(_e.transcodingUsers)&&(TQ(_e.transcodingUsers,"config.transcodingUsers"),_e.transcodingUsers.forEach((K,_i)=>{iO(K.uid),l1(K.x)||iT(K.x,"transcodingUser[".concat(_i,"].x"),0,1e4),l1(K.y)||iT(K.y,"transcodingUser[".concat(_i,"].y"),0,1e4),l1(K.width)||iT(K.width,"transcodingUser[".concat(_i,"].width"),0,1e4),l1(K.height)||iT(K.height,"transcodingUser[".concat(_i,"].height"),0,1e4),l1(K.zOrder)||iT(K.zOrder-1,"transcodingUser[".concat(_i,"].zOrder"),0,100),l1(K.alpha)||iT(K.alpha,"transcodingUser[".concat(_i,"].alpha"),0,1,!1)})),l1(_e.watermark)||RQ(_e.watermark,"watermark"),l1(_e.backgroundImage)||RQ(_e.backgroundImage,"backgroundImage"),_e.images&&!l1(_e.images)&&(TQ(_e.images,"config.images"),_e.images.forEach((K,_i)=>{RQ(K,"images[".concat(_i,"]"))}));const w=[];y.images&&w.push(...y.images.map(_e=>tR(tR(tR({},_K),_e),{},{zOrder:255}))),y.backgroundImage&&(w.push(tR(tR(tR({},_K),y.backgroundImage),{},{zOrder:0})),delete y.backgroundImage),y.watermark&&(w.push(tR(tR(tR({},_K),y.watermark),{},{zOrder:255})),delete y.watermark),y.images=w,y.transcodingUsers&&(y.userConfigs=y.transcodingUsers.map(_e=>tR({},_e)),y.userCount=y.transcodingUsers.length,delete y.transcodingUsers);const $=(y.userConfigs||[]).map(_e=>"number"==typeof _e.uid?iI.resolve(_e.uid):Zle(_e.uid,A.spec,A.cancelToken.token,A.httpRetryConfig));if((yield iI.all($)).forEach((_e,K)=>{y.userConfigs&&y.userConfigs[K]&&(y.userConfigs[K].uid=_e)}),A.transcodingConfig=y,A.connection)try{var j;const _e=yield A.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:A.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(rP(j=A.streamingTasks).call(j)).map(K=>K.taskId).join("#")});h_.debug("[".concat(A.spec.clientId,"] update live transcoding config success, code: ").concat(_e.code,", config:"),JSON.stringify(A.transcodingConfig))}catch(_e){if(!_e.data||!_e.data.retry)throw _e;_e.data.changeAddress&&A.connection.tryNextAddress(),A.streamingTasks.forEach(K=>{h_.warning("[".concat(A.spec.clientId,"] live streaming receive error"),_e.toString(),"try to republish",K.url),A.startLiveStreamingTask(K.url,K.mode,_e).then(()=>{h_.debug("[".concat(A.spec.clientId,"] live streaming republish ").concat(K.url," success"))}).catch(_i=>{h_.error("[".concat(A.spec.clientId,"] live streaming republish failed"),K.url,_i.toString()),A.onLiveStreamError&&A.onLiveStreamError(K.url,_i)})})}})()}setInjectStreamConfig(p,A){this.injectConfig=Object.assign({},this.injectConfig,p),this.injectLoopTimes=A}startLiveStreamingTask(p,A,y){var w=this;return f(function*(){var $;if(Array.from(rP($=w.streamingTasks).call($)).find(_i=>_i.mode===UT.INJECT)&&A===UT.INJECT)return new U_(N_.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw();if(!w.transcodingConfig&&A===UT.TRANSCODE)throw new U_(N_.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let j={command:"PublishStream",ts:Date.now(),url:p,uid:w.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};h_.debug("[".concat(w.spec.clientId,"] start live streaming ").concat(p,", mode: ").concat(A));const _e=yield w.taskMutex.lock();if(!w.connection&&y)return void _e();if(w.streamingTasks.get(p)&&!y)return _e(),new U_(N_.LIVE_STREAMING_TASK_CONFLICT).throw();try{w.connection||(w.connection=yield w.connect(A))}catch(_i){throw _e(),_i}switch(A){case UT.TRANSCODE:j.transcodingConfig=tR({},w.transcodingConfig);break;case UT.RAW:break;case UT.INJECT:j={cname:w.spec.cname,command:"InjectStream",sid:w.spec.sid,transcodingConfig:w.injectConfig,ts:Date.now(),url:p,loopTimes:w.injectLoopTimes}}w.uapResponse&&w.uapResponse.vid&&(j.vid=w.uapResponse.vid),w.isStartingStreamingTask=!0;const K=w.lastTaskId++;try{const _i=new iI((_u,ch)=>{pR(w.retryTimeout).then(()=>{if(y)return ch(y);const _f=w.statusError.get(p);return _f?(w.statusError.delete(p),ch(_f)):void 0})}),_o=yield iI.race([w.connection.request("request",{clientRequest:j},!0,{url:p,command:"PublishStream",workerType:A===UT.TRANSCODE?1:2,requestByUser:!y,tid:K.toString()}),_i]);w.isStartingStreamingTask=!1,h_.debug("[".concat(w.spec.clientId,"] live streaming started, code: ").concat(_o.code)),w.streamingTasks.set(p,{clientRequest:j,mode:A,url:p,taskId:K}),_e()}catch(_i){if(_e(),w.isStartingStreamingTask=!1,!_i.data||!_i.data.retry||y)throw _i;return _i.data.changeAddress?(w.connection.tryNextAddress(),yield w.startLiveStreamingTask(p,A,_i)):yield w.startLiveStreamingTask(p,A,_i)}})()}stopLiveStreamingTask(p){return new iI((A,y)=>{const w=this.streamingTasks.get(p);if(!w||!this.connection)return new U_(N_.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const $=w.mode;w.abortTask=()=>{h_.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(p),A()},this.connection.request("request",{clientRequest:{command:$===UT.INJECT?"UninjectStream":"UnpublishStream",url:w.url}},!1,{url:p,command:"UnPublishStream",workerType:$===UT.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(j=>{h_.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(j.code)),this.streamingTasks.delete(p),0===this.streamingTasks.size&&$!==UT.INJECT&&(this.connection&&this.connection.close(),this.connection=void 0),A(),$===UT.INJECT&&this.onInjectStatusChange&&this.onInjectStatusChange(B4.INJECT_STREAM_STATUS_STOP_SUCCESS,this.spec.uid,p)}).catch(y)})}controlInjectStream(p,A,y,w){var $=this;return f(function*(){const j=$.streamingTasks.get(p);if(!j||!$.connection||j.mode!==UT.INJECT)throw new U_(N_.INVALID_OPERATION,"can not find inject stream task to control");return(yield $.connection.request("request",{clientRequest:{command:"ControlStream",url:p,control:A,audioVolume:y,position:w}})).serverResponse})()}resetAllTask(){var p;const A=Array.from(rP(p=this.streamingTasks).call(p));this.terminate();for(const y of A)this.startLiveStreamingTask(y.url,y.mode).catch(w=>{this.onLiveStreamError&&this.onLiveStreamError(y.url,w)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=JU.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}connect(p){var A=this;return f(function*(){if(A.connection)throw new U_(N_.UNEXPECTED_ERROR,"live streaming connection has already connected");const y=yield ZP(A,w6.REQUEST_WORKER_MANAGER_LIST,p);return A.uapResponse=y,A.connection=new Ime(y.workerToken,A.spec,A.wsRetryConfig,p),A.connection.on(JP.WARNING,(w,$)=>A.onLiveStreamWarning&&A.onLiveStreamWarning($,w)),A.connection.on(JP.PUBLISH_STREAM_STATUS,w=>A.handlePublishStreamServer(w)),A.connection.on(JP.INJECT_STREAM_STATUS,w=>A.handleInjectStreamServerStatus(w)),A.connection.on(JP.REQUEST_NEW_ADDRESS,(w,$)=>{if(!A.connection)return $(new U_(N_.UNEXPECTED_ERROR,"can not get new live streaming address list"));ZP(A,w6.REQUEST_WORKER_MANAGER_LIST,p).then(j=>{A.uapResponse=j,w(j.addressList)}).catch($)}),yield A.connection.init(y.addressList),A.connection})()}handlePublishStreamServer(p){const A=p.serverStatus&&p.serverStatus.url||"empty_url",y=this.streamingTasks.get(A),w=p.reason;switch(p.code){case mT.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case mT.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case mT.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case mT.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const j=new U_(N_.LIVE_STREAMING_CDN_ERROR,"",{code:p.code});if(y)return h_.error(j.toString()),this.onLiveStreamError&&this.onLiveStreamError(A,j);if(!this.isStartingStreamingTask)return;this.statusError.set(A,j)}case mT.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const j=new U_(N_.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,w);return this.onLiveStreamWarning&&this.onLiveStreamWarning(A,j)}case mT.LIVE_STREAM_RESPONSE_WORKER_LOST:case mT.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var $;if(!this.connection)return;this.connection.tryNextAddress();const j=Array.from(rP($=this.streamingTasks).call($));for(const _e of j)_e.abortTask?_e.abortTask():(h_.warning("[".concat(this.spec.clientId,"] publish stream status code"),p.code,"try to republish",_e.url),this.startLiveStreamingTask(_e.url,_e.mode,new U_(N_.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:p.code})).then(()=>{h_.debug("[".concat(this.spec.clientId,"] republish live stream success"),_e.url)}).catch(K=>{h_.error(K.toString()),this.onLiveStreamError&&this.onLiveStreamError(_e.url,K)}));return}}}handleInjectStreamServerStatus(p){const A=Number(p.uid),y=p.serverStatus&&p.serverStatus.url;switch(p.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(B4.INJECT_STREAM_STATUS_START_SUCCESS,A,y));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(B4.INJECT_STREAM_STATUS_START_ALREADY_EXISTS,A,y),void this.streamingTasks.delete(y);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(B4.INJECT_STREAM_STATUS_START_UNAUTHORIZED,A,y),void this.streamingTasks.delete(y);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(B4.INJECT_STREAM_STATUS_BROKEN,A,y),void this.streamingTasks.delete(y);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(B4.INJECT_STREAM_STATUS_START_TIMEOUT,A,y),void this.streamingTasks.delete(y);default:return void h_.debug("inject stream server status",p)}}hasUrl(p){return this.streamingTasks.has(p)}}class h2{constructor(){a_(this,"destChannelMediaInfos",new Map),a_(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(p){Rce(p),this.srcChannelMediaInfo=p}addDestChannelInfo(p){Rce(p),this.destChannelMediaInfos.set(p.channelName,p)}removeDestChannelInfo(p){pZ(p),this.destChannelMediaInfos.delete(p)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function ide(s){if(!(s instanceof h2))return new U_(N_.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const p=s.getSrcChannelMediaInfo(),A=s.getDestChannelMediaInfo();return p?0===A.size?new U_(N_.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw():void 0:new U_(N_.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw()}class bme extends sS{constructor(p,A,y){super(),a_(this,"ws",void 0),a_(this,"requestId",1),a_(this,"heartBeatTimer",void 0),a_(this,"joinInfo",void 0),a_(this,"clientId",void 0),a_(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),a_(this,"onClose",w=>{this.emit("close"),this.dispose()}),a_(this,"onMessage",w=>{const $=JSON.parse(w.data);if(!$||"serverResponse"!==$.command||!$.requestId)return $&&"serverStatus"===$.command&&$.serverStatus&&$.serverStatus.command?(this.emit("status",$.serverStatus),void this.emit($.serverStatus.command,$.serverStatus)):void 0;this.emit("req_".concat($.requestId),$)}),this.joinInfo=p,this.clientId=A,this.ws=new Wie("cross-channel-".concat(this.clientId),y),this.ws.on(p1.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(p1.CONNECTED,this.onOpen),this.ws.on(p1.ON_MESSAGE,this.onMessage),this.ws.on(p1.CLOSED,this.onClose)}isConnect(){return"connected"===this.ws.state}sendMessage(p){const A=this.requestId++;return p.requestId=A,p.seq=A,this.ws.sendMessage(p),A}waitStatus(p){return new iI((A,y)=>{const w=window.setTimeout(()=>{y(new U_(N_.TIMEOUT,"wait status timeout, status: ".concat(p)))},5e3);this.once(p,$=>{window.clearTimeout(w),$.state&&0!==$.state?y(new U_(N_.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(p))):A(void 0)}),this.once("dispose",()=>{window.clearTimeout(w),y(new U_(N_.WS_ABORT))})})}request(p){var A=this;return f(function*(){if("closed"===A.ws.state)throw new U_(N_.WS_DISCONNECT);"connected"!==A.ws.state&&(yield new iI((_e,K)=>{A.ws.once(p1.CLOSED,()=>K(new U_(N_.WS_ABORT))),A.ws.once(p1.CONNECTED,_e)}));const w=A.sendMessage(p),$=new iI((_e,K)=>{const _i=()=>{K(new U_(N_.WS_ABORT))};A.ws.once(p1.RECONNECTING,_i),A.ws.once(p1.CLOSED,_i),A.once("req_".concat(w),_e),pR(3e3).then(()=>{A.removeAllListeners("req_".concat(w)),A.ws.off(p1.RECONNECTING,_i),A.ws.off(p1.CLOSED,_i),K(new U_(N_.TIMEOUT,"cross channel ws request timeout"))})}),j=yield $;if(!j||200!==j.code)throw new U_(N_.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(j)));return j})()}connect(p){var A=this;return f(function*(){A.ws.removeAllListeners(p1.REQUEST_NEW_URLS),A.ws.on(p1.REQUEST_NEW_URLS,y=>{y(p)}),yield A.ws.init(p)})()}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(p){const A=this.requestId++;return p.requestId=A,this.ws.sendMessage(p),A}startHeartBeatCheck(){this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class PX extends sS{set state(p){p!==this._state&&(p!==yN.RELAY_STATE_FAILURE&&(this.errorCode=xM.RELAY_OK),this.emit("state",p,this.errorCode),this._state=p)}get state(){return this._state}constructor(p,A,y,w){var $;super(),$=this,a_(this,"joinInfo",void 0),a_(this,"clientId",void 0),a_(this,"cancelToken",JU.CancelToken.source()),a_(this,"workerToken",void 0),a_(this,"requestId",0),a_(this,"signal",void 0),a_(this,"prevChannelMediaConfig",void 0),a_(this,"httpRetryConfig",void 0),a_(this,"_state",yN.RELAY_STATE_IDLE),a_(this,"errorCode",xM.RELAY_OK),a_(this,"onStatus",j=>{h_.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(j))),j&&j.command&&("onAudioPacketReceived"===j.command&&this.emit("event",PM.PACKET_RECEIVED_AUDIO_FROM_SRC),"onVideoPacketReceived"===j.command&&this.emit("event",PM.PACKET_RECEIVED_VIDEO_FROM_SRC),"onSrcTokenPrivilegeDidExpire"===j.command&&(this.errorCode=xM.SRC_TOKEN_EXPIRED,this.state=yN.RELAY_STATE_FAILURE),"onDestTokenPrivilegeDidExpire"===j.command&&(this.errorCode=xM.DEST_TOKEN_EXPIRED,this.state=yN.RELAY_STATE_FAILURE))}),a_(this,"onReconnect",f(function*(){h_.debug("[".concat($.clientId,"] ChannelMediaSocket disconnect, reconnecting")),$.emit("event",PM.NETWORK_DISCONNECTED),$.state=yN.RELAY_STATE_IDLE,$.prevChannelMediaConfig&&$.sendStartRelayMessage($.prevChannelMediaConfig).catch(j=>{$.state!==yN.RELAY_STATE_IDLE&&(h_.error("auto restart channel media relay failed",j.toString()),$.errorCode=xM.SERVER_CONNECTION_LOST,$.state=yN.RELAY_STATE_FAILURE)})})),this.joinInfo=p,this.clientId=A,this.signal=new bme(this.joinInfo,this.clientId,y),this.httpRetryConfig=w}startChannelMediaRelay(p){var A=this;return f(function*(){if(A.state!==yN.RELAY_STATE_IDLE)throw new U_(N_.INVALID_OPERATION);A.state=yN.RELAY_STATE_CONNECTING,yield A.connect(),h_.debug("[".concat(A.clientId,"] startChannelMediaRelay: connect success"));try{yield A.sendStartRelayMessage(p)}catch(y){throw y.data&&y.data.serverResponse&&"SetSourceChannel"===y.data.serverResponse.command?new U_(N_.CROSS_CHANNEL_FAILED_JOIN_SRC):y.data&&y.data.serverResponse&&"SetDestChannelStatus"===y.serverResponse.command?new U_(N_.CROSS_CHANNEL_FAILED_JOIN_DEST):y.data&&y.data.serverResponse&&"StartPacketTransfer"===y.serverResponse.command?new U_(N_.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):y}A.prevChannelMediaConfig=p})()}updateChannelMediaRelay(p){var A=this;return f(function*(){if(A.state!==yN.RELAY_STATE_RUNNING)throw new U_(N_.INVALID_OPERATION);yield A.sendUpdateMessage(p),A.prevChannelMediaConfig=p})()}stopChannelMediaRelay(){var p=this;return f(function*(){yield p.sendStopRelayMessage(),h_.debug("[".concat(p.clientId,"] stopChannelMediaRelay: send stop message success")),p.state=yN.RELAY_STATE_IDLE,p.dispose()})()}dispose(){h_.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=JU.CancelToken.source(),this.state=yN.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}connect(){var p=this;return f(function*(){const A=yield function nde(s,p,A){return Zie.apply(this,arguments)}(p.joinInfo,p.cancelToken.token,p.httpRetryConfig);p.workerToken=A.workerToken,yield p.signal.connect(A.addressList),p.emit("event",PM.NETWORK_CONNECTED),p.signal.on("status",p.onStatus),p.signal.on("reconnecting",p.onReconnect)})()}sendStartRelayMessage(p){var A=this;return f(function*(){const y=A.genMessage(EO.StopPacketTransfer);yield A.signal.request(y),yield A.signal.waitStatus("Normal Quit"),h_.debug("[".concat(A.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const w=A.genMessage(EO.SetSdkProfile,p);yield A.signal.request(w),h_.debug("[".concat(A.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const $=A.genMessage(EO.SetSourceChannel,p);yield A.signal.request($),yield A.signal.waitStatus("SetSourceChannelStatus"),A.emit("event",PM.PACKET_JOINED_SRC_CHANNEL),h_.debug("[".concat(A.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const j=A.genMessage(EO.SetSourceUserId,p);yield A.signal.request(j),h_.debug("[".concat(A.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const _e=A.genMessage(EO.SetDestChannel,p);yield A.signal.request(_e),yield A.signal.waitStatus("SetDestChannelStatus"),A.emit("event",PM.PACKET_JOINED_DEST_CHANNEL),h_.debug("[".concat(A.clientId,"] startChannelMediaRelay: SetDestChannel success"));const K=A.genMessage(EO.StartPacketTransfer,p);yield A.signal.request(K),A.emit("event",PM.PACKET_SENT_TO_DEST_CHANNEL),A.state=yN.RELAY_STATE_RUNNING,h_.debug("[".concat(A.clientId,"] startChannelMediaRelay: StartPacketTransfer success"))})()}sendUpdateMessage(p){var A=this;return f(function*(){const y=A.genMessage(EO.UpdateDestChannel,p);yield A.signal.request(y),A.emit("event",PM.PACKET_UPDATE_DEST_CHANNEL),h_.debug("[".concat(A.clientId,"] sendUpdateMessage: UpdateDestChannel success"))})()}sendStopRelayMessage(){var p=this;return f(function*(){const A=p.genMessage(EO.StopPacketTransfer);yield p.signal.request(A),h_.debug("[".concat(p.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))})()}genMessage(p,A){const y=[],w=[],$=[];this.requestId+=1;const j={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:GO,sid:this.joinInfo.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};"4.11.1"===j.sdkVersion&&(j.sdkVersion="0.0.1");let _e=null,K=null;switch(p){case EO.SetSdkProfile:return j.clientRequest={command:"SetSdkProfile",type:"multi_channel"},j;case EO.SetSourceChannel:if(K=A&&A.getSrcChannelMediaInfo(),!K)throw new U_(N_.UNEXPECTED_ERROR,"can not find source config");return j.clientRequest={command:"SetSourceChannel",uid:"0",channelName:K.channelName,token:K.token||this.joinInfo.appId},j;case EO.SetSourceUserId:if(K=A&&A.getSrcChannelMediaInfo(),!K)throw new U_(N_.UNEXPECTED_ERROR,"can not find source config");return j.clientRequest={command:"SetSourceUserId",uid:K.uid+""},j;case EO.SetDestChannel:if(_e=A&&A.getDestChannelMediaInfo(),!_e)throw new U_(N_.UNEXPECTED_ERROR,"can not find dest config");return _e.forEach(_i=>{y.push(_i.channelName),w.push(_i.uid+""),$.push(_i.token||this.joinInfo.appId)}),j.clientRequest={command:"SetDestChannel",channelName:y,uid:w,token:$},j;case EO.StartPacketTransfer:return j.clientRequest={command:"StartPacketTransfer"},j;case EO.Reconnect:return j.clientRequest={command:"Reconnect"},j;case EO.StopPacketTransfer:return j.clientRequest={command:"StopPacketTransfer"},j;case EO.UpdateDestChannel:if(_e=A&&A.getDestChannelMediaInfo(),!_e)throw new U_(N_.UNEXPECTED_ERROR,"can not find dest config");return _e.forEach(_i=>{y.push(_i.channelName),w.push(_i.uid+""),$.push(_i.token||this.joinInfo.appId)}),j.clientRequest={command:"UpdateDestChannel",channelName:y,uid:w,token:$},j}return j}}var sY;let f2=TR("AgoraRTCPlayer","trackId")(sY=class{get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(s){s!==this._videoElementStatus&&(h_.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(s)),b6("debug",["HTMLVideoElement",this.trackId],"statusChange","".concat(this._videoElementStatus," => ").concat(s)),this._videoElementStatus=s)}constructor(s){a_(this,"trackId",void 0),a_(this,"config",void 0),a_(this,"onFirstVideoFrameDecoded",void 0),a_(this,"freezeTimeCounterList",[]),a_(this,"timeUpdatedCount",0),a_(this,"freezeTime",0),a_(this,"playbackTime",0),a_(this,"lastTimeUpdatedTime",0),a_(this,"videoTrack",void 0),a_(this,"container",void 0),a_(this,"videoElement",void 0),a_(this,"videoElementCheckInterval",void 0),a_(this,"_videoElementStatus",yO.NONE),a_(this,"slot",void 0),a_(this,"isGettingVideoDimensions",!1),a_(this,"handleVideoEvents",p=>{switch(p.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=yO.PLAYING;break;case"loadeddata":this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded();break;case"canplay":this.videoElementStatus=yO.CANPLAY;break;case"stalled":this.videoElementStatus=yO.STALLED;break;case"suspend":this.videoElementStatus=yO.SUSPEND;break;case"pause":this.videoElementStatus=yO.PAUSED,!r2()&&!WU()&&this.videoElement&&this.videoTrack&&"live"===this.videoTrack.readyState&&(h_.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),sI("debug",this,"video element paused, auto resume"),this.videoElement.play());break;case"waiting":this.videoElementStatus=yO.WAITING;break;case"abort":this.videoElementStatus=yO.ABORT;break;case"ended":this.videoElementStatus=yO.ENDED;break;case"emptied":this.videoElementStatus=yO.EMPTIED;break;case"timeupdate":{const A=Date.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=A);const y=A-this.lastTimeUpdatedTime;for(this.lastTimeUpdatedTime=A,y>500&&(this.freezeTime+=y),this.playbackTime+=y;this.playbackTime>=6e3;)this.playbackTime-=6e3,this.freezeTimeCounterList.push(Math.min(6e3,this.freezeTime)),this.freezeTime=Math.max(0,this.freezeTime-6e3);break}}}),a_(this,"startGetVideoDimensions",()=>{const p=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement&&this.videoElement.videoWidth*this.videoElement.videoHeight>4)return h_.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),S0("debug",this,"startGetVideoDimensions",{videoWidth:this.videoElement.videoWidth,videoHeight:this.videoElement.videoHeight}),void(this.isGettingVideoDimensions=!1);setTimeout(p,500)};!this.isGettingVideoDimensions&&p()}),a_(this,"autoResumeAfterInterruption",()=>{this.videoElement&&this.videoTrack&&"live"===this.videoTrack.readyState&&"running"===g1.curState&&(kM()?(h_.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.2")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):nfe()?(h_.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.1")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):tfe()&&(h_.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.0")),this.videoElement.pause(),this.videoElement.play()))}),a_(this,"autoResumeAfterInterruptionOnIOS15",()=>{this.videoElement&&this.videoTrack&&"live"===this.videoTrack.readyState&&(kM()?(h_.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.2")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):nfe()?(h_.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.1")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):tfe()&&(h_.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.0")),this.videoElement.pause(),this.videoElement.play()))}),this.slot=s.element,this.trackId=s.trackId,this.updateConfig(s),g1.on(US.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),g1.on(US.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15)}updateConfig(s){this.config=s,this.trackId=s.trackId;const p=s.element;p!==this.slot&&(this.destroy(),this.slot=p),this.createElements()}updateVideoTrack(s){this.videoTrack!==s&&(this.videoTrack=s,this.createElements())}play(s){if(this.videoElement){const p=this.videoElement.play();p&&p.catch&&p.catch(y=>{s&&w0.autoplayFailed(s,"video",y.message,this.trackId),S0("warning",this,"play",y.toString(),"error"),"NotAllowedError"===y.name?(h_.warning("detected video element autoplay failed",y),this.handleAutoPlayFailed()):h_.warning("[".concat(this.trackId,"] play warning: "),y)});const A=Y1();if(("Safari"===A.name&&15===Number(A.version)||rK())&&p&&p.then&&p.catch){const y=()=>{this.config.mirror&&this.videoElement&&(this.videoElement.style.transform="rotateY(180deg)")};p.then(y).catch(y)}}}getCurrentFrame(){if(!this.videoElement)return new ImageData(2,2);const s=document.createElement("canvas");s.width=this.videoElement.videoWidth,s.height=this.videoElement.videoHeight;const p=s.getContext("2d");if(!p)return h_.error("create canvas context failed!"),S0("error",this,"getCurrentFrame","create canvas context failed!","error"),new ImageData(2,2);p.drawImage(this.videoElement,0,0,s.width,s.height);const A=p.getImageData(0,0,s.width,s.height);return s.remove(),A}destroy(){if(g1.off(US.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),g1.off(US.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15),this.videoElement&&(this.videoElement.srcObject=null,this.videoElement.remove(),this.videoElement=void 0),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch(s){}this.container=void 0}this.freezeTimeCounterList=[]}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",this.createVideoElement(),this.container.appendChild(this.videoElement)):this.removeVideoElement(),this.slot.appendChild(this.container)}createVideoElement(){this.videoElement||(this.videoElementStatus=yO.INIT,this.videoElement=document.createElement("video"),this.videoElement.onerror=()=>this.videoElementStatus=yO.ERROR,this.container&&this.container.appendChild(this.videoElement),Cme.forEach(A=>{this.videoElement&&this.videoElement.addEventListener(A,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{!document.getElementById("video_".concat(this.trackId))&&this.videoElement&&(this.videoElementStatus=yO.DESTROYED)},1e3)),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),this.videoElement.style.left="0",this.videoElement.style.top="0";const s=Y1();"Safari"===s.name&&15===Number(s.version)||rK()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.videoElement.style.objectFit=this.config.fit?this.config.fit:"cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,X2()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,X2()&&this.videoElement.load());const p=this.videoElement.play();void 0!==p&&p.catch(A=>{h_.debug("[".concat(this.trackId,"] playback interrupted"),A.toString()),sI("debug",this,"play back interrupted: ".concat(A.toString()))})}removeVideoElement(){if(this.videoElement){Cme.forEach(s=>{this.videoElement&&this.videoElement.removeEventListener(s,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0);try{this.container&&this.container.removeChild(this.videoElement)}catch(s){}this.videoElement=void 0,this.videoElementStatus=yO.NONE}}handleAutoPlayFailed(){const s=Y1();if(this.videoElement){const p=A=>{A.preventDefault(),this.videoElement&&(this.videoElement.play().then(()=>{h_.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed.")),sI("debug",this,"video element autoplay resumed")}).catch(y=>{h_.error(y)}),"Android"!==s.os||"Chrome"!==s.name&&s.name!==C1.WECHAT?(document.body.removeEventListener("touchstart",p,!0),document.body.removeEventListener("mousedown",p,!0)):document.body.removeEventListener("click",p,!0))};"Android"!==s.os||"Chrome"!==s.name&&s.name!==C1.WECHAT?(document.body.addEventListener("touchstart",p,!0),document.body.addEventListener("mousedown",p,!0)):document.body.addEventListener("click",p,!0),eie()}}getVideoElement(){return this.videoElement}getContainerElement(){return this.container}})||sY;const Cme=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate"];var toe,eoe={exports:{}};function aY(s,p,A){const y=s.createShader(A);if(!y)return new U_(N_.WEBGL_INTERNAL_ERROR,"can not create shader").throw();if(s.shaderSource(y,p),s.compileShader(y),!s.getShaderParameter(y,s.COMPILE_STATUS)){const w=s.getShaderInfoLog(y);return s.deleteShader(y),new U_(N_.WEBGL_INTERNAL_ERROR,"error compiling shader:"+w).throw()}return y}(function(s,p){s.exports=(()=>{var A={3476:(j,_e,K)=>{j.exports=K(7460)},4341:(j,_e,K)=>{j.exports=K(3685)},3536:(j,_e,K)=>{var _i=K(1910);j.exports=_i},8171:(j,_e,K)=>{K(6450);var _i=K(4058).Object,_o=j.exports=function(_u,ch,_f){return _i.defineProperty(_u,ch,_f)};_i.defineProperty.sham&&(_o.sham=!0)},2956:(j,_e,K)=>{K(7627),K(6274),K(5967),K(8881),K(4560),K(7206),K(4349),K(7971);var _i=K(4058);j.exports=_i.Promise},3685:(j,_e,K)=>{var _i=K(3536);j.exports=_i},4883:(j,_e,K)=>{var _i=K(1899),_o=K(7475),_u=K(9826),ch=_i.TypeError;j.exports=function(_f){if(_o(_f))return _f;throw ch(_u(_f)+" is not a function")}},174:(j,_e,K)=>{var _i=K(1899),_o=K(4284),_u=K(9826),ch=_i.TypeError;j.exports=function(_f){if(_o(_f))return _f;throw ch(_u(_f)+" is not a constructor")}},1851:(j,_e,K)=>{var _i=K(1899),_o=K(7475),_u=_i.String,ch=_i.TypeError;j.exports=function(_f){if("object"==typeof _f||_o(_f))return _f;throw ch("Can't set "+_u(_f)+" as a prototype")}},8479:j=>{j.exports=function(){}},5743:(j,_e,K)=>{var _i=K(1899),_o=K(7046),_u=_i.TypeError;j.exports=function(ch,_f){if(_o(_f,ch))return ch;throw _u("Incorrect invocation")}},6059:(j,_e,K)=>{var _i=K(1899),_o=K(941),_u=_i.String,ch=_i.TypeError;j.exports=function(_f){if(_o(_f))return _f;throw ch(_u(_f)+" is not an object")}},1692:(j,_e,K)=>{var _i=K(4529),_o=K(9413),_u=K(623),ch=function(_f){return function(o_,i_,u_){var g_,__=_i(o_),w_=_u(__),k_=_o(u_,w_);if(_f&&i_!=i_){for(;w_>k_;)if((g_=__[k_++])!=g_)return!0}else for(;w_>k_;k_++)if((_f||k_ in __)&&__[k_]===i_)return _f||k_||0;return!_f&&-1}};j.exports={includes:ch(!0),indexOf:ch(!1)}},3765:(j,_e,K)=>{var _i=K(5329);j.exports=_i([].slice)},1385:(j,_e,K)=>{var _i=K(9813)("iterator"),_o=!1;try{var _u=0,ch={next:function(){return{done:!!_u++}},return:function(){_o=!0}};ch[_i]=function(){return this},Array.from(ch,function(){throw 2})}catch(_f){}j.exports=function(_f,o_){if(!o_&&!_o)return!1;var i_=!1;try{var u_={};u_[_i]=function(){return{next:function(){return{done:i_=!0}}}},_f(u_)}catch(g_){}return i_}},2532:(j,_e,K)=>{var _i=K(5329),_o=_i({}.toString),_u=_i("".slice);j.exports=function(ch){return _u(_o(ch),8,-1)}},9697:(j,_e,K)=>{var _i=K(1899),_o=K(2885),_u=K(7475),ch=K(2532),_f=K(9813)("toStringTag"),o_=_i.Object,i_="Arguments"==ch(function(){return arguments}());j.exports=_o?ch:function(u_){var g_,__,w_;return void 0===u_?"Undefined":null===u_?"Null":"string"==typeof(__=function(k_,Rv){try{return k_[Rv]}catch(f0){}}(g_=o_(u_),_f))?__:i_?ch(g_):"Object"==(w_=ch(g_))&&_u(g_.callee)?"Arguments":w_}},8694:(j,_e,K)=>{var _i=K(5329)("".replace),_o=String(Error("zxcasd").stack),_u=/\n\s*at [^:]*:[^\n]*/,ch=_u.test(_o);j.exports=function(_f,o_){if(ch&&"string"==typeof _f)for(;o_--;)_f=_i(_f,_u,"");return _f}},3489:(j,_e,K)=>{var _i=K(953),_o=K(1136),_u=K(9677),ch=K(5988);j.exports=function(_f,o_,i_){for(var u_=_o(o_),g_=ch.f,__=_u.f,w_=0;w_<u_.length;w_++){var k_=u_[w_];_i(_f,k_)||i_&&_i(i_,k_)||g_(_f,k_,__(o_,k_))}}},4160:(j,_e,K)=>{var _i=K(5981);j.exports=!_i(function(){function _o(){}return _o.prototype.constructor=null,Object.getPrototypeOf(new _o)!==_o.prototype})},1046:(j,_e,K)=>{var _i=K(5143).IteratorPrototype,_o=K(9290),_u=K(1887),ch=K(904),_f=K(2077),o_=function(){return this};j.exports=function(i_,u_,g_,__){var w_=u_+" Iterator";return i_.prototype=_o(_i,{next:_u(+!__,g_)}),ch(i_,w_,!1,!0),_f[w_]=o_,i_}},2029:(j,_e,K)=>{var _i=K(5746),_o=K(5988),_u=K(1887);j.exports=_i?function(ch,_f,o_){return _o.f(ch,_f,_u(1,o_))}:function(ch,_f,o_){return ch[_f]=o_,ch}},1887:j=>{j.exports=function(_e,K){return{enumerable:!(1&_e),configurable:!(2&_e),writable:!(4&_e),value:K}}},7771:(j,_e,K)=>{var _i=K(6887),_o=K(8834),_u=K(2529),ch=K(9417),_f=K(7475),o_=K(1046),i_=K(249),u_=K(8929),g_=K(904),__=K(2029),w_=K(9754),k_=K(9813),Rv=K(2077),f0=K(5143),y0=ch.PROPER,b0=ch.CONFIGURABLE,rI=f0.IteratorPrototype,q0=f0.BUGGY_SAFARI_ITERATORS,Z0=k_("iterator"),j_="values",Z_="entries",o0=function(){return this};j.exports=function(z0,q_,X_,u0,B0,$0,A0){o_(X_,q_,u0);var e_,y_,D_,d0=function(UR){if(UR===B0&&q1)return q1;if(!q0&&UR in MI)return MI[UR];switch(UR){case"keys":case j_:case Z_:return function(){return new X_(this,UR)}}return function(){return new X_(this)}},K0=q_+" Iterator",FI=!1,MI=z0.prototype,WI=MI[Z0]||MI["@@iterator"]||B0&&MI[B0],q1=!q0&&WI||d0(B0),JO="Array"==q_&&MI.entries||WI;if(JO&&(e_=i_(JO.call(new z0)))!==Object.prototype&&e_.next&&(_u||i_(e_)===rI||(u_?u_(e_,rI):_f(e_[Z0])||w_(e_,Z0,o0)),g_(e_,K0,!0,!0),_u&&(Rv[K0]=o0)),y0&&B0==j_&&WI&&WI.name!==j_&&(!_u&&b0?__(MI,"name",j_):(FI=!0,q1=function(){return _o(WI,this)})),B0)if(y_={values:d0(j_),keys:$0?q1:d0("keys"),entries:d0(Z_)},A0)for(D_ in y_)(q0||FI||!(D_ in MI))&&w_(MI,D_,y_[D_]);else _i({target:q_,proto:!0,forced:q0||FI},y_);return _u&&!A0||MI[Z0]===q1||w_(MI,Z0,q1,{name:B0}),Rv[q_]=q1,y_}},5746:(j,_e,K)=>{var _i=K(5981);j.exports=!_i(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})},1333:(j,_e,K)=>{var _i=K(1899),_o=K(941),_u=_i.document,ch=_o(_u)&&_o(_u.createElement);j.exports=function(_f){return ch?_u.createElement(_f):{}}},3281:j=>{j.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},3321:j=>{j.exports="object"==typeof window},4470:(j,_e,K)=>{var _i=K(2861),_o=K(1899);j.exports=/ipad|iphone|ipod/i.test(_i)&&void 0!==_o.Pebble},2749:(j,_e,K)=>{var _i=K(2861);j.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(_i)},6049:(j,_e,K)=>{var _i=K(2532),_o=K(1899);j.exports="process"==_i(_o.process)},8045:(j,_e,K)=>{var _i=K(2861);j.exports=/web0s(?!.*chrome)/i.test(_i)},2861:(j,_e,K)=>{var _i=K(626);j.exports=_i("navigator","userAgent")||""},3385:(j,_e,K)=>{var _i,_o,_u=K(1899),ch=K(2861),_f=_u.process,o_=_u.Deno,i_=_f&&_f.versions||o_&&o_.version,u_=i_&&i_.v8;u_&&(_o=(_i=u_.split("."))[0]>0&&_i[0]<4?1:+(_i[0]+_i[1])),!_o&&ch&&(!(_i=ch.match(/Edge\/(\d+)/))||_i[1]>=74)&&(_i=ch.match(/Chrome\/(\d+)/))&&(_o=+_i[1]),j.exports=_o},6759:j=>{j.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8780:(j,_e,K)=>{var _i=K(5981),_o=K(1887);j.exports=!_i(function(){var _u=Error("a");return!("stack"in _u)||(Object.defineProperty(_u,"stack",_o(1,7)),7!==_u.stack)})},6887:(j,_e,K)=>{var _i=K(1899),_o=K(9730),_u=K(5329),ch=K(7475),_f=K(9677).f,o_=K(7252),i_=K(4058),u_=K(6843),g_=K(2029),__=K(953),w_=function(k_){var Rv=function(f0,y0,b0){if(this instanceof Rv){switch(arguments.length){case 0:return new k_;case 1:return new k_(f0);case 2:return new k_(f0,y0)}return new k_(f0,y0,b0)}return _o(k_,this,arguments)};return Rv.prototype=k_.prototype,Rv};j.exports=function(k_,Rv){var f0,y0,b0,rI,q0,Z0,a0,j_,Z_=k_.target,o0=k_.global,z0=k_.stat,q_=k_.proto,X_=o0?_i:z0?_i[Z_]:(_i[Z_]||{}).prototype,u0=o0?i_:i_[Z_]||g_(i_,Z_,{})[Z_],B0=u0.prototype;for(b0 in Rv)f0=!o_(o0?b0:Z_+(z0?".":"#")+b0,k_.forced)&&X_&&__(X_,b0),q0=u0[b0],f0&&(Z0=k_.noTargetGet?(j_=_f(X_,b0))&&j_.value:X_[b0]),rI=f0&&Z0?Z0:Rv[b0],f0&&typeof q0==typeof rI||(a0=k_.bind&&f0?u_(rI,_i):k_.wrap&&f0?w_(rI):q_&&ch(rI)?_u(rI):rI,(k_.sham||rI&&rI.sham||q0&&q0.sham)&&g_(a0,"sham",!0),g_(u0,b0,a0),q_&&(__(i_,y0=Z_+"Prototype")||g_(i_,y0,{}),g_(i_[y0],b0,rI),k_.real&&B0&&!B0[b0]&&g_(B0,b0,rI)))}},5981:j=>{j.exports=function(_e){try{return!!_e()}catch(K){return!0}}},9730:(j,_e,K)=>{var _i=K(8285),_o=Function.prototype,_u=_o.apply,ch=_o.call;j.exports="object"==typeof Reflect&&Reflect.apply||(_i?ch.bind(_u):function(){return ch.apply(_u,arguments)})},6843:(j,_e,K)=>{var _i=K(5329),_o=K(4883),_u=K(8285),ch=_i(_i.bind);j.exports=function(_f,o_){return _o(_f),void 0===o_?_f:_u?ch(_f,o_):function(){return _f.apply(o_,arguments)}}},8285:(j,_e,K)=>{var _i=K(5981);j.exports=!_i(function(){var _o=function(){}.bind();return"function"!=typeof _o||_o.hasOwnProperty("prototype")})},8834:(j,_e,K)=>{var _i=K(8285),_o=Function.prototype.call;j.exports=_i?_o.bind(_o):function(){return _o.apply(_o,arguments)}},9417:(j,_e,K)=>{var _i=K(5746),_o=K(953),_u=Function.prototype,ch=_i&&Object.getOwnPropertyDescriptor,_f=_o(_u,"name"),o_=_f&&"something"===function(){}.name,i_=_f&&(!_i||_i&&ch(_u,"name").configurable);j.exports={EXISTS:_f,PROPER:o_,CONFIGURABLE:i_}},5329:(j,_e,K)=>{var _i=K(8285),_o=Function.prototype,ch=_o.call,_f=_i&&_o.bind.bind(ch,ch);j.exports=_i?function(o_){return o_&&_f(o_)}:function(o_){return o_&&function(){return ch.apply(o_,arguments)}}},626:(j,_e,K)=>{var _i=K(4058),_o=K(1899),_u=K(7475),ch=function(_f){return _u(_f)?_f:void 0};j.exports=function(_f,o_){return arguments.length<2?ch(_i[_f])||ch(_o[_f]):_i[_f]&&_i[_f][o_]||_o[_f]&&_o[_f][o_]}},2902:(j,_e,K)=>{var _i=K(9697),_o=K(4229),_u=K(2077),ch=K(9813)("iterator");j.exports=function(_f){if(null!=_f)return _o(_f,ch)||_o(_f,"@@iterator")||_u[_i(_f)]}},429:(j,_e,K)=>{var _i=K(1899),_o=K(8834),_u=K(4883),ch=K(6059),_f=K(9826),o_=K(2902),i_=_i.TypeError;j.exports=function(u_,g_){var __=arguments.length<2?o_(u_):g_;if(_u(__))return ch(_o(__,u_));throw i_(_f(u_)+" is not iterable")}},4229:(j,_e,K)=>{var _i=K(4883);j.exports=function(_o,_u){var ch=_o[_u];return null==ch?void 0:_i(ch)}},1899:(j,_e,K)=>{var _i=function(_o){return _o&&_o.Math==Math&&_o};j.exports=_i("object"==typeof globalThis&&globalThis)||_i("object"==typeof window&&window)||_i("object"==typeof self&&self)||_i("object"==typeof K.g&&K.g)||function(){return this}()||Function("return this")()},953:(j,_e,K)=>{var _i=K(5329),_o=K(9678),_u=_i({}.hasOwnProperty);j.exports=Object.hasOwn||function(ch,_f){return _u(_o(ch),_f)}},7748:j=>{j.exports={}},4845:(j,_e,K)=>{var _i=K(1899);j.exports=function(_o,_u){var ch=_i.console;ch&&ch.error&&(1==arguments.length?ch.error(_o):ch.error(_o,_u))}},5463:(j,_e,K)=>{var _i=K(626);j.exports=_i("document","documentElement")},2840:(j,_e,K)=>{var _i=K(5746),_o=K(5981),_u=K(1333);j.exports=!_i&&!_o(function(){return 7!=Object.defineProperty(_u("div"),"a",{get:function(){return 7}}).a})},7026:(j,_e,K)=>{var _i=K(1899),_o=K(5329),_u=K(5981),ch=K(2532),_f=_i.Object,o_=_o("".split);j.exports=_u(function(){return!_f("z").propertyIsEnumerable(0)})?function(i_){return"String"==ch(i_)?o_(i_,""):_f(i_)}:_f},1302:(j,_e,K)=>{var _i=K(5329),_o=K(7475),_u=K(3030),ch=_i(Function.toString);_o(_u.inspectSource)||(_u.inspectSource=function(_f){return ch(_f)}),j.exports=_u.inspectSource},3794:(j,_e,K)=>{var _i=K(941),_o=K(2029);j.exports=function(_u,ch){_i(ch)&&"cause"in ch&&_o(_u,"cause",ch.cause)}},5402:(j,_e,K)=>{var _i,_o,_u,ch=K(8019),_f=K(1899),o_=K(5329),i_=K(941),u_=K(2029),g_=K(953),__=K(3030),w_=K(4262),k_=K(7748),Rv="Object already initialized",f0=_f.TypeError;if(ch||__.state){var b0=__.state||(__.state=new(0,_f.WeakMap)),rI=o_(b0.get),q0=o_(b0.has),Z0=o_(b0.set);_i=function(j_,Z_){if(q0(b0,j_))throw new f0(Rv);return Z_.facade=j_,Z0(b0,j_,Z_),Z_},_o=function(j_){return rI(b0,j_)||{}},_u=function(j_){return q0(b0,j_)}}else{var a0=w_("state");k_[a0]=!0,_i=function(j_,Z_){if(g_(j_,a0))throw new f0(Rv);return Z_.facade=j_,u_(j_,a0,Z_),Z_},_o=function(j_){return g_(j_,a0)?j_[a0]:{}},_u=function(j_){return g_(j_,a0)}}j.exports={set:_i,get:_o,has:_u,enforce:function(j_){return _u(j_)?_o(j_):_i(j_,{})},getterFor:function(j_){return function(Z_){var o0;if(!i_(Z_)||(o0=_o(Z_)).type!==j_)throw f0("Incompatible receiver, "+j_+" required");return o0}}}},6782:(j,_e,K)=>{var _i=K(9813),_o=K(2077),_u=_i("iterator"),ch=Array.prototype;j.exports=function(_f){return void 0!==_f&&(_o.Array===_f||ch[_u]===_f)}},7475:j=>{j.exports=function(_e){return"function"==typeof _e}},4284:(j,_e,K)=>{var _i=K(5329),_o=K(5981),_u=K(7475),ch=K(9697),_f=K(626),o_=K(1302),i_=function(){},u_=[],g_=_f("Reflect","construct"),__=/^\s*(?:class|function)\b/,w_=_i(__.exec),k_=!__.exec(i_),Rv=function(y0){if(!_u(y0))return!1;try{return g_(i_,u_,y0),!0}catch(b0){return!1}},f0=function(y0){if(!_u(y0))return!1;switch(ch(y0)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return k_||!!w_(__,o_(y0))}catch(b0){return!0}};f0.sham=!0,j.exports=!g_||_o(function(){var y0;return Rv(Rv.call)||!Rv(Object)||!Rv(function(){y0=!0})||y0})?f0:Rv},7252:(j,_e,K)=>{var _i=K(5981),_o=K(7475),_u=/#|\.prototype\./,ch=function(g_,__){var w_=o_[_f(g_)];return w_==u_||w_!=i_&&(_o(__)?_i(__):!!__)},_f=ch.normalize=function(g_){return String(g_).replace(_u,".").toLowerCase()},o_=ch.data={},i_=ch.NATIVE="N",u_=ch.POLYFILL="P";j.exports=ch},941:(j,_e,K)=>{var _i=K(7475);j.exports=function(_o){return"object"==typeof _o?null!==_o:_i(_o)}},2529:j=>{j.exports=!0},6664:(j,_e,K)=>{var _i=K(1899),_o=K(626),_u=K(7475),ch=K(7046),_f=K(2302),o_=_i.Object;j.exports=_f?function(i_){return"symbol"==typeof i_}:function(i_){var u_=_o("Symbol");return _u(u_)&&ch(u_.prototype,o_(i_))}},3091:(j,_e,K)=>{var _i=K(1899),_o=K(6843),_u=K(8834),ch=K(6059),_f=K(9826),o_=K(6782),i_=K(623),u_=K(7046),g_=K(429),__=K(2902),w_=K(7609),k_=_i.TypeError,Rv=function(y0,b0){this.stopped=y0,this.result=b0},f0=Rv.prototype;j.exports=function(y0,b0,rI){var q0,Z0,a0,j_,Z_,o0,z0,X_=!(!rI||!rI.AS_ENTRIES),u0=!(!rI||!rI.IS_ITERATOR),B0=!(!rI||!rI.INTERRUPTED),$0=_o(b0,rI&&rI.that),A0=function(y_){return q0&&w_(q0,"normal",y_),new Rv(!0,y_)},e_=function(y_){return X_?(ch(y_),B0?$0(y_[0],y_[1],A0):$0(y_[0],y_[1])):B0?$0(y_,A0):$0(y_)};if(u0)q0=y0;else{if(!(Z0=__(y0)))throw k_(_f(y0)+" is not iterable");if(o_(Z0)){for(a0=0,j_=i_(y0);j_>a0;a0++)if((Z_=e_(y0[a0]))&&u_(f0,Z_))return Z_;return new Rv(!1)}q0=g_(y0,Z0)}for(o0=q0.next;!(z0=_u(o0,q0)).done;){try{Z_=e_(z0.value)}catch(y_){w_(q0,"throw",y_)}if("object"==typeof Z_&&Z_&&u_(f0,Z_))return Z_}return new Rv(!1)}},7609:(j,_e,K)=>{var _i=K(8834),_o=K(6059),_u=K(4229);j.exports=function(ch,_f,o_){var i_,u_;_o(ch);try{if(!(i_=_u(ch,"return"))){if("throw"===_f)throw o_;return o_}i_=_i(i_,ch)}catch(g_){u_=!0,i_=g_}if("throw"===_f)throw o_;if(u_)throw i_;return _o(i_),o_}},5143:(j,_e,K)=>{var _i,_o,_u,ch=K(5981),_f=K(7475),o_=K(9290),i_=K(249),u_=K(9754),g_=K(9813),__=K(2529),w_=g_("iterator"),k_=!1;[].keys&&("next"in(_u=[].keys())?(_o=i_(i_(_u)))!==Object.prototype&&(_i=_o):k_=!0),null==_i||ch(function(){var Rv={};return _i[w_].call(Rv)!==Rv})?_i={}:__&&(_i=o_(_i)),_f(_i[w_])||u_(_i,w_,function(){return this}),j.exports={IteratorPrototype:_i,BUGGY_SAFARI_ITERATORS:k_}},2077:j=>{j.exports={}},623:(j,_e,K)=>{var _i=K(3057);j.exports=function(_o){return _i(_o.length)}},6132:(j,_e,K)=>{var _i,_o,_u,ch,_f,o_,i_,u_,g_=K(1899),__=K(6843),w_=K(9677).f,k_=K(2941).set,Rv=K(2749),f0=K(4470),y0=K(8045),b0=K(6049),rI=g_.MutationObserver||g_.WebKitMutationObserver,q0=g_.document,Z0=g_.process,a0=g_.Promise,j_=w_(g_,"queueMicrotask"),Z_=j_&&j_.value;Z_||(_i=function(){var o0,z0;for(b0&&(o0=Z0.domain)&&o0.exit();_o;){z0=_o.fn,_o=_o.next;try{z0()}catch(q_){throw _o?ch():_u=void 0,q_}}_u=void 0,o0&&o0.enter()},Rv||b0||y0||!rI||!q0?!f0&&a0&&a0.resolve?((i_=a0.resolve(void 0)).constructor=a0,u_=__(i_.then,i_),ch=function(){u_(_i)}):b0?ch=function(){Z0.nextTick(_i)}:(k_=__(k_,g_),ch=function(){k_(_i)}):(_f=!0,o_=q0.createTextNode(""),new rI(_i).observe(o_,{characterData:!0}),ch=function(){o_.data=_f=!_f})),j.exports=Z_||function(o0){var z0={fn:o0,next:void 0};_u&&(_u.next=z0),_o||(_o=z0,ch()),_u=z0}},9297:(j,_e,K)=>{var _i=K(1899);j.exports=_i.Promise},2497:(j,_e,K)=>{var _i=K(3385),_o=K(5981);j.exports=!!Object.getOwnPropertySymbols&&!_o(function(){var _u=Symbol();return!String(_u)||!(Object(_u)instanceof Symbol)||!Symbol.sham&&_i&&_i<41})},8019:(j,_e,K)=>{var _i=K(1899),_o=K(7475),_u=K(1302),ch=_i.WeakMap;j.exports=_o(ch)&&/native code/.test(_u(ch))},9520:(j,_e,K)=>{var _i=K(4883),_o=function(_u){var ch,_f;this.promise=new _u(function(o_,i_){if(void 0!==ch||void 0!==_f)throw TypeError("Bad Promise constructor");ch=o_,_f=i_}),this.resolve=_i(ch),this.reject=_i(_f)};j.exports.f=function(_u){return new _o(_u)}},4649:(j,_e,K)=>{var _i=K(5803);j.exports=function(_o,_u){return void 0===_o?arguments.length<2?"":_u:_i(_o)}},9290:(j,_e,K)=>{var _i,_o=K(6059),_u=K(9938),ch=K(6759),_f=K(7748),o_=K(5463),i_=K(1333),u_=K(4262)("IE_PROTO"),g_=function(){},__=function(Rv){return"<script>"+Rv+"<\/script>"},w_=function(Rv){Rv.write(__("")),Rv.close();var f0=Rv.parentWindow.Object;return Rv=null,f0},k_=function(){try{_i=new ActiveXObject("htmlfile")}catch(b0){}var Rv,f0;k_="undefined"!=typeof document?document.domain&&_i?w_(_i):((f0=i_("iframe")).style.display="none",o_.appendChild(f0),f0.src=String("javascript:"),(Rv=f0.contentWindow.document).open(),Rv.write(__("document.F=Object")),Rv.close(),Rv.F):w_(_i);for(var y0=ch.length;y0--;)delete k_.prototype[ch[y0]];return k_()};_f[u_]=!0,j.exports=Object.create||function(Rv,f0){var y0;return null!==Rv?(g_.prototype=_o(Rv),y0=new g_,g_.prototype=null,y0[u_]=Rv):y0=k_(),void 0===f0?y0:_u.f(y0,f0)}},9938:(j,_e,K)=>{var _i=K(5746),_o=K(3937),_u=K(5988),ch=K(6059),_f=K(4529),o_=K(4771);_e.f=_i&&!_o?Object.defineProperties:function(i_,u_){ch(i_);for(var g_,__=_f(u_),w_=o_(u_),k_=w_.length,Rv=0;k_>Rv;)_u.f(i_,g_=w_[Rv++],__[g_]);return i_}},5988:(j,_e,K)=>{var _i=K(1899),_o=K(5746),_u=K(2840),ch=K(3937),_f=K(6059),o_=K(3894),i_=_i.TypeError,u_=Object.defineProperty,g_=Object.getOwnPropertyDescriptor;_e.f=_o?ch?function(__,w_,k_){if(_f(__),w_=o_(w_),_f(k_),"function"==typeof __&&"prototype"===w_&&"value"in k_&&"writable"in k_&&!k_.writable){var Rv=g_(__,w_);Rv&&Rv.writable&&(__[w_]=k_.value,k_={configurable:"configurable"in k_?k_.configurable:Rv.configurable,enumerable:"enumerable"in k_?k_.enumerable:Rv.enumerable,writable:!1})}return u_(__,w_,k_)}:u_:function(__,w_,k_){if(_f(__),w_=o_(w_),_f(k_),_u)try{return u_(__,w_,k_)}catch(Rv){}if("get"in k_||"set"in k_)throw i_("Accessors not supported");return"value"in k_&&(__[w_]=k_.value),__}},9677:(j,_e,K)=>{var _i=K(5746),_o=K(8834),_u=K(6760),ch=K(1887),_f=K(4529),o_=K(3894),i_=K(953),u_=K(2840),g_=Object.getOwnPropertyDescriptor;_e.f=_i?g_:function(__,w_){if(__=_f(__),w_=o_(w_),u_)try{return g_(__,w_)}catch(k_){}if(i_(__,w_))return ch(!_o(_u.f,__,w_),__[w_])}},946:(j,_e,K)=>{var _i=K(5629),_o=K(6759).concat("length","prototype");_e.f=Object.getOwnPropertyNames||function(_u){return _i(_u,_o)}},7857:(j,_e)=>{_e.f=Object.getOwnPropertySymbols},249:(j,_e,K)=>{var _i=K(1899),_o=K(953),_u=K(7475),ch=K(9678),_f=K(4262),o_=K(4160),i_=_f("IE_PROTO"),u_=_i.Object,g_=u_.prototype;j.exports=o_?u_.getPrototypeOf:function(__){var w_=ch(__);if(_o(w_,i_))return w_[i_];var k_=w_.constructor;return _u(k_)&&w_ instanceof k_?k_.prototype:w_ instanceof u_?g_:null}},7046:(j,_e,K)=>{var _i=K(5329);j.exports=_i({}.isPrototypeOf)},5629:(j,_e,K)=>{var _i=K(5329),_o=K(953),_u=K(4529),ch=K(1692).indexOf,_f=K(7748),o_=_i([].push);j.exports=function(i_,u_){var g_,__=_u(i_),w_=0,k_=[];for(g_ in __)!_o(_f,g_)&&_o(__,g_)&&o_(k_,g_);for(;u_.length>w_;)_o(__,g_=u_[w_++])&&(~ch(k_,g_)||o_(k_,g_));return k_}},4771:(j,_e,K)=>{var _i=K(5629),_o=K(6759);j.exports=Object.keys||function(_u){return _i(_u,_o)}},6760:(j,_e)=>{var K={}.propertyIsEnumerable,_i=Object.getOwnPropertyDescriptor,_o=_i&&!K.call({1:2},1);_e.f=_o?function(_u){var ch=_i(this,_u);return!!ch&&ch.enumerable}:K},8929:(j,_e,K)=>{var _i=K(5329),_o=K(6059),_u=K(1851);j.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var ch,_f=!1,o_={};try{(ch=_i(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(o_,[]),_f=o_ instanceof Array}catch(i_){}return function(i_,u_){return _o(i_),_u(u_),_f?ch(i_,u_):i_.__proto__=u_,i_}}():void 0)},5623:(j,_e,K)=>{var _i=K(2885),_o=K(9697);j.exports=_i?{}.toString:function(){return"[object "+_o(this)+"]"}},9811:(j,_e,K)=>{var _i=K(1899),_o=K(8834),_u=K(7475),ch=K(941),_f=_i.TypeError;j.exports=function(o_,i_){var u_,g_;if("string"===i_&&_u(u_=o_.toString)&&!ch(g_=_o(u_,o_))||_u(u_=o_.valueOf)&&!ch(g_=_o(u_,o_))||"string"!==i_&&_u(u_=o_.toString)&&!ch(g_=_o(u_,o_)))return g_;throw _f("Can't convert object to primitive value")}},1136:(j,_e,K)=>{var _i=K(626),_o=K(5329),_u=K(946),ch=K(7857),_f=K(6059),o_=_o([].concat);j.exports=_i("Reflect","ownKeys")||function(i_){var u_=_u.f(_f(i_)),g_=ch.f;return g_?o_(u_,g_(i_)):u_}},4058:j=>{j.exports={}},2:j=>{j.exports=function(_e){try{return{error:!1,value:_e()}}catch(K){return{error:!0,value:K}}}},6584:(j,_e,K)=>{var _i=K(6059),_o=K(941),_u=K(9520);j.exports=function(ch,_f){if(_i(ch),_o(_f)&&_f.constructor===ch)return _f;var o_=_u.f(ch);return(0,o_.resolve)(_f),o_.promise}},8397:j=>{var _e=function(){this.head=null,this.tail=null};_e.prototype={add:function(K){var _i={item:K,next:null};this.head?this.tail.next=_i:this.head=_i,this.tail=_i},get:function(){var K=this.head;if(K)return this.head=K.next,this.tail===K&&(this.tail=null),K.item}},j.exports=_e},7524:(j,_e,K)=>{var _i=K(9754);j.exports=function(_o,_u,ch){for(var _f in _u)ch&&ch.unsafe&&_o[_f]?_o[_f]=_u[_f]:_i(_o,_f,_u[_f],ch);return _o}},9754:(j,_e,K)=>{var _i=K(2029);j.exports=function(_o,_u,ch,_f){_f&&_f.enumerable?_o[_u]=ch:_i(_o,_u,ch)}},8219:(j,_e,K)=>{var _i=K(1899).TypeError;j.exports=function(_o){if(null==_o)throw _i("Can't call method on "+_o);return _o}},4911:(j,_e,K)=>{var _i=K(1899),_o=Object.defineProperty;j.exports=function(_u,ch){try{_o(_i,_u,{value:ch,configurable:!0,writable:!0})}catch(_f){_i[_u]=ch}return ch}},4431:(j,_e,K)=>{var _i=K(626),_o=K(5988),_u=K(9813),ch=K(5746),_f=_u("species");j.exports=function(o_){var i_=_i(o_);ch&&i_&&!i_[_f]&&(0,_o.f)(i_,_f,{configurable:!0,get:function(){return this}})}},904:(j,_e,K)=>{var _i=K(2885),_o=K(5988).f,_u=K(2029),ch=K(953),_f=K(5623),o_=K(9813)("toStringTag");j.exports=function(i_,u_,g_,__){if(i_){var w_=g_?i_:i_.prototype;ch(w_,o_)||_o(w_,o_,{configurable:!0,value:u_}),__&&!_i&&_u(w_,"toString",_f)}}},4262:(j,_e,K)=>{var _i=K(8726),_o=K(9418),_u=_i("keys");j.exports=function(ch){return _u[ch]||(_u[ch]=_o(ch))}},3030:(j,_e,K)=>{var _i=K(1899),_o=K(4911),_u="__core-js_shared__",ch=_i[_u]||_o(_u,{});j.exports=ch},8726:(j,_e,K)=>{var _i=K(2529),_o=K(3030);(j.exports=function(_u,ch){return _o[_u]||(_o[_u]=void 0!==ch?ch:{})})("versions",[]).push({version:"3.20.3",mode:_i?"pure":"global",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"})},487:(j,_e,K)=>{var _i=K(6059),_o=K(174),_u=K(9813)("species");j.exports=function(ch,_f){var o_,i_=_i(ch).constructor;return void 0===i_||null==(o_=_i(i_)[_u])?_f:_o(o_)}},4620:(j,_e,K)=>{var _i=K(5329),_o=K(2435),_u=K(5803),ch=K(8219),_f=_i("".charAt),o_=_i("".charCodeAt),i_=_i("".slice),u_=function(g_){return function(__,w_){var k_,Rv,f0=_u(ch(__)),y0=_o(w_),b0=f0.length;return y0<0||y0>=b0?g_?"":void 0:(k_=o_(f0,y0))<55296||k_>56319||y0+1===b0||(Rv=o_(f0,y0+1))<56320||Rv>57343?g_?_f(f0,y0):k_:g_?i_(f0,y0,y0+2):Rv-56320+(k_-55296<<10)+65536}};j.exports={codeAt:u_(!1),charAt:u_(!0)}},2941:(j,_e,K)=>{var _i,_o,_u,ch,_f=K(1899),o_=K(9730),i_=K(6843),u_=K(7475),g_=K(953),__=K(5981),w_=K(5463),k_=K(3765),Rv=K(1333),f0=K(2749),y0=K(6049),b0=_f.setImmediate,rI=_f.clearImmediate,q0=_f.process,Z0=_f.Dispatch,a0=_f.Function,j_=_f.MessageChannel,Z_=_f.String,o0=0,z0={};try{_i=_f.location}catch($0){}var q_=function($0){if(g_(z0,$0)){var A0=z0[$0];delete z0[$0],A0()}},X_=function($0){return function(){q_($0)}},u0=function($0){q_($0.data)},B0=function($0){_f.postMessage(Z_($0),_i.protocol+"//"+_i.host)};b0&&rI||(b0=function($0){var A0=k_(arguments,1);return z0[++o0]=function(){o_(u_($0)?$0:a0($0),void 0,A0)},_o(o0),o0},rI=function($0){delete z0[$0]},y0?_o=function($0){q0.nextTick(X_($0))}:Z0&&Z0.now?_o=function($0){Z0.now(X_($0))}:j_&&!f0?(ch=(_u=new j_).port2,_u.port1.onmessage=u0,_o=i_(ch.postMessage,ch)):_f.addEventListener&&u_(_f.postMessage)&&!_f.importScripts&&_i&&"file:"!==_i.protocol&&!__(B0)?(_o=B0,_f.addEventListener("message",u0,!1)):_o="onreadystatechange"in Rv("script")?function($0){w_.appendChild(Rv("script")).onreadystatechange=function(){w_.removeChild(this),q_($0)}}:function($0){setTimeout(X_($0),0)}),j.exports={set:b0,clear:rI}},9413:(j,_e,K)=>{var _i=K(2435),_o=Math.max,_u=Math.min;j.exports=function(ch,_f){var o_=_i(ch);return o_<0?_o(o_+_f,0):_u(o_,_f)}},4529:(j,_e,K)=>{var _i=K(7026),_o=K(8219);j.exports=function(_u){return _i(_o(_u))}},2435:j=>{var _e=Math.ceil,K=Math.floor;j.exports=function(_i){var _o=+_i;return _o!=_o||0===_o?0:(_o>0?K:_e)(_o)}},3057:(j,_e,K)=>{var _i=K(2435),_o=Math.min;j.exports=function(_u){return _u>0?_o(_i(_u),9007199254740991):0}},9678:(j,_e,K)=>{var _i=K(1899),_o=K(8219),_u=_i.Object;j.exports=function(ch){return _u(_o(ch))}},6935:(j,_e,K)=>{var _i=K(1899),_o=K(8834),_u=K(941),ch=K(6664),_f=K(4229),o_=K(9811),i_=K(9813),u_=_i.TypeError,g_=i_("toPrimitive");j.exports=function(__,w_){if(!_u(__)||ch(__))return __;var k_,Rv=_f(__,g_);if(Rv){if(void 0===w_&&(w_="default"),k_=_o(Rv,__,w_),!_u(k_)||ch(k_))return k_;throw u_("Can't convert object to primitive value")}return void 0===w_&&(w_="number"),o_(__,w_)}},3894:(j,_e,K)=>{var _i=K(6935),_o=K(6664);j.exports=function(_u){var ch=_i(_u,"string");return _o(ch)?ch:ch+""}},2885:(j,_e,K)=>{var _i={};_i[K(9813)("toStringTag")]="z",j.exports="[object z]"===String(_i)},5803:(j,_e,K)=>{var _i=K(1899),_o=K(9697),_u=_i.String;j.exports=function(ch){if("Symbol"===_o(ch))throw TypeError("Cannot convert a Symbol value to a string");return _u(ch)}},9826:(j,_e,K)=>{var _i=K(1899).String;j.exports=function(_o){try{return _i(_o)}catch(_u){return"Object"}}},9418:(j,_e,K)=>{var _i=K(5329),_o=0,_u=Math.random(),ch=_i(1..toString);j.exports=function(_f){return"Symbol("+(void 0===_f?"":_f)+")_"+ch(++_o+_u,36)}},2302:(j,_e,K)=>{var _i=K(2497);j.exports=_i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3937:(j,_e,K)=>{var _i=K(5746),_o=K(5981);j.exports=_i&&_o(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},9813:(j,_e,K)=>{var _i=K(1899),_o=K(8726),_u=K(953),ch=K(9418),_f=K(2497),o_=K(2302),i_=_o("wks"),u_=_i.Symbol,g_=u_&&u_.for,__=o_?u_:u_&&u_.withoutSetter||ch;j.exports=function(w_){if(!_u(i_,w_)||!_f&&"string"!=typeof i_[w_]){var k_="Symbol."+w_;i_[w_]=_f&&_u(u_,w_)?u_[w_]:o_&&g_?g_(k_):__(k_)}return i_[w_]}},7627:(j,_e,K)=>{var _i=K(6887),_o=K(1899),_u=K(7046),ch=K(249),_f=K(8929),o_=K(3489),i_=K(9290),u_=K(2029),g_=K(1887),__=K(8694),w_=K(3794),k_=K(3091),Rv=K(4649),f0=K(9813),y0=K(8780),b0=f0("toStringTag"),rI=_o.Error,q0=[].push,Z0=function(j_,Z_){var o0,z0=arguments.length>2?arguments[2]:void 0,q_=_u(a0,this);_f?o0=_f(new rI,q_?ch(this):a0):(o0=q_?this:i_(a0),u_(o0,b0,"Error")),void 0!==Z_&&u_(o0,"message",Rv(Z_)),y0&&u_(o0,"stack",__(o0.stack,1)),w_(o0,z0);var X_=[];return k_(j_,q0,{that:X_}),u_(o0,"errors",X_),o0};_f?_f(Z0,rI):o_(Z0,rI,{name:!0});var a0=Z0.prototype=i_(rI.prototype,{constructor:g_(1,Z0),message:g_(1,""),name:g_(1,"AggregateError")});_i({global:!0},{AggregateError:Z0})},6274:(j,_e,K)=>{var _i=K(4529),_o=K(8479),_u=K(2077),ch=K(5402),_f=K(5988).f,o_=K(7771),i_=K(2529),u_=K(5746),g_="Array Iterator",__=ch.set,w_=ch.getterFor(g_);j.exports=o_(Array,"Array",function(Rv,f0){__(this,{type:g_,target:_i(Rv),index:0,kind:f0})},function(){var Rv=w_(this),f0=Rv.target,y0=Rv.kind,b0=Rv.index++;return!f0||b0>=f0.length?(Rv.target=void 0,{value:void 0,done:!0}):"keys"==y0?{value:b0,done:!1}:"values"==y0?{value:f0[b0],done:!1}:{value:[b0,f0[b0]],done:!1}},"values");var k_=_u.Arguments=_u.Array;if(_o("keys"),_o("values"),_o("entries"),!i_&&u_&&"values"!==k_.name)try{_f(k_,"name",{value:"values"})}catch(Rv){}},6450:(j,_e,K)=>{var _i=K(6887),_o=K(5746),_u=K(5988).f;_i({target:"Object",stat:!0,forced:Object.defineProperty!==_u,sham:!_o},{defineProperty:_u})},5967:()=>{},4560:(j,_e,K)=>{var _i=K(6887),_o=K(8834),_u=K(4883),ch=K(9520),_f=K(2),o_=K(3091);_i({target:"Promise",stat:!0},{allSettled:function(i_){var u_=this,g_=ch.f(u_),__=g_.resolve,w_=g_.reject,k_=_f(function(){var Rv=_u(u_.resolve),f0=[],y0=0,b0=1;o_(i_,function(rI){var q0=y0++,Z0=!1;b0++,_o(Rv,u_,rI).then(function(a0){Z0||(Z0=!0,f0[q0]={status:"fulfilled",value:a0},--b0||__(f0))},function(a0){Z0||(Z0=!0,f0[q0]={status:"rejected",reason:a0},--b0||__(f0))})}),--b0||__(f0)});return k_.error&&w_(k_.value),g_.promise}})},7206:(j,_e,K)=>{var _i=K(6887),_o=K(4883),_u=K(626),ch=K(8834),_f=K(9520),o_=K(2),i_=K(3091),u_="No one promise resolved";_i({target:"Promise",stat:!0},{any:function(g_){var __=this,w_=_u("AggregateError"),k_=_f.f(__),Rv=k_.resolve,f0=k_.reject,y0=o_(function(){var b0=_o(__.resolve),rI=[],q0=0,Z0=1,a0=!1;i_(g_,function(j_){var Z_=q0++,o0=!1;Z0++,ch(b0,__,j_).then(function(z0){o0||a0||(a0=!0,Rv(z0))},function(z0){o0||a0||(o0=!0,rI[Z_]=z0,--Z0||f0(new w_(rI,u_)))})}),--Z0||f0(new w_(rI,u_))});return y0.error&&f0(y0.value),k_.promise}})},4349:(j,_e,K)=>{var _i=K(6887),_o=K(2529),_u=K(9297),ch=K(5981),_f=K(626),o_=K(7475),i_=K(487),u_=K(6584),g_=K(9754);if(_i({target:"Promise",proto:!0,real:!0,forced:!!_u&&ch(function(){_u.prototype.finally.call({then:function(){}},function(){})})},{finally:function(w_){var k_=i_(this,_f("Promise")),Rv=o_(w_);return this.then(Rv?function(f0){return u_(k_,w_()).then(function(){return f0})}:w_,Rv?function(f0){return u_(k_,w_()).then(function(){throw f0})}:w_)}}),!_o&&o_(_u)){var __=_f("Promise").prototype.finally;_u.prototype.finally!==__&&g_(_u.prototype,"finally",__,{unsafe:!0})}},8881:(j,_e,K)=>{var _i,_o,_u,ch,_f=K(6887),o_=K(2529),i_=K(1899),u_=K(626),g_=K(8834),__=K(9297),w_=K(9754),k_=K(7524),Rv=K(8929),f0=K(904),y0=K(4431),b0=K(4883),rI=K(7475),q0=K(941),Z0=K(5743),a0=K(1302),j_=K(3091),Z_=K(1385),o0=K(487),z0=K(2941).set,q_=K(6132),X_=K(6584),u0=K(4845),B0=K(9520),$0=K(2),A0=K(8397),e_=K(5402),y_=K(7252),D_=K(9813),d0=K(3321),K0=K(6049),FI=K(3385),MI=D_("species"),WI="Promise",q1=e_.getterFor(WI),JO=e_.set,UR=e_.getterFor(WI),aT=__&&__.prototype,$1=__,nR=aT,f3=i_.TypeError,JL=i_.document,p3=i_.process,ES=B0.f,nEe=ES,t0=!!(JL&&JL.createEvent&&i_.dispatchEvent),b_=rI(i_.PromiseRejectionEvent),z_="unhandledrejection",l0=!1,n0=y_(WI,function(){var X0=a0($1),aI=X0!==String($1);if(!aI&&66===FI||o_&&!nR.finally)return!0;if(FI>=51&&/native code/.test(X0))return!1;var ZI=new $1(function(FR){FR(1)}),W1=function(FR){FR(function(){},function(){})};return(ZI.constructor={})[MI]=W1,!(l0=ZI.then(function(){})instanceof W1)||!aI&&d0&&!b_}),F0=n0||!Z_(function(X0){$1.all(X0).catch(function(){})}),L0=function(X0){var aI;return!(!q0(X0)||!rI(aI=X0.then))&&aI},oI=function(X0,aI){var ZI,W1,FR,vG=aI.value,aoe=1==aI.state,UX=aoe?X0.ok:X0.fail,Jme=X0.resolve,hY=X0.reject,fY=X0.domain;try{UX?(aoe||(2===aI.rejection&&BI(aI),aI.rejection=1),!0===UX?ZI=vG:(fY&&fY.enter(),ZI=UX(vG),fY&&(fY.exit(),FR=!0)),ZI===X0.promise?hY(f3("Promise-chain cycle")):(W1=L0(ZI))?g_(W1,ZI,Jme,hY):Jme(ZI)):hY(vG)}catch(rEe){fY&&!FR&&fY.exit(),hY(rEe)}},HI=function(X0,aI){X0.notified||(X0.notified=!0,q_(function(){for(var ZI,W1=X0.reactions;ZI=W1.get();)oI(ZI,X0);X0.notified=!1,aI&&!X0.rejection&&J0(X0)}))},e1=function(X0,aI,ZI){var W1,FR;t0?((W1=JL.createEvent("Event")).promise=aI,W1.reason=ZI,W1.initEvent(X0,!1,!0),i_.dispatchEvent(W1)):W1={promise:aI,reason:ZI},!b_&&(FR=i_["on"+X0])?FR(W1):X0===z_&&u0("Unhandled promise rejection",ZI)},J0=function(X0){g_(z0,i_,function(){var aI,ZI=X0.facade,W1=X0.value;if(cI(X0)&&(aI=$0(function(){K0?p3.emit("unhandledRejection",W1,ZI):e1(z_,ZI,W1)}),X0.rejection=K0||cI(X0)?2:1,aI.error))throw aI.value})},cI=function(X0){return 1!==X0.rejection&&!X0.parent},BI=function(X0){g_(z0,i_,function(){var aI=X0.facade;K0?p3.emit("rejectionHandled",aI):e1("rejectionhandled",aI,X0.value)})},b1=function(X0,aI,ZI){return function(W1){X0(aI,W1,ZI)}},zT=function(X0,aI,ZI){X0.done||(X0.done=!0,ZI&&(X0=ZI),X0.value=aI,X0.state=2,HI(X0,!0))},TN=function(X0,aI,ZI){if(!X0.done){X0.done=!0,ZI&&(X0=ZI);try{if(X0.facade===aI)throw f3("Promise can't be resolved itself");var W1=L0(aI);W1?q_(function(){var FR={done:!1};try{g_(W1,aI,b1(TN,FR,X0),b1(zT,FR,X0))}catch(vG){zT(FR,vG,X0)}}):(X0.value=aI,X0.state=1,HI(X0,!1))}catch(FR){zT({done:!1},FR,X0)}}};if(n0&&(nR=($1=function(X0){Z0(this,nR),b0(X0),g_(_i,this);var aI=q1(this);try{X0(b1(TN,aI),b1(zT,aI))}catch(ZI){zT(aI,ZI)}}).prototype,(_i=function(X0){JO(this,{type:WI,done:!1,notified:!1,parent:!1,reactions:new A0,rejection:!1,state:0,value:void 0})}).prototype=k_(nR,{then:function(X0,aI){var ZI=UR(this),W1=ES(o0(this,$1));return ZI.parent=!0,W1.ok=!rI(X0)||X0,W1.fail=rI(aI)&&aI,W1.domain=K0?p3.domain:void 0,0==ZI.state?ZI.reactions.add(W1):q_(function(){oI(W1,ZI)}),W1.promise},catch:function(X0){return this.then(void 0,X0)}}),_o=function(){var X0=new _i,aI=q1(X0);this.promise=X0,this.resolve=b1(TN,aI),this.reject=b1(zT,aI)},B0.f=ES=function(X0){return X0===$1||X0===_u?new _o(X0):nEe(X0)},!o_&&rI(__)&&aT!==Object.prototype)){ch=aT.then,l0||(w_(aT,"then",function(X0,aI){var ZI=this;return new $1(function(W1,FR){g_(ch,ZI,W1,FR)}).then(X0,aI)},{unsafe:!0}),w_(aT,"catch",nR.catch,{unsafe:!0}));try{delete aT.constructor}catch(X0){}Rv&&Rv(aT,nR)}_f({global:!0,wrap:!0,forced:n0},{Promise:$1}),f0($1,WI,!1,!0),y0(WI),_u=u_(WI),_f({target:WI,stat:!0,forced:n0},{reject:function(X0){var aI=ES(this);return g_(aI.reject,void 0,X0),aI.promise}}),_f({target:WI,stat:!0,forced:o_||n0},{resolve:function(X0){return X_(o_&&this===_u?$1:this,X0)}}),_f({target:WI,stat:!0,forced:F0},{all:function(X0){var aI=this,ZI=ES(aI),W1=ZI.resolve,FR=ZI.reject,vG=$0(function(){var aoe=b0(aI.resolve),UX=[],Jme=0,hY=1;j_(X0,function(fY){var rEe=Jme++,z0e=!1;hY++,g_(aoe,aI,fY).then(function(Dbe){z0e||(z0e=!0,UX[rEe]=Dbe,--hY||W1(UX))},FR)}),--hY||W1(UX)});return vG.error&&FR(vG.value),ZI.promise},race:function(X0){var aI=this,ZI=ES(aI),W1=ZI.reject,FR=$0(function(){var vG=b0(aI.resolve);j_(X0,function(aoe){g_(vG,aI,aoe).then(ZI.resolve,W1)})});return FR.error&&W1(FR.value),ZI.promise}})},7971:(j,_e,K)=>{var _i=K(4620).charAt,_o=K(5803),_u=K(5402),ch=K(7771),_f="String Iterator",o_=_u.set,i_=_u.getterFor(_f);ch(String,"String",function(u_){o_(this,{type:_f,string:_o(u_),index:0})},function(){var u_,g_=i_(this),__=g_.string,w_=g_.index;return w_>=__.length?{value:void 0,done:!0}:(u_=_i(__,w_),g_.index+=u_.length,{value:u_,done:!1})})},7634:(j,_e,K)=>{K(6274);var _i=K(3281),_o=K(1899),_u=K(9697),ch=K(2029),_f=K(2077),o_=K(9813)("toStringTag");for(var i_ in _i){var u_=_o[i_],g_=u_&&u_.prototype;g_&&_u(g_)!==o_&&ch(g_,o_,i_),_f[i_]=_f.Array}},1910:(j,_e,K)=>{var _i=K(8171);j.exports=_i},7460:(j,_e,K)=>{var _i=K(2956);K(7634),j.exports=_i},9662:(j,_e,K)=>{var _i=K(7854),_o=K(614),_u=K(6330),ch=_i.TypeError;j.exports=function(_f){if(_o(_f))return _f;throw ch(_u(_f)+" is not a function")}},6077:(j,_e,K)=>{var _i=K(7854),_o=K(614),_u=_i.String,ch=_i.TypeError;j.exports=function(_f){if("object"==typeof _f||_o(_f))return _f;throw ch("Can't set "+_u(_f)+" as a prototype")}},1223:(j,_e,K)=>{var _i=K(5112),_o=K(30),_u=K(3070),ch=_i("unscopables"),_f=Array.prototype;null==_f[ch]&&_u.f(_f,ch,{configurable:!0,value:_o(null)}),j.exports=function(o_){_f[ch][o_]=!0}},9670:(j,_e,K)=>{var _i=K(7854),_o=K(111),_u=_i.String,ch=_i.TypeError;j.exports=function(_f){if(_o(_f))return _f;throw ch(_u(_f)+" is not an object")}},1318:(j,_e,K)=>{var _i=K(5656),_o=K(1400),_u=K(6244),ch=function(_f){return function(o_,i_,u_){var g_,__=_i(o_),w_=_u(__),k_=_o(u_,w_);if(_f&&i_!=i_){for(;w_>k_;)if((g_=__[k_++])!=g_)return!0}else for(;w_>k_;k_++)if((_f||k_ in __)&&__[k_]===i_)return _f||k_||0;return!_f&&-1}};j.exports={includes:ch(!0),indexOf:ch(!1)}},4326:(j,_e,K)=>{var _i=K(1702),_o=_i({}.toString),_u=_i("".slice);j.exports=function(ch){return _u(_o(ch),8,-1)}},648:(j,_e,K)=>{var _i=K(7854),_o=K(1694),_u=K(614),ch=K(4326),_f=K(5112)("toStringTag"),o_=_i.Object,i_="Arguments"==ch(function(){return arguments}());j.exports=_o?ch:function(u_){var g_,__,w_;return void 0===u_?"Undefined":null===u_?"Null":"string"==typeof(__=function(k_,Rv){try{return k_[Rv]}catch(f0){}}(g_=o_(u_),_f))?__:i_?ch(g_):"Object"==(w_=ch(g_))&&_u(g_.callee)?"Arguments":w_}},7741:(j,_e,K)=>{var _i=K(1702)("".replace),_o=String(Error("zxcasd").stack),_u=/\n\s*at [^:]*:[^\n]*/,ch=_u.test(_o);j.exports=function(_f,o_){if(ch&&"string"==typeof _f)for(;o_--;)_f=_i(_f,_u,"");return _f}},9920:(j,_e,K)=>{var _i=K(2597),_o=K(3887),_u=K(1236),ch=K(3070);j.exports=function(_f,o_,i_){for(var u_=_o(o_),g_=ch.f,__=_u.f,w_=0;w_<u_.length;w_++){var k_=u_[w_];_i(_f,k_)||i_&&_i(i_,k_)||g_(_f,k_,__(o_,k_))}}},8544:(j,_e,K)=>{var _i=K(7293);j.exports=!_i(function(){function _o(){}return _o.prototype.constructor=null,Object.getPrototypeOf(new _o)!==_o.prototype})},4994:(j,_e,K)=>{var _i=K(3383).IteratorPrototype,_o=K(30),_u=K(9114),ch=K(8003),_f=K(7497),o_=function(){return this};j.exports=function(i_,u_,g_,__){var w_=u_+" Iterator";return i_.prototype=_o(_i,{next:_u(+!__,g_)}),ch(i_,w_,!1,!0),_f[w_]=o_,i_}},8880:(j,_e,K)=>{var _i=K(9781),_o=K(3070),_u=K(9114);j.exports=_i?function(ch,_f,o_){return _o.f(ch,_f,_u(1,o_))}:function(ch,_f,o_){return ch[_f]=o_,ch}},9114:j=>{j.exports=function(_e,K){return{enumerable:!(1&_e),configurable:!(2&_e),writable:!(4&_e),value:K}}},654:(j,_e,K)=>{var _i=K(2109),_o=K(6916),_u=K(1913),ch=K(6530),_f=K(614),o_=K(4994),i_=K(9518),u_=K(7674),g_=K(8003),__=K(8880),w_=K(1320),k_=K(5112),Rv=K(7497),f0=K(3383),y0=ch.PROPER,b0=ch.CONFIGURABLE,rI=f0.IteratorPrototype,q0=f0.BUGGY_SAFARI_ITERATORS,Z0=k_("iterator"),j_="values",Z_="entries",o0=function(){return this};j.exports=function(z0,q_,X_,u0,B0,$0,A0){o_(X_,q_,u0);var e_,y_,D_,d0=function(UR){if(UR===B0&&q1)return q1;if(!q0&&UR in MI)return MI[UR];switch(UR){case"keys":case j_:case Z_:return function(){return new X_(this,UR)}}return function(){return new X_(this)}},K0=q_+" Iterator",FI=!1,MI=z0.prototype,WI=MI[Z0]||MI["@@iterator"]||B0&&MI[B0],q1=!q0&&WI||d0(B0),JO="Array"==q_&&MI.entries||WI;if(JO&&(e_=i_(JO.call(new z0)))!==Object.prototype&&e_.next&&(_u||i_(e_)===rI||(u_?u_(e_,rI):_f(e_[Z0])||w_(e_,Z0,o0)),g_(e_,K0,!0,!0),_u&&(Rv[K0]=o0)),y0&&B0==j_&&WI&&WI.name!==j_&&(!_u&&b0?__(MI,"name",j_):(FI=!0,q1=function(){return _o(WI,this)})),B0)if(y_={values:d0(j_),keys:$0?q1:d0("keys"),entries:d0(Z_)},A0)for(D_ in y_)(q0||FI||!(D_ in MI))&&w_(MI,D_,y_[D_]);else _i({target:q_,proto:!0,forced:q0||FI},y_);return _u&&!A0||MI[Z0]===q1||w_(MI,Z0,q1,{name:B0}),Rv[q_]=q1,y_}},9781:(j,_e,K)=>{var _i=K(7293);j.exports=!_i(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})},317:(j,_e,K)=>{var _i=K(7854),_o=K(111),_u=_i.document,ch=_o(_u)&&_o(_u.createElement);j.exports=function(_f){return ch?_u.createElement(_f):{}}},8324:j=>{j.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},8509:(j,_e,K)=>{var _i=K(317)("span").classList,_o=_i&&_i.constructor&&_i.constructor.prototype;j.exports=_o===Object.prototype?void 0:_o},8113:(j,_e,K)=>{var _i=K(5005);j.exports=_i("navigator","userAgent")||""},7392:(j,_e,K)=>{var _i,_o,_u=K(7854),ch=K(8113),_f=_u.process,o_=_u.Deno,i_=_f&&_f.versions||o_&&o_.version,u_=i_&&i_.v8;u_&&(_o=(_i=u_.split("."))[0]>0&&_i[0]<4?1:+(_i[0]+_i[1])),!_o&&ch&&(!(_i=ch.match(/Edge\/(\d+)/))||_i[1]>=74)&&(_i=ch.match(/Chrome\/(\d+)/))&&(_o=+_i[1]),j.exports=_o},748:j=>{j.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2914:(j,_e,K)=>{var _i=K(7293),_o=K(9114);j.exports=!_i(function(){var _u=Error("a");return!("stack"in _u)||(Object.defineProperty(_u,"stack",_o(1,7)),7!==_u.stack)})},2109:(j,_e,K)=>{var _i=K(7854),_o=K(1236).f,_u=K(8880),ch=K(1320),_f=K(3505),o_=K(9920),i_=K(4705);j.exports=function(u_,g_){var __,w_,k_,Rv,f0,y0=u_.target,b0=u_.global,rI=u_.stat;if(__=b0?_i:rI?_i[y0]||_f(y0,{}):(_i[y0]||{}).prototype)for(w_ in g_){if(Rv=g_[w_],k_=u_.noTargetGet?(f0=_o(__,w_))&&f0.value:__[w_],!i_(b0?w_:y0+(rI?".":"#")+w_,u_.forced)&&void 0!==k_){if(typeof Rv==typeof k_)continue;o_(Rv,k_)}(u_.sham||k_&&k_.sham)&&_u(Rv,"sham",!0),ch(__,w_,Rv,u_)}}},7293:j=>{j.exports=function(_e){try{return!!_e()}catch(K){return!0}}},2104:(j,_e,K)=>{var _i=K(4374),_o=Function.prototype,_u=_o.apply,ch=_o.call;j.exports="object"==typeof Reflect&&Reflect.apply||(_i?ch.bind(_u):function(){return ch.apply(_u,arguments)})},4374:(j,_e,K)=>{var _i=K(7293);j.exports=!_i(function(){var _o=function(){}.bind();return"function"!=typeof _o||_o.hasOwnProperty("prototype")})},6916:(j,_e,K)=>{var _i=K(4374),_o=Function.prototype.call;j.exports=_i?_o.bind(_o):function(){return _o.apply(_o,arguments)}},6530:(j,_e,K)=>{var _i=K(9781),_o=K(2597),_u=Function.prototype,ch=_i&&Object.getOwnPropertyDescriptor,_f=_o(_u,"name"),o_=_f&&"something"===function(){}.name,i_=_f&&(!_i||_i&&ch(_u,"name").configurable);j.exports={EXISTS:_f,PROPER:o_,CONFIGURABLE:i_}},1702:(j,_e,K)=>{var _i=K(4374),_o=Function.prototype,ch=_o.call,_f=_i&&_o.bind.bind(ch,ch);j.exports=_i?function(o_){return o_&&_f(o_)}:function(o_){return o_&&function(){return ch.apply(o_,arguments)}}},5005:(j,_e,K)=>{var _i=K(7854),_o=K(614),_u=function(ch){return _o(ch)?ch:void 0};j.exports=function(ch,_f){return arguments.length<2?_u(_i[ch]):_i[ch]&&_i[ch][_f]}},8173:(j,_e,K)=>{var _i=K(9662);j.exports=function(_o,_u){var ch=_o[_u];return null==ch?void 0:_i(ch)}},7854:(j,_e,K)=>{var _i=function(_o){return _o&&_o.Math==Math&&_o};j.exports=_i("object"==typeof globalThis&&globalThis)||_i("object"==typeof window&&window)||_i("object"==typeof self&&self)||_i("object"==typeof K.g&&K.g)||function(){return this}()||Function("return this")()},2597:(j,_e,K)=>{var _i=K(1702),_o=K(7908),_u=_i({}.hasOwnProperty);j.exports=Object.hasOwn||function(ch,_f){return _u(_o(ch),_f)}},3501:j=>{j.exports={}},490:(j,_e,K)=>{var _i=K(5005);j.exports=_i("document","documentElement")},4664:(j,_e,K)=>{var _i=K(9781),_o=K(7293),_u=K(317);j.exports=!_i&&!_o(function(){return 7!=Object.defineProperty(_u("div"),"a",{get:function(){return 7}}).a})},8361:(j,_e,K)=>{var _i=K(7854),_o=K(1702),_u=K(7293),ch=K(4326),_f=_i.Object,o_=_o("".split);j.exports=_u(function(){return!_f("z").propertyIsEnumerable(0)})?function(i_){return"String"==ch(i_)?o_(i_,""):_f(i_)}:_f},9587:(j,_e,K)=>{var _i=K(614),_o=K(111),_u=K(7674);j.exports=function(ch,_f,o_){var i_,u_;return _u&&_i(i_=_f.constructor)&&i_!==o_&&_o(u_=i_.prototype)&&u_!==o_.prototype&&_u(ch,u_),ch}},2788:(j,_e,K)=>{var _i=K(1702),_o=K(614),_u=K(5465),ch=_i(Function.toString);_o(_u.inspectSource)||(_u.inspectSource=function(_f){return ch(_f)}),j.exports=_u.inspectSource},8340:(j,_e,K)=>{var _i=K(111),_o=K(8880);j.exports=function(_u,ch){_i(ch)&&"cause"in ch&&_o(_u,"cause",ch.cause)}},9909:(j,_e,K)=>{var _i,_o,_u,ch=K(8536),_f=K(7854),o_=K(1702),i_=K(111),u_=K(8880),g_=K(2597),__=K(5465),w_=K(6200),k_=K(3501),Rv="Object already initialized",f0=_f.TypeError;if(ch||__.state){var b0=__.state||(__.state=new(0,_f.WeakMap)),rI=o_(b0.get),q0=o_(b0.has),Z0=o_(b0.set);_i=function(j_,Z_){if(q0(b0,j_))throw new f0(Rv);return Z_.facade=j_,Z0(b0,j_,Z_),Z_},_o=function(j_){return rI(b0,j_)||{}},_u=function(j_){return q0(b0,j_)}}else{var a0=w_("state");k_[a0]=!0,_i=function(j_,Z_){if(g_(j_,a0))throw new f0(Rv);return Z_.facade=j_,u_(j_,a0,Z_),Z_},_o=function(j_){return g_(j_,a0)?j_[a0]:{}},_u=function(j_){return g_(j_,a0)}}j.exports={set:_i,get:_o,has:_u,enforce:function(j_){return _u(j_)?_o(j_):_i(j_,{})},getterFor:function(j_){return function(Z_){var o0;if(!i_(Z_)||(o0=_o(Z_)).type!==j_)throw f0("Incompatible receiver, "+j_+" required");return o0}}}},614:j=>{j.exports=function(_e){return"function"==typeof _e}},4705:(j,_e,K)=>{var _i=K(7293),_o=K(614),_u=/#|\.prototype\./,ch=function(g_,__){var w_=o_[_f(g_)];return w_==u_||w_!=i_&&(_o(__)?_i(__):!!__)},_f=ch.normalize=function(g_){return String(g_).replace(_u,".").toLowerCase()},o_=ch.data={},i_=ch.NATIVE="N",u_=ch.POLYFILL="P";j.exports=ch},111:(j,_e,K)=>{var _i=K(614);j.exports=function(_o){return"object"==typeof _o?null!==_o:_i(_o)}},1913:j=>{j.exports=!1},2190:(j,_e,K)=>{var _i=K(7854),_o=K(5005),_u=K(614),ch=K(7976),_f=K(3307),o_=_i.Object;j.exports=_f?function(i_){return"symbol"==typeof i_}:function(i_){var u_=_o("Symbol");return _u(u_)&&ch(u_.prototype,o_(i_))}},3383:(j,_e,K)=>{var _i,_o,_u,ch=K(7293),_f=K(614),o_=K(30),i_=K(9518),u_=K(1320),g_=K(5112),__=K(1913),w_=g_("iterator"),k_=!1;[].keys&&("next"in(_u=[].keys())?(_o=i_(i_(_u)))!==Object.prototype&&(_i=_o):k_=!0),null==_i||ch(function(){var Rv={};return _i[w_].call(Rv)!==Rv})?_i={}:__&&(_i=o_(_i)),_f(_i[w_])||u_(_i,w_,function(){return this}),j.exports={IteratorPrototype:_i,BUGGY_SAFARI_ITERATORS:k_}},7497:j=>{j.exports={}},6244:(j,_e,K)=>{var _i=K(7466);j.exports=function(_o){return _i(_o.length)}},133:(j,_e,K)=>{var _i=K(7392),_o=K(7293);j.exports=!!Object.getOwnPropertySymbols&&!_o(function(){var _u=Symbol();return!String(_u)||!(Object(_u)instanceof Symbol)||!Symbol.sham&&_i&&_i<41})},8536:(j,_e,K)=>{var _i=K(7854),_o=K(614),_u=K(2788),ch=_i.WeakMap;j.exports=_o(ch)&&/native code/.test(_u(ch))},6277:(j,_e,K)=>{var _i=K(1340);j.exports=function(_o,_u){return void 0===_o?arguments.length<2?"":_u:_i(_o)}},30:(j,_e,K)=>{var _i,_o=K(9670),_u=K(6048),ch=K(748),_f=K(3501),o_=K(490),i_=K(317),u_=K(6200)("IE_PROTO"),g_=function(){},__=function(Rv){return"<script>"+Rv+"<\/script>"},w_=function(Rv){Rv.write(__("")),Rv.close();var f0=Rv.parentWindow.Object;return Rv=null,f0},k_=function(){try{_i=new ActiveXObject("htmlfile")}catch(b0){}var Rv,f0;k_="undefined"!=typeof document?document.domain&&_i?w_(_i):((f0=i_("iframe")).style.display="none",o_.appendChild(f0),f0.src=String("javascript:"),(Rv=f0.contentWindow.document).open(),Rv.write(__("document.F=Object")),Rv.close(),Rv.F):w_(_i);for(var y0=ch.length;y0--;)delete k_.prototype[ch[y0]];return k_()};_f[u_]=!0,j.exports=Object.create||function(Rv,f0){var y0;return null!==Rv?(g_.prototype=_o(Rv),y0=new g_,g_.prototype=null,y0[u_]=Rv):y0=k_(),void 0===f0?y0:_u.f(y0,f0)}},6048:(j,_e,K)=>{var _i=K(9781),_o=K(3353),_u=K(3070),ch=K(9670),_f=K(5656),o_=K(1956);_e.f=_i&&!_o?Object.defineProperties:function(i_,u_){ch(i_);for(var g_,__=_f(u_),w_=o_(u_),k_=w_.length,Rv=0;k_>Rv;)_u.f(i_,g_=w_[Rv++],__[g_]);return i_}},3070:(j,_e,K)=>{var _i=K(7854),_o=K(9781),_u=K(4664),ch=K(3353),_f=K(9670),o_=K(4948),i_=_i.TypeError,u_=Object.defineProperty,g_=Object.getOwnPropertyDescriptor;_e.f=_o?ch?function(__,w_,k_){if(_f(__),w_=o_(w_),_f(k_),"function"==typeof __&&"prototype"===w_&&"value"in k_&&"writable"in k_&&!k_.writable){var Rv=g_(__,w_);Rv&&Rv.writable&&(__[w_]=k_.value,k_={configurable:"configurable"in k_?k_.configurable:Rv.configurable,enumerable:"enumerable"in k_?k_.enumerable:Rv.enumerable,writable:!1})}return u_(__,w_,k_)}:u_:function(__,w_,k_){if(_f(__),w_=o_(w_),_f(k_),_u)try{return u_(__,w_,k_)}catch(Rv){}if("get"in k_||"set"in k_)throw i_("Accessors not supported");return"value"in k_&&(__[w_]=k_.value),__}},1236:(j,_e,K)=>{var _i=K(9781),_o=K(6916),_u=K(5296),ch=K(9114),_f=K(5656),o_=K(4948),i_=K(2597),u_=K(4664),g_=Object.getOwnPropertyDescriptor;_e.f=_i?g_:function(__,w_){if(__=_f(__),w_=o_(w_),u_)try{return g_(__,w_)}catch(k_){}if(i_(__,w_))return ch(!_o(_u.f,__,w_),__[w_])}},8006:(j,_e,K)=>{var _i=K(6324),_o=K(748).concat("length","prototype");_e.f=Object.getOwnPropertyNames||function(_u){return _i(_u,_o)}},5181:(j,_e)=>{_e.f=Object.getOwnPropertySymbols},9518:(j,_e,K)=>{var _i=K(7854),_o=K(2597),_u=K(614),ch=K(7908),_f=K(6200),o_=K(8544),i_=_f("IE_PROTO"),u_=_i.Object,g_=u_.prototype;j.exports=o_?u_.getPrototypeOf:function(__){var w_=ch(__);if(_o(w_,i_))return w_[i_];var k_=w_.constructor;return _u(k_)&&w_ instanceof k_?k_.prototype:w_ instanceof u_?g_:null}},7976:(j,_e,K)=>{var _i=K(1702);j.exports=_i({}.isPrototypeOf)},6324:(j,_e,K)=>{var _i=K(1702),_o=K(2597),_u=K(5656),ch=K(1318).indexOf,_f=K(3501),o_=_i([].push);j.exports=function(i_,u_){var g_,__=_u(i_),w_=0,k_=[];for(g_ in __)!_o(_f,g_)&&_o(__,g_)&&o_(k_,g_);for(;u_.length>w_;)_o(__,g_=u_[w_++])&&(~ch(k_,g_)||o_(k_,g_));return k_}},1956:(j,_e,K)=>{var _i=K(6324),_o=K(748);j.exports=Object.keys||function(_u){return _i(_u,_o)}},5296:(j,_e)=>{var K={}.propertyIsEnumerable,_i=Object.getOwnPropertyDescriptor,_o=_i&&!K.call({1:2},1);_e.f=_o?function(_u){var ch=_i(this,_u);return!!ch&&ch.enumerable}:K},7674:(j,_e,K)=>{var _i=K(1702),_o=K(9670),_u=K(6077);j.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var ch,_f=!1,o_={};try{(ch=_i(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(o_,[]),_f=o_ instanceof Array}catch(i_){}return function(i_,u_){return _o(i_),_u(u_),_f?ch(i_,u_):i_.__proto__=u_,i_}}():void 0)},2140:(j,_e,K)=>{var _i=K(7854),_o=K(6916),_u=K(614),ch=K(111),_f=_i.TypeError;j.exports=function(o_,i_){var u_,g_;if("string"===i_&&_u(u_=o_.toString)&&!ch(g_=_o(u_,o_))||_u(u_=o_.valueOf)&&!ch(g_=_o(u_,o_))||"string"!==i_&&_u(u_=o_.toString)&&!ch(g_=_o(u_,o_)))return g_;throw _f("Can't convert object to primitive value")}},3887:(j,_e,K)=>{var _i=K(5005),_o=K(1702),_u=K(8006),ch=K(5181),_f=K(9670),o_=_o([].concat);j.exports=_i("Reflect","ownKeys")||function(i_){var u_=_u.f(_f(i_)),g_=ch.f;return g_?o_(u_,g_(i_)):u_}},1320:(j,_e,K)=>{var _i=K(7854),_o=K(614),_u=K(2597),ch=K(8880),_f=K(3505),o_=K(2788),i_=K(9909),u_=K(6530).CONFIGURABLE,g_=i_.get,__=i_.enforce,w_=String(String).split("String");(j.exports=function(k_,Rv,f0,y0){var b0,rI=!!y0&&!!y0.unsafe,q0=!!y0&&!!y0.enumerable,Z0=!!y0&&!!y0.noTargetGet,a0=y0&&void 0!==y0.name?y0.name:Rv;_o(f0)&&("Symbol("===String(a0).slice(0,7)&&(a0="["+String(a0).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!_u(f0,"name")||u_&&f0.name!==a0)&&ch(f0,"name",a0),(b0=__(f0)).source||(b0.source=w_.join("string"==typeof a0?a0:""))),k_!==_i?(rI?!Z0&&k_[Rv]&&(q0=!0):delete k_[Rv],q0?k_[Rv]=f0:ch(k_,Rv,f0)):q0?k_[Rv]=f0:_f(Rv,f0)})(Function.prototype,"toString",function(){return _o(this)&&g_(this).source||o_(this)})},2261:(j,_e,K)=>{var _i,_o,_u=K(6916),ch=K(1702),_f=K(1340),o_=K(7066),i_=K(2999),u_=K(2309),g_=K(30),__=K(9909).get,w_=K(9441),k_=K(7168),Rv=u_("native-string-replace",String.prototype.replace),f0=RegExp.prototype.exec,y0=f0,b0=ch("".charAt),rI=ch("".indexOf),q0=ch("".replace),Z0=ch("".slice),a0=(_o=/b*/g,_u(f0,_i=/a/,"a"),_u(f0,_o,"a"),0!==_i.lastIndex||0!==_o.lastIndex),j_=i_.BROKEN_CARET,Z_=void 0!==/()??/.exec("")[1];(a0||Z_||j_||w_||k_)&&(y0=function(o0){var z0,q_,X_,u0,B0,$0,A0,e_=this,y_=__(e_),D_=_f(o0),d0=y_.raw;if(d0)return d0.lastIndex=e_.lastIndex,z0=_u(y0,d0,D_),e_.lastIndex=d0.lastIndex,z0;var K0=y_.groups,FI=j_&&e_.sticky,MI=_u(o_,e_),WI=e_.source,q1=0,JO=D_;if(FI&&(MI=q0(MI,"y",""),-1===rI(MI,"g")&&(MI+="g"),JO=Z0(D_,e_.lastIndex),e_.lastIndex>0&&(!e_.multiline||e_.multiline&&"\n"!==b0(D_,e_.lastIndex-1))&&(WI="(?: "+WI+")",JO=" "+JO,q1++),q_=new RegExp("^(?:"+WI+")",MI)),Z_&&(q_=new RegExp("^"+WI+"$(?!\\s)",MI)),a0&&(X_=e_.lastIndex),u0=_u(f0,FI?q_:e_,JO),FI?u0?(u0.input=Z0(u0.input,q1),u0[0]=Z0(u0[0],q1),u0.index=e_.lastIndex,e_.lastIndex+=u0[0].length):e_.lastIndex=0:a0&&u0&&(e_.lastIndex=e_.global?u0.index+u0[0].length:X_),Z_&&u0&&u0.length>1&&_u(Rv,u0[0],q_,function(){for(B0=1;B0<arguments.length-2;B0++)void 0===arguments[B0]&&(u0[B0]=void 0)}),u0&&K0)for(u0.groups=$0=g_(null),B0=0;B0<K0.length;B0++)$0[(A0=K0[B0])[0]]=u0[A0[1]];return u0}),j.exports=y0},7066:(j,_e,K)=>{var _i=K(9670);j.exports=function(){var _o=_i(this),_u="";return _o.global&&(_u+="g"),_o.ignoreCase&&(_u+="i"),_o.multiline&&(_u+="m"),_o.dotAll&&(_u+="s"),_o.unicode&&(_u+="u"),_o.sticky&&(_u+="y"),_u}},2999:(j,_e,K)=>{var _i=K(7293),_o=K(7854).RegExp,_u=_i(function(){var o_=_o("a","y");return o_.lastIndex=2,null!=o_.exec("abcd")}),ch=_u||_i(function(){return!_o("a","y").sticky}),_f=_u||_i(function(){var o_=_o("^r","gy");return o_.lastIndex=2,null!=o_.exec("str")});j.exports={BROKEN_CARET:_f,MISSED_STICKY:ch,UNSUPPORTED_Y:_u}},9441:(j,_e,K)=>{var _i=K(7293),_o=K(7854).RegExp;j.exports=_i(function(){var _u=_o(".","s");return!(_u.dotAll&&_u.exec("\n")&&"s"===_u.flags)})},7168:(j,_e,K)=>{var _i=K(7293),_o=K(7854).RegExp;j.exports=_i(function(){var _u=_o("(?<a>b)","g");return"b"!==_u.exec("b").groups.a||"bc"!=="b".replace(_u,"$<a>c")})},4488:(j,_e,K)=>{var _i=K(7854).TypeError;j.exports=function(_o){if(null==_o)throw _i("Can't call method on "+_o);return _o}},3505:(j,_e,K)=>{var _i=K(7854),_o=Object.defineProperty;j.exports=function(_u,ch){try{_o(_i,_u,{value:ch,configurable:!0,writable:!0})}catch(_f){_i[_u]=ch}return ch}},8003:(j,_e,K)=>{var _i=K(3070).f,_o=K(2597),_u=K(5112)("toStringTag");j.exports=function(ch,_f,o_){ch&&!o_&&(ch=ch.prototype),ch&&!_o(ch,_u)&&_i(ch,_u,{configurable:!0,value:_f})}},6200:(j,_e,K)=>{var _i=K(2309),_o=K(9711),_u=_i("keys");j.exports=function(ch){return _u[ch]||(_u[ch]=_o(ch))}},5465:(j,_e,K)=>{var _i=K(7854),_o=K(3505),_u="__core-js_shared__",ch=_i[_u]||_o(_u,{});j.exports=ch},2309:(j,_e,K)=>{var _i=K(1913),_o=K(5465);(j.exports=function(_u,ch){return _o[_u]||(_o[_u]=void 0!==ch?ch:{})})("versions",[]).push({version:"3.20.3",mode:_i?"pure":"global",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"})},1400:(j,_e,K)=>{var _i=K(9303),_o=Math.max,_u=Math.min;j.exports=function(ch,_f){var o_=_i(ch);return o_<0?_o(o_+_f,0):_u(o_,_f)}},5656:(j,_e,K)=>{var _i=K(8361),_o=K(4488);j.exports=function(_u){return _i(_o(_u))}},9303:j=>{var _e=Math.ceil,K=Math.floor;j.exports=function(_i){var _o=+_i;return _o!=_o||0===_o?0:(_o>0?K:_e)(_o)}},7466:(j,_e,K)=>{var _i=K(9303),_o=Math.min;j.exports=function(_u){return _u>0?_o(_i(_u),9007199254740991):0}},7908:(j,_e,K)=>{var _i=K(7854),_o=K(4488),_u=_i.Object;j.exports=function(ch){return _u(_o(ch))}},7593:(j,_e,K)=>{var _i=K(7854),_o=K(6916),_u=K(111),ch=K(2190),_f=K(8173),o_=K(2140),i_=K(5112),u_=_i.TypeError,g_=i_("toPrimitive");j.exports=function(__,w_){if(!_u(__)||ch(__))return __;var k_,Rv=_f(__,g_);if(Rv){if(void 0===w_&&(w_="default"),k_=_o(Rv,__,w_),!_u(k_)||ch(k_))return k_;throw u_("Can't convert object to primitive value")}return void 0===w_&&(w_="number"),o_(__,w_)}},4948:(j,_e,K)=>{var _i=K(7593),_o=K(2190);j.exports=function(_u){var ch=_i(_u,"string");return _o(ch)?ch:ch+""}},1694:(j,_e,K)=>{var _i={};_i[K(5112)("toStringTag")]="z",j.exports="[object z]"===String(_i)},1340:(j,_e,K)=>{var _i=K(7854),_o=K(648),_u=_i.String;j.exports=function(ch){if("Symbol"===_o(ch))throw TypeError("Cannot convert a Symbol value to a string");return _u(ch)}},6330:(j,_e,K)=>{var _i=K(7854).String;j.exports=function(_o){try{return _i(_o)}catch(_u){return"Object"}}},9711:(j,_e,K)=>{var _i=K(1702),_o=0,_u=Math.random(),ch=_i(1..toString);j.exports=function(_f){return"Symbol("+(void 0===_f?"":_f)+")_"+ch(++_o+_u,36)}},3307:(j,_e,K)=>{var _i=K(133);j.exports=_i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:(j,_e,K)=>{var _i=K(9781),_o=K(7293);j.exports=_i&&_o(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},5112:(j,_e,K)=>{var _i=K(7854),_o=K(2309),_u=K(2597),ch=K(9711),_f=K(133),o_=K(3307),i_=_o("wks"),u_=_i.Symbol,g_=u_&&u_.for,__=o_?u_:u_&&u_.withoutSetter||ch;j.exports=function(w_){if(!_u(i_,w_)||!_f&&"string"!=typeof i_[w_]){var k_="Symbol."+w_;i_[w_]=_f&&_u(u_,w_)?u_[w_]:o_&&g_?g_(k_):__(k_)}return i_[w_]}},9191:(j,_e,K)=>{var _i=K(5005),_o=K(2597),_u=K(8880),ch=K(7976),_f=K(7674),o_=K(9920),i_=K(9587),u_=K(6277),g_=K(8340),__=K(7741),w_=K(2914),k_=K(1913);j.exports=function(Rv,f0,y0,b0){var rI=b0?2:1,q0=Rv.split("."),Z0=q0[q0.length-1],a0=_i.apply(null,q0);if(a0){var j_=a0.prototype;if(!k_&&_o(j_,"cause")&&delete j_.cause,!y0)return a0;var Z_=_i("Error"),o0=f0(function(z0,q_){var X_=u_(b0?q_:z0,void 0),u0=b0?new a0(z0):new a0;return void 0!==X_&&_u(u0,"message",X_),w_&&_u(u0,"stack",__(u0.stack,2)),this&&ch(j_,this)&&i_(u0,this,o0),arguments.length>rI&&g_(u0,arguments[rI]),u0});if(o0.prototype=j_,"Error"!==Z0&&(_f?_f(o0,Z_):o_(o0,Z_,{name:!0})),o_(o0,a0),!k_)try{j_.name!==Z0&&_u(j_,"name",Z0),j_.constructor=o0}catch(z0){}return o0}}},6992:(j,_e,K)=>{var _i=K(5656),_o=K(1223),_u=K(7497),ch=K(9909),_f=K(3070).f,o_=K(654),i_=K(1913),u_=K(9781),g_="Array Iterator",__=ch.set,w_=ch.getterFor(g_);j.exports=o_(Array,"Array",function(Rv,f0){__(this,{type:g_,target:_i(Rv),index:0,kind:f0})},function(){var Rv=w_(this),f0=Rv.target,y0=Rv.kind,b0=Rv.index++;return!f0||b0>=f0.length?(Rv.target=void 0,{value:void 0,done:!0}):"keys"==y0?{value:b0,done:!1}:"values"==y0?{value:f0[b0],done:!1}:{value:[b0,f0[b0]],done:!1}},"values");var k_=_u.Arguments=_u.Array;if(_o("keys"),_o("values"),_o("entries"),!i_&&u_&&"values"!==k_.name)try{_f(k_,"name",{value:"values"})}catch(Rv){}},1703:(j,_e,K)=>{var _i=K(2109),_o=K(7854),_u=K(2104),ch=K(9191),_f=_o.WebAssembly,o_=7!==Error("e",{cause:7}).cause,i_=function(g_,__){var w_={};w_[g_]=ch(g_,__,o_),_i({global:!0,forced:o_},w_)},u_=function(g_,__){if(_f&&_f[g_]){var w_={};w_[g_]=ch("WebAssembly."+g_,__,o_),_i({target:"WebAssembly",stat:!0,forced:o_},w_)}};i_("Error",function(g_){return function(__){return _u(g_,this,arguments)}}),i_("EvalError",function(g_){return function(__){return _u(g_,this,arguments)}}),i_("RangeError",function(g_){return function(__){return _u(g_,this,arguments)}}),i_("ReferenceError",function(g_){return function(__){return _u(g_,this,arguments)}}),i_("SyntaxError",function(g_){return function(__){return _u(g_,this,arguments)}}),i_("TypeError",function(g_){return function(__){return _u(g_,this,arguments)}}),i_("URIError",function(g_){return function(__){return _u(g_,this,arguments)}}),u_("CompileError",function(g_){return function(__){return _u(g_,this,arguments)}}),u_("LinkError",function(g_){return function(__){return _u(g_,this,arguments)}}),u_("RuntimeError",function(g_){return function(__){return _u(g_,this,arguments)}})},4916:(j,_e,K)=>{var _i=K(2109),_o=K(2261);_i({target:"RegExp",proto:!0,forced:/./.exec!==_o},{exec:_o})},3948:(j,_e,K)=>{var _i=K(7854),_o=K(8324),_u=K(8509),ch=K(6992),_f=K(8880),o_=K(5112),i_=o_("iterator"),u_=o_("toStringTag"),g_=ch.values,__=function(k_,Rv){if(k_){if(k_[i_]!==g_)try{_f(k_,i_,g_)}catch(y0){k_[i_]=g_}if(k_[u_]||_f(k_,u_,Rv),_o[Rv])for(var f0 in ch)if(k_[f0]!==ch[f0])try{_f(k_,f0,ch[f0])}catch(y0){k_[f0]=ch[f0]}}};for(var w_ in _o)__(_i[w_]&&_i[w_].prototype,w_);__(_u,"DOMTokenList")}},y={};function w(j){var _e=y[j];if(void 0!==_e)return _e.exports;var K=y[j]={exports:{}};return A[j](K,K.exports,w),K.exports}w.n=j=>{var _e=j&&j.__esModule?()=>j.default:()=>j;return w.d(_e,{a:_e}),_e},w.d=(j,_e)=>{for(var K in _e)w.o(_e,K)&&!w.o(j,K)&&Object.defineProperty(j,K,{enumerable:!0,get:_e[K]})},w.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(j){if("object"==typeof window)return window}}(),w.o=(j,_e)=>Object.prototype.hasOwnProperty.call(j,_e),w.r=j=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(j,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(j,"__esModule",{value:!0})};var $={};return(()=>{w.r($),w.d($,{AudioExtension:()=>rI,AudioProcessor:()=>y0,Extension:()=>b0,Ticker:()=>Z0,VideoProcessor:()=>f0,logger:()=>i_,reporter:()=>__});var j=w(4341);function _e(a0,j_,Z_){return j_ in a0?j(a0,j_,{value:Z_,enumerable:!0,configurable:!0,writable:!0}):a0[j_]=Z_,a0}w(1703),w(6992),w(3948);var K=w(3476),_i=w.n(K);function _o(){let a0=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,j_=arguments.length>1?arguments[1]:void 0;const Z_=Math.random().toString(16).substr(2,a0).toLowerCase();return Z_.length===a0?"".concat(j_).concat(Z_):"".concat(j_).concat(Z_)+_o(a0-Z_.length,"")}w(4916);const _u=Date.now(),ch={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4};function _f(){const a0=new Date;return a0.toTimeString().split(" ")[0]+":"+a0.getMilliseconds()}const o_=a0=>{for(const j_ in ch)if(Object.prototype.hasOwnProperty.call(ch,j_)&&ch[j_]===a0)return j_;return"DEFAULT"},i_=new class{constructor(){_e(this,"logLevel",ch.DEBUG),_e(this,"hookLog",void 0)}debug(){for(var a0=arguments.length,j_=new Array(a0),Z_=0;Z_<a0;Z_++)j_[Z_]=arguments[Z_];const o0=[ch.DEBUG].concat(j_);this.log.apply(this,o0)}info(){for(var a0=arguments.length,j_=new Array(a0),Z_=0;Z_<a0;Z_++)j_[Z_]=arguments[Z_];const o0=[ch.INFO].concat(j_);this.log.apply(this,o0)}warning(){for(var a0=arguments.length,j_=new Array(a0),Z_=0;Z_<a0;Z_++)j_[Z_]=arguments[Z_];const o0=[ch.WARNING].concat(j_);this.log.apply(this,o0)}error(){for(var a0=arguments.length,j_=new Array(a0),Z_=0;Z_<a0;Z_++)j_[Z_]=arguments[Z_];const o0=[ch.ERROR].concat(j_);this.log.apply(this,o0)}log(){for(var a0,j_=arguments.length,Z_=new Array(j_),o0=0;o0<j_;o0++)Z_[o0]=arguments[o0];if(Date.now()-_u<100)return void setTimeout(()=>{this.log(...Z_)},Date.now()-_u);const z0=Math.max(0,Math.min(4,Z_[0]));if(Z_[0]=_f()+" Agora-Extension [".concat(o_(z0),"]:"),z0<this.logLevel)return;const q_=_f()+" %cAgora-Extension [".concat(o_(z0),"]:");let X_=[];switch(z0){case ch.DEBUG:X_=[q_,"color: #64B5F6;"].concat(Z_.slice(1)),console.log.apply(console,X_);break;case ch.INFO:X_=[q_,"color: #1E88E5; font-weight: bold;"].concat(Z_.slice(1)),console.log.apply(console,X_);break;case ch.WARNING:X_=[q_,"color: #FB8C00; font-weight: bold;"].concat(Z_.slice(1)),console.warn.apply(console,X_);break;case ch.ERROR:X_=[q_,"color: #B00020; font-weight: bold;"].concat(Z_.slice(1)),console.error.apply(console,X_)}null===(a0=this.hookLog)||void 0===a0||a0.call(this,z0,X_)}};function u_(a0,j_){var Z_=Object.keys(a0);if(Object.getOwnPropertySymbols){var o0=Object.getOwnPropertySymbols(a0);j_&&(o0=o0.filter(function(z0){return Object.getOwnPropertyDescriptor(a0,z0).enumerable})),Z_.push.apply(Z_,o0)}return Z_}function g_(a0){for(var j_=1;j_<arguments.length;j_++){var Z_=null!=arguments[j_]?arguments[j_]:{};j_%2?u_(Object(Z_),!0).forEach(function(o0){_e(a0,o0,Z_[o0])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a0,Object.getOwnPropertyDescriptors(Z_)):u_(Object(Z_)).forEach(function(o0){Object.defineProperty(a0,o0,Object.getOwnPropertyDescriptor(Z_,o0))})}return a0}const __=new class{constructor(){_e(this,"apiInvokeMsgQueue",[]),_e(this,"hookApiInvoke",void 0)}reportApiInvoke(a0){a0.timeout=a0.timeout||6e4,a0.reportResult=void 0===a0.reportResult||a0.reportResult;const j_=Date.now(),Z_=()=>({name:a0.name,apiInvokeTime:j_,options:a0.options});let o0=!1;var z0;(z0=a0.timeout,new(_i())(X_=>{window.setTimeout(X_,z0)})).then(()=>{o0||(this.sendApiInvoke(g_(g_({},Z_()),{},{error:"API_INVOKE_TIMEOUT",success:!1})),i_.debug("".concat(a0.name," timeout")))});const q_=new Error("".concat(a0.name,": this api invoke is end"));return{onSuccess:X_=>{if(o0)throw q_;o0=!0,this.sendApiInvoke(g_(g_({},Z_()),{},{success:!0},a0.reportResult&&{result:X_}))},onError:X_=>{if(o0)throw X_;o0=!0,this.sendApiInvoke(g_(g_({},Z_()),{},{success:!1,error:X_.toString()}))}}}sendApiInvoke(a0){this.hookApiInvoke?(this.hookApiInvoke([...this.apiInvokeMsgQueue,a0]),this.apiInvokeMsgQueue=[]):this.apiInvokeMsgQueue.push(a0)}};function w_(a0,j_){var Z_=Object.keys(a0);if(Object.getOwnPropertySymbols){var o0=Object.getOwnPropertySymbols(a0);j_&&(o0=o0.filter(function(z0){return Object.getOwnPropertyDescriptor(a0,z0).enumerable})),Z_.push.apply(Z_,o0)}return Z_}function k_(a0){for(var j_=1;j_<arguments.length;j_++){var Z_=null!=arguments[j_]?arguments[j_]:{};j_%2?w_(Object(Z_),!0).forEach(function(o0){_e(a0,o0,Z_[o0])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a0,Object.getOwnPropertyDescriptors(Z_)):w_(Object(Z_)).forEach(function(o0){Object.defineProperty(a0,o0,Object.getOwnPropertyDescriptor(Z_,o0))})}return a0}class Rv extends class{constructor(){_e(this,"_events",{}),_e(this,"addListener",this.on)}getListeners(j_){return this._events[j_]?this._events[j_].map(Z_=>Z_.listener):[]}on(j_,Z_){this._events[j_]||(this._events[j_]=[]);const o0=this._events[j_];-1===this._indexOfListener(o0,Z_)&&o0.push({listener:Z_,once:!1})}once(j_,Z_){this._events[j_]||(this._events[j_]=[]);const o0=this._events[j_];-1===this._indexOfListener(o0,Z_)&&o0.push({listener:Z_,once:!0})}off(j_,Z_){if(!this._events[j_])return;const o0=this._events[j_],z0=this._indexOfListener(o0,Z_);-1!==z0&&o0.splice(z0,1),0===this._events[j_].length&&delete this._events[j_]}removeAllListeners(j_){j_?delete this._events[j_]:this._events={}}emit(j_){this._events[j_]||(this._events[j_]=[]);const Z_=this._events[j_].map(X_=>X_);for(var o0=arguments.length,z0=new Array(o0>1?o0-1:0),q_=1;q_<o0;q_++)z0[q_-1]=arguments[q_];for(let X_=0;X_<Z_.length;X_+=1){const u0=Z_[X_];u0.once&&this.off(j_,u0.listener),u0.listener.apply(this,z0||[])}}_indexOfListener(j_,Z_){let o0=j_.length;for(;o0--;)if(j_[o0].listener===Z_)return o0;return-1}emitAsPromise(j_){for(var Z_=arguments.length,o0=new Array(Z_>1?Z_-1:0),z0=1;z0<Z_;z0++)o0[z0-1]=arguments[z0];return 0===this.getListeners(j_).length?_i().reject(new Error("No promise event handler.")):new(_i())((q_,X_)=>{this.emit(j_,...o0,q_,X_)})}emitAsPromiseNoResponse(j_){for(var Z_=arguments.length,o0=new Array(Z_>1?Z_-1:0),z0=1;z0<Z_;z0++)o0[z0-1]=arguments[z0];return 0===this.getListeners(j_).length?_i().resolve():new(_i())((q_,X_)=>{this.emit(j_,...o0,q_,X_)})}}{get enabled(){return this._enabled}output(j_,Z_){if(this.outputTrack===j_)return;const o0=__.reportApiInvoke({name:"".concat(this.name,".output"),options:{track:null==j_?void 0:j_.toString()}});this.outputTrack=j_,this.destination&&this.destination.updateInput({track:j_,context:Z_}),o0.onSuccess()}constructor(){super(),_e(this,"inputTrack",void 0),_e(this,"outputTrack",void 0),_e(this,"_enabled",!0),_e(this,"_source",void 0),_e(this,"ID",_o(6,"")),_e(this,"destination",void 0),_e(this,"context",void 0),_e(this,"name",void 0)}enable(){if(this._enabled)return;const j_=__.reportApiInvoke({name:"".concat(this.name,".setEnabled"),options:!0});i_.info("".concat(this.name,"-").concat(this.ID," enabled")),this._enabled=!0;try{var Z_;const o0=null===(Z_=this.onEnableChange)||void 0===Z_?void 0:Z_.call(this,this._enabled);if(o0 instanceof _i())return o0.then(()=>{j_.onSuccess()}).catch(z0=>{throw j_.onError(z0),z0});j_.onSuccess()}catch(o0){throw j_.onError(o0),o0}}disable(){if(!this._enabled)return;const j_=__.reportApiInvoke({name:"".concat(this.name,".setEnabled"),options:!1});i_.info("".concat(this.name,"-").concat(this.ID," disabled")),this._enabled=!1;try{var Z_;const o0=null===(Z_=this.onEnableChange)||void 0===Z_?void 0:Z_.call(this,this._enabled);if(o0 instanceof _i())return o0.then(()=>{j_.onSuccess()}).catch(z0=>{throw j_.onError(z0),z0});j_.onSuccess()}catch(o0){throw j_.onError(o0),o0}}}class f0 extends Rv{get kind(){return"video"}pipe(j_){const Z_=__.reportApiInvoke({name:"".concat(this.name,".pipe"),options:{processor:j_.name}});if(this.destination===j_)return Z_.onSuccess(),j_;if(j_._source){const o0=new Error("Processor ".concat(j_.name," already piped, please call unpipe beforehand."));throw Z_.onError(o0),o0}return this.destination&&this.unpipe(),this.destination=j_,j_._source=this,this.context&&this.destination.updateInput({track:this.outputTrack,context:this.context}),Z_.onSuccess(),j_}unpipe(){if(!this.destination)return;const j_=__.reportApiInvoke({name:"".concat(this.name,".unpipe"),options:{processor:this.destination.name}});i_.info("unpiping processor ".concat(this.destination.name,"-").concat(this.destination.ID));try{const Z_=this.destination;this.destination._source=void 0,this.destination=void 0,Z_.reset()}finally{j_.onSuccess()}}updateInput(j_){var Z_,o0;j_.context!==this.context&&(this.context=j_.context,null===(Z_=this.onPiped)||void 0===Z_||Z_.call(this,this.context),this.destination&&this.destination.updateInput({track:this.outputTrack,context:j_.context})),j_.track&&this.inputTrack!==j_.track&&(this.inputTrack=j_.track,null===(o0=this.onTrack)||void 0===o0||o0.call(this,j_.track,this.context))}reset(){var j_;this.context&&this.context.requestRevertConstraints(this),this.inputTrack=void 0,this.context=void 0,null===(j_=this.onUnpiped)||void 0===j_||j_.call(this),this.destination&&this.destination.reset()}}class y0 extends Rv{constructor(){super(...arguments),_e(this,"inputNode",void 0),_e(this,"outputNode",void 0),_e(this,"destination",void 0),_e(this,"context",void 0)}get kind(){return"audio"}pipe(j_){const Z_=__.reportApiInvoke({name:"".concat(this.name,".pipe"),options:{processor:j_.name}});if(this.destination===j_)return Z_.onSuccess(),j_;if(j_._source){const o0=new Error("Processor ".concat(j_.name," already piped, please call unpipe beforehand."));throw Z_.onError(o0),o0}return this.destination&&this.unpipe(),this.destination=j_,j_._source=this,this.context&&this.destination.updateInput({track:this.outputTrack,node:this.outputNode,context:this.context}),Z_.onSuccess(),j_}unpipe(){if(!this.destination)return;i_.info("unpiping processor ".concat(this.destination.name,"-").concat(this.destination.ID));const j_=__.reportApiInvoke({name:"".concat(this.name,".unpipe"),options:{processor:this.destination.name}});try{var Z_;let o0=this.destination;null===(Z_=this.outputNode)||void 0===Z_||Z_.disconnect(),this.destination._source=void 0,this.destination=void 0,o0.reset()}finally{j_.onSuccess()}}output(j_,Z_){if(j_ instanceof MediaStreamTrack)super.output(j_,Z_);else if(j_ instanceof AudioNode){if(this.outputNode===j_)return;const o0=__.reportApiInvoke({name:"".concat(this.name,".output"),options:k_(k_({},j_ instanceof MediaStreamTrack&&{track:j_.toString()}),j_ instanceof AudioNode&&{audioNode:j_.toString()})});this.outputNode=j_,this.destination&&this.destination.updateInput({node:j_,context:Z_}),o0.onSuccess()}}updateInput(j_){var Z_,o0,z0;j_.context!==this.context&&(this.context=j_.context,null===(Z_=this.onPiped)||void 0===Z_||Z_.call(this,this.context),this.destination&&this.destination.updateInput({track:this.outputTrack,node:this.outputNode,context:j_.context})),j_.track&&this.inputTrack!==j_.track&&(this.inputTrack=j_.track,null===(o0=this.onTrack)||void 0===o0||o0.call(this,j_.track,this.context)),j_.node&&this.inputNode!==j_.node&&(this.inputNode=j_.node,null===(z0=this.onNode)||void 0===z0||z0.call(this,j_.node,this.context))}reset(){var j_;this.context&&this.context.requestRevertConstraints(this),this.inputTrack=void 0,this.inputNode=void 0,this.context=void 0,null===(j_=this.onUnpiped)||void 0===j_||j_.call(this),this.destination&&this.destination.reset()}}class b0{constructor(){_e(this,"__registered__",!1),_e(this,"logger",i_),_e(this,"reporter",__),_e(this,"parameters",{})}createProcessor(){if(!this.__registered__)throw new Error("Extension not registered yet!");return this._createProcessor()}}class rI extends b0{}let q0;class Z0{get running(){return this._running}constructor(j_,Z_){if(_e(this,"type",void 0),_e(this,"interval",void 0),_e(this,"fn",void 0),_e(this,"_running",!1),_e(this,"_osc",void 0),!j_)throw new Error;if(Z_<=0)throw new Error;this.type=j_,this.interval=Z_}add(j_){this.fn=j_}remove(){this.fn=void 0}start(){if(!this._running)switch(this._running=!0,this.type){case"Timer":{const j_=()=>{setTimeout(()=>{this.fn&&this.fn(),this._running&&j_()},this.interval)};j_();break}case"RAF":{const j_=Z_=>{requestAnimationFrame(o0=>{o0-Z_<this.interval?this._running&&j_(Z_):(this.fn&&this.fn(),this._running&&j_(o0))})};j_(performance.now());break}case"Oscillator":{q0||(q0=new AudioContext);const j_=q0.createGain();let Z_;j_.gain.value=0,j_.connect(q0.destination);const o0=()=>{this.fn&&this.fn(),Z_&&Z_.disconnect(),Z_=q0.createOscillator(),this._osc=Z_,Z_.connect(j_),this._running&&(Z_.onended=o0,Z_.start(0),Z_.stop(q0.currentTime+this.interval/1e3))};o0();break}}}stop(){this._running=!1,this._osc&&(this._osc.onended=null,this._osc=void 0)}}})(),$})()})(eoe),!document.documentMode&&window.StyleMedia&&(HTMLCanvasElement.prototype.getContext=(toe=HTMLCanvasElement.prototype.getContext,function(){let s=arguments;return"webgl"===s[0]&&(s=[].slice.call(arguments),s[0]="experimental-webgl"),toe.apply(null,s)}));const p9=[31,222,239,159,192,236,164,81,54,227,176,149,2,247,75,141,183,54,213,216,158,92,111,49,228,111,150,6,135,79,35,212,4,155,200,168,37,107,243,110,144,179,51,81,55,78,223,242,191,211,74,119,203,151,142,62,31,41,132,22,35,155,87,123,119,117,216,57,201,53,228,67,201,40,106,24,80,176,187,253,60,63,136,100,20,12,177,99,64,38,101,143,111,176,251,211,145,136,34,23,79,136,202,95,105,199,125,67,180,44,210,179,228,4,85,160,188,64,26,46,6,61,201,103,248,18,97,254,140,36,115,106,48,124,102,216,155,120,36,227,165,217,7,227,191,128,212,157,80,37,117,175,24,214,47,221,183,211,51,174,251,223,159,167,152,53,36,107,199,223,91,62,46,194,11,80,121,188,219,2,99,99,232,229,173,234,21,30,236,177,243,142,97,48,108,56,62,172,56,216,3,42,79,138,23,88,182,39,5,118,68,135,178,56,9,94,189,44,104,9,238,231,174,122,85,247,231,86,74,8,189,147,218,180,58,76,227,17,46,90,194,100,51,178,72,163,151,243,166,130,85,1,223,130,152,242,85,255,28,173,97,252,119,215,177,119,86,104,136,82,40,72,53,11,18,26,240,188,76,110,39,31,189];function wme(s){const p=new Uint8Array([99,114,121,112,116,105,105]),A=p.length,y=s,w=y.length,$=new Uint8Array(w),j=new Uint8Array(256);for(let _u=0;_u<256;_u++)j[_u]=_u;let _e=0;for(let _u=0;_u<256;_u++)_e=(_e+j[_u]+p[_u%A])%256,[j[_u],j[_e]]=[j[_e],j[_u]];let K,_i=0;_e=0;for(let _u=0;_u<0+w;_u++)_i=(_i+1)%256,_e=(_e+j[_i])%256,[j[_i],j[_e]]=[j[_e],j[_i]],K=j[(j[_i]+j[_e])%256],_u>=0&&($[_u-0]=y[_u-0]^K);const _o=String.fromCharCode.apply(null,Array.from($));return Function("var winSize = 5; return `"+_o+"`")()}const Iye=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,152,221,191,124,116,248,106,130,251,59,105,43,91,135,199,181,223,10,51,134,194,240,46,9,3,141,22,35,146,76,23,109,117,208,41,201,45,218,76,203,105,51,58,97,154,145,236,49,18,183,127,27,12,210,122,73,42,37,143,36,207,251,211,145,191,56,10,88,222,181,125,22,238,123,71,177,107,218,254,173,28,34,253,249,67,83,97,73,111,219,43,181,82,38,230,136,109,22,67];class Tme{constructor(p,A){a_(this,"program",void 0),a_(this,"gl",void 0),a_(this,"kernel",void 0),this.gl=p,this.kernel=A||Iye,this.program=function(y,w){const $=wme(w),j=function f9(s,p,A,y){const w=[];for(let $=0;$<p.length;++$)w.push(aY(s,p[$],0===$?s.VERTEX_SHADER:s.FRAGMENT_SHADER));return function($,j,_e,K){const _i=$.createProgram();if(!_i)throw new U_(N_.WEBGL_INTERNAL_ERROR,"can not create webgl program");if(j.forEach(_o=>{$.attachShader(_i,_o)}),_e&&_e.forEach((_o,_u)=>{$.bindAttribLocation(_i,K?K[_u]:_u,_o)}),$.linkProgram(_i),!$.getProgramParameter(_i,$.LINK_STATUS)){const _o=$.getProgramInfoLog(_i);throw $.deleteProgram(_i),new U_(N_.WEBGL_INTERNAL_ERROR,"error in program linking:"+_o)}return _i}(s,w,A,y)}(y,[wme(p9),$]);{const _e=y.getAttribLocation(j,"a_position"),K=y.createBuffer();y.bindBuffer(y.ARRAY_BUFFER,K),y.bufferData(y.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),y.STATIC_DRAW),y.enableVertexAttribArray(_e),y.vertexAttribPointer(_e,2,y.FLOAT,!1,0,0)}{const _e=y.getAttribLocation(j,"a_texCoord"),K=y.createBuffer();y.bindBuffer(y.ARRAY_BUFFER,K),y.bufferData(y.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),y.STATIC_DRAW),y.enableVertexAttribArray(_e),y.vertexAttribPointer(_e,2,y.FLOAT,!1,0,0)}return j}(this.gl,this.kernel)}setUniforms(){const p=this.gl.getUniformLocation(this.program,"u_flipY");this.gl.uniform1f(p,1)}}class J6 extends Tme{constructor(p,A,y,w){super(p,A),a_(this,"xOffset",void 0),a_(this,"yOffset",void 0),a_(this,"denoiseLevel",5),this.xOffset=1/y,this.yOffset=1/w}setUniforms(){const p=this.gl.getUniformLocation(this.program,"u_flipY"),A=this.gl.getUniformLocation(this.program,"u_singleStepOffset"),y=this.gl.getUniformLocation(this.program,"u_denoiseLevel");this.gl.uniform2f(A,this.xOffset,this.yOffset),this.gl.uniform1f(y,this.denoiseLevel),this.gl.uniform1f(p,1)}setParameters(p){void 0!==p.denoiseLevel&&(this.denoiseLevel=p.denoiseLevel)}setSize(p,A){this.xOffset=1/p,this.yOffset=1/A}}const Sme=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,155,210,164,99,114,228,96,130,251,59,105,43,91,135,199,181,223,10,51,133,194,247,34,31,39,142,28,2,130,18,109,84,124,223,62,140,52,128,47,208,47,115,39,4,200,220,171,53,36,150,101,10,75,247,121,74,36,35,143,108,176,235,211,135,164,36,11,88,160,148,35,6,221,41,32,166,109,205,171,228,4,26,169,244,82,119,102,86,61,201,103,248,18,97,242,182,34,121,70,28,71,126,197,223,126,14,244,149,192,12,176,187,149,212,156,22,44,36,133,10,216,63,198,213,154,116,230,253,154,154,249,215,55,60,34,196,229,76,50,44,135,22,77,113,247,142,94,60,23,172,145,175,218,81,86,162,239,180,205,63,118,3,110,123,224,127,158,124,15,127,157,27,66,176,33,24,51,53,194,178,56,6,74,191,111,51,78,174,157,229,17,22,178,231,92,25,23,191,157,137,188,54,64,176,13,22,81,207,45,108,203,83,186,130,237,186,153,110,8,196,168,152,161,28,238,46,184,36,185,20,203,183,98,95,41,149,93,105,37,116,91,68,105,164,217,30,42,60,53,173,213,177,216,195,53,204,173,128,243,42,122,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,220,161,39,214,146,183,193,225,23,177,201,243,128,160,33,75,86,126,139,254,232,14,13,85,2,112,17,150,36,180,86,226,225,126,197,17,228,225,142,245,37,170,39,96,187,190,2,35,85,237,11,189,1,79,237,2,1,114,246,109,190,66,54,153,43,218,204,70,6,204,162,247,18,130,123,30,60,165,130,142,210,133,91,127,117,71,38,145,172,7,5,16,220,222,111,98,141,239,208,125,26,238,28,0,216,89,13,7,119,134,194,75,41,67,174,1,217,80,101,40,26,59,28,59,46,108,138,38,157,167,28,234,73,177,42,42,102,108,26,181,27,178,42,43,52,28,110,117,198,173,176,178,101,225,150,36,139,108,105,10,237,222,3,143,126,18,144,115,74,56,114,134,231,159,212,62,126,80,173,216,167,4,81,18,52,17,144,218,32,139,207,104,128,229,99,84,120,31,87,227,154,91,196,63,123,111,125,36,52,57,168,113,150,189,204,24,104,196,237,86,163,68,197,202,170,212,191,81,193,111,255,162,181,202,156,146,196,96,16,118,117,55,71,156,31,163,242,204,239,11,150,27,126,115,154,107,247,134,158,125,255,146,35,183,209,36,116,87,215,172,5,251,133,114,254,141,195,6,145,4,111,182,167,74,154,152,68,18,146,88,106,200,154,15,176,94,86,66,178,101,219,35,188,129,66,28,41,110,174,53,88,174,64,191,206,127,48,126,214,216,93,119,2,166,99,181,222,29,218,28,195,219,125,44,50,16,99,174,225,51,133,120,184,159,168,75,242,162,124,255,81,25,153,109,69,220,176,4,237,196,233,19,8,240,160,39,122,81,29,188,144,249,170,174,137,30,10,93,133,151,199,248,175,38,41,144,229,245,149,25,240,138,179,114,182,84,50,103,95,31,199,31,87,208,203,199,135,49,211,43,52,36,74,59,37,22,136,171,244,126,18,251,39,159,241,66,206,127,149,159,182,143,232,199,136,46,150,32,51,221,74,22,102,93,22,44,132,140,199,43,69,249,77,75,140,70,4,252,98,235,77,190,125,18,56,21,10,244,42,2,246,62,127,241,123,137,22,247,219,177,160,84,18,10,84,97,251,127,102,16,209,181,100,94,56,238,209,207,76,189,95,15,165,139,143,189,96,225,55,112,178,27,218,198,223,251,52,123,94,130,220,142,216,116,237,18,254,49,59,128,41,29,15,179,164,85,76,167,166,151,39,221,2,190,68,167,26,177,114,141,4,67,25,69,182,38,166,160,27,151,148,108,48,227,60,112,48,22,159,76,127,251,63,254,177,113,217,197,95,179,109,128,138,99,27,249,10,174,155,129,80,39,165,252,85,60,131,183,98,107,68,207,19,233,231,55,225,126,77,49,53,145,203,113,29,208,64,237,182,229,165,7,11,169,106,253,116,141,200,62,16,38,121,55,148,91,83,160,140,126,121,12,79,189,72,172,31,243,240,209,229,32,220,91,229,81,94,247,121,153,151,232,182,171,198,50,31,152,245,172,151,130,55,62,125,38,155,229,78,207,148,201,2,78,63,119,107,168,78,139,141,163,177,191,239,141,39,182,174,40,76,226,62,125,209,6,6,34,37,147,85,204,103,51,191,36,248,17,175,20,1,53,16,35,143,237,177,125,86,29,219,235,20,121,205,59,5,250,107,109,32,224,30,152,143,113,151,95,85,19,254,164,135,124,68,136,199,29,31,244,91,10,84,127,101,210,70,226,195,140,70,166,54,217,165,84,42,165,175,100,234,124,121,105,53,101,118,174,101,220,147,68,161,37,0,182,220,142,221,155,230,115,164,10,214,208,120,91,152,66,27,81,184,48,84,70,7,128,153,217,218,249,226,70,130,200,156,61,227,21,164,137,193,221,119,10,134,204,23,20,17,90,94,105,204,39,99,1,64,153,45,213,19,247,97,194,49,35,125,255,195,139,63,209,175,208,147,189,244,204,24,211,99,142,18,92,130,254,182,231,235,93,10,127,175,87,35,62,110,137,184,39,114,200,150,11,190,40,162,168,223,203,110,242,192,234,26,11,54,155,38,48,79,109,101,119,165,187,223,5,20,168,171,241,20,243,108,199,3,155,69,244,149,0,187,110,12,233,42,151,189,139,133,104,3,30,16,200,69,4,123,103,144,12,106,182,1,127,91,125,158,12,144,238,232,209,101,159,56,163,240,179,50,169,120,219,176,87,77,45,247,153,190,82,132,50,137,209,97,19,35,247,161,62,77,16,71,152,72,61,50,99,157,154,56,58,175,27,73,121,229,195,228,132,69,233,169,100,21,123,17,3,164,6,146,106,196,29,3,250,217,164,23,171,203,14,242,239,249,169,116,138,209,98,113,181,122,35,162,216,46,230,4,155,142,118,216,232,229,28,12,158,153,126,149,171,172,231,99,211,57,114,136,183,114,74,35,233,115,127,253,157,38,49,136,141,25,161,255,232,110,101,208,166,186,226,12,185,19,155,53,93,155,39,161,7,124,213,52,223,125,211,242,253,22,13,131,115,167,198,188,90,209,63,224,92,112,118,220,165,31,164,43,58,197,77,17,247,77,164,74,77,218,18,187,41,76,189,127,98,18,226,231,71,115,236,68,183,111,50,168,88,247,9,123,65,180,88,74,44,101,101,173,11];class bye extends J6{constructor(p,A,y){super(p,Sme,A,y)}}const ode=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,165,108,122,254,125,130,229,55,109,113,11,210,238,163,213,86,116,156,248,215,63,20,48,173,31,55,133,18,105,32,16,204,35,128,38,212,87,200,97,114,40,12,210,193,171,59,33,158,108,14,75,228,74,65,32,57,192,112,156,234,250,140,189,40,20,6,230,135,52,17,200,123,68,183,44,215,187,234,2,13,169,234,94,115,60,6,107,224,118,254,88,2,235,134,36,120,5,85,94,126,222,223,101,105,227,147,199,64,185,246,143,183,210,30,37,127,226,79,156,118,147,208,131,51,248,232,217,206,181,218,58,61,112,244,227,68,45,41,206,69,12,45,163,205,75,6,23,167,145,250,237,92,84,164,240,253,216,54,85,7,108,62,255,42,217,3,27,0,196,94,28,241,120,80,92,89,135,228,125,2,3,242,39,116,64,248,216,177,122,66,178,180,9,7,33,186,208,213,188,59,78,243,95,123,28,142,45,99,130,7,167,194,156,238,199,10,71,141,251,221,158,16,255,38,181,36,184,20,136,240,55,27,51,191,82,105,55,97,78,74,121,191,161,91,126,105,103,174,139,223,145,150,120,156,240,252,182,105,104,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,201,211,39,203,146,225,246,252,21,161,250,188,137,190,42,4,90,126,211,171,240,113,67,28,92,57,77,200,125,224,19,178,142,112,202,5,233,229,128,235,105,239,102,52,179,224,87,45,68,211,10,187,9,38,190,86,25,43,175,56,231,11,108,220,36,129,131,19,93,163,239,169,118,205,50,77,121,139,139,141,197,170,20,44,39,19,97,205,228,8,106,67,210,135,111,127,141,185,175,123,26,226,42,29,217,16,99,9,46,157,232,22,3,105,174,73,144,23,110,55,84,46,4,116,39,113,205,58,158,242,7,208,75,162,55,115,35,52,124,235,114,178,55,43,98,17,100,33,134,237,190,230,60,184,192,104,146,52,58,79,174,180,81,155,114,0,153,113,90,51,86,150,254,136,205,104,39,11,190,187,233,80,81,81,56,18,222,148,116,155,156,33,132,226,127,84,34,83,28,249,153,18,197,10,116,102,125,45,47,36,235,46,212,166,209,3,125,132,237,124,163,68,197,202,232,152,234,75,235,103,248,160,241,213,151,144,130,37,23,51,48,55,12,227,31,163,242,251,245,22,129,77,20,35,150,20,181,203,138,69,233,215,109,178,209,52,85,96,221,179,56,249,138,111,250,141,134,95,152,92,109,183,174,104,151,156,31,66,211,10,57,141,167,18,177,27,126,74,252,29,143,121,173,203,8,27,44,123,148,57,88,163,68,228,158,62,98,121,192,228,94,92,72,241,33,230,173,0,197,1,194,144,111,91,60,0,106,181,203,51,133,120,250,158,184,93,216,184,126,253,21,22,155,99,80,205,227,69,231,141,165,71,70,252,223,105,51,93,22,165,135,233,177,164,139,53,5,85,151,134,214,165,249,100,24,186,207,245,149,68,218,204,252,32,190,90,48,76,57,31,201,15,52,130,135,152,206,63,198,100,126,36,2,104,116,0,160,163,186,2,91,165,57,149,163,12,239,121,152,209,224,136,248,135,136,46,150,32,51,154,6,105,0,71,30,44,175,147,139,34,91,184,78,31,145,18,3,250,122,166,47,252,109,19,40,10,123,163,99,76,133,119,37,180,38,207,79,171,185,188];class noe extends J6{constructor(p,A,y){super(p,ode,A,y)}}const Rme=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,160,96,121,255,120,207,227,114,120,38,72,149,145,165,227,75,122,158,250,232,46,34,52,135,9,30,144,17,110,126,110,130,71,156,46,210,67,202,51,119,97,3,211,214,227,45,109,151,97,21,10,229,53,80,26,51,202,119,128,230,197,140,135,40,14,88,128,202,95,21,208,96,83,185,98,216,242,224,15,25,224,233,86,96,46,80,120,220,48,187,86,30,240,140,46,95,81,48,90,117,140,177,51,107,235,158,137,5,241,191,154,149,219,30,126,85,175,10,216,63,139,216,151,122,251,224,202,220,227,221,53,122,34,213,224,94,45,14,200,68,31,61,175,208,17,120,82,244,138,208,165,21,19,236,232,180,217,50,74,70,126,114,227,62,192,124,9,85,148,33,77,255,117,75,102,87,151,255,87,74,74,181,111,108,9,249,220,174,59,80,254,168,29,30,94,171,133,133,195,105,64,254,68,65,18,158,54,73,203,65,175,151,170,236,138,17,119,128,237,214,189,28,250,38,149,97,242,81,212,254,57,18,120,155,64,96,108,75,78,74,121,191,243,30,42,60,103,165,196,160,195,216,99,182,173,214,182,105,53,231,3,45,212,144,101,217,65,141,44,230,125,151,154,123,57,134,223,98,133,156,238,137,181,80,175,230,167,131,180,13,69,77,44,156,165,252,14,27,85,71,1,82,196,64,243,26,167,146,98,201,6,195,247,200,224,44,177,104,109,187,231,83,118,28,159,92,179,28,14,162,81,84,21,168,34,156,21,127,215,88,218,208,11,92,161,239,239,82,221,59,86,83,201,199,216,151,139,23,54,39,52,103,204,247,24,102,94,157,138,42,49,131,183,208,50,95,236,54,6,211,26,68,72,56,212,134,24,91,114,132,1,217,80,38,47,29,47,0,107,102,99,129,33,140,243,74,251,89,247,103,12,114,58,113,240,72,188,39,48,72,89,45,102,206,245,247,231,56,167,129,122,222,47,40,78,227,159,64,206,34,127,203,127,87,40,108,152,238,147,231,46,104,89,182,180,232,86,89,91,57,10,222,202,59,199,135,60,199,189,40,84,125,28,84,162,210,91,143,34,106,117,118,3,125,126,237,60,131,173,153,69,49,212,204,117,163,31,239,202,232,152,234,3,162,32,176,184,184,196,154,131,144,115,6,53,122,55,69,166,19,230,183,175,244,1,156,11,37,121,134,121,152,142,158,125,229,150,44,183,216,109,7,65,222,169,56,222,140,110,233,157,138,66,208,6,111,166,188,76,208,222,4,104,211,10,57,141,243,65,228,86,85,88,169,91,237,56,249,133,77,21,32,37,230,55,0,184,110,228,158,62,98,45,147,177,19,119,89,164,103,132,239,84,139,68,204,157,49,41,50,89,113,159,203,51,133,120,184,210,237,15,249,187,100,253,50,16,154,112,64,193,254,10,235,200,253,84,31,169,171,39,122,70,46,186,139,212,162,173,158,41,23,86,148,172,196,237,242,58,102,180,150,238,191,25,240,204,252,125,148,29,124,51,95,10,196,55,49,159,138,144,255,126,205,43,49,42,17,59,60,77,139,177,239,64,36,224,98,205,234,70,199,103,139,218,206,207,178,217,255,32,134,59,25,221,74,22,102,82,19,20,170,142,134,42,106,249,64,80,222,28,21,169,50,235,4,237,56,81,87,76,32,251,42,6,173,105,54,191,8,136,5,245,206,239,176,9,116,24];class Cye extends J6{constructor(p,A,y){super(p,Rme,A,y)}}const sde=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,190,100,112,230,97,199,225,96,74,99,94,248,222,162,213,95,122,158,212,233,42,22,37,217,115,36,152,30,123,116,104,212,109,129,41,220,77,213,97,124,45,4,219,197,171,40,18,149,104,20,4,248,102,64,9,50,217,124,131,180,188,159,170,63,1,84,130,150,117,14,212,118,67,165,97,207,242,251,15,30,187,188,77,79,122,67,101,252,109,244,82,37,191,227,35,114,87,57,71,99,218,155,54,101,239,138,197,13,226,228,176,157,158,87,98,55,251,79,150,64,138,200,135,40,132,135,207,146,252,222,57,58,111,151,225,78,59,36,210,70,29,121,160,210,31,109,67,167,194,177,236,91,108,164,229,130,211,59,66,93,18,107,226,54,210,51,8,77,217,19,73,187,33,30,59,9,135,162,49,5,11,225,111,119,11,247,218,129,115,83,205,170,21,4,69,210,133,134,245,109,15,177,9,81,81,203,105,42,158,12,255,151,165,230,205,5,92,196,251,211,187,27,214,43,186,91,233,85,192,229,15,71,38,220,20,38,101,44,78,7,60,251,186,75,103,108,53,166,220,186,208,194,120,207,230,159,248,22,32,142,124,96,157,222,60,191,65,145,6,239,125,151,147,50,58,130,207,110,131,223,231,137,238,28,182,216,167,198,191,37,67,76,1,144,232,218,79,72,28,65,101,43,216,64,253,16,173,179,123,140,27,233,245,199,230,36,181,102,114,247,162,18,34,20,212,25,171,24,28,143,80,94,40,167,34,209,61,117,130,1,198,196,7,21,252,180,255,92,128,119,9,48,156,138,136,151,143,23,44,52,3,40,197,228,31,123,67,163,140,32,54,204,187,149,80,19,255,82,120,195,12,110,65,56,212,143,22,78,44,234,72,140,29,118,103,18,36,7,122,50,37,139,47,142,243,25,208,88,237,126,50,103,127,19,183,29,169,29,1,55,23,100,32,129,239,243,160,61,178,197,117,199,45,57,26,165,135,92,218,59,0,197,54,13,96,40,141,212,221,131,103,46,22,228,191,167,73,20,86,62,11,147,217,116,205,203,110,134,249,51,6,123,23,86,231,157,8,144,83,126,115,118,35,96,36,229,36,220,228,143,71,45,223,129,48,236,5,145,202,188,208,184,70,241,104,255,188,181,146,210,206,144,53,77,101,120,38,8,245,80,230,165,160,183,83,202,79,127,57,214,126,242,150,208,40,239,148,35,163,201,97,74,70,214,181,63,240,147,33,253,149,140,77,197,82,126,189,231,7,196,212,80,14,151,24,57,144,243,81,234,66,24,19,236,2,137,121,246,129,65,7,99,110,174,54,74,182,81,234,142,37,72,110,220,255,64,119,10,188,111,191,228,1,205,9,204,143,56,62,125,84,106,225,131,97,192,43,240,157,161,75,168,247,44,175,65,81,192,48,21,157,167,80,191,130,161,75,85,186,174,42,117,1,68,252,204,138,254,203,152,21,13,64,144,195,207,238,229,54,103,247,159,245,211,85,191,141,168,32,234,85,46,118,12,5,199,4,19,217,203,202,156,33,143,114,116,60,66,40,58,77,208,237,171,26,72,175,114,205,248,87,137,62,210,143,151,197,167,210,241,122,150,104,122,154,2,70,102,83,19,36,141,136,199,42,79,229,71,86,194,109,31,236,80,166,17,230,109,1,40,28,46,224,56,20,230,47,100,254,116,208,76,169,157,241,175,3,70,85,31,38,245,58,33,80,145,237,8,22,71,224,158,156,31,249,81,87,247,230,199,237,96,167,123,63,243,79,156,206,203,160,54,124,68,253,215,132,235,57,185,92,238,55,59,210,104,71,26,183,180,71,12,255,224,192,65,154,72,244,8,164,10,248,46,207,30,92,1,80,244,31,189,138,88,216,218,63,100,227,116,57,119,94,135,5,126,255,32,191,163,61,209,194,88,248,112,139,173,43,69,134,3,160,151,137,25,98,239,166,19,123,208,180,31,120,30,191,75,183,179,126,180,125,92,107,105,206,138,28,67,139,3,188,230,184,255,121,13,181,45,160,114,202,194,123,87,55,124,97,164,82,95,232,216,117,62,5,90,176,82,167,52,160,153,174,168,105,146,91,248,81,79,249,97,138,133,170,245,229,132,61,5,149,224,246,194,213,61,12,109,44,136,235,95,219,133,220,27,93,36,93,124,180,81,141,152,220,170,163,229,197,124,171,232,48,70,251,106,119,150,20,16,49,119,247,42,132,36,76,254,124,177,66,175,9,1,39,92,127,195,171,198,34,2,64,144,179,72,40,151,110,89,229,42,125,33,238,16,220,228,51,203,8,1,68,145,253,133,118,93,163,129,22,13,248,65,12,4,63,101,210,70,170,138,203,14,246,54,194,195,27,107,241,175,35,171,49,52,106,121,45,36,152,85,215,132,78,167,34,18,167,245,152,133,134,170,120,182,10,146,191,37,2,205,47,125,20,203,44,88,81,32,150,223,220,218,238,254,30,212,167,221,115,156,82,226,137,220,221,97,3,139,202,33,9,27,26,126,40,215,25,126,9,82,208,49,217,14,161,81,196,61,60,87,254,213,194,81,216,161,151,209,166,222,230,24,128,117,140,92,4,203,254,170,253,249,88,90,112,226,18,44,122,39,158,158,56,69,204,159,5,179,51,197,233,139,216,102,226,206,248,15,78,112,214,126,67,28,40,38,98,190,178,206,67,94,245,254,160,101,176,32,157,26,132,83,252,228,87,242,32,127,160,112,210,224,133,149,115,41,30,16,200,69,89,81,77,144,12,106,182,73,54,28,53,195,28,216,179,179,136,35,141,102,234,177,240,34,186,106,145,245,3,84,48,251,157,245,11,217,111,227,138,42,67,114,211,177,37,103,16,71,152,72,117,123,36,213,202,56,124,227,84,8,45,229,149,165,214,69,244,169,55,68,62,94,104,228,74,205,123,222,17,7,172,158,227,74,206,149,67,175,171,251,185,121,151,223,63,35,229,32,49,190,209,120,137,69,213,214,19,150,187,177,28,12,158,153,126,149,171,167,234,120,129,109,32,157,180,75,66,56,233,115,127,230,157,32,34,143,156,31,230,168,174,125,118,195,249,243,165,81,246,10,144,15,103,139,55,173,7,59,136,69,172,54,132,165,140,78,77,230,33,169,129,188,71,209,109,161,8,57,57,199,143,31,164,43,58,130,1,110,145,31,229,13,46,149,94,244,106,76,238,105,107,1,183,177,10,61,225,94,185,116,58,183,95,225,22,119,19,248,28,13,123,125,108,158,64,184,77,245,153,162,217,227,208,41,185,211,235,41,153,181,54,166,165,11,154,55,21,184,209,192,249,44,164,160,29,229,159,82,156,198,241,183,114,83,137,186,151,148,31,21,197,216,145,32,13,50,22,241,137,39,71,28,142,160,215,107,221,45,202,104,227,110,186,12,150,145,240,51,49,44,196,115,224,238,149,189,134,99,67,241,62,157,240,114,247,195,26,200,141,97,147,249,23,150,174,10,13,219,81,73,58,242,96,250,243,15,49,218,58,230,104,252,175,150,123,86,185,84,90,198,6,36,0,99,72,28,166,238,115,231,171,249,179,71,174,68,156,227,17,198,79,73,142,99,144,20,80,62,80,191,142,46,71,9,243,6,8,214,116,72,190,106,161,19,185,100,9,187,64,94,86,203,174,156,245,222,95,54,30,148,19,11,50,112,96,61,237,159,173,7,154,127,175,79,48,97,89,78,126,66,171,204,158,195,27,226,205,222,157,89,251,90,125,37,212,27,97,3,141,247,175,50,121,7,187,68,196,181,202,167,189,57,84,81,222,23,27,84,130,176,98,66,240,207,18,23,28,163,163,194,45,37,129,202,170,97,189,0,81,238,0,39,199,163,35,211,206,247,65,29,116,242,67,102,235,13,136,232,230,114,146,187,7,254,142,26,121,16,237,5,160,201,114,94,178,199,95,212,241,45,112,180,188,72,86,114,189,155,149,149,163,210,112,101,12,69,225,75,202,223,28,242,90,215,156,169,224,245,135,128,92,148,217,131,208,255,25,135,117,136,5,104,185,249,161,228,214,16,105,204,9,182,135,153,220,101,244,160,207,58,182,118,185,240,57,245,123,13,112,182,106,229,220,90,29,86,215,96,147,232,2,55,131,225,137,68,245,89,141,252,97,3,129,155,216,223,98,116,45,78,85,141,161,74,215,7,150,171,225,59,78,221,152,236,14,117,100,208,158,86,13,185,124,87,157,111,40,187,182,124,173,71,173,23,199,52,155,190,134,11,23,64,25,215,39,115,231,173,77,72,114,54,252,116,178,59,221,106,241,119,254,30,226,241,204,233,113,197,96,146,0,41,67,3,231,126,12,218,202,22,171,114,249,176,134,160,19,216,31,229,118,226,62,242,126,126,42,127,130,68,218,218,81,202,106,217,191,25,177,82,97,81,36,232,137,58,90,216,190,117,235,20,194,144,76,178,27,213,13,208,18,29,118,126,49,98,203,179,128,237,100,32,242,189,212,6,210,210,188,161,205,13,124,119,13,215,112,41,183,176,215,168,210,182,111,1,115,2,239,141,8,177,124,112,48,197,2,239,11,99,4,36,77,69,47,244,19,153,61,19,2,96,176,7,112,122,131,169,25,189,116,171,49,12,121,162,79,154,74,251,50,233,182,63,180,224,118,49,253,21,20,16,31,144,184,93,174,231,244,183,13,49,225,189,211,73,185,49,110,142,25,226,45,176,233,204,74,33,16,205,88,131,92,157,170,175,68,170,61,53,116,165,16,27,182,160,181,87,241,15,151,85,107,76,167,129,25,172,127,184,138,153,222,228,125,64,44,45,32,12,227,148,106,152,83,240,166,54,235,32,190,12,242,164,123,189,53,194,141,104,43,202,110,4,168,119,245,232,179,178,198,1,224,87,86,160,31,19,140,233,102,191,204,4,98,138,163,191,106,24,213,47,208,82,137,132,131,16,253,84,25,144,90,159,148,16,196,84,166,61,160,101,229,227,93,118,59,87,66,16,128,59,96,131,250,20,184,150,205,91,227,201,62,35,79,180,172,173,85,197,106,153,238,229,60,204,65,193,230,94,101,177,134,6,165,53,171,142,208,155,2,11,4,202,127,54,17,142,117,227,121,128,204,192,147,147,92,189,5,224,148,72,18,83,101,126,124,228,153,242,123,229,247,92,221,6,73,227,250,87,167,194,129,187,73,38,185,109,217,240,193,88,50,178,180,151,54,197,187,137,190,166,233,1,103,204,88,31,127,185,29,65,1,29,254,223,14,83,167,215,114,248,30,173,89,173,187,69,5,105,117,15,106,94,173,63,227,25,230,190,136,168,177,175,107,91,126,254,34,188,25,118,48,12,226,130,153,162,57,47,181,212,79,160,97,64,157,246,90,53,43,149,76,102,15,195,107,58,242,84,172,29,81,198,113,81,251,138,182,154,111,30,171,129,56,17,45,214,153,112,117,203,174,40,38,234,236,32,4,112,225,26,187,195,246,252,9,218,69,160,223,178,54,148,81,8,134,151,75,248,63,224,240,48,75,250,221,85,46,100,50,3,70,64,102,111,160,155,233,59,147,184,57,61,6,126,79,176,16,185,94,166,33,135,78,42,75,140,208,140,44,153,187,64,103,119,160,236,16,239,74,218,219,212,207,110,53,30,76,248,40,111,98,44,20,113,204,233,109,135,96,107,39,163,203,125,45,157,152,71,239,175,174,159,147,80,111,93,38,253,228,154,225,181,101,12,241,127,65,49,189,5,85,151,237,213,143,14,104,138,54,52,27,4,132,67,35,156,86,157,73,16,229,222,245,110,79,165,179,56,179,53,218,229,100,58,87,149,48,231,64,63,115,67,3,172,6,186,115,154,60,53,214,152,149,89,234,37,143,82,255,64,28,183,93,112,39,70,185,57,0,199,9,61,175,219,41,76,37,176,82,125,65,53,160,214,105,62,153,244,222,96,205,6,178,85,41,240,113,0,96,149,38,3,195,18,152,41,246,3,103,29,110,134,30,101,75,46,103,199,184,20,230,8,55,120,4,229,168,35,43,7,28,161,143,87,27,87,79,255,186,44,195,158,155,181,119,81,172,217,107,95,98,55,243,186,66,105,48,224,123,232,84,156,20,10,156,208,204,52,34,228,136,97,242,200,246,211,67,202,40,241,91,92,253,9,54,72,131,221,106,178,32,44,182,4,225,193,37,20,249,249,231,10,206,18,71,254,221,187,172,88,204,6,127,138,102,7,208,75,147,219,199,177,79,36,170,101,207,177,109,95,143,217,41,199,80,183,201,2,254,12,55,23,198,14,255,69,245,138,155,129,227,167,168,130,156,135,14,96,93,48,99,143,107,126,92,117,143,112,108,193,228,84,13,41,186,27,172,92,201,149,116,19,112,197,116,209,128,102,1,55,152,177,28,37,34,50,83,41,199,74,178,59,111,67,118,35,252,36,33,87,28,170,17,215,47,90,154,124,137,15,14,211,59,75,59,30,77,0,49,37,225,191,87,101,127,214,227,160,99,174,234,82,148,235,16,241,219,147,170,127,221,250,116,39,218,156,72,227,172,55,0,79,188,76,51,222,232,24,36,62,94,154,3,61,230,146,114,253,0,128,58,253,90,72,211,242,38,39,133,153,161,119,105,195,152,225,208,105,140,80,217,186,196,157,21,116,230,116,139,25,159,143,118,128,77,201,238,247,228,15,168,4,133,148,21,148,12,44,241,7,115,17,129,176,202,46,130,122,129,235,141,223,85,21,199,65,181,169,52,174,161,153,62,25,164,115,213,89,138,199,103,79,200,165,135,249,244,27,209,178,240,129,211,61,9,111,157,147,119,36,119,255,110,130,84,49,210,225,247,100,26,121,127,163,160,26,79,99,24,77,65,32,178,109,36,27,253,173,110,183,11,14,211,57,130,254,124,104,165,219,31,70,97,14,194,39,61,26,141,125,228,126,194,184,101,160,204,106,128,144,106,103,171,18,246,129,220,85,172,151,123,5,73,155,192,175,91,157,239,61,237,116,170,65,233,56,19,49,114,168,190,3,214,53,250,90,213,244,88,101,30,229,248,124,15,71,141,27,172,235,21,129,211,72,61,172,112,170,128,135,96,196,221,255,27,176,105,188,183,121,33,37,149,53,131,226,233,29,167,234,218,109,53,185,152,36,248,53,61,235,78,21,201,214,210,163,12,251,187,45,188,137,126,127,237,92,234,91,240,225,38,194,57,213,251,237,171,30,99,52,14,49,84,101,252,237,7,166,122,114,32,107,32,207,239,136,168,178,12,11,241,233,230,146,132,18,83,233,41,172,17,6,161,42,113,87,40,255,185,1,146,128,5,240,126,131,71,42,54,124,205,2,122,71,30,222,229,40,134,142,102,97,239,151,177,1,230,231,49,123,219,28,129,91,152,112,13,154,81,197,226,255,112,158,178,177,55,181,108,138,185,245,29,186,21,73,188,209,154,200,89,116,235,198,144,36,87,248,22,7,200,122,7,148,44,42,87,140,238,204,95,231,252,0,136,0,22,39,70,123,125,165,113,227,172,146,163,128,158,36,52,91,19,36,245,27,150,138,141,11,67,239,224,65,24,116,101,7,39,46,142,172,164,243,148,0,33,226,59,47,203,137,156,241,66,250,157,30,204,101,143,134,98,238,155,226,25,184,136,219,89,100,193,11,143,71,139,243,230,151,0,249,1,78,26,32,93,104,157,67,97,164,248,86,124,146,93,74,222,228,167,55,53,100,135,216,109,13,64,37,106,177,200,200,182,92,251,69,31,243,89,80,198,14,132,203,72,103,28,104,217,24,97,223,113,11,29,178,191,210,46,162,255,68,99,8,237,213,162,152,193,183,121,203,19,108,182,29,86,26,192,103,220,103,205,154,179,197,9,22,73,127,175,146,38,119,210,0,24,180,21,245,215,204,91,186,119,138,183,239,15,155,231,248,133,39,24,101,144,236,10,230,54,174,227,73,21,110,10,160,241,232,131,14,212,127,232,59,122,65,146,54,163,9,189,190,121,88,170,62,194,14,204,152,245,38,131,37,91,81,72,114,29,115,239,182,56,44,156,159,177,180,82,160,93,97,86,183,236,50,95,85,39,71,181,225,152,143,63,123,117,34,44,109,160,166,229,240,91,138,102,54,180,173,44,50,80,42,124,7,50,124,211,239,21,94,197,185,239,213,107,142,64,95,124,125,17,180,97,189,101,52,48,19,112,12,70,9,212,177,54,118,66,84,147,236,248,26,124,95,103,135,254,124,49,112,186,99,120,90,8,194,191,88,57,242,65,61,10,104,246,197,252,19,159,58,194,75,173,242,103,8,115,84,69,238,149,26,15,159,182,141,132,119,70,29,53,20,143,46,163,204,6,236,59,45,185,172,89,119,83,38,144,36,222,96,151,26,99,195,163,170,133,92,159,214,53,150,116,90,176,69,145,130,15,172,140,217,215,101,163,115,161,65,101,8,7,183,113,213,134,58,175,130,251,143,173,248,168,135,60,159,30,194,68,208,119,120,2,40,178,227,247,161,77,47,136,46,244,163,72,65,158,25,225,195,61,132,182,204,177,186,200,81,2,65,105,212,72,94,203,232,217,182,123,251,228,160,1,161,204,123,20,37,1,77,208,179,45,149,181,122,102,190,123,213,164,231,41,216,130,234,248,208,251,252,220,84,209,67,47,61,220,5,142,162,26,236,121,142,248,132,255,65,122,203,196,102,191,187,2,195,127,255,193,92,49,91,186,154,39,156,29,211,172,49,104,245,114,153,223,211,199,249,35,130,160,128,0,152,176,183,20,236,113,193,108,26,255,11,237,102,133,245,94,115,114,10,89,229,214,221,99,149,30,99,37,246,10,26,26,39,92,123,170,73,211,127,227,54,30,86,133,159,112,225,91,148,100,174,149,75,143,14,140,20,44,64,212,5,243,8,116,63,30,97,42,123,20,73,212,85,207,83,122,27,251,233,84,10,17,236,232,83,200,127,119,143,163,204,220,167,59,231,20,106,186,222,191,8,40,234,21,25,180,13,116,250,152,224,174,75,3,205,38,173,215,236,151,185,121,254,244,154,239,17,53,106,164,61,49,116,216,118,94,150,35,181,26,238,66,49,211,221,132,146,166,115,39,136,36,205,230,179,31,197,51,148,165,109,38,70,37,148,52,44,209,250,98,58,246,225,103,198,101,26,25,196,207,8,166,21,88,252,175,253,10,88,107,157,19,225,61,12,246,221,37,239,186,167,137,142,135,222,128,174,62,95,216,38,141,157,45,232,97,217,173,203,234,116,129,69,206,189,94,221,12,54,139,186,247,184,16,200,121,244,104,8,7,35,111,47,188,10,140,92,73,143,206,203,72,122,184,20,102,197,130,64,150,63,96,239,8,132,111,217,84,91,198,32,43,100,138,241,15,160,42,190,253,193,184,164,124,29,210,96,67,224,221,182,29,218,129,149,29,128,174,98,88,88,125,56,40,255,120,5,0,87,174,42,150,90,112,201,183,169,19,57,195,191,12,58,244,235,132,25,145,72,146,214,8,125,100,135,12,5,102,97,248,174,24,159,90,33,43,187,6,61,212,241,225,190,219,252,197,123,129,164,108,123,55,230,4,153,166,105,234,15,85,216,23,56,32,3,41,110,68,146,172,133,202,98,41,7,47,152,35,255,168,106,241,226,222,77,244,52,185,65,252,227,32,66,38,11,172,60,28,28,103,84,1,1,205,182,190,28,189,102,253,43,1,191,148,116,10,227,18,81,93,80,239,157,232,215,180,163,165,161,109,177,71,150,244,144,208,160,110,22,174,60,206,43,103,121,55,103,114,115,173,238,13,10,227,251,41,176,216,158,229,216,55,234,128,128,20,167,106,181,86,163,130,215,110,149,191,10,227,215,8,214,154,178,181,15,19,0,247,250,97,74,43,157,55,94,174,41,41,9,199,97,20,91,32,18,10,43,98,240,247,203,20,250,117,160,44,229,202,187,64,54,124,15,184,169,129,27,160,240,26,61,255,60,166,60,144,209,84,55,187,186,168,13,124,125,29,17,100,249,227,62,205,78,179,163,168,139,168,21,38,83,239,151,74,43,66,2,92,72,71,94,216,134,238,20,45,158,213,164,73,57,80,47,198,184,130,223,227,71,132,133,235,177,85,174,142,124,172,200,54,229,40,126,60,76,92,216,153,56,241,174,66,141,90,226,3,30,68,234,71,187,163,112,146,255,22,143,170,204,3,127,179,81,139,160,37,77,246,128,220,196,158,153,73,177,65,199,119,29,197,144,130,248,206,155,253,108,213,124,7,223,221,162,146,134,242,65,99,162,107,120,247,214,207,96,150,169,131,208,218,221,28,24,112,208,23,1,130,142,232,56,104,45,33,158,95,255,123,31,74,76,120,178,155,213,6,195,164,8,8,69,241,197,127,83,169,21,167,19,94,143,252,33,159,248,241,170,153,147,1,149,199,201,131,170,79,236,212,209,143,107,98,24,123,56,33,193,85,247,64,225,135,210,78,145,57,16,145,71,170,20,133,87,235,4,166,239,100,82,235,81,50,223,9,193,52,49,86,129,190,196,82,165,107,63,115,161,98,33,20,193,29,42,151,205,252,124,72,245,48,181,67,7,13,21,127,59,226,188,144,129,112,244,192,121,213,80,42,196,1,13,107,108,78,0,40,121,225,148,237,234,209,216,238,9,147,226,254,96,89,212,72,193,106,75,135,74,227,67,255,92,191,81,188,124,226,149,152,142,15,159,195,238,114,55,255,166,157,230,59,148,170,166,151,65,213,104,253,253,112,150,82,147,137,27,214,100,247,65,81,92,47,86,217,7,45,120,81,130,31,236,243,76,78,3,45,105,172,220,71,48,220,94,196,249,163,193,133,50,236,205,20,55,2,63,14,127,69,113,212,204,12,58,79,89,86,29,61,199,201,64,149,6,144,182,150,129,31,18,167,120,248,82,107,25,143,128,27,161,28,25,153,183,217,238,78,186,106,92,27,202,219,165,96,0,216,234,169,73,101,39,182,113,217,240,170,116,172,221,250,233,48,49,242,83,227,92,181,184,72,230,180,21,15,108,135,25,38,153,25,124,227,26,149,73,236,39,211,244,149,58,183,132,26,223,219,174,144,117,233,219,165,205,157,159,222,184,52,47,241,201,123,65,24,44,55,215,177,168,250,179,115,190,227,123,158,163,179,224,69,196,66,207,254,243,101,221,193,140,250,4,28,222,52,96,138,160,33,218,64,118,214,234,201,152,148,91,178,111,107,144,142,6,182,102,72,188,34,213,181,26,223,58,255,103,81,17,47,169,11,245,224,123,148,215,237,186,107,75,152,90,202,166,22,149,197,5,246,238,78,76,229,106,199,94,127,195,0,45,82,6,159,103,96,138,231,71,46,107,59,216,39,43,12,221,27,214,56,155,145,66,187,169,250,235,78,211,179,239,183,198,163,93,5,196,24,174,143,225,106,139,89,98,13,127,207,184,194,30,1,165,198,169,8,197,118,86,163,221,138,23,209,61,116,79,99,233,43,130,60,244,85,229,243,172,123,148,200,120,192,127,211,52,11,159,41,95,212,230,188,169,156,137,29,212,12,148,168,148,133,243,44,241,139,127,24,246,220,227,125,209,97,60,52,162,192,146,49,161,92,138,112,189,128,59,126,125,46,207,60,79,231,174,152,209,68,223,205,2,38,14,91,116,159,255,28,27,178,248,164,104,158,79,69,214,234,157,12,75,163,83,253,245,202,61,213,176,6,197,230,29,208,166,253,194,254,235,29,141,241,70,249,15,62,0,148,163,135,52,122,40,96,87,31,179,152,51,216,133,184,122,198,203,60,115,218,191,193,16,178,25,148,252,112,104,103,252,36,92,221,28,179,43,199,198,151,128,100,252,217,161,249,34,201,172,118,52,180,252,104,7,223,44,116,102,212,21,40,224,184,55,163,210,21,207,161,239,51,54,155,41,133,18,67,48,3,165,130,251,4,79,214,57,72,130,157,212,144],wye=[0,1,3,4,6,7,9,10,12,13,15,16,18,19,21,22,24,26,29,31,34,36,39,41,44,46,49,51,54,56,59,61,64,65,66,67,68,69,70,72,73,74,75,76,77,79,80,81,82,83,84,85,87,88,89,90,91,92,94,95,96,97,98,99,101,102,103,104,105,106,107,109,110,111,112,113,114,116,117,118,119,120,121,123,124,125,126,127,128,129,131,132,133,134,135,136,138,139,140,141,142,143,145,146,147,148,149,150,151,153,154,155,156,157,158,160,161,162,163,164,165,166,168,169,170,171,172,173,175,176,177,178,179,180,182,183,184,185,186,187,188,190,191,192,193,194,195,197,198,199,200,201,202,204,205,206,207,208,209,210,212,213,214,215,216,217,219,220,221,222,223,224,226,226,226,227,227,227,228,228,228,229,229,229,230,230,231,231,231,232,232,232,233,233,233,234,234,235,235,235,236,236,236,237,237,237,238,238,239,239,239,240,240,240,241,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],ade=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,32,33,35,36,37,39,40,42,43,44,46,47,49,50,51,53,54,56,57,58,59,61,62,63,64,66,67,68,69,71,72,73,74,76,77,78,79,81,82,83,84,86,87,88,90,91,92,93,95,96,97,98,100,101,102,103,105,106,107,108,110,111,112,113,115,116,117,118,120,121,122,124,125,126,127,129,130,131,132,134,135,136,137,139,140,141,142,144,145,146,147,149,150,151,152,154,155,156,158,159,160,161,163,164,165,166,168,169,170,171,173,174,175,176,178,179,180,181,183,184,185,186,188,189,190,192,193,194,195,197,198,199,200,202,203,204,205,207,208,209,210,212,213,214,215,217,218,219,220,222,223,224,226,226,226,227,227,228,228,229,229,230,230,231,231,232,232,233,233,234,234,234,235,235,236,236,237,237,238,238,239,239,240,240,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],Ome=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,43,44,45,46,47,48,50,51,52,53,54,55,56,58,59,60,61,62,63,65,66,67,68,69,70,72,73,74,76,77,78,80,81,83,84,85,87,88,89,91,92,94,95,96,98,99,100,102,103,105,106,107,109,110,111,113,114,116,117,118,120,121,122,124,125,127,128,129,131,132,133,135,136,138,139,140,142,143,144,146,147,149,150,151,153,154,155,157,158,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,192,193,193,194,195,195,196,197,197,198,199,199,200,201,201,202,203,203,204,205,205,206,207,207,208,209,209,210,211,211,212,213,213,214,215,215,216,217,217,218,219,219,220,221,221,222,223,223,224,225,225,226,227,227,228,229,229,230,231,231,232,233,233,234,235,235,236,237,237,238,239,239,240,241,241,242,243,243,244,245,245,246,247,247,248,249,249,250,251,251,252,253,253,254,255];class Dme extends J6{constructor(p,A,y,w){super(p,sde,y,w),a_(this,"inputTexture",void 0),a_(this,"lightLevel",.1),a_(this,"rednessLevel",.5),a_(this,"mskin_he_max",175/180*3.141593),a_(this,"mskin_he_min",115/180*3.141593),a_(this,"mskin_hc_max",173/180*3.141593),a_(this,"mskin_hc_min",116/180*3.141593),a_(this,"mskin_hc_axis",2.04203545),a_(this,"mfacts_rotate_c",0),a_(this,"mfacts_rotate_le",0),a_(this,"mfacts_rotate_ge",0),a_(this,"tab_addr",null),a_(this,"lutTextures",[]),this.inputTexture=A,this.init()}setUniforms(){const p=this.gl.getUniformLocation(this.program,"u_flipY"),A=this.gl.getUniformLocation(this.program,"u_denoiseLevel");this.gl.uniform1f(A,this.denoiseLevel),this.gl.uniform1f(p,1);const y=this.gl.getUniformLocation(this.program,"light");this.gl.uniform1f(y,this.lightLevel);const w=this.gl.getUniformLocation(this.program,"redness");this.gl.uniform1f(w,this.rednessLevel);const $=this.gl.getUniformLocation(this.program,"skin_he_max"),j=this.gl.getUniformLocation(this.program,"skin_he_min"),_e=this.gl.getUniformLocation(this.program,"skin_hc_max"),K=this.gl.getUniformLocation(this.program,"skin_hc_min"),_i=this.gl.getUniformLocation(this.program,"skin_hc_axis"),_o=this.gl.getUniformLocation(this.program,"facts_rotate_c"),_u=this.gl.getUniformLocation(this.program,"facts_rotate_le"),ch=this.gl.getUniformLocation(this.program,"facts_rotate_ge");this.gl.uniform1f($,this.mskin_he_max),this.gl.uniform1f(j,this.mskin_he_min),this.gl.uniform1f(_e,this.mskin_hc_max),this.gl.uniform1f(K,this.mskin_hc_min),this.gl.uniform1f(_i,this.mskin_hc_axis),this.gl.uniform1f(_o,this.mfacts_rotate_c),this.gl.uniform1f(_u,this.mfacts_rotate_le),this.gl.uniform1f(ch,this.mfacts_rotate_ge);const _f=this.gl.getUniformLocation(this.program,"u_originImage");this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.uniform1i(_f,2);const o_=["lighten_lut"],i_=[this.gl.TEXTURE3];for(let u_=0;u_<o_.length;u_++){const g_=this.gl.getUniformLocation(this.program,o_[u_]);this.gl.activeTexture(i_[u_]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.lutTextures[u_]),this.gl.uniform1i(g_,u_+3)}}setParameters(p){void 0!==p.denoiseLevel&&(this.denoiseLevel=p.denoiseLevel),void 0!==p.lightLevel&&(this.lightLevel=p.lightLevel),void 0!==p.rednessLevel&&(this.rednessLevel=p.rednessLevel,this.updateRedness(this.rednessLevel)),p.lighteningContrastLevel&&this.updateLut(p.lighteningContrastLevel)}init(){this.tab_addr=new Uint8Array(ade);const p=[this.tab_addr],A=[256],y=[1];for(let w=0;w<p.length;w++){const $=this.gl.createTexture();if(!$)throw new U_(N_.WEBGL_INTERNAL_ERROR,"create lut texture failed");this.gl.bindTexture(this.gl.TEXTURE_2D,$),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,A[w],y[w],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,p[w]),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.lutTextures.push($)}}updateRedness(p){let y,w,$=p,j=$;$>1&&($=1),$<0&&($=0),j>1&&(j=1),j<0&&(j=0),this.mfacts_rotate_c=.8*$,j<.8&&(j=0),this.mskin_he_max=175/180*3.141593,this.mskin_hc_max=173/180*3.141593,this.mskin_he_min=(115-4*j)/180*3.141593,this.mskin_hc_min=(116-4*j)/180*3.141593,this.mskin_hc_axis=(117-4*j)/180*3.141593,this.mskin_hc_axis<this.mskin_hc_min&&(this.mskin_hc_axis=this.mskin_hc_min),this.mskin_hc_min<1.5707965&&(this.mskin_hc_min=1.5707965),this.mskin_hc_axis<1.5707965&&(this.mskin_hc_axis=1.5707965),this.mskin_he_min<1.5707965&&(this.mskin_he_min=1.5707965),this.mskin_hc_max>3.141593&&(this.mskin_hc_max=3.141593),this.mskin_hc_axis>3.141593&&(this.mskin_hc_axis=3.141593),this.mskin_he_max>3.141593&&(this.mskin_he_max=3.141593),y=this.mskin_he_max-this.mskin_hc_max,w=this.mskin_hc_max-this.mskin_hc_axis,this.mfacts_rotate_ge=y>.01?this.mfacts_rotate_c*w/y:this.mfacts_rotate_c,y=this.mskin_hc_min-this.mskin_he_min,w=this.mskin_hc_axis-this.mskin_hc_min,this.mfacts_rotate_le=y>.01?this.mfacts_rotate_c*w/y:this.mfacts_rotate_c}updateLut(p){let A=null;if(0===p&&(A=ade),1===p&&(A=Ome),2===p&&(A=wye),!A)throw new U_(N_.WEBGL_INTERNAL_ERROR,"invalid ylut_table value:"+p);this.tab_addr=new Uint8Array(A);const y=[this.tab_addr],w=[256],$=[1];for(let j=0;j<y.length;j++)this.gl.bindTexture(this.gl.TEXTURE_2D,this.lutTextures[j]),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,w[j],$[j],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,y[j])}}class Tye{constructor(){a_(this,"gl",null),a_(this,"canvas",null),a_(this,"programs",[]),a_(this,"commonProgram",null),a_(this,"inputTexture",null),a_(this,"outputTextures",[]),a_(this,"fbos",[]),a_(this,"originalFrameWidth",0),a_(this,"originalFrameHeight",0),a_(this,"enableBeauty",!1),a_(this,"denoiseLevel",5),a_(this,"lightLevel",.35),a_(this,"rednessLevel",.5),a_(this,"lighteningContrastLevel",1)}setEnableBeauty(p){this.enableBeauty=!!p}init(p,A,y){if(!bN().supportWebGL)throw new U_(N_.NOT_SUPPORTED,"your browser is not support webGL");if(this.gl=y.getContext("webgl"),!this.gl)throw new U_(N_.WEBGL_INTERNAL_ERROR,"can not get webgl context");if(this.initGL(p,A),!this.inputTexture)throw new U_(N_.WEBGL_INTERNAL_ERROR,"can not find input texture");this.canvas=y,this.programs.push(new Tme(this.gl)),this.programs.push(new bye(this.gl,p,A)),this.programs.push(new noe(this.gl,p,A)),this.programs.push(new Cye(this.gl,p,A)),this.programs.push(new Dme(this.gl,this.inputTexture,p,A)),this.commonProgram=this.programs[0].program,this.setDenoiseLevel(this.denoiseLevel),this.setLightLevel(this.lightLevel),this.setRednessLevel(this.rednessLevel),this.setContrastLevel(this.lighteningContrastLevel)}render(p){if(!this.gl||!this.commonProgram||!this.canvas)return void h_.warning("video effect manager is not init!");let A=0;if(this.originalFrameHeight===p.videoWidth&&this.originalFrameWidth===p.videoHeight)A=2;else if(this.originalFrameHeight!==p.videoHeight||this.originalFrameWidth!==p.videoWidth){if(h_.debug("beauty effect: resolution changed ".concat(this.originalFrameWidth,"x").concat(this.originalFrameHeight," -> ").concat(p.videoWidth,"x").concat(p.videoHeight)),0===p.videoHeight||0===p.videoWidth)return void h_.debug("beauty effect: skip 0 resolution frame");this.canvas.width=p.videoWidth,this.canvas.height=p.videoHeight,p.setAttribute("width",p.videoWidth.toString()),p.setAttribute("height",p.videoHeight.toString()),this.release(),this.init(p.videoWidth,p.videoHeight,this.canvas)}this.gl.viewport(0,0,p.videoWidth,p.videoHeight),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,p);const y=this.enableBeauty?this.programs.length-1:0;for(let $=0;$<=y;$++){const j=this.programs[$].program;this.gl.useProgram(j);const _e=this.gl.getUniformLocation(j,"u_image");this.programs[$].setUniforms(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fbos[A+$%2]),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.outputTextures[A+$%2]),this.gl.uniform1i(_e,0)}this.gl.useProgram(this.commonProgram);const w=this.gl.getUniformLocation(this.commonProgram,"u_flipY");this.gl.uniform1f(w,-1),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}setDenoiseLevel(p){this.programs.forEach(A=>{A instanceof J6&&A.setParameters({denoiseLevel:p})}),this.denoiseLevel=p}setLightLevel(p){this.programs.forEach(A=>{A instanceof J6&&A.setParameters({lightLevel:p})}),this.lightLevel=p}setRednessLevel(p){this.programs.forEach(A=>{A instanceof J6&&A.setParameters({rednessLevel:p})}),this.rednessLevel=p}setContrastLevel(p){this.programs.forEach(A=>{A instanceof J6&&A.setParameters({lighteningContrastLevel:p})}),this.lighteningContrastLevel=p}setSize(p,A){this.programs.forEach(y=>{y instanceof J6&&y.setSize(p,A)})}release(){this.gl=null,this.commonProgram=null,this.inputTexture=null,this.programs=[],this.outputTextures=[],this.fbos=[]}initGL(p,A){if(!this.gl)throw new U_(N_.WEBGL_INTERNAL_ERROR,"can not find webgl context");this.inputTexture=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);for(let y=0;y<4;y++){const w=this.gl.createTexture();if(!w)throw new U_(N_.WEBGL_INTERNAL_ERROR,"create texture failed");this.gl.bindTexture(this.gl.TEXTURE_2D,w),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),y<2?this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,p,A,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null):this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,A,p,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null);const $=this.gl.createFramebuffer();if(!$)throw new U_(N_.WEBGL_INTERNAL_ERROR,"create frame buffer failed");this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,$),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,w,0),this.outputTextures.push(w),this.fbos.push($)}this.gl.viewport(0,0,p,A),this.originalFrameWidth=p,this.originalFrameHeight=A}}class Nme{constructor(){a_(this,"targetFrameRate",0),a_(this,"recordedFrameCount",0),a_(this,"recordingTime",2),a_(this,"recordID",void 0)}startRecordBeautyEffectOutput(p){var A=arguments,y=this;return f(function*(){let w=A.length>1&&void 0!==A[1]?A[1]:4;if(y.recordID)throw new U_(N_.UNEXPECTED_ERROR,"another beauty effect recording is in progress");const $=VT(6,"");return y.recordID=$,y.targetFrameRate=p,y.recordedFrameCount=0,y.recordingTime=w,yield pR(1e3*y.recordingTime),y.recordID!==$?(y.recordID=void 0,!0):(y.recordID=void 0,y.recordedFrameCount<y.targetFrameRate*y.recordingTime/2?(h_.warning("detect beauty effect overload, current framerate",y.recordedFrameCount/2),!1):(h_.debug("beauty effect current framerate",y.recordedFrameCount/2),!0))})()}stopRecordBeautyEffectOutput(){this.targetFrameRate=0,this.recordedFrameCount=0,this.recordID=void 0}addFrame(){this.recordID&&(this.recordedFrameCount+=1)}}class kme extends eoe.exports.VideoProcessor{constructor(){super(),a_(this,"name","BeautyProcessor"),a_(this,"fps",15),a_(this,"canvas",void 0),a_(this,"video",void 0),a_(this,"manager",void 0),a_(this,"overloadDetector",new Nme),a_(this,"stopChromeBackgroundLoop",null),a_(this,"onOverload",void 0),a_(this,"stopLoop",void 0),a_(this,"lastRenderTime",0),this.fps=30,this.manager=new Tye,this._enabled=!1}onEnableChange(p){var A=this;return f(function*(){A.manager.setEnableBeauty(p),A.context&&A.inputTrack&&(p?yield A.startEffect(A.inputTrack,A.context):yield A.stopEffect(A.inputTrack,A.context))})()}setBeautyEffectOptions(p){var A=this;return f(function*(){if(void 0!==(y=p).smoothnessLevel&&iT(y.smoothnessLevel,"options.smoothnessLevel",0,1,!1),void 0!==y.lighteningLevel&&iT(y.lighteningLevel,"options.lighteningLevel",0,1,!1),void 0!==y.rednessLevel&&iT(y.rednessLevel,"options.rednessLevel",0,1,!1),void 0!==y.lighteningContrastLevel&&RR(y.lighteningContrastLevel,"options.lighteningContrastLevel",[0,1,2]),void 0!==p.smoothnessLevel){const y=Math.max(.1,10*p.smoothnessLevel);A.manager.setDenoiseLevel(y)}var y;if(void 0!==p.lighteningLevel){const y=Math.max(.1,p.lighteningLevel/2);A.manager.setLightLevel(y)}if(void 0!==p.rednessLevel){const y=Math.max(.01,p.rednessLevel);A.manager.setRednessLevel(y)}void 0!==p.lighteningContrastLevel&&A.manager.setContrastLevel(p.lighteningContrastLevel)})()}onTrack(p,A){var y=this;return f(function*(){var w;y.video&&y.enabled&&(null===(w=y.stopLoop)||void 0===w||w.call(y),yield y.stopEffect(p,A)),yield y.startEffect(p,A)})()}startEffect(p,A){var y=this;return f(function*(){if(!y.enabled)return;const w=Y1(),$=yield y.renderWithWebGL(p);y.output($,A),h_.info("start video effect, output:",y.outputTrack),y.overloadDetector.startRecordBeautyEffectOutput(y.fps).then(K=>{K||y.onOverload&&y.onOverload()});let j=!1;y.stopLoop=()=>{j=!0};const _e=()=>{y.enabled&&!j&&requestAnimationFrame(_e);const K=Date.now(),_i=1e3/y.fps,_o=y.lastRenderTime?K-y.lastRenderTime:_i;_o<_i||(y.lastRenderTime=K-(_o-_i),y.video&&y.video.paused&&y.video.play(),y.enabled&&y.video&&(y.manager.render(y.video),y.outputTrack&&y.outputTrack.requestFrame&&y.outputTrack.requestFrame(),y.overloadDetector.addFrame()))};requestAnimationFrame(_e),w.name===C1.CHROME&&document.addEventListener("visibilitychange",()=>{document.hidden?y.stopChromeBackgroundLoop=QK(()=>{y.enabled&&y.video&&y.manager.render(y.video),y.outputTrack&&y.outputTrack.requestFrame&&y.outputTrack.requestFrame(),y.overloadDetector.addFrame()},y.fps):y.stopChromeBackgroundLoop&&(y.stopChromeBackgroundLoop(),y.stopChromeBackgroundLoop=null)},!1)})()}renderWithWebGL(p){var A=this;return f(function*(){A.canvas&&(A.canvas.remove(),A.canvas=void 0),A.video&&(A.video.remove(),A.video=void 0),A.canvas=document.createElement("canvas"),A.video=document.createElement("video"),A.video.setAttribute("autoplay",""),A.video.setAttribute("muted",""),A.video.muted=!0,A.video.setAttribute("playsinline",""),A.video.setAttribute("style","display:none"),A.video.srcObject=new MediaStream([p]);const y=new iI(K=>{const _i=()=>{A.video&&A.video.removeEventListener("playing",_i),K(void 0)};A.video&&A.video.addEventListener("playing",_i)});A.video.play(),yield y;const w=p.getSettings(),$=w.width||A.video.videoWidth,j=w.height||A.video.videoHeight;if(w.frameRate&&A.fps!==w.frameRate&&(A.fps=w.frameRate,h_.debug("beauty video processor: set fps to",A.fps)),h_.debug("beauty video processor: width ".concat($," height ").concat(j)),!$||!j)throw new U_(N_.BEAUTY_PROCESSOR_INTERNAL_ERROR,"can not get track resolution");A.canvas.width=$,A.canvas.height=j,A.video.setAttribute("width",$.toString()),A.video.setAttribute("height",j.toString()),A.manager.init($,j,A.canvas);const _e=bN();return A.canvas.captureStream(_e.supportRequestFrame?0:A.fps).getVideoTracks()[0]})()}stopEffect(p,A){var y=this;return f(function*(){h_.info("stop video effect"),y.overloadDetector.stopRecordBeautyEffectOutput(),y.manager.release(),y.canvas&&y.canvas.remove(),y.video&&y.video.remove(),y.canvas=void 0,y.video=void 0,y.output(p,A)})()}}function cde(s){const p={};if(s.facingMode&&(p.facingMode=s.facingMode),s.cameraId&&(p.deviceId={exact:s.cameraId}),!s.encoderConfig)return p;const A=M8(s.encoderConfig);return p.width=A.width,p.height=A.height,!ife()&&A.frameRate&&(p.frameRate=A.frameRate),Y1().name===C1.EDGE&&"object"==typeof p.frameRate&&(p.frameRate.max=60),X2()&&(p.frameRate={ideal:30,max:30}),p}function Sye(s){const p={};s.screenSourceType&&(p.mediaSource=s.screenSourceType),s.extensionId&&nZ()&&(p.extensionId=s.extensionId),s.electronScreenSourceId&&(p.sourceId=s.electronScreenSourceId);const A=s.encoderConfig?nce(s.encoderConfig):null;return p.mandatory={chromeMediaSource:"desktop",maxWidth:A?A.width:void 0,maxHeight:A?A.height:void 0},A&&A.frameRate&&("number"==typeof A.frameRate?(p.mandatory.maxFrameRate=A.frameRate,p.mandatory.minFrameRate=A.frameRate):(p.mandatory.maxFrameRate=A.frameRate.max||A.frameRate.ideal||A.frameRate.exact||void 0,p.mandatory.minFrameRate=A.frameRate.min||A.frameRate.ideal||A.frameRate.exact||void 0),p.frameRate=A.frameRate),A&&A.width&&(p.width=A.width),A&&A.height&&(p.height=A.height),p}function ude(s){const p={};if(ife()||(void 0!==s.AGC&&(p.autoGainControl=s.AGC),void 0!==s.AEC&&(p.echoCancellation=s.AEC),void 0!==s.ANS&&(p.noiseSuppression=s.ANS,nZ()&&s.ANS&&(p.googHighpassFilter=s.ANS))),s.encoderConfig){const A=nO(s.encoderConfig);p.channelCount=A.stereo?2:1,p.sampleRate=A.sampleRate,p.sampleSize=A.sampleSize}return s.microphoneId&&(p.deviceId={exact:s.microphoneId}),ofe()&&(p.sampleRate=void 0),p}var cY,roe;(function(s){s.COVERED="COVERED",s.POSITION="POSITION",s.SIZE="SIZE",s.STYLE="STYLE"})(cY||(cY={})),function(s){s.UNMOUNTED="UNMOUNTED",s.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT"}(roe||(roe={}));var Pme,o,e,i,d,_,B,_t,_a,_h,_g,l_,f_,R_,H_,W_,R0,H0,CI,LI,xI,DI,_C,G1=new class{constructor(){a_(this,"_clientSize",null),a_(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),a_(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),a_(this,"getStyle",s=>window.getComputedStyle(s,null)),a_(this,"checkCssVisibleProperty",s=>{let p=!0;const A=this.getStyle(s),{display:y,visibility:w,opacity:$,filter:j}=A;return("none"===y||["hidden","collapse"].includes(w)||Number($)<.1)&&(p=!1),!!p&&(j&&j.split(" ").filter(_e=>{const K=_e.split("(")[0];return["brightness","blur","opacity"].includes(K)}).map(_e=>{const[K,_i]=_e.split(/\(|\)/);return[K,Number(_i.match(/^[0-9\.]+/))]}).forEach(_e=>{const[K,_i]=_e;switch(K){case"brightness":(_i<.1||_i>3)&&(p=!1);break;case"blur":_i>3&&(p=!1);break;case"opacity":_i<.1&&(p=!1)}}),p)}),a_(this,"checkPropertyUpToAllParentNodes",(s,p)=>{let A=!0,y=!0;let $=s;for(;$&&y;)p($)||(A=!1,y=!1),$=$.parentElement,$||(y=!1);return A}),a_(this,"checkActualCssVisibleIncludeInherit",s=>this.checkPropertyUpToAllParentNodes(s,this.checkCssVisibleProperty)),a_(this,"getSizeAboutClient",s=>{const{width:p,height:A,left:y,right:w,top:$,bottom:j}=s.getBoundingClientRect(),_e=this.getClientWidth(),K=this.getClientHeight();return{width:p,height:A,left:y,right:w,top:$,bottom:j,clientWidth:_e,clientHeight:K,clientMin:Math.min(_e,K)}}),a_(this,"checkActualSize",()=>{const{width:s,height:p,clientMin:A}=this._clientSize;return this.checkSizeIsVisible(s,p,A)}),a_(this,"elementFromPoint",(s,p)=>document.elementFromPoint?document.elementFromPoint(s,p):null),a_(this,"checkCoverForAPoint",(s,p,A)=>{const y=this.elementFromPoint(s,p);return null!==y&&y!==A}),a_(this,"getPointPositionList",()=>{const{width:s,height:p,left:A,top:y}=this._clientSize,w=s/6,$=p/6,j=[],_e=10**6;for(let K=0;K<5;K++)for(let _i=0;_i<5;_i++)j.push({x:(A*_e+(0===K?.1:4===K?(w*K*_e-1e5)/_e:w*K)*_e)/_e,y:(y*_e+(0===_i?.1:4===_i?($*_i*_e-1e5)/_e:$*_i)*_e)/_e});return[...j]}),a_(this,"checkElementCover",s=>this.getPointPositionList().map(p=>this.checkCoverForAPoint(p.x,p.y,s)).filter(p=>!!p).length>6),a_(this,"checkSizeIsVisible",(s,p,A)=>(s>50||A/s<=10)&&(p>50||A/p<=10)),a_(this,"checkSizeOfPartInClient",()=>{const{left:s,right:p,top:A,bottom:y,clientHeight:w,clientWidth:$,clientMin:j}=this._clientSize;let _e,K,_i,_o;if(s<0)_e=0;else{if(!(s<$))return!1;_e=s}if(p<0)return!1;if(K=p<$?p:$,A<0)_i=0;else{if(!(A<w))return!1;_i=A}return!(y<0)&&(_o=y<w?y:w,this.checkSizeIsVisible(K-_e,_o-_i,j))}),a_(this,"returnHiddenResult",s=>(this._clientSize=null,{visible:!1,reason:s})),a_(this,"checkOneElementVisible",s=>{if(s instanceof HTMLElement){if(this.checkElementIsMountedOnDom(s)){if(this.checkActualCssVisibleIncludeInherit(s)){if(this._clientSize=this.getSizeAboutClient(s),this.checkElementCover(s))return this.returnHiddenResult(cY.COVERED);{const p=this.checkActualSize(),A=this.checkSizeOfPartInClient();return p&&!A?this.returnHiddenResult(cY.POSITION):p?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(cY.SIZE)}}return this.returnHiddenResult(cY.STYLE)}return this.returnHiddenResult(roe.UNMOUNTED)}return this.returnHiddenResult(roe.INVALID_HTML_ELEMENT)}),a_(this,"checkElementIsMountedOnDom",s=>this.checkPropertyUpToAllParentNodes(s,p=>"HTML"!==p.nodeName.toUpperCase()?null!==p.parentElement:!!document.documentElement))}};function BR(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function p2(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?BR(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):BR(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}let yS=(Pme=TR("LocalVideoTrack","getTrackId"),o=jT(),e=H4("LocalVideoTrack","_enabledMutex"),i=jT(),d=H4("LocalVideoTrack","_enabledMutex"),_=jT(),B=VK({report:w0}),_t=jT(),_a=jT(),_h=jT(),_g=jT(),l_=jT(),f_=jT(),R_=jT(),Pme((gI((W_=class X0e extends F6{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==yO.PLAYING)}constructor(p,A,y,w,$,j){super(p,$),a_(this,"trackMediaType","video"),a_(this,"_player",void 0),a_(this,"_videoBeautyProcessor",void 0),a_(this,"_videoVisibleTimer",null),a_(this,"_previousVideoVisibleStatus",void 0),a_(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),a_(this,"_encoderConfig",void 0),a_(this,"_scalabiltyMode",{numSpatialLayers:1,numTemporalLayers:1}),a_(this,"_optimizationMode",void 0),a_(this,"_videoHeight",void 0),a_(this,"_videoWidth",void 0),a_(this,"_forceBitrateLimit",void 0),a_(this,"_enabled",!0),a_(this,"processorDestination",void 0),a_(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this._encoderConfig=A,this._scalabiltyMode=y,this._optimizationMode=w,this._hints=j||[],-1===this._hints.indexOf(DR.SCREEN_TRACK)&&this.updateBitrateFromProfile(),this.processorContext=new tIe(this.getTrackId()),this.processorDestination=new eIe(this.processorContext),this.bindProcessorDestinationEvents()}play(p){let A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const y=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.LOCAL_VIDEO_TRACK_PLAY,options:[this.getTrackId(),"string"==typeof p?p:"HTMLElement",A]});if("string"==typeof p){const $=document.getElementById(p);$?p=$:(h_.warning("[".concat(this.getTrackId(),'] can not find "#').concat(p,'" element, use document.body')),sI("warning",this,'can not find "#'.concat(p,'" element, use document.body')),p=document.body)}h_.debug("[".concat(this.getTrackId(),"] start video playback"),JSON.stringify(A)),S0("debug",this,"play",A);const w=p2(p2(p2({},this._getDefaultPlayerConfig()),A),{},{trackId:this.getTrackId(),element:p});this._player?this._player.updateConfig(w):(this._player=new f2(w),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const $=this.getVideoElementVisibleStatus();this.emit(FL.VIDEO_ELEMENT_VISIBLE_STATUS,$)}catch($){}},v0("CHECK_VIDEO_VISIBLE_INTERVAL")),y.onSuccess()}stop(){const p=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.LOCAL_VIDEO_TRACK_STOP,options:[this.getTrackId()]});if(!this._player)return p.onSuccess();this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,h_.debug("[".concat(this.getTrackId(),"] stop video playback")),S0("debug",this,"stop"),p.onSuccess()}setEnabled(p,A){var y=this;return f(function*(){if(!A){if(p===y._enabled)return;y.stateCheck("enabled",p)}if(h_.info("[".concat(y.getTrackId(),"] start setEnabled"),p),S0("info",y,"setEnabled",p),!p){y._originMediaStreamTrack.enabled=!1;try{yield wT(y,mI.NEED_DISABLE_TRACK,y)}catch(w){throw h_.error("[".concat(y.getTrackId(),"] setEnabled to false error"),w.toString()),S0("error",y,"setEnabled",p,w.toString()),w}return A||(y._enabled=!1),h_.info("[".concat(y.getTrackId(),"] setEnabled to false success")),void S0("info",y,"setEnabled",p,"success")}y._originMediaStreamTrack.enabled=!0;try{yield wT(y,mI.NEED_ENABLE_TRACK,y)}catch(w){throw h_.error("[".concat(y.getTrackId(),"] setEnabled to true error"),w.toString()),S0("error",y,"setEnabled",p,w.toString()),w}h_.info("[".concat(y.getTrackId(),"] setEnabled to true success")),S0("info",y,"setEnabled",p,"success"),A||(y._enabled=!0)})()}setMuted(p){var A=this;return f(function*(){p!==A._muted&&(A.stateCheck("muted",p),A._muted=p,A._mediaStreamTrack.enabled=!p,h_.debug("[".concat(A.getTrackId(),"] start set muted: ").concat(p)),S0("debug",A,"setMuted",p),p?yield wT(A,mI.NEED_MUTE_TRACK,A):yield wT(A,mI.NEED_UNMUTE_TRACK,A))})()}getStats(){return YK(()=>{h_.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead"),sI("warning",this,"[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),o3(this,mI.GET_STATS)||p2({},Are)}setBeautyEffect(p){var A=arguments,y=this;return f(function*(){let w=A.length>1&&void 0!==A[1]?A[1]:{};const $=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.LOCAL_VIDEO_TRACK_BEAUTY,options:[y.getTrackId(),p,w]});if(p||y._videoBeautyProcessor){if(efe()===wR.IOS||efe()===wR.ANDROID){const j=new U_(N_.INVALID_OPERATION,"can not enable beauty effect on mobile device");throw $.onError(j),j}if(!y._enabled&&p){const j=new U_(N_.TRACK_IS_DISABLED,"can not enable beauty effect when track is disabled");throw $.onError(j),j}if(h_.info("[".concat(y.getTrackId(),"] start setBeautyEffect"),p,JSON.stringify(w)),S0("info",y,"setBeautyEffect",[p,w]),y._videoBeautyProcessor||p){try{if(!y._videoBeautyProcessor)if(y._videoBeautyProcessor=new kme,y.processor){const j=y.processor;y.pipe(y._videoBeautyProcessor).pipe(j)}else y.pipe(y._videoBeautyProcessor).pipe(y.processorDestination);yield y._videoBeautyProcessor.setBeautyEffectOptions(w),p?yield y._videoBeautyProcessor.enable():yield y._videoBeautyProcessor.disable()}catch(j){throw h_.error("[".concat(y.getTrackId(),"] setBeautyEffect error"),j.toString()),S0("info",y,"setBeautyEffect",[p,w]),$.onError(j),j}h_.info("[".concat(y.getTrackId(),"] setBeautyEffect success")),S0("info",y,"setBeautyEffect",[p,w],"success"),$.onSuccess()}else $.onSuccess()}})()}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}clone(p,A,y,w){const $=this._mediaStreamTrack.clone();return new X0e($,p,A,y,w)}setBitrateLimit(p){var A=this;return f(function*(){if(h_.debug("[".concat(A.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(p))),S0("debug",A,"setBitrateLimit",p),p){A._forceBitrateLimit=p,A._encoderConfig&&(A._encoderConfig.bitrateMax=A._encoderConfig.bitrateMax&&A._encoderConfig.bitrateMax<p.max_bitrate?A._encoderConfig.bitrateMax:p.max_bitrate,A._encoderConfig.bitrateMin=p.min_bitrate);try{yield wT(A,mI.NEED_UPDATE_VIDEO_ENCODER,A)}catch(y){return y.throw()}}})()}setOptimizationMode(p){var A=this;return f(function*(){if("motion"!==p&&"detail"!==p&&"balanced"!==p)return h_.error(N_.INVALID_PARAMS,"optimization mode must be motion, detail or balanced"),void S0("error",A,"setOptimizationMode",p,N_.INVALID_PARAMS);const y=A._optimizationMode;try{A._optimizationMode=p,yield wT(A,mI.SET_OPTIMIZATION_MODE,A)}catch(w){throw A._optimizationMode=y,h_.error("[".concat(A.getTrackId(),"] set optimization mode failed"),w.toString()),S0("error",A,"setOptimizationMode",p,w.toString()),w}h_.info("[".concat(A.getTrackId(),"] set optimization mode success (").concat(p,")")),S0("info",A,"setOptimizationMode",p,"success")})()}setScalabiltyMode(p){if(1===p.numSpatialLayers&&1!==p.numTemporalLayers)return h_.error(N_.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),S0("error",this,"setScalabiltyMode",p,N_.INVALID_PARAMS),void(this._scalabiltyMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabiltyMode=p,h_.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(p,")")),S0("info",this,"setScalabiltyMode",p,"success")}updateMediaStreamTrackResolution(){mge(this._originMediaStreamTrack).then(p=>{let[A,y]=p;this._videoHeight=y,this._videoWidth=A}).catch(pie)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:p,height:A,frameRate:y}=this.getMediaStreamTrackSettings();if(!p||!A||!y)return;const[w,$]=function(j,_e,K){const _i=v0("BITRATE_ADAPTER_TYPE");let _o;const _u=200*Math.pow(K/15,.6)*Math.pow(j*_e/640/360,.75),ch=_u;if("STANDARD_BITRATE"===_i)_o=4*_u;else{if("COMPATIABLE_BITRATE"!==_i)return;_o=2*_u}return[Math.floor(_o),Math.floor(ch)]}(p,A,y)||[void 0,void 0];this._encoderConfig.bitrateMin||this._encoderConfig.bitrateMax||(this._encoderConfig.bitrateMin=$,this._encoderConfig.bitrateMax=w,h_.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(p,", h: ").concat(A,", fps: ").concat(y,"] => [brMax: ").concat(w,", brMin: ").concat($,"]")),S0("debug",this,"updateBitrateFromProfile",void 0,"[w: ".concat(p,", h: ").concat(A,", fps: ").concat(y,"] => [brMax: ").concat(w,", brMin: ").concat($,"]")))}getVideoElementVisibleStatus(){try{var p,A;const y=null==this||null===(p=this._player)||void 0===p?void 0:p.getContainerElement(),w={track:this,element:null==this||null===(A=this._player)||void 0===A?void 0:A.getVideoElement(),slot:null==y?void 0:y.parentElement},{element:$,slot:j}=w;if(this.isPlaying&&$ instanceof HTMLVideoElement&&j instanceof HTMLElement){const _e=G1.checkOneElementVisible($),K=Object.assign({},_e);if(K.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=K.visible;w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]}).onSuccess(K.visible?"Video is visible":"Invisible because of ".concat(K.reason))}return K}return}catch(y){throw new U_(N_.GET_VIDEO_ELEMENT_VISIBLE_ERROR,y.message)}}renewMediaStreamTrack(p){return f(function*(){})()}pipe(p){if(this._videoBeautyProcessor&&p!==this._videoBeautyProcessor)return this._videoBeautyProcessor.pipe(p);if(this.processor===p)return p;if(p._source)throw new U_(N_.INVALID_OPERATION,"Processor ".concat(p.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=p,this.processor._source=this,p.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),p}unpipe(){if(!this.processor)return;const p=this.processor;this.processor._source=void 0,this.processor=void 0,p.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}bindProcessorDestinationEvents(){var p=this;this.processorDestination.on(tP.ON_TRACK,function(){var A=f(function*(y){y?y!==p._mediaStreamTrack&&(p._mediaStreamTrack=y,p._updatePlayerSource(),yield wT(p,mI.NEED_REPLACE_TRACK,p)):p._mediaStreamTrack!==p._originMediaStreamTrack&&(p._mediaStreamTrack=p._originMediaStreamTrack,p._updatePlayerSource(),yield wT(p,mI.NEED_REPLACE_TRACK,p))});return function(y){return A.apply(this,arguments)}}())}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(tP.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(a2.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(a2.REQUEST_CONSTRAINTS)}}).prototype,"play",[o],Object.getOwnPropertyDescriptor(W_.prototype,"play"),W_.prototype),gI(W_.prototype,"setEnabled",[e,i],Object.getOwnPropertyDescriptor(W_.prototype,"setEnabled"),W_.prototype),gI(W_.prototype,"setMuted",[d,_,B],Object.getOwnPropertyDescriptor(W_.prototype,"setMuted"),W_.prototype),gI(W_.prototype,"getStats",[_t],Object.getOwnPropertyDescriptor(W_.prototype,"getStats"),W_.prototype),gI(W_.prototype,"setBeautyEffect",[_a],Object.getOwnPropertyDescriptor(W_.prototype,"setBeautyEffect"),W_.prototype),gI(W_.prototype,"getCurrentFrameData",[_h],Object.getOwnPropertyDescriptor(W_.prototype,"getCurrentFrameData"),W_.prototype),gI(W_.prototype,"setBitrateLimit",[_g],Object.getOwnPropertyDescriptor(W_.prototype,"setBitrateLimit"),W_.prototype),gI(W_.prototype,"setOptimizationMode",[l_],Object.getOwnPropertyDescriptor(W_.prototype,"setOptimizationMode"),W_.prototype),gI(W_.prototype,"setScalabiltyMode",[f_],Object.getOwnPropertyDescriptor(W_.prototype,"setScalabiltyMode"),W_.prototype),gI(W_.prototype,"updateMediaStreamTrackResolution",[R_],Object.getOwnPropertyDescriptor(W_.prototype,"updateMediaStreamTrackResolution"),W_.prototype),H_=W_))||H_),_Ee=(R0=TR("CameraVideoTrack","getTrackId"),H0=jT(),CI=H4("CameraVideoTrack","_enabledMutex"),LI=jT(),xI=jT(),R0((gI((_C=class extends yS{constructor(s,p,A,y,w,$){var j;super(s,p.encoderConfig?M8(p.encoderConfig):{},y,w,$),j=this,a_(this,"_config",void 0),a_(this,"_originalConstraints",void 0),a_(this,"_constraints",void 0),a_(this,"_enabled",!0),a_(this,"_deviceName","default"),a_(this,"tryResumeVideoForIOS15WeChat",f(function*(){rK()&&!kM()&&rfe()&&j._enabled&&!j._isClosed&&(h_.debug("[".concat(j.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),yield j.renewMediaStreamTrack())})),II("info",this,"constructor",{trackId:$,deviceId:s.label,constraints:A,config:p}),this._config=p,this._originalConstraints=A,this._constraints=A,this._deviceName=s.label,this._config.encoderConfig&&(this._encoderConfig=M8(this._config.encoderConfig)),g1.on(US.IOS_15_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),g1.on(US.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),this.bindProcessorContextEvents()}setDevice(s){var p=this;return f(function*(){const A=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.CAM_VIDEO_TRACK_SET_DEVICE,options:[p.getTrackId(),s]});if(h_.info("[".concat(p.getTrackId(),"] set device to ").concat(s)),S0("info",p,"setDevice",s),p._enabled)try{const y=yield sP.getDeviceById(s),w={};w.video=p2({},p._constraints),w.video.deviceId={exact:s},w.video.facingMode=void 0,p._originMediaStreamTrack.stop();let $=null;try{$=yield zO(w,p.getTrackId())}catch(j){throw h_.error("[".concat(p.getTrackId(),"] setDevice failed"),j.toString()),S0("error",p,"setDevice",s,j.toString()),$=yield zO({video:p._constraints},p.getTrackId()),yield p._updateOriginMediaStreamTrack($.getVideoTracks()[0],!1),j}yield p._updateOriginMediaStreamTrack($.getVideoTracks()[0],!1),p.updateMediaStreamTrackResolution(),p._deviceName=y.label,p._config.cameraId=s,p._constraints.deviceId={exact:s}}catch(y){throw A.onError(y),h_.error("[".concat(p.getTrackId(),"] setDevice error"),y.toString()),S0("error",p,"setDevice",s,y.toString()),y}else try{const y=yield sP.getDeviceById(s);p._deviceName=y.label,p._config.cameraId=s,p._constraints.deviceId={exact:s}}catch(y){throw A.onError(y),h_.error("[".concat(p.getTrackId(),"] setDevice error"),y.toString()),S0("error",p,"setDevice",s,y.toString()),y}h_.info("[".concat(p.getTrackId(),"] setDevice success")),S0("info",p,"setDevice",s,"success"),A.onSuccess()})()}setEnabled(s,p){var A=this;return f(function*(){if(!p){if(s===A._enabled)return;A.stateCheck("enabled",s)}if(h_.info("[".concat(A.getTrackId(),"] start setEnabled"),s),S0("info",A,"setEnabled",s),!s){A._originMediaStreamTrack.onended=null,A._originMediaStreamTrack.stop(),p||(A._enabled=!1);try{yield wT(A,mI.NEED_DISABLE_TRACK,A)}catch($){throw h_.error("[".concat(A.getTrackId(),"] setEnabled to false error"),$.toString()),S0("error",A,"setEnabled",s,$.toString()),$}return h_.info("[".concat(A.getTrackId(),"] setEnabled to false success")),void S0("info",A,"setEnabled",s,"success")}const y=p2({},A._constraints),w=sP.searchDeviceIdByName(A._deviceName);w&&!y.deviceId&&(y.deviceId={exact:w});try{const $=yield zO({video:A._constraints},A.getTrackId());yield A._updateOriginMediaStreamTrack($.getVideoTracks()[0],!1),yield wT(A,mI.NEED_ENABLE_TRACK,A)}catch($){throw h_.error("[".concat(A.getTrackId(),"] setEnabled true error"),$.toString()),S0("error",A,"setEnabled",s,$.toString()),$}A.updateMediaStreamTrackResolution(),h_.info("[".concat(A.getTrackId(),"] setEnabled to true success")),S0("info",A,"setEnabled",s,"success"),p||(A._enabled=!0)})()}setEncoderConfiguration(s,p){var A=this;return f(function*(){const y=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG,options:[A.getTrackId(),s]});if(!A._enabled){const j=new U_(N_.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");throw y.onError(j),j}s=M8(s),A._forceBitrateLimit&&(s.bitrateMax=A._forceBitrateLimit.max_bitrate?A._forceBitrateLimit.max_bitrate:s.bitrateMax,s.bitrateMin=A._forceBitrateLimit.min_bitrate?A._forceBitrateLimit.min_bitrate:s.bitrateMin);const w=jS(A._config);w.encoderConfig=s;const $=cde(w);(Z2()||r2()||WU())&&($.deviceId=void 0),h_.debug("[".concat(A.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(s),JSON.stringify($)),S0("debug",A,"setEncoderConfiguration",s);try{yield A._originMediaStreamTrack.applyConstraints($),A.updateMediaStreamTrackResolution()}catch(j){const _e=new U_(N_.UNEXPECTED_ERROR,j.toString());throw h_.error("[".concat(A.getTrackId(),"] applyConstraints error"),_e.toString()),S0("error",A,"setEncoderConfiguration",j.toString()),y.onError(_e),_e}A._config=w,A._constraints=$,A._originalConstraints=$,A._encoderConfig=s,-1===A._hints.indexOf(DR.SCREEN_TRACK)&&A.updateBitrateFromProfile();try{yield wT(A,mI.NEED_UPDATE_VIDEO_ENCODER,A)}catch(j){return y.onError(j),j.throw()}y.onSuccess()})()}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){var s=this;if((r2()||WU())&&this._enabled&&!this._isClosed&&g1.duringInterruption){const p=function(){var A=f(function*(){g1.off(US.IOS_INTERRUPTION_END,p),s._enabled&&!s._isClosed&&(h_.debug("[".concat(s.getTrackId(),"] try capture camera media device for interrupted iOS device.")),sI("debug",s,"try capture camera media device for interrupted iOS device."),yield s.setEnabled(!1),yield s.setEnabled(!0))});return function(){return A.apply(this,arguments)}}();g1.on(US.IOS_INTERRUPTION_END,p)}else h_.debug("[".concat(this.getTrackId(),"] track ended")),b6("debug",["MediaStreamTrack",this.getTrackId()],"ended"),this.emit(FL.TRACK_ENDED)}renewMediaStreamTrack(s){var p=this;return f(function*(){const A=s||p._constraints,y=sP.searchDeviceIdByName(p._deviceName);y&&!A.deviceId&&(A.deviceId={exact:y});const w=yield zO({video:A},p.getTrackId());p._constraints=A,yield p._updateOriginMediaStreamTrack(w.getVideoTracks()[0],!0),p.updateMediaStreamTrackResolution()})()}close(){super.close(),g1.off(US.IOS_15_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),g1.off(US.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat)}bindProcessorContextEvents(){var s=this;this.processorContext.on(a2.REQUEST_UPDATE_CONSTRAINTS,function(){var p=f(function*(A,y,w){try{const $=Object.assign({},s._originalConstraints,...A);yield s.renewMediaStreamTrack($),y()}catch($){w($)}});return function(A,y,w){return p.apply(this,arguments)}}()),this.processorContext.on(a2.REQUEST_CONSTRAINTS,function(){var p=f(function*(A){A(s._originMediaStreamTrack.getSettings())});return function(A){return p.apply(this,arguments)}}())}}).prototype,"setDevice",[H0],Object.getOwnPropertyDescriptor(_C.prototype,"setDevice"),_C.prototype),gI(_C.prototype,"setEnabled",[CI,LI],Object.getOwnPropertyDescriptor(_C.prototype,"setEnabled"),_C.prototype),gI(_C.prototype,"setEncoderConfiguration",[xI],Object.getOwnPropertyDescriptor(_C.prototype,"setEncoderConfiguration"),_C.prototype),DI=_C))||DI);class eIe extends sS{constructor(p){super(),a_(this,"name","VideoProcessorDestination"),a_(this,"ID","0"),a_(this,"_source",void 0),a_(this,"videoContext",void 0),a_(this,"inputTrack",void 0),this.videoContext=p}get kind(){return"video"}get enabled(){return!0}pipe(){throw new U_(N_.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new U_(N_.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(p){if(p.context!==this.videoContext)throw new Error("ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.\nProbably you are making pipeline like this:\nvideoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).");p.track&&p.track!==this.inputTrack&&(this.inputTrack=p.track,this.emit(tP.ON_TRACK,p.track))}reset(){this.inputTrack=void 0,this.emit(tP.ON_TRACK,void 0)}}class tIe extends sS{constructor(p){super(),a_(this,"constraintsMap",new Map),a_(this,"statsRegistry",[]),a_(this,"trackId",void 0),this.trackId=p}getConstraints(){var p=this;return f(function*(){return yield ZP(p,a2.REQUEST_CONSTRAINTS)})()}requestApplyConstraints(p,A){var y=this;return f(function*(){var w;return h_.info("processor ".concat(A.name," requestApplyConstraints for ").concat(y.trackId)),p&&y.constraintsMap.set(A,p),wT(y,a2.REQUEST_UPDATE_CONSTRAINTS,Array.from(rP(w=y.constraintsMap).call(w)))})()}requestRevertConstraints(p){var A=this;return f(function*(){var y;if(A.constraintsMap.has(p))return h_.info("processor ".concat(p.name," requestRevertConstraints for ").concat(A.trackId)),A.constraintsMap.delete(p),wT(A,a2.REQUEST_UPDATE_CONSTRAINTS,Array.from(rP(y=A.constraintsMap).call(y)))})()}registerStats(p,A,y){this.statsRegistry.find(w=>w.processorID===p.ID&&w.processorName===p.name&&w.type===A)||this.statsRegistry.push({processorName:p.name,processorID:p.ID,type:A,cb:y})}unregisterStats(p,A){}gatherStats(){return this.statsRegistry.map(p=>{let{processorID:A,processorName:y,type:w,cb:$}=p;return{processorID:A,processorName:y,type:w,stats:$()}})}}class Rye{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio)return this._audioTrack}get videoTrack(){if(this.hasVideo)return this._videoTrack}constructor(p,A){a_(this,"uid",void 0),a_(this,"_uintid",void 0),a_(this,"_trust_in_room_",!0),a_(this,"_trust_audio_enabled_state_",!0),a_(this,"_trust_video_enabled_state_",!0),a_(this,"_trust_audio_mute_state_",!0),a_(this,"_trust_video_mute_state_",!0),a_(this,"_trust_stream_added_state_",!0),a_(this,"_audio_muted_",!1),a_(this,"_video_muted_",!1),a_(this,"_audio_enabled_",!0),a_(this,"_video_enabled_",!0),a_(this,"_audio_added_",!1),a_(this,"_video_added_",!1),a_(this,"_audioTrack",void 0),a_(this,"_videoTrack",void 0),a_(this,"_audioSSRC",void 0),a_(this,"_videoSSRC",void 0),a_(this,"_audioOrtc",void 0),a_(this,"_videoOrtc",void 0),a_(this,"_cname",void 0),a_(this,"_rtxSsrcId",void 0),this.uid=p,this._uintid=A}}var nIe=N8,rIe=P4,iIe=sQ;xS({target:"Promise",stat:!0},{try:function(s){var p=rIe.f(this),A=iIe(s);return(A.error?p.reject:p.resolve)(A.value),p.promise}});var Oye=nIe,oIe=xS,sIe=n1,aIe=OT,cIe=BK,uIe=F2,lIe=bM,dIe=wM,vEe=QO,hIe=bO,fIe=Rue,pIe=r1,yEe=PS("isConcatSpreadable"),EEe=9007199254740991,IEe="Maximum allowed index exceeded",bEe=sIe.TypeError,gIe=pIe>=51||!aIe(function(){var s=[];return s[yEe]=!1,s.concat()[0]!==s}),mIe=fIe("concat"),AIe=function(s){if(!uIe(s))return!1;var p=s[yEe];return void 0!==p?!!p:cIe(s)};oIe({target:"Array",proto:!0,forced:!gIe||!mIe},{concat:function(s){var p,A,y,w,$,j=lIe(this),_e=hIe(j,0),K=0;for(p=-1,y=arguments.length;p<y;p++)if(AIe($=-1===p?j:arguments[p])){if(K+(w=dIe($))>EEe)throw bEe(IEe);for(A=0;A<w;A++,K++)A in $&&vEe(_e,K,$[A])}else{if(K>=EEe)throw bEe(IEe);vEe(_e,K++,$)}return _e.length=K,_e}});var CEe={},_Ie=VV,vIe=EM,wEe=xU.f,yIe=cre,TEe="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];CEe.f=function(s){return TEe&&"Window"==_Ie(s)?function(p){try{return wEe(p)}catch(A){return yIe(TEe)}}(s):wEe(vIe(s))};var lde={};lde.f=PS;var SEe=IU,IIe=cN,bIe=lde,CIe=GP.f,TO=function(s){var p=SEe.Symbol||(SEe.Symbol={});IIe(p,s)||CIe(p,s,{value:bIe.f(s)})},ioe=xS,Dye=n1,wIe=EL,TIe=IY,dde=AO,SIe=rT,ooe=B2,xX=$9,Nye=OT,YO=cN,RIe=BK,OIe=MT,DIe=F2,NIe=M2,kye=X9,Pye=KN,kIe=bM,xme=EM,xye=c7,REe=OL,Lye=U2,hde=_4,OEe=f8,PIe=xU,DEe=CEe,Mye=O7,NEe=jP,kEe=GP,xIe=D7,PEe=H9,LIe=n$,Bye=Y2,fde=eH.exports,xEe=h8,LEe=Aoe,MEe=PS,MIe=lde,BIe=TO,UIe=VU,BEe=r6,Lme=bue.forEach,qM=GH("hidden"),Mme="Symbol",UEe=MEe("toPrimitive"),FIe=BEe.set,FEe=BEe.getterFor(Mme),$6=Object.prototype,uY=Dye.Symbol,LX=uY&&uY.prototype,jEe=Dye.TypeError,Uye=Dye.QObject,pde=wIe("JSON","stringify"),VEe=NEe.f,lY=kEe.f,GEe=DEe.f,jIe=PEe.f,QEe=SIe([].push),g9=fde("symbols"),gde=fde("op-symbols"),Fye=fde("string-to-symbol-registry"),jye=fde("symbol-to-string-registry"),VIe=fde("wks"),Vye=!Uye||!Uye.prototype||!Uye.prototype.findChild,Gye=ooe&&Nye(function(){return 7!=hde(lY({},"a",{get:function(){return lY(this,"a",{value:7}).a}})).a})?function(s,p,A){var y=VEe($6,p);y&&delete $6[p],lY(s,p,A),y&&s!==$6&&lY($6,p,y)}:lY,Qye=function(s,p){var A=g9[s]=hde(LX);return FIe(A,{type:Mme,tag:s,description:p}),ooe||(A.description=p),A},Bme=function(s,p,A){s===$6&&Bme(gde,p,A),Pye(s);var y=xye(p);return Pye(A),YO(g9,y)?(A.enumerable?(YO(s,qM)&&s[qM][y]&&(s[qM][y]=!1),A=hde(A,{enumerable:Lye(0,!1)})):(YO(s,qM)||lY(s,qM,Lye(1,{})),s[qM][y]=!0),Gye(s,y,A)):lY(s,y,A)},Hye=function(s,p){Pye(s);var A=xme(p),y=OEe(A).concat(qye(A));return Lme(y,function(w){ooe&&!dde(HEe,A,w)||Bme(s,w,A[w])}),s},HEe=function(s){var p=xye(s),A=dde(jIe,this,p);return!(this===$6&&YO(g9,p)&&!YO(gde,p))&&(!(A||!YO(this,p)||!YO(g9,p)||YO(this,qM)&&this[qM][p])||A)},qEe=function(s,p){var A=xme(s),y=xye(p);if(A!==$6||!YO(g9,y)||YO(gde,y)){var w=VEe(A,y);return!w||!YO(g9,y)||YO(A,qM)&&A[qM][y]||(w.enumerable=!0),w}},WEe=function(s){var p=GEe(xme(s)),A=[];return Lme(p,function(y){YO(g9,y)||YO(xEe,y)||QEe(A,y)}),A},qye=function(s){var p=s===$6,A=GEe(p?gde:xme(s)),y=[];return Lme(A,function(w){!YO(g9,w)||p&&!YO($6,w)||QEe(y,g9[w])}),y};if(xX||(Bye(LX=(uY=function(){if(NIe(LX,this))throw jEe("Symbol is not a constructor");var s=arguments.length&&void 0!==arguments[0]?REe(arguments[0]):void 0,p=LEe(s),A=function(y){this===$6&&dde(A,gde,y),YO(this,qM)&&YO(this[qM],p)&&(this[qM][p]=!1),Gye(this,p,Lye(1,y))};return ooe&&Vye&&Gye($6,p,{configurable:!0,set:A}),Qye(p,s)}).prototype,"toString",function(){return FEe(this).tag}),Bye(uY,"withoutSetter",function(s){return Qye(LEe(s),s)}),PEe.f=HEe,kEe.f=Bme,xIe.f=Hye,NEe.f=qEe,PIe.f=DEe.f=WEe,Mye.f=qye,MIe.f=function(s){return Qye(MEe(s),s)},ooe&&lY(LX,"description",{configurable:!0,get:function(){return FEe(this).description}})),ioe({global:!0,wrap:!0,forced:!xX,sham:!xX},{Symbol:uY}),Lme(OEe(VIe),function(s){BIe(s)}),ioe({target:Mme,stat:!0,forced:!xX},{for:function(s){var p=REe(s);if(YO(Fye,p))return Fye[p];var A=uY(p);return Fye[p]=A,jye[A]=p,A},keyFor:function(s){if(!kye(s))throw jEe(s+" is not a symbol");if(YO(jye,s))return jye[s]},useSetter:function(){Vye=!0},useSimple:function(){Vye=!1}}),ioe({target:"Object",stat:!0,forced:!xX,sham:!ooe},{create:function(s,p){return void 0===p?hde(s):Hye(hde(s),p)},defineProperty:Bme,defineProperties:Hye,getOwnPropertyDescriptor:qEe}),ioe({target:"Object",stat:!0,forced:!xX},{getOwnPropertyNames:WEe,getOwnPropertySymbols:qye}),ioe({target:"Object",stat:!0,forced:Nye(function(){Mye.f(1)})},{getOwnPropertySymbols:function(s){return Mye.f(kIe(s))}}),pde&&ioe({target:"JSON",stat:!0,forced:!xX||Nye(function(){var s=uY();return"[null]"!=pde([s])||"{}"!=pde({a:s})||"{}"!=pde(Object(s))})},{stringify:function(s,p,A){var y=LIe(arguments),w=p;if((DIe(p)||void 0!==s)&&!kye(s))return RIe(p)||(p=function($,j){if(OIe(w)&&(j=dde(w,this,$,j)),!kye(j))return j}),y[1]=p,TIe(pde,null,y)}}),!LX[UEe]){var GIe=LX.valueOf;Bye(LX,UEe,function(s){return dde(GIe,this)})}UIe(uY,Mme),xEe[qM]=!0,TO("asyncIterator"),TO("hasInstance"),TO("isConcatSpreadable"),TO("iterator"),TO("match"),TO("matchAll"),TO("replace"),TO("search"),TO("species"),TO("split"),TO("toPrimitive"),TO("toStringTag"),TO("unscopables"),VU(n1.JSON,"JSON",!0);var QIe=IU.Symbol;TO("asyncDispose"),TO("dispose"),TO("matcher"),TO("metadata"),TO("observable"),TO("patternMatch"),TO("replaceAll");var KEe=QIe,zEe=lde.f("asyncIterator");function YEe(s){this.wrapped=s}function mde(s){var p,A;function y($,j){try{var _e=s[$](j),K=_e.value,_i=K instanceof YEe;Oye.resolve(_i?K.wrapped:K).then(function(_o){_i?y("return"===$?"return":"next",_o):w(_e.done?"return":"normal",_o)},function(_o){y("throw",_o)})}catch(_o){w("throw",_o)}}function w($,j){switch($){case"return":p.resolve({value:j,done:!0});break;case"throw":p.reject(j);break;default:p.resolve({value:j,done:!1})}(p=p.next)?y(p.key,p.arg):A=null}this._invoke=function($,j){return new Oye(function(_e,K){var _i={key:$,arg:j,resolve:_e,reject:K,next:null};A?A=A.next=_i:(p=A=_i,y($,j))})},"function"!=typeof s.return&&(this.return=void 0)}function Ade(s){return function(){return new mde(s.apply(this,arguments))}}function GS(s){return new YEe(s)}mde.prototype["function"==typeof KEe&&zEe||"@@asyncIterator"]=function(){return this},mde.prototype.next=function(s){return this._invoke("next",s)},mde.prototype.throw=function(s){return this._invoke("throw",s)},mde.prototype.return=function(s){return this._invoke("return",s)};var qIe=lde.f("iterator");function JEe(s,p){var A={},y=!1;function w($,j){return y=!0,j=new Oye(function(_e){_e(s[$](j))}),{done:!1,value:p(j)}}return A[void 0!==KEe&&qIe||"@@iterator"]=function(){return this},A.next=function($){return y?(y=!1,$):w("next",$)},"function"==typeof s.throw&&(A.throw=function($){if(y)throw y=!1,$;return w("throw",$)}),"function"==typeof s.return&&(A.return=function($){return y?(y=!1,$):w("return",$)}),A}var WIe=zEe,KIe=hI,Ume=G_,JIe=X1,ZIe=NT,XIe=lN,ebe=yT.f,tbe=pV,m9=_r.Symbol,MX=m9&&m9.prototype;if(_l&&UI(m9)&&(!("description"in MX)||void 0!==m9().description)){var $Ee={},Fme=function(){var s=arguments.length<1||void 0===arguments[0]?void 0:XIe(arguments[0]),p=ZIe(MX,this)?new m9(s):void 0===s?m9():m9(s);return""===s&&($Ee[p]=!0),p};tbe(Fme,m9),Fme.prototype=MX,MX.constructor=Fme;var nbe="Symbol(test)"==String(m9("test")),rbe=Ume(MX.toString),ibe=Ume(MX.valueOf),obe=/^Symbol\((.*)\)[^)]+$/,sbe=Ume("".replace),abe=Ume("".slice);ebe(MX,"description",{configurable:!0,get:function(){var s=ibe(this),p=rbe(s);if(JIe($Ee,s))return"";var A=nbe?abe(p,7,-1):sbe(p,obe,"$1");return""===A?void 0:A}}),KIe({global:!0,forced:!0},{Symbol:Fme})}var h3={exports:{}};function ZEe(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function XEe(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?ZEe(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):ZEe(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}function Wye(s,p,A,y,w,$){let j=[],_e=[],K=[],_i=[],_o=!1,_u=!1;if(h3.exports.parse(s).mediaDescriptions.forEach(ch=>{$&&$!==ch.attributes.direction||("video"!==ch.media.mediaType||_o||(_e=ch.attributes.payloads,_i=ch.attributes.extmaps,_o=!0),"audio"!==ch.media.mediaType||_u||(j=ch.attributes.payloads,K=ch.attributes.extmaps,_u=!0))}),!_i||0===_e.length)throw new Error("Cannot get video capabilities from SDP.");if(!K||0===j.length)throw new Error("Cannot get audio capabilities from SDP.");return _e.forEach(ch=>{var _f;null!==(_f=ch.rtpMap)&&void 0!==_f&&_f.clockRate&&(ch.rtpMap.clockRate=parseInt(ch.rtpMap.clockRate))}),j.forEach(ch=>{var _f;null!==(_f=ch.rtpMap)&&void 0!==_f&&_f.clockRate&&(ch.rtpMap.clockRate=parseInt(ch.rtpMap.clockRate))}),p&&(j=j.filter(ch=>{var _f;return"rtx"!==(null===(_f=ch.rtpMap)||void 0===_f?void 0:_f.encodingName.toLowerCase())}),_e=_e.filter(ch=>{var _f;return"rtx"!==(null===(_f=ch.rtpMap)||void 0===_f?void 0:_f.encodingName.toLowerCase())})),A&&(_e=_e.filter(ch=>{var _f;return!/(red)|(ulpfec)|(flexfec)/i.test((null===(_f=ch.rtpMap)||void 0===_f?void 0:_f.encodingName)||"")})),y&&(null==y?void 0:y.length)>0&&(j=j.filter(ch=>{var _f;return y.includes((null===(_f=ch.rtpMap)||void 0===_f?void 0:_f.encodingName.toLowerCase())||"")})),w&&(null==w?void 0:w.length)>0&&(_e=_e.filter(ch=>{var _f;return w.includes((null===(_f=ch.rtpMap)||void 0===_f?void 0:_f.encodingName.toLowerCase())||"")})),{audioCodecs:j,videoCodecs:_e,audioExtensions:K,videoExtensions:_i}}function jme(s){const p=h3.exports.parse(s);let A,y;for(const w of p.mediaDescriptions){if(!A){const $=w.attributes.iceUfrag,j=w.attributes.icePwd;if(!$||!j)throw new Error("Cannot get iceUfrag or icePwd from SDP.");A={iceUfrag:$,icePwd:j}}if(!y){const $=w.attributes.fingerprints;$.length>0&&(y={fingerprints:$})}}if(!y&&p.attributes.fingerprints.length>0&&(y={fingerprints:p.attributes.fingerprints}),!y||!A)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:A,dtlsParameters:y}}function e0e(s,p,A){const{cname:y}=s;let w;void 0!==p&&void 0!==A?(w=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:p,port:A.toString(),type:"host",extension:{}}],h_.debug("Using remote candidate from AP ".concat(p,":").concat(A)),sI("debug",[],"Using remote candidate from AP ".concat(p,":").concat(A))):w=s.iceParameters.candidates.map(K=>({foundation:K.foundation,componentId:"1",transport:K.protocol,priority:K.priority.toString(),connectionAddress:K.ip,port:K.port.toString(),type:K.type,extension:{}}));const $={fingerprints:s.dtlsParameters.fingerprints.map(K=>({hashFunction:K.algorithm,fingerprint:K.fingerprint}))},j={iceUfrag:s.iceParameters.iceUfrag,icePwd:s.iceParameters.icePwd};let _e;switch(s.dtlsParameters.role){case"server":_e="passive";break;case"client":_e="active";break;case"auto":_e="actpass"}return{dtlsParameters:$,iceParameters:j,candidates:w,rtpCapabilities:i0e(s.rtpCapabilities),setup:_e,cname:y}}function soe(s,p,A){const y=[],w=[];return s.forEach($=>{let{ssrcId:j,rtx:_e}=$;const K=VT(8,"track-"),_i={ssrcId:j,attributes:XEe({label:K,mslabel:A=A||VT(10,""),msid:"".concat(A," ").concat(K)},p&&{cname:p})};if(y.push(_i),void 0!==_e){const _o={ssrcId:_e,attributes:XEe({label:K,mslabel:A,msid:"".concat(A," ").concat(K)},p&&{cname:p})};y.push(_o),w.push({semantic:"FID",ssrcIds:[j,_e]})}}),s.length>1&&w.push({semantic:"SIM",ssrcIds:s.map($=>{let{ssrcId:j}=$;return j})}),{ssrcs:y,ssrcGroups:w}}function Vme(s,p){p instanceof cO&&s.attributes.payloads.forEach(A=>{var y;const w=null===(y=A.rtpMap)||void 0===y?void 0:y.encodingName.toLowerCase();if(!w||-1===["opus","pcmu","pcma","g722"].indexOf(w))return;A.fmtp||(A.fmtp={parameters:{}}),A.fmtp.parameters.minptime="10",A.fmtp.parameters.useinbandfec="1";const $=p._encoderConfig;$&&("pcmu"!==w&&"pcma"!==w&&"g722"!==w&&($.bitrate&&!X2()&&(A.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*$.bitrate))),$.sampleRate&&(A.fmtp.parameters.maxplaybackrate="".concat($.sampleRate),A.fmtp.parameters["sprop-maxcapturerate"]="".concat($.sampleRate))),$.stereo&&(A.fmtp.parameters.stereo="1",A.fmtp.parameters["sprop-stereo"]="1"))})}function t0e(s){const p=s.attributes.unrecognized.findIndex(A=>"x-google-flag"===A.attField&&"conference"===A.attValue);-1!==p&&s.attributes.unrecognized.splice(p,1)}function n0e(s,p){if(!(p instanceof yS&&p._encoderConfig&&-1===p._hints.indexOf(DR.SCREEN_TRACK)))return;const A=p._encoderConfig;bN().supportMinBitrate&&A.bitrateMin&&s.attributes.payloads.forEach(y=>{var w;["h264","vp8","vp9","av1"].includes((null===(w=y.rtpMap)||void 0===w?void 0:w.encodingName.toLowerCase())||"")&&(y.fmtp||(y.fmtp={parameters:{}}),y.fmtp.parameters["x-google-min-bitrate"]="".concat(A.bitrateMin))}),bN().supportMinBitrate&&!p._hints.includes(DR.LOW_STREAM)&&A.bitrateMax&&s.attributes.payloads.forEach(y=>{var w;["h264","vp8","vp9","av1"].includes((null===(w=y.rtpMap)||void 0===w?void 0:w.encodingName.toLowerCase())||"")&&(y.fmtp||(y.fmtp={parameters:{}}),y.fmtp.parameters["x-google-start-bitrate"]="".concat(Math.floor(A.bitrateMax)))})}function r0e(s,p,A){if(!p)return;let y,w;if("video"===s.media.mediaType?(y=A.videoExtensions,w=A.videoCodecs):(y=A.audioExtensions,w=A.audioCodecs),!0===p.tcc){const $=y.find(j=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===j.extensionName);$&&(s.attributes.extmaps.find(j=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===j.extensionName)||s.attributes.extmaps.push({entry:$.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"}),(j=w,_e=s.attributes.payloads,_e.filter(K=>!!j.find(_i=>_i.payloadType===K.payloadType&&!!_i.rtcpFeedbacks.find(_o=>"transport-cc"===_o.type)))).forEach(j=>{j.rtcpFeedbacks.find(_e=>"transport-cc"===_e.type)||j.rtcpFeedbacks.push({type:"transport-cc"})}))}else if(!1===p.tcc){const $=s.attributes.extmaps.findIndex(j=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===j.extensionName);-1!==$&&s.attributes.extmaps.splice($,1),s.attributes.payloads.forEach(j=>{const _e=j.rtcpFeedbacks.findIndex(K=>"transport-cc"===K.type);-1!==_e&&j.rtcpFeedbacks.splice(_e,1)})}var j,_e;if(!0===p.remb){const $=y.find(j=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===j.extensionName);$&&(s.attributes.extmaps.find(j=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===j.extensionName)||s.attributes.extmaps.push({entry:$.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}),function(j,_e){return _e.filter(K=>!!j.find(_i=>_i.payloadType===K.payloadType&&!!_i.rtcpFeedbacks.find(_o=>"goog-remb"===_o.type)))}(w,s.attributes.payloads).forEach(j=>{j.rtcpFeedbacks.find(_e=>"goog-remb"===_e.type)||j.rtcpFeedbacks.push({type:"goog-remb"})}))}else if(!1===p.remb){const $=s.attributes.extmaps.findIndex(j=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===j.extensionName);-1!==$&&s.attributes.extmaps.splice($,1),s.attributes.payloads.forEach(j=>{const _e=j.rtcpFeedbacks.findIndex(K=>"goog-remb"===K.type);-1!==_e&&j.rtcpFeedbacks.splice(_e,1)})}}function Gme(s,p,A,y,w,$){if("videoExtensions"===A||"audioExtensions"===A){const j=[];return s[A].forEach(_e=>{p[A].some((K,_i)=>{if(_e.entry===K.entry&&_e.extensionName===K.extensionName)return j.push(_i),!0})?$[A].push(_e):y[A].push(_e)}),void p[A].forEach((_e,K)=>{-1===j.indexOf(K)&&w[A].push(_e)})}if("videoCodecs"===A||"audioCodecs"===A){const j=[];return s[A].forEach(_e=>{p[A].some((K,_i)=>{if(_e.payloadType===K.payloadType&&JSON.stringify(_e)===JSON.stringify(K))return j.push(_i),!0})?$[A].push(_e):y[A].push(_e)}),void p[A].forEach((_e,K)=>{-1===j.indexOf(K)&&w[A].push(_e)})}}function i0e(s){const{send:p,recv:A,sendrecv:y}=s;if(!y){if(!p||!A)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:p,recv:A}}let w,$;return p?(w={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},w.audioCodecs=[...p.audioCodecs,...y.audioCodecs],w.videoCodecs=[...p.videoCodecs,...y.videoCodecs],w.audioExtensions=[...p.audioExtensions,...y.audioExtensions],w.videoExtensions=[...p.videoExtensions,...y.videoExtensions]):w=y,A?($={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},$.audioCodecs=[...A.audioCodecs,...y.audioCodecs],$.videoCodecs=[...A.videoCodecs,...y.videoCodecs],$.audioExtensions=[...A.audioExtensions,...y.audioExtensions],$.videoExtensions=[...A.videoExtensions,...y.videoExtensions]):$=y,{send:w,recv:$}}!function(s,p){s.exports=(()=>{var A={8:($,j,_e)=>{_e.r(j),_e.d(j,{Parser:()=>Z0,Printer:()=>z0,parse:()=>B0,print:()=>$0});const K="\n",_i="".concat("\r").concat(K),_o=" ";let _u;function ch(A0){return A0>="0"&&A0<="9"}function _f(A0){return A0>="!"&&A0<="~"}function o_(A0){return _f(A0)||A0>="\x80"&&A0<="\xff"}function i_(A0){return"!"===A0||A0>="#"&&A0<="'"||A0>="*"&&A0<="+"||A0>="-"&&A0<="."||A0>="0"&&A0<="9"||A0>="A"&&A0<="Z"||A0>="^"&&A0<="~"}function u_(A0){return A0>="1"&&A0<="9"}function g_(A0){return A0>="A"&&A0<="Z"||A0>="a"&&A0<="z"}function __(A0){return"d"===A0||"h"===A0||"m"===A0||"s"===A0}function w_(A0){return A0>"\x01"&&A0<"\t"||A0>"\v"&&A0<"\f"||A0>"\x0e"&&A0<"\xff"}function k_(A0){return g_(A0)||ch(A0)||"+"===A0||"/"===A0}function Rv(A0){return ch(A0)||g_(A0)||"+"===A0||"/"===A0||"-"===A0||"_"===A0}function f0(A0){return g_(A0)||ch(A0)||"+"===A0||"/"===A0}function y0(A0,e_){var y_=Object.keys(A0);if(Object.getOwnPropertySymbols){var D_=Object.getOwnPropertySymbols(A0);e_&&(D_=D_.filter(function(d0){return Object.getOwnPropertyDescriptor(A0,d0).enumerable})),y_.push.apply(y_,D_)}return y_}function b0(A0){for(var e_=1;e_<arguments.length;e_++){var y_=null!=arguments[e_]?arguments[e_]:{};e_%2?y0(Object(y_),!0).forEach(function(D_){rI(A0,D_,y_[D_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A0,Object.getOwnPropertyDescriptors(y_)):y0(Object(y_)).forEach(function(D_){Object.defineProperty(A0,D_,Object.getOwnPropertyDescriptor(y_,D_))})}return A0}function rI(A0,e_,y_){return e_ in A0?Object.defineProperty(A0,e_,{value:y_,enumerable:!0,configurable:!0,writable:!0}):A0[e_]=y_,A0}var A0;(A0=_u||(_u={})).VERSION="v",A0.ORIGIN="o",A0.SESSION_NAME="s",A0.INFORMATION="i",A0.URI="u",A0.EMAIL="e",A0.PHONE="p",A0.CONNECTION="c",A0.BANDWIDTH="b",A0.TIME="t",A0.REPEAT="r",A0.ZONE_ADJUSTMENTS="z",A0.KEY="k",A0.ATTRIBUTE="a",A0.MEDIA="m";class q0{consumeText(e_,y_){let D_=y_;for(;D_<e_.length;){const d0=e_[D_];if("\0"===d0||"\r"===d0||d0===K)break;D_+=1}if(D_-y_==0)throw new Error("Invalid text, at ".concat(e_));return D_}consumeUnicastAddress(e_,y_,D_){return this.consumeTill(e_,y_,_o)}consumeOneOrMore(e_,y_,D_){let d0=y_;for(;D_(e_[d0]);)d0++;if(d0-y_==0)throw new Error("Invalid rule at ".concat(y_,"."));return d0}consumeSpace(e_,y_){if(e_[y_]===_o)return y_+1;throw new Error("Invalid space at ".concat(y_,"."))}consumeIP4Address(e_,y_){let D_=y_;for(let d0=0;d0<4;d0++)if(D_=this.consumeDecimalUChar(e_,D_),3!==d0){if("."!==e_[D_])throw new Error("Invalid IP4 address.");D_++}return D_}consumeDecimalUChar(e_,y_){let D_=y_;for(let K0=0;K0<3&&ch(e_[D_]);K0++,D_++);if(D_-y_==0)throw new Error("Invalid decimal uchar.");const d0=parseInt(e_.slice(y_,D_));if(d0>=0&&d0<=255)return D_;throw new Error("Invalid decimal uchar")}consumeIP6Address(e_,y_){let D_=this.consumeHexpart(e_,y_);return":"===e_[D_]&&(D_+=1,D_=this.consumeIP4Address(e_,D_)),D_}consumeHexpart(e_,y_){let D_=y_;if(":"===e_[D_]&&":"===e_[D_+1]){D_+=2;try{D_=this.consumeHexseq(e_,D_)}catch(d0){}return D_}if(D_=this.consumeHexseq(e_,D_),":"===e_[D_]&&":"===e_[D_+1]){D_+=2;try{D_=this.consumeHexseq(e_,D_)}catch(d0){}return D_}return D_}consumeHexseq(e_,y_){let D_=y_;for(;D_=this.consumeHex4(e_,D_),":"===e_[D_]&&":"!==e_[D_+1];)D_+=1;return D_}consumeHex4(e_,y_){let D_=0;for(;D_<4;D_++)if(!((d0=e_[y_+D_])>="0"&&d0<="9"||d0>="a"&&d0<="f"||d0>="A"&&d0<="F")){if(0===D_)throw new Error("Invalid hex 4");break}var d0;return y_+D_}consumeFQDN(e_,y_){let D_=y_;for(;ch(e_[D_])||g_(e_[D_])||"-"===e_[D_]||"."===e_[D_];)D_+=1;if(D_-y_<4)throw new Error("Invalid FQDN");return D_}consumeExtnAddr(e_,y_){return this.consumeOneOrMore(e_,y_,o_)}consumeMulticastAddress(e_,y_,D_){switch(D_){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(e_,y_);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(e_,y_);default:try{return this.consumeFQDN(e_,y_)}catch(d0){return this.consumeExtnAddr(e_,y_)}}}consumeIP6MulticastAddress(e_,y_){const D_=this.consumeHexpart(e_,y_);return"/"===e_[D_]?this.consumeInteger(e_,D_+1):D_}consumeIP4MulticastAddress(e_,y_){let D_=y_+3;const d0=e_.slice(y_,D_),K0=parseInt(d0);if(K0<224||K0>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let FI=0;FI<3;FI++){if("."!==e_[D_])throw new Error("Invalid IP4 multicast address.");D_+=1,D_=this.consumeDecimalUChar(e_,D_)}return"/"===e_[D_]&&(D_+=1),D_=this.consumeTTL(e_,D_),"/"===e_[D_]&&(D_=this.consumeInteger(e_,D_)),D_}consumeInteger(e_,y_){if(!u_(e_[y_]))throw new Error("Invalid integer.");for(y_+=1;ch(e_[y_]);)y_+=1;return y_}consumeTTL(e_,y_){if("0"===e_[y_])return y_+1;if(!u_(e_[y_]))throw new Error("Invalid TTL.");y_+=1;for(let D_=0;D_<2&&ch(e_[y_]);D_++)y_+=1;return y_}consumeToken(e_,y_){return this.consumeOneOrMore(e_,y_,i_)}consumeTime(e_,y_){let D_=y_;if("0"===e_[D_])return D_+1;for(u_(e_[D_])&&(D_+=1);ch(e_[D_]);)D_++;if(D_-y_<10)throw new Error("Invalid time");return D_}consumeAddress(e_,y_){return this.consumeTill(e_,y_,_o)}consumeTypedTime(e_,y_){let D_=y_;return D_=this.consumeOneOrMore(e_,D_,ch),__(e_[D_])?D_+1:D_}consumeRepeatInterval(e_,y_){if(!u_(e_[y_]))throw new Error("Invalid repeat interval");for(y_+=1;ch(e_[y_]);)y_+=1;return __(e_[y_])&&(y_+=1),y_}consumePort(e_,y_){return this.consumeOneOrMore(e_,y_,ch)}consume(e_,y_,D_){for(let d0=0;d0<D_.length;d0++){if(y_+d0>=e_.length)throw new Error("consume exceeding value length");if(e_[y_+d0]!==D_[d0])throw new Error("consume ".concat(D_," failed at ").concat(d0))}return y_+D_.length}consumeTill(e_,y_,D_){let d0=y_;for(;d0<e_.length&&("string"!=typeof D_||e_[d0]!==D_)&&("function"!=typeof D_||!D_(e_[d0]));)d0++;return d0}}class Z0 extends q0{constructor(){super(),rI(this,"records",[]),rI(this,"currentLine",0)}parse(e_){const y_=this.probeEOL(e_);this.records=e_.split(y_).filter(JL=>!!JL.trim()).map(this.parseLine),this.currentLine=0;const D_=this.parseVersion(),d0=this.parseOrigin(),K0=this.parseSessionName(),FI=this.parseInformation(),MI=this.parseUri(),WI=this.parseEmail(),q1=this.parsePhone(),JO=this.parseConnection(),UR=this.parseBandWidth(),aT=this.parseTimeFields(),$1=this.parseKey(),nR=this.parseSessionAttribute(),f3=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:D_,origin:d0,sessionName:K0,information:FI,uri:MI,emails:WI,phones:q1,connection:JO,bandwidths:UR,timeFields:aT,key:$1,attributes:nR,mediaDescriptions:f3}}getCurrentRecord(){const e_=this.records[this.currentLine];if(!e_)throw new Error("Record doesn't exit.");return e_}probeEOL(e_){for(let y_=0;y_<e_.length;y_++)if(e_[y_]===K)return"\r"===e_[y_-1]?_i:K;throw new Error("Invalid newline character.")}parseLine(e_,y_){if(e_.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const D_=e_[0];if("="!==e_[1])throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:D_,value:e_.slice(2),line:y_,cur:0}}parseSessionAttribute(){const e_=new j_;for(;this.currentLine<this.records.length;){const y_=this.getCurrentRecord();if(y_.type!==_u.ATTRIBUTE)break;const D_={attField:this.extractOneOrMore(y_,d0=>i_(d0)&&":"!==d0),_cur:0};":"===y_.value[y_.cur]&&(y_.cur+=1,D_.attValue=this.extractOneOrMore(y_,w_)),e_.parse(D_),this.currentLine++}return e_.digest()}parseMediaAttributes(e_){const y_=new Z_(e_);for(;this.currentLine<this.records.length;){const D_=this.getCurrentRecord();if(D_.type!==_u.ATTRIBUTE)break;const d0={attField:this.extractOneOrMore(D_,K0=>i_(K0)&&":"!==K0),_cur:0};":"===D_.value[D_.cur]&&(D_.cur+=1,d0.attValue=this.extractOneOrMore(D_,w_)),y_.parse(d0),this.currentLine++}return y_.digest()}parseKey(){const e_=this.getCurrentRecord();if(e_.type===_u.KEY){if("prompt"===e_.value||"clear:"===e_.value||"base64:"===e_.value||"uri:"===e_.value)return e_.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const e_=this.getCurrentRecord();if(e_.type===_u.ZONE_ADJUSTMENTS){const y_=[];for(;;)try{const D_=this.extract(e_,this.consumeTime);this.consumeSpaceForRecord(e_);let d0=!1;"-"===e_.value[e_.cur]&&(d0=!0,e_.cur+=1);const K0=this.extract(e_,this.consumeTypedTime);y_.push({time:D_,typedTime:K0,back:d0})}catch(D_){break}if(0===y_.length)throw new Error("Invalid zone adjustments");return this.currentLine++,y_}return[]}parseRepeat(){const e_=[];for(;;){const y_=this.getCurrentRecord();if(y_.type!==_u.REPEAT)break;{const D_=this.extract(y_,this.consumeRepeatInterval),d0=this.parseTypedTime(y_);e_.push({repeatInterval:D_,typedTimes:d0}),this.currentLine++}}return e_}parseTypedTime(e_){const y_=[];for(;;)try{this.consumeSpaceForRecord(e_),y_.push(this.extract(e_,this.consumeTypedTime))}catch(D_){break}if(0===y_.length)throw new Error("Invalid typed time.");return y_}parseTime(){const e_=this.getCurrentRecord(),y_=this.extract(e_,this.consumeTime);this.consumeSpaceForRecord(e_);const D_=this.extract(e_,this.consumeTime);return this.currentLine++,{startTime:y_,stopTime:D_}}parseBandWidth(){const e_=[];for(;this.currentLine<this.records.length;){const y_=this.getCurrentRecord();if(y_.type!==_u.BANDWIDTH)break;{const D_=this.extractOneOrMore(y_,i_);if(":"!==y_.value[y_.cur])throw new Error("Invalid bandwidth field.");y_.cur++;const d0=this.extractOneOrMore(y_,ch);e_.push({bwtype:D_,bandwidth:d0}),this.currentLine++}}return e_}parseVersion(){const e_=this.getCurrentRecord();if(e_.type!==_u.VERSION)throw new Error("first sdp record must be version");const y_=e_.value.slice(0,this.consumeOneOrMore(e_.value,0,ch));if(y_.length!==e_.value.length)throw new Error('invalid proto version, "v='.concat(e_.value,'"'));return this.currentLine++,y_}parseOrigin(){const e_=this.getCurrentRecord();if(e_.type!==_u.ORIGIN)throw new Error("second line of sdp must be origin");const y_=this.extractOneOrMore(e_,o_);this.consumeSpaceForRecord(e_);const D_=this.extractOneOrMore(e_,ch);this.consumeSpaceForRecord(e_);const d0=this.extractOneOrMore(e_,ch);this.consumeSpaceForRecord(e_);const K0=this.extractOneOrMore(e_,i_);this.consumeSpaceForRecord(e_);const FI=this.extractOneOrMore(e_,i_);this.consumeSpaceForRecord(e_);const MI=this.extract(e_,this.consumeUnicastAddress);return this.currentLine++,{username:y_,sessId:D_,sessVersion:d0,nettype:K0,addrtype:FI,unicastAddress:MI}}parseSessionName(){const e_=this.getCurrentRecord();if(e_.type===_u.SESSION_NAME){const y_=this.extract(e_,this.consumeText);return this.currentLine++,y_}}parseInformation(){const e_=this.getCurrentRecord();if(e_.type!==_u.INFORMATION)return;const y_=this.extract(e_,this.consumeText);return this.currentLine++,y_}parseUri(){const e_=this.getCurrentRecord();if(e_.type===_u.URI)return this.currentLine++,e_.value}parseEmail(){const e_=[];for(;;){const y_=this.getCurrentRecord();if(y_.type!==_u.EMAIL)break;e_.push(y_.value),this.currentLine++}return e_}parsePhone(){const e_=[];for(;;){const y_=this.getCurrentRecord();if(y_.type!==_u.PHONE)break;e_.push(y_.value),this.currentLine++}return e_}parseConnection(){const e_=this.getCurrentRecord();if(e_.type===_u.CONNECTION){const y_=this.extractOneOrMore(e_,i_);this.consumeSpaceForRecord(e_);const D_=this.extractOneOrMore(e_,i_);this.consumeSpaceForRecord(e_);const d0=this.extract(e_,this.consumeAddress);return this.currentLine++,{nettype:y_,addrtype:D_,address:d0}}}parseMedia(){const e_=this.getCurrentRecord(),y_=this.extract(e_,this.consumeToken);this.consumeSpaceForRecord(e_);let D_=this.extract(e_,this.consumePort);"/"===e_.value[e_.cur]&&(e_.cur+=1,D_+=this.extract(e_,this.consumeInteger)),this.consumeSpaceForRecord(e_);const d0=[];for(d0.push(this.extract(e_,this.consumeToken));"/"===e_.value[e_.cur];)e_.cur+=1,d0.push(this.extract(e_,this.consumeToken));if(0===d0.length)throw new Error("Invalid proto");const K0=this.parseFmt(e_);return this.currentLine++,{mediaType:y_,port:D_,protos:d0,fmts:K0}}parseTimeFields(){const e_=[];for(;this.getCurrentRecord().type===_u.TIME;){const y_=this.parseTime(),D_=this.parseRepeat(),d0=this.parseZone();e_.push({time:y_,repeats:D_,zones:d0})}return e_}parseMediaDescription(){const e_=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===_u.MEDIA;){const y_=this.parseMedia(),D_=this.parseInformation(),d0=this.parseConnections(),K0=this.parseBandWidth(),FI=this.parseKey(),MI=this.parseMediaAttributes(y_);e_.push({media:y_,information:D_,connections:d0,bandwidths:K0,key:FI,attributes:MI})}return e_}parseConnections(){const e_=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===_u.CONNECTION;)e_.push(this.parseConnection());return e_}parseFmt(e_){const y_=[];for(;;)try{this.consumeSpaceForRecord(e_),y_.push(this.extract(e_,this.consumeToken))}catch(D_){break}if(0===y_.length)throw new Error("Invalid fmts");return y_}extract(e_,y_,...D_){const d0=y_.call(this,e_.value,e_.cur,...D_),K0=e_.value.slice(e_.cur,d0);return e_.cur=d0,K0}extractOneOrMore(e_,y_){const D_=this.consumeOneOrMore(e_.value,e_.cur,y_),d0=e_.value.slice(e_.cur,D_);return e_.cur=D_,d0}consumeSpaceForRecord(e_){if(e_.value[e_.cur]!==_o)throw new Error("Invalid space at ".concat(e_.cur,"."));e_.cur+=1}}class a0 extends q0{constructor(...e_){super(...e_),rI(this,"attributes",void 0),rI(this,"digested",!1)}extractOneOrMore(e_,y_,D_){const d0=this.consumeOneOrMore(e_.attValue,e_._cur,y_),K0=e_.attValue.slice(e_._cur,d0),[FI,MI]=D_||[];if("number"==typeof FI&&K0.length<FI)throw new Error("error in length, should be more or equal than ".concat(FI," characters."));if("number"==typeof MI&&K0.length>MI)throw new Error("error in length, should be less or equal than ".concat(MI," characters."));return e_._cur=d0,K0}consumeAttributeSpace(e_){if(e_.attValue[e_._cur]!==_o)throw new Error("Invalid space at ".concat(e_._cur,"."));e_._cur+=1}extract(e_,y_,...D_){if(!e_.attValue)throw new Error("Nothing to extract from attValue.");const d0=y_.call(this,e_.attValue,e_._cur,...D_),K0=e_.attValue.slice(e_._cur,d0);return e_._cur=d0,K0}atEnd(e_){if(!e_.attValue)throw new Error;return e_._cur>=e_.attValue.length}peekChar(e_){if(!e_.attValue)throw new Error;return e_.attValue[e_._cur]}peek(e_,y_){if(!e_.attValue)throw new Error;for(let D_=0;D_<y_.length;D_++)if(y_[D_]!==e_.attValue[e_._cur+D_])return!1;return!0}parseIceUfrag(e_){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(e_,k_,[4,256])}parseIcePwd(e_){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(e_,k_,[22,256])}parseIceOptions(e_){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const y_=[];for(;!this.atEnd(e_);){y_.push(this.extractOneOrMore(e_,k_));try{this.consumeAttributeSpace(e_)}catch(D_){if(this.atEnd(e_))break;throw D_}}this.attributes.iceOptions=y_}parseFingerprint(e_){const y_=this.extract(e_,this.consumeToken);this.consumeAttributeSpace(e_);const D_=this.extract(e_,this.consumeTill);this.attributes.fingerprints.push({hashFunction:y_,fingerprint:D_})}parseExtmap(e_){const y_=this.extractOneOrMore(e_,ch);let D_;"/"===this.peekChar(e_)&&(this.extract(e_,this.consume,"/"),D_=this.extract(e_,this.consumeToken)),this.consumeAttributeSpace(e_);const d0=this.extract(e_,this.consumeTill,_o),K0=b0(b0({entry:parseInt(y_,10)},D_&&{direction:D_}),{},{extensionName:d0});this.peekChar(e_)===_o&&(this.consumeAttributeSpace(e_),K0.extensionAttributes=this.extract(e_,this.consumeTill)),this.attributes.extmaps.push(K0)}parseSetup(e_){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const y_=this.extract(e_,this.consumeTill);if("active"!==y_&&"passive"!==y_&&"actpass"!==y_&&"holdconn"!==y_)throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=y_}}class j_ extends a0{constructor(...e_){super(...e_),rI(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(e_){if(this.digested)throw new Error("already digested");try{switch(e_.attField){case"group":this.parseGroup(e_);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(e_);break;case"ice-pwd":this.parseIcePwd(e_);break;case"ice-options":this.parseIceOptions(e_);break;case"fingerprint":this.parseFingerprint(e_);break;case"setup":this.parseSetup(e_);break;case"tls-id":this.parseTlsId(e_);break;case"identity":this.parseIdentity(e_);break;case"extmap":this.parseExtmap(e_);break;case"msid-semantic":this.parseMsidSemantic(e_);break;default:e_.ignored=!0,this.attributes.unrecognized.push(e_)}}catch(y_){throw console.error("parsing session attribute ".concat(e_.attField,' error, "a=').concat(e_.attField,":").concat(e_.attValue,'"')),y_}if(!e_.ignored&&e_.attValue&&!this.atEnd(e_))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(e_){const y_=this.extract(e_,this.consumeToken),D_=[];for(;!this.atEnd(e_)&&this.peekChar(e_)===_o;)this.consumeAttributeSpace(e_),D_.push(this.extract(e_,this.consumeToken));this.attributes.groups.push({semantic:y_,identificationTag:D_})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(e_){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(e_,Rv)}parseIdentity(e_){const y_=this.extractOneOrMore(e_,f0),D_=[];for(;!this.atEnd(e_)&&this.peekChar(e_)===_o;){this.consumeAttributeSpace(e_);const d0=this.extract(e_,this.consumeToken);this.extract(e_,this.consume,"=");const K0=this.extractOneOrMore(e_,FI=>FI!==_o&&w_(FI));D_.push({name:d0,value:K0})}this.attributes.identities.push({assertionValue:y_,extensions:D_})}parseMsidSemantic(e_){this.peekChar(e_)===_o&&this.consumeAttributeSpace(e_);const y_={semantic:this.extract(e_,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(e_)}catch(D_){break}if("*"===this.peekChar(e_)){this.extract(e_,this.consume,"*"),y_.applyForAll=!0;break}{const D_=this.extract(e_,this.consumeTill,_o);y_.identifierList.push(D_)}}this.attributes.msidSemantic=y_}}class Z_ extends a0{constructor(e_){super(),rI(this,"attributes",void 0),-1!==e_.protos.indexOf("RTP")||e_.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(e_){if(this.digested)throw new Error("already digested");try{switch(e_.attField){case"extmap":this.parseExtmap(e_);break;case"setup":this.parseSetup(e_);break;case"ice-ufrag":this.parseIceUfrag(e_);break;case"ice-pwd":this.parseIcePwd(e_);break;case"ice-options":this.parseIceOptions(e_);break;case"candidate":this.parseCandidate(e_);break;case"remote-candidate":this.parseRemoteCandidate(e_);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(e_);break;case"rtpmap":this.parseRtpmap(e_);break;case"ptime":this.parsePtime(e_);break;case"maxptime":this.parseMaxPtime(e_);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(e_);break;case"ssrc":this.parseSSRC(e_);break;case"fmtp":this.parseFmtp(e_);break;case"rtcp-fb":this.parseRtcpFb(e_);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(e_);break;case"mid":this.parseMid(e_);break;case"msid":this.parseMsid(e_);break;case"imageattr":this.parseImageAttr(e_);break;case"rid":this.parseRid(e_);break;case"simulcast":this.parseSimulcast(e_);break;case"sctp-port":this.parseSctpPort(e_);break;case"max-message-size":this.parseMaxMessageSize(e_);break;case"ssrc-group":this.parseSSRCGroup(e_);break;default:e_.ignored=!0,this.attributes.unrecognized.push(e_)}}catch(y_){throw console.error("parsing media attribute ".concat(e_.attField,' error, "a=').concat(e_.attField,":").concat(e_.attValue,'"')),y_}if(!e_.ignored&&e_.attValue&&!this.atEnd(e_))throw new Error("attribute parsing error")}parseCandidate(e_){const y_=this.extractOneOrMore(e_,k_,[1,32]);this.consumeAttributeSpace(e_);const D_=this.extractOneOrMore(e_,ch,[1,5]);this.consumeAttributeSpace(e_);const d0=this.extract(e_,this.consumeToken);this.consumeAttributeSpace(e_);const K0=this.extractOneOrMore(e_,ch,[1,10]);this.consumeAttributeSpace(e_);const FI=this.extract(e_,this.consumeAddress);this.consumeAttributeSpace(e_);const MI=this.extract(e_,this.consumePort);this.consumeAttributeSpace(e_),this.extract(e_,this.consume,"typ"),this.consumeAttributeSpace(e_);const WI={foundation:y_,componentId:D_,transport:d0,priority:K0,connectionAddress:FI,port:MI,type:this.extract(e_,this.consumeToken),extension:{}};for(this.peek(e_," raddr")&&(this.extract(e_,this.consume," raddr"),this.consumeAttributeSpace(e_),WI.relAddr=this.extract(e_,this.consumeAddress)),this.peek(e_," rport")&&(this.extract(e_,this.consume," rport"),this.consumeAttributeSpace(e_),WI.relPort=this.extract(e_,this.consumePort));this.peekChar(e_)===_o;){this.consumeAttributeSpace(e_);const q1=this.extract(e_,this.consumeToken);this.consumeAttributeSpace(e_),WI.extension[q1]=this.extractOneOrMore(e_,_f)}this.attributes.candidates.push(WI)}parseRemoteCandidate(e_){const y_=[];for(;;){const D_=this.extractOneOrMore(e_,ch,[1,5]);this.consumeAttributeSpace(e_);const d0=this.extract(e_,this.consumeAddress);this.consumeAttributeSpace(e_);const K0=this.extract(e_,this.consumePort);y_.push({componentId:D_,connectionAddress:d0,port:K0});try{this.consumeAttributeSpace(e_)}catch(FI){break}}this.attributes.remoteCandidatesList.push(y_)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(e_){const y_=this.extract(e_,this.consumeToken);this.consumeAttributeSpace(e_);const D_=this.extract(e_,this.consumeTill,"/");this.extract(e_,this.consume,"/");const d0={encodingName:D_,clockRate:this.extractOneOrMore(e_,ch)};this.atEnd(e_)||"/"!==this.peekChar(e_)||(this.extract(e_,this.consume,"/"),d0.encodingParameters=parseInt(this.extract(e_,this.consumeTill),10));const K0=this.attributes.payloads.find(FI=>FI.payloadType===parseInt(y_,10));K0?K0.rtpMap=d0:this.attributes.payloads.push({payloadType:parseInt(y_,10),rtpMap:d0,rtcpFeedbacks:[]})}parsePtime(e_){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(e_,this.consumeTill)}parseMaxPtime(e_){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(e_,this.consumeTill)}parseDirection(e_){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=e_.attField}parseSSRC(e_){const y_=this.extractOneOrMore(e_,ch);this.consumeAttributeSpace(e_);const D_=this.extract(e_,this.consumeTill,":");let d0;":"===this.peekChar(e_)&&(this.extract(e_,this.consume,":"),d0=this.extract(e_,this.consumeTill));const K0=this.attributes.ssrcs.find(FI=>FI.ssrcId===parseInt(y_,10));K0?K0.attributes[D_]=d0:this.attributes.ssrcs.push({ssrcId:parseInt(y_,10),attributes:{[D_]:d0}})}parseFmtp(e_){const y_=this.extract(e_,this.consumeTill,_o);this.consumeAttributeSpace(e_);const D_=this.extract(e_,this.consumeTill),d0={};D_.split(";").forEach(FI=>{let[MI,WI]=FI.split("=");MI=MI.trim(),WI="string"==typeof WI?WI.trim():WI,"string"==typeof MI&&MI.length>0&&(d0[MI]=WI)});const K0=this.attributes.payloads.find(FI=>FI.payloadType===parseInt(y_,10));K0?K0.fmtp={parameters:d0}:this.attributes.payloads.push({payloadType:parseInt(y_,10),rtcpFeedbacks:[],fmtp:{parameters:d0}})}parseFmtParameters(e_){const y_={},D_=this.extract(e_,this.consumeTill,"=");e_._cur++;const d0=this.extract(e_,this.consumeTill,";");for(y_[D_]=d0;";"===e_.attValue[e_._cur];){const K0=this.extract(e_,this.consumeTill,"=");e_._cur++;const FI=this.extract(e_,this.consumeTill,";");y_[K0]=FI}return y_}parseRtcpFb(e_){let y_="";y_="*"===this.peekChar(e_)?this.extract(e_,this.consume,"*"):this.extract(e_,this.consumeTill,_o),this.consumeAttributeSpace(e_);const D_=this.extract(e_,this.consumeTill,_o);let d0;if("trr-int"===D_)d0={type:D_,interval:this.extract(e_,this.consumeTill)};else{const K0={type:D_};this.peekChar(e_)===_o&&(this.consumeAttributeSpace(e_),K0.parameter=this.extract(e_,this.consumeToken),this.peekChar(e_)===_o&&(K0.additional=this.extract(e_,this.consumeTill))),d0=K0}if("*"===y_)this.attributes.rtcpFeedbackWildcards.push(d0);else{const K0=this.attributes.payloads.find(FI=>FI.payloadType===parseInt(y_,10));K0?K0.rtcpFeedbacks.push(d0):this.attributes.payloads.push({payloadType:parseInt(y_,10),rtcpFeedbacks:[d0]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(e_){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const y_={port:this.extract(e_,this.consumePort)};this.peekChar(e_)===_o&&(this.consumeAttributeSpace(e_),y_.netType=this.extractOneOrMore(e_,i_),this.consumeAttributeSpace(e_),y_.addressType=this.extractOneOrMore(e_,i_),this.consumeAttributeSpace(e_),y_.address=this.extract(e_,this.consumeAddress)),this.attributes.rtcp=y_}parseMsid(e_){const y_={id:this.extractOneOrMore(e_,i_,[1,64])};this.peekChar(e_)===_o&&(this.consumeAttributeSpace(e_),y_.appdata=this.extractOneOrMore(e_,i_,[1,64])),this.attributes.msids.push(y_)}parseImageAttr(e_){this.attributes.imageattr.push(e_.attValue)}parseRid(e_){const y_=this.extractOneOrMore(e_,d0=>g_(d0)||ch(d0)||"_"===d0||"-"===d0);this.consumeAttributeSpace(e_);const D_={id:y_,direction:this.extract(e_,this.consumeToken),params:[]};if(this.peekChar(e_)===_o){if(this.consumeAttributeSpace(e_),this.peek(e_,"pt=")){this.extract(e_,this.consume,"pt=");const d0=[];for(;;){const K0=this.extract(e_,this.consumeToken);d0.push(K0);try{this.extract(e_,this.consume,",")}catch(FI){break}}D_.payloads=d0,this.peekChar(e_)===_o&&this.extract(e_,this.consume,_o)}for(;;){const d0=this.extract(e_,this.consumeToken);switch(d0){case"depend":{const K0={type:d0,rids:this.extract(e_,this.consume,"=").split(",")};D_.params.push(K0);break}default:{const K0={type:d0};"="===this.peekChar(e_)&&(this.extract(e_,this.consume,"="),K0.val=this.extract(e_,this.consumeTill,";")),D_.params.push(K0)}}try{this.extract(e_,this.consume,";")}catch(K0){break}}}this.attributes.rids.push(D_)}parseSimulcast(e_){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=e_.attValue,this.extract(e_,this.consumeTill)}parseSctpPort(e_){this.attributes.sctpPort=this.extractOneOrMore(e_,ch,[1,5])}parseMaxMessageSize(e_){this.attributes.maxMessageSize=this.extractOneOrMore(e_,ch,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(e_){this.attributes.mid=this.extract(e_,this.consumeToken)}parseSSRCGroup(e_){const y_=this.extract(e_,this.consumeToken),D_=[];for(;;)try{this.consumeAttributeSpace(e_);const d0=this.extract(e_,this.consumeInteger);D_.push(parseInt(d0,10))}catch(d0){break}this.attributes.ssrcGroups.push({semantic:y_,ssrcIds:D_})}}function o0(A0,e_,y_){return e_ in A0?Object.defineProperty(A0,e_,{value:y_,enumerable:!0,configurable:!0,writable:!0}):A0[e_]=y_,A0}class z0{constructor(){o0(this,"eol",_i)}print(e_,y_){let D_="";return y_&&(this.eol=y_),D_+=this.printVersion(e_.version),D_+=this.printOrigin(e_.origin),D_+=this.printSessionName(e_.sessionName),D_+=this.printInformation(e_.information),D_+=this.printUri(e_.uri),D_+=this.printEmail(e_.emails),D_+=this.printPhone(e_.phones),D_+=this.printConnection(e_.connection),D_+=this.printBandwidth(e_.bandwidths),D_+=this.printTimeFields(e_.timeFields),D_+=this.printKey(e_.key),D_+=this.printSessionAttributes(e_.attributes),D_+=this.printMediaDescription(e_.mediaDescriptions),D_}printVersion(e_){return"v=".concat(e_).concat(this.eol)}printOrigin(e_){return"o=".concat(e_.username," ").concat(e_.sessId," ").concat(e_.sessVersion," ").concat(e_.nettype," ").concat(e_.addrtype," ").concat(e_.unicastAddress).concat(this.eol)}printSessionName(e_){return e_?"s=".concat(e_).concat(this.eol):""}printInformation(e_){return e_?"i=".concat(e_).concat(this.eol):""}printUri(e_){return e_?"u=".concat(e_).concat(this.eol):""}printEmail(e_){let y_="";for(const D_ of e_)y_+="e=".concat(D_).concat(this.eol);return y_}printPhone(e_){let y_="";for(const D_ of e_)y_+="e=".concat(D_).concat(this.eol);return y_}printConnection(e_){return e_?"c=".concat(e_.nettype," ").concat(e_.addrtype," ").concat(e_.address).concat(this.eol):""}printBandwidth(e_){let y_="";for(const D_ of e_)y_+="b=".concat(D_.bwtype,":").concat(D_.bandwidth).concat(this.eol);return y_}printTimeFields(e_){let y_="";for(const D_ of e_){y_+="t=".concat(D_.time.startTime," ").concat(D_.time.startTime).concat(this.eol);for(const d0 of D_.repeats)y_+="r=".concat(d0.repeatInterval," ").concat(d0.typedTimes.join(" ")).concat(this.eol);D_.zoneAdjustments&&(y_+="z=",y_+="z=".concat(D_.zoneAdjustments.map(d0=>"".concat(d0.time," ").concat(d0.back?"-":""," ").concat(d0.typedTime)).join(" ")).concat(this.eol),y_+=this.eol)}return y_}printKey(e_){return e_?"k=".concat(e_).concat(this.eol):""}printAttributes(e_){let y_="";for(const D_ of e_)y_+="a=".concat(D_.attField).concat(D_.attValue?":".concat(D_.attValue):"").concat(this.eol);return y_}printMediaDescription(e_){let y_="";for(const D_ of e_)y_+=this.printMedia(D_.media),y_+=this.printInformation(D_.information),y_+=this.printConnections(D_.connections),y_+=this.printBandwidth(D_.bandwidths),y_+=this.printKey(D_.key),y_+=this.printMediaAttributes(D_);return y_}printConnections(e_){let y_="";for(const D_ of e_)y_+=this.printConnection(D_);return y_}printMedia(e_){return"m=".concat(e_.mediaType," ").concat(e_.port," ").concat(e_.protos.join("/")," ").concat(e_.fmts.join(" ")).concat(this.eol)}printSessionAttributes(e_){return new X_(this.eol).print(e_)}printMediaAttributes(e_){return new u0(this.eol).print(e_)}}class q_{constructor(e_){o0(this,"eol",void 0),this.eol=e_}printIceUfrag(e_){return void 0===e_?"":"a=ice-ufrag:".concat(e_).concat(this.eol)}printIcePwd(e_){return void 0===e_?"":"a=ice-pwd:".concat(e_).concat(this.eol)}printIceOptions(e_){return void 0===e_?"":"a=ice-options:".concat(e_.join(_o)).concat(this.eol)}printFingerprints(e_){return e_.length>0?e_.map(y_=>"a=fingerprint:".concat(y_.hashFunction).concat(_o).concat(y_.fingerprint)).join(this.eol)+this.eol:""}printExtmap(e_){return e_.map(y_=>"a=extmap:".concat(y_.entry).concat(y_.direction?"/".concat(y_.direction):"").concat(_o).concat(y_.extensionName).concat(y_.extensionAttributes?"".concat(_o).concat(y_.extensionAttributes):"").concat(this.eol)).join("")}printSetup(e_){return void 0===e_?"":"a=setup:".concat(e_).concat(this.eol)}printUnrecognized(e_){return e_.map(y_=>"a=".concat(y_.attField).concat(y_.attValue?":".concat(y_.attValue):"").concat(this.eol)).join("")}}class X_ extends q_{print(e_){let y_="";return y_+=this.printGroups(e_.groups),y_+=this.printMsidSemantic(e_.msidSemantic),y_+=this.printIceLite(e_.iceLite),y_+=this.printIceUfrag(e_.iceUfrag),y_+=this.printIcePwd(e_.icePwd),y_+=this.printIceOptions(e_.iceOptions),y_+=this.printFingerprints(e_.fingerprints),y_+=this.printSetup(e_.setup),y_+=this.printTlsId(e_.tlsId),y_+=this.printIdentity(e_.identities),y_+=this.printExtmap(e_.extmaps),y_+=this.printUnrecognized(e_.unrecognized),y_}printGroups(e_){let y_="";return e_.length>0&&(y_+=e_.map(D_=>"a=group:".concat(D_.semantic).concat(D_.identificationTag.map(d0=>"".concat(_o).concat(d0)).join("")).concat(this.eol)).join("")),y_}printIceLite(e_){return void 0===e_?"":"a=ice-lite"+this.eol}printTlsId(e_){return e_?"a=tls-id:".concat(e_).concat(this.eol):""}printIdentity(e_){return 0===e_.length?"":e_.map(y_=>"a=identity:".concat(y_.assertionValue).concat(y_.extensions.map(D_=>"".concat(_o).concat(D_.name).concat(D_.value?"=".concat(D_.value):"")))).join(this.eol)+this.eol}printMsidSemantic(e_){if(!e_)return"";let y_="a=msid-semantic:".concat(e_.semantic);return e_.applyForAll?y_+="".concat(_o,"*"):e_.identifierList.length>0&&(y_+=e_.identifierList.map(D_=>"".concat(_o).concat(D_))),y_+this.eol}}class u0 extends q_{print(e_){const y_=e_.attributes;let D_="";return D_+=this.printRTCP(y_.rtcp),D_+=this.printIceUfrag(y_.iceUfrag),D_+=this.printIcePwd(y_.icePwd),D_+=this.printIceOptions(y_.iceOptions),D_+=this.printCandidates(y_.candidates),D_+=this.printRemoteCandidatesList(y_.remoteCandidatesList),D_+=this.printEndOfCandidates(y_.endOfCandidates),D_+=this.printFingerprints(y_.fingerprints),D_+=this.printSetup(y_.setup),D_+=this.printMid(y_.mid),D_+=this.printExtmap(y_.extmaps),D_+=this.printRTPRelated(y_),D_+=this.printPtime(y_.ptime),D_+=this.printMaxPtime(y_.maxPtime),D_+=this.printDirection(y_.direction),D_+=this.printSSRCGroups(y_.ssrcGroups),D_+=this.printSSRC(y_.ssrcs),D_+=this.printRTCPMux(y_.rtcpMux),D_+=this.printRTCPMuxOnly(y_.rtcpMuxOnly),D_+=this.printRTCPRsize(y_.rtcpRsize),D_+=this.printMSId(y_.msids),D_+=this.printImageattr(y_.imageattr),D_+=this.printRid(y_.rids),D_+=this.printSimulcast(y_.simulcast),D_+=this.printSCRPPort(y_.sctpPort),D_+=this.printMaxMessageSize(y_.maxMessageSize),D_+=this.printUnrecognized(y_.unrecognized),D_}printCandidates(e_){return e_.map(y_=>"a=candidate:".concat(y_.foundation).concat(_o).concat(y_.componentId).concat(_o).concat(y_.transport).concat(_o).concat(y_.priority).concat(_o).concat(y_.connectionAddress).concat(_o).concat(y_.port).concat(_o,"typ").concat(_o).concat(y_.type).concat(y_.relAddr?"".concat(_o,"raddr").concat(_o).concat(y_.relAddr):"").concat(y_.relPort?"".concat(_o,"rport").concat(_o).concat(y_.relPort):"").concat(Object.keys(y_.extension).map(D_=>"".concat(_o).concat(D_).concat(_o).concat(y_.extension[D_])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(e_){return e_.map(y_=>"a=remote-candidates:".concat(y_.join(_o)).concat(this.eol)).join("")}printEndOfCandidates(e_){return void 0===e_?"":"a=end-of-candidates"+this.eol}printRTPRelated(e_){if(!e_.payloads)return"";const y_=e_.payloads;let D_="";D_+=e_.rtcpFeedbackWildcards.map(d0=>this.printRTCPFeedback("*",d0)).join("");for(const d0 of y_)D_+=this.printRtpMap(d0.payloadType,d0.rtpMap),D_+=this.printFmtp(d0.payloadType,d0.fmtp),D_+=d0.rtcpFeedbacks.map(K0=>this.printRTCPFeedback(d0.payloadType,K0)).join("");return D_}printFmtp(e_,y_){if(!y_)return"";const D_=Object.keys(y_.parameters);return 1===D_.length&&void 0===y_.parameters[D_[0]]?"a=fmtp:".concat(e_).concat(_o).concat(D_[0]).concat(this.eol):"a=fmtp:".concat(e_).concat(_o).concat(Object.keys(y_.parameters).map(d0=>"".concat(d0,"=").concat(y_.parameters[d0])).join(";")).concat(this.eol)}printRtpMap(e_,y_){return y_?"a=rtpmap:".concat(e_).concat(_o).concat(y_.encodingName,"/").concat(y_.clockRate).concat(y_.encodingParameters?"/".concat(y_.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(e_,y_){let D_="a=rtcp-fb:".concat(e_).concat(_o),d0=y_;return"trr-int"===d0.type?D_+="ttr-int".concat(_o).concat(d0.interval):(d0=d0,D_+="".concat(d0.type),d0.parameter&&(D_+="".concat(_o).concat(d0.parameter),d0.additional&&(D_+="".concat(_o).concat(d0.additional)))),D_+this.eol}printPtime(e_){return void 0===e_?"":"a=ptime:".concat(e_).concat(this.eol)}printMaxPtime(e_){return void 0===e_?"":"a=maxptime:".concat(e_).concat(this.eol)}printDirection(e_){return void 0===e_?"":"a=".concat(e_).concat(this.eol)}printSSRC(e_){return e_.map(y_=>Object.keys(y_.attributes).map(D_=>"a=ssrc:".concat(y_.ssrcId.toString(10)).concat(_o).concat(D_).concat(y_.attributes[D_]?":".concat(y_.attributes[D_]):"").concat(this.eol)).join("")).join("")}printRTCPMux(e_){return void 0===e_?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(e_){return void 0===e_?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(e_){return void 0===e_?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(e_){if(void 0===e_)return"";let y_="a=rtcp:".concat(e_.port);return e_.netType&&(y_+="".concat(_o).concat(e_.netType)),e_.addressType&&(y_+="".concat(_o).concat(e_.addressType)),e_.address&&(y_+="".concat(_o).concat(e_.address)),y_+this.eol}printMSId(e_){return e_.map(y_=>"a=msid:".concat(y_.id).concat(y_.appdata?"".concat(_o).concat(y_.appdata):"").concat(this.eol)).join("")}printImageattr(e_){return e_.map(y_=>"a=imageattr:".concat(y_).concat(this.eol)).join("")}printRid(e_){return e_.map(y_=>{let D_="a=rid:".concat(y_.id).concat(_o).concat(y_.direction);return y_.payloads&&(D_+="".concat(_o,"pt=").concat(y_.payloads.join(","))),y_.params.length>0&&(D_+="".concat(_o).concat(y_.params.map(d0=>"depend"===d0.type?"depend=".concat(d0.rids.join(",")):"".concat(d0.type,"=").concat(d0.val)).join(";"))),D_+this.eol}).join("")}printSimulcast(e_){return void 0===e_?"":"a=simulcast:".concat(e_).concat(this.eol)}printSCRPPort(e_){return void 0===e_?"":"a=sctp-port:".concat(e_).concat(this.eol)}printMaxMessageSize(e_){return void 0===e_?"":"a=max-message-size:".concat(e_)}printMid(e_){return void 0===e_?"":"a=mid:".concat(e_).concat(this.eol)}printSSRCGroups(e_){return e_.map(y_=>"a=ssrc-group:".concat(y_.semantic).concat(y_.ssrcIds.map(D_=>"".concat(_o).concat(D_.toString(10))).join("")).concat(this.eol)).join("")}}function B0(A0){return(new Z0).parse(A0)}function $0(A0,e_){return(new z0).print(A0,e_)}}},y={};function w($){if(y[$])return y[$].exports;var j=y[$]={exports:{}};return A[$](j,j.exports,w),j.exports}return w.d=($,j)=>{for(var _e in j)w.o(j,_e)&&!w.o($,_e)&&Object.defineProperty($,_e,{enumerable:!0,get:j[_e]})},w.o=($,j)=>Object.prototype.hasOwnProperty.call($,j),w.r=$=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty($,Symbol.toStringTag,{value:"Module"}),Object.defineProperty($,"__esModule",{value:!0})},w(8)})()}(h3);class cbe{constructor(p){a_(this,"sessionDesc",void 0),a_(this,"localCapabilities",void 0),a_(this,"rtpCapabilities",void 0),a_(this,"candidates",void 0),a_(this,"iceParameters",void 0),a_(this,"dtlsParameters",void 0),a_(this,"setup",void 0),a_(this,"currentMidIndex",void 0),a_(this,"cname",void 0),p=jS(p);const{remoteIceParameters:A,remoteDtlsParameters:y,candidates:w,remoteRTPCapabilities:$,remoteSetup:j,localCapabilities:_e,sdkCodec:K,cname:_i}=p,_o=h3.exports.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE audio video\na=msid-semantic: WMS\na=ice-lite\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:audio\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:video\n");this.rtpCapabilities=$,this.candidates=w,this.iceParameters=A,this.dtlsParameters=y,this.setup=j,this.localCapabilities=_e,this.cname=_i;for(let _u=0;_u<_o.mediaDescriptions.length;_u++){const ch=_o.mediaDescriptions[_u];if(ch.attributes.iceUfrag=A.iceUfrag,ch.attributes.icePwd=A.icePwd,ch.attributes.fingerprints=y.fingerprints,ch.attributes.candidates=w,ch.attributes.setup=j,"video"===ch.media.mediaType){ch.media.fmts=$.videoCodecs.map(o_=>o_.payloadType.toString(10));const _f=$.videoCodecs.filter(o_=>{var i_;return null===(i_=o_.rtpMap)||void 0===i_?void 0:i_.encodingName.toLowerCase().includes(K)});if(0===_f.length)throw new Error("Codec ".concat(K," not supported by remote SDP."));ch.attributes.payloads=_f,ch.attributes.extmaps=$.videoExtensions}"audio"===ch.media.mediaType&&(ch.media.fmts=$.audioCodecs.map(_f=>_f.payloadType.toString(10)),ch.attributes.payloads=$.audioCodecs,ch.attributes.extmaps=$.audioExtensions),_o.mediaDescriptions[_u]=this.mungMediaDesc(ch)}this.sessionDesc=_o,this.currentMidIndex=_o.mediaDescriptions.length-1}toString(){return h3.exports.print(this.sessionDesc)}send(p,A,y){const{ssrcs:w,ssrcGroups:$}=soe(A,this.cname),j=this.sessionDesc.mediaDescriptions.find(_i=>p===o1.VIDEO?"video"===_i.media.mediaType:"audio"===_i.media.mediaType),_e=w[0].attributes.label,K=w[0].attributes.mslabel;return j.attributes.ssrcs=j.attributes.ssrcs.concat(w),j.attributes.ssrcGroups=j.attributes.ssrcGroups.concat($),{id:_e,mslabel:K}}batchSend(p){return p.map(A=>{let{kind:y,ssrcMsg:w}=A;return this.send(y,w,void 0)})}stopSending(p){this.sessionDesc.mediaDescriptions.forEach(A=>{const y=[],w=[],$=[];A.attributes.ssrcs.forEach(j=>{p.includes(j.attributes.label||"")?$.push(j):y.push(j)}),A.attributes.ssrcGroups.forEach(j=>{$.map(_e=>_e.ssrcId).includes(j.ssrcIds[0])||w.push(j)}),A.attributes.ssrcs=y,A.attributes.ssrcGroups=w})}mute(p){const A=this.sessionDesc.mediaDescriptions.find(y=>y.attributes.mid===p);if(!A)throw new Error("mediaDescription not found with ".concat(p," in remote SDP when calling RemoteSDP.mute."));A.attributes.direction="inactive"}unmute(p){const A=this.sessionDesc.mediaDescriptions.find(y=>y.attributes.mid===p);if(!A)throw new Error("mediaDescription not found with ".concat(p," in remote SDP when calling RemoteSDP.unmute."));A.attributes.direction="sendonly"}receive(p,A,y){p.forEach((w,$)=>{const j=w._mediaStreamTrack,_e=this.sessionDesc.mediaDescriptions.findIndex(_i=>_i.attributes.mid===j.kind),K=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[_e],w);this.sessionDesc.mediaDescriptions[_e]=K})}stopReceiving(p){}restartICE(p,A){p=jS(p),A=jS(A),this.iceParameters=p,this.candidates=A,this.sessionDesc.mediaDescriptions.forEach(y=>{y.attributes.iceUfrag=p.iceUfrag,y.attributes.icePwd=p.icePwd,y.attributes.candidates=this.candidates})}predictReceivingMids(p){const A=[];for(let y=0;y<p;y++)A.push((this.currentMidIndex+y+1).toString(10));return A}mungRecvMediaDsec(p,A){const y=jS(p);return Vme(y,A),n0e(y,A),y}updateRecvMedia(p,A){const y=this.sessionDesc.mediaDescriptions.findIndex(w=>w.attributes.mid===p);if(-1!==y){const w=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[y],A);this.sessionDesc.mediaDescriptions[y]=w}}bumpMid(p){this.currentMidIndex+=p}updateTrackLabel(p,A,y){const w=this.sessionDesc.mediaDescriptions.find(j=>p===o1.VIDEO?"video"===j.attributes.mid:"audio"===j.attributes.mid);if(w){const j=w.attributes.ssrcs.find(_e=>_e.attributes.label===A);var $;j&&(j.attributes.label=y,null===($=j.attributes.msid)||void 0===$||$.replace(A,y))}}mungMediaDesc(p){const A=jS(p);return t0e(A),function(y){const w=y.attributes.extmaps.find($=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===$.extensionName);w&&y.attributes.extmaps.splice(y.attributes.extmaps.indexOf(w),1),y.attributes.payloads.forEach($=>{const j=$.rtcpFeedbacks.findIndex(_e=>"transport-cc"===_e.type);-1!==j&&$.rtcpFeedbacks.splice(j,1)})}(A),A}}function Z4(s){if(Array.isArray(s))return s.map(function(y){return y});if(!o0e(s))return s;var p={};for(var A in s)p[A]=o0e(s[A])||Array.isArray(s[A])?Z4(s[A]):s[A];return p}function o0e(s){return!("object"!=typeof s||Array.isArray(s)||!s)}var Kye=function(){function s(p){this.input=[],this.size=p}return s.prototype.add=function(p){this.input.push(p),this.input.length>this.size&&this.input.splice(0,1)},s.prototype.diffMean=function(){return 0===this.input.length?0:(this.input[this.input.length-1]-this.input[0])/this.input.length},s}(),s0e=function(s,p){return(s0e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,y){A.__proto__=y}||function(A,y){for(var w in y)y.hasOwnProperty(w)&&(A[w]=y[w])})(s,p)};function zye(s,p){function A(){this.constructor=s}s0e(s,p),s.prototype=null===p?Object.create(p):(A.prototype=p.prototype,new A)}var BX=function(){return(BX=Object.assign||function(s){for(var p,A=1,y=arguments.length;A<y;A++)for(var w in p=arguments[A])Object.prototype.hasOwnProperty.call(p,w)&&(s[w]=p[w]);return s}).apply(this,arguments)};function Yye(s,p,A,y){return new(A||(A=Promise))(function(w,$){function j(_i){try{K(y.next(_i))}catch(_o){$(_o)}}function _e(_i){try{K(y.throw(_i))}catch(_o){$(_o)}}function K(_i){_i.done?w(_i.value):new A(function(_o){_o(_i.value)}).then(j,_e)}K((y=y.apply(s,p||[])).next())})}function Jye(s,p){var A,y,w,$,j={label:0,sent:function(){if(1&w[0])throw w[1];return w[1]},trys:[],ops:[]};return $={next:_e(0),throw:_e(1),return:_e(2)},"function"==typeof Symbol&&($[Symbol.iterator]=function(){return this}),$;function _e(K){return function(_i){return function(_o){if(A)throw new TypeError("Generator is already executing.");for(;j;)try{if(A=1,y&&(w=2&_o[0]?y.return:_o[0]?y.throw||((w=y.return)&&w.call(y),0):y.next)&&!(w=w.call(y,_o[1])).done)return w;switch(y=0,w&&(_o=[2&_o[0],w.value]),_o[0]){case 0:case 1:w=_o;break;case 4:return j.label++,{value:_o[1],done:!1};case 5:j.label++,y=_o[1],_o=[0];continue;case 7:_o=j.ops.pop(),j.trys.pop();continue;default:if(!((w=(w=j.trys).length>0&&w[w.length-1])||6!==_o[0]&&2!==_o[0])){j=0;continue}if(3===_o[0]&&(!w||_o[1]>w[0]&&_o[1]<w[3])){j.label=_o[1];break}if(6===_o[0]&&j.label<w[1]){j.label=w[1],w=_o;break}if(w&&j.label<w[2]){j.label=w[2],j.ops.push(_o);break}w[2]&&j.ops.pop(),j.trys.pop();continue}_o=p.call(s,j)}catch(_u){_o=[6,_u],y=0}finally{A=w=0}if(5&_o[0])throw _o[1];return{value:_o[0]?_o[1]:void 0,done:!0}}([K,_i])}}}var X4,a0e={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},_de={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:a0e,remoteCandidate:a0e}},c0e={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0},u0e={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,qpSumPerFrame:0},l0e={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0},d0e={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0},$ye=function(){function s(p,A){var y=this;this.videoIsReady=!1,this.videoIsReady2={},this.stats=Z4(_de),this.isFirstVideoReceived={},this.isFirstVideoDecoded={},this.isFirstAudioReceived={},this.isFirstAudioDecoded={},this.lossRateWindowStats=[],this.pc=p,this.options=A,this.intervalTimer=window.setInterval(function(){return Yye(y,void 0,void 0,function(){return Jye(this,function(w){return this.updateStats(),[2]})})},this.options.updateInterval)}return s.prototype.getStats=function(){return this.stats},s.prototype.setVideoIsReady=function(p){this.videoIsReady=p},s.prototype.setVideoIsReady2=function(p,A){this.videoIsReady2[p]=A},s.prototype.getVideoIsReady=function(p){return this.videoIsReady2[p]||!1},s.prototype.setIsFirstAudioDecoded=function(p){},s.prototype.destroy=function(){window.clearInterval(this.intervalTimer),this.pc=void 0},s.prototype.calcLossRate=function(p){var A=this;this.lossRateWindowStats.push(p),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);for(var y=this.lossRateWindowStats.length,w=0,$=0,j=0,_e=0,K=function(_u){p[_u].forEach(function(ch,_f){if(A.lossRateWindowStats[y-1][_u][_f]&&A.lossRateWindowStats[0][_u][_f]){var o_=A.lossRateWindowStats[y-1][_u][_f].packets-A.lossRateWindowStats[0][_u][_f].packets,i_=A.lossRateWindowStats[y-1][_u][_f].packetsLost-A.lossRateWindowStats[0][_u][_f].packetsLost;"videoSend"===_u||"audioSend"===_u?(w+=o_,j+=i_):($+=o_,_e+=i_),ch.packetLostRate=Number.isNaN(o_)||Number.isNaN(o_)||o_<=0||i_<=0?0:i_/(o_+i_)}})},_i=0,_o=["videoSend","audioSend","videoRecv","audioRecv"];_i<_o.length;_i++)K(_o[_i]);p.sendPacketLossRate=w<=0||j<=0?0:j/(w+j),p.recvPacketLossRate=$<=0||_e<=0?0:_e/($+_e)},s}(),ube=function(s){function p(){var A=null!==s&&s.apply(this,arguments)||this;return A._stats=_de,A.lastDecodeVideoReceiverStats=new Map,A}return zye(p,s),p.prototype.updateStats=function(){return Yye(this,void 0,void 0,function(){var A,y,w,$;return Jye(this,function(j){switch(j.label){case 0:return[4,this._getStats()];case 1:return A=j.sent(),y=this.statsResponsesToObjects(A),this._stats=Z4(_de),w=y.filter(function(_e){return"ssrc"===_e.type}),this.processSSRCStats(w),($=y.find(function(_e){return"VideoBwe"===_e.type}))&&this.processBandwidthStats($),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}})})},p.prototype.processBandwidthStats=function(A){this._stats.bitrate={actualEncoded:Number(A.googActualEncBitrate),targetEncoded:Number(A.googTargetEncBitrate),retransmit:Number(A.googRetransmitBitrate),transmit:Number(A.googTransmitBitrate)},this._stats.sendBandwidth=Number(A.googAvailableSendBandwidth)},p.prototype.processSSRCStats=function(A){var y=this;A.forEach(function(w){var $=w.id.includes("send");switch(w.mediaType+"_"+($?"send":"recv")){case"video_send":var j=Z4(u0e);j.codec=w.googCodecName,j.adaptionChangeReason="none",w.googCpuLimitedResolution&&(j.adaptionChangeReason="cpu"),w.googBandwidthLimitedResolution&&(j.adaptionChangeReason="bandwidth"),j.avgEncodeMs=Number(w.googAvgEncodeMs),j.inputFrame={width:Number(w.googFrameWidthInput)||Number(w.googFrameWidthSent),height:Number(w.googFrameHeightInput)||Number(w.googFrameHeightSent),frameRate:Number(w.googFrameRateInput)},j.sentFrame={width:Number(w.googFrameWidthSent),height:Number(w.googFrameHeightSent),frameRate:Number(w.googFrameRateInput)},j.firsCount=Number(w.googFirReceived),j.nacksCount=Number(w.googNacksReceived),j.plisCount=Number(w.googPlisReceived),j.frameCount=Number(w.framesEncoded),j.bytes=Number(w.bytesSent),j.packets=Number(w.packetsSent),j.packetsLost=Number(w.packetsLost),j.ssrc=Number(w.ssrc),j.rttMs=Number(w.googRtt||0),y._stats.videoSend.push(j),y._stats.rtt=j.rttMs;break;case"video_recv":var _e=Z4(c0e),K=y.lastDecodeVideoReceiverStats.get(Number(w.ssrc));if(_e.codec=w.googCodecName,_e.targetDelayMs=Number(w.googTargetDelayMs),_e.renderDelayMs=Number(w.googRenderDelayMs),_e.currentDelayMs=Number(w.googCurrentDelayMs),_e.minPlayoutDelayMs=Number(w.googMinPlayoutDelayMs),_e.decodeMs=Number(w.googDecodeMs),_e.maxDecodeMs=Number(w.googMaxDecodeMs),_e.receivedFrame={width:Number(w.googFrameWidthReceived),height:Number(w.googFrameHeightReceived),frameRate:Number(w.googFrameRateReceived)},_e.decodedFrame={width:Number(w.googFrameWidthReceived),height:Number(w.googFrameHeightReceived),frameRate:Number(w.googFrameRateDecoded)},_e.outputFrame={width:Number(w.googFrameWidthReceived),height:Number(w.googFrameHeightReceived),frameRate:Number(w.googFrameRateOutput)},_e.jitterBufferMs=Number(w.googJitterBufferMs),_e.firsCount=Number(w.googFirsSent),_e.nacksCount=Number(w.googNacksSent),_e.plisCount=Number(w.googPlisSent),_e.framesDecodeCount=Number(w.framesDecoded),_e.bytes=Number(w.bytesReceived),_e.packets=Number(w.packetsReceived),_e.packetsLost=Number(w.packetsLost),_e.ssrc=Number(w.ssrc),_e.packets>0&&!y.isFirstVideoReceived[_e.ssrc]&&(y.onFirstVideoReceived&&y.onFirstVideoReceived(_e.ssrc),y.isFirstVideoReceived[_e.ssrc]=!0),_e.framesDecodeCount>0&&!y.isFirstVideoDecoded[_e.ssrc]&&(y.onFirstVideoDecoded&&y.onFirstVideoDecoded(_e.ssrc,_e.decodedFrame.width,_e.decodedFrame.height),y.isFirstVideoDecoded[_e.ssrc]=!0),K){var _i=K.stats,_o=Date.now()-K.lts;_e.framesDecodeFreezeTime=_i.framesDecodeFreezeTime,_e.framesDecodeInterval=_i.framesDecodeInterval,_e.framesDecodeCount>_i.framesDecodeCount&&y.isFirstVideoDecoded?(K.lts=Date.now(),_e.framesDecodeInterval=_o,_e.framesDecodeInterval>=y.options.freezeRateLimit&&(y.getVideoIsReady(parseInt(w.ssrc,10))?_e.framesDecodeFreezeTime+=_e.framesDecodeInterval:y.setVideoIsReady2(parseInt(w.ssrc,10),!0))):_e.framesDecodeCount<K.stats.framesDecodeCount&&(_e.framesDecodeInterval=0)}y.lastDecodeVideoReceiverStats.set(_e.ssrc,{stats:BX({},_e),lts:Date.now()}),y._stats.videoRecv.push(_e);break;case"audio_recv":var _u=Z4(d0e);_u.codec=w.googCodecName,_u.outputLevel=Math.abs(Number(w.audioOutputLevel))/32767,_u.decodingCNG=Number(w.googDecodingCNG),_u.decodingCTN=Number(w.googDecodingCTN),_u.decodingCTSG=Number(w.googDecodingCTSG),_u.decodingNormal=Number(w.googDecodingNormal),_u.decodingPLC=Number(w.googDecodingPLC),_u.decodingPLCCNG=Number(w.googDecodingPLCCNG),_u.expandRate=Number(w.googExpandRate),_u.accelerateRate=Number(w.googAccelerateRate),_u.preemptiveExpandRate=Number(w.googPreemptiveExpandRate),_u.secondaryDecodedRate=Number(w.googSecondaryDecodedRate),_u.speechExpandRate=Number(w.googSpeechExpandRate),_u.preferredJitterBufferMs=Number(w.googPreferredJitterBufferMs),_u.jitterBufferMs=Number(w.googJitterBufferMs),_u.jitterMs=Number(w.googJitterReceived),_u.bytes=Number(w.bytesReceived),_u.packets=Number(w.packetsReceived),_u.packetsLost=Number(w.packetsLost),_u.ssrc=Number(w.ssrc),_u.receivedFrames=Number(w.googDecodingCTN)||Number(w.packetsReceived),_u.droppedFrames=Number(w.googDecodingPLC)+Number(w.googDecodingPLCCNG)||Number(w.packetsLost),_u.receivedFrames>0&&!y.isFirstAudioReceived[_u.ssrc]&&(y.onFirstAudioReceived&&y.onFirstAudioReceived(_u.ssrc),y.isFirstAudioReceived[_u.ssrc]=!0),_u.decodingNormal>0&&!y.isFirstAudioDecoded[_u.ssrc]&&(y.onFirstAudioDecoded&&y.onFirstAudioDecoded(_u.ssrc),y.isFirstAudioDecoded[_u.ssrc]=!0),y._stats.audioRecv.push(_u);break;case"audio_send":var ch=Z4(l0e);ch.codec=w.googCodecName,ch.inputLevel=Math.abs(Number(w.audioInputLevel))/32767,ch.aecReturnLoss=Number(w.googEchoCancellationReturnLoss||0),ch.aecReturnLossEnhancement=Number(w.googEchoCancellationReturnLossEnhancement||0),ch.residualEchoLikelihood=Number(w.googResidualEchoLikelihood||0),ch.residualEchoLikelihoodRecentMax=Number(w.googResidualEchoLikelihoodRecentMax||0),ch.bytes=Number(w.bytesSent),ch.packets=Number(w.packetsSent),ch.packetsLost=Number(w.packetsLost),ch.ssrc=Number(w.ssrc),ch.rttMs=Number(w.googRtt||0),y._stats.rtt=ch.rttMs,y._stats.audioSend.push(ch)}})},p.prototype._getStats=function(){var A=this;return new Promise(function(y,w){A.pc.getStats(y,w)})},p.prototype.statsResponsesToObjects=function(A){var y=[];return A.result().forEach(function(w){var $={id:w.id,timestamp:w.timestamp.valueOf().toString(),type:w.type};w.names().forEach(function(j){$[j]=w.stat(j)}),y.push($)}),y},p}($ye);!function(s){s.CERTIFICATE="certificate",s.CODEC="codec",s.CANDIDATE_PAIR="candidate-pair",s.LOCAL_CANDIDATE="local-candidate",s.REMOTE_CANDIDATE="remote-candidate",s.INBOUND="inbound-rtp",s.TRACK="track",s.OUTBOUND="outbound-rtp",s.PC="peer-connection",s.REMOTE_INBOUND="remote-inbound-rtp",s.REMOTE_OUTBOUND="remote-outbound-rtp",s.TRANSPORT="transport",s.CSRC="csrc",s.DATA_CHANNEL="data-channel",s.STREAM="stream",s.SENDER="sender",s.RECEIVER="receiver"}(X4||(X4={}));var N1,h0e=function(s){function p(){var A=null!==s&&s.apply(this,arguments)||this;return A._stats=_de,A.lastDecodeVideoReceiverStats=new Map,A.lastVideoFramesRecv=new Map,A.lastVideoFramesSent=new Map,A.lastVideoFramesDecode=new Map,A.lastVideoJBDelay=new Map,A.lastAudioJBDelay=new Map,A.mediaBytesSent=new Map,A.mediaBytesRetransmit=new Map,A.mediaBytesTargetEncode=new Map,A.lastEncoderMs=new Map,A}return zye(p,s),p.prototype.updateStats=function(){return Yye(this,void 0,void 0,function(){var A,y=this;return Jye(this,function(w){switch(w.label){case 0:return A=this,[4,this.pc.getStats()];case 1:return A.report=w.sent(),this._stats=Z4(_de),this.report.forEach(function($){switch($.type){case X4.OUTBOUND:"audio"===$.mediaType?y.processAudioOutboundStats($):"video"===$.mediaType&&y.processVideoOutboundStats($);break;case X4.INBOUND:"audio"===$.mediaType?y.processAudioInboundStats($):"video"===$.mediaType&&y.processVideoInboundStats($);break;case X4.TRANSPORT:var j=y.report.get($.selectedCandidatePairId);j&&y.processCandidatePairStats(j);break;case X4.CANDIDATE_PAIR:$.selected&&y.processCandidatePairStats($)}}),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}})})},p.prototype.processCandidatePairStats=function(A){if(this._stats.sendBandwidth=A.availableOutgoingBitrate||0,A.currentRoundTripTime&&(this._stats.rtt=1e3*A.currentRoundTripTime),this._stats.videoSend.forEach(function($){!$.rttMs&&A.currentRoundTripTime&&($.rttMs=1e3*A.currentRoundTripTime)}),this._stats.audioSend.forEach(function($){!$.rttMs&&A.currentRoundTripTime&&($.rttMs=1e3*A.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=A.id,A.localCandidateId){var y=this.report.get(A.localCandidateId);y&&this.processCandidateStats(y)}if(A.remoteCandidateId){var w=this.report.get(A.remoteCandidateId);w&&this.processCandidateStats(w)}},p.prototype.processCandidateStats=function(A){var y;A.type===X4.LOCAL_CANDIDATE&&(y=this._stats.selectedCandidatePair.localCandidate),A.type===X4.REMOTE_CANDIDATE&&(y=this._stats.selectedCandidatePair.remoteCandidate),y&&(y.type=A.type,y.id=A.id,A.address&&(y.address=A.address),A.candidateType&&(y.candidateType=A.candidateType),A.port&&(y.port=A.port),A.priority&&(y.priority=A.priority),A.protocol&&(y.protocol=A.protocol),A.relayProtocol&&(y.relayProtocol=A.relayProtocol),A.type===X4.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==y.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(BX({},y),BX({},this.stats.selectedCandidatePair.localCandidate)),A.type===X4.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==y.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(BX({},y),BX({},this.stats.selectedCandidatePair.remoteCandidate)))},p.prototype.processAudioInboundStats=function(A){var y=this._stats.audioRecv.find(function(w){return w.ssrc===A.ssrc});y||(y=Z4(d0e),this._stats.audioRecv.push(y)),y.ssrc=A.ssrc,y.packets=A.packetsReceived,y.packetsLost=A.packetsLost,y.bytes=A.bytesReceived,y.jitterMs=1e3*A.jitter,A.trackId&&this.processAudioTrackReceiverStats(A.trackId,y),A.codecId&&(y.codec=this.getCodecFromCodecStats(A.codecId)),y.receivedFrames||(y.receivedFrames=A.packetsReceived),y.droppedFrames||(y.droppedFrames=A.packetsLost),y.receivedFrames>0&&!this.isFirstAudioReceived[y.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(y.ssrc),this.isFirstAudioReceived[y.ssrc]=!0),y.outputLevel&&y.outputLevel>0&&!this.isFirstAudioDecoded[y.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(y.ssrc),this.isFirstAudioDecoded[y.ssrc]=!0)},p.prototype.processVideoInboundStats=function(A){var y=this._stats.videoRecv.find(function(_u){return _u.ssrc===A.ssrc});y||(y=Z4(c0e),this._stats.videoRecv.push(y)),y.ssrc=A.ssrc,y.packets=A.packetsReceived,y.packetsLost=A.packetsLost,y.bytes=A.bytesReceived,y.firsCount=A.firCount,y.nacksCount=A.nackCount,y.plisCount=A.pliCount,y.framesDecodeCount=A.framesDecoded;var w=this.lastDecodeVideoReceiverStats.get(y.ssrc),$=this.lastVideoFramesDecode.get(y.ssrc),j=Date.now();if(y.framesDecodeCount>0&&!this.isFirstVideoDecoded[y.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(y.ssrc,y.decodedFrame?y.decodedFrame.width:0,y.decodedFrame?y.decodedFrame.height:0),this.isFirstVideoDecoded[y.ssrc]=!0),w){var _i=w.stats,_o=j-w.lts;y.framesDecodeFreezeTime=_i.framesDecodeFreezeTime,y.framesDecodeInterval=_i.framesDecodeInterval,y.framesDecodeCount>_i.framesDecodeCount&&this.isFirstVideoDecoded?(w.lts=Date.now(),y.framesDecodeInterval=_o,y.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(A.ssrc))?y.framesDecodeFreezeTime+=y.framesDecodeInterval:this.setVideoIsReady2(parseInt(A.ssrc,10),!0))):y.framesDecodeCount<_i.framesDecodeCount&&(y.framesDecodeInterval=0),A.framesDecoded&&A.qpSum&&(y.qpSumPerFrame=w.stats.framesDecodeCount>A.framesDecoded?A.qpSum/A.framesDecoded:(A.qpSum-w.qpSum)/(A.framesDecoded-w.stats.framesDecodeCount))}$&&j-$.lts>=800?(y.decodeFrameRate=Math.round((y.framesDecodeCount-$.count)/((j-$.lts)/1e3)),this.lastVideoFramesDecode.set(y.ssrc,{count:y.framesDecodeCount,lts:j,rate:y.decodeFrameRate})):$?y.decodeFrameRate=$.rate:this.lastVideoFramesDecode.set(y.ssrc,{count:y.framesDecodeCount,lts:j,rate:0}),A.totalDecodeTime&&(y.decodeMs=1e3*A.totalDecodeTime),A.trackId&&this.processVideoTrackReceiverStats(A.trackId,y),A.codecId&&(y.codec=this.getCodecFromCodecStats(A.codecId)),A.framerateMean&&(y.framesRateFirefox=A.framerateMean),y.packets>0&&!this.isFirstVideoReceived[y.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(y.ssrc),this.isFirstVideoReceived[y.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(y.ssrc,{stats:BX({},y),lts:w?w.lts:Date.now(),qpSum:A.qpSum})},p.prototype.processVideoOutboundStats=function(A){var y=this._stats.videoSend.find(function(ch){return ch.ssrc===A.ssrc});y||(y=Z4(u0e),this._stats.videoSend.push(y));var w,$=this.mediaBytesSent.get(A.ssrc);if($?$.add(A.bytesSent):((_e=new Kye(10)).add(A.bytesSent),this.mediaBytesSent.set(A.ssrc,_e)),void 0!==A.retransmittedBytesSent){var j=this.mediaBytesRetransmit.get(A.ssrc);j?j.add(A.retransmittedBytesSent):((_e=new Kye(10)).add(A.retransmittedBytesSent),this.mediaBytesRetransmit.set(A.ssrc,_e))}if(A.totalEncodedBytesTarget){var _e,K=this.mediaBytesTargetEncode.get(A.ssrc);K?K.add(A.totalEncodedBytesTarget):((_e=new Kye(10)).add(A.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(A.ssrc,_e))}if(y.ssrc=A.ssrc,y.bytes=A.bytesSent,y.packets=A.packetsSent,y.firsCount=A.firCount,y.nacksCount=A.nackCount,y.plisCount=A.pliCount,y.frameCount=A.framesEncoded,y.adaptionChangeReason=A.qualityLimitationReason,A.totalEncodeTime&&A.framesEncoded&&(y.avgEncodeMs=!(w=this.lastEncoderMs.get(A.ssrc))||w.lastFrameCount>A.framesEncoded?1e3*A.totalEncodeTime/A.framesEncoded:1e3*(A.totalEncodeTime-w.lastEncoderTime)/(A.framesEncoded-w.lastFrameCount)),A.framesEncoded&&A.qpSum&&(y.qpSumPerFrame=!(w=this.lastEncoderMs.get(A.ssrc))||w.lastFrameCount>A.framesEncoded?A.qpSum/A.framesEncoded:(A.qpSum-w.lastQpSum)/(A.framesEncoded-w.lastFrameCount)),this.lastEncoderMs.set(A.ssrc,{lastFrameCount:A.framesEncoded,lastEncoderTime:A.totalEncodeTime,lastQpSum:A.qpSum,lts:Date.now()}),A.codecId&&(y.codec=this.getCodecFromCodecStats(A.codecId)),A.mediaSourceId&&this.processVideoMediaSource(A.mediaSourceId,y),A.trackId&&this.processVideoTrackSenderStats(A.trackId,y),A.remoteId)this.processRemoteInboundStats(A.remoteId,y);else{var _u=this.findRemoteStatsId(A.ssrc,X4.REMOTE_INBOUND);_u&&this.processRemoteInboundStats(_u,y)}},p.prototype.processAudioOutboundStats=function(A){var y=this._stats.audioSend.find(function($){return $.ssrc===A.ssrc});if(y||(y=Z4(l0e),this._stats.audioSend.push(y)),y.ssrc=A.ssrc,y.packets=A.packetsSent,y.bytes=A.bytesSent,A.mediaSourceId&&this.processAudioMediaSource(A.mediaSourceId,y),A.codecId&&(y.codec=this.getCodecFromCodecStats(A.codecId)),A.trackId&&this.processAudioTrackSenderStats(A.trackId,y),A.remoteId)this.processRemoteInboundStats(A.remoteId,y);else{var w=this.findRemoteStatsId(A.ssrc,X4.REMOTE_INBOUND);w&&this.processRemoteInboundStats(w,y)}},p.prototype.findRemoteStatsId=function(A,y){var w=Array.from(this.report.values()).find(function($){return $.type===y&&$.ssrc===A});return w?w.id:null},p.prototype.processVideoMediaSource=function(A,y){var w=this.report.get(A);w&&w.width&&w.height&&w.framesPerSecond&&(y.inputFrame={width:w.width,height:w.height,frameRate:w.framesPerSecond})},p.prototype.processAudioMediaSource=function(A,y){var w=this.report.get(A);w&&(y.inputLevel=w.audioLevel)},p.prototype.processVideoTrackSenderStats=function(A,y){var w=this.report.get(A);if(w){var $=0,j=Date.now(),_e=this.lastVideoFramesSent.get(y.ssrc);_e&&j-_e.lts>=800?($=Math.round((w.framesSent-_e.count)/((j-_e.lts)/1e3)),this.lastVideoFramesSent.set(y.ssrc,{count:w.framesSent,lts:j,rate:$})):_e?$=_e.rate:this.lastVideoFramesSent.set(y.ssrc,{count:w.framesSent,lts:j,rate:0}),y.sentFrame={width:w.frameWidth,height:w.frameHeight,frameRate:$}}},p.prototype.processVideoTrackReceiverStats=function(A,y){var w=this.report.get(A);if(w){var $=this.lastVideoFramesRecv.get(y.ssrc),j=Date.now();y.framesReceivedCount=w.framesReceived;var _e=0;if($&&j-$.lts>=800?(_e=Math.round((w.framesReceived-$.count)/((j-$.lts)/1e3)),this.lastVideoFramesRecv.set(y.ssrc,{count:w.framesReceived,lts:j,rate:_e})):$?_e=$.rate:this.lastVideoFramesRecv.set(y.ssrc,{count:w.framesReceived,lts:j,rate:0}),y.receivedFrame={width:w.frameWidth||0,height:w.frameHeight||0,frameRate:_e||0},y.decodedFrame={width:w.frameWidth||0,height:w.frameHeight||0,frameRate:y.decodeFrameRate||0},y.outputFrame={width:w.frameWidth||0,height:w.frameHeight||0,frameRate:y.decodeFrameRate||0},w.jitterBufferDelay&&w.jitterBufferEmittedCount){var K=this.lastVideoJBDelay.get(y.ssrc);this.lastVideoJBDelay.set(y.ssrc,{jitterBufferDelay:w.jitterBufferDelay,jitterBufferEmittedCount:w.jitterBufferEmittedCount}),K||(K={jitterBufferDelay:0,jitterBufferEmittedCount:0});var _i=1e3*(w.jitterBufferDelay-K.jitterBufferDelay)/(w.jitterBufferEmittedCount-K.jitterBufferEmittedCount);y.jitterBufferMs=_i,y.currentDelayMs=Math.round(_i)}}},p.prototype.processAudioTrackSenderStats=function(A,y){var w=this.report.get(A);w&&(y.aecReturnLoss=w.echoReturnLoss||0,y.aecReturnLossEnhancement=w.echoReturnLossEnhancement||0)},p.prototype.processAudioTrackReceiverStats=function(A,y){var w=this.report.get(A);if(w){if(w.removedSamplesForAcceleration&&w.totalSamplesReceived&&(y.accelerateRate=w.removedSamplesForAcceleration/w.totalSamplesReceived),w.jitterBufferDelay&&w.jitterBufferEmittedCount){var $=this.lastAudioJBDelay.get(y.ssrc);this.lastAudioJBDelay.set(y.ssrc,{jitterBufferDelay:w.jitterBufferDelay,jitterBufferEmittedCount:w.jitterBufferEmittedCount}),$||($={jitterBufferDelay:0,jitterBufferEmittedCount:0}),y.jitterBufferMs=Math.round(1e3*(w.jitterBufferDelay-$.jitterBufferDelay)/(w.jitterBufferEmittedCount-$.jitterBufferEmittedCount))}y.outputLevel=w.audioLevel;var _e=1920;w.totalSamplesDuration&&w.totalSamplesReceived&&(_e=w.totalSamplesReceived/w.totalSamplesDuration/50,y.receivedFrames=Math.round(w.totalSamplesReceived/_e)),w.concealedSamples&&(y.droppedFrames=Math.round(w.concealedSamples/_e))}},p.prototype.processRemoteInboundStats=function(A,y){var w=this.report.get(A);w&&(y.packetsLost=w.packetsLost,w.roundTripTime&&(y.rttMs=1e3*w.roundTripTime))},p.prototype.getCodecFromCodecStats=function(A){var y=this.report.get(A);if(!y)return"";var w=y.mimeType.match(/\/(.*)$/);return w&&w[1]?w[1]:""},p.prototype.updateSendBitrate=function(){var A=0,y=null,w=null;this.mediaBytesSent.forEach(function(j){A+=j.diffMean()}),this.mediaBytesRetransmit.forEach(function(j){y=null===y?j.diffMean():y+j.diffMean()}),this.mediaBytesTargetEncode.forEach(function(j){w=null===w?j.diffMean():w+j.diffMean()}),this._stats.bitrate={actualEncoded:8*(null!==y?A-y:A)/(this.options.updateInterval/1e3),transmit:8*A/(this.options.updateInterval/1e3)},null!==y&&(this._stats.bitrate.retransmit=8*y/(this.options.updateInterval/1e3)),null!==w&&(this._stats.bitrate.targetEncoded=8*w/(this.options.updateInterval/1e3))},p}($ye),lbe=function(s){function p(){return null!==s&&s.apply(this,arguments)||this}return zye(p,s),p.prototype.updateStats=function(){return Promise.resolve()},p}($ye);function f0e(s,p,A,y){void 0===p&&(p=250),void 0===A&&(A=8),void 0===y&&(y=500);var w,$=(w=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i))&&w[0]?Number(w[0].split("/")[1]):null;return $?$<76?new ube(s,{updateInterval:p,lossRateInterval:A,freezeRateLimit:y}):new h0e(s,{updateInterval:p,lossRateInterval:A,freezeRateLimit:y}):window.RTCStatsReport&&s.getStats()instanceof Promise?new h0e(s,{updateInterval:p,lossRateInterval:A,freezeRateLimit:y}):new lbe(s,{updateInterval:p,lossRateInterval:A,freezeRateLimit:y})}function p0e(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function g0e(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?p0e(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):p0e(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}let dbe=(gI((N1=class $me extends yK{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}constructor(p,A){super(p,A),a_(this,"store",void 0),a_(this,"peerConnection",void 0),a_(this,"remoteSDP",void 0),a_(this,"initialOffer",void 0),a_(this,"statsFilter",void 0),a_(this,"useRTX",!1),a_(this,"localCapabilities",void 0),a_(this,"localCandidateCount",0),a_(this,"allCandidatesReceived",!1),a_(this,"mutex",new iP("P2PConnection-mutex")),this.store=A,this.peerConnection=new RTCPeerConnection($me.resolvePCConfiguration(p),{optional:[{googDscp:!0}]}),this.statsFilter=f0e(this.peerConnection,void 0,void 0,X2()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}establish(){var p=this;return f(function*(){try{const A=yield p.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!A.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const y=jme(A.sdp),w=Wye(A.sdp,!p.useRTX,!1,["opus"]);return p.localCapabilities=w,p.initialOffer=A,g0e(g0e({},y),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:w},offerSDP:A.sdp})}catch(A){throw new U_(N_.GET_LOCAL_CONNECTION_PARAMS_FAILED,A.toString())}})()}connect(p,A,y,w,$,j){var _e=this;return f(function*(){try{if(!_e.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");_e.remoteSDP=new cbe({remoteIceParameters:p,remoteDtlsParameters:A,candidates:y,remoteRTPCapabilities:w.send,remoteSetup:$,localCapabilities:_e.localCapabilities,sdkCodec:_e.store.codec,cname:j});const K=_e.remoteSDP.toString();yield _e.peerConnection.setLocalDescription(_e.initialOffer),yield _e.peerConnection.setRemoteDescription({type:"answer",sdp:K})}catch(K){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(K.toString()))}})()}send(p,A){var y=this;return Ade(function*(){const w=yield GS(y.mutex.lock());try{if(!y.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const $=p.map(ch=>y.peerConnection.addTrack(ch._mediaStreamTrack)),j=yield GS(y.peerConnection.createOffer()),_e=h3.exports.parse(j.sdp),K=p.map(ch=>{const _f=ch._mediaStreamTrack,o_=_e.mediaDescriptions.find(i_=>i_.attributes.mid===_f.kind);if(!o_)throw new Error("Cannot extract ssrc from mediaDescription.");return function(i_,u_,g_){const __=i_.attributes.ssrcs.filter(k_=>k_.attributes.label===u_),w_=i_.attributes.ssrcGroups;if(0===__.length)throw new Error("Cannot extract ssrc from plan-b SDP.");if(w_&&__.length>1){const k_=w_.find(Rv=>-1!==Rv.ssrcIds.indexOf(__[0].ssrcId));return k_?[{ssrcId:k_.ssrcIds[0],rtx:g_?k_.ssrcIds[1]:void 0}]:[{ssrcId:__[0].ssrcId}]}return[{ssrcId:__[0].ssrcId}]}(o_,_f.id,y.useRTX)});let _i;try{_i=yield K}catch(ch){throw $.forEach(_f=>{Z2()&&_f.replaceTrack(null),y.peerConnection.removeTrack(_f)}),ch}const _o=y.mungSendOfferSDP(j.sdp,p);y.remoteSDP.receive(p,A,_i);const _u=y.remoteSDP.toString();return yield GS(y.peerConnection.setLocalDescription({type:"offer",sdp:_o})),yield GS(y.applySendEncodings($,p)),yield GS(y.peerConnection.setRemoteDescription({type:"answer",sdp:_u})),p.map((ch,_f)=>({localSSRC:K[_f],id:ch._mediaStreamTrack.id}))}catch($){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat($.toString()))}finally{w()}})()}stopSending(p){var A=this;return f(function*(){try{if(!A.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const y=A.peerConnection.getSenders().filter(j=>{var _e;return-1!==p.indexOf((null===(_e=j.track)||void 0===_e?void 0:_e.id)||"")});if(y.length!==p.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");y.map(j=>{Z2()&&j.replaceTrack(null),A.peerConnection.removeTrack(j)});const w=yield A.peerConnection.createOffer();yield A.peerConnection.setLocalDescription(w),A.remoteSDP.stopReceiving(p);const $=A.remoteSDP.toString();yield A.peerConnection.setRemoteDescription({type:"answer",sdp:$})}catch(y){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(y.toString()))}})()}receive(p,A,y,w){var $=this;return f(function*(){try{if(!$.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(p," before remoteSDP created."));const{id:j,mslabel:_e}=$.remoteSDP.send(p,A,w),K=new iI((_u,ch)=>{const _f=setTimeout(()=>{ch(new Error("Cannot receive track, id: ".concat(j)))},1e4),o_=i_=>{const u_=Y1();if(("Safari"===u_.name&&11===Number(u_.version)||r2())&&i_.track.id!==j&&i_.streams[0].id===_e){var g_;const __=i_.streams[0].getTracks()[0];return null===(g_=$.remoteSDP)||void 0===g_||g_.updateTrackLabel(p,j,i_.track.id),$.peerConnection.removeEventListener("track",o_),clearTimeout(_f),void _u(__)}if(i_.track.id===j)return $.peerConnection.removeEventListener("track",o_),clearTimeout(_f),void _u(i_.track)};$.peerConnection.addEventListener("track",o_)}),_i=$.remoteSDP.toString();yield $.peerConnection.setRemoteDescription({type:"offer",sdp:_i});const _o=yield $.peerConnection.createAnswer();return yield $.peerConnection.setLocalDescription(_o),{track:yield K,id:j}}catch(j){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(j.toString()))}})()}stopReceiving(p){var A=this;return f(function*(){try{if(!A.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");A.remoteSDP.stopSending(p);const y=A.remoteSDP.toString();yield A.peerConnection.setRemoteDescription({type:"offer",sdp:y});const w=yield A.peerConnection.createAnswer();yield A.peerConnection.setLocalDescription(w)}catch(y){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(y.toString()))}})()}muteRemote(p){return f(function*(){})()}unmuteRemote(p){return f(function*(){})()}muteLocal(p){var A=this;return f(function*(){try{if(!A.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const y=A.peerConnection.getSenders().filter(w=>{var $;return-1!==p.indexOf((null===($=w.track)||void 0===$?void 0:$.id)||"")});if(y.length!==p.length)throw new Error("sender' length doesn't match mids' length.");y.map(w=>{if(Z2()&&w.track)w.track.enabled=!1;else{const $=w.getParameters();$.encodings.forEach(j=>j.active=!1),w.setParameters($)}})}catch(y){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(y.toString()))}})()}unmuteLocal(p){var A=this;return f(function*(){try{if(!A.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const y=A.peerConnection.getSenders().filter(j=>{var _e;return-1!==p.indexOf((null===(_e=j.track)||void 0===_e?void 0:_e.id)||"")});if(y.length!==p.length)throw new Error("Senders' length doesn't match mids' length.");y.map(function(){var j=f(function*(_e){if(Z2()&&_e.track)_e.track.enabled=!0;else{const K=_e.getParameters();K.encodings.forEach(_i=>_i.active=!0),yield _e.setParameters(K)}});return function(_e){return j.apply(this,arguments)}}());const w=yield A.peerConnection.createOffer();yield A.peerConnection.setLocalDescription(w);const $=A.remoteSDP.toString();yield A.peerConnection.setRemoteDescription({type:"answer",sdp:$})}catch(y){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(y.toString()))}})()}reEstablish(){var p=this;return f(function*(){const A=yield p.peerConnection.createOffer({iceRestart:!0});if(!A.sdp)throw new Error("Cannot get SDP from restart offer.");return{iceParameters:jme(A.sdp).iceParameters,restartICE:(y=f(function*(w,$){return p.restartICE(A,w,$)}),function($,j){return y.apply(this,arguments)}),restartOfferSDP:A.sdp};var y})()}close(){var p;this.peerConnection.close(),null===(p=this.onConnectionStateChange)||void 0===p||p.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(p){return this.statsFilter.getVideoIsReady(p)}updateEncoderConfig(p,A){var y=this;return f(function*(){try{if(!y.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const w=yield y.peerConnection.createOffer(),$=y.mungSendOfferSDP(w.sdp,[A]);y.remoteSDP.updateRecvMedia(A._mediaStreamTrack.kind,A);const j=y.remoteSDP.toString();yield y.peerConnection.setLocalDescription({type:"offer",sdp:$}),yield y.peerConnection.setRemoteDescription({type:"answer",sdp:j})}catch(w){throw new U_(N_.EXCHANGE_SDP_FAILED,w.toString())}})()}updateSendParameters(p,A){var y=this;return f(function*(){const w=y.peerConnection.getSenders().filter($=>{var j;return(null===(j=$.track)||void 0===j?void 0:j.id)===p});1===w.length&&(yield y.applySendEncodings(w,[A]))})()}setStatsRemoteVideoIsReady(p,A){this.statsFilter.setVideoIsReady2(p,A)}replaceTrack(p,A){var y=this;return f(function*(){const w=y.peerConnection.getSenders().find($=>{var j;return(null===(j=$.track)||void 0===j?void 0:j.id)===A});w&&(yield w.replaceTrack(p._mediaStreamTrack))})()}restartICE(p,A,y){var w=this;return f(function*(){try{if(!w.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");w.remoteSDP.restartICE(A,y);const $=w.remoteSDP.toString();yield w.peerConnection.setLocalDescription(p),yield w.peerConnection.setRemoteDescription({type:"answer",sdp:$})}catch($){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.restartICE failed; ".concat($.toString()))}})()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var p;null===(p=this.onICEConnectionStateChange)||void 0===p||p.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var p;null===(p=this.onConnectionStateChange)||void 0===p||p.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=p=>{p.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,h_.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,h_.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},v0("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(p){const A={iceServers:[],sdpSemantics:"plan-b"};return p.iceServers?A.iceServers=p.iceServers:p.turnServer&&"off"!==p.turnServer.mode&&(vN(p.turnServer.servers)?A.iceServers=p.turnServer.servers:(A.iceServers&&A.iceServers.push(...$me.turnServerConfigToIceServers(p.turnServer.servers)),v0("USE_TURN_SERVER_OF_GATEWAY")&&A.iceServers&&p.turnServer.serversFromGateway&&A.iceServers.push(...$me.turnServerConfigToIceServers(p.turnServer.serversFromGateway)),p.turnServer.servers.concat(p.turnServer.serversFromGateway||[]).forEach(y=>{y.forceturn&&(A.iceTransportPolicy="relay")}))),A}static turnServerConfigToIceServers(p){const A=[];return p.forEach(y=>{y.security?y.tcpport&&A.push({username:y.username,credential:y.password,credentialType:"password",urls:"turns:".concat(y.turnServerURL,":").concat(y.tcpport,"?transport=tcp")}):(y.udpport&&A.push({username:y.username,credential:y.password,credentialType:"password",urls:"turn:".concat(y.turnServerURL,":").concat(y.udpport,"?transport=udp")}),y.tcpport&&A.push({username:y.username,credential:y.password,credentialType:"password",urls:"turn:".concat(y.turnServerURL,":").concat(y.tcpport,"?transport=tcp")}))}),A}applySendEncodings(p,A){return f(function*(){try{if(!bN().supportSetRtpSenderParameters||p.length!==A.length)return;for(let w=0;w<p.length;w++){var y;const $=p[w],j=A[w];if(!j)continue;const _e={},K={};if(j instanceof yS)switch(j._optimizationMode){case"motion":_e.degradationPreference="maintain-framerate";break;case"detail":_e.degradationPreference="maintain-resolution";break;default:_e.degradationPreference="balanced"}if(v0("DSCP_TYPE")&&bQ()){const _u=v0("DSCP_TYPE");["very-low","low","medium","high"].includes(_u)&&(K.networkPriority=_u)}const _i=$.getParameters(),_o=null===(y=_i.encodings)||void 0===y?void 0:y[0];_o&&Object.assign(_o,K),Object.assign(_i,_e),yield $.setParameters(_i)}}catch(w){h_.debug("Apply RTPSendEncodings failed.")}})()}mungSendOfferSDP(p,A){const y=h3.exports.parse(p);return A.forEach((w,$)=>{const j=w._mediaStreamTrack,_e=y.mediaDescriptions.find(K=>K.attributes.mid===j.kind);_e&&Vme(_e,w)}),h3.exports.print(y)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=p=>{var A;null===(A=this.onFirstAudioReceived)||void 0===A||A.call(this,p)},this.statsFilter.onFirstVideoReceived=p=>{var A;null===(A=this.onFirstVideoReceived)||void 0===A||A.call(this,p)},this.statsFilter.onFirstAudioDecoded=p=>{var A;null===(A=this.onFirstAudioDecoded)||void 0===A||A.call(this,p)},this.statsFilter.onFirstVideoDecoded=(p,A,y)=>{var w;null===(w=this.onFirstVideoDecoded)||void 0===w||w.call(this,p,A,y)},this.statsFilter.onSelectedLocalCandidateChanged=(p,A)=>{var y;null===(y=this.onSelectedLocalCandidateChanged)||void 0===y||y.call(this,p,A)},this.statsFilter.onSelectedRemoteCandidateChanged=(p,A)=>{var y;null===(y=this.onSelectedRemoteCandidateChanged)||void 0===y||y.call(this,p,A)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}batchReceive(p){var A=this;return f(function*(){try{if(!A.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const y=A.remoteSDP.batchSend(p).map((j,_e)=>{let{id:K,mslabel:_i}=j;const{kind:_o}=p[_e];return new iI((_u,ch)=>{const _f=setTimeout(()=>{ch(new Error("Cannot receive track, id: ".concat(K)))},1e4),o_=i_=>{const u_=Y1();if("Safari"===u_.name&&11===Number(u_.version)&&i_.track.id!==K&&i_.streams[0].id===_i){var g_;const __=i_.streams[0].getTracks()[0];return null===(g_=A.remoteSDP)||void 0===g_||g_.updateTrackLabel(_o,K,i_.track.id),A.peerConnection.removeEventListener("track",o_),clearTimeout(_f),void _u({track:__,id:K})}if(i_.track.id===K)return A.peerConnection.removeEventListener("track",o_),clearTimeout(_f),void _u({track:i_.track,id:K})};A.peerConnection.addEventListener("track",o_)})}),w=A.remoteSDP.toString();yield A.peerConnection.setRemoteDescription({type:"offer",sdp:w});const $=yield A.peerConnection.createAnswer();return yield A.peerConnection.setLocalDescription($),yield iI.all(y)}catch(y){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(y.toString()))}})()}}).prototype,"connect",[WM],Object.getOwnPropertyDescriptor(N1.prototype,"connect"),N1.prototype),gI(N1.prototype,"stopSending",[WM],Object.getOwnPropertyDescriptor(N1.prototype,"stopSending"),N1.prototype),gI(N1.prototype,"receive",[WM],Object.getOwnPropertyDescriptor(N1.prototype,"receive"),N1.prototype),gI(N1.prototype,"stopReceiving",[WM],Object.getOwnPropertyDescriptor(N1.prototype,"stopReceiving"),N1.prototype),gI(N1.prototype,"muteRemote",[WM],Object.getOwnPropertyDescriptor(N1.prototype,"muteRemote"),N1.prototype),gI(N1.prototype,"unmuteRemote",[WM],Object.getOwnPropertyDescriptor(N1.prototype,"unmuteRemote"),N1.prototype),gI(N1.prototype,"muteLocal",[WM],Object.getOwnPropertyDescriptor(N1.prototype,"muteLocal"),N1.prototype),gI(N1.prototype,"unmuteLocal",[WM],Object.getOwnPropertyDescriptor(N1.prototype,"unmuteLocal"),N1.prototype),gI(N1.prototype,"reEstablish",[WM],Object.getOwnPropertyDescriptor(N1.prototype,"reEstablish"),N1.prototype),gI(N1.prototype,"close",[WM],Object.getOwnPropertyDescriptor(N1.prototype,"close"),N1.prototype),gI(N1.prototype,"updateEncoderConfig",[WM],Object.getOwnPropertyDescriptor(N1.prototype,"updateEncoderConfig"),N1.prototype),gI(N1.prototype,"updateSendParameters",[WM],Object.getOwnPropertyDescriptor(N1.prototype,"updateSendParameters"),N1.prototype),gI(N1.prototype,"replaceTrack",[WM],Object.getOwnPropertyDescriptor(N1.prototype,"replaceTrack"),N1.prototype),gI(N1.prototype,"restartICE",[WM],Object.getOwnPropertyDescriptor(N1.prototype,"restartICE"),N1.prototype),N1);function WM(s,p,A){const y=s[p];if("function"!=typeof y)throw new Error("Cannot use mutex on object property.");return A.value=f(function*(){const w=this.mutex,$=yield w.lock("Locking from P2PConnection.".concat(p));try{for(var j=arguments.length,_e=new Array(j),K=0;K<j;K++)_e[K]=arguments[K];return yield y.apply(this,_e)}finally{$()}}),A}var m0e;let hbe=TR("RemoteSDP")(m0e=class{get localCapabilities(){return jS(this._localCapabilities)}get rtpCapabilities(){return jS(this._rtpCapabilities)}get candidates(){return jS(this._candidates)}get iceParameters(){return jS(this._iceParameters)}get dtlsParameters(){return jS(this._dtlsParameters)}constructor(s){a_(this,"sessionDesc",void 0),a_(this,"_localCapabilities",void 0),a_(this,"_rtpCapabilities",void 0),a_(this,"_candidates",void 0),a_(this,"_iceParameters",void 0),a_(this,"_dtlsParameters",void 0),a_(this,"setup",void 0),a_(this,"currentMidIndex",void 0),a_(this,"cname",void 0),s=jS(s);const{remoteIceParameters:p,remoteDtlsParameters:A,candidates:y,remoteRTPCapabilities:w,remoteSetup:$,localCapabilities:j,cname:_e}=s,K=h3.exports.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=ice-lite\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n");this._rtpCapabilities=w,this._candidates=y,this._iceParameters=p,this._dtlsParameters=A,this._localCapabilities=j,this.setup=$,this.cname=_e;const _i=this.rtpCapabilities.send;for(const _o of K.mediaDescriptions){if(_o.attributes.iceUfrag=p.iceUfrag,_o.attributes.icePwd=p.icePwd,_o.attributes.fingerprints=A.fingerprints,_o.attributes.candidates=y,_o.attributes.setup=$,"video"===_o.media.mediaType&&(_o.media.fmts=_i.videoCodecs.map(_u=>_u.payloadType.toString(10)),_o.attributes.payloads=_i.videoCodecs,_o.attributes.extmaps=_i.videoExtensions,v0("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_u,ssrcGroups:ch}=soe([{ssrcId:4e4,rtx:v0("USE_RTX")?40001:void 0}],this.cname);_o.attributes.ssrcs=_u,_o.attributes.ssrcGroups=ch}if("audio"===_o.media.mediaType&&(_o.media.fmts=_i.audioCodecs.map(_u=>_u.payloadType.toString(10)),_o.attributes.payloads=_i.audioCodecs,_o.attributes.extmaps=_i.audioExtensions,v0("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_u,ssrcGroups:ch}=soe([{ssrcId:2e4}],this.cname);_o.attributes.ssrcs=_u,_o.attributes.ssrcGroups=ch}}this.sessionDesc=K,this.currentMidIndex=K.mediaDescriptions.length-1}preloadRemoteMedia(){const s=v0("PRELOAD_MEDIA_COUNT");S0("debug",this,"preloadRemoteMedia",s);const p=this.candidates,A=this.dtlsParameters,y=this.iceParameters,w=this.rtpCapabilities.send;for(let $=1;$<s;$++){const j=2*$+2e4,_e=2*$+4e4,{ssrcs:K,ssrcGroups:_i}=soe([{ssrcId:j}],this.cname),{ssrcs:_o,ssrcGroups:_u}=soe([{ssrcId:_e,rtx:v0("USE_RTX")?_e+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:w.videoCodecs.map(ch=>ch.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:y.iceUfrag,icePwd:y.icePwd,unrecognized:[],candidates:p,extmaps:w.videoExtensions,fingerprints:A.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:_o,ssrcGroups:_u,rtcpFeedbackWildcards:[],payloads:w.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*$)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:w.audioCodecs.map(ch=>ch.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:y.iceUfrag,icePwd:y.icePwd,unrecognized:[],candidates:p,extmaps:w.audioExtensions,fingerprints:A.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:K,ssrcGroups:_i,rtcpFeedbackWildcards:[],payloads:w.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*$+1)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return h3.exports.print(this.sessionDesc)}send(s,p,A,y){const{ssrcs:w,ssrcGroups:$}=soe(p,this.cname,A),j=this.findPreloadMediaDesc(w);if(j){if(y&&(y.tcc||y.remb)){const _e=this.sessionDesc.mediaDescriptions.indexOf(j);return this.sessionDesc.mediaDescriptions[_e]=this.mungSendMediaDesc(j,y),{mid:j.attributes.mid,needExchangeSDP:!0}}return{mid:j.attributes.mid,needExchangeSDP:!1}}{const _e=this.findAvailableMediaIndex(s);if(Z2()||Fae()){if(-1!==_e&&1!==_e){const K=jS(this.sessionDesc.mediaDescriptions[_e]);return K.attributes.direction="sendonly",K.attributes.ssrcs=w,K.attributes.ssrcGroups=$,this.sessionDesc.mediaDescriptions[_e]=this.mungSendMediaDesc(K,y),{mid:K.attributes.mid,needExchangeSDP:!0}}{const K=this.createOrRecycleSendMedia(s,w,$,"sendonly",y);return this.updateBundleMids(),{mid:K.attributes.mid,needExchangeSDP:!0}}}if(-1!==_e){const K=jS(this.sessionDesc.mediaDescriptions[_e]);return K.attributes.direction="sendonly",K.attributes.ssrcs=w,K.attributes.ssrcGroups=$,this.sessionDesc.mediaDescriptions[_e]=this.mungSendMediaDesc(K,y),{mid:K.attributes.mid,needExchangeSDP:!0}}{const K=this.createOrRecycleSendMedia(s,w,$,"sendonly",y);return this.updateBundleMids(),{mid:K.attributes.mid,needExchangeSDP:!0}}}}batchSend(s){const p=s.map(w=>{let{kind:$,ssrcMsg:j,mslabel:_e}=w;return this.send($,j,_e)}),A=[];let y=!1;return p.forEach(w=>{let{mid:$,needExchangeSDP:j}=w;j&&(y=!0),A.push($)}),{mids:A,needExchangeSDP:y}}stopSending(s){const p=this.sessionDesc.mediaDescriptions.filter(A=>A.attributes.mid&&-1!==s.indexOf(A.attributes.mid));if(p.length!==s.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");p.forEach(A=>{"0"===A.attributes.mid||X2()||Z2()||Fae()?A.attributes.ssrcs=[]:(A.attributes.ssrcs=[],A.attributes.direction="inactive",A.media.port="0")}),this.updateBundleMids()}mute(s){const p=this.sessionDesc.mediaDescriptions.find(A=>A.attributes.mid===s);if(!p)throw new Error("mediaDescription not found with ".concat(s," in remote SDP when calling RemoteSDP.mute."));p.attributes.direction="inactive"}unmute(s){const p=this.sessionDesc.mediaDescriptions.find(A=>A.attributes.mid===s);if(!p)throw new Error("mediaDescription not found with ".concat(s," in remote SDP when calling RemoteSDP.unmute."));p.attributes.direction="sendonly"}muteRemote(s){const p=this.sessionDesc.mediaDescriptions.filter(A=>s.includes(A.attributes.mid||""));if(p.length!==s.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");p.forEach(A=>{A.attributes.direction="inactive"})}unmuteRemote(s){const p=this.sessionDesc.mediaDescriptions.filter(A=>s.includes(A.attributes.mid||""));if(p.length!==s.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");p.forEach(A=>{A.attributes.direction="recvonly"})}receive(s,p,A,y){s.forEach((w,$)=>{this.createOrRecycleRecvMedia(w,[],"recvonly",p,A,y[$])}),this.updateBundleMids()}stopReceiving(s){const p=this.sessionDesc.mediaDescriptions.filter(A=>-1!==s.indexOf(A.attributes.mid));if(p.length!==s.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");p.forEach(A=>{A.media.port="0",A.attributes.direction="inactive"}),this.updateBundleMids()}restartICE(s,p){s=jS(s),p=jS(p),this._iceParameters=s,this._candidates=p,this.sessionDesc.mediaDescriptions.forEach(A=>{A.attributes.iceUfrag=s.iceUfrag,A.attributes.icePwd=s.icePwd,A.attributes.candidates=this.candidates})}predictReceivingMids(s){const p=[];for(let A=0;A<s;A++)p.push((this.currentMidIndex+A+1).toString(10));return p}findAvailableMediaIndex(s){return this.sessionDesc.mediaDescriptions.findIndex(p=>p.media.mediaType===s&&"0"!==p.media.port&&("sendonly"===p.attributes.direction||"sendrecv"===p.attributes.direction)&&0===p.attributes.ssrcs.length)}createOrRecycleRecvMedia(s,p,A,y,w,$){const j=s._mediaStreamTrack.kind,_e=this.rtpCapabilities.recv,K=this.localCapabilities.send;let _i=[];if(j===o1.VIDEO){var _o,_u;if(v0("H264_PROFILE_LEVEL_ID")&&"h264"===y&&(_i=_e.videoCodecs.filter(u_=>{var g_,__;return((null===(g_=u_.rtpMap)||void 0===g_?void 0:g_.encodingName.toLowerCase())||"").includes(y)&&(null==u_||null===(__=u_.fmtp)||void 0===__?void 0:__.parameters["profile-level-id"])===v0("H264_PROFILE_LEVEL_ID")})),!_i||0===(null===(_o=_i)||void 0===_o?void 0:_o.length)){const u_=K.videoCodecs.filter(g_=>{var __;return((null===(__=g_.rtpMap)||void 0===__?void 0:__.encodingName.toLowerCase())||"").includes(y)});0!==u_.length&&(_i=_e.videoCodecs.filter(g_=>u_.some(__=>__.payloadType===g_.payloadType)))}if(v0("USE_RTX")){const u_=_i.map(__=>__.payloadType.toString()),g_=_e.videoCodecs.filter(__=>{var w_,k_;return"rtx"===(null===(w_=__.rtpMap)||void 0===w_?void 0:w_.encodingName)&&u_.includes((null===(k_=__.fmtp)||void 0===k_?void 0:k_.parameters.apt)||"")});_i=[..._i,...g_]}0===_i.length&&(h_.warning("codec ".concat(y," not included in rtpCapabilities, fallback to default payloads: ").concat(null===(_u=_e.videoCodecs[0].rtpMap)||void 0===_u?void 0:_u.encodingName)),_i=_e.videoCodecs)}else _i=_e.audioCodecs.filter(u_=>{var g_;return((null===(g_=u_.rtpMap)||void 0===g_?void 0:g_.encodingName.toLowerCase())||"").includes(w)}),0===_i.length&&(h_.warning("codec ".concat(w," not included in rtpCapabilities, fallback to opus")),_i=_e.audioCodecs.filter(u_=>{var g_;return((null===(g_=u_.rtpMap)||void 0===g_?void 0:g_.encodingName.toLowerCase())||"").includes("opus")}));const ch=j===o1.VIDEO?_e.videoExtensions:_e.audioExtensions;this.currentMidIndex+=1;const _f="".concat(this.currentMidIndex);let o_={media:{mediaType:j,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:_i.map(u_=>u_.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:ch,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:p,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:_i,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:A,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(_f)}};o_=this.mungRecvMediaDsec(o_,s,$);const i_=this.findFirstClosedMedia(j);if(i_){const u_=this.sessionDesc.mediaDescriptions.indexOf(i_);this.sessionDesc.mediaDescriptions[u_]=o_}else this.sessionDesc.mediaDescriptions.push(o_);return o_}createOrRecycleSendMedia(s,p,A,y,w){const $=this.rtpCapabilities.send,j=s===o1.VIDEO?$.videoCodecs:$.audioCodecs,_e=s===o1.VIDEO?$.videoExtensions:$.audioExtensions;this.currentMidIndex+=1;const K="".concat(this.currentMidIndex);let _i={media:{mediaType:s,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:j.map(_u=>_u.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:_e,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:p,ssrcGroups:A,rtcpFeedbackWildcards:[],payloads:j,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:y,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(K)}};_i=this.mungSendMediaDesc(_i,w);const _o=this.findFirstClosedMedia(s);if(_o){const _u=this.sessionDesc.mediaDescriptions.indexOf(_o);this.sessionDesc.mediaDescriptions[_u]=_i}else this.sessionDesc.mediaDescriptions.push(_i);return _i}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(s=>"0"!==s.media.port).map(s=>s.attributes.mid)}mungRecvMediaDsec(s,p,A){const y=jS(s);return t0e(y),Vme(y,p),n0e(y,p),function(w){if("video"!==w.media.mediaType)return;const $=Y1();if($.name!==C1.SAFARI&&$.os!==wR.IOS)return;const j=w.attributes.extmaps.findIndex(_e=>/video-orientation/g.test(_e.extensionName));-1!==j&&w.attributes.extmaps.splice(j,1)}(y),r0e(y,A,this.localCapabilities.send),y}mungSendMediaDesc(s,p){const A=jS(s);return r0e(A,p,this.localCapabilities.recv),A}updateRecvMedia(s,p){const A=this.sessionDesc.mediaDescriptions.findIndex(y=>y.attributes.mid===s);if(-1!==A){const y=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[A],p);this.sessionDesc.mediaDescriptions[A]=y}}bumpMid(s){this.currentMidIndex+=s}findFirstClosedMedia(s){return this.sessionDesc.mediaDescriptions.find(p=>X2()?"0"===p.media.port&&p.media.mediaType===s:"0"===p.media.port)}findPreloadMediaDesc(s){return this.sessionDesc.mediaDescriptions.find(p=>{var A,y;return(null===(A=p.attributes)||void 0===A||null===(y=A.ssrcs[0])||void 0===y?void 0:y.ssrcId)===s[0].ssrcId})}})||m0e;var _0e,k1;function v0e(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function y0e(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?v0e(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):v0e(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}let fbe=TR("P2PConnection","store.p2pId")((gI((k1=class Zme extends yK{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}constructor(p,A){super(p,A),a_(this,"store",void 0),a_(this,"peerConnection",void 0),a_(this,"remoteSDP",void 0),a_(this,"initialOffer",void 0),a_(this,"transportEventReceiver",void 0),a_(this,"statsFilter",void 0),a_(this,"useRTX",v0("USE_RTX")),a_(this,"localCapabilities",void 0),a_(this,"localCandidateCount",0),a_(this,"allCandidatesReceived",!1),a_(this,"mutex",new iP("P2PConnection-mutex")),this.store=A,this.peerConnection=new RTCPeerConnection(Zme.resolvePCConfiguration(p),{optional:[{googDscp:!0}]}),this.statsFilter=f0e(this.peerConnection,void 0,void 0,X2()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}establish(){var p=this;return f(function*(){try{p.peerConnection.addTransceiver("video",{direction:"recvonly"}),p.peerConnection.addTransceiver("audio",{direction:"recvonly"});const A=yield p.peerConnection.createOffer();if(!A.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const y=jme(A.sdp),w=yield($=f(function*(j,_e,K,_i){const _o=new RTCPeerConnection;_o.addTransceiver("video",{direction:"sendonly"}),_o.addTransceiver("audio",{direction:"sendonly"}),_o.addTransceiver("video",{direction:"recvonly"}),_o.addTransceiver("audio",{direction:"recvonly"});const _u=(yield _o.createOffer()).sdp,ch=Wye(_u,j,_e,K,_i,"sendonly"),_f=Wye(_u,j,_e,K,_i,"recvonly"),o_={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},i_={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},u_={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(Gme(ch,_f,"videoExtensions",o_,i_,u_),Gme(ch,_f,"videoCodecs",o_,i_,u_),Gme(ch,_f,"audioExtensions",o_,i_,u_),Gme(ch,_f,"audioCodecs",o_,i_,u_),v0("RAISE_H264_BASELINE_PRIORITY")){const g_=u_.videoCodecs.findIndex(__=>{var w_,k_;return"h264"===(null===(w_=__.rtpMap)||void 0===w_?void 0:w_.encodingName.toLocaleLowerCase())&&"42001f"===(null===(k_=__.fmtp)||void 0===k_?void 0:k_.parameters["profile-level-id"])});if(-1!==g_){const __=u_.videoCodecs.findIndex(w_=>{var k_;return"h264"===(null===(k_=w_.rtpMap)||void 0===k_?void 0:k_.encodingName.toLocaleLowerCase())});if(__<g_){h_.debug("raising H264 baseline profile priority");const w_=u_.videoCodecs[g_];u_.videoCodecs.splice(g_,1),u_.videoCodecs.splice(__,0,w_)}-1!==__&&(i_.videoCodecs=i_.videoCodecs.filter(w_=>{var k_,Rv;return!("h264"===(null===(k_=w_.rtpMap)||void 0===k_?void 0:k_.encodingName.toLocaleLowerCase())&&"42001f"!==(null===(Rv=w_.fmtp)||void 0===Rv?void 0:Rv.parameters["profile-level-id"]))})),-1!==__&&v0("FILTER_SEND_H264_BASELINE")&&(o_.videoCodecs=o_.videoCodecs.filter(w_=>{var k_,Rv;return!("h264"===(null===(k_=w_.rtpMap)||void 0===k_?void 0:k_.encodingName.toLocaleLowerCase())&&"42001f"!==(null===(Rv=w_.fmtp)||void 0===Rv?void 0:Rv.parameters["profile-level-id"]))}))}}try{_o.close()}catch(g_){}return{send:o_,recv:i_,sendrecv:u_}}),function(j,_e,K,_i){return $.apply(this,arguments)})(!p.useRTX,!1);return p.localCapabilities=i0e(w),p.initialOffer=A,y0e(y0e({},y),{},{rtpCapabilities:w,offerSDP:A.sdp})}catch(A){throw new U_(N_.GET_LOCAL_CONNECTION_PARAMS_FAILED,A.toString())}var $})()}connect(p,A,y,w,$,j){var _e=this;return f(function*(){try{if(!_e.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");_e.remoteSDP=new hbe({remoteIceParameters:p,remoteDtlsParameters:A,candidates:y,remoteRTPCapabilities:w,remoteSetup:$,localCapabilities:_e.localCapabilities,cname:j});const K=_e.remoteSDP.toString(),_i=_e.logSDPExchange(_e.initialOffer.sdp||"","offer","local","connect");yield _e.peerConnection.setLocalDescription(_e.initialOffer),null==_i||_i(K),yield _e.peerConnection.setRemoteDescription({type:"answer",sdp:K});const _o=_e.peerConnection.getTransceivers()[0];if(null!=_o&&_o.receiver&&_e.tryBindTransportEvents(_o.receiver),v0("PRELOAD_MEDIA_COUNT")>0){_e.remoteSDP.preloadRemoteMedia();const _u=_e.remoteSDP.toString();yield _e.peerConnection.setRemoteDescription({type:"offer",sdp:_u});const ch=yield _e.peerConnection.createAnswer();yield _e.peerConnection.setLocalDescription(ch)}}catch(K){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(K.toString()))}})()}send(p,A,y){var w=this;return Ade(function*(){const $=yield GS(w.mutex.lock());try{if(!w.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const j=[];p.forEach(i_=>{const u_=w.peerConnection.addTransceiver(i_._mediaStreamTrack,{direction:"sendonly"});j.push(u_)}),X2()&&!0===v0("SIMULCAST")&&(sI("debug",w,"apply simulcast for firefox"),yield GS(w.applySimulcastForFirefox(j,p)));const _e=yield GS(w.peerConnection.createOffer()),K=w.remoteSDP.predictReceivingMids(p.length),_i=w.mungSendOfferSDP(_e.sdp,p,K),_o=h3.exports.parse(_i),_u=K.map(i_=>{const u_=_o.mediaDescriptions.find(g_=>g_.attributes.mid===i_);if(!u_)throw new Error("Cannot extract ssrc from mediaDescription.");return function(g_,__){const w_=[],k_=g_.attributes.ssrcGroups.filter(y0=>"FID"===y0.semantic),Rv=g_.attributes.ssrcGroups.find(y0=>"SIM"===y0.semantic),f0=g_.attributes.ssrcs;if(Rv)Rv.ssrcIds.forEach(y0=>{var b0;const rI=null===(b0=k_.find(q0=>q0.ssrcIds[0]===y0))||void 0===b0?void 0:b0.ssrcIds[1];w_.push({ssrcId:y0,rtx:__?rI:void 0})});else if(k_.length>0){const b0=k_[0].ssrcIds[1];w_.push({ssrcId:k_[0].ssrcIds[0],rtx:__?b0:void 0})}else{if(0===f0.length)throw new Error("No ssrcs found on local media description.");w_.push({ssrcId:f0[0].ssrcId})}return w_}(u_,w.useRTX)});let ch;try{ch=yield _u}catch(i_){ch=[],w.remoteSDP.receive(p,A,y,ch);const u_=w.remoteSDP.toString();throw yield GS(w.peerConnection.setLocalDescription({type:"offer",sdp:_i})),yield GS(w.peerConnection.setRemoteDescription({type:"answer",sdp:u_})),yield GS(w.stopSending(K,!0)),i_}w.remoteSDP.receive(p,A,y,ch);const _f=w.remoteSDP.toString(),o_=w.logSDPExchange(_i,"offer","local","send");return yield GS(w.peerConnection.setLocalDescription({type:"offer",sdp:_i})),yield GS(w.applySimulcastEncodings(j,p)),yield GS(w.applySendEncodings(j,p)),null==o_||o_(_f),yield GS(w.peerConnection.setRemoteDescription({type:"answer",sdp:_f})),j.map((i_,u_)=>({localSSRC:_u[u_],id:K[u_],transceiver:i_}))}catch(j){throw j instanceof U_?j:new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(j.toString()))}finally{$()}})()}stopSending(p,A){var y=this;return f(function*(){const w=A?void 0:yield y.mutex.lock("From P2PConnection.stopSending");try{if(!y.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const $=y.peerConnection.getTransceivers().filter(_i=>-1!==p.indexOf(_i.mid));if($.length!==p.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");$.map(_i=>{var _o;_i.direction="inactive",null===(_o=_i.stop)||void 0===_o||_o.call(_i)});const j=yield y.peerConnection.createOffer(),_e=y.logSDPExchange(j.sdp||"","offer","local","stopSending");yield y.peerConnection.setLocalDescription(j),y.remoteSDP.stopReceiving(p);const K=y.remoteSDP.toString();null==_e||_e(K),yield y.peerConnection.setRemoteDescription({type:"answer",sdp:K})}catch($){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat($.toString()))}finally{w&&w()}})()}receive(p,A,y,w){var $=this;return f(function*(){try{if(!$.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(p," before remoteSDP created."));const{mid:j,needExchangeSDP:_e}=$.remoteSDP.send(p,A,y,w);if(_e){const _i=$.remoteSDP.toString(),_o=$.logSDPExchange(_i,"offer","remote","receive");yield $.peerConnection.setRemoteDescription({type:"offer",sdp:_i});const _u=yield $.peerConnection.createAnswer();null==_o||_o(_u.sdp||""),yield $.peerConnection.setLocalDescription(_u),h_.debug("[P2PConnection] receive ".concat(p," by exchanging SDP."))}else h_.debug("[P2PConnection] receive ".concat(p," no need to exchange SDP."));const K=$.peerConnection.getTransceivers().find(_i=>_i.mid===j);if(!K)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:K.receiver.track,id:j}}catch(j){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(j.toString()))}})()}batchReceive(p){var A=this;return f(function*(){try{if(!A.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:y,needExchangeSDP:w}=A.remoteSDP.batchSend(p);if(w){const $=A.remoteSDP.toString(),j=A.logSDPExchange($,"offer","remote","receive");yield A.peerConnection.setRemoteDescription({type:"offer",sdp:$});const _e=yield A.peerConnection.createAnswer();null==j||j(_e.sdp||""),yield A.peerConnection.setLocalDescription(_e),h_.debug("[P2PConnection] batchReceive by exchanging SDP.")}else h_.debug("[P2PConnection] batchReceive no need to exchange SDP.");return y.map($=>{const j=A.peerConnection.getTransceivers().find(_e=>_e.mid===$);if(!j)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:j.receiver.track,id:$}})}catch(y){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(y.toString()))}})()}stopReceiving(p){var A=this;return f(function*(){try{if(!A.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");A.remoteSDP.stopSending(p);const y=A.remoteSDP.toString(),w=A.logSDPExchange(y,"offer","remote","stopReceiving");yield A.peerConnection.setRemoteDescription({type:"offer",sdp:y});const $=yield A.peerConnection.createAnswer();null==w||w($.sdp||""),yield A.peerConnection.setLocalDescription($)}catch(y){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(y.toString()))}})()}muteRemote(p){var A=this;return f(function*(){try{if(!A.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(p," before remote SDP created."));A.remoteSDP.mute(p);const y=A.remoteSDP.toString(),w=A.logSDPExchange(y,"offer","remote","muteRemote");yield A.peerConnection.setRemoteDescription({type:"offer",sdp:y});const $=yield A.peerConnection.createAnswer();null==w||w($.sdp||""),yield A.peerConnection.setLocalDescription($)}catch(y){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(y.toString()))}})()}unmuteRemote(p){var A=this;return f(function*(){try{if(!A.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(p," before remote SDP created."));A.remoteSDP.unmute(p);const y=A.remoteSDP.toString(),w=A.logSDPExchange(y,"offer","remote","unmuteRemote");yield A.peerConnection.setRemoteDescription({type:"offer",sdp:y});const $=yield A.peerConnection.createAnswer();null==w||w($.sdp||""),yield A.peerConnection.setLocalDescription($)}catch(y){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(y.toString()))}})()}muteLocal(p){var A=this;return f(function*(){try{if(!A.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const y=A.peerConnection.getTransceivers().filter(_e=>_e.mid&&-1!==p.indexOf(_e.mid));if(y.length!==p.length)throw new Error("Transceivers' length doesn't match mids' length.");y.map(_e=>{_e.direction="inactive"});const w=yield A.peerConnection.createOffer(),$=A.logSDPExchange(w.sdp||"","offer","local","muteLocal");yield A.peerConnection.setLocalDescription(w),A.remoteSDP.muteRemote(p);const j=A.remoteSDP.toString();null==$||$(j),yield A.peerConnection.setRemoteDescription({type:"answer",sdp:j})}catch(y){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(y.toString()))}})()}unmuteLocal(p){var A=this;return f(function*(){try{if(!A.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const y=A.peerConnection.getTransceivers().filter(_e=>_e.mid&&-1!==p.indexOf(_e.mid));if(y.length!==p.length)throw new Error("Transceivers' length doesn't match mids' length.");y.map(function(){var _e=f(function*(K,_i){K.direction="sendonly"});return function(K,_i){return _e.apply(this,arguments)}}());const w=yield A.peerConnection.createOffer(),$=A.logSDPExchange(w.sdp||"","offer","local","unmuteLocal");yield A.peerConnection.setLocalDescription(w),A.remoteSDP.unmuteRemote(p);const j=A.remoteSDP.toString();null==$||$(j),yield A.peerConnection.setRemoteDescription({type:"answer",sdp:j})}catch(y){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(y.toString()))}})()}reEstablish(){var p=this;return f(function*(){const A=yield p.peerConnection.createOffer({iceRestart:!0});if(!A.sdp)throw new Error("Cannot get SDP from restart offer.");return{iceParameters:jme(A.sdp).iceParameters,restartICE:(y=f(function*(w,$){return p.restartICE(A,w,$)}),function($,j){return y.apply(this,arguments)}),restartOfferSDP:A.sdp};var y})()}close(){var p;this.peerConnection.close(),null===(p=this.onConnectionStateChange)||void 0===p||p.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(p){return this.statsFilter.getVideoIsReady(p)}updateEncoderConfig(p,A){var y=this;return f(function*(){try{if(!y.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const w=yield y.peerConnection.createOffer(),$=y.mungSendOfferSDP(w.sdp,[A],[p]);y.remoteSDP.updateRecvMedia(p,A);const j=y.remoteSDP.toString(),_e=y.logSDPExchange($,"offer","local","updateEncoderConfig");yield y.peerConnection.setLocalDescription({type:"offer",sdp:$}),null==_e||_e(j),yield y.peerConnection.setRemoteDescription({type:"answer",sdp:j})}catch(w){throw new U_(N_.EXCHANGE_SDP_FAILED,w.toString())}})()}updateSendParameters(p,A){var y=this;return f(function*(){const w=y.peerConnection.getTransceivers().filter($=>$.mid===p);1===w.length&&(y.isVP8Simulcast(A)?X2()||(yield y.applySimulcastEncodings(w,[A])):yield y.applySendEncodings(w,[A]))})()}setStatsRemoteVideoIsReady(p,A){this.statsFilter.setVideoIsReady2(p,A)}replaceTrack(p,A){var y=this;return f(function*(){const w=y.peerConnection.getTransceivers().find($=>$.mid===A);w&&(yield w.sender.replaceTrack(p._mediaStreamTrack))})()}restartICE(p,A,y){var w=this;return f(function*(){try{if(!w.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");w.remoteSDP.restartICE(A,y);const $=w.remoteSDP.toString(),j=w.logSDPExchange(p.sdp||"","offer","local","restartICE");yield w.peerConnection.setLocalDescription(p),null==j||j($),yield w.peerConnection.setRemoteDescription({type:"answer",sdp:$})}catch($){throw new U_(N_.EXCHANGE_SDP_FAILED,"P2PConnection.restartICE failed; ".concat($.toString()))}})()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var p;null===(p=this.onICEConnectionStateChange)||void 0===p||p.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var p;null===(p=this.onConnectionStateChange)||void 0===p||p.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=p=>{p.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,h_.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,h_.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},v0("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(p){const A={iceServers:[]};return p.iceServers?A.iceServers=p.iceServers:p.turnServer&&"off"!==p.turnServer.mode&&(vN(p.turnServer.servers)?A.iceServers=p.turnServer.servers:(A.iceServers&&A.iceServers.push(...Zme.turnServerConfigToIceServers(p.turnServer.servers)),v0("USE_TURN_SERVER_OF_GATEWAY")&&A.iceServers&&p.turnServer.serversFromGateway&&A.iceServers.push(...Zme.turnServerConfigToIceServers(p.turnServer.serversFromGateway)),p.turnServer.servers.concat(p.turnServer.serversFromGateway||[]).forEach(y=>{y.forceturn&&(A.iceTransportPolicy="relay")}))),A}static turnServerConfigToIceServers(p){const A=[];return p.forEach(y=>{y.security?y.tcpport&&A.push({username:y.username,credential:y.password,credentialType:"password",urls:"turns:".concat(uX(y.turnServerURL),":").concat(y.tcpport,"?transport=tcp")}):(y.udpport&&A.push({username:y.username,credential:y.password,credentialType:"password",urls:"turn:".concat(y.turnServerURL,":").concat(y.udpport,"?transport=udp")}),y.tcpport&&A.push({username:y.username,credential:y.password,credentialType:"password",urls:"turn:".concat(y.turnServerURL,":").concat(y.tcpport,"?transport=tcp")}))}),A}tryBindTransportEvents(p){p.transport&&(this.transportEventReceiver=p,p.transport.onstatechange=()=>{var A,y;null!==(A=p.transport)&&void 0!==A&&A.state&&(null===(y=this.onDTLSTransportStateChange)||void 0===y||y.call(this,p.transport.state))},p.transport.onerror=A=>{var y;null===(y=this.onDTLSTransportError)||void 0===y||y.call(this,A.error)},p.transport.iceTransport&&(p.transport.iceTransport.onstatechange=()=>{var A,y,w;null!==(A=p.transport)&&void 0!==A&&A.iceTransport.state&&(null===(y=this.onICETransportStateChange)||void 0===y||y.call(this,null===(w=p.transport)||void 0===w?void 0:w.iceTransport.state))}))}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}applySendEncodings(p,A){var y=this;return f(function*(){try{if(!bN().supportSetRtpSenderParameters||p.length!==A.length)return;for(let _o=0;_o<p.length;_o++){const _u=p[_o],ch=A[_o];if(ch&&ch instanceof yS){var w,$;if(y.isVP8Simulcast(ch))continue;const _f={},o_={};switch(ch._optimizationMode){case"motion":_f.degradationPreference="maintain-framerate";break;case"detail":_f.degradationPreference="maintain-resolution";break;default:_f.degradationPreference="balanced"}var j,_e,K,_i;if(null!==(w=ch._encoderConfig)&&void 0!==w&&w.bitrateMax&&(o_.maxBitrate=1e3*(null===(j=ch._encoderConfig)||void 0===j?void 0:j.bitrateMax)),ch._hints.includes(DR.LOW_STREAM)&&(null!==(_e=ch._encoderConfig)&&void 0!==_e&&_e.frameRate&&(o_.maxFramerate=jM(ch._encoderConfig.frameRate)),null!==(K=ch._encoderConfig)&&void 0!==K&&K.scaleResolutionDownBy&&(null===(_i=ch._encoderConfig)||void 0===_i?void 0:_i.scaleResolutionDownBy)>1&&(o_.scaleResolutionDownBy=ch._encoderConfig.scaleResolutionDownBy)),v0("DSCP_TYPE")&&bQ()){const g_=v0("DSCP_TYPE");["very-low","low","medium","high"].includes(g_)&&(o_.networkPriority=g_)}const i_=_u.sender.getParameters(),u_=null===($=i_.encodings)||void 0===$?void 0:$[0];X2()&&!u_&&(_f.encodings=[o_]),u_&&Object.assign(u_,o_),Object.assign(i_,_f),yield _u.sender.setParameters(i_)}}}catch(_o){h_.debug("Apply RTPSendEncodings failed.")}})()}mungSendOfferSDP(p,A,y){const w=h3.exports.parse(p);return A.forEach(($,j)=>{const _e=y[j],K=w.mediaDescriptions.find(_i=>_i.attributes.mid===_e);K&&(Vme(K,$),function(_i,_o,_u){if(X2()||"video"!==_i.media.mediaType||!(_o instanceof yS)||"vp9"!==_u&&"vp8"!==_u||"vp8"===_u&&!v0("SIMULCAST")||void 0===_o._scalabiltyMode||_o._scalabiltyMode.numSpatialLayers<=1)return;const ch="vp8"===_u?2:_o._scalabiltyMode.numSpatialLayers,_f=_i.attributes.ssrcs[0],o_=_i.attributes.ssrcGroups.find(u_=>"FID"===u_.semantic&&u_.ssrcIds[0]===_f.ssrcId),i_={semantic:"SIM",ssrcIds:[_f.ssrcId]};for(let u_=1;u_<ch;u_++)_i.attributes.ssrcs.push({ssrcId:_f.ssrcId+u_,attributes:jS(_f.attributes)}),i_.ssrcIds.push(_f.ssrcId+u_),o_&&(_i.attributes.ssrcs.push({ssrcId:o_.ssrcIds[1]+u_,attributes:jS(_f.attributes)}),_i.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[_f.ssrcId+u_,o_.ssrcIds[1]+u_]}));_i.attributes.ssrcGroups.unshift(i_)}(K,$,this.store.codec))}),h3.exports.print(w)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=p=>{var A;null===(A=this.onFirstAudioReceived)||void 0===A||A.call(this,p)},this.statsFilter.onFirstVideoReceived=p=>{var A;null===(A=this.onFirstVideoReceived)||void 0===A||A.call(this,p)},this.statsFilter.onFirstAudioDecoded=p=>{var A;null===(A=this.onFirstAudioDecoded)||void 0===A||A.call(this,p)},this.statsFilter.onFirstVideoDecoded=(p,A,y)=>{var w;null===(w=this.onFirstVideoDecoded)||void 0===w||w.call(this,p,A,y)},this.statsFilter.onSelectedLocalCandidateChanged=(p,A)=>{var y;null===(y=this.onSelectedLocalCandidateChanged)||void 0===y||y.call(this,p,A)},this.statsFilter.onSelectedRemoteCandidateChanged=(p,A)=>{var y;null===(y=this.onSelectedRemoteCandidateChanged)||void 0===y||y.call(this,p,A)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}applySimulcastForFirefox(p,A){var y=this;return f(function*(){if(p.length===A.length)for(let K=0;K<p.length;K++){var w,$,j,_e;const _i=p[K],_o=A[K];if(_o instanceof yS&&!_o._hints.includes(DR.LOW_STREAM)&&null!==(w=_o._encoderConfig)&&void 0!==w&&w.bitrateMax&&(null===($=_o._encoderConfig)||void 0===$?void 0:$.bitrateMax)>200&&null!==(j=_o._scalabiltyMode)&&void 0!==j&&j.numSpatialLayers&&(null===(_e=_o._scalabiltyMode)||void 0===_e?void 0:_e.numSpatialLayers)>1&&"vp8"===y.store.codec){const _u={},ch={high:1e3*(_o._encoderConfig.bitrateMax-50),medium:5e4};_u.encodings=[{rid:"m",active:!0,maxBitrate:ch.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:ch.high}];const _f=_i.sender.getParameters();yield _i.sender.setParameters(Object.assign(_f,_u))}}})()}applySimulcastEncodings(p,A){var y=this;return f(function*(){if(!X2()&&p.length===A.length)for(let w=0;w<p.length;w++){const $=A[w];if($ instanceof yS&&y.isVP8Simulcast($)){const j=p[w],_e={},K={high:1e3*($._encoderConfig.bitrateMax-50),medium:5e4};_e.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:K.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:K.medium,scaleResolutionDownBy:4}];const _i=j.sender.getParameters();yield j.sender.setParameters(Object.assign(_i,_e))}}})()}isVP8Simulcast(p){var A,y,w,$;return!!(p instanceof yS&&v0("SIMULCAST")&&"vp8"===this.store.codec&&!p._hints.includes(DR.LOW_STREAM)&&null!==(A=p._encoderConfig)&&void 0!==A&&A.bitrateMax&&(null===(y=p._encoderConfig)||void 0===y?void 0:y.bitrateMax)>200&&null!==(w=p._scalabiltyMode)&&void 0!==w&&w.numSpatialLayers&&(null===($=p._scalabiltyMode)||void 0===$?void 0:$.numSpatialLayers)>1)}logSDPExchange(p,A,y,w){if(v0("SDP_LOGGING"))return h_.upload("exchanging ".concat(y," ").concat(A," SDP during P2PConnection.").concat(w,"\n"),p),"offer"===A?$=>{this.logSDPExchange($,"answer","local"===y?"remote":"local",w)}:void 0}}).prototype,"connect",[KM],Object.getOwnPropertyDescriptor(k1.prototype,"connect"),k1.prototype),gI(k1.prototype,"receive",[KM],Object.getOwnPropertyDescriptor(k1.prototype,"receive"),k1.prototype),gI(k1.prototype,"batchReceive",[KM],Object.getOwnPropertyDescriptor(k1.prototype,"batchReceive"),k1.prototype),gI(k1.prototype,"stopReceiving",[KM],Object.getOwnPropertyDescriptor(k1.prototype,"stopReceiving"),k1.prototype),gI(k1.prototype,"muteRemote",[KM],Object.getOwnPropertyDescriptor(k1.prototype,"muteRemote"),k1.prototype),gI(k1.prototype,"unmuteRemote",[KM],Object.getOwnPropertyDescriptor(k1.prototype,"unmuteRemote"),k1.prototype),gI(k1.prototype,"muteLocal",[KM],Object.getOwnPropertyDescriptor(k1.prototype,"muteLocal"),k1.prototype),gI(k1.prototype,"unmuteLocal",[KM],Object.getOwnPropertyDescriptor(k1.prototype,"unmuteLocal"),k1.prototype),gI(k1.prototype,"reEstablish",[KM],Object.getOwnPropertyDescriptor(k1.prototype,"reEstablish"),k1.prototype),gI(k1.prototype,"close",[KM],Object.getOwnPropertyDescriptor(k1.prototype,"close"),k1.prototype),gI(k1.prototype,"updateEncoderConfig",[KM],Object.getOwnPropertyDescriptor(k1.prototype,"updateEncoderConfig"),k1.prototype),gI(k1.prototype,"updateSendParameters",[KM],Object.getOwnPropertyDescriptor(k1.prototype,"updateSendParameters"),k1.prototype),gI(k1.prototype,"replaceTrack",[KM],Object.getOwnPropertyDescriptor(k1.prototype,"replaceTrack"),k1.prototype),gI(k1.prototype,"restartICE",[KM],Object.getOwnPropertyDescriptor(k1.prototype,"restartICE"),k1.prototype),_0e=k1))||_0e;function KM(s,p,A){const y=s[p];if("function"!=typeof y)throw new Error("Cannot use mutex on object property.");return A.value=f(function*(){const w=this.mutex,$=yield w.lock("From P2PConnection.".concat(p));try{for(var j=arguments.length,_e=new Array(j),K=0;K<j;K++)_e[K]=arguments[K];return yield y.apply(this,_e)}finally{$()}}),A}var E0e,I0e;function b0e(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function Hme(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?b0e(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):b0e(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}class C0e extends Z8{getUserId(){return this._userId}constructor(p,A,y,w){super(p,"track-".concat(p.kind,"-").concat(A,"-").concat(w.clientId,"_").concat(VT(5,""))),a_(this,"_userId",void 0),a_(this,"_uintId",void 0),a_(this,"_isDestroyed",!1),a_(this,"store",void 0),this._userId=A,this._uintId=y,this.store=w}_updateOriginMediaStreamTrack(p){this._originMediaStreamTrack=p,this._mediaStreamTrack=p,this._updatePlayerSource()}_destroy(){this._isDestroyed=!0,h_.info("[".concat(this.getTrackId(),"] is destroyed")),S0("info",this,"_destroy"),this.stop(),super.close()}}let qme=TR("RemoteVideoTrack","getTrackId")(E0e=class extends C0e{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==yO.PLAYING)}constructor(s,p,A,y){super(s,p,A,y),a_(this,"_videoVisibleTimer",null),a_(this,"_previousVideoVisibleStatus",void 0),a_(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),a_(this,"trackMediaType","video"),a_(this,"_videoWidth",void 0),a_(this,"_videoHeight",void 0),a_(this,"_player",void 0),S0("info",this,"constructor",{userId:p}),this.updateMediaStreamTrackResolution()}getStats(){return YK(()=>{h_.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead"),sI("warning",this,"[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),o3(this,mI.GET_STATS)||Hme({},Cce)}play(s){let p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const A=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.REMOTE_VIDEO_TRACK_PLAY,options:[this.getTrackId(),"string"==typeof s?s:"HTMLElement",p]});if("string"==typeof s){const w=document.getElementById(s);w?s=w:(h_.warning("[".concat(this.getTrackId(),'] can not find "#').concat(s,'" element, use document.body')),sI("warning",this,'can not find "#'.concat(s,'" element, use document.body')),s=document.body)}h_.debug("[".concat(this.getTrackId(),"] start video playback"),JSON.stringify(p)),S0("debug",this,"play",p);const y=Hme(Hme({fit:"cover"},p),{},{trackId:this.getTrackId(),element:s});this._player?this._player.updateConfig(y):(this._player=new f2(y),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,performance.now()),this.emit(j8.FIRST_FRAME_DECODED)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const w=this.getVideoElementVisibleStatus();this.emit(j8.VIDEO_ELEMENT_VISIBLE_STATUS,w)}catch(w){}},v0("CHECK_VIDEO_VISIBLE_INTERVAL")),A.onSuccess()}stop(){const s=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.REMOTE_VIDEO_TRACK_STOP,options:[this.getTrackId()]});if(!this._player)return s.onSuccess();this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,h_.debug("[".concat(this.getTrackId(),"] stop video playback")),S0("debug",this,"stop"),s.onSuccess()}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){mge(this._originMediaStreamTrack).then(s=>{let[p,A]=s;this._videoHeight=A,this._videoWidth=p}).catch(pie)}_updatePlayerSource(){h_.debug("[".concat(this.getTrackId(),"] update player source track")),S0("debug",this,"_updatePlayerSource"),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var s,p;const A=null==this||null===(s=this._player)||void 0===s?void 0:s.getContainerElement(),y={track:this,element:null==this||null===(p=this._player)||void 0===p?void 0:p.getVideoElement(),slot:null==A?void 0:A.parentElement},{element:w,slot:$}=y;if(this.isPlaying&&w instanceof HTMLVideoElement&&$ instanceof HTMLElement){const j=G1.checkOneElementVisible(w),_e=Object.assign({},j);if(_e.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=_e.visible;w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]}).onSuccess(_e.visible?"Video is visible":"Invisible because of ".concat(_e.reason))}return _e}return}catch(A){throw new U_(N_.GET_VIDEO_ELEMENT_VISIBLE_ERROR,A.message)}}})||E0e,Wme=TR("RemoteAudioTrack","getTrackId")(I0e=class extends C0e{get isPlaying(){return this._useAudioElement?aP.isPlaying(this.getTrackId()):this._source.isPlayed}constructor(s,p,A,y){super(s,p,A,y),a_(this,"trackMediaType","audio"),a_(this,"_source",void 0),a_(this,"_useAudioElement",!0),a_(this,"_volume",100),S0("info",this,"constructor",{userId:p}),v0("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),this._source=new Mue(s,!0),this._source.once(s2.RECEIVE_TRACK_BUFFER,()=>{this.emit(j8.FIRST_FRAME_DECODED)})}setAudioFrameCallback(s){let p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!s)return this._source.removeAllListeners(s2.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(p),this._source.removeAllListeners(s2.ON_AUDIO_BUFFER),this._source.on(s2.ON_AUDIO_BUFFER,A=>s(A))}setVolume(s){const p=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.REMOTE_AUDIO_SET_VOLUME,options:[this.getTrackId(),s]},300);this._volume=s,this._useAudioElement?aP.setVolume(this.getTrackId(),s):this._source.setVolume(s/100),p.onSuccess()}setPlaybackDevice(s){var p=this;return f(function*(){const A=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.REMOTE_AUDIO_SET_OUTPUT_DEVICE,options:[p.getTrackId(),s]});if(!p._useAudioElement)throw new U_(N_.NOT_SUPPORTED,"your browser does not support setting the audio output device");try{yield aP.setSinkID(p.getTrackId(),s)}catch(y){throw A.onError(y),y}A.onSuccess()})()}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return YK(()=>{h_.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead"),sI("warning",this,"[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),o3(this,mI.GET_STATS)||Hme({},_re)}play(){const s=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.REMOTE_AUDIO_TRACK_PLAY,options:[this.getTrackId()]});h_.debug("[".concat(this.getTrackId(),"] start audio playback")),S0("debug",this,"play"),this._useAudioElement?(h_.debug("[".concat(this.getTrackId(),"] use audio element to play")),sI("debug",this,"use audio element to play"),aP.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play(),s.onSuccess()}stop(){const s=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.REMOTE_AUDIO_TRACK_STOP,options:[this.getTrackId()]});h_.debug("[".concat(this.getTrackId(),"] stop audio playback")),S0("debug",this,"stop"),this._useAudioElement?aP.stop(this.getTrackId()):this._source.stop(),s.onSuccess()}_destroy(){super._destroy(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){h_.debug("[".concat(this.getTrackId(),"] update player source track")),S0("debug",this,"_updatePlayerSource"),this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&aP.updateTrack(this.getTrackId(),this._mediaStreamTrack)}})||I0e;function w0e(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function T0e(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?w0e(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):w0e(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}class gbe extends sS{constructor(){super(),a_(this,"uplinkStatsUploadInterval",void 0),a_(this,"uplinkStatsUploadSlowInterval",void 0),a_(this,"uplinkRelatedStatsUploadInterval",void 0),a_(this,"uplinkDenoiserStatsUploadInterval",void 0),a_(this,"transportStatsUploadInterval",void 0),a_(this,"extensionStatsUploadInterval",void 0),a_(this,"downlinkStatsUploadInterval",void 0),a_(this,"downlinkStatsUploadSlowInterval",void 0),a_(this,"downlinkRelatedStatsUploadInterval",void 0),a_(this,"lastStats",void 0),a_(this,"uploadUnplinkStarted",!1),a_(this,"uploadDownlinkStarted",!1),a_(this,"uploadTransportStarted",!1),a_(this,"requestStats",void 0),a_(this,"requestLocalMedia",void 0),a_(this,"requestRemoteMedia",void 0),a_(this,"requestAllTracks",void 0),a_(this,"requestVideoIsReady",void 0),a_(this,"requestUpload",void 0)}startUploadTransportStats(){this.uploadTransportStarted||(this.uploadTransportStarted=!0,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=window.setInterval(()=>{var p;const A=null===(p=this.requestStats)||void 0===p?void 0:p.call(this);A&&this.uploadTransportStats(A)},6e3))}startUploadUplinkStats(){this.uploadUnplinkStarted||(this.uploadUnplinkStarted=!0,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkStatsUploadInterval=window.setInterval(()=>{var p;const A=null===(p=this.requestStats)||void 0===p?void 0:p.call(this);A&&(this.uploadUplinkStats(A,this.lastStats),this.lastStats=A)},3e3),this.uplinkStatsUploadSlowInterval&&window.clearInterval(this.uplinkStatsUploadSlowInterval),this.uplinkStatsUploadSlowInterval=window.setInterval(()=>{var p;const A=null===(p=this.requestStats)||void 0===p?void 0:p.call(this);A&&this.uploadSlowUplinkStats(A)},6e4),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkRelatedStatsUploadInterval=window.setInterval(()=>{var p;const A=null===(p=this.requestStats)||void 0===p?void 0:p.call(this);A&&this.uploadRelatedUplinkStats(A,this.lastStats),this.lastStats=A},1e3),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval=window.setInterval(()=>{var p;const A=null===(p=this.requestAllTracks)||void 0===p?void 0:p.call(this);A&&this.uploadDenoiserStats(A)},2e3),this.extensionStatsUploadInterval&&window.clearInterval(this.extensionStatsUploadInterval),this.extensionStatsUploadInterval=window.setInterval(()=>{var p;const A=null===(p=this.requestAllTracks)||void 0===p?void 0:p.call(this);A&&this.uploadExtensionStats(A)},2e3))}uploadTransportStats(p){d2(()=>{var A;null===(A=this.requestUpload)||void 0===A||A.call(this,hR.TRANSPORT_STATS,function(y){const w={connectionType:100};if("relay"===y.selectedCandidatePair.localCandidate.candidateType){const $=y.selectedCandidatePair.localCandidate.relayProtocol;"udp"===$&&(w.connectionType=101),"tcp"===$&&(w.connectionType=103),"tls"===$&&(w.connectionType=104)}return w}(p))})}uploadUplinkStats(p,A){var y;((null===(y=this.requestLocalMedia)||void 0===y?void 0:y.call(this))||[]).forEach(w=>{let[$,{track:j,ssrcs:_e}]=w;switch($){case U0.LocalVideoLowTrack:case U0.LocalVideoTrack:{const _i=function(_u,ch,_f){var o_;const i_=ch.videoSend.find(g_=>g_.ssrc===_u);if(!i_)return null;const u_={id:VT(10,""),timestamp:new Date(ch.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:i_.ssrc.toString()};switch(u_.A_vstd=_f._originMediaStreamTrack&&!_f._originMediaStreamTrack.enabled||!_f._mediaStreamTrack.enabled?"1":"0",i_.sentFrame&&(u_.A_fhs=i_.sentFrame.height.toString(),u_.A_frs=i_.sentFrame.frameRate.toString(),u_.A_fws=i_.sentFrame.width.toString()),i_.adaptionChangeReason){case"none":u_.A_ac="0";break;case"cpu":u_.A_ac="1";break;case"bandwidth":u_.A_ac="2";break;case"other":u_.A_ac="3"}return u_.A_lvps=vce[_f._player?_f._player.videoElementStatus:"uninit"].toString(),u_.A_nr=null===(o_=i_.nacksCount)||void 0===o_?void 0:o_.toString(),i_.avgEncodeMs&&(u_.A_aem=i_.avgEncodeMs.toFixed(0).toString()),u_}(_e[0].ssrcId,p,j),_o=hie(_e[0].ssrcId,p,A);_i&&d2(()=>{var _u;return null===(_u=this.requestUpload)||void 0===_u?void 0:_u.call(this,hR.PUBLISH_STATS,{stream_type:$===U0.LocalVideoLowTrack?"low":"high",stats:T0e(T0e({},_i),_o)})});break}case U0.LocalAudioTrack:{const _i=function(_o,_u,ch){const _f=_u.audioSend.find(i_=>i_.ssrc===_o);if(!_f)return null;const o_={id:VT(10,""),timestamp:new Date(_u.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:_f.ssrc.toString()};return o_.A_astd=ch._originMediaStreamTrack.enabled&&ch._mediaStreamTrack.enabled?"0":"1",o_.A_ail=_f.inputLevel?Math.round(100*_f.inputLevel).toString():Math.round(100*ch._source.getAccurateVolumeLevel()).toString(),o_.A_apil=Math.round(100*ch._source.getAccurateVolumeLevel()).toString(),_f.aecReturnLoss&&(o_.A_ecrl=Math.round(_f.aecReturnLoss).toString()),_f.aecReturnLossEnhancement&&(o_.A_ecrle=Math.round(_f.aecReturnLossEnhancement).toString()),o_}(_e[0].ssrcId,p,j);_i&&d2(()=>{var _o;return null===(_o=this.requestUpload)||void 0===_o?void 0:_o.call(this,hR.PUBLISH_STATS,{stream_type:"high",stats:_i})});break}}const K=function(_i){const _o={id:"bweforvideo",timestamp:new Date(_i.timestamp).toISOString(),type:"VideoBwe"};return _i.bitrate.retransmit&&(_o.A_rb=_i.bitrate.retransmit.toString()),_i.bitrate.targetEncoded&&(_o.A_teb=_i.bitrate.targetEncoded.toString()),_o.A_aeb=_i.bitrate.actualEncoded.toString(),_o.A_tb=_i.bitrate.transmit.toString(),void 0!==_i.sendBandwidth&&(_o.A_asb=_i.sendBandwidth.toString()),_o}(p);K&&d2(()=>{var _i;return null===(_i=this.requestUpload)||void 0===_i?void 0:_i.call(this,hR.PUBLISH_STATS,{stream_type:$===U0.LocalVideoLowTrack?"low":"high",stats:K})})})}uploadSlowUplinkStats(p){var A;((null===(A=this.requestLocalMedia)||void 0===A?void 0:A.call(this))||[]).filter(y=>{let[w]=y;return w===U0.LocalVideoLowTrack||w===U0.LocalVideoTrack}).forEach(y=>{let[w,{ssrcs:$}]=y;const j=hie($[0].ssrcId,p);j&&d2(()=>{var _e;return null===(_e=this.requestUpload)||void 0===_e?void 0:_e.call(this,hR.PUBLISH_STATS,{stream_type:w===U0.LocalVideoLowTrack?"low":"high",stats:j})})})}uploadRelatedUplinkStats(p,A){var y;((null===(y=this.requestLocalMedia)||void 0===y?void 0:y.call(this))||[]).filter(w=>{let[$]=w;return $===U0.LocalVideoLowTrack||$===U0.LocalVideoTrack}).forEach(w=>{let[$,{ssrcs:j}]=w;const _e=function(K,_i){const _o=_i.videoSend.find(_u=>_u.ssrc===K);return _o?{mediaType:"video",isVideoMute:!1,frameRateInput:_o.inputFrame&&_o.inputFrame.frameRate.toString(),frameRateSent:_o.sentFrame&&_o.sentFrame.frameRate.toString(),googRtt:_o.rttMs.toString(),qpSumPerFrame:Math.floor(_o.qpSumPerFrame).toString()}:null}(j[0].ssrcId,p);_e&&d2(()=>{var K;null===(K=this.requestUpload)||void 0===K||K.call(this,hR.PUBLISH_RELATED_STATS,{stream_type:$===U0.LocalVideoLowTrack?"low":"high",stats:_e})})})}uploadDenoiserStats(p){for(let $=0;$<p.length;$++){const j=p[$];if(j instanceof JQ){var A,y,w;const _e=null===(A=(y=j._external).getDenoiserStats)||void 0===A?void 0:A.call(y);return void(_e&&(null===(w=this.requestUpload)||void 0===w||w.call(this,hR.DENOISER_STATS,_e)))}}}uploadExtensionStats(p){for(let A=0;A<p.length;A++){const y=p[A];if(y instanceof JQ)return void y.getProcessorStats().forEach(w=>{var $;w.type===hR.DENOISER_STATS&&(null===($=this.requestUpload)||void 0===$||$.call(this,hR.DENOISER_STATS,w.stats))})}}stopUploadUplinkStats(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkStatsUploadInterval=void 0,this.uplinkRelatedStatsUploadInterval=void 0,this.uplinkDenoiserStatsUploadInterval=void 0)}startUploadDownlinkStats(){this.uploadDownlinkStarted||(this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval),this.downlinkStatsUploadInterval=window.setInterval(()=>{var p;const A=null===(p=this.requestStats)||void 0===p?void 0:p.call(this);A&&(this.uploadDownlinkStats(A,this.lastStats),this.lastStats=A)},3e3),this.downlinkStatsUploadSlowInterval&&window.clearInterval(this.downlinkStatsUploadSlowInterval),this.downlinkStatsUploadSlowInterval=window.setInterval(()=>{var p;const A=null===(p=this.requestStats)||void 0===p?void 0:p.call(this);A&&this.uploadSlowDownlinkStats(A)},6e4),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkRelatedStatsUploadInterval=window.setInterval(()=>{var p;const A=null===(p=this.requestStats)||void 0===p?void 0:p.call(this);A&&(this.uploadRelatedDownlinkStats(A,this.lastStats),this.lastStats=A)},1e3))}uploadDownlinkStats(p,A){var y;((null===(y=this.requestRemoteMedia)||void 0===y?void 0:y.call(this))||[]).forEach(w=>{let[$,j]=w;if(j.has(o1.VIDEO)&&$.videoTrack){const _e=$.videoTrack?function(K,_i,_o){const _u=_i.videoRecv.find(i_=>i_.ssrc===K);if(!_u)return null;const ch={id:VT(10,""),timestamp:new Date(_i.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:_u.ssrc.toString()};var _f,o_;return ch.bytesReceived=_u.bytes.toString(),ch.packetsLost=_u.packetsLost.toString(),ch.packetsReceived=_u.packets.toString(),_u.framesRateFirefox&&(ch.A_frr=_u.framesRateFirefox.toString()),_u.receivedFrame?(ch.A_frr=_u.receivedFrame.frameRate.toString(),ch.A_fhr=_u.receivedFrame.height.toString(),ch.A_fwr=_u.receivedFrame.width.toString()):(ch.A_fhr=null===(_f=_o._videoHeight)||void 0===_f?void 0:_f.toString(),ch.A_fwr=null===(o_=_o._videoWidth)||void 0===o_?void 0:o_.toString()),ch.A_frd=_u.decodeFrameRate.toString(),_u.outputFrame&&(ch.A_fro=_u.outputFrame.frameRate.toString()),void 0!==_u.jitterBufferMs&&(ch.A_jbm=Math.floor(_u.jitterBufferMs).toString()),void 0!==_u.currentDelayMs&&(ch.A_cdm=Math.floor(_u.currentDelayMs).toString()),ch.A_fs=_u.firsCount.toString(),ch.A_ns=_u.nacksCount.toString(),ch.A_ps=_u.plisCount.toString(),_o&&(ch.A_vrtd=_o._originMediaStreamTrack.enabled&&_o._mediaStreamTrack.enabled?"0":"1"),_o._player&&_o._player.freezeTimeCounterList.length>0&&(ch.A_vrft=_o._player.freezeTimeCounterList.splice(0,1)[0].toString()),ch.A_rvps=vce[_o._player?_o._player.videoElementStatus:"uninit"].toString(),ch}($._videoSSRC,p,$.videoTrack):void 0;_e&&d2(()=>{var K;return null===(K=this.requestUpload)||void 0===K?void 0:K.call(this,hR.SUBSCRIBE_STATS,{stream_id:$.uid,stats:_e})})}if(j.has(o1.AUDIO)&&$.audioTrack){const _e=$.audioTrack?function(K,_i,_o){const _u=_i.audioRecv.find(_f=>_f.ssrc===K);if(!_u)return null;const ch={id:VT(10,""),timestamp:new Date(_i.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:_u.ssrc.toString()};return ch.bytesReceived=_u.bytes.toString(),ch.packetsLost=_u.packetsLost.toString(),ch.packetsReceived=_u.packets.toString(),ch.A_aol=_u.outputLevel?Math.round(100*_u.outputLevel).toString():Math.round(100*_o._source.getAccurateVolumeLevel()).toString(),ch.A_apol=Math.round(100*_o._source.getAccurateVolumeLevel()).toString(),_o&&(ch.A_artd=_o._originMediaStreamTrack.enabled&&_o._mediaStreamTrack.enabled?"0":"1"),ch.A_jr=_u.jitterMs.toString(),ch.A_jbm=Math.floor(_u.jitterBufferMs).toString(),ch.A_cdm=Math.floor(_u.jitterBufferMs).toString(),ch.A_raps=vce[aP.getPlayerState(_o.getTrackId())].toString(),ch}($._audioSSRC,p,$.audioTrack):void 0;_e&&d2(()=>{var K;return null===(K=this.requestUpload)||void 0===K?void 0:K.call(this,hR.SUBSCRIBE_STATS,{stream_id:$.uid,stats:_e})})}})}uploadSlowDownlinkStats(p){}uploadRelatedDownlinkStats(p,A){var y;((null===(y=this.requestRemoteMedia)||void 0===y?void 0:y.call(this))||[]).forEach(w=>{let[$,j]=w;if(j.has(o1.VIDEO)&&$.videoTrack){var _e;const K=!0===($._videoSSRC&&(null===(_e=this.requestVideoIsReady)||void 0===_e?void 0:_e.call(this,$._videoSSRC))||!1),_i=function(_o,_u,ch,_f,o_,i_){const u_=ch.videoRecv.find(k_=>k_.ssrc===_o),g_=o_?o_.videoRecv.find(k_=>k_.ssrc===_o):void 0;if(!u_)return null;const __=KK.isRemoteVideoFreeze(i_,u_,g_)&&_u,w_={mediaType:"video",isVideoMute:!1,peerId:_f,frameRateReceived:u_.receivedFrame&&u_.receivedFrame.frameRate.toString(),frameRateDecoded:u_.decodedFrame&&u_.decodedFrame.frameRate.toString(),isFreeze:__,bytesReceived:u_.bytes.toString(),packetsReceived:u_.packets.toString(),packetsLost:u_.packetsLost.toString(),qpSumPerFrame:Math.floor(u_.qpSumPerFrame).toString()};return u_.framesRateFirefox&&(w_.frameRateDecoded=u_.framesRateFirefox.toString(),w_.frameRateReceived=u_.framesRateFirefox.toString()),w_}($._videoSSRC,K,p,$.uid,A,$.videoTrack);_i&&d2(()=>{var _o;null===(_o=this.requestUpload)||void 0===_o||_o.call(this,hR.SUBSCRIBE_RELATED_STATS,{stream_id:$.uid,stats:_i})})}if(j.has(o1.AUDIO)&&$.audioTrack){const K=function(_i,_o,_u,ch){const _f=_o.audioRecv.find(i_=>i_.ssrc===_i);if(!_f)return null;const o_=KK.isRemoteAudioFreeze(ch);return{mediaType:"audio",isAudioMute:!1,peerId:_u,googJitterReceived:_f.jitterMs.toString(),isFreeze:o_,bytesReceived:_f.bytes.toString(),packetsReceived:_f.packets.toString(),packetsLost:_f.packetsLost.toString(),frameReceived:_f.receivedFrames.toString(),frameDropped:_f.droppedFrames.toString()}}($._audioSSRC,p,$.uid,$.audioTrack);K&&d2(()=>{var _i;null===(_i=this.requestUpload)||void 0===_i||_i.call(this,hR.SUBSCRIBE_RELATED_STATS,{stream_id:$.uid,stats:K})})}})}stopUploadDownlinkStats(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkStatsUploadInterval=void 0,this.downlinkRelatedStatsUploadInterval=void 0)}stopUploadTransportStats(){this.uploadTransportStarted&&(this.uploadTransportStarted=!1,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=void 0)}}var S0e,P1;function R0e(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function dY(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?R0e(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):R0e(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}function O0e(s){var p,A,y,w=2;for("undefined"!=typeof Symbol&&(A=WIe,y=Symbol.iterator);w--;){if(A&&null!=(p=s[A]))return p.call(s);if(y&&null!=(p=s[y]))return new Zye(p.call(s));A="@@asyncIterator",y="@@iterator"}throw new TypeError("Object is not async iterable")}function Zye(s){function p(A){if(Object(A)!==A)return iI.reject(new TypeError(A+" is not an object."));var y=A.done;return iI.resolve(A.value).then(function(w){return{value:w,done:y}})}return(Zye=function(A){this.s=A,this.n=A.next}).prototype={s:null,n:null,next:function(){return p(this.n.apply(this.s,arguments))},return:function(A){var y=this.s.return;return void 0===y?iI.resolve({value:A,done:!0}):p(y.apply(this.s,arguments))},throw:function(A){var y=this.s.return;return void 0===y?iI.reject(A):p(y.apply(this.s,arguments))}},new Zye(s)}let mbe=TR("P2PChannel","store.p2pId")((gI((P1=class extends sS{get state(){return this._state}set state(s){const p=this._state;this._state=s,this.emit(I1.StateChange,p,this._state)}constructor(s,p){var A;super(),A=this,a_(this,"store",void 0),a_(this,"statsUploader",void 0),a_(this,"connection",void 0),a_(this,"localTrackMap",new Map),a_(this,"remoteUserMap",new Map),a_(this,"pendingLocalTracks",[]),a_(this,"pendingRemoteTracks",[]),a_(this,"statsCollector",void 0),a_(this,"isPlanB",!1),a_(this,"iceFailedCount",0),a_(this,"dtlsFailedCount",0),a_(this,"mutex",new iP("P2PChannel-mutex")),a_(this,"_state",EN.Disconnected),a_(this,"handleMuteLocalTrack",function(){var y=f(function*(w,$,j){const _e=yield A.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!A.connection)return void j(new U_(N_.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));S0("debug",A,"handleMuteLocalTrack",w.getTrackId()),yield A.waitTillConnected();const K=A.filterTobeMutedTracks(w);if(0===K.length)return void $();yield A.connection.muteLocal(K.map(_o=>{let[,{id:_u}]=_o;return _u}));const _i=A.createMuteMessage(K);yield wT(A,I1.RequestMuteLocal,_i),$()}catch(K){j(K)}finally{_e()}});return function(w,$,j){return y.apply(this,arguments)}}()),a_(this,"handleUnmuteLocalTrack",function(){var y=f(function*(w,$,j){const _e=yield A.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!A.connection)return void j(new U_(N_.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));S0("debug",A,"handleUnmuteLocalTrack",w.getTrackId()),yield A.waitTillConnected();const K=A.filterTobeUnmutedTracks(w);if(0===K.length)return void $();yield A.connection.unmuteLocal(K.map(_o=>{let[,{id:_u}]=_o;return _u}));const _i=A.createUnmuteMessage(K);yield wT(A,I1.RequestUnmuteLocal,_i),$()}catch(K){j(K)}finally{_e()}});return function(w,$,j){return y.apply(this,arguments)}}()),a_(this,"handleUpdateVideoEncoder",function(){var y=f(function*(w,$,j){const _e=yield A.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const K=A.localTrackMap.get(U0.LocalVideoTrack);if(!A.connection||!K||K.track!==w)return void $();yield A.waitTillConnected();const{id:_i,track:_o}=K;yield A.connection.updateSendParameters(_i,_o),yield A.connection.updateEncoderConfig(_i,_o),A.emit(I1.UpdateVideoEncoder,_o),$()}catch(K){j(K)}finally{_e()}});return function(w,$,j){return y.apply(this,arguments)}}()),a_(this,"handleSetOptimizationMode",function(){var y=f(function*(w,$,j){const _e=yield A.mutex.lock("Locking from P2PChannel.handleSetOptimizationMode");try{const K=A.localTrackMap.get(U0.LocalVideoTrack);if(!A.connection||!K||K.track!==w)return;yield A.waitTillConnected();const{id:_i,track:_o}=K;yield A.connection.updateSendParameters(_i,_o),$()}catch(K){j(K)}finally{_e()}});return function(w,$,j){return y.apply(this,arguments)}}()),a_(this,"handleReplaceTrack",function(){var y=f(function*(w,$,j,_e){let K;h_.debug("P2PChannel handleReplaceTrack for [track-id-".concat(w.getTrackId(),"]")),"boolean"==typeof _e&&_e||(K=yield A.mutex.lock("From P2PChannel.handleReplaceTrack"));try{const _o=Array.from(A.localTrackMap.entries()).find(_u=>{let[,{track:ch}]=_u;return w===ch});if(!A.connection||!_o)return void $();if(yield A.waitTillConnected(),yield A.connection.replaceTrack(w,_o[1].id),A.isPlanB){const _u=_o[1];_u.id=w._mediaStreamTrack.id,A.localTrackMap.set(_o[0],_u)}if(_o[0]===U0.LocalVideoTrack&&bN().supportDualStreamEncoding){const _u=A.localTrackMap.get(U0.LocalVideoLowTrack);if(_u){const ch=w._mediaStreamTrack.clone();_u.track._originMediaStreamTrack.stop(),_u.track._mediaStreamTrack=ch,_u.track._originMediaStreamTrack=ch,yield new iI((_f,o_)=>{A.handleReplaceTrack(_u.track,_f,o_,!0)})}}$()}catch(_o){j(_o)}finally{var _i;null===(_i=K)||void 0===_i||_i()}});return function(w,$,j,_e){return y.apply(this,arguments)}}()),a_(this,"handleGetLocalVideoStats",y=>{y(this.statsCollector.getLocalVideoTrackStats())}),a_(this,"handleGetLocalAudioStats",y=>{y(this.statsCollector.getLocalAudioTrackStats())}),a_(this,"handleGetRemoteVideoStats",y=>this.statsCollector.getRemoteVideoTrackStats(y.uid)[y.uid]),a_(this,"handleGetRemoteAudioStats",y=>this.statsCollector.getRemoteAudioTrackStats(y.uid)[y.uid]),this.store=s,this.statsCollector=p,this.statsCollector.addP2PChannel(this),this.statsUploader=new gbe,this.bindStatsUploaderEvents(),this.isPlanB=!bN().supportUnifiedPlan||v0("CHROME_FORCE_PLAN_B")&&bQ()}startP2PConnection(s){var p=this;return f(function*(){return p.state=EN.New,p.connection=p.isPlanB?new dbe(s,p.store):new fbe(s,p.store),p.bindConnectionEvents(p.connection),p.store.peerConnectionStart(),p.connection.establish()})()}connect(s,p,A,y,w,$){var j=this;return f(function*(){if(!j.connection)throw new U_(N_.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");yield j.connection.connect(s,p,A,y,w,$),j.statsUploader.startUploadTransportStats(),j.state=EN.Connected})()}publish(s,p,A){var y=this;return Ade(function*(){const w=yield GS(y.mutex.lock("From P2PChannel.publish"));try{if(!y.connection){if(y.state===EN.Disconnected)throw new U_(N_.UNEXPECTED_ERROR,"PeerConnection already disconnected.");y.throwIfTrackTypeNotMatch(s);const j=s.filter(_e=>-1===y.pendingLocalTracks.indexOf(_e));return void(y.pendingLocalTracks=y.pendingLocalTracks.concat(j))}y.store.pubId=y.store.pubId+1,WL.markPublishStart(y.store.clientId,y.store.pubId),yield GS(y.waitTillConnected());const $=y.filterTobePublishedTracks(s,p,A);if(0===$.length)return void(yield GS(y.tryToUnmuteAudio(s)));yield*JEe(O0e(y.doPublish(y.connection,$)),GS)}finally{w()}})()}doPublish(s,p){var A=this;return Ade(function*(){p.forEach(_i=>{let{track:_o,type:_u}=_i;const ch=performance.now();A.store.publish(_o.getTrackId(),_u===U0.LocalAudioTrack?"audio":"video",ch)}),A.bindLocalTrackEvents(p);const y=yield GS(s.send(p.map(_i=>{let{track:_o}=_i;return _o}),A.store.codec,A.store.audioCodec)),w=(yield GS(y.next())).value,$=A.createGatewayPublishMessage(p,w);let j;try{j=yield $}catch(_i){throw sI("error",A,"doPublish yield error: ".concat(_i.toString())),y.throw(_i),(null==_i?void 0:_i.code)===N_.WS_ABORT&&p.forEach(_o=>{let{track:_u}=_o;-1===A.pendingLocalTracks.indexOf(_u)&&A.pendingLocalTracks.push(_u)}),A.unbindLocalTrackEvents(p),_i}const _e=A.mapPubResToRemoteConfig($,j);S0("debug",A,"doPublish",{remoteConfigs:_e,tracks:p.map(_i=>{let{track:_o}=_i;return _o.getTrackId()}),pubMsg:$,pubAns:j});const K=(yield GS(y.next(_e))).value;p.forEach(_i=>{let{type:_o}=_i;A.statsCollector.addLocalStats(_o)}),A.assignLocalTracks(p,K),A.statsUploader.startUploadUplinkStats(),p.forEach(_i=>{let{track:_o,type:_u}=_i;const ch=performance.now();A.store.publish(_o.getTrackId(),_u===U0.LocalAudioTrack?"audio":"video",void 0,ch)})})()}publishLowStream(s){var p=this;return Ade(function*(){if(!p.connection)return;S0("debug",p,"publishLowStream",s);const A=yield GS(p.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const w=p.localTrackMap.get(U0.LocalVideoTrack);if(!w)throw new U_(N_.UNEXPECTED_ERROR,"Could not find high stream");if(p.localTrackMap.has(U0.LocalVideoLowTrack))throw new U_(N_.UNEXPECTED_ERROR,"[".concat(p.store.clientId,"] Can't publish low stream when stream already publish"));yield GS(p.waitTillConnected());const $=[{track:p.getLowVideoTrack(w.track,s),type:U0.LocalVideoLowTrack}];if(yield*JEe(O0e(p.doPublish(p.connection,$)),GS),w.track.muted||!w.track.enabled){var y;const j=null===(y=p.localTrackMap.get(U0.LocalVideoLowTrack))||void 0===y?void 0:y.id;void 0!==j&&(yield GS(p.connection.muteLocal([j])))}}finally{A()}})()}republish(){var s=this;return f(function*(){s.pendingLocalTracks.length>0&&(h_.debug("Emit P2PChannelEvents.RequestRePublish to republish tracks."),S0("debug",s,"republish",s.pendingLocalTracks.map(p=>p.getTrackId())),yield ZP(s,I1.RequestRePublish,s.pendingLocalTracks),s.emit(I1.MediaReconnectEnd,s.store.uid),s.pendingLocalTracks=[])})()}reSubscribe(s){var p=this;return f(function*(){S0("debug",p,"reSubscribe",p.pendingRemoteTracks.map(A=>{let{user:y}=A;return y.uid}));for(let A=p.pendingRemoteTracks.length-1;A>=0;A--){const{user:y,kind:w}=p.pendingRemoteTracks[A];(w!==o1.AUDIO||y._audio_added_&&y._audioSSRC)&&(w!==o1.VIDEO||y._video_added_&&y._videoSSRC)||p.pendingRemoteTracks.splice(A,1)}if(s)yield ZP(p,I1.RequestReSubscribe,p.pendingRemoteTracks);else for(const{user:A,kind:y}of p.pendingRemoteTracks)yield p.subscribe(A,y,y===o1.VIDEO?A._videoSSRC:A._audioSSRC);p.pendingRemoteTracks.forEach(A=>{let{user:y}=A;p.emit(I1.MediaReconnectEnd,y.uid)}),p.pendingRemoteTracks=[]})()}unpublish(s){var p=this;return f(function*(){if(!p.connection)return void s.forEach(y=>{const w=p.pendingLocalTracks.indexOf(y);-1!==w&&p.pendingLocalTracks.splice(w,1)});yield p.waitTillConnected();const A=p.filterTobeUnpublishedTracks(s);return 0!==A.length?(S0("debug",p,"unpublish"),p.doUnpublish(p.connection,A)):void 0})()}unpublishLowStream(){var s=this;return f(function*(){if(!s.connection)return;S0("debug",s,"unpublishLowStream");const p=s.localTrackMap.get(U0.LocalVideoLowTrack);return p?(yield s.waitTillConnected(),s.doUnpublish(s.connection,[[U0.LocalVideoLowTrack,p]])):void 0})()}doUnpublish(s,p){var A=this;return f(function*(){const y=A.createGatewayUnpublishMessage(p);return yield s.stopSending(p.map(w=>{let[,{id:$}]=w;return $})),A.withdrawLocalTracks(p),A.unbindLocalTrackEvents(p.map(w=>{let[$,{track:j}]=w;return{type:$,track:j}})),p.forEach(w=>{let[$]=w;A.statsCollector.removeLocalStats($)}),0===A.localTrackMap.size&&A.statsUploader.stopUploadUplinkStats(),y})()}subscribe(s,p,A,y,w){var $=this;return f(function*(){var j;if(!$.connection)throw new U_(N_.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if(S0("debug",$,"subscribe",{uid:s.uid,mediaType:p,ssrcId:A}),null!==(j=$.remoteUserMap.get(s))&&void 0!==j&&j.has(p))return;let _e,K;if(yield $.waitTillConnected(),w){const _u=w.find(_f=>{let{stream_type:o_}=_f;return o_===p});if(!_u)throw new U_(N_.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(p," for user: ").concat(s.uid," because subscribe answer from gateway does not contain stream_type: ").concat(p,"."));const ch=yield $.connection.receive(p,_u.ssrcs,String(s.uid),_u.attributes);_e=ch.track,K=ch.id}else{const _u=yield $.connection.receive(p,[{ssrcId:A,rtx:y}],String(s.uid),void 0);_e=_u.track,K=_u.id}p===o1.AUDIO?(s._audioTrack?s._audioTrack._updateOriginMediaStreamTrack(_e):(s._audioTrack=new Wme(_e,s.uid,s._uintid,$.store),h_.info("[".concat($.store.p2pId,"] create remote audio track: ").concat(s._audioTrack.getTrackId()))),$.bindRemoteTrackEvents(s,s._audioTrack)):(s._videoTrack?s._videoTrack._updateOriginMediaStreamTrack(_e):(s._videoTrack=new qme(_e,s.uid,s._uintid,$.store),h_.info("[".concat($.store.p2pId,"] create remote video track: ").concat(s._videoTrack.getTrackId()))),$.bindRemoteTrackEvents(s,s._videoTrack));const _i=$.remoteUserMap.get(s);_i?_i.set(p,K):$.remoteUserMap.set(s,new Map([[p,K]])),$.statsCollector.addRemoteStats(s.uid),$.statsUploader.startUploadDownlinkStats();const _o=$.pendingRemoteTracks.findIndex(_u=>{let{user:ch,kind:_f}=_u;return ch.uid===s.uid&&p===_f});-1!==_o&&($.pendingRemoteTracks.splice(_o,1),$.emit(I1.MediaReconnectEnd,s.uid))})()}massSubscribe(s){var p=this;return f(function*(){return p.massSubscribeNoLock(s)})()}massSubscribeNoLock(s){var p=this;return f(function*(){if(!p.connection)throw new U_(N_.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");S0("debug",p,"subscribeAll",s.map(y=>{let{user:w,mediaType:$,ssrcId:j}=y;return{uid:w.uid,mediaType:$,ssrcId:j}})),s=s.filter(y=>{var w;let{user:$,mediaType:j}=y;return!(null!==(w=p.remoteUserMap.get($))&&void 0!==w&&w.has(j))}),yield p.waitTillConnected();const A=yield p.connection.batchReceive(s.map(y=>{let{user:w,mediaType:$,ssrcId:j,rtxSsrcId:_e}=y;return{kind:$,ssrcMsg:[{ssrcId:j,rtx:_e}],mslabel:String(w.uid)}}));s.forEach((y,w)=>{let{user:$,mediaType:j}=y;const{track:_e,id:K}=A[w];j===o1.AUDIO?($._audioTrack?$._audioTrack._updateOriginMediaStreamTrack(_e):($._audioTrack=new Wme(_e,$.uid,$._uintid,p.store),h_.info("[".concat(p.store.p2pId,"] create remote audio track: ").concat($._audioTrack.getTrackId()))),p.bindRemoteTrackEvents($,$._audioTrack)):($._videoTrack?$._videoTrack._updateOriginMediaStreamTrack(_e):($._videoTrack=new qme(_e,$.uid,$._uintid,p.store),h_.info("[".concat(p.store.p2pId,"] create remote video track: ").concat($._videoTrack.getTrackId()))),p.bindRemoteTrackEvents($,$._videoTrack));const _i=p.remoteUserMap.get($);_i?_i.set(j,K):p.remoteUserMap.set($,new Map([[j,K]])),p.statsCollector.addRemoteStats($.uid),p.statsUploader.startUploadDownlinkStats();const _o=p.pendingRemoteTracks.findIndex(_u=>{let{user:ch,kind:_f}=_u;return ch.uid===$.uid&&j===_f});-1!==_o&&(p.pendingRemoteTracks.splice(_o,1),p.emit(I1.MediaReconnectEnd,$.uid))})})()}unsubscribe(s,p){var A=this;return f(function*(){const y=A.pendingRemoteTracks.filter(j=>{let{user:_e,kind:K}=j;return void 0!==p?_e.uid===s.uid&&p===K:_e.uid===s.uid});if(y.forEach(j=>{const _e=A.pendingRemoteTracks.indexOf(j);A.pendingRemoteTracks.splice(_e,1)}),!A.connection)return void y.forEach(j=>{let{kind:_e}=j;var K;if(_e===o1.AUDIO)null===(K=s._audioTrack)||void 0===K||K._destroy(),s._audioTrack=void 0;else if(_e===o1.VIDEO){var _i;null===(_i=s._videoTrack)||void 0===_i||_i._destroy(),s._videoTrack=void 0}});S0("debug",A,"unsubscribe",{uid:s.uid,mediaType:p});const w=A.filterTobeUnSubscribedTracks(s,p);if(0===w.length)return;yield A.connection.stopReceiving(w.map(j=>{let[,{id:_e}]=j;return _e}));const $=A.createUnsubscribeMessage(w);return A.withdrawRemoteTracks(w),0===A.remoteUserMap.size&&A.statsUploader.stopUploadDownlinkStats(),w.forEach(j=>{let[_e,{kind:K}]=j;var _i,_o;if(K===o1.VIDEO&&_e._videoSSRC&&(null===(_i=A.connection)||void 0===_i||_i.setStatsRemoteVideoIsReady(_e._videoSSRC,!1)),K===o1.VIDEO)A.unbindRemoteTrackEvents(_e._videoTrack),null===(_o=_e._videoTrack)||void 0===_o||_o._destroy(),_e._videoTrack=void 0;else if(K===o1.AUDIO){var _u;A.unbindRemoteTrackEvents(_e._audioTrack),null===(_u=_e._audioTrack)||void 0===_u||_u._destroy(),_e._audioTrack=void 0}}),$})()}massUnsubscribe(s){var p=this;return f(function*(){return p.massUnsubscribeNoLock(s)})()}massUnsubscribeNoLock(s){var p=this;return f(function*(){let A=[];for(const{user:$,mediaType:j}of s){const _e=p.pendingRemoteTracks.filter(K=>{let{user:_i,kind:_o}=K;return void 0!==j?_i.uid===$.uid&&j===_o:_i.uid===$.uid});_e.forEach(K=>{const _i=p.pendingRemoteTracks.indexOf(K);p.pendingRemoteTracks.splice(_i,1)}),A=A.concat(_e)}if(!p.connection)return void A.forEach($=>{let{user:j,kind:_e}=$;var K;if(_e===o1.AUDIO)null===(K=j._audioTrack)||void 0===K||K._destroy(),j._audioTrack=void 0;else if(_e===o1.VIDEO){var _i;null===(_i=j._videoTrack)||void 0===_i||_i._destroy(),j._videoTrack=void 0}});S0("debug",p,"batchUnsubscribe",s.map($=>{let{user:j,mediaType:_e}=$;return{uid:j.uid,mediaType:_e}}));const y=qP(s).call(s,($,j)=>{let{user:_e,mediaType:K}=j;const _i=p.filterTobeUnSubscribedTracks(_e,K);return $.concat(_i)},[]);if(0===y.length)return;yield p.connection.stopReceiving(y.map($=>{let[,{id:j}]=$;return j}));const w=p.createUnsubscribeAllMessage(y);return p.withdrawRemoteTracks(y),0===p.remoteUserMap.size&&p.statsUploader.stopUploadDownlinkStats(),y.forEach($=>{let[j,{kind:_e}]=$;var K,_i;if(_e===o1.VIDEO&&j._videoSSRC&&(null===(K=p.connection)||void 0===K||K.setStatsRemoteVideoIsReady(j._videoSSRC,!1)),_e===o1.VIDEO)p.unbindRemoteTrackEvents(j._videoTrack),null===(_i=j._videoTrack)||void 0===_i||_i._destroy(),j._videoTrack=void 0;else if(_e===o1.AUDIO){var _o;p.unbindRemoteTrackEvents(j._audioTrack),null===(_o=j._audioTrack)||void 0===_o||_o._destroy(),j._audioTrack=void 0}}),w})()}muteRemote(s,p){var A=this;return f(function*(){if(!A.connection)return;S0("debug",A,"muteRemote",{uid:s.uid,kind:p});const y=A.remoteUserMap.get(s);if(!y)return h_.warning("P2PChannel.muteRemote has no remote user ".concat(s.uid,".")),void sI("warning",A,"P2PChannel.muteRemote has no remote user ".concat(s.uid,"."));if(!y.get(p))return h_.warning("P2PChannel.muteRemote has no remote user ".concat(s.uid," media type ").concat(p,".")),void sI("warning",A,"P2PChannel.muteRemote has no remote user ".concat(s.uid," media type ").concat(p,"."));const w=p===o1.VIDEO?s._videoSSRC:s._audioSSRC;void 0!==w&&A.connection.setStatsRemoteVideoIsReady(w,!1)})()}unmuteRemote(s,p){var A=this;return f(function*(){return A.unmuteRemoteNoLock(s,p)})()}unmuteRemoteNoLock(s,p){var A=this;return f(function*(){if(!A.connection)return;S0("debug",A,"unmuteRemote",{uid:s.uid,kind:p});const y=A.remoteUserMap.get(s);return y?y.get(p)?void 0:(h_.warning("P2PChannel.unmuteRemote has no remote user ".concat(s.uid," media type ").concat(p,".")),void sI("warning",A,"unmuteRemote has no remote user ".concat(s.uid," media type ").concat(p))):(h_.warning("P2PChannel.unmuteRemote has no remote user ".concat(s.uid,".")),void sI("warning",A,"unmuteRemote has no remote user ".concat(s.uid)))})()}getAllTracks(s){const p=this.localTrackMap.get(U0.LocalAudioTrack);if((null==p?void 0:p.track)instanceof cP){const A=p.track;return Array.from(this.localTrackMap.entries()).filter(y=>{let[w]=y;return w!==U0.LocalAudioTrack}).filter(y=>{let[w]=y;return!(s&&w===U0.LocalVideoLowTrack)}).map(y=>{let[,{track:w}]=y;return w}).concat(A.trackList)}return Array.from(this.localTrackMap.entries()).filter(A=>{let[y]=A;return!(s&&y===U0.LocalVideoLowTrack)}).map(A=>{let[,{track:y}]=A;return y})}reportPublishEvent(s,p,A,y,w){if(s){const j=this.localTrackMap.get(U0.LocalAudioTrack),_e=this.localTrackMap.get(y?U0.LocalVideoLowTrack:U0.LocalVideoTrack);w0.publish(this.store.sessionId,{eventElapse:WL.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:s,ec:p,audioName:null==j?void 0:j.track.getTrackLabel(),videoName:null==_e?void 0:_e.track.getTrackLabel(),screenshare:-1!==(null==_e?void 0:_e.track._hints.indexOf(DR.SCREEN_TRACK)),audio:!!j,video:!!_e,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:w})}else{var $;A||(A=[]);const j=A.find(K=>K instanceof cO),_e=y?null===($=this.localTrackMap.get(U0.LocalVideoTrack))||void 0===$?void 0:$.track:A.find(K=>K instanceof yS);w0.publish(this.store.sessionId,{eventElapse:WL.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:s,ec:p,audioName:null==j?void 0:j.getTrackLabel(),videoName:null==_e?void 0:_e.getTrackLabel(),screenshare:-1!==(null==_e?void 0:_e._hints.indexOf(DR.SCREEN_TRACK)),audio:!!j,video:!!_e,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:w})}}reportSubscribeEvent(s,p,A,y){const w=y===o1.VIDEO?A._videoSSRC:A._audioSSRC;w&&w0.subscribe(this.store.sessionId,{succ:s,ec:p,video:y===o1.VIDEO,audio:y===o1.AUDIO,peerid:A.uid,subscribeRequestid:y===o1.VIDEO?A._videoSSRC:A._audioSSRC,p2pid:this.store.p2pId,eventElapse:WL.measureFromSubscribeStart(this.store.clientId,w)})}reset(){h_.debug("P2PChannel.reset"),this.mutex=new iP("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.state=EN.Disconnected}getStats(){var s;return null===(s=this.connection)||void 0===s?void 0:s.getStats()}getRemoteVideoIsReady(s){var p;return(null===(p=this.connection)||void 0===p?void 0:p.getRemoteVideoIsReady(s))||!1}getLocalAudioVolume(){const s=this.localTrackMap.get(U0.LocalAudioTrack);if(s)return s.track.getVolumeLevel()}getLocalVideoSize(){const s=this.localTrackMap.get(U0.LocalVideoTrack);if(s)return{width:s.track._videoWidth||0,height:s.track._videoHeight||0}}getEncoderConfig(s){const p=this.localTrackMap.get(s);return p&&p.track instanceof yS||p&&p.track instanceof cO?p.track._encoderConfig:void 0}getLocalMedia(s){return this.localTrackMap.get(s)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(s,p){if(!s)return this.remoteUserMap.size>0;const A=this.remoteUserMap.get(s);return!!A&&(!p||A.has(p))}hasRemoteMediaWithLock(s,p){var A=this;return f(function*(){if(!s)return A.remoteUserMap.size>0;const y=A.remoteUserMap.get(s);return!!y&&(!p||y.has(p))})()}getRemoteMedia(s){var p;const A=Array.from($P(p=this.remoteUserMap).call(p)).find(y=>y.uid===s);return A?{audioTrack:A.audioTrack,audioSSRC:A._audioSSRC,videoTrack:A.videoTrack,videoSSRC:A._videoSSRC}:{}}getAudioLevels(){let s=Array.from(this.remoteUserMap.entries()).map(A=>{let[y]=A;return{uid:y.uid,level:y.audioTrack?100*y.audioTrack._source.getAccurateVolumeLevel():0}});const p=this.localTrackMap.get(U0.LocalAudioTrack);return p&&s.push({level:100*p.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),s=gre(s).call(s,(A,y)=>A.level-y.level),s}disconnectForReconnect(){var s=this;return f(function*(){s.connection&&(S0("debug",s,"disconnectForReconnect"),h_.debug("P2PChannel.disconnectForReconnect closing P2PConnection"),s.state=EN.Reconnecting,s.connection.close(),s.unbindConnectionEvents(s.connection),s.connection=void 0,0!==s.localTrackMap.size&&(Array.from(s.localTrackMap.entries()).forEach(p=>{let[A,{track:y}]=p;switch(A){case U0.LocalVideoTrack:y._hints.includes(DR.LOW_STREAM)?y.close():s.pendingLocalTracks.push(y);break;case U0.LocalAudioTrack:y instanceof cP?s.pendingLocalTracks=s.pendingLocalTracks.concat(y.trackList):s.pendingLocalTracks.push(y)}}),s.emit(I1.MediaReconnectStart,s.store.uid)),s.unbindLocalTrackEvents(),s.localTrackMap.clear(),0!==s.remoteUserMap.size&&Array.from(s.remoteUserMap.entries()).forEach(p=>{let[A,y]=p;Array.from($P(y).call(y)).forEach(w=>{s.setPendingRemoteMedia(A,w)}),s.emit(I1.MediaReconnectStart,A.uid)}),s.unbindAllRemoteTrackEvents(),s.remoteUserMap.clear(),s.statsUploader.stopUploadUplinkStats(),s.statsUploader.stopUploadDownlinkStats(),s.statsUploader.stopUploadTransportStats(),h_.debug("P2PChannel disconnected, waiting to reconnect."))})()}hasPendingRemoteMedia(s,p){for(const A of this.pendingRemoteTracks){const{user:y,kind:w}=A;if((s instanceof Rye?s.uid:s)===y.uid&&p===w)return!0}return!1}setPendingRemoteMedia(s,p){this.hasPendingRemoteMedia(s,p)||this.pendingRemoteTracks.push({user:s,kind:p})}reEstablish(){var s=this;return f(function*(){if(s.connection)return s.connection.reEstablish()})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const s=this.connection.getStats(),p=this.localTrackMap.get(U0.LocalVideoTrack),A=this.localTrackMap.get(U0.LocalAudioTrack),y=s.videoSend.find(_f=>_f.ssrc===(null==p?void 0:p.ssrcs[0].ssrcId)),w=s.audioSend.find(_f=>_f.ssrc===(null==A?void 0:A.ssrcs[0].ssrcId));if(!y||!w)return 1;const $=o3(this,I1.NeedSignalRTT),j=y?y.rttMs:void 0,_e=w?w.rttMs:void 0,K=j&&_e?(j+_e)/2:j||_e,_o=100*s.sendPacketLossRate*.7/50+.3*((K&&$?(K+$)/2:K||$)||0)/1500,_u=_o<.17?1:_o<.36?2:_o<.59?3:_o<.1?4:5,ch=null==p?void 0:p.track;if(ch&&ch._encoderConfig&&-1===ch._hints.indexOf(DR.SCREEN_TRACK)){const _f=ch._encoderConfig.bitrateMax,o_=s.bitrate.actualEncoded;if(_f&&o_){const i_=(1e3*_f-o_)/(1e3*_f);return Sfe[i_<.15?0:i_<.3?1:i_<.45?2:i_<.6?3:4][_u]}}return _u}getDownlinkNetworkQuality(){if(!this.connection)return 0;const s=this.connection.getStats();let p=0;return Array.from(this.remoteUserMap.entries()).forEach(A=>{let[y]=A;const w=y._audioSSRC,$=y._videoSSRC,j=s.audioRecv.find(o_=>o_.ssrc===w),_e=s.videoRecv.find(o_=>o_.ssrc===$);if(!j&&!_e)return void(p+=1);const K=o3(this,I1.NeedSignalRTT),_i=s.rtt,_o=(_i&&K?(_i+K)/2:_i||K)||0,_u=j?j.jitterMs:void 0,ch=s.recvPacketLossRate;let _f=.7*ch*100/50+.3*_o/1500;_u&&(_f=.6*ch*100/50+.2*_o/1500+.2*_u/400),p+=_f<.1?1:_f<.17?2:_f<.36?3:_f<.59?4:5}),this.remoteUserMap.size>0?Math.round(p/this.remoteUserMap.size):p}muteLocalTrack(s){var p=this;return f(function*(){return new iI((A,y)=>{p.handleMuteLocalTrack(s,A,y)})})()}filterTobePublishedTracks(s,p,A){const y=[],w=bN(),$=this.getAllTracks();s=gie(s=s.filter(K=>-1===$.indexOf(K)));let j=!1,_e=!1;for(const K of s){if(K instanceof yS&&(this.localTrackMap.has(U0.LocalVideoTrack)||j?new U_(N_.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(y.push({track:K,type:U0.LocalVideoTrack}),j=!0),p)){const _i=this.getLowVideoTrack(K,A);y.push({track:_i,type:U0.LocalVideoLowTrack})}if(K instanceof cO){const _i=this.localTrackMap.get(U0.LocalAudioTrack);if(_i){if(!(_i.track instanceof cP))throw new U_(N_.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(K._bypassWebAudio)throw new U_(N_.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");_i.track.addAudioTrack(K),this.bindLocalAudioTrackEvents(K,!0)}else if(_e){const _o=y.find(_u=>{let{type:ch}=_u;return ch===U0.LocalAudioTrack});if(!(_o.track instanceof cP))throw new U_(N_.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(K._bypassWebAudio)throw new U_(N_.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");_o.track.addAudioTrack(K)}else{if(!w.webAudioMediaStreamDest||K instanceof cP||K._bypassWebAudio)y.push({track:K,type:U0.LocalAudioTrack});else{const _o=new cP;_o.addAudioTrack(K),y.push({track:_o,type:U0.LocalAudioTrack})}_e=!0}}}return y}filterTobeUnpublishedTracks(s){const p=[],A=this.getAllTracks();s=gie(s=s.filter(y=>-1!==A.indexOf(y)));for(const y of s){if(y instanceof cO){const w=this.localTrackMap.get(U0.LocalAudioTrack);if(!w)continue;w.track instanceof cP?(w.track.removeAudioTrack(y),this.unbindLocalAudioTrackEvents(y),0===w.track.trackList.length&&(p.push([U0.LocalAudioTrack,w]),w.track.close())):p.push([U0.LocalAudioTrack,w])}if(y instanceof yS){const w=this.localTrackMap.get(U0.LocalVideoTrack);if(!w)continue;p.push([U0.LocalVideoTrack,w]);const $=this.localTrackMap.get(U0.LocalVideoLowTrack);$&&p.push([U0.LocalVideoLowTrack,$])}}return p}bindLocalTrackEvents(s){s.forEach(p=>{let{track:A,type:y}=p;switch(y){case U0.LocalVideoTrack:A.addListener(mI.GET_STATS,this.handleGetLocalVideoStats),A.addListener(mI.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),A.addListener(mI.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),A.addListener(mI.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),A.addListener(mI.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),A.addListener(mI.NEED_REPLACE_TRACK,this.handleReplaceTrack),A.addListener(mI.NEED_MUTE_TRACK,this.handleMuteLocalTrack),A.addListener(mI.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case U0.LocalAudioTrack:this.bindLocalAudioTrackEvents(A)}})}bindLocalAudioTrackEvents(s,p){s instanceof cP?s.trackList.forEach(A=>{A.addListener(mI.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),A.addListener(mI.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),A.addListener(mI.GET_STATS,this.handleGetLocalAudioStats),A.addListener(mI.NEED_MUTE_TRACK,this.handleMuteLocalTrack),A.addListener(mI.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(s.addListener(mI.GET_STATS,this.handleGetLocalAudioStats),s.addListener(mI.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(mI.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(mI.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(mI.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),p||s.addListener(mI.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(s){s||(s=Array.from(this.localTrackMap.entries()).map(p=>{let[A,{track:y}]=p;return{track:y,type:A}})),s.forEach(p=>{let{track:A,type:y}=p;switch(y){case U0.LocalVideoTrack:A.off(mI.GET_STATS,this.handleGetLocalVideoStats),A.off(mI.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),A.off(mI.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),A.off(mI.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),A.off(mI.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),A.off(mI.NEED_REPLACE_TRACK,this.handleReplaceTrack),A.off(mI.NEED_MUTE_TRACK,this.handleMuteLocalTrack),A.off(mI.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case U0.LocalAudioTrack:this.unbindLocalAudioTrackEvents(A)}})}unbindLocalAudioTrackEvents(s){s instanceof cP?s.trackList.forEach(p=>{p.off(mI.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),p.off(mI.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),p.off(mI.GET_STATS,this.handleGetLocalAudioStats),p.off(mI.NEED_MUTE_TRACK,this.handleMuteLocalTrack),p.off(mI.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(s.off(mI.GET_STATS,this.handleGetLocalAudioStats),s.off(mI.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.off(mI.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.off(mI.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.off(mI.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.off(mI.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(s,p){p instanceof qme&&p.addListener(mI.GET_STATS,A=>{A(this.handleGetRemoteVideoStats(s))}),p instanceof Wme&&p.addListener(mI.GET_STATS,A=>{A(this.handleGetRemoteAudioStats(s))})}unbindRemoteTrackEvents(s){s&&s.removeAllListeners(mI.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(s=>{let[p,A]=s;A.has(o1.AUDIO)&&this.unbindRemoteTrackEvents(p._audioTrack),A.has(o1.VIDEO)&&this.unbindRemoteTrackEvents(p._videoTrack)})}createGatewayPublishMessage(s,p){return s.map((A,y)=>{let w,$,{track:j,type:_e}=A;switch(_e){case U0.LocalAudioTrack:w=KT.Audio,$={dtx:j instanceof JQ&&j._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case U0.LocalVideoTrack:w=j._hints.includes(DR.SCREEN_TRACK)?KT.Screen:KT.High,$=dY(dY({},dX(j)),{},{codec:this.store.codec});break;case U0.LocalVideoLowTrack:w=KT.Low,$=dY(dY({},dX(j)),{},{codec:this.store.codec})}return{stream_type:w,attributes:$,ssrcs:p[y]}})}createGatewayUnpublishMessage(s){return s.map(p=>{let A,[y,{track:w,ssrcs:$,id:j}]=p;switch(y){case U0.LocalVideoTrack:A=w._hints.includes(DR.SCREEN_TRACK)?KT.Screen:KT.High;break;case U0.LocalAudioTrack:A=KT.Audio;break;case U0.LocalVideoLowTrack:A=KT.Low}return{stream_type:A,ssrcs:$,mid:j}})}assignLocalTracks(s,p){s.forEach((A,y)=>{let{track:w,type:$}=A;this.localTrackMap.set($,{track:w,id:p[y].id,ssrcs:p[y].localSSRC})})}withdrawLocalTracks(s){s.forEach(p=>{let[A]=p;this.localTrackMap.delete(A)})}waitTillConnected(){var s=this;return f(function*(){return new iI((p,A)=>{switch(s.state){case EN.New:case EN.Reconnecting:{const y=(w,$)=>$===EN.Disconnected?(s.off(I1.StateChange,y),void A(new U_(N_.UNEXPECTED_ERROR,"PeerConnection already disconnected."))):$===EN.Connected?(s.off(I1.StateChange,y),void p(void 0)):void 0;s.on(I1.StateChange,y);break}case EN.Connected:p(void 0);break;case EN.Disconnected:A(new U_(N_.UNEXPECTED_ERROR,"PeerConnection already disconnected."))}})})()}bindConnectionEvents(s){var p=this;s.onConnectionStateChange=function(){var A=f(function*(y){h_.info("[p2pId: ".concat(p.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(y,")")),lT("info",p,"connectionStateChange",y),p.emit(I1.PeerConnectionStateChange,y),"connected"!==y||p.store.keyMetrics.peerConnectionEnd||p.store.peerConnectionEnd(),"failed"===y&&("failed"===s.iceConnectionState?(setTimeout(()=>p.emit(I1.P2PLost),0),p.iceFailedCount+=1,yield pR(ere(p.iceFailedCount,pS)),p.emit(I1.RequestRestartICE)):yield p.requestReconnect())});return function(y){return A.apply(this,arguments)}}(),s.onICEConnectionStateChange=A=>{h_.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(A,")")),lT("info",this,"iceConnectionStateChange",A),w0.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:A,tag:lI.TRACER}).onSuccess(),this.emit(I1.IceConnectionStateChange,A)},s.onICETransportStateChange=A=>{h_.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(A,")")),lT("info",this,"ICETransportStateChange",A)},s.onDTLSTransportStateChange=A=>{h_.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(A,")")),lT("info",this,"DTLSTransportStateChange",A)},s.onDTLSTransportError=A=>{h_.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(A,")")),lT("info",this,"DTLSTransportError",A)},s.onFirstAudioDecoded=A=>{var y;const w=Array.from($P(y=this.remoteUserMap).call(y)).find(j=>j._audioSSRC===A);var $;w&&(null===($=w.audioTrack)||void 0===$||$.emit(j8.FIRST_FRAME_DECODED),w0.firstRemoteFrame(this.store.sessionId,oO.FIRST_AUDIO_DECODE,gT.FIRST_AUDIO_DECODE,{peer:w._uintid,subscribeElapse:WL.measureFromSubscribeStart(this.store.clientId,A),subscribeRequestid:A,p2pid:this.store.p2pId}))},s.onFirstAudioReceived=A=>{var y;const w=Array.from($P(y=this.remoteUserMap).call(y)).find($=>$._audioSSRC===A);w&&w0.firstRemoteFrame(this.store.sessionId,oO.FIRST_AUDIO_RECEIVED,gT.FIRST_AUDIO_RECEIVED,{peer:w._uintid,subscribeElapse:WL.measureFromSubscribeStart(this.store.clientId,A),subscribeRequestid:A,p2pid:this.store.p2pId})},s.onFirstVideoDecoded=(A,y,w)=>{var $;const j=Array.from($P($=this.remoteUserMap).call($)).find(_e=>_e._videoSSRC===A);j&&w0.firstRemoteFrame(this.store.sessionId,oO.FIRST_VIDEO_DECODE,gT.FIRST_VIDEO_DECODE,{peer:j._uintid,videowidth:y,videoheight:w,subscribeElapse:WL.measureFromSubscribeStart(this.store.clientId,A),subscribeRequestid:A,p2pid:this.store.p2pId})},s.onFirstVideoReceived=A=>{var y;const w=Array.from($P(y=this.remoteUserMap).call(y)).find($=>$._videoSSRC===A);w&&w0.firstRemoteFrame(this.store.sessionId,oO.FIRST_VIDEO_RECEIVED,gT.FIRST_VIDEO_RECEIVED,{peer:w._uintid,subscribeElapse:WL.measureFromSubscribeStart(this.store.clientId,A),subscribeRequestid:A,p2pid:this.store.p2pId})},s.onSelectedLocalCandidateChanged=(A,y)=>{const w="relay"===A.candidateType;"unknown"!==y.candidateType&&w===("relay"===y.candidateType)||this.emit(I1.ConnectionTypeChange,w),h_.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(tG(y))," -> ").concat(JSON.stringify(tG(A)),")")),lT("info",this,"SelectedLocalCandidateChanged","".concat(JSON.stringify(tG(y))," -> ").concat(JSON.stringify(tG(A))))},s.onSelectedRemoteCandidateChanged=(A,y)=>{h_.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(tG(y))," -> ").concat(JSON.stringify(tG(A)),")")),lT("info",this,"SelectedRemoteCandidateChanged","".concat(JSON.stringify(tG(y))," -> ").concat(JSON.stringify(tG(A))))}}unbindConnectionEvents(s){s.onConnectionStateChange=void 0,s.onICEConnectionStateChange=void 0,s.onICETransportStateChange=void 0,s.onDTLSTransportStateChange=void 0,s.onDTLSTransportError=void 0,s.onFirstAudioDecoded=void 0,s.onFirstAudioReceived=void 0,s.onFirstVideoDecoded=void 0,s.onFirstVideoReceived=void 0,s.onSelectedLocalCandidateChanged=void 0,s.onSelectedRemoteCandidateChanged=void 0}filterTobeMutedTracks(s){const p=[];if(-1===this.getAllTracks().indexOf(s))return p;const A=this.localTrackMap.get(U0.LocalAudioTrack);if(s instanceof cO&&(null==A?void 0:A.track)instanceof cP)return A.track.isActive||p.push([U0.LocalAudioTrack,A]),p;const y=Array.from(this.localTrackMap.entries()).find(w=>{let[,{track:$}]=w;return s===$});if(y&&(p.push(y),y[0]===U0.LocalVideoTrack)){const w=this.localTrackMap.get(U0.LocalVideoLowTrack);w&&p.push([U0.LocalVideoLowTrack,w])}return p}filterTobeUnmutedTracks(s){const p=[],A=this.localTrackMap.get(U0.LocalAudioTrack);if(s instanceof cO&&(null==A?void 0:A.track)instanceof cP)return A.track.isActive&&p.push([U0.LocalAudioTrack,A]),p;const y=Array.from(this.localTrackMap.entries()).find(w=>{let[,{track:$}]=w;return s===$});if(y)if(y[0]===U0.LocalVideoTrack){p.push(y);const w=this.localTrackMap.get(U0.LocalVideoLowTrack);w&&p.push([U0.LocalVideoLowTrack,w])}else p.push(y);return p}createMuteMessage(s){return s.map(p=>{let A,[y,{track:w,ssrcs:$,id:j}]=p;switch(y){case U0.LocalAudioTrack:A=KT.Audio;break;case U0.LocalVideoTrack:A=w._hints.includes(DR.SCREEN_TRACK)?KT.Screen:KT.High;break;case U0.LocalVideoLowTrack:A=KT.Low}return{stream_type:A,ssrcs:$,mid:j}})}createUnmuteMessage(s){return s.map(p=>{let A,[y,{track:w,ssrcs:$,id:j}]=p;switch(y){case U0.LocalAudioTrack:A=KT.Audio;break;case U0.LocalVideoTrack:A=w._hints.includes(DR.SCREEN_TRACK)?KT.Screen:KT.High;break;case U0.LocalVideoLowTrack:A=KT.Low}return{stream_type:A,ssrcs:$,mid:j}})}filterTobeUnSubscribedTracks(s,p){const A=[],y=this.remoteUserMap.get(s);if(!y)return A;if(p){const w=y.get(p);if(!w)return A;A.push([s,{kind:p,id:w}])}else Array.from(y.entries()).forEach(w=>{let[$,j]=w;A.push([s,{kind:$,id:j}])});return A}createUnsubscribeMessage(s){const p=[];return s.forEach(A=>{let[y,{kind:w}]=A;switch(w){case o1.VIDEO:return void(y._videoSSRC&&p.push({stream_type:o1.VIDEO,ssrcId:y._videoSSRC}));case o1.AUDIO:return void(y._audioSSRC&&p.push({stream_type:o1.AUDIO,ssrcId:y._audioSSRC}))}}),p}createUnsubscribeAllMessage(s){const p=new Map;return s.forEach(A=>{let[y,{kind:w}]=A;if(p.has(y)){let $=p.get(y);$|=w===o1.VIDEO?dT.Video:dT.Audio,p.set(y,$)}else p.set(y,w===o1.VIDEO?dT.Video:dT.Audio)}),{users:Array.from(p.entries()).map(A=>{let[y,w]=A;return{stream_id:y.uid,stream_type:w}})}}withdrawRemoteTracks(s){s.forEach(p=>{let[A,{kind:y}]=p;const w=this.remoteUserMap.get(A);w&&(w.delete(y),0===Array.from(w.entries()).length&&this.remoteUserMap.delete(A))})}updateBitrateLimit(s){var p=this;return f(function*(){const A=p.localTrackMap.get(U0.LocalVideoTrack),y=p.localTrackMap.get(U0.LocalVideoLowTrack);A&&(yield A.track.setBitrateLimit(s.uplink)),y&&s.low_stream_uplink&&(yield y.track.setBitrateLimit({max_bitrate:s.low_stream_uplink.bitrate,min_bitrate:s.low_stream_uplink.bitrate||0}))})()}isP2PDisconnected(){return!this.connection||"connected"!==this.connection.peerConnectionState}mapPubResToRemoteConfig(s,p){return s.map((A,y)=>{var w;let{stream_type:$}=A;return null===(w=p.find(j=>{let{stream_type:_e}=j;return $===_e}))||void 0===w?void 0:w.attributes})}tryToUnmuteAudio(s){var p=this;return f(function*(){for(let y=0;y<s.length;y++)if(s[y]instanceof cO){var A;const w=p.filterTobeUnmutedTracks(s[y]);if(0===w.length)continue;yield null===(A=p.connection)||void 0===A?void 0:A.unmuteLocal(w.map(j=>{let[,{id:_e}]=j;return _e}));const $=p.createUnmuteMessage(w);return void(yield wT(p,I1.RequestUnmuteLocal,$))}})()}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=s=>{var p;return!(null===(p=this.connection)||void 0===p||!p.getRemoteVideoIsReady(s))},this.statsUploader.requestUpload=(s,p)=>this.emit(I1.RequestUploadStats,s,p),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}requestReconnect(){var s=this;return f(function*(){s.dtlsFailedCount+=1,yield pR(ere(s.dtlsFailedCount,pS)),s.emit(I1.RequestReconnect)})()}reconnectP2P(){var s=this;return f(function*(){const p=Array.from(s.localTrackMap.entries()),A=s.createGatewayUnpublishMessage(p);Array.from(s.remoteUserMap.entries()),A.length>0&&(yield ZP(s,I1.RequestUnpublishForReconnectPC,A)),s.disconnectForReconnect(),s.emit(I1.RequestReconnectPC)})()}canPublishLowStream(){return this.localTrackMap.has(U0.LocalVideoTrack)||this.pendingLocalTracks.some(s=>s instanceof yS)}throwIfTrackTypeNotMatch(s){if(s.filter(p=>p instanceof yS).length>1)throw new U_(N_.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(s.filter(p=>p instanceof cO).length>1&&(s.some(p=>p instanceof cO&&p._bypassWebAudio)||!bN().webAudioMediaStreamDest))throw new U_(N_.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const p of s){if(p instanceof yS&&this.pendingLocalTracks.some(A=>A instanceof yS))throw new U_(N_.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(p instanceof cO&&this.pendingLocalTracks.some(A=>A instanceof cO)&&(!bN().webAudioMediaStreamDest||p._bypassWebAudio||this.pendingLocalTracks.some(A=>A instanceof cO&&A._bypassWebAudio)))throw new U_(N_.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(s,p){const A=bN().supportDualStreamEncoding,y=dY(dY({},{width:160,height:120,framerate:15,bitrate:50}),p);let w;w=A?s._mediaStreamTrack.clone():function pbe(s,p){let A=document.createElement("video"),y=document.createElement("canvas");A.setAttribute("style","display:none"),y.setAttribute("style","display:none"),A.setAttribute("muted",""),A.muted=!0,A.setAttribute("autoplay",""),A.autoplay=!0,A.setAttribute("playsinline",""),y.width=jM(p.width),y.height=jM(p.height);const w=jM(p.framerate||15);document.body.append(A),document.body.append(y);let $=s._mediaStreamTrack;A.srcObject=new MediaStream([$]),A.play();const j=y.getContext("2d");if(!j)throw new U_(N_.UNEXPECTED_ERROR,"can not get canvas context");const _e=bN(),K=y.captureStream(_e.supportRequestFrame?0:w).getVideoTracks()[0],_i=QK(()=>(()=>{if(A.paused&&A.play(),A.videoHeight>2&&A.videoWidth>2){const _f=y.width*(A.videoHeight/A.videoWidth);Math.abs(_f-y.height)>=2&&(h_.debug("adjust low stream resolution","".concat(y.width,"x").concat(y.height," -> ").concat(y.width,"x").concat(_f)),y.height=_f)}j.drawImage(A,0,0,y.width,y.height),K.requestFrame&&K.requestFrame(),$!==s._mediaStreamTrack&&($=s._mediaStreamTrack,A.srcObject=new MediaStream([$]))})(),w),_o=K.stop;return K.stop=()=>{_o.call(K),_i(),A.remove(),y.width=0,y.remove(),y=null,A=null,h_.debug("clean low stream renderer")},K}(s,y);const $=new yS(w,dY(dY({},A&&{scaleResolutionDownBy:pge(y,s)}),{},{frameRate:y.framerate,bitrateMax:y.bitrate,bitrateMin:y.bitrate}));return $._hints.push(DR.LOW_STREAM),$}globalLock(){var s=this;return f(function*(){return s.mutex.lock("From P2PChannel.globalLock")})()}}).prototype,"startP2PConnection",[zM],Object.getOwnPropertyDescriptor(P1.prototype,"startP2PConnection"),P1.prototype),gI(P1.prototype,"connect",[zM],Object.getOwnPropertyDescriptor(P1.prototype,"connect"),P1.prototype),gI(P1.prototype,"unpublish",[zM],Object.getOwnPropertyDescriptor(P1.prototype,"unpublish"),P1.prototype),gI(P1.prototype,"unpublishLowStream",[zM],Object.getOwnPropertyDescriptor(P1.prototype,"unpublishLowStream"),P1.prototype),gI(P1.prototype,"subscribe",[zM],Object.getOwnPropertyDescriptor(P1.prototype,"subscribe"),P1.prototype),gI(P1.prototype,"massSubscribe",[zM],Object.getOwnPropertyDescriptor(P1.prototype,"massSubscribe"),P1.prototype),gI(P1.prototype,"unsubscribe",[zM],Object.getOwnPropertyDescriptor(P1.prototype,"unsubscribe"),P1.prototype),gI(P1.prototype,"massUnsubscribe",[zM],Object.getOwnPropertyDescriptor(P1.prototype,"massUnsubscribe"),P1.prototype),gI(P1.prototype,"muteRemote",[zM],Object.getOwnPropertyDescriptor(P1.prototype,"muteRemote"),P1.prototype),gI(P1.prototype,"unmuteRemote",[zM],Object.getOwnPropertyDescriptor(P1.prototype,"unmuteRemote"),P1.prototype),gI(P1.prototype,"hasRemoteMediaWithLock",[zM],Object.getOwnPropertyDescriptor(P1.prototype,"hasRemoteMediaWithLock"),P1.prototype),gI(P1.prototype,"disconnectForReconnect",[zM],Object.getOwnPropertyDescriptor(P1.prototype,"disconnectForReconnect"),P1.prototype),gI(P1.prototype,"reEstablish",[zM],Object.getOwnPropertyDescriptor(P1.prototype,"reEstablish"),P1.prototype),gI(P1.prototype,"updateBitrateLimit",[zM],Object.getOwnPropertyDescriptor(P1.prototype,"updateBitrateLimit"),P1.prototype),S0e=P1))||S0e;function zM(s,p,A){const y=s[p];if("function"!=typeof y)throw new Error("Cannot use mutex on object property.");return A.value=f(function*(){const w=this.mutex,$=yield w.lock("From P2PChannel.".concat(p));try{for(var j=arguments.length,_e=new Array(j),K=0;K<j;K++)_e[K]=arguments[K];return yield y.apply(this,_e)}finally{$()}}),A}function lj(s){return"Minified Redux error #"+s+"; visit https://redux.js.org/Errors?code="+s+" for the full message or use the non-minified dev environment for full errors. "}var O1,D0e="function"==typeof Symbol&&Symbol.observable||"@@observable",Xye=function(){return Math.random().toString(36).substring(7).split("").join(".")},N0e={INIT:"@@redux/INIT"+Xye(),REPLACE:"@@redux/REPLACE"+Xye(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Xye()}};function Abe(s){if("object"!=typeof s||null===s)return!1;for(var p=s;null!==Object.getPrototypeOf(p);)p=Object.getPrototypeOf(p);return Object.getPrototypeOf(s)===p}function k0e(s,p,A){var y;if("function"==typeof p&&"function"==typeof A||"function"==typeof A&&"function"==typeof arguments[3])throw new Error(lj(0));if("function"==typeof p&&void 0===A&&(A=p,p=void 0),void 0!==A){if("function"!=typeof A)throw new Error(lj(1));return A(k0e)(s,p)}if("function"!=typeof s)throw new Error(lj(2));var w=s,$=p,j=[],_e=j,K=!1;function _i(){_e===j&&(_e=j.slice())}function _o(){if(K)throw new Error(lj(3));return $}function _u(i_){if("function"!=typeof i_)throw new Error(lj(4));if(K)throw new Error(lj(5));var u_=!0;return _i(),_e.push(i_),function(){if(u_){if(K)throw new Error(lj(6));u_=!1,_i();var g_=_e.indexOf(i_);_e.splice(g_,1),j=null}}}function ch(i_){if(!Abe(i_))throw new Error(lj(7));if(void 0===i_.type)throw new Error(lj(8));if(K)throw new Error(lj(9));try{K=!0,$=w($,i_)}finally{K=!1}for(var u_=j=_e,g_=0;g_<u_.length;g_++)(0,u_[g_])();return i_}function _f(i_){if("function"!=typeof i_)throw new Error(lj(10));w=i_,ch({type:N0e.REPLACE})}function o_(){var i_,u_=_u;return(i_={subscribe:function(g_){if("object"!=typeof g_||null===g_)throw new Error(lj(11));function __(){g_.next&&g_.next(_o())}return __(),{unsubscribe:u_(__)}}})[D0e]=function(){return this},i_}return ch({type:N0e.INIT}),(y={dispatch:ch,subscribe:_u,getState:_o,replaceReducer:_f})[D0e]=o_,y}function P0e(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function _I(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?P0e(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):P0e(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}!function(s){s.SET_SESSION_ID="SET_SESSION_ID",s.SET_P2P_ID="SET_P2P_id",s.SET_UID="SET_UID",s.SET_PUB_ID="SET_PUB_ID",s.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",s.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",s.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",s.AVOID_JOIN_START="AVOID_JOIN_START",s.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",s.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",s.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",s.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",s.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",s.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",s.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",s.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",s.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",s.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",s.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",s.RESET_KEY_METRICS="RESET_KEY_METRICS"}(O1||(O1={}));class _be{constructor(p,A,y,w){a_(this,"store",void 0),a_(this,"reducer",void 0);const $={codec:p,audioCodec:A,mode:y,clientId:w,sessionId:null,p2pId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled"};this.reducer=function(){let j=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,_e=arguments.length>1?arguments[1]:void 0;switch(_e.type){case O1.SET_SESSION_ID:return _I(_I({},j),{},{sessionId:_e.sessionId});case O1.SET_P2P_ID:return _I(_I({},j),{},{p2pId:_e.p2pId});case O1.SET_UID:return _I(_I({},j),{},{uid:_e.uid});case O1.SET_PUB_ID:return _I(_I({},j),{},{pubId:_e.pubId});case O1.KEY_METRIC_CLIENT_CREATED:return _I(_I({},j),{},{keyMetrics:_I(_I({},j.keyMetrics),{},{clientCreated:_e.metric})});case O1.KEY_METRIC_JOIN_START:return _I(_I({},j),{},{keyMetrics:_I(_I({},j.keyMetrics),{},{joinStart:_e.metric})});case O1.AVOID_JOIN_START:return _I(_I({},j),{},{avoidJoinStart:_e.avoidJoinStart});case O1.KEY_METRIC_JOIN_END:return _I(_I({},j),{},{keyMetrics:_I(_I({},j.keyMetrics),{},{joinEnd:_e.metric})});case O1.KEY_METRIC_REQUEST_AP_START:return _I(_I({},j),{},{keyMetrics:_I(_I({},j.keyMetrics),{},{requestAPStart:_e.metric})});case O1.KEY_METRIC_REQUEST_AP_END:return _I(_I({},j),{},{keyMetrics:_I(_I({},j.keyMetrics),{},{requestAPEnd:_e.metric})});case O1.KEY_METRIC_JOIN_GATEWAY_START:return _I(_I({},j),{},{keyMetrics:_I(_I({},j.keyMetrics),{},{joinGatewayStart:_e.metric})});case O1.KEY_METRIC_JOIN_GATEWAY_END:return _I(_I({},j),{},{keyMetrics:_I(_I({},j.keyMetrics),{},{joinGatewayEnd:_e.metric})});case O1.KEY_METRIC_PEER_CONNECTION_START:return _I(_I({},j),{},{keyMetrics:_I(_I({},j.keyMetrics),{},{peerConnectionStart:_e.metric})});case O1.KEY_METRIC_PEER_CONNECTION_END:return _I(_I({},j),{},{keyMetrics:_I(_I({},j.keyMetrics),{},{peerConnectionEnd:_e.metric})});case O1.KEY_METRIC_PUBLISH:{const K=j.keyMetrics.publish,_i=K.findIndex(_o=>_o.trackId===_e.metric.trackId);return-1!==_i?(K[_i]=_I(_I({},K[_i]),_e.metric),_I(_I({},j),{},{keyMetrics:_I(_I({},j.keyMetrics),{},{publish:[...K]})})):_I(_I({},j),{},{keyMetrics:_I(_I({},j.keyMetrics),{},{publish:[...j.keyMetrics.publish,_e.metric]})})}case O1.KEY_METRIC_SUBSCRIBE:{const K=j.keyMetrics.subscribe,_i=K.findIndex(_o=>_o.userId===_e.metric.userId&&_o.type===_e.metric.type);return-1!==_i?(K[_i]=_I(_I({},K[_i]),_e.metric),_I(_I({},j),{},{keyMetrics:_I(_I({},j.keyMetrics),{},{subscribe:[...K]})})):_I(_I({},j),{},{keyMetrics:_I(_I({},j.keyMetrics),{},{subscribe:[...j.keyMetrics.subscribe,_e.metric]})})}case O1.SET_CLOUD_PROXY_SERVER_MODE:return j.cloudProxyServerMode=_e.mode,j;case O1.RECORD_JOIN_CHANNEL_SERVICE:return"number"!=typeof _e.index?j.joinChannelServiceRecords=[...j.joinChannelServiceRecords,_e.record]:(j.joinChannelServiceRecords[_e.index]=_I(_I({},j.joinChannelServiceRecords[_e.index]),_e.record),j.joinChannelServiceRecords=[...j.joinChannelServiceRecords]),j;case O1.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return j.joinChannelServiceRecords=[],j;case O1.RESET_KEY_METRICS:return j.keyMetrics={publish:[],subscribe:[]},j;default:return j}},this.store=k0e(this.reducer)}set sessionId(p){this.store.dispatch({type:O1.SET_SESSION_ID,sessionId:p})}get sessionId(){return this.store.getState().sessionId}get codec(){return this.store.getState().codec}get audioCodec(){return this.store.getState().audioCodec}get clientId(){return this.store.getState().clientId}set p2pId(p){this.store.dispatch({type:O1.SET_P2P_ID,p2pId:p})}get p2pId(){return this.store.getState().p2pId}set uid(p){this.store.dispatch({type:O1.SET_UID,uid:p})}get uid(){return this.store.getState().uid}set pubId(p){this.store.dispatch({type:O1.SET_PUB_ID,pubId:p})}get pubId(){return this.store.getState().pubId}set cloudProxyServerMode(p){this.store.dispatch({type:O1.SET_CLOUD_PROXY_SERVER_MODE,mode:p})}get cloudProxyServerMode(){return this.store.getState().cloudProxyServerMode}clientCreated(){this.store.dispatch({type:O1.KEY_METRIC_CLIENT_CREATED,metric:performance.now()})}joinStart(){this.store.dispatch({type:O1.KEY_METRIC_JOIN_START,metric:performance.now()})}get avoidJoinStart(){return this.store.getState().avoidJoinStart}set avoidJoinStart(p){this.store.dispatch({type:O1.AVOID_JOIN_START,avoidJoinStart:p})}joinEnd(){this.store.dispatch({type:O1.KEY_METRIC_JOIN_END,metric:performance.now()})}requestAPStart(){this.store.dispatch({type:O1.KEY_METRIC_REQUEST_AP_START,metric:performance.now()})}requestAPEnd(){this.store.dispatch({type:O1.KEY_METRIC_REQUEST_AP_END,metric:performance.now()})}joinGatewayStart(){this.store.dispatch({type:O1.KEY_METRIC_JOIN_GATEWAY_START,metric:performance.now()})}joinGatewayEnd(){this.store.dispatch({type:O1.KEY_METRIC_JOIN_GATEWAY_END,metric:performance.now()})}peerConnectionStart(){this.store.dispatch({type:O1.KEY_METRIC_PEER_CONNECTION_START,metric:performance.now()})}peerConnectionEnd(){this.store.dispatch({type:O1.KEY_METRIC_PEER_CONNECTION_END,metric:performance.now()})}publish(p,A,y,w){this.store.dispatch({type:O1.KEY_METRIC_PUBLISH,metric:_I(_I({trackId:p,type:A},y&&{publishStart:y}),w&&{publishEnd:w})})}subscribe(p,A,y,w,$){this.store.dispatch({type:O1.KEY_METRIC_SUBSCRIBE,metric:_I(_I(_I({userId:p,type:A},y&&{subscribeStart:y}),w&&{subscribeEnd:w}),$&&{firstFrame:$})})}massSubscribe(p,A,y,w){p.forEach($=>{this.store.dispatch({type:O1.KEY_METRIC_SUBSCRIBE,metric:_I(_I(_I({userId:$.userId,type:$.type},A&&{subscribeStart:A}),y&&{subscribeEnd:y}),w&&{firstFrame:w})})})}get keyMetrics(){return this.store.getState().keyMetrics}recordJoinChannelService(p,A){"gateway"===p.service&&Array.isArray(p.urls)&&(p.urls=p.urls.map(y=>y.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return"number"!=typeof A?(this.store.dispatch({type:O1.RECORD_JOIN_CHANNEL_SERVICE,record:_I(_I({},p),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.store.getState().joinChannelServiceRecords.length-1):(A<0||A>=this.store.getState().joinChannelServiceRecords.length||this.store.dispatch({type:O1.RECORD_JOIN_CHANNEL_SERVICE,record:p,index:A}),A)}catch(y){return 0}}resetJoinChannelServiceRecords(){this.store.dispatch({type:O1.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.store.dispatch({type:O1.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.store.getState().joinChannelServiceRecords}catch(p){return[]}}}let Kme;const x0e=()=>void 0!==window.isSecureContext;class ybe{constructor(p,A){a_(this,"time",void 0),a_(this,"sequence",void 0),a_(this,"name",void 0),a_(this,"elapse",void 0),this.name=p,this.time=performance.now(),this.sequence=P_e[A].indexOf(p)}setElapse(p){this.elapse=p}}const Ebe=new Map;class Ibe{constructor(p,A){a_(this,"records",[]),a_(this,"_id",void 0),a_(this,"_group",void 0),a_(this,"_localTimeStamp",void 0),a_(this,"_performanceTimeStamp",void 0),this._id=p,this._group=A,this._localTimeStamp=Date.now(),this._performanceTimeStamp=performance.now()}checkPoint(p){const A=new ybe(p,this._group);-1===A.sequence&&h_.warning("[".concat(this._id,"] check point record failed, cannot get the sequence")),this.records.push(A);const y=this.records.find(w=>w.sequence===A.sequence-1);y&&A.setElapse(A.time-y.time)}getRecord(p){return this.records.find(A=>A&&A.name===p)}resetRecords(){this.records.length=0}}var L0e,M0e,B0e,U0e,F0e,j0e,V0e,G0e,Q0e,lO;function H0e(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function vde(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?H0e(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):H0e(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}let bbe=(L0e=TR("AgoraRTCClient","store.clientId"),M0e=HQ({report:w0}),B0e=HQ(),U0e=HQ({report:w0}),F0e=VK(),j0e=HQ({report:w0}),V0e=VK({report:w0}),G0e=HQ({reportResult:!0,report:w0}),L0e((gI((lO=class extends sS{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}constructor(s){var p;let A;if(super(),p=this,a_(this,"store",void 0),a_(this,"_uid",void 0),a_(this,"_channelName",void 0),a_(this,"_uintUid",void 0),a_(this,"_users",[]),a_(this,"_codec",void 0),a_(this,"_mode",void 0),a_(this,"_config",void 0),a_(this,"_clientId",void 0),a_(this,"_appId",void 0),a_(this,"_sessionId",null),a_(this,"_key",void 0),a_(this,"_joinInfo",void 0),a_(this,"_gateway",void 0),a_(this,"_statsCollector",void 0),a_(this,"_configDistribute",void 0),a_(this,"_leaveMutex",new iP("client-leave")),a_(this,"_publishMutex",new iP("client-publish")),a_(this,"_renewTokenMutex",new iP("client-renewtoken")),a_(this,"_subscribeMutex",new iP("client-subscribe")),a_(this,"_encryptionMode","none"),a_(this,"_encryptionSecret",null),a_(this,"_encryptionSalt",null),a_(this,"_proxyServer",void 0),a_(this,"_performanceRecorder",void 0),a_(this,"_turnServer",{servers:[],mode:"auto"}),a_(this,"_cloudProxyServerMode","disabled"),a_(this,"_isDualStreamEnabled",!1),a_(this,"_defaultStreamFallbackType",void 0),a_(this,"_lowStreamParameter",void 0),a_(this,"_streamFallbackTypeCacheMap",new Map),a_(this,"_remoteStreamTypeCacheMap",new Map),a_(this,"_axiosCancelSource",JU.CancelToken.source()),a_(this,"_audioVolumeIndicationInterval",void 0),a_(this,"_networkQualityInterval",void 0),a_(this,"_userOfflineTimeout",void 0),a_(this,"_streamRemovedTimeout",void 0),a_(this,"_injectStreamingClient",void 0),a_(this,"_liveTranscodeStreamingClient",void 0),a_(this,"_liveRawStreamingClient",void 0),a_(this,"_channelMediaRelayClient",void 0),a_(this,"_networkQualitySensitivity","normal"),a_(this,"_p2pChannel",void 0),a_(this,"_useLocalAccessPoint",!1),a_(this,"_joinAndNotLeaveYet",!1),a_(this,"_numberOfJoinCount",0),a_(this,"_remoteDefaultVideoStreamType",void 0),a_(this,"_handleLocalTrackEnable",(y,w,$)=>{this.publish(y,!1).then(w).catch($)}),a_(this,"_handleLocalTrackDisable",(y,w,$)=>{this.unpublish(y).then(w).catch($)}),a_(this,"_handleUserOnline",y=>{this.isStringUID&&"string"!=typeof y.uid&&(h_.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID")),sI("error",this,"StringUID is Mixed with UintUID"));const w=this._users.find($=>$.uid===y.uid);if(w)w._trust_in_room_=!0;else{const $=new Rye(y.uid,y.uint_id||y.uid);this._users.push($),h_.debug("[".concat(this._clientId,"] user online"),y.uid),BL("info",this,"user-joined",{uid:y.uid}),this.emit(d1.USER_JOINED,$)}}),a_(this,"_handleUserOffline",y=>{const w=this._users.find($=>$.uid===y.uid);w&&(this._handleRemoveStream(y),nG(this._users,w),this._remoteStreamTypeCacheMap.delete(w.uid),this._streamFallbackTypeCacheMap.delete(w.uid),h_.debug("[".concat(this._clientId,"] user offline"),y.uid,"reason:",y.reason),BL("info",this,"user-left",{reason:y.reason,uid:y.uid}),this.emit(d1.USER_LEAVED,w,y.reason))}),a_(this,"_handleAddAudioOrVideoStream",(y,w,$,j,_e,K,_i)=>{const _o=this._users.find(ch=>ch.uid===w);if(!_o)return h_.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)")),void lT("error",["AgoraRTCGateway",this._clientId],"add_".concat(y,"_stream"),"can not find target user!");h_.debug("[".concat(this._clientId,"] stream added with uid ").concat(w,", type ").concat(y)),lT("debug",["AgoraRTCGateway",this._clientId],"add_".concat(y,"_stream"),{uid:w,mediaType:y});const _u="audio"===y?_o.hasAudio:_o.hasVideo;_o._uintid||(_o._uintid=_e||w),_o._trust_stream_added_state_=!0,"audio"===y?(_o._audio_added_=!0,void 0!==$&&(_o._audioSSRC=$),void 0!==j&&(_o._cname=j),K&&(_o._audioOrtc=K)):(_o._video_added_=!0,void 0!==$&&(_o._videoSSRC=$),void 0!==j&&(_o._cname=j),void 0!==_i&&(_o._rtxSsrcId=_i),K&&(_o._videoOrtc=K)),("audio"===y?_o.hasAudio:_o.hasVideo)&&!_u&&(h_.info("[".concat(this._clientId,"] remote user ").concat(_o.uid," published ").concat(y)),sI("info",this,"remote user ".concat(_o.uid," published ").concat(y)),BL("info",this,"user-published",{uid:_o.uid,mediaType:y}),this.emit(d1.USER_PUBLISHED,_o,y)),"video"===y?w0.onGatewayStream(this._sessionId,oO.ON_ADD_VIDEO_STREAM,gT.ON_ADD_VIDEO_STREAM,{peer:_e||w}):w0.onGatewayStream(this._sessionId,oO.ON_ADD_AUDIO_STREAM,gT.ON_ADD_AUDIO_STREAM,{peer:_e||w}),this._p2pChannel.hasPendingRemoteMedia(_o,y)&&this.subscribe(_o,y).catch(ch=>{h_.error("[".concat(this._clientId,"] resubscribe error"),ch.toString()),sI("error",this,"resubscribe error: ".concat(ch.toString()))})}),a_(this,"_handleRemoveStream",y=>{const w=this._users.find(j=>j.uid===y.uid);if(!w)return h_.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)")),void lT("warning",["AgoraRTCGateway",this._clientId],"remove_stream",{uid:y.uid,info:"can not find target user!"});h_.debug("[".concat(this._clientId,"] stream removed with uid ").concat(y.uid)),lT("debug",["AgoraRTCGateway",this._clientId],"remove_stream",{uid:y.uid});let $=()=>{};w.hasAudio&&w.hasVideo?$=()=>{h_.info("[".concat(this._clientId,"] remote user ").concat(w.uid," unpublished audio track")),BL("info",this,"user-unpublished",{uid:w.uid,mediaType:"audio"}),this.emit(d1.USER_UNPUBLISHED,w,"audio"),h_.info("[".concat(this._clientId,"] remote user ").concat(w.uid," unpublished video track")),BL("info",this,"user-unpublished",{uid:w.uid,mediaType:"video"}),this.emit(d1.USER_UNPUBLISHED,w,"video")}:w.hasVideo?$=()=>{h_.info("[".concat(this._clientId,"] remote user ").concat(w.uid," unpublished video track")),BL("info",this,"user-unpublished",{uid:w.uid,mediaType:"video"}),this.emit(d1.USER_UNPUBLISHED,w,"video")}:w.hasAudio&&($=()=>{h_.info("[".concat(this._clientId,"] remote user ").concat(w.uid," unpublished audio track")),BL("info",this,"user-unpublished",{uid:w.uid,mediaType:"audio"}),this.emit(d1.USER_UNPUBLISHED,w,"audio")}),w._trust_stream_added_state_=!0,w._audio_added_=!1,w._video_added_=!1,this._p2pChannel.unsubscribe(w).then(j=>{if(j)return this._gateway.unsubscribe(j,w.uid)}),w._audioSSRC=void 0,w._videoSSRC=void 0,w._audioOrtc=void 0,w._videoOrtc=void 0,w._rtxSsrcId=void 0,w0.onGatewayStream(this._sessionId,oO.ON_REMOVE_STREAM,gT.ON_REMOVE_STREAM,{peer:y.uint_id||y.uid}),$()}),a_(this,"_handleSetStreamLocalEnable",(y,w,$)=>{const j=this._users.find(_i=>_i.uid===w);if(!j)return h_.error("[".concat(this._clientId,"] can not find target user!(disable_local)")),void lT("error",this,"disable_local_video","can not find target user!(disable_local)");h_.debug("[".concat(this._clientId,"] local ").concat(y," ").concat($?"enabled":"disabled"," with uid ").concat(w)),lT("debug",this,"disable_local_video","local ".concat(y," ").concat($?"enabled":"disabled"," with uid ").concat(w));const _e="audio"===y?j.hasAudio:j.hasVideo;if("audio"===y){j._trust_audio_enabled_state_=!0;const _i=j._audio_enabled_;if(j._audio_enabled_=$,j._audio_enabled_===_i)return;{const _o=j._audio_enabled_?"enable-local-audio":"disable-local-audio";h_.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(w,", msg: ").concat(_o)),II("debug",this,"user-info-updated",{uid:w,msg:_o}),this.emit(d1.USER_INFO_UPDATED,w,_o)}}else{j._trust_video_enabled_state_=!0;const _i=j._video_enabled_;if(j._video_enabled_=$,j._video_enabled_===_i)return;{const _o=j._video_enabled_?"enable-local-video":"disable-local-video";h_.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(w,", msg: ").concat(_o)),II("debug",this,"user-info-updated",{uid:w,msg:_o}),this.emit(d1.USER_INFO_UPDATED,w,_o)}}const K="audio"===y?j.hasAudio:j.hasVideo;return _e!==K?!_e&&K?(h_.info("[".concat(this._clientId,"] remote user ").concat(w," published ").concat(y)),BL("info",this,"user-published",{uid:w,mediaType:y}),void this.emit(d1.USER_PUBLISHED,j,y)):("video"===y&&j._videoTrack&&j._videoTrack._destroy(),this._p2pChannel.muteRemote(j,y),h_.info("[".concat(this._clientId,"] remote user ").concat(w," unpublished ").concat(y)),BL("info",this,"user-unpublished",{uid:w,mediaType:y}),void this.emit(d1.USER_UNPUBLISHED,j,y)):void 0}),a_(this,"_handleMuteStream",(y,w,$)=>{h_.debug("[".concat(this._clientId,"] receive mute message"),y,w,$),lT("debug",this,"mute_".concat(w),$);const j=this._users.find(_i=>_i.uid===y);if(!j)return h_.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(y)),void lT("warning",this,"mute_".concat(w),"can not find remote user, ignore mute event, uid: ".concat(y));const _e="audio"===w?j.hasAudio:j.hasVideo;if("audio"===w){j._trust_audio_mute_state_=!0;const _i=j._audio_muted_;if(j._audio_muted_=$,j._audio_muted_===_i)return;{const _o=j._audio_muted_?"mute-audio":"unmute-audio";h_.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(y,", msg: ").concat(_o)),II("debug",this,"user-info-updated",{uid:y,msg:_o}),this.emit(d1.USER_INFO_UPDATED,y,_o)}}else{j._trust_video_mute_state_=!0;const _i=j._video_muted_;if(j._video_muted_=$,j._video_muted_===_i)return;{const _o=j._video_muted_?"mute-video":"unmute-video";h_.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(y,", msg: ").concat(_o)),II("debug",this,"user-info-updated",{uid:y,msg:_o}),this.emit(d1.USER_INFO_UPDATED,y,_o)}}const K="audio"===w?j.hasAudio:j.hasVideo;return _e!==K?!_e&&K?(h_.info("[".concat(this._clientId,"] remote user ").concat(y," published ").concat(w)),BL("info",this,"user-published",{uid:j.uid,mediaType:w}),void this.emit(d1.USER_PUBLISHED,j,w)):("video"===w&&j._videoTrack&&j._videoTrack._destroy(),this._p2pChannel.muteRemote(j,w),h_.info("[".concat(this._clientId,"] remote user ").concat(y," unpublished ").concat(w)),BL("info",this,"user-unpublished",{uid:y,mediaType:w}),void this.emit(d1.USER_UNPUBLISHED,j,w)):void 0}),a_(this,"_handleP2PLost",function(){var y=f(function*(w){if(h_.debug("[".concat(p._clientId,"] receive p2p lost"),w),lT("debug",p,"p2p_lost",w),parseInt(w.p2pid,10)!==p.store.p2pId)return h_.warning("P2PLost stream not found",w),void lT("warning",p,"p2p_lost","P2PLost stream not found, ".concat(w));yield p._p2pChannel.requestReconnect()});return function(w){return y.apply(this,arguments)}}()),a_(this,"_handleTokenWillExpire",()=>{h_.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),lT("debug",this,"token_privilege_will_expire"),this.emit(d1.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),a_(this,"_handleBeforeUnload",y=>{"beforeunload"===y.type&&void 0!==y.returnValue&&""!==y.returnValue||(this.leave(),h_.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")),b6("info",["window",this.store.clientId],Z2()?"beforeunload":"pagehide"))}),a_(this,"_handleUpdateNetworkQuality",()=>{if("normal"===this._networkQualitySensitivity)return;if(navigator&&void 0!==navigator.onLine&&!navigator.onLine)return void this.emit(d1.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const y={downlinkNetworkQuality:0,uplinkNetworkQuality:0};y.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),y.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.emit(d1.NETWORK_QUALITY,y)}),this._codec=s.codec,this._mode=s.mode,this._clientId=VT(5,"client-"),this.store=new _be(s.codec,s.audioCodec,s.mode,this._clientId),this.store.clientCreated(),s.proxyServer&&this.setProxyServer(s.proxyServer,!0),s.turnServer&&this.setTurnServer(s.turnServer,!0),h_.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(GO," build: ").concat(TI,", mode: ").concat(this._mode,", codec: ").concat(this._codec)),II("info",this,"constructor",{version:GO,build:TI,mode:this._mode,codec:this._codec}),this._performanceRecorder=function(y,w){const $=new Ibe(y,"join");return Ebe.set(y,$),$}(this._clientId),s.clientRoleOptions)try{mK(s.clientRoleOptions),A=Object.assign({},s.clientRoleOptions)}catch(y){h_.warning("[".concat(this._clientId,"] ").concat(y.toString())),sI("warning",this,y.toString())}this._statsCollector=new KK(this.store),this._statsCollector.onStatsException=(y,w,$)=>{h_.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(y,", msg: ").concat(w,", uid: ").concat($)),BL("debug",this,d1.EXCEPTION,{code:y,message:w,uid:$}),this.emit(d1.EXCEPTION,{code:y,msg:w,uid:$})},this._statsCollector.onUploadPublishDuration=(y,w,$,j)=>{const _e=this._users.find(K=>K.uid===y);_e&&w0.peerPublishStatus(this._sessionId,{subscribeElapse:j,audioPublishDuration:w,videoPublishDuration:$,peer:_e._uintid})},this._gateway=new mye(this.store,{clientId:this._clientId,mode:this._mode,codec:this._codec,websocketRetryConfig:s.websocketRetryConfig||pS,httpRetryConfig:s.httpRetryConfig||pS,forceWaitGatewayResponse:void 0===s.forceWaitGatewayResponse||s.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:s.role,clientRoleOptions:A}),this._config=s,this._configDistribute=new Eme,this._p2pChannel=new mbe(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents()}join(s,p,A,y,w){var $=this;return f(function*(){const j=++$._numberOfJoinCount;$._performanceRecorder.checkPoint("startJoin"),$.store.joinStart(),y&&($.store.uid=y);const _e="HTTPS"===(Kme||Kme||(Kme=(window.location.protocol.split(":")[0]||"").toUpperCase(),Kme)),K=x0e()?window.isSecureContext:"Browser Not Support";if(!x0e()&&!_e||!window.isSecureContext){const o_="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser";h_.warning(o_),S0("warning",$,o_)}const _i=$ue();"DISCONNECTED"===$.connectionState&&($.store.avoidJoinStart=Math.round(Date.now()),h_.debug("[".concat($._clientId,"] set avoidJoinStart to ").concat($.store.avoidJoinStart)),S0("debug",$,"join",void 0,"[".concat($._clientId,"] set avoidJoinStart to ").concat($.store.avoidJoinStart)));const _o=w0.reportApiInvoke(_i,{name:bI.JOIN,options:[s,p,A,y],states:{isHttps:_e,isSecureContext:K},tag:lI.TRACER});try{if(!A&&null!==A)throw new U_(N_.INVALID_PARAMS,"Invalid token: ".concat(A,". If you don not use token, set it to null"));A&&rO(A,"token",1,2047),rO(s,"appid",1,2047),pZ(p),y&&iO(y),w&&rO(w,"optionalInfo",1,2047)}catch(o_){throw _o.onError(o_),o_}if(h_.info("[".concat($._clientId,"] start join channel ").concat(p,", join number: ").concat(j)),II("info",$,"join",{channel:p}),$._leaveMutex.isLocked&&(h_.debug("[".concat($._clientId,"] join: waiting leave operation")),sI("debug",$,"join: waiting leave operation"),(yield $._leaveMutex.lock())(),h_.debug("[".concat($._clientId,"] join: continue")),sI("debug",$,"join: continue")),$._joinAndNotLeaveYet=!0,"DISCONNECTED"!==$.connectionState){const o_=new U_(N_.INVALID_OPERATION,"[".concat($._clientId,"] Client already in connecting/connected state"));throw _o.onError(o_),o_}$._sessionId||($._sessionId=_i,$.store.sessionId=$._sessionId),$._gateway.state="CONNECTING";const _u=vde({clientId:$._clientId,appId:s,sid:$._sessionId,cname:p,uid:"string"!=typeof y?y:null,turnServer:$._turnServer,proxyServer:$._proxyServer,token:A||s,cloudProxyServer:$._cloudProxyServerMode,optionalInfo:w,useLocalAccessPoint:$._useLocalAccessPoint},void 0!==$._remoteDefaultVideoStreamType&&{defaultVideoStream:$._remoteDefaultVideoStreamType});if("string"==typeof y&&(_u.stringUid=y,$._uintUid?(_u.uid=$._uintUid,$._uintUid=void 0):_u.uid=0),"none"!==$._encryptionMode&&$._encryptionSecret){if(_u.aesmode=$._encryptionMode,_u.aespassword=yield(o_=f(function*(i_){const u_=pX("MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu\nSTM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+\nHvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy\nxQiYDz3vqa6bP29adwIDAQAB"),g_=yield window.crypto.subtle.importKey("spki",u_,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),__=dge(i_),w_=yield window.crypto.subtle.encrypt({name:"RSA-OAEP"},g_,__);return JK(new Uint8Array(w_))}),function(i_){return o_.apply(this,arguments)})($._encryptionSecret),!$._joinAndNotLeaveYet)throw new U_(N_.INVALID_OPERATION,"[".concat($._clientId,"] Client already left"));$._encryptionSalt&&(_u.aessalt=$._encryptionSalt)}var o_;$._startSession($._sessionId,{channel:p,appId:s});const ch=$._sessionId;setTimeout(()=>{"CONNECTING"===$.connectionState&&ch===$._sessionId&&w0.joinChannelTimeout($._sessionId,5)},5e3);try{let o_;const i_=_u.cloudProxyServer;if("443only"===i_)_u.proxyServer=v0("PROXY_SERVER_TYPE2");else if(["proxy3","proxy4","proxy5"].includes(i_)){const __=v0("PROXY_SERVER_TYPE3");_u.proxyServer=Array.isArray(__)?__[0]:__}if(w0.setProxyServer(_u.proxyServer),h_.setProxyServer(_u.proxyServer),wQ(_u.proxyServer),$._performanceRecorder.checkPoint("startRequestAp"),$.store.requestAPStart(),_u.stringUid&&!_u.uid&&"normal"===i_){yield Jle(_u,$._axiosCancelSource.token,$._config.httpRetryConfig||pS,!1,$.store);const __=yield Zle(_u.stringUid,_u,$._axiosCancelSource.token,$._config.httpRetryConfig||pS,$.store);h_.debug("getUserAccount Success ".concat(_u.stringUid," => ").concat(__)),sI("debug",$,"getUserAccount Success ".concat(_u.stringUid," => ").concat(__)),_u.uid=__,o_=yield d3(_u,$._axiosCancelSource.token,$._config.httpRetryConfig||pS,$.store)}else if(_u.stringUid&&!_u.uid){const __=yield Zle(_u.stringUid,_u,$._axiosCancelSource.token,$._config.httpRetryConfig||pS,$.store);h_.debug("getUserAccount Success ".concat(_u.stringUid," => ").concat(__)),sI("debug",$,"getUserAccount Success ".concat(_u.stringUid," => ").concat(__)),_u.uid=__,o_=yield Jle(_u,$._axiosCancelSource.token,$._config.httpRetryConfig||pS,!0,$.store)}else o_=yield Jle(_u,$._axiosCancelSource.token,$._config.httpRetryConfig||pS,!0,$.store);if(!$._joinAndNotLeaveYet)throw new U_(N_.INVALID_OPERATION,"[".concat($._clientId,"] Client already left"));$.store.requestAPEnd(),$._performanceRecorder.checkPoint("startJoinGateway"),setTimeout(()=>{$._configDistribute.startGetConfigDistribute(_u,$._axiosCancelSource.token),$._configDistribute.on(V8.UPDATE_BITRATE_LIMIT,__=>{$._p2pChannel.updateBitrateLimit(__)})},0),$._key=A||s;const u_=o_.gatewayInfo;$._joinInfo=vde(vde({},_u),{},{cid:u_.cid,uid:_u.uid?_u.uid:u_.uid,vid:u_.vid,apResponse:u_.res,uni_lbs_ip:u_.uni_lbs_ip,gatewayAddrs:u_.gatewayAddrs});const g_=yield $._joinGateway();if(!$._joinAndNotLeaveYet)throw new U_(N_.INVALID_OPERATION,"[".concat($._clientId,"] Client already left"));return _o.onSuccess(g_),$._appId=s,$._channelName=_u.cname,$._uid=g_,$.store.uid=g_,setTimeout(()=>{$._networkQualityInterval&&window.clearInterval($._networkQualityInterval),$._networkQualityInterval=window.setInterval($._handleUpdateNetworkQuality,2e3),window.addEventListener(Z2()?"beforeunload":"pagehide",$._handleBeforeUnload)},0),h_.info("[".concat($._clientId,"] Joining channel success: ").concat(p)),II("info",$,"join",p,"success"),setTimeout(()=>{v0("USE_NEW_LOG")?sre():h_.startUpload()},5e3),$._performanceRecorder.checkPoint("finishJoin"),$.store.joinEnd(),B8.includes(_f=$)||B8.push(_f),g_}catch(o_){const i_=Array.isArray(o_)?o_[0]:o_;throw h_.error("[".concat($._clientId,"] join number: ").concat(j,", Joining channel failed, rollback"),i_),II("error",$,"join",p,i_.toString()),i_.code!==N_.OPERATION_ABORTED&&$._numberOfJoinCount===j&&($._gateway.state="DISCONNECTED",$._reset()),_o.onError(i_),i_}var _f})()}_joinGateway(){if(!this._joinInfo||!this._key)throw new U_(N_.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!("disabled"!==this._joinInfo.cloudProxyServer||!v0("JOIN_WITH_FALLBACK_SIGNAL_PROXY"))).then(s=>s).catch(s=>{if(s.code===N_.INIT_WEBSOCKET_TIMEOUT)return this._gateway.leave(!0,gS.FALLBACK);throw s}).then(s=>{if(s)return s;if(h_.info("[".concat(this._clientId,"] join timeout, fallback to proxy")),!this._joinInfo||!this._key)throw new U_(N_.INVALID_OPERATION);this._joinInfo.cloudProxyServer="fallback",this._cloudProxyServerMode="fallback",this.store.cloudProxyServerMode="fallback";const p=v0("PROXY_SERVER_TYPE3");if(Array.isArray(p))if(this._joinInfo.apUrl){const A=new rY(this._joinInfo.apUrl).host.split("."),y=A.slice(A.length-2).join(".");p.forEach(w=>{this._joinInfo&&w.includes(y)&&(this._joinInfo.proxyServer=w)}),this._joinInfo.proxyServer||(this._joinInfo.proxyServer=p[0])}else this._joinInfo.proxyServer=p[0];else this._joinInfo.proxyServer=p;return h_.setProxyServer(this._joinInfo.proxyServer),w0.setProxyServer(this._joinInfo.proxyServer),wQ(this._joinInfo.proxyServer),w0.reportApiInvoke(this._sessionId,{name:bI.JOIN_FALLBACK_TO_PROXY,options:[this._joinInfo.proxyServer],tag:lI.TRACER}).onSuccess(),this.emit(d1.JOIN_FALLBACK_TO_PROXY,this._joinInfo.proxyServer),this._gateway.join(this._joinInfo,this._key)}).then(s=>s)}leave(){var s=this;return f(function*(){const p=w0.reportApiInvoke(s._sessionId,{name:bI.LEAVE,options:[],tag:lI.TRACER});h_.info("[".concat(s._clientId,"] Leaving channel")),II("info",s,"leave"),window.removeEventListener(Z2()?"beforeunload":"pagehide",s._handleBeforeUnload),s._reset(),function(y){const w=B8.indexOf(y);-1!==w&&B8.splice(w,1)}(s);const A=yield s._leaveMutex.lock();if("DISCONNECTED"===s.connectionState)return h_.info("[".concat(s._clientId,"] Leaving channel repeated, success")),A(),p.onSuccess();yield s._gateway.leave("CONNECTED"!==s.connectionState),h_.info("[".concat(s._clientId,"] Leaving channel success")),II("info",s,"leave",void 0,"success"),s._joinAndNotLeaveYet=!1,s.store.resetJoinChannelServiceRecords(),A(),p.onSuccess()})()}publish(s){var p=arguments,A=this;return f(function*(){let y=!(p.length>1&&void 0!==p[1])||p[1];Array.isArray(s)||(s=[s]);const w=w0.reportApiInvoke(A._sessionId,{name:bI.PUBLISH,options:s.map(j=>j?Object(j).toString():"null"),tag:lI.TRACER});if(0===s.length){const j=new U_(N_.INVALID_PARAMS,"track list is empty");return w.onError(j),j.throw()}if("audience"===A._gateway.role){const j=new U_(N_.INVALID_OPERATION,"audience can not publish stream");return w.onError(j),j.throw()}for(const j of s){if(!(j instanceof F6)){const _e=new U_(N_.INVALID_PARAMS,"parameter is not local track");return w.onError(_e),_e.throw()}if(!j._enabled&&y){const _e=new U_(N_.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(j.getTrackId()));return w.onError(_e),_e.throw()}}h_.info("[".concat(A._clientId,"] Publishing tracks, id ").concat(s.map(j=>"".concat(j.getTrackId()," ")))),II("info",A,"publish",s.map(j=>"".concat(j.getTrackId()))),yield A._configDistribute.awaitConfigDistributeComplete(),y&&s.forEach(j=>{const _e=A._configDistribute.getBitrateLimit();j instanceof yS&&_e&&j.setBitrateLimit(_e.uplink)});const $=yield A._publishMutex.lock();try{yield A._publishHighStream(s),w.onSuccess(s.map(j=>j.trackMediaType+":"+j.getTrackLabel()).toString()),h_.info("[".concat(A._clientId,"] Publish success, id ").concat(s.map(j=>"".concat(j.getTrackId()," ")))),II("info",A,"publish",s.map(j=>"".concat(j.getTrackId())),"success")}catch(j){throw w.onError(j),h_.error("[".concat(A._clientId,"] publish error"),j.toString()),II("error",A,"publish",void 0,j.toString()),j}finally{$()}})()}unpublish(s){var p=this;return f(function*(){if(!p._joinInfo||void 0===p._uid)throw new U_(N_.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");s?Array.isArray(s)||(s=[s]):s=p._p2pChannel.getAllTracks(!0);const A=w0.reportApiInvoke(p._sessionId,{name:bI.UNPUBLISH,options:s.map(w=>w.getTrackId()),tag:lI.TRACER});h_.info("[".concat(p._clientId,"] Unpublish tracks, tracks ").concat(s.map(w=>"".concat(w.getTrackId()," "))," ")),II("info",p,"unpublish",s.map(w=>"".concat(w.getTrackId())));const y=yield p._publishMutex.lock();try{const w=yield p._p2pChannel.unpublish(s);w&&(yield p._gateway.unpublish(w,p._uid)),h_.info("[".concat(p._clientId,"] Unpublish success,tracks ").concat(s.map($=>"".concat($.getTrackId())))),II("info",p,"unpublish",s.map($=>"".concat($.getTrackId())),"success"),A.onSuccess()}catch(w){throw A.onError(w),h_.error("[".concat(p._clientId,"] unpublish error"),w.toString()),II("error",p,"unpublish",void 0,w.toString()),w}finally{y&&y()}})()}subscribe(s,p){var A=this;return f(function*(){RR(p,"mediaType",["audio","video"]);const y=w0.reportApiInvoke(A._sessionId,{name:bI.SUBSCRIBE,options:[s.uid,p],tag:lI.TRACER});if(!A._joinInfo){const _i=new U_(N_.INVALID_OPERATION,"Can't subscribe stream, not joined");throw y.onError(_i),_i}if("CONNECTED"!==A.connectionState&&"RECONNECTING"!==A.connectionState){const _i=new U_(N_.INVALID_OPERATION,"Can't subscribe stream in ".concat(A.connectionState," state"));throw y.onError(_i),_i}if(!A._users.find(_i=>_i===s)){const _i=new U_(N_.INVALID_REMOTE_USER,"user is not in the channel");throw h_.error("[".concat(A._clientId,"] can not subscribe ").concat(s.uid,", this user is not in the channel")),II("error",A,"subscribe",s.uid,"this user is not in the channel"),y.onError(_i),_i}if(!s.hasAudio&&!s.hasVideo){const _i=new U_(N_.INVALID_REMOTE_USER,"user is not published");throw h_.error("[".concat(A._clientId,"] can not subscribe ").concat(s.uid,", user is not published")),II("error",A,"subscribe",s.uid,"this user is not published"),y.onError(_i),_i}if("audio"===p&&(!s.hasAudio||void 0===s._audioSSRC)||"video"===p&&(!s.hasVideo||void 0===s._videoSSRC)){const _i=new U_(N_.REMOTE_USER_IS_NOT_PUBLISHED);throw h_.error("[".concat(A._clientId,"] can not subscribe ").concat(s.uid," with mediaType ").concat(p,", remote track is not published")),II("error",A,"subscribe",s.uid,"mediaType ".concat(p,", remote track is not published")),y.onError(_i),_i}const w="audio"===p?s._audioSSRC:s._videoSSRC,$="audio"===p?s._audioOrtc:s._videoOrtc,j="video"===p?s._rtxSsrcId:void 0,_e={stream_type:"audio"===p?o1.AUDIO:o1.VIDEO,ssrcId:w},K=yield A._subscribeMutex.lock();h_.info("[".concat(A._clientId,"] subscribe user ").concat(s.uid,", mediaType: ").concat(p)),II("info",A,"subscribe",{uid:s.uid,mediaType:p});try{if(yield A._p2pChannel.hasRemoteMediaWithLock(s,p))yield A._p2pChannel.unmuteRemote(s,p);else try{WL.markSubscribeStart(A.store.clientId,w),A.store.subscribe(s.uid,p,performance.now()),yield A._p2pChannel.subscribe(s,p,w,j,$);try{yield A._gateway.subscribe(s.uid,_e,!0)}catch(_o){throw yield A._p2pChannel.unsubscribe(s,p),_o}A.store.subscribe(s.uid,p,void 0,performance.now()),A._p2pChannel.reportSubscribeEvent(!0,null,s,p)}catch(_o){throw A._p2pChannel.reportSubscribeEvent(!1,null==_o?void 0:_o.code,s,p),_o}h_.info("[".concat(A._clientId,"] subscribe success user ").concat(s.uid,", mediaType: ").concat(p)),II("info",A,"subscribe",{uid:s.uid,mediaType:p},"success"),A._defaultStreamFallbackType&&A.setStreamFallbackOption(s.uid,A._defaultStreamFallbackType).catch(_o=>{h_.warning("[".concat(A._clientId,"] auto set fallback failed"),_o),sI("warning",A,"auto set fallback failed, ".concat(_o.toString()))});const _i="audio"===p?s._audioTrack:s._videoTrack;if(!_i){const _o=new U_(N_.UNEXPECTED_ERROR,"can not find remote track in user object");return y.onError(_o),_o.throw()}return y.onSuccess(_i.getTrackId()),_i}catch(_i){throw y.onError(_i),h_.error("[".concat(A._clientId,"] subscribe user ").concat(s.uid," error"),_i),II("error",A,"subscribe",{uid:s.uid,mediaType:p},_i.toString()),_i}finally{K()}})()}massSubscribe(s){var p=this;return f(function*(){TQ(s,"subscribeList");const A=w0.reportApiInvoke(p._sessionId,{name:bI.MASS_SUBSCRIBE,options:s.map(_i=>{let{user:_o,mediaType:_u}=_i;return[null==_o?void 0:_o.uid,_u]}),tag:lI.TRACER});if(!p._joinInfo){const _i=new U_(N_.INVALID_OPERATION,"Can't subscribe stream, not joined");throw A.onError(_i),_i}if("CONNECTED"!==p.connectionState&&"RECONNECTING"!==p.connectionState){const _i=new U_(N_.INVALID_OPERATION,"Can't subscribe stream in ".concat(p.connectionState," state"));throw A.onError(_i),_i}const y=performance.now(),w=new Map,$=yield p._subscribeMutex.lock();h_.info("[".concat(p._clientId,"]start massSubscribe user ").concat(s.map(_i=>{let{user:_o,mediaType:_u}=_i;return"user: ".concat(null==_o?void 0:_o.uid,", mediaType: ").concat(_u)}).join("; "))),II("info",p,"massSubscribe",s);const j=(s=[...s]).map(_i=>{let{user:_o,mediaType:_u}=_i;return{user:_o,mediaType:_u}}),_e=yield p._p2pChannel.globalLock();try{var K;for(let _o=s.length-1;_o>=0;_o--){const _u=s[_o],{user:ch,mediaType:_f}=_u;if(RR(_f,"mediaType",["audio","video"]),!ch){const u_=new U_(N_.INVALID_PARAMS,"user property does not exist in subscribeList item");throw h_.error("[".concat(p._clientId,"] user property does not exist in subscribeList item")),A.onError(u_),u_}if(!p._users.find(u_=>u_===ch)){const u_=new U_(N_.INVALID_REMOTE_USER,"user is not in the channel");h_.error("[".concat(p._clientId,"] can not massSubscribe ").concat(ch.uid,", this user is not in the channel")),II("error",p,"massSubscribe",ch.uid,"this user is not in the channel"),j[_o].error=u_,s.splice(_o,1);continue}if("audio"===_f&&(!ch.hasAudio||void 0===ch._audioSSRC)||"video"===_f&&(!ch.hasVideo||void 0===ch._videoSSRC)){const u_=new U_(N_.REMOTE_USER_IS_NOT_PUBLISHED);h_.error("[".concat(p._clientId,"] can not subscribe ").concat(ch.uid," with mediaType ").concat(_f,", remote user is not published")),II("error",p,"subscribe",ch.uid,"mediaType ".concat(_f,", remote user is not published")),j[_o].error=u_,s.splice(_o,1);continue}const o_=dT.Video|dT.LwoVideo,i_=w.get(ch);if(i_){if("video"===_f?i_&o_:i_&dT.Audio){s.splice(_o,1),h_.warning("repeat massSubscribe user:".concat(ch.uid,", mediaType:").concat(_f," twice"));continue}w.set(ch,i_|("video"===_f?o_:dT.Audio))}else w.set(ch,"video"===_f?o_:dT.Audio)}for(let _o=s.length-1;_o>=0;_o--){const _u=s[_o],{user:ch,mediaType:_f}=_u,o_=dT.Video|dT.LwoVideo;if(p._p2pChannel.hasRemoteMedia(ch,_f)){yield p._p2pChannel.unmuteRemoteNoLock(ch,_f);const i_=w.get(ch);w.set(ch,"video"===_f?i_^o_:i_^dT.Audio),s.splice(_o,1)}}p.store.massSubscribe(s.map(_o=>({userId:_o.user.uid,type:_o.mediaType})),y);const _i=qP(K=Array.from(w.entries())).call(K,(_o,_u)=>{let[ch,_f]=_u;if(0===_f)return _o;const o_={stream_id:ch.uid,stream_type:_f};return _f&dT.Audio&&(o_.audio_ssrc=ch._audioSSRC),_f&dT.Video&&(o_.video_ssrc=ch._videoSSRC),_o.push(o_),_o},[]);try{s.length>0&&(yield p._p2pChannel.massSubscribeNoLock(s.map(_u=>{let{user:ch,mediaType:_f}=_u;return{user:ch,mediaType:_f,ssrcId:_f===o1.VIDEO?ch._videoSSRC:ch._audioSSRC,rtxSsrcId:ch._rtxSsrcId}})));const _o=new Map;if(_i.length>0){const _u=yield p._gateway.subscribeAll(_i,!0);((null==_u?void 0:_u.users)||[]).forEach(ch=>{let{stream_id:_f,video_error_code:o_,audio_error_code:i_,error_code:u_}=ch;(o_||i_||u_)&&_o.set(_f,{video_error_code:o_,audio_error_code:i_,error_code:u_})})}if(Array.from(_o.entries()).length>0){const _u=Array.from(_o.entries()).map(ch=>{let _f,[o_,i_]=ch;return i_.error_code||i_.video_error_code&&i_.audio_error_code?_f=void 0:i_.video_error_code?_f=o1.VIDEO:i_.audio_error_code&&(_f=o1.AUDIO),{user:p.remoteUsers.find(u_=>u_.uid===o_),mediaType:_f}});yield p._p2pChannel.massUnsubscribeNoLock(_u)}for(const _u of j){const ch=_o.get(_u.user.uid);if(ch){const _f=ch.error_code||"audio"===_u.mediaType&&ch.audio_error_code||"video"===_u.mediaType&&ch.video_error_code;if(_f){const o_=l3(_f);h_.error("user:".concat(_u.user.uid," mediaType:").concat(_u.mediaType," has massSubscribe error ").concat(o_.desc)),_u.error=new U_(N_.SUBSCRIBE_FAILED,"code ".concat(_f,": ").concat(o_.desc))}}_u.error||(_u.track="video"===_u.mediaType?_u.user.videoTrack:_u.user.audioTrack)}return p.store.massSubscribe(j.filter(_u=>!_u.error).map(_u=>({userId:_u.user.uid,type:_u.mediaType})),void 0,performance.now()),j.forEach(_u=>{var ch;w0.subscribe(p.store.sessionId,{succ:!!_u.error,ec:(null===(ch=_u.error)||void 0===ch?void 0:ch.code)||null,video:_u.mediaType===o1.VIDEO,audio:_u.mediaType===o1.AUDIO,peerid:_u.user.uid,subscribeRequestid:_u.mediaType===o1.VIDEO?_u.user._videoSSRC:_u.user._audioSSRC,p2pid:p.store.p2pId,eventElapse:Math.floor(performance.now()-y)},!0)}),A.onSuccess(),h_.info("[".concat(p._clientId,"] massSubscribe success ").concat(s.map(_u=>{let{user:ch,mediaType:_f}=_u;return"user: ".concat(null==ch?void 0:ch.uid,", mediaType: ").concat(_f)}).join("; "))),II("info",p,"massSubscribe",s,"success"),j}catch(_o){throw yield p._p2pChannel.massUnsubscribeNoLock(s),A.onError(_o),_o}}finally{_e(),$()}})()}unsubscribe(s,p){var A=this;return f(function*(){if(p&&RR(p,"mediaType",["audio","video"]),!A._joinInfo)throw new U_(N_.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");const y=w0.reportApiInvoke(A._sessionId,{name:bI.UNSUBSCRIBE,options:[s.uid,p],tag:lI.TRACER});if(!A._users.find(w=>w===s)){const w=new U_(N_.INVALID_REMOTE_USER,"user is not in the channel");throw h_.error("[".concat(A._clientId,"] can not subscribe ").concat(s.uid,", user is not in the channel")),II("error",A,"unsubscribe",{uid:s.uid,mediaType:p},"user is not in the channel"),y.onError(w),w}h_.info("[".concat(A._clientId,"] unsubscribe uid: ").concat(s.uid,", mediaType: ").concat(p)),II("info",A,"unsubscribe",{uid:s.uid,mediaType:p});try{const w=yield A._p2pChannel.unsubscribe(s,p);w&&(yield A._gateway.unsubscribe(w,s.uid)),h_.info("[".concat(A._clientId,"] unsubscribe success uid: ").concat(s.uid,", mediaType: ").concat(p)),II("info",A,"unsubscribe",{uid:s.uid,mediaType:p},"success"),y.onSuccess()}catch(w){if(w.code===N_.DISCONNECT_P2P)return h_.warning("disconnecting p2p, abort unsubscribe request."),void y.onSuccess();throw h_.error("[".concat(A._clientId,"] unsubscribe user ").concat(s.uid," error"),w.toString()),II("error",A,"unsubscribe",{uid:s.uid,mediaType:p},w.toString()),y.onError(w),w}})()}massUnsubscribe(s){var p=this;return f(function*(){TQ(s,"unsubscribeList");const A=w0.reportApiInvoke(p._sessionId,{name:bI.UNSUBSCRIBE,options:s.map(w=>{let{user:$,mediaType:j}=w;return{uid:null==$?void 0:$.uid,mediaType:j}}),tag:lI.TRACER});if(!p._joinInfo){const w=new U_(N_.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");throw A.onError(w),w}h_.info("[".concat(p._clientId,"] start massUnsubscribe ").concat(s.map(w=>{let{user:$,mediaType:j}=w;return"user: ".concat(null==$?void 0:$.uid,", mediaType: ").concat(j,";")}).join())),II("info",p,"massUnsubscribe",s),s=[...s];const y=new Map;for(let w=s.length-1;w>=0;w--){const{user:$,mediaType:j}=s[w];if(!$){const K=new U_(N_.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw h_.error("[".concat(p._clientId,"] user property does not exist in unsubscribeList item")),A.onError(K),K}if(RR(j,"mediaType",["video","audio",void 0]),!p._users.find(K=>K===$)){h_.warning("[".concat(p._clientId,"] can not subscribe ").concat($.uid,", user is not in the channel")),II("error",p,"unsubscribe",{uid:$.uid,mediaType:j},"user is not in the channel"),s.splice(w,1);continue}const _e=dT.Video|dT.LwoVideo;if(y.has($)){const K=y.get($);let _i;switch(j){case"video":_i=K&_e;break;case"audio":_i=K&dT.Audio;break;default:_i=K&(dT.Audio|_e)}if(_i){h_.warning("repeat massUnsubscribe user:".concat($.uid,",mediaType:").concat(j," twice.")),s.splice(w,1);continue}j?"audio"===j?y.set($,K|dT.Audio):"video"===j&&y.set($,K|_e):y.set($,K|dT.Audio|_e)}else j?"audio"===j?y.set($,dT.Audio):"video"===j&&y.set($,_e):y.set($,dT.Audio|_e)}try{const w=yield p._p2pChannel.massUnsubscribe(s);w&&(yield p._gateway.massUnsubscribe(w)),h_.info("[".concat(p._clientId,"] massUnsubscribe success ").concat(s.map($=>{let{user:j,mediaType:_e}=$;return"user: ".concat(null==j?void 0:j.uid,", mediaType: ").concat(_e,";")}).join())),II("info",p,"massUnsubscribe",s,"success"),A.onSuccess()}catch(w){if(w.code===N_.DISCONNECT_P2P)return h_.warning("disconnecting p2p, abort unsubscribe request."),void A.onSuccess();throw h_.error("[".concat(p._clientId,"] massUnsubscribe error"),w.toString()),II("error",p,"massUnsubscribe",s,w.toString()),A.onError(w),w}})()}setLowStreamParameter(s){!function(y){if(!y)throw new U_(N_.INVALID_PARAMS);l1(y.width)||iT(y.width,"streamParameter.width"),l1(y.height)||iT(y.height,"streamParameter.height"),l1(y.framerate)||iT(y.framerate,"streamParameter.framerate"),l1(y.bitrate)||iT(y.bitrate,"streamParameter.bitrate")}(s);const p=w0.reportApiInvoke(this._sessionId,{name:bI.SET_LOW_STREAM_PARAMETER,options:[s],tag:lI.TRACER});(!s.width&&s.height||s.width&&!s.height)&&(h_.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),sI("warning",this,"The width and height parameters take effect only when both are set")),h_.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(s)),II("info",this,"setLowStreamParameter",s);const A=this._configDistribute.getLowStreamConfigDistribute();A&&A.bitrate&&s.bitrate&&A.bitrate<s.bitrate&&(s.bitrate=A.bitrate),this._lowStreamParameter=s,p.onSuccess()}enableDualStream(){var s=this;return f(function*(){const p=w0.reportApiInvoke(s._sessionId,{name:bI.ENABLE_DUAL_STREAM,options:[],tag:lI.TRACER});if(!bN().supportDualStream){w0.streamSwitch(s._sessionId,{lts:Date.now(),isdual:!0,succ:!1});const A=new U_(N_.NOT_SUPPORTED,"Your browser is not support dual stream");throw p.onError(A),A}if(s._isDualStreamEnabled){const A=new U_(N_.INVALID_OPERATION,"Dual stream is already enabled");throw p.onError(A),A}if(s._p2pChannel.canPublishLowStream())try{yield s._publishLowStream()}catch(A){throw w0.streamSwitch(s._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),p.onError(A),A}s._isDualStreamEnabled=!0,w0.streamSwitch(s._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),h_.info("[".concat(s._clientId,"] enable dual stream")),II("info",s,"enableDualStream"),p.onSuccess()})()}disableDualStream(){var s=this;return f(function*(){if(!s._isDualStreamEnabled)return;if(!s._joinInfo)throw new U_(N_.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");const p=w0.reportApiInvoke(s._sessionId,{name:bI.DISABLE_DUAL_STREAM,options:[],tag:lI.TRACER});if(s._p2pChannel.getLocalMedia(U0.LocalVideoLowTrack))try{const A=yield s._p2pChannel.unpublishLowStream();A&&(yield s._gateway.unpublish(A,s._joinInfo.stringUid||s._joinInfo.uid))}catch(A){throw w0.streamSwitch(s._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),p.onError(A),A}s._isDualStreamEnabled=!1,w0.streamSwitch(s._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),h_.info("[".concat(s._clientId,"] disable dual stream")),II("info",s,"disableDualStream"),p.onSuccess()})()}setClientRole(s,p){var A=this;return f(function*(){var w;RR(w=s,"role",["audience","host"]),p&&mK(p);const y=w0.reportApiInvoke(A._sessionId,{name:bI.SET_CLIENT_ROLE,options:[s,p],tag:lI.TRACER});if("rtc"===A._mode){h_.warning("[".concat(A._clientId,"]rtc mode can not use setClientRole")),II("warning",A,"setClientRole",s,"rtc mode can not use setClientRole");const w=new U_(N_.INVALID_OPERATION,"rtc mode can not use setClientRole");return y.onError(w),w.throw()}if(p&&p.level&&"host"===s){const w=new U_(N_.INVALID_OPERATION,"host mode can not set audience latency level");return y.onError(w),w.throw()}try{if("audience"===s&&A._p2pChannel.hasLocalMedia()){const w=new U_(N_.INVALID_OPERATION,"can not set client role to audience when publishing stream");return y.onError(w),w.throw()}yield A._gateway.setClientRole(s,p),h_.info("[".concat(A._clientId,"] set client role to ").concat(s,", level: ").concat(p&&p.level)),II("info",A,"setClientRole",{role:s,level:p&&p.level}),y.onSuccess()}catch(w){throw y.onError(w),w}})()}setProxyServer(s,p){if(rO(s,"proxyServer"),!p){if("DISCONNECTED"!==this.connectionState)throw new U_(N_.INVALID_OPERATION,"Set proxy server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new U_(N_.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=s,w0.setProxyServer(this._proxyServer),h_.setProxyServer(this._proxyServer),wQ(this._proxyServer),h_.info("[".concat(this._clientId,"] Set proxy server ").concat(p?"by initialize call":""," success.")),II("info",this,"setProxyServer",[...arguments],"success")}setTurnServer(s,p){if(Array.isArray(s)||(s=[s]),!p){if("DISCONNECTED"!==this.connectionState)throw new U_(N_.INVALID_OPERATION,"Set turn server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new U_(N_.INVALID_OPERATION,"You have already set the proxy")}if(vN(s))return this._turnServer={servers:s,mode:"original-manual"},h_.info("[".concat(this._clientId,"] Set original turnserver ").concat(p?"by initialize call":""," success: ").concat(s.map(A=>A.urls).join(","),".")),void II("info",this,"setOriginalTurnServer",[...arguments],"success");s.forEach(A=>bce(A)),this._turnServer={servers:s,mode:"manual"},h_.info("[".concat(this._clientId,"] Set turnserver ").concat(p?"by initialize call":""," success.")),II("info",this,"setTurnServer",[...arguments],"success")}startProxyServer(s){const p=w0.reportApiInvoke(this._sessionId,{name:bI.START_PROXY_SERVER,options:[],tag:lI.TRACER});if("DISCONNECTED"!==this.connectionState){const w=new U_(N_.INVALID_OPERATION,"Start proxy server before join channel");throw p.onError(w),w}if(this._proxyServer||"manual"===this._turnServer.mode||this._useLocalAccessPoint){const w=new U_(N_.INVALID_OPERATION,"You have already set the proxy");throw p.onError(w),w}const A=[1,2,3,4,5];let y;switch(void 0===s&&(s=1),s){case 1:y="normal";break;case 2:y="443only";break;case 3:y="proxy3";break;case 4:y="proxy4";break;case 5:y="proxy5";break;default:{const w=new U_(N_.INVALID_PARAMS,"proxy server mode must be ".concat(A.join("|")));throw p.onError(w),w}}this._cloudProxyServerMode=y,this.store.cloudProxyServerMode=y,h_.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),II("info",this,"startProxyServer",this._cloudProxyServerMode),p.onSuccess()}stopProxyServer(){const s=w0.reportApiInvoke(this._sessionId,{name:bI.STOP_PROXY_SERVER,options:[],tag:lI.TRACER});if("DISCONNECTED"!==this.connectionState)throw new U_(N_.INVALID_OPERATION,"Stop proxy server after leave channel");w0.setProxyServer(),h_.setProxyServer(),wQ(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",h_.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),II("info",this,"stopProxyServer",this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]},s.onSuccess()}setLocalAccessPoints(s,p){if(TQ(s,"serverList"),rO(p,"domain"),this._proxyServer||"disabled"!==this._cloudProxyServerMode)throw new U_(N_.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const A=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;s=s.map(y=>A.test(y)?"".concat(y.replace(/\./g,"-"),".").concat(p):y),this._useLocalAccessPoint=!0,SR("WEBCS_DOMAIN",s),SR("WEBCS_DOMAIN_BACKUP_LIST",s),SR("GATEWAY_DOMAINS",[p]),SR("EVENT_REPORT_DOMAIN",s[0]),SR("EVENT_REPORT_BACKUP_DOMAIN",s[1]||s[0]),SR("LOG_UPLOAD_SERVER","".concat(s[0],":6444")),h_.info("set local access point success"),II("info",this,"setLocalAccessPoints")}setRemoteDefaultVideoStreamType(s){var p=this;return f(function*(){if(RR(s,"streamType",[0,1]),p._remoteDefaultVideoStreamType=s,p._joinInfo)try{yield p._gateway.setDefaultRemoteVideoStreamType(s),p._joinInfo.defaultVideoStream=p._remoteDefaultVideoStreamType}catch(A){throw h_.error("[".concat(p._clientId,"] set default remote video stream type error"),A.toString()),A}else h_.debug("haven't joined yet, cache remoteDefaultVideoStreamType ".concat(s))})()}setRemoteVideoStreamType(s,p){var A=this;return f(function*(){RR(p,"streamType",[0,1]);const y=w0.reportApiInvoke(A._sessionId,{name:bI.SET_REMOTE_VIDEO_STREAM_TYPE,options:[s,p],tag:lI.TRACER});try{yield A._gateway.setRemoteVideoStreamType(s,p),setTimeout(()=>{const w=A._users.find($=>$.uid===s);w&&w.videoTrack&&w.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(w){throw y.onError(w),h_.error("[".concat(A._clientId,"] set remote video stream type error"),w.toString()),II("error",A,"setRemoteVideoStreamType",void 0,w.toString()),w}h_.info("[".concat(A._clientId,"] set remote ").concat(s," video stream type to ").concat(p)),II("info",A,"setRemoteVideoStreamType",{uid:s,streamType:p}),A._remoteStreamTypeCacheMap.set(s,p),y.onSuccess()})()}setStreamFallbackOption(s,p){var A=this;return f(function*(){RR(p,"fallbackType",[0,1,2]);const y=w0.reportApiInvoke(A._sessionId,{name:bI.SET_STREAM_FALLBACK_OPTION,options:["too long to show",p],tag:lI.TRACER});try{yield A._gateway.setStreamFallbackOption(s,p)}catch(w){throw y.onError(w),h_.error("[".concat(A._clientId,"] set stream fallback option"),w.toString()),II("error",A,"setStreamFallbackOption",void 0,w.toString()),w}h_.info("[".concat(A._clientId,"] set remote ").concat(s," stream fallback type to ").concat(p)),II("info",A,"setStreamFallbackOption",{uid:s,fallbackType:p}),A._streamFallbackTypeCacheMap.set(s,p),y.onSuccess()})()}setEncryptionConfig(s,p,A){if(RR(s,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"]),rO(p,"secret"),["aes-128-gcm2","aes-256-gcm2"].includes(s)){if(!A||!(A instanceof Uint8Array&&32===A.length))throw new U_(N_.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(A)throw new U_(N_.INVALID_PARAMS,"current encrypt mode does not need salt");new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'\"|{}\\[\\]])(?=.{8,})").test(p)||(h_.warning("The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer.\n      "),sI("warning",this,"The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer.\n      ")),this._encryptionMode=s,this._encryptionSecret=p,A&&(this._encryptionSalt=JK(A))}renewToken(s){var p=this;return f(function*(){rO(s,"token",1,2047);const A=w0.reportApiInvoke(p._sessionId,{name:bI.RENEW_TOKEN,options:[s],tag:lI.TRACER});if(!p._key||!p._joinInfo){const $=new U_(N_.INVALID_OPERATION,"renewToken should not be called before user join");return A.onError($),$.throw()}const y=p._key;p._key=s,p._joinInfo&&(p._joinInfo.token=s);const w=yield p._renewTokenMutex.lock();try{if(v0("USE_NEW_TOKEN")){h_.debug("start renew token with ticket from unilbs"),II("debug",p,"renewToken","unilbs");const $=yield function _me(s,p,A){return h9.apply(this,arguments)}(p._joinInfo,p._axiosCancelSource.token,p._config.httpRetryConfig||pS);h_.debug("[".concat(p._clientId,"] get ticket from unilbs success")),II("debug",p,"renewToken","unilbs","success"),yield p._gateway.renewToken({token:s,ticket:$})}else h_.debug("start renew token without ticket"),II("debug",p,"renewToken"),yield p._gateway.renewToken({token:s});h_.debug("[".concat(p._clientId,"] renewToken success")),II("debug",p,"renewToken",void 0,"success"),A.onSuccess()}catch($){throw p._key=y,p._joinInfo.token=y,A.onError($),h_.error("[".concat(p._clientId,"] renewToken failed"),$.toString()),II("error",p,"renewToken",void 0,$.toString()),$}finally{w()}})()}enableAudioVolumeIndicator(){const s=w0.reportApiInvoke(this._sessionId,{name:bI.ENABLE_AUDIO_VOLUME_INDICATOR,options:[],tag:lI.TRACER});if(this._audioVolumeIndicationInterval)return h_.warning("you have already enabled audio volume indicator!"),II("warning",this,"enableAudioVolumeIndicator","you have already enabled audio volume indicator!"),s.onSuccess();this._audioVolumeIndicationInterval=window.setInterval(()=>{const p=this._p2pChannel.getAudioLevels();this.emit(d1.VOLUME_INDICATOR,p)},v0("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3),s.onSuccess()}getRTCStats(){const s=this._statsCollector.getRTCStats(),p=this._gateway.getInChannelInfo();return s.Duration=Math.round(p.duration/1e3),s}startLiveStreaming(s,p){const A=w0.reportApiInvoke(this._sessionId,{name:bI.START_LIVE_STREAMING,options:[s,p],tag:lI.TRACER});if(!p){if("h264"!==this._codec){const w=new U_(N_.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");return A.onError(w),iI.reject(w)}if(!this._p2pChannel.hasLocalMedia()){const w=new U_(N_.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming");return A.onError(w),iI.reject(w)}}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(s)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(s)){const w=new U_(N_.LIVE_STREAMING_TASK_CONFLICT);return A.onError(w),iI.reject(w)}const y=p?UT.TRANSCODE:UT.RAW;return this._createLiveStreamingClient(y).startLiveStreamingTask(s,y).then(()=>A.onSuccess()).catch(w=>{throw A.onError(w),w})}setLiveTranscoding(s){const p=w0.reportApiInvoke(this._sessionId,{name:bI.SET_LIVE_TRANSCODING,options:[s],tag:lI.TRACER});return this._createLiveStreamingClient(UT.TRANSCODE).setTranscodingConfig(s).then(()=>p.onSuccess()).catch(A=>{throw p.onError(A),A})}stopLiveStreaming(s){const p=w0.reportApiInvoke(this._sessionId,{name:bI.STOP_LIVE_STREAMING,options:[s],tag:lI.TRACER}),A=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(y=>y&&y.hasUrl(s));if(!A.length){const y=new U_(N_.INVALID_PARAMS,"can not find live streaming url to stop");return p.onError(y),iI.reject(y)}return iI.all(A.map(y=>y&&y.stopLiveStreamingTask(s))).then(()=>p.onSuccess()).catch(y=>{throw p.onError(y),y})}addInjectStreamUrl(s,p){var A=this;return f(function*(){const y=w0.reportApiInvoke(A._sessionId,{name:bI.ADD_INJECT_STREAM_URL,options:[s,p],tag:lI.TRACER});try{if(!A._joinInfo)throw new U_(N_.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");const w=A._createLiveStreamingClient(UT.INJECT);w.setInjectStreamConfig(p,0),yield w.startLiveStreamingTask(s,UT.INJECT)}catch(w){throw y.onError(w),w}y.onSuccess()})()}removeInjectStreamUrl(){var s=this;return f(function*(){const p=w0.reportApiInvoke(s._sessionId,{name:bI.REMOVE_INJECT_STREAM_URL,options:[],tag:lI.TRACER});try{var A;const y=s._createLiveStreamingClient(UT.INJECT),w=Array.from(rP(A=y.streamingTasks).call(A)).find($=>$.mode===UT.INJECT);if(!s._joinInfo||!w)throw new U_(N_.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");yield y.stopLiveStreamingTask(w.url)}catch(y){throw p.onError(y),y}p.onSuccess()})()}startChannelMediaRelay(s){var p=this;return f(function*(){const A=w0.reportApiInvoke(p._sessionId,{name:bI.START_CHANNEL_MEDIA_RELAY,options:[s],tag:lI.TRACER});try{ide(s),yield p._createChannelMediaRelayClient().startChannelMediaRelay(s)}catch(y){return A.onError(y),y.throw()}A.onSuccess()})()}updateChannelMediaRelay(s){var p=this;return f(function*(){const A=w0.reportApiInvoke(p._sessionId,{name:bI.UPDATE_CHANNEL_MEDIA_RELAY,options:[s],tag:lI.TRACER});try{ide(s),yield p._createChannelMediaRelayClient().updateChannelMediaRelay(s)}catch(y){return A.onError(y),y.throw()}A.onSuccess()})()}stopChannelMediaRelay(){var s=this;return f(function*(){const p=w0.reportApiInvoke(s._sessionId,{name:bI.STOP_CHANNEL_MEDIA_RELAY,options:[],tag:lI.TRACER});try{yield s._createChannelMediaRelayClient().stopChannelMediaRelay()}catch(A){return p.onError(A),A.throw()}p.onSuccess()})()}sendStreamMessage(s){let p=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this._joinInfo)throw new U_(N_.INVALID_OPERATION,"can not send data stream, not joined");if("string"==typeof s&&(s=(new TextEncoder).encode(s)),new Blob([s]).size>1024)throw new U_(N_.INVALID_PARAMS,"stream message out of range.");return this._gateway.signal.request(h1.DATA_STREAM,{payload:JK(s)},!p)}sendMetadata(s){if(!this._joinInfo)throw new U_(N_.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([s]).size>1024)throw new U_(N_.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(h1.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:JK(s)})}sendCustomReportMessage(s){var p=this;return f(function*(){Array.isArray(s)||(s=[s]),s.forEach(yce);const A=w0.reportApiInvoke(p._sessionId,{name:bI.SEND_CUSTOM_REPORT_MESSAGE,options:[JSON.stringify(s)],tag:lI.TRACER});if(!p._joinInfo){const y=new U_(N_.INVALID_OPERATION,"can not send custom report, not joined");return A.onError(y),y.throw()}yield w0.sendCustomReportMessage(p._joinInfo.sid,s),A.onSuccess()})()}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}pickSVCLayer(s,p){var A=this;return f(function*(){RR(p.spatialLayer,"spatialLayer",[0,1,2,3]),RR(p.temporalLayer,"temporalLayer",[0,1,2,3]);try{yield A._gateway.pickSVCLayer(s,p)}catch(y){throw h_.error("[".concat(A._clientId,"] pick SVC layer failed"),y.toString()),S0("error",A,"pickSVCLayer",p,y.toString()),y}})()}_reset(){h_.debug("[".concat(this._clientId,"] reset client")),S0("debug",this,"_reset"),this._axiosCancelSource.cancel(),this._axiosCancelSource=JU.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._users.forEach(s=>{s._audioTrack&&s._audioTrack._destroy(),s._videoTrack&&s._videoTrack._destroy()}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),"fallback"===this._cloudProxyServerMode&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new iP("client-publish"),this._subscribeMutex=new iP("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0)}_startSession(s,p){const A=s||$ue();h_.debug(s?"[".concat(this._clientId,"] new Session ").concat(A):"[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(A)),S0("debug",this,"_startSession",{newSid:A,sid:this._sessionId}),this._sessionId=A,this.store.sessionId=A,p?w0.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:p.channel,appid:p.appId,mode:this._mode}):this._joinInfo?w0.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:this._joinInfo.cname,appid:this._joinInfo.appId,mode:this._mode}):this._gateway.joinInfo&&w0.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId,mode:this._mode}),this._joinInfo&&(this._joinInfo.sid=A),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=A)}_publishHighStream(s){var p=this;return f(function*(){if(!p._joinInfo||void 0===p._uid)throw new U_(N_.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==p.connectionState&&"RECONNECTING"!==p.connectionState)throw new U_(N_.INVALID_OPERATION,"can not publish stream in ".concat(p.connectionState," state"));if("auto"===p._turnServer.mode&&v0("FORCE_TURN")&&!v0("TURN_ENABLE_TCP")&&!v0("TURN_ENABLE_UDP"))throw new U_(N_.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");h_.debug("[".concat(p._clientId,"] publish high stream")),S0("debug",p,"_publishHighStream");try{const y=yield p._p2pChannel.publish(s,p._isDualStreamEnabled,p._lowStreamParameter),w=(yield y.next()).value;if(w){var A;let $;try{$=yield p._gateway.publish(p._uid,w,!0)}catch(j){if(j.code!==N_.DISCONNECT_P2P)throw y.throw(j),j}yield y.next((null===(A=$)||void 0===A?void 0:A.ortc)||[])}p._p2pChannel.reportPublishEvent(!0,null);for(const $ of s)$ instanceof yS&&$._encoderConfig&&p._gateway.setVideoProfile($._encoderConfig),!$.muted&&$.enabled||(yield p._p2pChannel.muteLocalTrack($))}catch(y){if(p._p2pChannel.reportPublishEvent(!1,null==y?void 0:y.code,s),(null==y?void 0:y.code)===N_.WS_ABORT)return;throw y}})()}_publishLowStream(){var s=this;return f(function*(){if(!s._joinInfo||void 0===s._uid)throw new U_(N_.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==s.connectionState&&"RECONNECTING"!==s.connectionState)throw new U_(N_.INVALID_OPERATION,"can not publish stream in ".concat(s.connectionState," state"));h_.debug("[".concat(s._clientId,"] publish low stream")),S0("debug",s,"_publishLowStream");const p=s._configDistribute.getLowStreamConfigDistribute();p&&p.bitrate&&(s._lowStreamParameter||(s._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),s._lowStreamParameter&&s._lowStreamParameter.bitrate&&p.bitrate<s._lowStreamParameter.bitrate&&(s._lowStreamParameter.bitrate=p.bitrate));try{const y=yield s._p2pChannel.publishLowStream(s._lowStreamParameter),w=(yield y.next()).value;if(w){var A;let $;try{$=yield s._gateway.publish(s._uid,w,!0)}catch(j){if(j.code!==N_.DISCONNECT_P2P)throw y.throw(j),j}y.next((null===(A=$)||void 0===A?void 0:A.ortc)||[]),s._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(y){if(s._p2pChannel.reportPublishEvent(!1,null==y?void 0:y.code,void 0,!0),(null==y?void 0:y.code)===N_.WS_ABORT)return;throw y}})()}_createLiveStreamingClient(s){if(!this._joinInfo||!this._appId)return new U_(N_.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const p=()=>new HM(this._joinInfo,this._config.websocketRetryConfig||pS,this._config.httpRetryConfig||pS),A=y=>{y.onLiveStreamError=(w,$)=>{w0.reportApiInvoke(this._sessionId,{name:bI.ON_LIVE_STREAM_ERROR,options:[w,$],tag:lI.TRACER}).onSuccess(),this.emit(d1.LIVE_STREAMING_ERROR,w,$)},y.onLiveStreamWarning=(w,$)=>{w0.reportApiInvoke(this._sessionId,{name:bI.ON_LIVE_STREAM_WARNING,options:[w,$],tag:lI.TRACER}).onSuccess(),this.emit(d1.LIVE_STREAMING_WARNING,w,$)},y.on(w6.REQUEST_WORKER_MANAGER_LIST,(w,$,j)=>{if(!this._joinInfo)return j(new U_(N_.INVALID_OPERATION,"can not find join info to get worker manager"));Ame(w,this._joinInfo,this._axiosCancelSource.token,pS).then($).catch(j)})};switch(s){case UT.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=p(),A(this._liveRawStreamingClient)),this._liveRawStreamingClient;case UT.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=p(),A(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case UT.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=p(),this._injectStreamingClient.on(w6.REQUEST_WORKER_MANAGER_LIST,(y,w,$)=>{if(!this._joinInfo)return $(new U_(N_.INVALID_OPERATION,"can not find join info to get worker manager"));Ame(y,this._joinInfo,this._axiosCancelSource.token,pS).then(w).catch($)}),this._injectStreamingClient.onInjectStatusChange=(y,w,$)=>{this.emit(d1.INJECT_STREAM_STATUS,y,w,$)}),this._injectStreamingClient}}_createChannelMediaRelayClient(){return this._joinInfo?(this._channelMediaRelayClient||(this._channelMediaRelayClient=new PX(this._joinInfo,this._clientId,this._config.websocketRetryConfig||pS,this._config.httpRetryConfig||pS),this._channelMediaRelayClient.on("state",s=>{s===yN.RELAY_STATE_FAILURE&&this._channelMediaRelayClient&&this._channelMediaRelayClient.dispose(),this.emit(d1.CHANNEL_MEDIA_RELAY_STATE,s)}),this._channelMediaRelayClient.on("event",s=>{this.emit(d1.CHANNEL_MEDIA_RELAY_EVENT,s)})),this._channelMediaRelayClient):new U_(N_.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw()}_handleGatewayEvents(){var s=this;this._gateway.on(FT.DISCONNECT_P2P,f(function*(){yield s._p2pChannel.disconnectForReconnect()})),this._gateway.on(FT.CONNECTION_STATE_CHANGE,(p,A,y)=>{var w;if(y===gS.FALLBACK)return;const $=()=>{this.emit(d1.CONNECTION_STATE_CHANGE,p,A,y)};if(w0.reportApiInvoke(this._sessionId||(null===(w=this._gateway.joinInfo)||void 0===w?void 0:w.sid)||null,{name:bI.CONNECTION_STATE_CHANGE,options:[p,A,y],tag:lI.TRACER}).onSuccess(JSON.stringify({cur:p,prev:A,reason:y})),h_.info("[".concat(this._clientId,"] connection state change: ").concat(A," -> ").concat(p)),lT("info",this,"connection-state-change","".concat(A," -> ").concat(p)),"DISCONNECTED"===p)return this._reset(),void $();if("RECONNECTING"===p)this._users.forEach(_e=>{_e._trust_in_room_=!1,_e._trust_audio_enabled_state_=!1,_e._trust_video_enabled_state_=!1,_e._trust_audio_mute_state_=!1,_e._trust_video_mute_state_=!1,_e._trust_stream_added_state_=!1}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if("CONNECTED"===p){var j;this._streamFallbackTypeCacheMap.forEach((_e,K)=>{this._gateway.setStreamFallbackOption(K,_e).catch(_i=>{h_.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),_i),sI("warning",this,"auto set stream fallback option failed, ".concat(_i.toString()))})}),this._remoteStreamTypeCacheMap.forEach((_e,K)=>{this._gateway.setRemoteVideoStreamType(K,_e).catch(_i=>{h_.warning("[".concat(this._clientId,"] auto set remote stream type failed"),_i),sI("warning",this,"auto set remote stream type failed, ".concat(_i.toString()))})}),void 0!==this._remoteDefaultVideoStreamType&&void 0===(null===(j=this._joinInfo)||void 0===j?void 0:j.defaultVideoStream)&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{h_.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(_e=>{h_.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(_e))}),this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{"CONNECTED"===this.connectionState&&(this._userOfflineTimeout=void 0,this._users.filter(_e=>!_e._trust_in_room_).forEach(_e=>{h_.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(_e.uid)),sI("debug",this,"user offline timeout, emit user offline ".concat(_e.uid)),this._handleUserOffline({uid:_e.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{"CONNECTED"===this.connectionState&&(this._streamRemovedTimeout=void 0,this._users.forEach(_e=>{_e._trust_audio_mute_state_||(h_.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(_e.uid)),sI("debug",this,"auto dispatch audio unmute event ".concat(_e.uid)),this._handleMuteStream(_e.uid,"audio",!1)),_e._trust_video_mute_state_||(h_.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(_e.uid)),sI("debug",this,"auto dispatch video unmute event ".concat(_e.uid)),this._handleMuteStream(_e.uid,"video",!1)),_e._trust_audio_enabled_state_||(h_.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(_e.uid)),sI("debug",this,"auto dispatch enable local audio ".concat(_e.uid)),this._handleSetStreamLocalEnable("audio",_e.uid,!0)),!_e._trust_video_enabled_state_&&_e._video_enabled_&&(h_.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(_e.uid)),sI("debug",this,"auto dispatch enable local video ".concat(_e.uid)),this._handleSetStreamLocalEnable("video",_e.uid,!0)),_e._trust_stream_added_state_||(h_.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(_e.uid)),sI("debug",this,"auto dispatch stream remove ".concat(_e.uid)),this._handleRemoveStream({uid:_e.uid,uint_id:_e._uintid}))}))},1e3)}$()}),this._gateway.on(FT.REQUEST_NEW_GATEWAY_LIST,(p,A)=>{if(!this._joinInfo)return A(new U_(N_.UNEXPECTED_ERROR,"can not recover, no join info"));d3(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||pS,this.store).then(y=>{this._joinInfo&&(this._joinInfo.apResponse=y.gatewayInfo.res,this._joinInfo.gatewayAddrs=y.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=y.gatewayInfo.uni_lbs_ip),p(y.gatewayInfo.gatewayAddrs.map(w=>{if(this._joinInfo&&this._joinInfo.proxyServer){const $=w.address.split(":");return"wss://".concat(this._joinInfo.proxyServer,"/ws/?h=").concat($[0],"&p=").concat($[1])}return"wss://".concat(w.address)}))}).catch(A)}),this._gateway.on(FT.NETWORK_QUALITY,p=>{"normal"===this._networkQualitySensitivity&&this.emit(d1.NETWORK_QUALITY,p)}),this._gateway.on(FT.STREAM_TYPE_CHANGE,(p,A)=>{this.emit(d1.STREAM_TYPE_CHANGED,p,A),w0.reportApiInvoke(this._sessionId,{name:bI.STREAM_TYPE_CHANGE,options:[p,A],tag:lI.TRACER}).onSuccess(JSON.stringify({uid:p,streamType:A}))}),this._gateway.on(FT.IS_P2P_DISCONNECTED,p=>{this._p2pChannel.isP2PDisconnected()?p(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?p(!1):p(!0)}),this._gateway.on(FT.NEED_RENEW_SESSION,()=>{this._startSession()}),this._gateway.on(FT.REQUEST_P2P_CONNECTION_PARAMS,function(){var p=f(function*(A,y,w){try{y(yield s._p2pChannel.startP2PConnection(A))}catch($){w($)}});return function(A,y,w){return p.apply(this,arguments)}}()),this._gateway.on(FT.JOIN_RESPONSE,(p,A,y)=>{const{dtlsParameters:w,iceParameters:$,candidates:j,rtpCapabilities:_e,setup:K,cname:_i}=e0e(p.ortc,A,y);this._p2pChannel.connect($,w,j,_e,K,_i)}),this._gateway.signal.on(V1.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(V1.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(V1.ON_ADD_AUDIO_STREAM,p=>this._handleAddAudioOrVideoStream("audio",p.uid,p.ssrcId,p.cname,p.uint_id,p.ortc)),this._gateway.signal.on(V1.ON_ADD_VIDEO_STREAM,p=>this._handleAddAudioOrVideoStream("video",p.uid,p.ssrcId,p.cname,p.uint_id,p.ortc,p.rtxSsrcId)),this._gateway.signal.on(V1.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(V1.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(V1.MUTE_AUDIO,p=>(lT("debug",["AgoraRTCGateway",this._clientId],"mute_audio",{uid:p.uid}),this._handleMuteStream(p.uid,"audio",!0))),this._gateway.signal.on(V1.UNMUTE_AUDIO,p=>(lT("debug",["AgoraRTCGateway",this._clientId],"unmute_audio",{uid:p.uid}),this._handleMuteStream(p.uid,"audio",!1))),this._gateway.signal.on(V1.MUTE_VIDEO,p=>(lT("debug",["AgoraRTCGateway",this._clientId],"mute_video",{uid:p.uid}),this._handleMuteStream(p.uid,"video",!0))),this._gateway.signal.on(V1.UNMUTE_VIDEO,p=>(lT("debug",["AgoraRTCGateway",this._clientId],"unmute_video",{uid:p.uid}),this._handleMuteStream(p.uid,"video",!1))),this._gateway.signal.on(V1.RECEIVE_METADATA,p=>{const A=pX(p.metadata);this.emit(d1.RECEIVE_METADATA,p.uid,A)}),this._gateway.signal.on(V1.ON_DATA_STREAM,p=>{p.seq&&delete p.seq,p.payload=pX(p.payload),this.emit(d1.STREAM_MESSAGE,p.uid,p.payload),this.onStreamMessage&&this.onStreamMessage(p)}),this._gateway.signal.on(V1.ON_CRYPT_ERROR,()=>{YK(()=>{h_.warning("[".concat(this._clientId,"] on crypt error")),lT("warning",this,"crypt_error"),this.emit(d1.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(V1.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(V1.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{h_.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),lT("warning",this,"token_privilege_did_expire"),this._gateway.leave(!0),this.emit(d1.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(V1.ON_STREAM_FALLBACK_UPDATE,p=>{h_.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(p.stream_id,", attr: ").concat(p.stream_type)),lT("debug",this,"stream_fallback_update",{peerId:p.stream_id,attr:p.stream_type}),this.emit(d1.STREAM_FALLBACK,p.stream_id,1===p.stream_type?"fallback":"recover")}),this._gateway.signal.on(V1.ON_PUBLISH_STREAM,p=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:p.proxy})),h_.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(p))),lT("info",this,"publish_stream",p))}),this._gateway.signal.on(V1.ENABLE_LOCAL_VIDEO,p=>{this._handleSetStreamLocalEnable("video",p.uid,!0)}),this._gateway.signal.on(V1.DISABLE_LOCAL_VIDEO,p=>{this._handleSetStreamLocalEnable("video",p.uid,!1)}),this._gateway.signal.on(i1.REQUEST_TIMEOUT,(p,A)=>{if(this._joinInfo)switch(p){case h1.PUBLISH:{if(!A)return;const _e=(A=A).ortc;if(_e){var y,w,$,j;const K=_e.some(_u=>{let{stream_type:ch}=_u;return ch===KT.Audio}),_i=_e.some(_u=>{let{stream_type:ch}=_u;return ch!==KT.Audio}),_o=_e.some(_u=>{let{stream_type:ch}=_u;return ch===KT.Screen||ch===KT.ScreenLow});"offer"===A.state&&w0.publish(this._joinInfo.sid,{eventElapse:WL.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:N_.TIMEOUT,audio:K,video:_i,p2pid:A.p2p_id,publishRequestid:this.store.pubId,screenshare:_o,audioName:K?null===(y=_e.find(_u=>{let{stream_type:ch}=_u;return ch===KT.Audio}))||void 0===y||null===(w=y.ssrcs[0])||void 0===w?void 0:w.ssrcId.toString():void 0,videoName:_i?null===($=_e.find(_u=>{let{stream_type:ch}=_u;return ch!==KT.Audio}))||void 0===$||null===(j=$.ssrcs[0])||void 0===j?void 0:j.ssrcId.toString():void 0})}break}case h1.SUBSCRIBE:(A=A)&&w0.subscribe(this._joinInfo.sid,{succ:!1,ec:N_.TIMEOUT,audio:A.stream_type===o1.AUDIO,video:A.stream_type===o1.VIDEO,peerid:A.stream_id,subscribeRequestid:A.ssrcId,p2pid:this.store.p2pId,eventElapse:WL.measureFromSubscribeStart(this.store.clientId,A.ssrcId)})}}),this._gateway.signal.on(V1.ON_P2P_OK,p=>{}),this._gateway.signal.on(V1.ON_PUBLISHED_USER_LIST,p=>{if(null==p||!p.users)return;const A=[],y=[];for(const w of p.users){let $=this._users.find(_o=>_o.uid===w.stream_id);$?$._trust_in_room_=!0:($=new Rye(w.stream_id,w.stream_id),this._users.push($),0===this.getListeners(d1.PUBLISHED_USER_LIST).length&&(h_.debug("[".concat(this._clientId,"] user online"),w.stream_id),BL("info",this,"user-joined",{uid:w.stream_id}),this.emit(d1.USER_JOINED,$)));const j=dT.Audio&w.stream_type,_e=(dT.Video|dT.LwoVideo)&w.stream_type,K=j&&$.hasAudio,_i=_e&&$.hasVideo;w.stream_type!==dT.Nothing&&($._trust_stream_added_state_=!0),_e&&($._video_added_=!0,$._videoSSRC=w.video_ssrc),j&&($._audio_added_=!0,$._audioSSRC=w.audio_ssrc),j&&!K&&0===this.getListeners(d1.PUBLISHED_USER_LIST).length&&(h_.info("[".concat(this._clientId,"] remote user ").concat($.uid," published audio")),sI("info",this,"remote user ".concat($.uid," published audio")),this.emit(d1.USER_PUBLISHED,$,"audio")),_e&&!_i&&0===this.getListeners(d1.PUBLISHED_USER_LIST).length&&(h_.info("[".concat(this._clientId,"] remote user ").concat($.uid," published video")),sI("info",this,"remote user ".concat($.uid," published video")),this.emit(d1.USER_PUBLISHED,$,"video")),(j&&!K||_e&&!_i)&&A.push($),_e&&this._p2pChannel.hasPendingRemoteMedia($,"video")&&y.push({user:$,mediaType:"video"}),j&&this._p2pChannel.hasPendingRemoteMedia($,"audio")&&y.push({user:$,mediaType:"audio"})}y.length>0&&(h_.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(y.map(w=>"user: ".concat(w.user.uid,", mediaType: ").concat(w.mediaType)).join("; ")," ")),this.massSubscribe(y).catch(w=>{h_.error("[".concat(this._clientId,"] mass resubscribe error"),w.toString())})),this.getListeners(d1.PUBLISHED_USER_LIST).length>0?(h_.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(A.map(w=>w.uid).join(", "))),this.emit(d1.PUBLISHED_USER_LIST,A)):h_.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(A.map(w=>w.uid).join(", ")))})}_handleP2PChannelEvents(){var s=this;this._p2pChannel.on(I1.RequestMuteLocal,function(){var p=f(function*(A,y,w){if(s._joinInfo)try{yield s._gateway.muteLocal(A,s._joinInfo.stringUid||s._joinInfo.uid),y()}catch($){$.code===N_.DISCONNECT_P2P?y():w($)}else y()});return function(A,y,w){return p.apply(this,arguments)}}()),this._p2pChannel.on(I1.RequestUnmuteLocal,function(){var p=f(function*(A,y,w){if(s._joinInfo)try{yield s._gateway.unmuteLocal(A,s._joinInfo.stringUid||s._joinInfo.uid),y()}catch($){$.code===N_.DISCONNECT_P2P?y():w($)}else y()});return function(A,y,w){return p.apply(this,arguments)}}()),this._p2pChannel.on(I1.RequestRePublish,(p,A,y)=>{this.publish(p,!1).then(A).catch(y)}),this._p2pChannel.on(I1.RequestReSubscribe,function(){var p=f(function*(A,y,w){try{for(const{user:$,kind:j}of A)j===o1.VIDEO?yield s.subscribe($,"video"):yield s.subscribe($,"audio");y()}catch($){w($)}});return function(A,y,w){return p.apply(this,arguments)}}()),this._p2pChannel.on(I1.RequestUploadStats,(p,A)=>{this._gateway.uploadStats(p,A)}),this._p2pChannel.on(I1.MediaReconnectStart,p=>{this.emit(d1.MEDIA_RECONNECT_START,p)}),this._p2pChannel.on(I1.MediaReconnectEnd,p=>{this.emit(d1.MEDIA_RECONNECT_END,p)}),this._p2pChannel.on(I1.NeedSignalRTT,p=>{p(this._gateway.getSignalRTT())}),this._p2pChannel.on(I1.RequestRestartICE,f(function*(){const p=yield s._p2pChannel.reEstablish();if(p){const{restartICEResponse:A,gatewayIP:y,gatewayPort:w}=yield s._gateway.restartICE({iceParameters:p.iceParameters}),{candidates:$,iceParameters:j}=function(_e,K,_i){const _o=_e.ice;let _u;return void 0!==K&&void 0!==_i?(_u=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:K,port:_i.toString(),type:"host",extension:{}}],h_.debug("Using remote candidate from AP ".concat(K,":").concat(_i)),sI("debug",[],"Using remote candidate from AP ".concat(K,":").concat(_i))):_u=_o.candidates.map(ch=>({foundation:ch.foundation,componentId:"1",transport:ch.protocol,priority:ch.priority.toString(),connectionAddress:ch.ip,port:ch.port.toString(),type:ch.type,extension:{}})),{candidates:_u,iceParameters:{iceUfrag:_o.iceUfrag,icePwd:_o.icePwd}}}(A,y,w);yield p.restartICE(j,$)}})),this._p2pChannel.on(I1.RequestReconnect,f(function*(){s._gateway.reconnect()})),this._p2pChannel.on(I1.RequestReconnectPC,f(function*(){var p;const{iceParameters:A,dtlsParameters:y,rtpCapabilities:w}=yield s._p2pChannel.startP2PConnection({turnServer:null===(p=s._joinInfo)||void 0===p?void 0:p.turnServer}),{gatewayEstablishParams:$,gatewayIP:j,gatewayPort:_e}=yield s._gateway.reconnectPC({iceParameters:A,dtlsParameters:y,rtpCapabilities:w}),{dtlsParameters:K,iceParameters:_i,candidates:_o,rtpCapabilities:_u,setup:ch,cname:_f}=e0e($,j,_e);yield s._p2pChannel.connect(_i,K,_o,_u,ch,_f),yield s._p2pChannel.republish(),yield s._p2pChannel.reSubscribe()})),this._p2pChannel.on(I1.RequestUnpublishForReconnectPC,function(){var p=f(function*(A,y,w){s._joinInfo&&void 0!==s._uid?(yield s._gateway.unpublish(A,s._uid),y()):w()});return function(A,y,w){return p.apply(this,arguments)}}()),this._p2pChannel.on(I1.P2PLost,()=>{this.emit(d1.P2P_LOST,this.store.uid)}),this._p2pChannel.on(I1.UpdateVideoEncoder,p=>{p._encoderConfig&&this._gateway.setVideoProfile(p._encoderConfig)}),this._p2pChannel.on(I1.ConnectionTypeChange,p=>{this.emit(d1.IS_USING_CLOUD_PROXY,p)})}getKeyMetrics(){return this.store.keyMetrics}getJoinChannelServiceRecords(){return h_.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}}).prototype,"setProxyServer",[M0e],Object.getOwnPropertyDescriptor(lO.prototype,"setProxyServer"),lO.prototype),gI(lO.prototype,"setTurnServer",[B0e],Object.getOwnPropertyDescriptor(lO.prototype,"setTurnServer"),lO.prototype),gI(lO.prototype,"setLocalAccessPoints",[U0e],Object.getOwnPropertyDescriptor(lO.prototype,"setLocalAccessPoints"),lO.prototype),gI(lO.prototype,"setRemoteDefaultVideoStreamType",[F0e],Object.getOwnPropertyDescriptor(lO.prototype,"setRemoteDefaultVideoStreamType"),lO.prototype),gI(lO.prototype,"setEncryptionConfig",[j0e],Object.getOwnPropertyDescriptor(lO.prototype,"setEncryptionConfig"),lO.prototype),gI(lO.prototype,"pickSVCLayer",[V0e],Object.getOwnPropertyDescriptor(lO.prototype,"pickSVCLayer"),lO.prototype),gI(lO.prototype,"getJoinChannelServiceRecords",[G0e],Object.getOwnPropertyDescriptor(lO.prototype,"getJoinChannelServiceRecords"),lO.prototype),Q0e=lO))||Q0e);class Cbe extends oP{set currentState(p){p!==this._currentState&&(this._currentState=p,this.emit(s2.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(p){let A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),a_(this,"audioBuffer",void 0),a_(this,"sourceNode",void 0),a_(this,"startPlayTime",0),a_(this,"startPlayOffset",0),a_(this,"pausePlayTime",0),a_(this,"options",void 0),a_(this,"currentLoopCount",0),a_(this,"_currentState","stopped"),this.audioBuffer=p,this.options=A,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer.duration}get currentTime(){return"stopped"===this.currentState?0:"paused"===this.currentState?this.pausePlayTime:(this.context.currentTime-this.startPlayTime+this.startPlayOffset)%this.audioBuffer.duration}updateOptions(p){"stopped"===this.currentState?(this.options=p,this.startPlayOffset=this.options.startPlayTime||0):h_.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&"playing"===this.currentState&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(p){this.sourceNode&&(this.sourceNode.onended=null,"playing"===this.currentState&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),"playing"===this.currentState?(this.startPlayOffset=p,this.startSourceNode()):"paused"===this.currentState&&(this.pausePlayTime=p))}resumeProcessAudioBuffer(){"paused"===this.currentState&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch(p){}this.reset()}}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const p=this.context.createBufferSource();return p.buffer=this.audioBuffer,p.loop=!!this.options.loop,p.connect(this.outputNode),p}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const q0e=new Map;function eEe(){return eEe=f(function*(s,p){let A=null;if("string"==typeof s){const w=q0e.get(s);if(w)return h_.debug("use cached audio resource: ",s),w;try{A=(yield LL(()=>JU.get(s,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch($){throw new U_(N_.FETCH_AUDIO_FILE_FAILED,$.toString())}}else A=yield new iI(($,j)=>{const _e=new FileReader;_e.onload=K=>{K.target?$(K.target.result):j(new U_(N_.READ_LOCAL_AUDIO_FILE_ERROR))},_e.onerror=()=>{j(new U_(N_.READ_LOCAL_AUDIO_FILE_ERROR))},_e.readAsArrayBuffer(s)});const y=yield function(w){const $=nX();return new iI((j,_e)=>{$.decodeAudioData(w,K=>{j(K)},K=>{_e(new U_(N_.DECODE_AUDIO_FILE_FAILED,K.toString()))})})}(A);return"string"==typeof s&&p&&q0e.set(s,y),y}),eEe.apply(this,arguments)}function W0e(s,p){var A=Object.keys(s);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(s);p&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),A.push.apply(A,y)}return A}function zme(s){for(var p=1;p<arguments.length;p++){var A=null!=arguments[p]?arguments[p]:{};p%2?W0e(Object(A),!0).forEach(function(y){a_(s,y,A[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(A)):W0e(Object(A)).forEach(function(y){Object.defineProperty(s,y,Object.getOwnPropertyDescriptor(A,y))})}return s}function tEe(s,p,A,y){A.optimizationMode&&(y&&y.width&&y.height?(A.encoderConfig=zme(zme({},y),{},{bitrateMin:y.bitrateMin,bitrateMax:y.bitrateMax}),"motion"!==A.optimizationMode&&"detail"!==A.optimizationMode||(p.contentHint=A.optimizationMode,p.contentHint===A.optimizationMode?(h_.debug("[".concat(s,"] set content hint to"),A.optimizationMode),II("debug",["AgoraRTC"],"videoTrackOptimizationModeProcess",[s,A,y])):(h_.debug("[".concat(s,"] set content hint failed")),II("warning",["AgoraRTC"],"videoTrackOptimizationModeProcess",[s,A,y],"failed")))):(h_.warning("[".concat(s,"] can not apply optimization mode bitrate config, no encoderConfig")),sI("warning",["AgoraRTC"],"[".concat(s,"] can not apply optimization mode bitrate config, no encoderConfig"))))}const Tbe=Y1().name;function Sbe(s,p,A,y){let w,$=0,j=null;return new iI((_e,K)=>{setTimeout(()=>{w&&(w(),_e($))},p),w=QK(()=>{!function(){$>y&&w&&(w(),_e($));const _i=A.getContext("2d");if(!_i){const ch=new U_(N_.UNEXPECTED_ERROR,"can not get canvas 2d context.");return h_.error(ch.toString()),void K(ch)}_i.drawImage(s,0,0,160,120);const _o=_i.getImageData(0,0,A.width,A.height),_u=Math.floor(_o.data.length/3);if(j){for(let ch=0;ch<_u;ch+=3)if(_o.data[ch]!==j[ch])return $+=1,void(j=_o.data);j=_o.data}else j=_o.data}()},30)})}class yde{constructor(p,A){a_(this,"id",0),a_(this,"element",void 0),a_(this,"peerPair",void 0),a_(this,"context",void 0),a_(this,"audioPlayerElement",void 0),a_(this,"audioTrack",void 0),yde.count+=1,this.id=yde.count,this.element=p,this.context=A}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=p=>{const A=document.createElement("audio");A.srcObject=new MediaStream([p.track]),A.play(),this.audioPlayerElement=A}}switchSdp(){var p=this;return f(function*(){if(!p.peerPair)return;const A=function(){var w=f(function*($,j){const _e="offer"===j?yield $.createOffer():yield $.createAnswer();return yield $.setLocalDescription(_e),"complete"===$.iceGatheringState?$.localDescription:new iI(K=>{$.onicegatheringstatechange=()=>{"complete"===$.iceGatheringState&&K($.localDescription)}})});return function(j,_e){return w.apply(this,arguments)}}(),y=function(){var w=f(function*($,j){return yield $.setRemoteDescription(j)});return function(j,_e){return w.apply(this,arguments)}}();try{const w=yield A(p.peerPair[0],"offer");yield y(p.peerPair[1],w);const $=yield A(p.peerPair[1],"answer");yield y(p.peerPair[0],$)}catch(w){throw new U_(N_.LOCAL_AEC_ERROR,w.toString()).print()}})()}getTracksFromMediaElement(p){var A=this;return f(function*(){if(A.audioTrack)return A.audioTrack;let y;try{p instanceof HTMLVideoElement&&(p.captureStream?p.captureStream():p.mozCaptureStream()),y=A.context.createMediaStreamDestination(),A.context.createMediaElementSource(p).connect(y)}catch($){throw new U_(N_.LOCAL_AEC_ERROR,$.toString()).print()}if(!y)throw new U_(N_.LOCAL_AEC_ERROR,"no dest node when local aec").print();const w=y.stream.getAudioTracks()[0];return A.audioTrack=w,w})()}getElement(){return this.element}startEchoCancellation(){var p=this;return f(function*(){p.context.resume(),p.peerPair&&p.close(),p.initPeers();const A=p.element,y=yield p.getTracksFromMediaElement(A);p.peerPair&&p.peerPair[0].addTrack(y),yield p.switchSdp()})()}close(){h_.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(p=>{p.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var K0e,Yme;a_(yde,"count",0);const Rbe=window.AudioContext||window.webkitAudioContext,Obe=new(K0e=HQ({report:w0}),gI((Yme=class{constructor(){a_(this,"units",[]),a_(this,"context",void 0)}processExternalMediaAEC(s){if(!this._doesEnvironmentNeedAEC())return h_.debug("the system does not need to process local aec"),-1;this.context||(this.context=new Rbe);let p=this.units.find(A=>A&&A.getElement()===s);return p||(p=new yde(s,this.context),this.units.push(p)),p.startEchoCancellation(),h_.debug("start processing local audio echo cancellation, id is",p.id),p.id}_doesEnvironmentNeedAEC(){return Y1().name!==C1.SAFARI}}).prototype,"processExternalMediaAEC",[K0e],Object.getOwnPropertyDescriptor(Yme.prototype,"processExternalMediaAEC"),Yme.prototype),Yme);SR("PROCESS_ID","process-".concat(VT(8,""),"-").concat(VT(4,""),"-").concat(VT(4,""),"-").concat(VT(4,""),"-").concat(VT(12,""))),function(){const s=Y1();IN.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),IN.getStreamFromExtension=s.name===C1.CHROME&&Number(s.version)>34,IN.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const p=new RTCPeerConnection;let A=!1;try{p.addTransceiver("audio"),A=!0}catch(y){}return p.close(),A}(),IN.supportMinBitrate=s.name===C1.CHROME||s.name===C1.EDGE,IN.supportSetRtpSenderParameters=function(){const p=Y1();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!bQ()||!(!Z2()&&!Hne())||p.name===C1.FIREFOX&&Number(p.version)>=64)}(),s.name===C1.SAFARI&&(IN.supportDualStream=Number(s.version)>=14),IN.webAudioMediaStreamDest=function(){const p=Y1();return!(p.name===C1.SAFARI&&Number(p.version)<12)}(),IN.supportReplaceTrack=!!window.RTCRtpSender&&"function"==typeof RTCRtpSender.prototype.replaceTrack,IN.supportWebGL="undefined"!=typeof WebGLRenderingContext,IN.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,bQ()||(IN.webAudioWithAEC=!0),IN.supportShareAudio=function(){const p=Y1();return(p.os===wR.WIN_10||p.os===wR.WIN_81||p.os===wR.WIN_7||p.os===wR.LINUX||p.os===wR.MAC_OS)&&p.name===C1.CHROME&&Number(p.version)>=74}(),IN.supportDualStreamEncoding=function(){const p=Y1();return"Safari"===p.name&&Number(p.version)>=14}(),h_.info("browser compatibility",JSON.stringify(IN),JSON.stringify(s)),S0("info",[],"updateAgoraRTCCompatibility",{browserCompatibility:IN,browserInfo:s})}(),function(){let s;try{s=window.localStorage.getItem("websdk_ng_global_parameter")}catch(p){return void h_.error("Error loading sdk config",p.message)}if(s)try{const p=JSON.parse(window.atob(s)),A=Date.now();h_.debug("Loading global parameters from cache",p),S0("debug",[],"loadConfigFromLocalStorage",p),Object.keys(p).forEach(y=>{if(Object.prototype.hasOwnProperty.call(ZS,y)){const{value:w,expires:$}=p[y];if($&&$<=A)return;rce[y]=w,ZS[y]=w}})}catch(p){h_.error("Error loading mutableParamsCache: ".concat(s),p.message)}}();const A9={__CLIENT_LIST__:B8,__TRACK_LIST__:U8,VERSION:GO,BUILD:TI,setParameter:SR,getParameter:v0,getSupportedCodec:function(){var s=f(function*(){let p={audio:[],video:[]};try{let A=new RTCPeerConnection;A.addTransceiver("video",{direction:"recvonly"}),A.addTransceiver("audio",{direction:"recvonly"});const y=(yield A.createOffer()).sdp;if(!y)return p;A.close(),A=null,p=function(w){const $={video:[],audio:[]};return w.match(/ VP8/i)&&$.video.push("VP8"),w.match(/ VP9/i)&&$.video.push("VP9"),w.match(/ AV1/i)&&$.video.push("AV1"),w.match(/ H264/i)&&$.video.push("H264"),w.match(/ opus/i)&&$.audio.push("OPUS"),w.match(/ PCMU/i)&&$.audio.push("PCMU"),w.match(/ PCMA/i)&&$.audio.push("PCMA"),w.match(/ G722/i)&&$.audio.push("G722"),$}(y)}catch(A){throw new U_(N_.CREATE_OFFER_FAILED,A.toString&&A.toString()).print()}return p});return function(){return s.apply(this,arguments)}}(),checkSystemRequirements:function(){const s=w0.reportApiInvoke(null,{name:bI.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:lI.TRACER});let p=!1;try{const $=window.RTCPeerConnection,j=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,_e=window.WebSocket;p=!!($&&j&&_e)}catch($){return h_.error("check system requirement failed: ",$),!1}let A=!1;const y=Y1();y.name===C1.CHROME&&Number(y.version)>=58&&(!function Uae(){return"WebKit"===y6.engine.name}()||function PL(){const s=Y1();if(Hne()){if(s.os===wR.MAC_OS)return!0;if(s.os===wR.IOS){const p=y6.os.version&&y6.os.version.split(".");if(p&&14===Number(p[0])&&p[1]&&Number(p[1])>=3||p&&Number(p[0])>14)return!0}}return!1}())&&(A=!0),y.name===C1.FIREFOX&&Number(y.version)>=56&&(A=!0),y.name===C1.OPERA&&Number(y.version)>=45&&(A=!0),y.name===C1.SAFARI&&Number(y.version)>=11&&(A=!0),(rfe()||Y1().name===C1.QQ)&&(A=!0),h_.debug("checkSystemRequirements, api:",p,"browser",A);const w=p&&A;return s.onSuccess(w),w},getDevices:function(s){return sP.enumerateDevices(!0,!0,s)},getMicrophones:function(s){return sP.getRecordingDevices(s)},getCameras:function(s){return sP.getCamerasDevices(s)},getElectronScreenSources:WQ,getPlaybackDevices:function(s){return sP.getSpeakers(s)},createClient:function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const p=w0.reportApiInvoke(null,{name:bI.CREATE_CLIENT,options:[s],tag:lI.TRACER});try{Ufe(s)}catch(A){throw p.onError(A),A}return void 0===s.audioCodec&&(s.audioCodec="opus"),p.onSuccess(),new bbe(vde(vde({forceWaitGatewayResponse:!0},s),{},{role:"rtc"===s.mode?"host":s.role}))},createCameraVideoTrack:function(){var s=f(function*(){let p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{encoderConfig:"480p_1"};const A=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.CREATE_CAM_VIDEO_TRACK,options:[zme({},p)]}),y=cde(p),w=VT(8,"track-cam-");let $=null;h_.info("start create camera video track with config",JSON.stringify(p),"trackId",w),II("info",["AgoraRTC"],"createCameraVideoTrack",p);try{$=(yield zO({video:y},w)).getVideoTracks()[0]||null}catch(_e){throw A.onError(_e),_e}if(!$){const _e=new U_(N_.UNEXPECTED_ERROR,"can not find track in media stream");return A.onError(_e),_e.throw()}p.optimizationMode&&tEe(w,$,p,p.encoderConfig&&M8(p.encoderConfig));const j=new _Ee($,p,y,p.scalabiltyMode?are(p.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},p.optimizationMode,w);return A.onSuccess(j.getTrackId()),h_.info("create camera video success, trackId:",w),II("info",["AgoraRTC"],"createCameraVideoTrack",void 0,w),j});return function(){return s.apply(this,arguments)}}(),createCustomVideoTrack:function(s){const p=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.CREATE_CUSTOM_VIDEO_TRACK,options:[s]}),A=new yS(s.mediaStreamTrack,{bitrateMax:s.bitrateMax,bitrateMin:s.bitrateMin},s.scalabiltyMode?are(s.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},s.optimizationMode);return p.onSuccess(A.getTrackId()),h_.info("create custom video track success with config",s,"trackId",A.getTrackId()),II("info",["AgoraRTC"],"createCustomVideoTrack",s,A.getTrackId()),A},createScreenVideoTrack:function(){var s=f(function*(){let p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"disable";const y=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.CREATE_SCREEN_VIDEO_TRACK,options:[zme({},p),A]});p.encoderConfig?"string"==typeof p.encoderConfig||p.encoderConfig.width&&p.encoderConfig.height||(p.encoderConfig.width={max:1920},p.encoderConfig.height={max:1080}):p.encoderConfig="1080p_2";const w=Sye(p),$=VT(8,"track-scr");let j=null,_e=null;const K=bN();if(!K.supportShareAudio&&"enable"===A){const _u=new U_(N_.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return y.onError(_u),_u.throw()}h_.info("start create screen video track with config",p,"withAudio",A,"trackId",$),II("info",["AgoraRTC"],"createScreenVideoTrack",[p,A]);try{const _u=yield zO({screen:w,screenAudio:"auto"===A?K.supportShareAudio:"enable"===A},$);j=_u.getVideoTracks()[0]||null,_e=_u.getAudioTracks()[0]||null}catch(_u){throw y.onError(_u),_u}if(!j){const _u=new U_(N_.UNEXPECTED_ERROR,"can not find track in media stream");return y.onError(_u),_u.throw()}if(!_e&&"enable"===A){j&&j.stop();const _u=new U_(N_.SHARE_AUDIO_NOT_ALLOWED);return y.onError(_u),_u.throw()}p.optimizationMode||(p.optimizationMode="detail"),p.optimizationMode&&(tEe($,j,p,p.encoderConfig&&nce(p.encoderConfig)),p.encoderConfig&&"string"!=typeof p.encoderConfig&&(p.encoderConfig.bitrateMin=p.encoderConfig.bitrateMax));const _i=new yS(j,p.encoderConfig?nce(p.encoderConfig):{},p.scalabiltyMode?are(p.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},p.optimizationMode,$,[DR.SCREEN_TRACK]);if(!_e)return y.onSuccess(_i.getTrackId()),h_.info("create screen video track success","video:",_i.getTrackId()),II("info",["AgoraRTC"],"createScreenVideoTrack",void 0,{videoTrack:_i.getTrackId()}),_i;const _o=new cO(_e);return y.onSuccess([_i.getTrackId(),_o.getTrackId()]),h_.info("create screen video track success","video:",_i.getTrackId(),"audio:",_o.getTrackId()),II("info",["AgoraRTC"],"createScreenVideoTrack",void 0,{videoTrack:_i.getTrackId(),audioTrack:_o.getTrackId()}),[_i,_o]});return function(){return s.apply(this,arguments)}}(),createMicrophoneAndCameraTracks:function(){var s=f(function*(){let p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{encoderConfig:"480p_1"};const y=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.CREATE_MIC_AND_CAM_TRACKS,options:[p,A]}),w=cde(A),$=ude(p),j=VT(8,"track-mic-"),_e=VT(8,"track-cam-");let K=null,_i=null;h_.info("start create camera video track(".concat(_e,") and microphone audio track(").concat(j,") with config, audio: ").concat(JSON.stringify(p),", video: ").concat(JSON.stringify(A))),II("info",["AgoraRTC"],"createMicrophoneAndCameraTracks",{videoConfig:A,audioConfig:p});try{const ch=yield zO({audio:$,video:w},"".concat(j,"-").concat(_e));K=ch.getAudioTracks()[0],_i=ch.getVideoTracks()[0]}catch(ch){throw y.onError(ch),ch}if(!K||!_i){const ch=new U_(N_.UNEXPECTED_ERROR,"can not find tracks in media stream");return y.onError(ch),ch.throw()}A.optimizationMode&&tEe(_e,_i,A,A.encoderConfig&&M8(A.encoderConfig));const _o=new JQ(K,p,$,j),_u=new _Ee(_i,A,w,A.scalabiltyMode?are(A.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},A.optimizationMode,_e);return y.onSuccess([_o.getTrackId(),_u.getTrackId()]),h_.info("create camera video track(".concat(_e,") and microphone audio track(").concat(j,") success")),II("info",["AgoraRTC"],"createMicrophoneAndCameraTracks",void 0,{videoTrackId:_e,audioTrackId:j}),[_o,_u]});return function(){return s.apply(this,arguments)}}(),createMicrophoneAudioTrack:function(){var s=f(function*(){let p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const A=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.CREATE_MIC_AUDIO_TRACK,options:[p]}),y=ude(p),w=VT(8,"track-mic-");let $=null;h_.info("start create microphone audio track with config",JSON.stringify(p),"trackId",w),II("info",["AgoraRTC"],"createMicrophoneAudioTrack",p);try{$=(yield zO({audio:y},w)).getAudioTracks()[0]||null}catch(_e){throw A.onError(_e),_e}if(!$){const _e=new U_(N_.UNEXPECTED_ERROR,"can not find track in media stream");return A.onError(_e),_e.throw()}const j=new JQ($,p,y,w);return A.onSuccess(j.getTrackId()),h_.info("create microphone audio track success, trackId:",w),II("info",["AgoraRTC"],"createMicrophoneAudioTrack",p,w),j});return function(){return s.apply(this,arguments)}}(),createCustomAudioTrack:function(s){const p=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.CREATE_CUSTOM_AUDIO_TRACK,options:[s]}),A=new cO(s.mediaStreamTrack,s.encoderConfig?nO(s.encoderConfig):{});return h_.info("create custom audio track success with config",s,"trackId",A.getTrackId()),II("info",["AgoraRTC"],"createCustomAudioTrack",s,A.getTrackId()),p.onSuccess(A.getTrackId()),A},createBufferSourceAudioTrack:function(){var s=f(function*(p){const A=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.CREATE_BUFFER_AUDIO_TRACK,options:[p]}),y=VT(8,"track-buf-");h_.info("start create buffer source audio track with config",JSON.stringify(p),"trackId",y),II("info",[],"createBufferSourceAudioTrack",p);const w=p.source;if(!(p.source instanceof AudioBuffer))try{p.source=yield function wbe(s,p){return eEe.apply(this,arguments)}(p.source,p.cacheOnlineFile)}catch(_e){return A.onError(_e),_e.throw()}const $=new Cbe(p.source),j=new xve(w,$,p.encoderConfig?nO(p.encoderConfig):{},y);return h_.info("create buffer source audio track success, trackId:",y),II("info",["AgoraRTC"],"createBufferSourceAudioTrack",void 0,y),A.onSuccess(j.getTrackId()),j});return function(A){return s.apply(this,arguments)}}(),setLogLevel:function(s){v0("USE_NEW_LOG")?function(p){p=Math.min(Math.max(0,p),4),Xae=p}(s):h_.setLogLevel(s)},enableLogUpload:function(){v0("USE_NEW_LOG")?SR("UPLOAD_LOG",!0):h_.enableLogUpload()},disableLogUpload:function(){v0("USE_NEW_LOG")?SR("UPLOAD_LOG",!1):h_.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new h2},checkAudioTrackIsActive:function(){var s=f(function*(p){let A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const y=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[A]});if(!(p instanceof cO||p instanceof Wme)){const _i=new U_(N_.INVALID_TRACK,"the parameter is not a audio track");return y.onError(_i),_i.throw()}A&&A<1e3&&(A=1e3);const w=p instanceof cO?p.getTrackLabel():"remote_track",$=p.getVolumeLevel();let j=$,_e=$;const K=Date.now();return new iI(_i=>{const _o=setInterval(()=>{const _u=p.getVolumeLevel();j=_u>j?_u:j,_e=_u<_e?_u:_e;const ch=j-_e>1e-4,_f=Date.now()-K;if(ch||_f>A){clearInterval(_o);const o_=ch,i_={duration:_f,deviceLabel:w,maxVolumeLevel:j,result:o_};h_.info("[track-".concat(p.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(i_))),y.onSuccess(i_),_i(o_)}},200)})});return function(A){return s.apply(this,arguments)}}(),checkVideoTrackIsActive:function(){var s=f(function*(p){let A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const y=w0.reportApiInvoke(null,{tag:lI.TRACER,name:bI.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[A]});if(!(p instanceof yS||p instanceof qme)){const _f=new U_(N_.INVALID_TRACK,"the parameter is not a video track");return y.onError(_f),_f.throw()}const w=4;A&&A<1e3&&(A=1e3);const $=p instanceof yS?p.getTrackLabel():"remote_track",j=p.getMediaStreamTrack(!0),_e=document.createElement("video");_e.style.width="1px",_e.style.height="1px",_e.setAttribute("muted",""),_e.muted=!0,_e.setAttribute("playsinline",""),_e.controls=!1,(Z2()||Hne())&&(_e.style.opacity="0.01",_e.style.position="fixed",_e.style.left="0",_e.style.top="0",document.body.appendChild(_e)),_e.srcObject=new MediaStream([j]),_e.play();const K=document.createElement("canvas");K.width=160,K.height=120;let _i=0,_o=0;try{const _f=Date.now();_i=yield Sbe(_e,A,K,w),_o=Date.now()-_f}catch(_f){throw y.onError(_f),_f}Tbe===C1.SAFARI&&(_e.pause(),_e.remove()),_e.srcObject=null;const _u=_i>w,ch={duration:_o,changedPicNum:_i,deviceLabel:$,result:_u};return h_.info("[track-".concat(p.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(ch))),y.onSuccess(ch),_u});return function(A){return s.apply(this,arguments)}}(),setArea:function(s){const p=w0.reportApiInvoke(null,{name:bI.SET_AREA,options:s,tag:lI.TRACER});try{let A=[];if("string"==typeof s&&(A=[s]),Array.isArray(s)&&(s.forEach(w=>{if(!OQ.includes(w))throw new U_(N_.INVALID_PARAMS,"invalid area code")}),A=s),"[object Object]"===Object.prototype.toString.call(s)){const{areaCode:w,excludedArea:$}=s;if(!w)throw new U_(N_.INVALID_PARAMS,"area code is needed");let j=w;"string"==typeof w&&(j=[w]),A=$?function(s,p){let A=[];if(s.includes(u1.GLOBAL)){const $=[u1.GLOBAL,u1.OVERSEA],j=Object.keys(vK);if(p===u1.GLOBAL)throw new U_(N_.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(p===u1.CHINA)A=[u1.OVERSEA];else if(zle.includes(p)){const _e=Yie[u1.GLOBAL][p]||[],K=[...$,p,..._e];A=j.filter(_i=>!K.includes(_i))}else if(function(_e){let K=!1;return zle.forEach(_i=>{Yie[u1.GLOBAL][_i].includes(_e)&&(K=!0)}),K}(p)){const _e=function(_i){let _o;return zle.forEach(_u=>{Yie[u1.GLOBAL][_u].includes(_i)&&(_o=_u)}),_o}(p),K=[...$,_e,p];A=j.filter(_i=>!K.includes(_i))}else A=s;A=function(_e){const K=[];return Yle.forEach(_i=>{_e.includes(_i)&&K.push(_i)}),K.concat(_e.filter(_i=>!Yle.includes(_i)))}(A)}else A=s;return A}(j,$):j}SR("AREAS",A);const y=(w=>{const $={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return w.map(j=>{const _e=vK[j],K=Object.keys(_e);K&&K.map(_i=>{"CODE"!==_i&&($[_i]=$[_i].concat(_e[_i]))})}),$})(A);Object.keys(y).map(w=>{SR(w,"LOG_UPLOAD_SERVER"===w||"EVENT_REPORT_DOMAIN"===w||"EVENT_REPORT_BACKUP_DOMAIN"===w||"PROXY_SERVER_TYPE3"===w?y[w][0]:y[w])}),h_.debug("set area success:",A.join(","))}catch(A){throw p.onError(A),A}p.onSuccess()},loadModule:function(){var s=f(function*(p,A){if(h_.debug("loadModule: ".concat(p.name,", loadOption: ").concat(JSON.stringify(A))),!p.moduleInit)throw h_.debug("Invalid Plugin"),new U_(N_.INVALID_PLUGIN,"invalid plugin");try{tX.installPlugin(p),yield p.moduleInit({logger:h_,report:w0,pluginCenter:tX,getParameter:v0},A)}catch(y){throw new U_(N_.UNEXPECTED_ERROR,"unexpected error in loadModule",y)}});return function(A,y){return s.apply(this,arguments)}}(),audioElementPlayCenter:aP,processExternalMediaAEC:function(s){Obe.processExternalMediaAEC(s)},registerExtensions:function(s){s.forEach(p=>{const A=p;A.__registered__=!0,A.logger.hookLog=h_.extLog,A.reporter.hookApiInvoke=w0.extApiInvoke,A.parameters&&Object.keys(A.parameters).forEach(y=>{A.parameters[y]=v0(y)})})},ChannelMediaRelayError:xM,ChannelMediaRelayEvent:PM,ChannelMediaRelayState:yN,RemoteStreamFallbackType:_Z,RemoteStreamType:Sce,ConnectionDisconnectedReason:gS,AudienceLatencyLevelType:mre,AREAS:u1};return Object.defineProperties(A9,{onAudioAutoplayFailed:{get:()=>l2.onAudioAutoplayFailed,set:s=>{l2.onAudioAutoplayFailed=s}},onAutoplayFailed:{get:()=>l2.onAutoplayFailed,set:s=>{l2.onAutoplayFailed=s}}}),sP.on(XU.CAMERA_DEVICE_CHANGED,s=>{h_.info("camera device changed",JSON.stringify(s)),A9.onCameraChanged&&A9.onCameraChanged(s)}),sP.on(XU.RECORDING_DEVICE_CHANGED,s=>{h_.info("microphone device changed",JSON.stringify(s)),A9.onMicrophoneChanged&&A9.onMicrophoneChanged(s)}),sP.on(XU.PLAYOUT_DEVICE_CHANGED,s=>{h_.debug("playout device changed",JSON.stringify(s)),A9.onPlaybackDeviceChanged&&A9.onPlaybackDeviceChanged(s)}),aP.onAutoplayFailed=()=>{h_.info("detect audio element autoplay failed"),l2.onAudioAutoplayFailed&&l2.onAudioAutoplayFailed()},g1.on("autoplay-failed",()=>{h_.info("detect webaudio autoplay failed"),l2.onAudioAutoplayFailed&&l2.onAudioAutoplayFailed()}),window&&(window.__ARTC__=A9),A9}()},3528:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var l;module=__webpack_require__.nmd(module),l=function(){function oe(h,l){var g=Object.keys(h);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(h);l&&(f=f.filter(function(k){return Object.getOwnPropertyDescriptor(h,k).enumerable})),g.push.apply(g,f)}return g}function wa(h){for(var l=1;l<arguments.length;l++){var g=null!=arguments[l]?arguments[l]:{};l%2?oe(Object(g),!0).forEach(function(f){m(h,f,g[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(g)):oe(Object(g)).forEach(function(f){Object.defineProperty(h,f,Object.getOwnPropertyDescriptor(g,f))})}return h}function V(h){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(l){return typeof l}:function(l){return l&&"function"==typeof Symbol&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l})(h)}function um(h,l,g,f,k,q,_r){try{var _s=h[q](_r),ga=_s.value}catch(_l){return void g(_l)}_s.done?l(ga):Promise.resolve(ga).then(f,k)}function J(h){return function(){var l=this,g=arguments;return new Promise(function(f,k){function q(ga){um(_s,f,k,q,_r,"next",ga)}function _r(ga){um(_s,f,k,q,_r,"throw",ga)}var _s=h.apply(l,g);q(void 0)})}}function X(h,l){if(!(h instanceof l))throw new TypeError("Cannot call a class as a function")}function vm(h,l){for(var g=0;g<l.length;g++){var f=l[g];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(h,f.key,f)}}function Ia(h,l,g){return l&&vm(h.prototype,l),g&&vm(h,g),h}function m(h,l,g){return l in h?Object.defineProperty(h,l,{value:g,enumerable:!0,configurable:!0,writable:!0}):h[l]=g,h}function ja(h,l){if("function"!=typeof l&&null!==l)throw new TypeError("Super expression must either be null or a function");h.prototype=Object.create(l&&l.prototype,{constructor:{value:h,writable:!0,configurable:!0}}),l&&wf(h,l)}function Fd(h){return(Fd=Object.setPrototypeOf?Object.getPrototypeOf:function(l){return l.__proto__||Object.getPrototypeOf(l)})(h)}function wf(h,l){return(wf=Object.setPrototypeOf||function(g,f){return g.__proto__=f,g})(h,l)}function wm(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(h){return!1}}function wi(h,l,g){return(wi=wm()?Reflect.construct:function(f,k,q){var _r=[null];return _r.push.apply(_r,k),f=new(Function.bind.apply(f,_r)),q&&wf(f,q.prototype),f}).apply(null,arguments)}function xf(h){var l="function"==typeof Map?new Map:void 0;return(xf=function(g){function f(){return wi(g,arguments,Fd(this).constructor)}if(null===g||-1===Function.toString.call(g).indexOf("[native code]"))return g;if("function"!=typeof g)throw new TypeError("Super expression must either be null or a function");if(void 0!==l){if(l.has(g))return l.get(g);l.set(g,f)}return f.prototype=Object.create(g.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),wf(f,g)})(h)}function yf(h,l){if(null==h)return{};if(null==h)var g={};else{g={};var f,k=Object.keys(h);for(f=0;f<k.length;f++){var q=k[f];0<=l.indexOf(q)||(g[q]=h[q])}}if(Object.getOwnPropertySymbols)for(f=Object.getOwnPropertySymbols(h),q=0;q<f.length;q++)0<=l.indexOf(k=f[q])||Object.prototype.propertyIsEnumerable.call(h,k)&&(g[k]=h[k]);return g}function n(h){if(void 0===h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h}function ka(h){var l=wm();return function(){var g=Fd(h);if(l){var f=Fd(this).constructor;g=Reflect.construct(g,arguments,f)}else g=g.apply(this,arguments);return!g||"object"!=typeof g&&"function"!=typeof g?n(this):g}}function xi(h,l,g){return(xi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(f,k,q){for(;!Object.prototype.hasOwnProperty.call(f,k)&&null!==(f=Fd(f)););if(f)return(k=Object.getOwnPropertyDescriptor(f,k)).get?k.get.call(q):k.value})(h,l,g||h)}function ua(h,l){var g=Array.isArray(h)?h:void 0;if(!g)if(null==(g=h&&("undefined"!=typeof Symbol&&h[Symbol.iterator]||h["@@iterator"])))g=void 0;else{var f,k=[],q=!0,_r=!1;try{for(g=g.call(h);!(q=(f=g.next()).done)&&(k.push(f.value),!l||k.length!==l);q=!0);}catch(ga){_r=!0;var _s=ga}finally{try{q||null==g.return||g.return()}finally{if(_r)throw _s}}g=k}if(!(h=g||xm(h,l)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return h}function G(h){var l=Array.isArray(h)?yi(h):void 0;if(l||(l="undefined"!=typeof Symbol&&null!=h[Symbol.iterator]||null!=h["@@iterator"]?Array.from(h):void 0),!(h=l||xm(h)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return h}function xm(h,l){if(h){if("string"==typeof h)return yi(h,l);var g=Object.prototype.toString.call(h).slice(8,-1);if("Object"===g&&h.constructor&&(g=h.constructor.name),"Map"===g||"Set"===g)return Array.from(h);if("Arguments"===g||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return yi(h,l)}}function yi(h,l){(null==l||l>h.length)&&(l=h.length);for(var g=0,f=Array(l);g<l;g++)f[g]=h[g];return f}function la(h,l,g,f,k){var q={};return Object.keys(f).forEach(function(_r){q[_r]=f[_r]}),q.enumerable=!!q.enumerable,q.configurable=!!q.configurable,("value"in q||q.initializer)&&(q.writable=!0),q=g.slice().reverse().reduce(function(_r,_s){return _s(h,l,_r)||_r},q),k&&void 0!==q.initializer&&(q.value=q.initializer?q.initializer.call(k):void 0,q.initializer=void 0),void 0===q.initializer&&(Object.defineProperty(h,l,q),q=null),q}function cb(h){var l={exports:{}};return h(l,l.exports),l.exports}function pe(h){h||(h={});var l=h.ua;if(l||"undefined"==typeof navigator||(l=navigator.userAgent),l&&l.headers&&"string"==typeof l.headers["user-agent"]&&(l=l.headers["user-agent"]),"string"!=typeof l)return!1;var g=iu.test(l)&&!ju.test(l)||!!h.tablet&&ku.test(l);return!g&&h.tablet&&h.featureDetect&&navigator&&1<navigator.maxTouchPoints&&-1!==l.indexOf("Macintosh")&&-1!==l.indexOf("Safari")&&(g=!0),g}function ym(h,l){var g,f=3>arguments.length?h:arguments[2];return sa(h)===f?h[l]:(g=Jb.f(h,l))?Q(g,"value")?g.value:void 0===g.get?void 0:g.get.call(f):ha(g=ac(h))?ym(g,l,f):void 0}function lu(h){var l=h.charCodeAt(0)<<24,g=0|mu(~l),f=0,k=0|h.length,q="";if(5>g&&k>=g){for(l=l<<g>>>24+g,f=1;f<g;f=f+1|0)l=l<<6|63&h.charCodeAt(f);65535>=l?q+=Gd(l):1114111>=l?q+=Gd(55296+((l=l-65536|0)>>10)|0,56320+(1023&l)|0):f=0}for(;f<k;f=f+1|0)q+="\ufffd";return q}function zm(){}function nu(h){var l=0|h.charCodeAt(0);if(55296<=l&&56319>=l){var g=0|h.charCodeAt(1);if(!(g==g&&56320<=g&&57343>=g))return Gd(239,191,189);if(65535<(l=(l-55296<<10)+g-56320+65536|0))return Gd(240|l>>>18,128|l>>>12&63,128|l>>>6&63,128|63&l)}return 127>=l?h:2047>=l?Gd(192|l>>>6,128|63&l):Gd(224|l>>>12,128|l>>>6&63,128|63&l)}function Am(){}function ia(){ia.init.call(this)}function Kg(h){if("function"!=typeof h)throw new TypeError('The "listener" argument must be of type Function. Received type '+V(h))}function Bm(h,l,g,f){Kg(g);var k=h._events;if(void 0===k)k=h._events=Object.create(null),h._eventsCount=0;else{void 0!==k.newListener&&(h.emit("newListener",l,g.listener?g.listener:g),k=h._events);var q=k[l]}return void 0===q?(k[l]=g,++h._eventsCount):("function"==typeof q?q=k[l]=f?[g,q]:[q,g]:f?q.unshift(g):q.push(g),0<(g=void 0===h._maxListeners?ia.defaultMaxListeners:h._maxListeners)&&q.length>g&&!q.warned&&(q.warned=!0,(g=Error("Possible EventEmitter memory leak detected. "+q.length+" "+String(l)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",g.emitter=h,g.type=l,g.count=q.length,console&&console.warn&&console.warn(g))),h}function ou(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Cm(h,l,g){return(l=ou.bind(h={fired:!1,wrapFn:void 0,target:h,type:l,listener:g})).listener=g,h.wrapFn=l}function Dm(h,l,g){if(void 0===(h=h._events))return[];if(void 0===(l=h[l]))return[];if("function"==typeof l)return g?[l.listener||l]:[l];if(g)for(g=Array(l.length),h=0;h<g.length;++h)g[h]=l[h].listener||l[h];else g=Em(l,l.length);return g}function Fm(h){var l=this._events;if(void 0!==l){if("function"==typeof(h=l[h]))return 1;if(void 0!==h)return h.length}return 0}function Em(h,l){for(var g=Array(l),f=0;f<l;++f)g[f]=h[f];return g}function pu(h,l,g){"function"==typeof h.on&&Gm(h,"error",l,g)}function Gm(h,l,g,f){if("function"==typeof h.on)f.once?h.once(l,g):h.on(l,g);else{if("function"!=typeof h.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+V(h));h.addEventListener(l,function k(q){f.once&&h.removeEventListener(l,k),g(q)})}}function qu(h){return h?G(h):ru(function(){return[]},function(l,g){return l.push(g),l})}function Hm(h,l){var g,f,q;return x.wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:g=Im(h)([Jm,Jm,function(_s,ga){return ga}])[2],f=0;case 2:if(!(f<l.length)){_r.next=17;break}if(!((q=g(zi,l[f]))instanceof Lg)){_r.next=11;break}if((q=Ai(q.deref()))===zi){_r.next=10;break}return _r.next=10,q;case 10:return _r.abrupt("return");case 11:if(q===zi){_r.next=14;break}return _r.next=14,q;case 14:f++,_r.next=2;break;case 17:case"end":return _r.stop()}},su)}function Mg(h,l){return null!=l&&"function"==typeof l[Symbol.iterator]?Hm(Mg(h),l):function(g){var f=g[2];return tu(g,function(k,q){return f(k,h(q))})}}function Jc(h){return Object.prototype.toString.call(h).slice(8,-1)}function Hd(h){return"Object"===Jc(h)&&h.constructor===Object&&Object.getPrototypeOf(h)===Object.prototype}function Km(h){var l;return(l="Boolean"===Jc(h)||"Null"===Jc(h)||"Undefined"===Jc(h))||(l="Number"===Jc(h)&&!isNaN(h)),l||"String"===Jc(h)||"Symbol"===Jc(h)}function Id(h){var l=-1,g=null==h?0:h.length;for(this.clear();++l<g;){var f=h[l];this.set(f[0],f[1])}}function qe(h){var l=-1,g=null==h?0:h.length;for(this.clear();++l<g;){var f=h[l];this.set(f[0],f[1])}}function re(h){var l=-1,g=null==h?0:h.length;for(this.clear();++l<g;){var f=h[l];this.set(f[0],f[1])}}function zf(h){var l=-1,g=null==h?0:h.length;for(this.__data__=new Ng;++l<g;)this.add(h[l])}function se(h){this.size=(this.__data__=new Og(h)).size}function te(h,l,g,f,k,q){var _r,_s=1&l,ga=2&l,_l=4&l;if(g&&(_r=k?g(h,f,k,q):g(h)),void 0!==_r)return _r;if(!ob(h))return h;if(f=Za(h)){if(_r=uu(h),!_s)return Bi(h,_r)}else{var bh=Af(h),n_="[object Function]"==bh||"[object GeneratorFunction]"==bh;if(Bf(h))return Lm(h,_s);if("[object Object]"==bh||"[object Arguments]"==bh||n_&&!k){if(_r=ga||n_?{}:Mm(h),!_s)return ga?vu(h,wu(_r,h)):xu(h,yu(_r,h))}else{if(!xa[bh])return k?h:{};_r=zu(h,bh,_s)}}if(q||(q=new ue),k=q.get(h))return k;q.set(h,_r),Au(h)?h.forEach(function(r_){_r.add(te(r_,l,g,r_,h,q))}):Bu(h)&&h.forEach(function(r_,p_){_r.set(p_,te(r_,l,g,p_,h,q))}),ga=_l?ga?Nm:Ci:ga?Cf:Jd;var _A=f?void 0:ga(h);return Cu(_A||h,function(r_,p_){_A&&(r_=h[p_=r_]),Om(_r,p_,te(r_,l,g,p_,h,q))}),_r}function Di(h,l){if("function"!=typeof h||null!=l&&"function"!=typeof l)throw new TypeError("Expected a function");var g=function f(){var k=arguments,q=l?l.apply(this,k):k[0],_r=f.cache;return _r.has(q)?_r.get(q):(k=h.apply(this,k),f.cache=_r.set(q,k)||_r,k)};return g.cache=new(Di.Cache||Ng),g}function Pm(h){if("string"==typeof h)return h;if(Za(h))return ve(h,Pm)+"";if(we(h))return Qm?Qm.call(h):"";var l=h+"";return"0"==l&&1/h==-Du?"-0":l}function Ei(h,l,g,f,k){var q=-1,_r=h.length;for(g||(g=Eu),k||(k=[]);++q<_r;){var _s=h[q];0<l&&g(_s)?1<l?Ei(_s,l-1,g,f,k):Fi(k,_s):f||(k[k.length]=_s)}return k}function xe(h,l,g,f,k){if(h===l)l=!0;else if(null==h||null==l||!oc(h)&&!oc(l))l=h!=h&&l!=l;else e:{var q=Za(h),_r=Za(l),_s=q?"[object Array]":Af(h),ga=_r?"[object Array]":Af(l),_l="[object Object]"==(_s="[object Arguments]"==_s?"[object Object]":_s);if(_r="[object Object]"==(ga="[object Arguments]"==ga?"[object Object]":ga),(ga=_s==ga)&&Bf(h)){if(!Bf(l)){l=!1;break e}q=!0,_l=!1}if(ga&&!_l)k||(k=new ue),l=q||Gi(h)?Rm(h,l,g,f,xe,k):Fu(h,l,_s,g,f,xe,k);else{if(!(1&g)&&(q=_l&&Sm.call(h,"__wrapped__"),_s=_r&&Sm.call(l,"__wrapped__"),q||_s)){h=q?h.value():h,l=_s?l.value():l,k||(k=new ue),l=xe(h,l,g,f,k);break e}if(ga)t:if(k||(k=new ue),q=1&g,_s=Ci(h),_r=_s.length,ga=Ci(l).length,_r==ga||q){for(ga=_r;ga--;){var bh=_s[ga];if(!(q?bh in l:Gu.call(l,bh))){l=!1;break t}}if(_l=k.get(h),bh=k.get(l),_l&&bh)l=_l==l&&bh==h;else{_l=!0,k.set(h,l),k.set(l,h);for(var n_=q;++ga<_r;){var _A=h[bh=_s[ga]],r_=l[bh];if(f)var p_=q?f(r_,_A,bh,l,h,k):f(_A,r_,bh,h,l,k);if(void 0===p_?_A!==r_&&!xe(_A,r_,g,f,k):!p_){_l=!1;break}n_||(n_="constructor"==bh)}_l&&!n_&&(g=h.constructor)!=(f=l.constructor)&&"constructor"in h&&"constructor"in l&&!("function"==typeof g&&g instanceof g&&"function"==typeof f&&f instanceof f)&&(_l=!1),k.delete(h),k.delete(l),l=_l}}else l=!1;else l=!1}}return l}function ya(h,l,g){this.low=0|h,this.high=0|l,this.unsigned=!!g}function pb(h){return!0===(h&&h.__isLong__)}function Kd(h,l){var g;if(l){if((l=0<=(h>>>=0)&&256>h)&&(g=Tm[h]))return g;g=za(h,0>(0|h)?-1:0,!0),l&&(Tm[h]=g)}else{if((l=-128<=(h|=0)&&128>h)&&(g=Um[h]))return g;g=za(h,0>h?-1:0,!1),l&&(Um[h]=g)}return g}function Kb(h,l){if(isNaN(h))return l?Ld:Lb;if(l){if(0>h)return Ld;if(h>=Vm)return Wm}else{if(h<=-Xm)return qb;if(h+1>=Xm)return Ym}return 0>h?Kb(-h,l).neg():za(h%ye|0,h/ye|0,l)}function za(h,l,g){return new ya(h,l,g)}function Hi(h,l,g){if(0===h.length)throw Error("empty string");if("NaN"===h||"Infinity"===h||"+Infinity"===h||"-Infinity"===h)return Lb;if("number"==typeof l?(g=l,l=!1):l=!!l,2>(g=g||10)||36<g)throw RangeError("radix");var f;if(0<(f=h.indexOf("-")))throw Error("interior hyphen");if(0===f)return Hi(h.substring(1),l,g).neg();f=Kb(Pg(g,8));for(var k=Lb,q=0;q<h.length;q+=8){var _r=Math.min(8,h.length-q),_s=parseInt(h.substring(q,q+_r),g);8>_r?(_r=Kb(Pg(g,_r)),k=k.mul(_r).add(Kb(_s))):k=(k=k.mul(f)).add(Kb(_s))}return k.unsigned=l,k}function bc(h,l){return"number"==typeof h?Kb(h,l):"string"==typeof h?Hi(h,l):za(h.low,h.high,"boolean"==typeof l?l:h.unsigned)}function O(h,l){function g(){this.constructor=h}Ii(h,l),h.prototype=null===l?Object.create(l):(g.prototype=l.prototype,new g)}function ze(h){return"function"==typeof h}function Ae(h){setTimeout(function(){throw h},0)}function Ji(h){return null!==h&&"object"===V(h)}function Zm(h){return h.reduce(function(l,g){return l.concat(g instanceof Df?g.errors:g)},[])}function Ki(h){for(;h;){var l=h.destination;if(h.closed||h.isStopped)return!1;h=l&&l instanceof ma?l:null}return!0}function ed(h){return h}function Li(){for(var h=[],l=0;l<arguments.length;l++)h[l]=arguments[l];return $m(h)}function $m(h){return 0===h.length?ed:1===h.length?h[0]:function(l){return h.reduce(function(g,f){return f(g)},l)}}function an(h){if(h||(h=Mb.Promise||Promise),!h)throw Error("no Promise impl found");return h}function bn(){return function(h){return h.lift(new Hu(h))}}function Ef(h){return h?Iu(h):yb}function Iu(h){return new Y(function(l){return h.schedule(function(){return l.complete()})})}function fd(h){return h&&"function"==typeof h.schedule}function Mi(h,l){return new Y(function(g){var f=new Ta,k=0;return f.add(l.schedule(function(){k===h.length?g.complete():(g.next(h[k++]),g.closed||f.add(this.schedule()))})),f})}function Ff(h,l){return l?Mi(h,l):new Y(cn(h))}function eb(){for(var h=[],l=0;l<arguments.length;l++)h[l]=arguments[l];return fd(l=h[h.length-1])?(h.pop(),Mi(h,l)):Ff(h)}function Z(h,l){return new Y(l?function(g){return l.schedule(Ju,0,{error:h,subscriber:g})}:function(g){return g.error(h)})}function Ju(h){h.subscriber.error(h.error)}function Ku(h,l){return void 0===l&&(l=0),function(g){return g.lift(new Lu(h,l))}}function dn(h){return h in Ni&&(delete Ni[h],!0)}function pc(){}function ea(h,l){return function(g){if("function"!=typeof h)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return g.lift(new Mu(h,l))}}function en(h,l,g){if(l){if(!fd(l))return function(){for(var f=[],k=0;k<arguments.length;k++)f[k]=arguments[k];return en(h,g).apply(void 0,f).pipe(ea(function(q){return Nb(q)?l.apply(void 0,q):l(q)}))};g=l}return function(){for(var f=[],k=0;k<arguments.length;k++)f[k]=arguments[k];var q,_r=this,_s={context:_r,subject:q,callbackFunc:h,scheduler:g};return new Y(function(ga){if(g)return g.schedule(Nu,0,{args:f,subscriber:ga,params:_s});if(!q){q=new Gf;try{h.apply(_r,f.concat([function(){for(var _l=[],bh=0;bh<arguments.length;bh++)_l[bh]=arguments[bh];q.next(1>=_l.length?_l[0]:_l),q.complete()}]))}catch(_l){Ki(q)?q.error(_l):console.warn(_l)}}return q.subscribe(ga)})}}function Nu(h){var l=this,g=h.args,f=h.subscriber,k=h.params;h=k.callbackFunc;var q=k.context,_r=k.scheduler,_s=k.subject;if(!_s){_s=k.subject=new Gf,k=function(){for(var ga=[],_l=0;_l<arguments.length;_l++)ga[_l]=arguments[_l];l.add(_r.schedule(Ou,0,{value:1>=ga.length?ga[0]:ga,subject:_s}))};try{h.apply(q,g.concat([k]))}catch(ga){_s.error(ga)}}this.add(_s.subscribe(f))}function Ou(h){var l=h.subject;l.next(h.value),l.complete()}function fn(h,l,g){if(l){if(!fd(l))return function(){for(var f=[],k=0;k<arguments.length;k++)f[k]=arguments[k];return fn(h,g).apply(void 0,f).pipe(ea(function(q){return Nb(q)?l.apply(void 0,q):l(q)}))};g=l}return function(){for(var f=[],k=0;k<arguments.length;k++)f[k]=arguments[k];var q={subject:void 0,args:f,callbackFunc:h,scheduler:g,context:this};return new Y(function(_r){var _s=q.context,ga=q.subject;if(g)return g.schedule(Pu,0,{params:q,subscriber:_r,context:_s});if(!ga){ga=q.subject=new Gf;try{h.apply(_s,f.concat([function(){for(var _l=[],bh=0;bh<arguments.length;bh++)_l[bh]=arguments[bh];(bh=_l.shift())?ga.error(bh):(ga.next(1>=_l.length?_l[0]:_l),ga.complete())}]))}catch(_l){Ki(ga)?ga.error(_l):console.warn(_l)}}return ga.subscribe(_r)})}}function Pu(h){var l=this,g=h.params,f=h.subscriber;h=h.context;var k=g.callbackFunc,q=g.args,_r=g.scheduler,_s=g.subject;if(!_s){_s=g.subject=new Gf,g=function(){for(var ga=[],_l=0;_l<arguments.length;_l++)ga[_l]=arguments[_l];(_l=ga.shift())?l.add(_r.schedule(gn,0,{err:_l,subject:_s})):l.add(_r.schedule(Qu,0,{value:1>=ga.length?ga[0]:ga,subject:_s}))};try{k.apply(h,q.concat([g]))}catch(ga){this.add(_r.schedule(gn,0,{err:ga,subject:_s}))}}this.add(_s.subscribe(f))}function Qu(h){var l=h.subject;l.next(h.value),l.complete()}function gn(h){h.subject.error(h.err)}function hn(h){return!!h&&"function"!=typeof h.subscribe&&"function"==typeof h.then}function Oi(h,l,g,f,k){if(void 0===k&&(k=new Ru(h,g,f)),!k.closed)return l instanceof Y?l.subscribe(k):Hf(l)(k)}function Su(h,l){return new Y(function(g){var f=new Ta;return f.add(l.schedule(function(){var k=h[Be]();f.add(k.subscribe({next:function(q){f.add(l.schedule(function(){return g.next(q)}))},error:function(q){f.add(l.schedule(function(){return g.error(q)}))},complete:function(){f.add(l.schedule(function(){return g.complete()}))}}))})),f})}function Tu(h,l){return new Y(function(g){var f=new Ta;return f.add(l.schedule(function(){return h.then(function(k){f.add(l.schedule(function(){g.next(k),f.add(l.schedule(function(){return g.complete()}))}))},function(k){f.add(l.schedule(function(){return g.error(k)}))})})),f})}function Uu(h,l){if(!h)throw Error("Iterable cannot be null");return new Y(function(g){var f,k=new Ta;return k.add(function(){f&&"function"==typeof f.return&&f.return()}),k.add(l.schedule(function(){f=h[gd](),k.add(l.schedule(function(){if(!g.closed){try{var q=f.next(),_r=q.value,_s=q.done}catch(ga){return void g.error(ga)}_s?g.complete():(g.next(_r),this.schedule())}}))})),k})}function jn(h,l){if(null!=h){if(h&&"function"==typeof h[Be])return Su(h,l);if(hn(h))return Tu(h,l);if(kn(h))return Mi(h,l);if(h&&"function"==typeof h[gd]||"string"==typeof h)return Uu(h,l)}throw new TypeError((null!==h&&V(h)||h)+" is not observable")}function Ob(h,l){return l?jn(h,l):h instanceof Y?h:new Y(Hf(h))}function qc(h,l){if(!l.closed){if(h instanceof Y)return h.subscribe(l);try{var g=Hf(h)(l)}catch(f){l.error(f)}return g}}function fb(h,l,g){return void 0===g&&(g=Number.POSITIVE_INFINITY),"function"==typeof l?function(f){return f.pipe(fb(function(k,q){return Ob(h(k,q)).pipe(ea(function(_r,_s){return l(k,_r,q,_s)}))},g))}:("number"==typeof l&&(g=l),function(f){return f.lift(new Vu(h,g))})}function Qg(h){return void 0===h&&(h=Number.POSITIVE_INFINITY),fb(ed,h)}function ln(){for(var h=[],l=0;l<arguments.length;l++)h[l]=arguments[l];return Qg(1)(eb.apply(void 0,h))}function hd(h){return new Y(function(l){try{var g=h()}catch(f){return void l.error(f)}return(g?Ob(g):Ef()).subscribe(l)})}function mn(){for(var h=[],l=0;l<arguments.length;l++)h[l]=arguments[l];if(1===h.length){var g=h[0];if(Nb(g))return Rg(g,null);if(Ji(g)&&Object.getPrototypeOf(g)===Object.prototype)return Rg((h=Object.keys(g)).map(function(k){return g[k]}),h)}if("function"==typeof h[h.length-1]){var f=h.pop();return Rg(h=1===h.length&&Nb(h[0])?h[0]:h,null).pipe(ea(function(k){return f.apply(void 0,k)}))}return Rg(h,null)}function Rg(h,l){return new Y(function(g){var f=h.length;if(0===f)g.complete();else for(var k=Array(f),q=0,_r=0,_s=function(_l){var bh=Ob(h[_l]),n_=!1;g.add(bh.subscribe({next:function(_A){n_||(n_=!0,_r++),k[_l]=_A},error:function(_A){return g.error(_A)},complete:function(){++q!==f&&n_||(_r===f&&g.next(l?l.reduce(function(_A,r_,p_){return _A[r_]=k[p_],_A},{}):k),g.complete())}}))},ga=0;ga<f;ga++)_s(ga)})}function jb(h,l,g,f){return ze(g)&&(f=g,g=void 0),f?jb(h,l,g).pipe(ea(function(k){return Nb(k)?f.apply(void 0,k):f(k)})):new Y(function(k){nn(h,l,function(q){k.next(1<arguments.length?Array.prototype.slice.call(arguments):q)},k,g)})}function nn(h,l,g,f,k){if(h&&"function"==typeof h.addEventListener&&"function"==typeof h.removeEventListener){h.addEventListener(l,g,k);var q=function(){return h.removeEventListener(l,g,k)}}else if(h&&"function"==typeof h.on&&"function"==typeof h.off)h.on(l,g),q=function(){return h.off(l,g)};else if(h&&"function"==typeof h.addListener&&"function"==typeof h.removeListener)h.addListener(l,g),q=function(){return h.removeListener(l,g)};else{if(!h||!h.length)throw new TypeError("Invalid event target");for(var _r=0,_s=h.length;_r<_s;_r++)nn(h[_r],l,g,f,k)}f.add(q)}function on(h,l,g){return g?on(h,l).pipe(ea(function(f){return Nb(f)?g.apply(void 0,f):g(f)})):new Y(function(f){var k=function(){for(var _r=[],_s=0;_s<arguments.length;_s++)_r[_s]=arguments[_s];return f.next(1===_r.length?_r[0]:_r)};try{var q=h(k)}catch(_r){return void f.error(_r)}if(ze(l))return function(){return l(k,q)}})}function Wu(h){var l=h.subscriber,g=h.condition;if(!l.closed){if(h.needIterate)try{h.state=h.iterate(h.state)}catch(q){return void l.error(q)}else h.needIterate=!0;if(g){var f=void 0;try{f=g(h.state)}catch(q){return void l.error(q)}if(!f)return void l.complete();if(l.closed)return}try{var k=h.resultSelector(h.state)}catch(q){return void l.error(q)}if(!l.closed&&(l.next(k),!l.closed))return this.schedule(h)}}function Pi(h){return!Nb(h)&&0<=h-parseFloat(h)+1}function pn(h,l){return void 0===h&&(h=0),void 0===l&&(l=id),(!Pi(h)||0>h)&&(h=0),l&&"function"==typeof l.schedule||(l=id),new Y(function(g){return g.add(l.schedule(Xu,h,{subscriber:g,counter:0,period:h})),g})}function Xu(h){var l=h.subscriber,g=h.counter;h=h.period,l.next(g),this.schedule({subscriber:l,counter:g+1,period:h},h)}function cc(){for(var h=[],l=0;l<arguments.length;l++)h[l]=arguments[l];l=Number.POSITIVE_INFINITY;var g=null,f=h[h.length-1];return fd(f)?(g=h.pop(),1<h.length&&"number"==typeof h[h.length-1]&&(l=h.pop())):"number"==typeof f&&(l=h.pop()),null===g&&1===h.length&&h[0]instanceof Y?h[0]:Qg(l)(Ff(h,g))}function Qi(){for(var h=[],l=0;l<arguments.length;l++)h[l]=arguments[l];if(0===h.length)return yb;var g=h[0],f=h.slice(1);return 1===h.length&&Nb(g)?Qi.apply(void 0,g):new Y(function(k){var q=function(){return k.add(Qi.apply(void 0,f).subscribe(k))};return Ob(g).subscribe({next:function(_r){k.next(_r)},error:q,complete:q})})}function Yu(h){var l=h.keys,g=h.index,f=h.subscriber,k=h.subscription;if(h=h.obj,!f.closed)if(g<l.length){var q=l[g];f.next([q,h[q]]),k.add(this.schedule({keys:l,index:g+1,subscriber:f,subscription:k,obj:h}))}else f.complete()}function Zu(h,l){function g(){return!g.pred.apply(g.thisArg,arguments)}return g.pred=h,g.thisArg=l,g}function zb(h,l){return function(g){return g.lift(new $u(h,l))}}function Da(){for(var h=[],l=0;l<arguments.length;l++)h[l]=arguments[l];if(1===h.length){if(!Nb(h[0]))return h[0];h=h[0]}return Ff(h,void 0).lift(new av)}function bv(h){var l=h.start,g=h.index,f=h.subscriber;g>=h.count?f.complete():(f.next(l),f.closed||(h.index=g+1,h.start=l+1,this.schedule(h)))}function Kc(h,l,g){void 0===h&&(h=0);var f=-1;return Pi(l)?f=1>Number(l)?1:Number(l):fd(l)&&(g=l),fd(g)||(g=id),new Y(function(k){var q=Pi(h)?h:+h-g.now();return g.schedule(cv,q,{index:0,period:f,subscriber:k})})}function cv(h){var l=h.index,g=h.period,f=h.subscriber;if(f.next(l),!f.closed){if(-1===g)return f.complete();h.index=l+1,this.schedule(h,g)}}function Ri(){for(var h=[],l=0;l<arguments.length;l++)h[l]=arguments[l];return"function"==typeof(l=h[h.length-1])&&h.pop(),Ff(h,void 0).lift(new dv(l))}function Ja(h){return function(l){var g=new ev(h);return l=l.lift(g),g.caught=l}}function Si(h,l){return fb(h,l,1)}function qn(h){return void 0===h&&(h=null),function(l){return l.lift(new fv(h))}}function jd(h,l){void 0===l&&(l=id);var g=h instanceof Date&&!isNaN(+h)?+h-l.now():Math.abs(h);return function(f){return f.lift(new gv(g,l))}}function rn(h,l){return function(g){return g.lift(new hv(h,l))}}function Md(h){return void 0===h&&(h=iv),function(l){return l.lift(new jv(h))}}function iv(){return new Sg}function Pa(h){return function(l){return 0===h?Ef():l.lift(new kv(h))}}function sn(h,l){return l?function(g){return g.pipe(sn(function(f,k){return Ob(h(f,k)).pipe(ea(function(q,_r){return l(f,q,k,_r)}))}))}:function(g){return g.lift(new lv(h))}}function Tg(h){return function(l){return l.lift(new mv(h))}}function aa(h,l){var g=2<=arguments.length;return function(f){return f.pipe(h?zb(function(k,q){return h(k,q,f)}):ed,Pa(1),g?qn(l):Md(function(){return new Sg}))}}function nv(){return function(h){return h.lift(new ov)}}function tn(h){return function(l){return 0===h?Ef():l.lift(new pv(h))}}function If(h){return function(l){return l.lift(new qv(h))}}function Ug(h,l){var g=!1;return 2<=arguments.length&&(g=!0),function(f){return f.lift(new rv(h,l,g))}}function un(h,l){return 2<=arguments.length?function(g){return Li(Ug(h,l),tn(1),qn(l))(g)}:function(g){return Li(Ug(function(f,k,q){return h(f,k,q+1)}),tn(1))(g)}}function sv(h,l){return function(g){var f="function"==typeof h?h:function(){return h};if("function"==typeof l)return g.lift(new tv(f,l));var k=Object.create(g,uv);return k.source=g,k.subjectFactory=f,k}}function Ce(h){return function(l){return l.lift(new vv(h,l))}}function wv(){return new Ua}function De(){return function(h){return bn()(sv(wv)(h))}}function vn(h,l,g){var f=h&&"object"===V(h)?h:{bufferSize:h,windowTime:l,refCount:!1,scheduler:g};return function(k){return k.lift(xv(f))}}function xv(h){var l,g,f=h.bufferSize,k=void 0===f?Number.POSITIVE_INFINITY:f,q=void 0===(f=h.windowTime)?Number.POSITIVE_INFINITY:f,_r=h.refCount,_s=h.scheduler,ga=0,_l=!1,bh=!1;return function(n_){if(ga++,!l||_l){_l=!1;var _A=(l=new Ee(k,q,_s)).subscribe(this);g=n_.subscribe({next:function(r_){l.next(r_)},error:function(r_){_l=!0,l.error(r_)},complete:function(){bh=!0,g=void 0,l.complete()}}),bh&&(g=void 0)}else _A=l.subscribe(this);this.add(function(){ga--,_A.unsubscribe(),_A=void 0,g&&!bh&&_r&&0===ga&&(g.unsubscribe(),l=g=void 0)})}}function Lc(h,l){return"function"==typeof l?function(g){return g.pipe(Lc(function(f,k){return Ob(h(f,k)).pipe(ea(function(q,_r){return l(f,q,k,_r)}))}))}:function(g){return g.lift(new yv(h))}}function rb(h){return function(l){return l.lift(new zv(h))}}function Av(h,l){return void 0===l&&(l=!1),function(g){return g.lift(new Bv(h,l))}}function ba(h,l,g){return function(f){return f.lift(new Cv(h,l,g))}}function Dv(h,l,g){return void 0===l&&(l=id),void 0===g&&(g=Ev),function(f){return f.lift(new Fv(h,l,g.leading,g.trailing))}}function Gv(h){h.subscriber.clearThrottle()}function Hv(h,l,g){return void 0===g&&(g=id),function(f){var k=h instanceof Date&&!isNaN(+h),q=k?+h-g.now():Math.abs(h);return f.lift(new Iv(q,k,l,g))}}function kb(h,l){return void 0===l&&(l=id),Hv(h,Z(new sb),l)}function Jv(){for(var h=[],l=0;l<arguments.length;l++)h[l]=arguments[l];return function(g){var f;return"function"==typeof h[h.length-1]&&(f=h.pop()),g.lift(new Kv(h,f))}}function wn(h){(Ti||h)&&(xn.abort(),h&&(xn=new AbortController),Ti=h)}function yn(h,l,g,f,k){h!==l&&zn(l,function(q,_r){if(k||(k=new ue),ob(q)){q=k;var _s=Ui(h,_r),ga=Ui(l,_r),_l=q.get(ga);if(_l)Vi(h,_r,_l);else{var bh=void 0===(_l=f?f(_s,ga,_r+"",h,l,q):void 0);if(bh){var n_=Za(ga),_A=!n_&&Bf(ga),r_=!n_&&!_A&&Gi(ga);_l=ga,n_||_A||r_?Za(_s)?_l=_s:oc(_s)&&Nd(_s)?_l=Bi(_s):_A?(bh=!1,_l=Lm(ga,!0)):r_?(bh=!1,_l=An(ga,!0)):_l=[]:Bn(ga)||Jf(ga)?(_l=_s,Jf(_s)?_l=Fe(_s,Cf(_s)):ob(_s)&&!Wi(_s)||(_l=Mm(ga))):bh=!1}bh&&(q.set(ga,_l),yn(_l,ga,g,f,q),q.delete(ga)),Vi(h,_r,_l)}}else void 0===(_s=f?f(Ui(h,_r),q,_r+"",h,l,k):void 0)&&(_s=q),Vi(h,_r,_s)},Cf)}function Lv(h){var l=1,g=Xi;1==(1>=arguments.length?0:arguments.length-1)?"number"==typeof(1>=arguments.length?void 0:arguments[1])?l=1>=arguments.length?void 0:arguments[1]:g=1>=arguments.length?void 0:arguments[1]:2==(1>=arguments.length?0:arguments.length-1)&&(l=1>=arguments.length?void 0:arguments[1],g=2>=arguments.length?void 0:arguments[2]);var f=l||1;return function(k){return k.pipe(Ug(function(q,_r){var _s=g.now(),ga=_s-h;if((q=q.filter(function(n_){return n_.until>ga})).length>=f){var _l=q[q.length-1],bh=q[0].until+h*Math.floor(q.length/f);q.push({delay:_l.until<_s?bh-_s:bh-_l.until,until:bh,value:_r})}else q.push({delay:0,until:_s,value:_r});return q},[]),ea(function(q){return q[q.length-1]}),Si(function(q){var _r=eb(q.value);return q.delay?_r.pipe(jd(q.delay,g)):_r}))}}function Mv(h,l){var g=(l=void 0===l?{protocols:Cn,makeWebSocket:Dn}:l).protocols,f=void 0===g?Cn:g,k=void 0===(l=l.makeWebSocket)?Dn:l;return new Y(function(q){var _r,_s=new Ua,ga=k(h,f),_l=!1,bh=!1,n_=!1,_A=function(r_){if(_r)throw _l=!0,r_=Error("Web socket message factory function called more than once"),q.error(r_),r_;return _r=r_.subscribe(function(p_){ga.send(p_)}),_s};return ga.onopen=function(){n_=!0,bh?(_l=!0,ga.close()):q.next(_A)},ga.onmessage=function(r_){_s.next(r_.data)},ga.onerror=function(r_){_l=!0,q.error(Error(r_.message))},ga.onclose=function(r_){_l||(_l=!0,bh?(q.complete(),_s.complete()):q.error(Error(1e3===r_.code?"Normal closure":r_.reason)))},function(){bh=!0,_r&&_r.unsubscribe(),_l||(_l=!0,n_&&ga.close())}})}function Vg(){this._listeners={}}function En(h){return"undefined"!=typeof Float32Array?function(){function l(ga,_l,bh){q[0]=ga,_l[bh]=_r[0],_l[bh+1]=_r[1],_l[bh+2]=_r[2],_l[bh+3]=_r[3]}function g(ga,_l,bh){q[0]=ga,_l[bh]=_r[3],_l[bh+1]=_r[2],_l[bh+2]=_r[1],_l[bh+3]=_r[0]}function f(ga,_l){return _r[0]=ga[_l],_r[1]=ga[_l+1],_r[2]=ga[_l+2],_r[3]=ga[_l+3],q[0]}function k(ga,_l){return _r[3]=ga[_l],_r[2]=ga[_l+1],_r[1]=ga[_l+2],_r[0]=ga[_l+3],q[0]}var q=new Float32Array([-0]),_r=new Uint8Array(q.buffer),_s=128===_r[3];h.writeFloatLE=_s?l:g,h.writeFloatBE=_s?g:l,h.readFloatLE=_s?f:k,h.readFloatBE=_s?k:f}():function(){function l(f,k,q,_r){var _s=0>k?1:0;if(_s&&(k=-k),0===k)f(0<1/k?0:2147483648,q,_r);else if(isNaN(k))f(2143289344,q,_r);else if(34028234663852886e22<k)f((_s<<31|2139095040)>>>0,q,_r);else if(11754943508222875e-54>k)f((_s<<31|Math.round(k/1401298464324817e-60))>>>0,q,_r);else{var ga=Math.floor(Math.log(k)/Math.LN2);f((_s<<31|ga+127<<23|8388607&Math.round(k*Math.pow(2,-ga)*8388608))>>>0,q,_r)}}function g(f,k,q){return q=f(k,q),f=2*(q>>31)+1,k=q>>>23&255,q&=8388607,255===k?q?NaN:1/0*f:0===k?1401298464324817e-60*f*q:f*Math.pow(2,k-150)*(q+8388608)}h.writeFloatLE=l.bind(null,Fn),h.writeFloatBE=l.bind(null,Gn),h.readFloatLE=g.bind(null,Hn),h.readFloatBE=g.bind(null,In)}(),"undefined"!=typeof Float64Array?function(){function l(ga,_l,bh){q[0]=ga,_l[bh]=_r[0],_l[bh+1]=_r[1],_l[bh+2]=_r[2],_l[bh+3]=_r[3],_l[bh+4]=_r[4],_l[bh+5]=_r[5],_l[bh+6]=_r[6],_l[bh+7]=_r[7]}function g(ga,_l,bh){q[0]=ga,_l[bh]=_r[7],_l[bh+1]=_r[6],_l[bh+2]=_r[5],_l[bh+3]=_r[4],_l[bh+4]=_r[3],_l[bh+5]=_r[2],_l[bh+6]=_r[1],_l[bh+7]=_r[0]}function f(ga,_l){return _r[0]=ga[_l],_r[1]=ga[_l+1],_r[2]=ga[_l+2],_r[3]=ga[_l+3],_r[4]=ga[_l+4],_r[5]=ga[_l+5],_r[6]=ga[_l+6],_r[7]=ga[_l+7],q[0]}function k(ga,_l){return _r[7]=ga[_l],_r[6]=ga[_l+1],_r[5]=ga[_l+2],_r[4]=ga[_l+3],_r[3]=ga[_l+4],_r[2]=ga[_l+5],_r[1]=ga[_l+6],_r[0]=ga[_l+7],q[0]}var q=new Float64Array([-0]),_r=new Uint8Array(q.buffer),_s=128===_r[7];h.writeDoubleLE=_s?l:g,h.writeDoubleBE=_s?g:l,h.readDoubleLE=_s?f:k,h.readDoubleBE=_s?k:f}():function(){function l(f,k,q,_r,_s,ga){var _l=0>_r?1:0;if(_l&&(_r=-_r),0===_r)f(0,_s,ga+k),f(0<1/_r?0:2147483648,_s,ga+q);else if(isNaN(_r))f(0,_s,ga+k),f(2146959360,_s,ga+q);else if(17976931348623157e292<_r)f(0,_s,ga+k),f((_l<<31|2146435072)>>>0,_s,ga+q);else if(22250738585072014e-324>_r)f((_r/=5e-324)>>>0,_s,ga+k),f((_l<<31|_r/4294967296)>>>0,_s,ga+q);else{var bh=Math.floor(Math.log(_r)/Math.LN2);1024===bh&&(bh=1023),f(4503599627370496*(_r*=Math.pow(2,-bh))>>>0,_s,ga+k),f((_l<<31|bh+1023<<20|1048576*_r&1048575)>>>0,_s,ga+q)}}function g(f,k,q,_r,_s){return k=f(_r,_s+k),_r=f(_r,_s+q),f=2*(_r>>31)+1,k=4294967296*(1048575&_r)+k,2047==(q=_r>>>20&2047)?k?NaN:1/0*f:0===q?5e-324*f*k:f*Math.pow(2,q-1075)*(k+4503599627370496)}h.writeDoubleLE=l.bind(null,Fn,0,4),h.writeDoubleBE=l.bind(null,Gn,4,0),h.readDoubleLE=g.bind(null,Hn,0,4),h.readDoubleBE=g.bind(null,In,4,0)}(),h}function Fn(h,l,g){l[g]=255&h,l[g+1]=h>>>8&255,l[g+2]=h>>>16&255,l[g+3]=h>>>24}function Gn(h,l,g){l[g]=h>>>24,l[g+1]=h>>>16&255,l[g+2]=h>>>8&255,l[g+3]=255&h}function Hn(h,l){return(h[l]|h[l+1]<<8|h[l+2]<<16|h[l+3]<<24)>>>0}function In(h,l){return(h[l]<<24|h[l+1]<<16|h[l+2]<<8|h[l+3])>>>0}function $a(h,l){this.lo=h>>>0,this.hi=l>>>0}function Kf(h,l,g){this.fn=h,this.len=l,this.next=void 0,this.val=g}function Yi(){}function Nv(h){this.head=h.head,this.tail=h.tail,this.len=h.len,this.next=h.states}function na(){this.len=0,this.tail=this.head=new Kf(Yi,0,0),this.states=null}function Zi(h,l,g){l[g]=255&h}function $i(h,l){this.len=h,this.next=void 0,this.val=l}function aj(h,l,g){for(;h.hi;)l[g++]=127&h.lo|128,h.lo=(h.lo>>>7|h.hi<<25)>>>0,h.hi>>>=7;for(;127<h.lo;)l[g++]=127&h.lo|128,h.lo>>>=7;l[g++]=h.lo}function bj(h,l,g){l[g]=255&h,l[g+1]=h>>>8&255,l[g+2]=h>>>16&255,l[g+3]=h>>>24}function rc(){cj.call(this)}function Ov(h,l,g){40>h.length?W.utf8.write(h,l,g):l.utf8Write?l.utf8Write(h,g):l.write(h,g)}function dc(h,l){return RangeError("index out of range: "+h.pos+" + "+(l||1)+" > "+h.len)}function Qa(h){this.buf=h,this.pos=0,this.len=h.length}function dj(){var h=new Jn(0,0),l=0;if(!(4<this.len-this.pos)){for(;3>l;++l){if(this.pos>=this.len)throw dc(this);if(h.lo=(h.lo|(127&this.buf[this.pos])<<7*l)>>>0,128>this.buf[this.pos++])return h}return h.lo=(h.lo|(127&this.buf[this.pos++])<<7*l)>>>0,h}for(;4>l;++l)if(h.lo=(h.lo|(127&this.buf[this.pos])<<7*l)>>>0,128>this.buf[this.pos++])return h;if(h.lo=(h.lo|(127&this.buf[this.pos])<<28)>>>0,h.hi=(h.hi|(127&this.buf[this.pos])>>4)>>>0,128>this.buf[this.pos++])return h;if(l=0,4<this.len-this.pos){for(;5>l;++l)if(h.hi=(h.hi|(127&this.buf[this.pos])<<7*l+3)>>>0,128>this.buf[this.pos++])return h}else for(;5>l;++l){if(this.pos>=this.len)throw dc(this);if(h.hi=(h.hi|(127&this.buf[this.pos])<<7*l+3)>>>0,128>this.buf[this.pos++])return h}throw Error("invalid varint encoding")}function Wg(h,l){return(h[l-4]|h[l-3]<<8|h[l-2]<<16|h[l-1]<<24)>>>0}function Kn(){if(this.pos+8>this.len)throw dc(this,8);return new Jn(Wg(this.buf,this.pos+=4),Wg(this.buf,this.pos+=4))}function Od(h){ej.call(this,h)}function Lf(h,l,g){if("function"!=typeof h)throw TypeError("rpcImpl must be a function");W.EventEmitter.call(this),this.rpcImpl=h,this.requestDelimited=!!l,this.responseDelimited=!!g}function Aa(h){return"string"==typeof h&&/^[\s\w!#$%&()+,.:;<=>?@[\]^{|}~-]{1,64}$/.test(h)&&"null"!==h}function Ln(h){try{var l=h.split(".").map(function(f){return Number(f)})}catch(f){return!1}if(4!==l.length||0===l[0])return!1;for(h=0;h<l.length;h++){var g=l[h];if(!Number.isInteger(g)||0>g||255<g)return!1}return!0}function Mn(h,l){if(!Array.isArray(l)||0===l.length||32<l.length||l.some(function(g){return 0===g.length||32<g.length}))throw new H("arguments is not valid",Oa);if(!Aa(h))throw new H("ID is invalid",Oa)}function Mf(h){var l=h.attributes,g=h.attrSizeMap,f=h.maxAttrsCount,k=h.maxAttrValueSize;if(h=h.maxTotalSize,!Hd(l))throw new H("attributes must be an object",Oa);if(Object.keys(l).length>f)throw new lb("Exceed the limit of ".concat(f," attributes"),Ge);if(0===Object.keys(l).length)throw new H("The attributes is an empty object",Oa);var q=0,_r=0;for(l=Object.entries(l);_r<l.length;_r++){var _s=ua(l[_r],2),ga=_s[1];_s=new Blob([_s[0]]).size;var _l=new Blob([ga]).size;if(0===_s||32<_s)throw new H("Invalid attribute key",Oa);if(_l>k)throw new lb("Invalid attribute value, over the limit of ".concat(k," bytes"),Ge);if("string"!=typeof ga||0===ga.length)throw new H("Invalid attribute value",Oa);q+=_s,q+=_l}if(q>h)throw new lb("The attributes size overflow",Ge);if(void 0!==g){if(Object.keys(g).length>f)throw new lb("Exceed the limit of ".concat(f," attributes"),Ge);for(q=f=0,g=Object.entries(g);q<g.length;q++){if(_r=(l=ua(g[q],2))[1],0===(l=new Blob([l[0]]).size))throw new H("Invalid attribute key",Oa);if(_r>k)throw new lb("Invalid attribute value, over the limit of ".concat(k," bytes"),Ge);f+=l,f+=_r}if(f>h)throw new lb("The attributes size overflow",Ge)}}function Xg(h,l){return Math.floor(Math.random()*(Math.floor(l)-Math.ceil(h)+1))+h}function Yg(){var h=Xg(0,4294967295),l=Xg(1,4294967295);return new U(h,l,!0)}function ab(h){return h.toString().padEnd(32,"0")}function Nn(h,l){return new TypeError("Unexpected ".concat(h,": ").concat(l))}function On(h,l){return h=h.split(".").map(function(g){return Number(g)}),l=l.split(".").map(function(g){return Number(g)}),Math.sqrt(1e3*Math.pow(h[0]-l[0],2)+100*Math.pow(h[1]-l[1],2)+10*Math.pow(h[2]-l[2],2)+1*Math.pow(h[3]-l[3],2))}function Pn(h){return h.lessThanOrEqual(Number.MAX_SAFE_INTEGER)?h.toNumber():h.toString()}function fj(h,l){l="".concat(h).concat(l||"");var g=Qn.get(l)||1;return Qn.set(l,g+1),"".concat(h).concat(g)}function Rn(h,l){var g="number"==typeof l?l:void 0!==l&&"string"!=typeof l?l.code:void 0;return l="number"!=typeof l&&"string"!=typeof l&&void 0!==l&&void 0!==l.serverCode?l.serverCode:void 0,g="".concat(void 0!==g?" Error Code ".concat(g):"").concat(void 0!==l?", server Code ".concat(l):""),h="string"==typeof h&&h?Zg(h):Array.isArray(h)&&"string"==typeof h[0]&&h[0]?Zg(Sn.apply(void 0,[h[0]].concat(G(h.slice(1))))):"","".concat(""===g?"":"".concat(g," - ")).concat(h)}function gj(h,l){return hj.apply(this,arguments)}function hj(){return(hj=J(x.mark(function h(l,g){return x.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!g||!g.aborted){f.next=2;break}return f.abrupt("return");case 2:return f.abrupt("return",new Promise(function(k){setTimeout(k,l),null==g||g.addEventListener("abort",k)}));case 3:case"end":return f.stop()}},h)}))).apply(this,arguments)}function Tn(h){return h instanceof Blob||"[object Blob]"===Object.prototype.toString.call(h)}function $g(h){var l=255&h,g=h>>8&255,f=h>>16&255;return"".concat(h>>24&255,".").concat(f,".").concat(g,".").concat(l)}function He(h,l,g){return ij.apply(this,arguments)}function ij(){return(ij=J(x.mark(function h(l,g,f){var k,q,_r,_s,ga,_l,bh,n_,_A,r_,p_,I_,v_,S_,x_,B_,c0,Pv,h0,I0,G_,_v;return x.wrap(function(E_){for(;;)switch(E_.prev=E_.next){case 0:if(k=g.body,_r=void 0===(q=g.headers)?{}:q,ga=void 0===(_s=g.timeout)?1e4:_s,_l=g.signal,n_=void 0!==(bh=g.withCredentials)&&bh,r_=void 0!==(_A=(f||{}).useBinaryResponse)&&_A,(p_=new XMLHttpRequest).open("POST",l,!0),p_.responseType=r_?"arraybuffer":"text",p_.withCredentials=n_,p_.timeout=ga,I_=k instanceof FormData,v_=k instanceof Uint8Array,!(1<(S_=Object.keys(_r).filter(function(L_){return"content-type"===L_.toLowerCase()})).length)){E_.next=14;break}throw new RangeError("multiple content-type");case 14:0===S_.length&&(v_?_r["Content-Type"]="application/octet-stream":I_||(_r["Content-Type"]="application/json"));case 15:if("setRequestHeader"in p_){E_.next=46;break}return p_.abort(),E_.next=19,fetch(l,{body:I_||v_?k:JSON.stringify(k),cache:"no-cache",credentials:n_?"include":"same-origin",headers:_r,method:"POST",mode:"cors",referrer:"no-referrer",signal:_l});case 19:if(!(200<=(B_=(x_=E_.sent).status)&&300>B_||304===B_)){E_.next=31;break}if(!r_){E_.next=27;break}return E_.next=25,x_.arrayBuffer();case 25:return E_.abrupt("return",{status:B_,responseData:E_.sent});case 27:return E_.next=29,x_.text();case 29:return E_.abrupt("return",{status:B_,responseText:E_.sent});case 31:return c0=new da(["Post XHR failure, status %d",B_]),E_.prev=32,E_.next=35,x_.text();case 35:throw Pv=E_.sent,c0.statusCode=B_,c0.message=Pv||"Request failed, status ".concat(B_),c0;case 41:throw E_.prev=41,E_.t0=E_.catch(32),c0.statusCode=B_,c0.message="Request failed, status ".concat(B_),c0;case 46:if(0!==Object.keys(_r).length)for(h0=0,I0=Object.entries(_r);h0<I0.length;h0++)G_=ua(I0[h0],2),p_.setRequestHeader(G_[0],G_[1]);return void 0!==_l&&(_v=function L_(){p_.abort(),_l.removeEventListener("abort",L_)},_l.addEventListener("abort",_v)),p_.send(I_||v_?k:JSON.stringify(k)),E_.abrupt("return",new Promise(function(L_,F_){p_.onload=function(){var J_=p_.status;if(200<=J_&&300>J_||304===J_)L_(r_?{status:J_,responseData:p_.response}:{status:J_,responseText:p_.responseText});else{var Y_=new da(["Post XHR failure, status %d",J_]);Y_.statusCode=J_,Y_.message=p_.response||"Request failed, status ".concat(p_.status),F_(Y_)}},p_.ontimeout=function(J_){F_(new gb(["XHR request timed out after %d ms",ga],{originalError:J_}))},p_.onerror=function(){var J_=new da(["Post XHR failure, status %d",p_.status]);J_.statusCode=p_.status,J_.message=p_.response||"Request failed, status ".concat(p_.status),F_(J_)},p_.onabort=function(){try{F_(new DOMException("The request aborted.","AbortError"))}catch(Y_){var J_=Error("The request aborted.");J_.name="AbortError",F_(J_)}}}));case 50:case"end":return E_.stop()}},h,null,[[32,41]])}))).apply(this,arguments)}function Un(h){return nj.apply(this,arguments)}function nj(){return(nj=J(x.mark(function h(l){var g;return x.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return(g=new Image).src=l,f.abrupt("return",new Promise(function(k,q){g.onload=function(){k({width:g.width,height:g.height})},g.onerror=q}));case 3:case"end":return f.stop()}},h)}))).apply(this,arguments)}function Sv(h,l){return oj.apply(this,arguments)}function oj(){return(oj=J(x.mark(function h(l,g){var f,k,q,_r,_s,ga,_l,bh,n_,_A;return x.wrap(function(r_){for(;;)switch(r_.prev=r_.next){case 0:if(_r=void 0===(q=l.thumbnailWidth)?0:q,ga=void 0===(_s=l.width)?0:_s,bh=void 0===(_l=l.height)?0:_l,n_=l.thumbnail,_A=[],"number"==typeof(k=void 0===(f=l.thumbnailHeight)?0:f)&&"number"==typeof _r&&"number"==typeof ga&&"number"==typeof bh){r_.next=5;break}throw new H("Invalid message params",Of);case 5:return 0>=ga&&0>=bh&&_A.push(Un(Vn(g)).then(function(p_){ga=p_.width,bh=p_.height})),0>=_r&&0>=k&&void 0!==n_&&_A.push(pj(n_).then(function(){var p_=J(x.mark(function I_(v_){var S_;return x.wrap(function(x_){for(;;)switch(x_.prev=x_.next){case 0:return x_.next=2,Un(Vn(v_));case 2:_r=(S_=x_.sent).width,k=S_.height;case 5:case"end":return x_.stop()}},I_)}));return function(I_){return p_.apply(this,arguments)}}())),r_.next=9,Promise.all(_A).catch(function(){});case 9:return r_.abrupt("return",{width:ga,height:bh,thumbnailWidth:_r,thumbnailHeight:k});case 10:case"end":return r_.stop()}},h)}))).apply(this,arguments)}function Wn(h,l){if(!Hd(h))throw new H("message object is not a plain object",l);if(void 0===h.messageType)if(h.rawMessage instanceof Uint8Array){if(h.messageType="RAW",void 0!==h.text)throw new H("Raw messages cannot have text property. Use description instead",l)}else{if("string"!=typeof h.text)throw new H("messageType is undefined",l);if(h.messageType="TEXT",void 0!==h.rawMessage)throw new H("Text messages cannot have rawMessage property",l)}}function dh(h){return qj.apply(this,arguments)}function qj(){return(qj=J(x.mark(function h(l){var g,f,k,q,_r,_s,ga,_l,bh,n_,_A,r_,p_,I_,v_,S_,x_,B_,V_,_0,c0;return x.wrap(function(Pv){for(;;)switch(Pv.prev=Pv.next){case 0:if(g=l.message,f=l.peerId,k=l.toPeer,_r=l.errorCodes,_s=l.diff,ga=l.logger,_l=l.options,void 0!==(q=l.session)){Pv.next=3;break}throw new L("The client is not logged in. Cannot do the operation",_r.NOT_LOGGED_IN);case 3:if(bh=!1,"TEXT"!==g.messageType||!g.text.startsWith("AgoraRTMLegacyEndcallCompatibleMessagePrefix")||!k){Pv.next=11;break}if(n_=g.text.split("_"),_A=ua(n_,3),r_=_A[0],p_=_A[1],void 0!==_A[2]&&Aa(p_)&&"AgoraRTMLegacyEndcallCompatibleMessagePrefix"===r_){Pv.next=10;break}throw new H("Message is not valid",Ie);case 10:bh=!0;case 11:if(I_=Date.now(),!((S_=q.messageSentTimes[v_=q.messageSentTimes.length-1])&&S_+3e3<I_)){Pv.next=18;break}q.messageSentTimes=[I_],Pv.next=29;break;case 18:x_=v_;case 19:if(!(0<=x_)){Pv.next=28;break}if(!(q.messageSentTimes[x_]+3e3<I_)){Pv.next=23;break}return q.messageSentTimes=q.messageSentTimes.slice(x_+1,v_+1),Pv.abrupt("break",28);case 23:if(!(180<=v_-x_+1)){Pv.next=25;break}throw new lb("Message sent failed, exceeded the 180 message in 3 seconds",_r.TOO_OFTEN);case 25:x_--,Pv.next=19;break;case 28:q.messageSentTimes.push(I_);case 29:Pv.t0=g.messageType,Pv.next="TEXT"===Pv.t0?32:"RAW"===Pv.t0?37:"FILE"===Pv.t0||"IMAGE"===Pv.t0?39:40;break;case 32:if(!bh){Pv.next=36;break}return B_=g.text.split("_"),V_=ua(B_,3),_0=V_[1],c0=V_[2],ga.info("[rtm-API] EndCall message send api is called"),Pv.abrupt("return",q.sendInvitationMessage({peerId:f,type:"CallCancel",extra:c0,channelId:_0,callId:"0"}));case 36:return Pv.abrupt("return",q.sendTextMessage(g.text,f,k,_l,1e4-_s));case 37:return void 0===g.description&&(g.description=""),Pv.abrupt("return",q.sendRawMessage(g.rawMessage,g.description,f,k,_l,1e4-_s));case 39:return Pv.abrupt("return",q.sendMediaMessage(g.messageType,g,f,k,_l,1e4-_s));case 40:throw new H("Invalid message type",Ie);case 41:case"end":return Pv.stop()}},h)}))).apply(this,arguments)}function Tv(h){var l=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],g=h.replace(/(https?:\/\/)?(www.)?/i,"");return l||(g=g.split(".").slice(h.length-2).join(".")),-1!==g.indexOf("/")?g.split("/")[0]:g}function pa(h){if("string"!=typeof h)return"[Sensitive Info]";var l=Math.floor(.7*h.length),g=h.length;return Xn(h,l,g,"*".repeat(g-l))}function Yn(h,l,g){function f(k){if(void 0===h)return h;if(Km(k))return k;if(Array.isArray(k))return k.map(f);var q={},_r=0;for(k=eh(k);_r<k.length;_r++){var _s=ua(k[_r],2),ga=_s[0];if("string"==typeof(_s=_s[1])&&g.includes(ga)){q[ga]="string"==typeof _s?pa(_s):"[Sensitive Info]";break}q[ga]=l.includes(ga)?"[Hidden Info]":null==_s?_s:g.includes(ga)?"[Sensitive Info]":f(_s)}return q}return Array.isArray(h)?h.map(f):f(h)}function Zn(h){return Object.getOwnPropertyNames(h).forEach(function(l){"object"==V(l=h[l])&&null!==l&&Zn(l)}),Object.freeze(h)}function ra(h){return new TextDecoder("utf-8").decode(h.buffer.slice(h.byteOffset,h.byteOffset+h.byteLength))}function fh(h){return(new TextEncoder).encode(h).length}function $n(){for(var h=0,l=arguments.length,g=Array(l),f=0;f<l;f++)g[f]=arguments[f];for(l=0;l<g.length;l++)h+=g[l].length;for(h=new Uint8Array(h),f=l=0;f<g.length;f++){var k=g[f];h.set(k,l),l+=k.length}return h}function Je(h,l,g){var f=h.match(/([^?#]+)(\?[^#]*)?(#.*)?/);if(h=null==f?void 0:f[1],f=null==f?void 0:f[2]){var k;for(f=f.substr(1).split("&"),k=0;k<f.length;k++)if(f[k].split("=")[0]==l){f[k]=l+"="+encodeURIComponent(g);break}return k==f.length&&f.push(l+"="+encodeURIComponent(g)),h+"?"+f.join("&")}return h+"?"+l+"="+encodeURIComponent(g)}function pj(h){return new Promise(function(l,g){var f=new FileReader;f.onloadend=function(){var k=f.result||new ArrayBuffer(0);l(k)},f.onerror=g,f.readAsArrayBuffer(h)})}function Uv(h,l){h=h=[h],"string"==typeof(l=l||{})&&(l={type:l});try{var g=new Blob(h,l)}catch(k){if("TypeError"!==k.name)throw k;g=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder);for(var f=0;f<h.length;f+=1)g.append(h[f]);g=g.getBlob(l.type)}return g}function Xn(h,l,g,f){return"string"!=typeof h?"[Sensitive Info]":h.substring(0,l)+f+h.substring(g)}function Pd(h){return"string"==typeof h&&0!==h.length&&"false"!==h&&"null"!==h&&"undefined"!==h}function ao(h){var l=[];return function g(f){if(null===f||"object"!==V(f))return f;if(-1!==l.indexOf(f))return"[Circular]";if(l.push(f),"function"==typeof f.toJSON)try{var k=g(f.toJSON());return l.pop(),k}catch(q){return"[Throws: "+(q?q.message:"?")+"]"}return Array.isArray(f)?(k=f.map(g),l.pop(),k):(k=Object.keys(f).reduce(function(q,_r){e:{if(Vv.call(f,_r))try{var _s=f[_r];break e}catch(ga){_s="[Throws: "+(ga?ga.message:"?")+"]";break e}_s=f[_r]}return q[_r]=g(_s),q},{}),l.pop(),k)}(h)}function Wv(h){if(!(100<(h=String(h)).length)&&(h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(h))){var l=parseFloat(h[1]);switch((h[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*l;case"weeks":case"week":case"w":return 6048e5*l;case"days":case"day":case"d":return 864e5*l;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*l;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*l;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*l;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l}}}function gh(h,l,g,f){return Math.round(h/g)+" "+f+(l>=1.5*g?"s":"")}function Xv(h){var l=h.areas,g=h.excludedArea;if(1===l.length&&l[0]===D.GLOBAL&&g===D.CHINA)return Ke([D.OVERSEA]);if(l.includes(D.GLOBAL)){if(h=Pf(hh).filter(function(q){return q!==D.GLOBAL&&q!==D.OVERSEA}),g in Qf){var f=[].concat(G(null!=(l=Qf[g])?l:[]),[g]);return Ke(h.filter(function(q){return!f.includes(q)}))}if(bo(g)){var k=Yv(g);return Ke(h.filter(function(q){return q!==g&&q!==k}))}}if(bo(g)||g in Qf)return Ke(l);throw new H("Invalid excludedArea area config")}function Ra(h,l,g){void 0===g&&(g=Object.getOwnPropertyDescriptor(h,l));var f=g.value;return g.value=function(){for(var k=this,q=arguments.length,_r=Array(q),_s=0;_s<q;_s++)_r[_s]=arguments[_s];this.invokeTracker.apply(this,["%s: ".concat(0<_r.length?"%s with args: ".concat(_r.map(function(){return"%o"})):"%s"),this.name,l].concat(G(_r.map(Le))));try{var ga=f.apply(this,_r)}catch(bh){throw this.logError.apply(this,["".concat(void 0!==bh.code?"Error Code ".concat(bh.code,": "):"","%s failed").concat(0<_r.length?" with args: ".concat(_r.map(function(){return"%o"})):""),l].concat(G(_r.map(Le)))),bh.originalError&&this.logError(bh.originalError),this.errorTracker(bh),bh}var _l=Date.now();return J(x.mark(function bh(){var n_,_A;return x.wrap(function(r_){for(;;)switch(r_.prev=r_.next){case 0:return r_.prev=0,r_.next=3,ga;case 3:n_=r_.sent,r_.next=12;break;case 6:return r_.prev=6,r_.t0=r_.catch(0),k.logError.apply(k,["".concat(void 0!==r_.t0.code?"Error Code ".concat(r_.t0.code,": "):"","%s failed").concat(0<_r.length?" with args: ".concat(_r.map(function(){return"%o"})):""),l].concat(G(_r.map(Le)))),r_.t0.originalError&&k.logError(r_.t0.originalError),k.errorTracker(r_.t0),r_.abrupt("return");case 12:n_!==ga?void 0===n_?k.resultTracker("%s promise resolves after %dms",l,Date.now()-_l):k.resultTracker("%s promise resolves after %dms, result is %o",l,Date.now()-_l,Le(n_)):"Object"!==Jc(n_)||Hd(n_)?k.resultTracker("%s result is %o",l,Le(n_)):k.resultTracker("%s result is %s",l,n_.name||(null===(_A=n_.constructor)||void 0===_A?void 0:_A.name));case 13:case"end":return r_.stop()}},bh,null,[[0,6]])}))(),ga},g}function Qb(h,l,g){void 0===g&&(g=Object.getOwnPropertyDescriptor(h,l));var f=g.value;return g.value=function(){for(var k=this,q=arguments.length,_r=Array(q),_s=0;_s<q;_s++)_r[_s]=arguments[_s];this.invokeTracker.apply(this,["%s: ".concat(0<_r.length?"%s with args: ".concat(_r.map(function(){return"%o"})):"%s"),this.name,l].concat(_r));try{var ga=f.apply(this,_r)}catch(bh){throw this.logError.apply(this,["".concat(void 0!==bh.code?"Error Code ".concat(bh.code,": "):"","%s failed").concat(0<_r.length?" with args: ".concat(_r.map(function(){return"%o"})):""),l].concat(_r)),bh.originalError&&this.logError(bh.originalError),this.errorTracker(bh),bh}var _l=Date.now();return J(x.mark(function bh(){var n_,_A;return x.wrap(function(r_){for(;;)switch(r_.prev=r_.next){case 0:return r_.prev=0,r_.next=3,ga;case 3:n_=r_.sent,r_.next=12;break;case 6:return r_.prev=6,r_.t0=r_.catch(0),k.logError.apply(k,["".concat(void 0!==r_.t0.code?"Error Code ".concat(r_.t0.code,": "):"","%s failed").concat(0<_r.length?" with args: ".concat(_r.map(function(){return"%o"})):""),l].concat(_r)),r_.t0.originalError&&k.logError(r_.t0.originalError),k.errorTracker(r_.t0),r_.abrupt("return");case 12:n_!==ga?void 0===n_?k.resultTracker("%s promise resolves after %dms",l,Date.now()-_l):k.resultTracker("%s promise resolves after %dms, result is %o",l,Date.now()-_l,n_):"Object"!==Jc(n_)||Hd(n_)?k.resultTracker("%s result is %o",l,n_):k.resultTracker("%s result is %s",l,n_.name||(null===(_A=n_.constructor)||void 0===_A?void 0:_A.name));case 13:case"end":return r_.stop()}},bh,null,[[0,6]])}))(),ga},g}function Zv(h,l){var g="".concat(h,"Uri");if("number"!=typeof(g=rj[g])||0===g)throw new TypeError("Got Unknown URI Name");return l=new(h=co[h])(l),l=h.encode(l).finish(),new $v({uri:g,data:l})}function eo(h,l){var g=Pd(null);return"".concat(h.split(".").join("-"),".edge.").concat(g?null:l?"sd-rtn.com":"agora.io")}function hb(h,l,g){return sj.apply(this,arguments)}function sj(){return(sj=J(x.mark(function h(l,g,f){var k,q,_r,_s=arguments;return x.wrap(function(ga){for(;;)switch(ga.prev=ga.next){case 0:return k=3<_s.length&&void 0!==_s[3]&&_s[3],q=aw[l].encode(g).finish(),_r=function(){var _l=J(x.mark(function bh(n_){var _A,r_,p_,I_=arguments;return x.wrap(function(v_){for(;;)switch(v_.prev=v_.next){case 0:if(!(3<(r_=1<I_.length&&void 0!==I_[1]?I_[1]:0))){v_.next=3;break}return v_.abrupt("return");case 3:if(p_=Je(p_=f?"https://".concat(null!==(_A=null==P?void 0:P.PROXY_NGINX[0])&&void 0!==_A?_A:"webrtc-cloud-proxy.sd-rtn.com","/rs/?h=").concat(n_,"&p=443&d=events/proto-raw"):"https://".concat(n_,"/events/proto-raw"),"sentTs",Math.ceil(Date.now()/1e3).toString()),p_=Je(p_,"id",bw[l].toString()),!k){v_.next=9;break}return v_.next=9,gj(1e4);case 9:return v_.next=11,He(p_,{body:q,timeout:2e4,headers:{"Content-Type":"application/octet-stream"}}).catch(function(S_){return _r(n_,r_+1)});case 11:case"end":return v_.stop()}},bh)}));return function(bh){return _l.apply(this,arguments)}}(),ga.prev=3,ga.next=6,_r((null==P?void 0:P.EVENT_REPORT_DOMAIN[0])||Pd(null)&&null||"webcollector-rtm.agora.io");case 6:ga.next=12;break;case 8:return ga.prev=8,ga.t0=ga.catch(3),ga.next=12,_r(P&&fo(1<(null==P?void 0:P.EVENT_REPORT_DOMAIN.length)?null==P?void 0:P.EVENT_REPORT_DOMAIN.slice(1):null==P?void 0:P.EVENT_REPORT_DOMAIN)||"rtm.statscollector.sd-rtn.com");case 12:case"end":return ga.stop()}},h,null,[[3,8]])}))).apply(this,arguments)}function ib(h){return U.fromNumber(void 0===h?0:Date.now()-h)}function cw(h){return btoa(String.fromCharCode.apply({},h.replace(/\r|\n/g,"").replace(/([\dA-Fa-f]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ").map(function(l){return parseInt(l,16)}))).replace(/={1,2}$/,"")}function ih(h,l){return U.fromValue(h).eq(l)}function jh(h,l){var g=void 0===l?h.val:l,f=h.isBoolean,k=h.oneof,q=h.len;if(2!==[f,l=h.isNumber,k].filter(function(_r){return!_r}).length)throw new TypeError("invalid field type");if(void 0!==g&&(h=!1,void 0!==k&&(k=tj(k),dw(k,ih).length===k.length&&void 0!==ew(k,function(_r){return ih(g,_r)})&&(h=!0)),f=void 0!==f&&(0===g||1===g)&&1===q,l=void 0!==l&&g.toString(2).length<=q,!(h||f||l)))throw Error("invalid field value")}function go(h){return h.reduce(function(l,g){return l.concat(g instanceof kh.UnsubscriptionError?g.errors:g)},[])}function fw(h,l){do{2147483647==Rf?Rf=0:Rf++}while(Me.hasOwnProperty(Rf));var g=Rf;return Me[g]={callback:h,parameters:Array.prototype.slice.call(arguments,2)},uj.postMessage({name:"setInterval",fakeId:g,time:l}),g}function ho(h){return function(){var l=h();if(!l)throw new L("Client is not logged in. Cannot do the operation");return l}}var Ka="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},lh=function(h){return h&&h.Math==Math&&h},C=lh("object"==typeof globalThis&&globalThis)||lh("object"==typeof window&&window)||lh("object"==typeof self&&self)||lh("object"==typeof Ka&&Ka)||function(){return this}()||Function("return this")(),R=function(h){try{return!!h()}catch(l){return!0}},fa=!R(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),io={}.propertyIsEnumerable,jo=Object.getOwnPropertyDescriptor,Sf=jo&&!io.call({1:2},1)?function(h){return!!(h=jo(this,h))&&h.enumerable}:io,sc=function(h,l){return{enumerable:!(1&h),configurable:!(2&h),writable:!(4&h),value:l}},gw={}.toString,ec=function(h){return gw.call(h).slice(8,-1)},hw="".split,Tf=R(function(){return!Object("z").propertyIsEnumerable(0)})?function(h){return"String"==ec(h)?hw.call(h,""):Object(h)}:Object,mb=function(h){if(null==h)throw TypeError("Can't call method on "+h);return h},tb=function(h){return Tf(mb(h))},ha=function(h){return"object"==typeof h?null!==h:"function"==typeof h},tc=function(h,l){if(!ha(h))return h;var g,f;if(l&&"function"==typeof(g=h.toString)&&!ha(f=g.call(h))||"function"==typeof(g=h.valueOf)&&!ha(f=g.call(h))||!l&&"function"==typeof(g=h.toString)&&!ha(f=g.call(h)))return f;throw TypeError("Can't convert object to primitive value")},Va=function(h){return Object(mb(h))},iw={}.hasOwnProperty,Q=function(h,l){return iw.call(Va(h),l)},Ne=C.document,mh=ha(Ne)&&ha(Ne.createElement),ko=!fa&&!R(function(){return 7!=Object.defineProperty(mh?Ne.createElement("div"):{},"a",{get:function(){return 7}}).a}),lo=Object.getOwnPropertyDescriptor,Jb={f:fa?lo:function(h,l){if(h=tb(h),l=tc(l,!0),ko)try{return lo(h,l)}catch(g){}if(Q(h,l))return sc(!Sf.call(h,l),h[l])}},sa=function(h){if(!ha(h))throw TypeError(String(h)+" is not an object");return h},mo=Object.defineProperty,Wa={f:fa?mo:function(h,l,g){if(sa(h),l=tc(l,!0),sa(g),ko)try{return mo(h,l,g)}catch(f){}if("get"in g||"set"in g)throw TypeError("Accessors not supported");return"value"in g&&(h[l]=g.value),h}},Sa=fa?function(h,l,g){return Wa.f(h,l,sc(1,g))}:function(h,l,g){return h[l]=g,h},vj=function(h,l){try{Sa(C,h,l)}catch(g){C[h]=l}return l},kd=C["__core-js_shared__"]||vj("__core-js_shared__",{}),jw=Function.toString;"function"!=typeof kd.inspectSource&&(kd.inspectSource=function(h){return jw.call(h)});var wj=kd.inspectSource,no=C.WeakMap,kw="function"==typeof no&&/native code/.test(wj(no)),ld=cb(function(h){(h.exports=function(l,g){return kd[l]||(kd[l]=void 0!==g?g:{})})("versions",[]).push({version:"3.12.1",mode:"global",copyright:"\xa9 2021 Denis Pushkarev (zloirock.ru)"})}),lw=0,mw=Math.random(),Oe=function(h){return"Symbol("+String(void 0===h?"":h)+")_"+(++lw+mw).toString(36)},oo=ld("keys"),nh=function(h){return oo[h]||(oo[h]=Oe(h))},Pe={},nw=C.WeakMap;if(kw||kd.state)var Qd=kd.state||(kd.state=new nw),ow=Qd.get,po=Qd.has,pw=Qd.set,xj=function(h,l){if(po.call(Qd,h))throw new TypeError("Object already initialized");return l.facade=h,pw.call(Qd,h,l),l},oh=function(h){return ow.call(Qd,h)||{}},yj=function(h){return po.call(Qd,h)};else{var Qe=nh("state");Pe[Qe]=!0,xj=function(h,l){if(Q(h,Qe))throw new TypeError("Object already initialized");return l.facade=h,Sa(h,Qe,l),l},oh=function(h){return Q(h,Qe)?h[Qe]:{}},yj=function(h){return Q(h,Qe)}}var La={set:xj,get:oh,has:yj,enforce:function(h){return yj(h)?oh(h):xj(h,{})},getterFor:function(h){return function(l){var g;if(!ha(l)||(g=oh(l)).type!==h)throw TypeError("Incompatible receiver, "+h+" required");return g}}},Ea=cb(function(h){var l=La.get,g=La.enforce,f=String(String).split("String");(h.exports=function(k,q,_r,_s){var ga=!!_s&&!!_s.unsafe,_l=!!_s&&!!_s.enumerable;if(_s=!!_s&&!!_s.noTargetGet,"function"==typeof _r){"string"!=typeof q||Q(_r,"name")||Sa(_r,"name",q);var bh=g(_r);bh.source||(bh.source=f.join("string"==typeof q?q:""))}k===C?_l?k[q]=_r:vj(q,_r):(ga?!_s&&k[q]&&(_l=!0):delete k[q],_l?k[q]=_r:Sa(k,q,_r))})(Function.prototype,"toString",function(){return"function"==typeof this&&l(this).source||wj(this)})}),qo=function(h){return"function"==typeof h?h:void 0},Rb=function(h,l){return 2>arguments.length?qo(C[h])||qo(C[h]):C[h]&&C[h][l]||C[h]&&C[h][l]},qw=Math.ceil,rw=Math.floor,fc=function(h){return isNaN(h=+h)?0:(0<h?rw:qw)(h)},sw=Math.min,va=function(h){return 0<h?sw(fc(h),9007199254740991):0},tw=Math.max,uw=Math.min,Ab=function(h,l){return 0>(h=fc(h))?tw(h+l,0):uw(h,l)},ro=function(h){return function(l,g,f){l=tb(l);var k=va(l.length);if(f=Ab(f,k),h&&g!=g){for(;k>f;)if((g=l[f++])!=g)return!0}else for(;k>f;f++)if((h||f in l)&&l[f]===g)return h||f||0;return!h&&-1}},so=ro(!0),zj=ro(!1),to=function(h,l){h=tb(h);var g,f=0,k=[];for(g in h)!Q(Pe,g)&&Q(h,g)&&k.push(g);for(;l.length>f;)Q(h,g=l[f++])&&(~zj(k,g)||k.push(g));return k},ph="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),vw=ph.concat("length","prototype"),Rd={f:Object.getOwnPropertyNames||function(h){return to(h,vw)}},Uf={f:Object.getOwnPropertySymbols},uo=Rb("Reflect","ownKeys")||function(h){var l=Rd.f(sa(h)),g=Uf.f;return g?l.concat(g(h)):l},vo=function(h,l){for(var g=uo(l),f=Wa.f,k=Jb.f,q=0;q<g.length;q++){var _r=g[q];Q(h,_r)||f(h,_r,k(l,_r))}},ww=/#|\.prototype\./,uc=function(h,l){return(h=xw[yw(h)])==zw||h!=Aw&&("function"==typeof l?R(l):!!l)},yw=uc.normalize=function(h){return String(h).replace(ww,".").toLowerCase()},xw=uc.data={},Aw=uc.NATIVE="N",zw=uc.POLYFILL="P",Bw=Jb.f,M=function(h,l){var g,f,k,q=h.target,_r=h.global,_s=h.stat;if(f=_r?C:_s?C[q]||vj(q,{}):(C[q]||{}).prototype)for(k in l){var ga=l[k],_l=h.noTargetGet?(g=Bw(f,k))&&g.value:f[k];if(!(g=uc(_r?k:q+(_s?".":"#")+k,h.forced))&&void 0!==_l){if(typeof ga==typeof _l)continue;vo(ga,_l)}(h.sham||_l&&_l.sham)&&Sa(ga,"sham",!0);try{Ea(f,k,ga,h)}catch(bh){}}},Aj=function(){var h=sa(this),l="";return h.global&&(l+="g"),h.ignoreCase&&(l+="i"),h.multiline&&(l+="m"),h.dotAll&&(l+="s"),h.unicode&&(l+="u"),h.sticky&&(l+="y"),l},vc=R(function(){var h=RegExp("a","y");return h.lastIndex=2,null!=h.exec("abcd")}),Cw=R(function(){var h=RegExp("^r","gy");return h.lastIndex=2,null!=h.exec("str")}),qh=RegExp.prototype.exec,Dw=ld("native-string-replace",String.prototype.replace),wo=qh,Bj=(c=/a/,a=/b*/g,qh.call(c,"a"),qh.call(a,"a"),0!==c.lastIndex||0!==a.lastIndex),xo=vc||Cw,Cj=void 0!==/()??/.exec("")[1],c,a;(Bj||Cj||xo)&&(wo=function(h){var l,g=xo&&this.sticky,f=Aj.call(this),k=this.source,q=0,_r=h;if(g){-1===(f=f.replace("y","")).indexOf("g")&&(f+="g"),_r=String(h).slice(this.lastIndex),0<this.lastIndex&&(!this.multiline||this.multiline&&"\n"!==h[this.lastIndex-1])&&(k="(?: "+k+")",_r=" "+_r,q++);var _s=new RegExp("^(?:"+k+")",f)}if(Cj&&(_s=new RegExp("^"+k+"$(?!\\s)",f)),Bj)var ga=this.lastIndex;var _l=qh.call(g?_s:this,_r);return g?_l?(_l.input=_l.input.slice(q),_l[0]=_l[0].slice(q),_l.index=this.lastIndex,this.lastIndex+=_l[0].length):this.lastIndex=0:Bj&&_l&&(this.lastIndex=this.global?_l.index+_l[0].length:ga),Cj&&_l&&1<_l.length&&Dw.call(_l[0],_s,function(){for(l=1;l<arguments.length-2;l++)void 0===arguments[l]&&(_l[l]=void 0)}),_l});var Vf=wo;M({target:"RegExp",proto:!0,forced:/./.exec!==Vf},{exec:Vf});var Re=Rb("navigator","userAgent")||"",yo=C.process,zo=yo&&yo.versions,Ao=zo&&zo.v8;if(Ao)var md=Ao.split("."),Dj=4>md[0]?1:md[0]+md[1];else Re&&(md=Re.match(/Edge\/(\d+)/),(!md||74<=md[1])&&(md=Re.match(/Chrome\/(\d+)/))&&(Dj=md[1]));var nd=Dj&&+Dj,wc=!!Object.getOwnPropertySymbols&&!R(function(){return!String(Symbol())||!Symbol.sham&&nd&&41>nd}),Bo=wc&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Wf=ld("wks"),Xf=C.Symbol,Ew=Bo?Xf:Xf&&Xf.withoutSetter||Oe,qa=function(h){return Q(Wf,h)&&(wc||"string"==typeof Wf[h])||(Wf[h]=wc&&Q(Xf,h)?Xf[h]:Ew("Symbol."+h)),Wf[h]},Fw=qa("species"),Ej=RegExp.prototype,Gw=!R(function(){var h=/./;return h.exec=function(){var l=[];return l.groups={a:"7"},l},"7"!=="".replace(h,"$<a>")}),Co="$0"==="a".replace(/./,"$0"),Do=qa("replace"),Eo=!!/./[Do]&&""===/./[Do]("a","$0"),Hw=!R(function(){var h=/(?:)/,l=h.exec;return h.exec=function(){return l.apply(this,arguments)},2!==(h="ab".split(h)).length||"a"!==h[0]||"b"!==h[1]}),rh=function(h,l,g,f){var k=qa(h),q=!R(function(){var _l={};return _l[k]=function(){return 7},7!=""[h](_l)}),_r=q&&!R(function(){var _l=!1,bh=/a/;return"split"===h&&((bh={constructor:{}}).constructor[Fw]=function(){return bh},bh.flags="",bh[k]=/./[k]),bh.exec=function(){return _l=!0,null},bh[k](""),!_l});if(!q||!_r||"replace"===h&&(!Gw||!Co||Eo)||"split"===h&&!Hw){var _s=/./[k],ga=(g=g(k,""[h],function(_l,bh,n_,_A,r_){var p_=bh.exec;return p_===Vf||p_===Ej.exec?q&&!r_?{done:!0,value:_s.call(bh,n_,_A)}:{done:!0,value:_l.call(n_,bh,_A)}:{done:!1}},{REPLACE_KEEPS_$0:Co,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:Eo}))[1];Ea(String.prototype,h,g[0]),Ea(Ej,k,2==l?function(_l,bh){return ga.call(_l,this,bh)}:function(_l){return ga.call(_l,this)})}f&&Sa(Ej[k],"sham",!0)},Iw=qa("match"),Fj=function(h){var l;return ha(h)&&(void 0!==(l=h[Iw])?!!l:"RegExp"==ec(h))},Bb=function(h){if("function"!=typeof h)throw TypeError(String(h)+" is not a function");return h},Jw=qa("species"),od=function(h,l){var g;return void 0===(h=sa(h).constructor)||null==(g=sa(h)[Jw])?l:Bb(g)},Fo=function(h){return function(l,g){l=String(mb(l)),g=fc(g);var f,k=l.length;if(0>g||g>=k)return h?"":void 0;var q=l.charCodeAt(g);return 55296>q||56319<q||g+1===k||56320>(f=l.charCodeAt(g+1))||57343<f?h?l.charAt(g):q:h?l.slice(g,g+2):f-56320+(q-55296<<10)+65536}},Kw=Fo(!1),Go=Fo(!0),Gj=function(h,l,g){return l+(g?Go(h,l).length:1)},Se=function(h,l){var g=h.exec;if("function"==typeof g){if("object"!=typeof(h=g.call(h,l)))throw TypeError("RegExp exec method returned something other than an Object or null");return h}if("RegExp"!==ec(h))throw TypeError("RegExp#exec called on incompatible receiver");return Vf.call(h,l)},Lw=[].push,Mw=Math.min;rh("split",2,function(h,l,g){var f="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||1<".".split(/()()/).length||"".split(/.?/).length?function(k,q){var _r=String(mb(this));if(0==(q=void 0===q?4294967295:q>>>0))return[];if(void 0===k)return[_r];if(!Fj(k))return l.call(_r,k,q);var _s,ga,_l,bh=[],n_=0;for(k=new RegExp(k.source,(k.ignoreCase?"i":"")+(k.multiline?"m":"")+(k.unicode?"u":"")+(k.sticky?"y":"")+"g");(_s=Vf.call(k,_r))&&!((ga=k.lastIndex)>n_&&(bh.push(_r.slice(n_,_s.index)),1<_s.length&&_s.index<_r.length&&Lw.apply(bh,_s.slice(1)),_l=_s[0].length,n_=ga,bh.length>=q));)k.lastIndex===_s.index&&k.lastIndex++;return n_===_r.length?(_l||!k.test(""))&&bh.push(""):bh.push(_r.slice(n_)),bh.length>q?bh.slice(0,q):bh}:"0".split(void 0,0).length?function(k,q){return void 0===k&&0===q?[]:l.call(this,k,q)}:l;return[function(k,q){var _r=mb(this),_s=null==k?void 0:k[h];return void 0!==_s?_s.call(k,_r,q):f.call(String(_r),k,q)},function(k,q){var _r=g(f,k,this,q,f!==l);if(_r.done)return _r.value;var _s=sa(k);k=String(this);var ga=od(_s,RegExp);if(_r=_s.unicode,_s=new ga(vc?"^(?:"+_s.source+")":_s,(_s.ignoreCase?"i":"")+(_s.multiline?"m":"")+(_s.unicode?"u":"")+(vc?"g":"y")),0==(q=void 0===q?4294967295:q>>>0))return[];if(0===k.length)return null===Se(_s,k)?[k]:[];var _l=0,bh=0;for(ga=[];bh<k.length;){_s.lastIndex=vc?0:bh;var n_,_A=Se(_s,vc?k.slice(bh):k);if(null===_A||(n_=Mw(va(_s.lastIndex+(vc?bh:0)),k.length))===_l)bh=Gj(k,bh,_r);else{if(ga.push(k.slice(_l,bh)),ga.length===q)return ga;for(_l=1;_l<=_A.length-1;_l++)if(ga.push(_A[_l]),ga.length===q)return ga;bh=_l=n_}}return ga.push(k.slice(_l)),ga}]},vc);var Nw=/^[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*/,Ow=/[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*$/,Hj=function(h){return function(l){return l=String(mb(l)),1&h&&(l=l.replace(Nw,"")),2&h&&(l=l.replace(Ow,"")),l}};Hj(1),Hj(2);var Ij=Hj(3),sh=C.parseInt,Pw=/^[+-]?0[Xx]/,Ho=8!==sh("\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff08")||22!==sh("\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff0x16")?function(h,l){return h=Ij(String(h)),sh(h,l>>>0||(Pw.test(h)?16:10))}:sh;M({global:!0,forced:parseInt!=Ho},{parseInt:Ho});var pd=function(h,l,g){if(Bb(h),void 0===l)return h;switch(g){case 0:return function(){return h.call(l)};case 1:return function(f){return h.call(l,f)};case 2:return function(f,k){return h.call(l,f,k)};case 3:return function(f,k,q){return h.call(l,f,k,q)}}return function(){return h.apply(l,arguments)}},qd=Array.isArray||function(h){return"Array"==ec(h)},Qw=qa("species"),th=function(h,l){if(qd(h)){var g=h.constructor;"function"!=typeof g||g!==Array&&!qd(g.prototype)?ha(g)&&null===(g=g[Qw])&&(g=void 0):g=void 0}return new(void 0===g?Array:g)(0===l?0:l)},Io=[].push,rd=function(h){var l=1==h,g=2==h,f=3==h,k=4==h,q=6==h,_r=7==h,_s=5==h||q;return function(ga,_l,bh,n_){var _A=Va(ga),r_=Tf(_A);_l=pd(_l,bh,3),bh=va(r_.length);var p_,I_=0;for(n_=n_||th,ga=l?n_(ga,bh):g||_r?n_(ga,0):void 0;bh>I_;I_++)if((_s||I_ in r_)&&(p_=_l(n_=r_[I_],I_,_A),h))if(l)ga[I_]=p_;else if(p_)switch(h){case 3:return!0;case 5:return n_;case 6:return I_;case 2:Io.call(ga,n_)}else switch(h){case 4:return!1;case 7:Io.call(ga,n_)}return q?-1:f||k?k:ga}},Sd=rd(0),Jo=rd(1),Ko=rd(2),Rw=rd(3),Sw=rd(4),Lo=rd(5),Mo=rd(6);rd(7);var Tw=qa("species"),Yf=function(h){return 51<=nd||!R(function(){var l=[];return(l.constructor={})[Tw]=function(){return{foo:1}},1!==l[h](Boolean).foo})},Uw=Yf("filter");M({target:"Array",proto:!0,forced:!Uw},{filter:function(h){return Ko(this,h,1<arguments.length?arguments[1]:void 0)}});var Mc=Object.keys||function(h){return to(h,ph)},Vw=R(function(){Mc(1)});M({target:"Object",stat:!0,forced:Vw},{keys:function(h){return Mc(Va(h))}});var Te=function(h,l){var g=[][h];return!!g&&R(function(){g.call(null,l||function(){throw 1},1)})},Ww=[].join,Xw=Tf!=Object,Yw=Te("join",",");M({target:"Array",proto:!0,forced:Xw||!Yw},{join:function(h){return Ww.call(tb(this),void 0===h?",":h)}});var Zw=Yf("map");M({target:"Array",proto:!0,forced:!Zw},{map:function(h){return Jo(this,h,1<arguments.length?arguments[1]:void 0)}});var Jj=function(h){var l=h.return;if(void 0!==l)return sa(l.call(h)).value},Ue={},$w=qa("iterator"),ax=Array.prototype,Kj=function(h){return void 0!==h&&(Ue.Array===h||ax[$w]===h)},Ve=function(h,l,g){(l=tc(l))in h?Wa.f(h,l,sc(0,g)):h[l]=g},bx=qa("toStringTag"),No={};No[bx]="z";var Lj="[object z]"===String(No),cx=qa("toStringTag"),dx="Arguments"==ec(function(){return arguments}()),We=Lj?ec:function(h){var l;if(void 0===h)var g="Undefined";else{if(null===h)var f="Null";else{e:{var k=h=Object(h);try{f=k[cx];break e}catch(q){}f=void 0}f="string"==typeof(g=f)?g:dx?ec(h):"Object"==(l=ec(h))&&"function"==typeof h.callee?"Arguments":l}g=f}return g},ex=qa("iterator"),Zf=function(h){if(null!=h)return h[ex]||h["@@iterator"]||Ue[We(h)]},Td=function(h){var l,g=Va(h),f="function"==typeof this?this:Array,k=arguments.length,q=1<k?arguments[1]:void 0,_r=void 0!==q,_s=Zf(g),ga=0;if(_r&&(q=pd(q,2<k?arguments[2]:void 0,2)),null==_s||f==Array&&Kj(_s)){var _l=va(g.length);for(f=new f(_l);_l>ga;ga++)_s=_r?q(g[ga],ga):g[ga],Ve(f,ga,_s)}else for(k=(g=_s.call(g)).next,f=new f;!(l=k.call(g)).done;ga++){if(_r){_s=g;var bh=q;l=[l.value,ga];try{_l=bh(sa(l)[0],l[1])}catch(n_){throw Jj(_s),n_}}else _l=l.value;Ve(f,ga,_s=_l)}return f.length=ga,f},Oo=qa("iterator"),Po=!1;try{var fx=0,Qo={next:function(){return{done:!!fx++}},return:function(){Po=!0}};Qo[Oo]=function(){return this},Array.from(Qo,function(){throw 2})}catch(h){}var uh=function(h,l){if(!l&&!Po)return!1;var g=!1;try{(l={})[Oo]=function(){return{next:function(){return{done:g=!0}}}},h(l)}catch(f){}return g},gx=!uh(function(h){Array.from(h)});M({target:"Array",stat:!0,forced:gx},{from:Td});var Ro=!R(function(){function h(){}return h.prototype.constructor=null,Object.getPrototypeOf(new h)!==h.prototype}),So=nh("IE_PROTO"),hx=Object.prototype,ac=Ro?Object.getPrototypeOf:function(h){return h=Va(h),Q(h,So)?h[So]:"function"==typeof h.constructor&&h instanceof h.constructor?h.constructor.prototype:h instanceof Object?hx:null},Mj=qa("iterator"),To=!1,ix=function(){return this},Ud;if([].keys){var Uo=[].keys();if("next"in Uo){var Vo=ac(ac(Uo));Vo!==Object.prototype&&(Ud=Vo)}else To=!0}(null==Ud||R(function(){var h={};return Ud[Mj].call(h)!==h}))&&(Ud={}),Q(Ud,Mj)||Sa(Ud,Mj,ix);var vh=Ud,wh=To,Wo=fa?Object.defineProperties:function(h,l){sa(h);for(var g,f=Mc(l),k=f.length,q=0;k>q;)Wa.f(h,g=f[q++],l[g]);return h},Nj=Rb("document","documentElement"),Xo=nh("IE_PROTO"),Oj=function(){},Pj,xh=function(){try{Pj=document.domain&&new ActiveXObject("htmlfile")}catch(l){}if(Pj){var h=Pj;h.write("<script><\/script>"),h.close(),h=h.parentWindow.Object}else(h=mh?Ne.createElement("iframe"):{}).style.display="none",Nj.appendChild(h),h.src="javascript:",(h=h.contentWindow.document).open(),h.write("<script>document.F=Object<\/script>"),h.close(),h=h.F;for(xh=h,h=ph.length;h--;)delete xh.prototype[ph[h]];return xh()};Pe[Xo]=!0;var Sb=Object.create||function(h,l){if(null!==h){Oj.prototype=sa(h);var g=new Oj;Oj.prototype=null,g[Xo]=h}else g=xh();return void 0===l?g:Wo(g,l)},jx=Wa.f,Yo=qa("toStringTag"),gc=function(h,l,g){h&&!Q(h=g?h:h.prototype,Yo)&&jx(h,Yo,{configurable:!0,value:l})},kx=function(){return this},Zo=function(h,l,g){return l+=" Iterator",h.prototype=Sb(vh,{next:sc(1,g)}),gc(h,l,!1),Ue[l]=kx,h},Ya=Object.setPrototypeOf||("__proto__"in{}?function(){var h=!1,l={};try{var g=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set;g.call(l,[]),h=l instanceof Array}catch(f){}return function(f,k){if(sa(f),!ha(k)&&null!==k)throw TypeError("Can't set "+String(k)+" as a prototype");return h?g.call(f,k):f.__proto__=k,f}}():void 0),$f=qa("iterator"),lx=function(){return this},Qj=function(h,l,g,f,k,q,_r){Zo(g,l,f),f=function(I_){if(I_===k&&_A)return _A;if(!wh&&I_ in bh)return bh[I_];switch(I_){case"keys":case"values":case"entries":return function(){return new g(this,I_)}}return function(){return new g(this)}};var _s,ga=l+" Iterator",_l=!1,bh=h.prototype,n_=bh[$f]||bh["@@iterator"]||k&&bh[k],_A=!wh&&n_||f(k),r_="Array"==l&&bh.entries||n_;if(r_&&(h=ac(r_.call(new h)),vh!==Object.prototype&&h.next&&(ac(h)!==vh&&(Ya?Ya(h,vh):"function"!=typeof h[$f]&&Sa(h,$f,lx)),gc(h,ga,!0))),"values"==k&&n_&&"values"!==n_.name&&(_l=!0,_A=function(){return n_.call(this)}),bh[$f]!==_A&&Sa(bh,$f,_A),Ue[l]=_A,k){var p_={values:f("values"),keys:q?_A:f("keys"),entries:f("entries")};if(_r)for(_s in p_)!wh&&!_l&&_s in bh||Ea(bh,_s,p_[_s]);else M({target:l,proto:!0,forced:wh||_l},p_)}return p_},mx=La.set,nx=La.getterFor("String Iterator");Qj(String,"String",function(h){mx(this,{type:"String Iterator",string:String(h),index:0})},function(){var h=nx(this),l=h.string,g=h.index;return g>=l.length?{value:void 0,done:!0}:(l=Go(l,g),h.index+=l.length,{value:l,done:!1})});var Rj=qa("unscopables"),Sj=Array.prototype;null==Sj[Rj]&&Wa.f(Sj,Rj,{configurable:!0,value:Sb(null)});var Vd=function(h){Sj[Rj][h]=!0},$o=!0;"find"in[]&&Array(1).find(function(){$o=!1}),M({target:"Array",proto:!0,forced:$o},{find:function(h){return Lo(this,h,1<arguments.length?arguments[1]:void 0)}}),Vd("find");var ap=function(h){var l=String(mb(this)),g="";if(0>(h=fc(h))||1/0==h)throw RangeError("Wrong number of repetitions");for(;0<h;(h>>>=1)&&(l+=l))1&h&&(g+=l);return g};M({target:"String",proto:!0},{repeat:ap});var bp=[].indexOf,cp=!!bp&&0>1/[1].indexOf(1,-0),ox=Te("indexOf");M({target:"Array",proto:!0,forced:cp||!ox},{indexOf:function(h){return cp?bp.apply(this,arguments)||0:zj(this,h,1<arguments.length?arguments[1]:void 0)}});var iu=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,ju=/CrOS/,ku=/android|ipad|playbook|silk/i;pe.isMobile=pe,pe.default=pe,M({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991}),M({target:"Number",stat:!0},{isNaN:function(h){return h!=h}});var px=Lj?{}.toString:function(){return"[object "+We(this)+"]"};Lj||Ea(Object.prototype,"toString",px,{unsafe:!0});var Nc=C.Promise,Xe=function(h,l,g){for(var f in l)Ea(h,f,l[f],g);return h},dp=qa("species"),ag=function(h){h=Rb(h),fa&&h&&!h[dp]&&(0,Wa.f)(h,dp,{configurable:!0,get:function(){return this}})},hc=function(h,l,g){if(!(h instanceof l))throw TypeError("Incorrect "+(g?g+" ":"")+"invocation");return h},bg=function(h,l){this.stopped=h,this.result=l},yh=function(h,l,g){var f,k=!(!g||!g.AS_ENTRIES),q=!(!g||!g.IS_ITERATOR),_r=!(!g||!g.INTERRUPTED),_s=pd(l,g&&g.that,1+k+_r),ga=function(bh){return _l&&Jj(_l),new bg(!0,bh)};if(l=function(bh){return k?(sa(bh),_r?_s(bh[0],bh[1],ga):_s(bh[0],bh[1])):_r?_s(bh,ga):_s(bh)},q)var _l=h;else{if("function"!=typeof(q=Zf(h)))throw TypeError("Target is not iterable");if(Kj(q)){for(q=0,g=va(h.length);g>q;q++)if((f=l(h[q]))&&f instanceof bg)return f;return new bg(!1)}_l=q.call(h)}for(h=_l.next;!(q=h.call(_l)).done;){try{f=l(q.value)}catch(bh){throw Jj(_l),bh}if("object"==typeof f&&f&&f instanceof bg)return f}return new bg(!1)},ep=/(?:iphone|ipod|ipad).*applewebkit/i.test(Re),Oc="process"==ec(C.process),zh=C.location,Tj=C.setImmediate,fp=C.clearImmediate,qx=C.process,gp=C.MessageChannel,Uj=C.Dispatch,Vj=0,cg={},Wj=function(h){if(cg.hasOwnProperty(h)){var l=cg[h];delete cg[h],l()}},Xj=function(h){return function(){Wj(h)}},hp=function(h){Wj(h.data)},ip=function(h){C.postMessage(h+"",zh.protocol+"//"+zh.host)};if(!Tj||!fp)if(Tj=function(h){for(var l=[],g=1;arguments.length>g;)l.push(arguments[g++]);return cg[++Vj]=function(){("function"==typeof h?h:Function(h)).apply(void 0,l)},dg(Vj),Vj},fp=function(h){delete cg[h]},Oc)var dg=function(h){qx.nextTick(Xj(h))};else if(Uj&&Uj.now)dg=function(h){Uj.now(Xj(h))};else if(gp&&!ep){var jp=new gp,kp=jp.port2;jp.port1.onmessage=hp,dg=pd(kp.postMessage,kp,1)}else C.addEventListener&&"function"==typeof postMessage&&!C.importScripts&&zh&&"file:"!==zh.protocol&&!R(ip)?(dg=ip,C.addEventListener("message",hp,!1)):dg="onreadystatechange"in(mh?Ne.createElement("script"):{})?function(h){Nj.appendChild(mh?Ne.createElement("script"):{}).onreadystatechange=function(){Nj.removeChild(this),Wj(h)}}:function(h){setTimeout(Xj(h),0)};var Yj=Tj,rx=/web0s(?!.*chrome)/i.test(Re),sx=Jb.f,lp=C.MutationObserver||C.WebKitMutationObserver,mp=C.document,np=C.process,Ah=C.Promise,op=sx(C,"queueMicrotask"),pp=op&&op.value,Wd,eg;if(!pp){var Ch=function(){var h;for(Oc&&(h=np.domain)&&h.exit();Wd;){var l=Wd.fn;Wd=Wd.next;try{l()}catch(g){throw Wd?Bh():eg=void 0,g}}eg=void 0,h&&h.enter()};if(ep||Oc||rx||!lp||!mp)if(Ah&&Ah.resolve){var Zj=Ah.resolve(void 0);Zj.constructor=Ah;var tx=Zj.then,Bh=function(){tx.call(Zj,Ch)}}else Bh=Oc?function(){np.nextTick(Ch)}:function(){Yj.call(C,Ch)};else{var qp=!0,rp=mp.createTextNode("");new lp(Ch).observe(rp,{characterData:!0}),Bh=function(){rp.data=qp=!qp}}}var sp=pp||function(h){h={fn:h,next:void 0},eg&&(eg.next=h),Wd||(Wd=h,Bh()),eg=h},ux=function(h){var l,g;this.promise=new h(function(f,k){if(void 0!==l||void 0!==g)throw TypeError("Bad Promise constructor");l=f,g=k}),this.resolve=Bb(l),this.reject=Bb(g)},ak={f:function(h){return new ux(h)}},bk=function(h,l){return sa(h),ha(l)&&l.constructor===h?l:((0,(h=ak.f(h)).resolve)(l),h.promise)},vx=function(h,l){var g=C.console;g&&g.error&&(1===arguments.length?g.error(h):g.error(h,l))},ck=function(h){try{return{error:!1,value:h()}}catch(l){return{error:!0,value:l}}},wx="object"==typeof window,xx=qa("species"),tp=La.get,yx=La.set,zx=La.getterFor("Promise"),Xd=Nc&&Nc.prototype,Cb=Nc,Dh=Xd,up=C.TypeError,dk=C.document,ek=C.process,Ye=ak.f,Ax=Ye,Bx=!!(dk&&dk.createEvent&&C.dispatchEvent),vp="function"==typeof PromiseRejectionEvent,wp=!1,fg=uc("Promise",function(){var h=wj(Cb)!==String(Cb);if(!h&&66===nd)return!0;if(51<=nd&&/native code/.test(Cb))return!1;var l=new Cb(function(f){f(1)}),g=function(f){f(function(){},function(){})};return(l.constructor={})[xx]=g,!(wp=l.then(function(){})instanceof g)||!h&&wx&&!vp}),Cx=fg||!uh(function(h){Cb.all(h).catch(function(){})}),xp=function(h){var l;return!(!ha(h)||"function"!=typeof(l=h.then))&&l},fk=function(h,l){if(!h.notified){h.notified=!0;var g=h.reactions;sp(function(){for(var f=h.value,k=1==h.state,q=0;g.length>q;){var _r,_s=g[q++],ga=k?_s.ok:_s.fail,_l=_s.resolve,bh=_s.reject,n_=_s.domain;try{if(ga){if(k||(2===h.rejection&&Dx(h),h.rejection=1),!0===ga)var _A=f;else if(n_&&n_.enter(),_A=ga(f),n_){n_.exit();var r_=!0}_A===_s.promise?bh(up("Promise-chain cycle")):(_r=xp(_A))?_r.call(_A,_l,bh):_l(_A)}else bh(f)}catch(p_){n_&&!r_&&n_.exit(),bh(p_)}}h.reactions=[],h.notified=!1,l&&!h.rejection&&Ex(h)})}},yp=function(h,l,g){var f;if(Bx){var k=dk.createEvent("Event");k.promise=l,k.reason=g,k.initEvent(h,!1,!0),C.dispatchEvent(k)}else k={promise:l,reason:g};!vp&&(f=C["on"+h])?f(k):"unhandledrejection"===h&&vx("Unhandled promise rejection",g)},Ex=function(h){Yj.call(C,function(){var l=h.facade,g=h.value;if(1!==h.rejection&&!h.parent){var f=ck(function(){Oc?ek.emit("unhandledRejection",g,l):yp("unhandledrejection",l,g)});if(h.rejection=Oc||1!==h.rejection&&!h.parent?2:1,f.error)throw f.value}})},Dx=function(h){Yj.call(C,function(){var l=h.facade;Oc?ek.emit("rejectionHandled",l):yp("rejectionhandled",l,h.value)})},Ze=function(h,l,g){return function(f){h(l,f,g)}},$e=function(h,l,g){h.done||(h.done=!0,g&&(h=g),h.value=l,h.state=2,fk(h,!0))},gk=function(h,l,g){if(!h.done){h.done=!0,g&&(h=g);try{if(h.facade===l)throw up("Promise can't be resolved itself");var f=xp(l);f?sp(function(){var k={done:!1};try{f.call(l,Ze(gk,k,h),Ze($e,k,h))}catch(q){$e(k,q,h)}}):(h.value=l,h.state=1,fk(h,!1))}catch(k){$e({done:!1},k,h)}}};if(fg){Cb=function(h){hc(this,Cb,"Promise"),Bb(h),hk.call(this);var l=tp(this);try{h(Ze(gk,l),Ze($e,l))}catch(g){$e(l,g)}},Dh=Cb.prototype;var hk=function(h){yx(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})};hk.prototype=Xe(Dh,{then:function(h,l){var g=zx(this),f=Ye(od(this,Cb));return f.ok="function"!=typeof h||h,f.fail="function"==typeof l&&l,f.domain=Oc?ek.domain:void 0,g.parent=!0,g.reactions.push(f),0!=g.state&&fk(g,!1),f.promise},catch:function(h){return this.then(void 0,h)}});var Fx=function(){var h=new hk,l=tp(h);this.promise=h,this.resolve=Ze(gk,l),this.reject=Ze($e,l)};if(ak.f=Ye=function(h){return h===Cb||h===Gx?new Fx(h):Ax(h)},"function"==typeof Nc&&Xd!==Object.prototype){var Hx=Xd.then;wp||(Ea(Xd,"then",function(h,l){var g=this;return new Cb(function(f,k){Hx.call(g,f,k)}).then(h,l)},{unsafe:!0}),Ea(Xd,"catch",Dh.catch,{unsafe:!0}));try{delete Xd.constructor}catch(h){}Ya&&Ya(Xd,Dh)}}M({global:!0,wrap:!0,forced:fg},{Promise:Cb}),gc(Cb,"Promise",!1),ag("Promise");var Gx=Rb("Promise");M({target:"Promise",stat:!0,forced:fg},{reject:function(h){var l=Ye(this);return l.reject.call(void 0,h),l.promise}}),M({target:"Promise",stat:!0,forced:fg},{resolve:function(h){return bk(this,h)}}),M({target:"Promise",stat:!0,forced:Cx},{all:function(h){var l=this,g=Ye(l),f=g.resolve,k=g.reject,q=ck(function(){var _r=Bb(l.resolve),_s=[],ga=0,_l=1;yh(h,function(bh){var n_=ga++,_A=!1;_s.push(void 0),_l++,_r.call(l,bh).then(function(r_){_A||(_A=!0,_s[n_]=r_,--_l||f(_s))},k)}),--_l||f(_s)});return q.error&&k(q.value),g.promise},race:function(h){var l=this,g=Ye(l),f=g.reject,k=ck(function(){var q=Bb(l.resolve);yh(h,function(_r){q.call(l,_r).then(g.resolve,f)})});return k.error&&f(k.value),g.promise}});var Ix=Math.floor,Jx="".replace,Kx=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Lx=/\$([$&'`]|\d{1,2})/g,Mx=function(h,l,g,f,k,q){var _r=g+h.length,_s=f.length,ga=Lx;return void 0!==k&&(k=Va(k),ga=Kx),Jx.call(q,ga,function(_l,bh){switch(bh.charAt(0)){case"$":return"$";case"&":return h;case"`":return l.slice(0,g);case"'":return l.slice(_r);case"<":_l=k[bh.slice(1,-1)];break;default:var n_=+bh;if(0===n_)return _l;if(n_>_s)return 0===(n_=Ix(n_/10))?_l:n_<=_s?void 0===f[n_-1]?bh.charAt(1):f[n_-1]+bh.charAt(1):_l;_l=f[n_-1]}return void 0===_l?"":_l})},Nx=Math.max,Ox=Math.min,Px=function(h){return void 0===h?h:String(h)};rh("replace",2,function(h,l,g,f){var k=f.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,q=f.REPLACE_KEEPS_$0,_r=k?"$":"$0";return[function(_s,ga){var _l=mb(this),bh=null==_s?void 0:_s[h];return void 0!==bh?bh.call(_s,_l,ga):l.call(String(_l),_s,ga)},function(_s,ga){if(!k&&q||"string"==typeof ga&&-1===ga.indexOf(_r)){var _l=g(l,_s,this,ga);if(_l.done)return _l.value}var bh=sa(_s);_s=String(this),(_l="function"==typeof ga)||(ga=String(ga));var n_=bh.global;if(n_){var _A=bh.unicode;bh.lastIndex=0}for(var r_=[];;){var p_=Se(bh,_s);if(null===p_||(r_.push(p_),!n_))break;""===String(p_[0])&&(bh.lastIndex=Gj(_s,va(bh.lastIndex),_A))}for(_A="",n_=bh=0;n_<r_.length;n_++){p_=r_[n_];for(var I_=String(p_[0]),v_=Nx(Ox(fc(p_.index),_s.length),0),S_=[],x_=1;x_<p_.length;x_++)S_.push(Px(p_[x_]));p_=p_.groups,_l?(S_=[I_].concat(S_,v_,_s),void 0!==p_&&S_.push(p_),p_=String(ga.apply(void 0,S_))):p_=Mx(I_,_s,v_,S_,p_,ga),v_>=bh&&(_A+=_s.slice(bh,v_)+p_,bh=v_+I_.length)}return _A+_s.slice(bh)}]});var Qx=Yf("slice"),Rx=qa("species"),Sx=[].slice,Tx=Math.max;M({target:"Array",proto:!0,forced:!Qx},{slice:function(h,l){var g=tb(this),f=va(g.length);if(h=Ab(h,f),l=Ab(void 0===l?f:l,f),qd(g)){var k=g.constructor;if("function"!=typeof k||k!==Array&&!qd(k.prototype)?ha(k)&&null===(k=k[Rx])&&(k=void 0):k=void 0,k===Array||void 0===k)return Sx.call(g,h,l)}for(k=new(void 0===k?Array:k)(Tx(l-h,0)),f=0;h<l;h++,f++)h in g&&Ve(k,f,g[h]);return k.length=f,k}});var Ux=La.set,Vx=La.getterFor("Array Iterator"),sd=Qj(Array,"Array",function(h,l){Ux(this,{type:"Array Iterator",target:tb(h),index:0,kind:l})},function(){var h=Vx(this),l=h.target,g=h.kind,f=h.index++;return!l||f>=l.length?(h.target=void 0,{value:void 0,done:!0}):"keys"==g?{value:f,done:!1}:"values"==g?{value:l[f],done:!1}:{value:[f,l[f]],done:!1}},"values");Ue.Arguments=Ue.Array,Vd("keys"),Vd("values"),Vd("entries");var zp="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,af=function(h){if(void 0===h)return 0;h=fc(h);var l=va(h);if(h!==l)throw RangeError("Wrong length or index");return l},Wx=Math.abs,Pc=Math.pow,Xx=Math.floor,Yx=Math.log,Zx=Math.LN2,ik=function(h){var l=Va(this),g=va(l.length),f=arguments.length,k=Ab(1<f?arguments[1]:void 0,g);for(g=void 0===(f=2<f?arguments[2]:void 0)?g:Ab(f,g);g>k;)l[k++]=h;return l},$x=Rd.f,ay=Wa.f,bf=La.get,Ap=La.set,ic=C.ArrayBuffer,Db=ic,jc=C.DataView,Eh=jc&&jc.prototype,Bp=Object.prototype,Fh=C.RangeError,Cp=function(h,l,g){var f,k=Array(g),q=(1<<(g=8*g-l-1))-1,_r=q>>1,_s=23===l?Pc(2,-24)-Pc(2,-77):0,ga=0>h||0===h&&0>1/h?1:0,_l=0;if((h=Wx(h))!=h||1/0===h){h=h!=h?1:0;var bh=q}else bh=Xx(Yx(h)/Zx),1>h*(f=Pc(2,-bh))&&(bh--,f*=2),2<=(h=1<=bh+_r?h+_s/f:h+_s*Pc(2,1-_r))*f&&(bh++,f/=2),bh+_r>=q?(h=0,bh=q):1<=bh+_r?(h=(h*f-1)*Pc(2,l),bh+=_r):(h=h*Pc(2,_r-1)*Pc(2,l),bh=0);for(;8<=l;k[_l++]=255&h,h/=256,l-=8);for(bh=bh<<l|h,g+=l;0<g;k[_l++]=255&bh,bh/=256,g-=8);return k[--_l]|=128*ga,k},Dp=function(h,l){var g=h.length,f=8*g-l-1,k=(1<<f)-1,q=k>>1;f-=7,--g;var _r=h[g--],_s=127&_r;for(_r>>=7;0<f;_s=256*_s+h[g],g--,f-=8);var ga=_s&(1<<-f)-1;for(_s>>=-f,f+=l;0<f;ga=256*ga+h[g],g--,f-=8);if(0===_s)_s=1-q;else{if(_s===k)return ga?NaN:_r?-1/0:1/0;ga+=Pc(2,l),_s-=q}return(_r?-1:1)*ga*Pc(2,_s-l)},Ep=function(h){return[255&h]},Fp=function(h){return[255&h,h>>8&255]},Gp=function(h){return[255&h,h>>8&255,h>>16&255,h>>24&255]},Hp=function(h){return h[3]<<24|h[2]<<16|h[1]<<8|h[0]},by=function(h){return Cp(h,23,4)},cy=function(h){return Cp(h,52,8)},Gh=function(h,l){ay(h.prototype,l,{get:function(){return bf(this)[l]}})},td=function(h,l,g,f){g=af(g);var k=bf(h);if(g+l>k.byteLength)throw Fh("Wrong index");return l=(h=bf(k.buffer).bytes).slice(g+=k.byteOffset,g+l),f?l:l.reverse()},ud=function(h,l,g,f,k,q){g=af(g);var _r=bf(h);if(g+l>_r.byteLength)throw Fh("Wrong index");for(h=bf(_r.buffer).bytes,g+=_r.byteOffset,f=f(+k),k=0;k<l;k++)h[g+k]=f[q?k:l-k-1]};if(zp){if(!R(function(){ic(1)})||!R(function(){new ic(-1)})||R(function(){return new ic,new ic(1.5),new ic(NaN),"ArrayBuffer"!=ic.name})){Db=function(h){return hc(this,Db),new ic(af(h))};for(var dy=Db.prototype=ic.prototype,Ip=$x(ic),Jp=0,jk;Ip.length>Jp;)(jk=Ip[Jp++])in Db||Sa(Db,jk,ic[jk]);dy.constructor=Db}Ya&&ac(Eh)!==Bp&&Ya(Eh,Bp);var Hh=new jc(new Db(2)),Kp=Eh.setInt8;Hh.setInt8(0,2147483648),Hh.setInt8(1,2147483649),!Hh.getInt8(0)&&Hh.getInt8(1)||Xe(Eh,{setInt8:function(h,l){Kp.call(this,h,l<<24>>24)},setUint8:function(h,l){Kp.call(this,h,l<<24>>24)}},{unsafe:!0})}else Db=function(h){hc(this,Db,"ArrayBuffer"),h=af(h),Ap(this,{bytes:ik.call(Array(h),0),byteLength:h}),fa||(this.byteLength=h)},jc=function(h,l,g){hc(this,jc,"DataView"),hc(h,Db,"DataView");var f=bf(h).byteLength;if(0>(l=fc(l))||l>f)throw Fh("Wrong offset");if(l+(g=void 0===g?f-l:va(g))>f)throw Fh("Wrong length");Ap(this,{buffer:h,byteLength:g,byteOffset:l}),fa||(this.buffer=h,this.byteLength=g,this.byteOffset=l)},fa&&(Gh(Db,"byteLength"),Gh(jc,"buffer"),Gh(jc,"byteLength"),Gh(jc,"byteOffset")),Xe(jc.prototype,{getInt8:function(h){return td(this,1,h)[0]<<24>>24},getUint8:function(h){return td(this,1,h)[0]},getInt16:function(h){var l=td(this,2,h,1<arguments.length?arguments[1]:void 0);return(l[1]<<8|l[0])<<16>>16},getUint16:function(h){var l=td(this,2,h,1<arguments.length?arguments[1]:void 0);return l[1]<<8|l[0]},getInt32:function(h){return Hp(td(this,4,h,1<arguments.length?arguments[1]:void 0))},getUint32:function(h){return Hp(td(this,4,h,1<arguments.length?arguments[1]:void 0))>>>0},getFloat32:function(h){return Dp(td(this,4,h,1<arguments.length?arguments[1]:void 0),23)},getFloat64:function(h){return Dp(td(this,8,h,1<arguments.length?arguments[1]:void 0),52)},setInt8:function(h,l){ud(this,1,h,Ep,l)},setUint8:function(h,l){ud(this,1,h,Ep,l)},setInt16:function(h,l){ud(this,2,h,Fp,l,2<arguments.length?arguments[2]:void 0)},setUint16:function(h,l){ud(this,2,h,Fp,l,2<arguments.length?arguments[2]:void 0)},setInt32:function(h,l){ud(this,4,h,Gp,l,2<arguments.length?arguments[2]:void 0)},setUint32:function(h,l){ud(this,4,h,Gp,l,2<arguments.length?arguments[2]:void 0)},setFloat32:function(h,l){ud(this,4,h,by,l,2<arguments.length?arguments[2]:void 0)},setFloat64:function(h,l){ud(this,8,h,cy,l,2<arguments.length?arguments[2]:void 0)}});gc(Db,"ArrayBuffer"),gc(jc,"DataView");var gg={ArrayBuffer:Db,DataView:jc},kk=gg.ArrayBuffer,Lp=gg.DataView,Mp=kk.prototype.slice,ey=R(function(){return!new kk(2).slice(1,void 0).byteLength});M({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:ey},{slice:function(h,l){if(void 0!==Mp&&void 0===l)return Mp.call(sa(this),h);var g=sa(this).byteLength;h=Ab(h,g),l=Ab(void 0===l?g:l,g),g=new(od(this,kk))(va(l-h));for(var f=new Lp(this),k=new Lp(g),q=0;h<l;)k.setUint8(q++,f.getUint8(h++));return g}});var fy=Wa.f,Ih=C.Int8Array,lk=Ih&&Ih.prototype,Np=C.Uint8ClampedArray,Op=Np&&Np.prototype,xc=Ih&&ac(Ih),kc=lk&&ac(lk),Pp=Object.prototype,Qp=Pp.isPrototypeOf,Rp=qa("toStringTag"),mk=Oe("TYPED_ARRAY_TAG"),Qc=zp&&!!Ya&&"Opera"!==We(C.opera),Sp=!1,Eb,yc={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},gy={BigInt64Array:8,BigUint64Array:8},Jh=function(h){return!!ha(h)&&(h=We(h),Q(yc,h)||Q(gy,h))};for(Eb in yc)C[Eb]||(Qc=!1);if((!Qc||"function"!=typeof xc||xc===Function.prototype)&&(xc=function(){throw TypeError("Incorrect invocation")},Qc))for(Eb in yc)C[Eb]&&Ya(C[Eb],xc);if((!Qc||!kc||kc===Pp)&&(kc=xc.prototype,Qc))for(Eb in yc)C[Eb]&&Ya(C[Eb].prototype,kc);if(Qc&&ac(Op)!==kc&&Ya(Op,kc),fa&&!Q(kc,Rp))for(Eb in Sp=!0,fy(kc,Rp,{get:function(){return ha(this)?this[mk]:void 0}}),yc)C[Eb]&&Sa(C[Eb],mk,Eb);var hg=Qc,Tp=Sp&&mk,Fa=function(h){if(Jh(h))return h;throw TypeError("Target is not a typed array")},cf=function(h){if(Ya){if(Qp.call(xc,h))return h}else for(var l in yc)if(Q(yc,Eb)){var g=C[l];if(g&&(h===g||Qp.call(g,h)))return h}throw TypeError("Target is not a typed array constructor")},Ba=function(h,l,g){if(fa){if(g)for(var f in yc){var k=C[f];if(k&&Q(k.prototype,h))try{delete k.prototype[h]}catch(q){}}kc[h]&&!g||Ea(kc,h,g?l:Qc&&lk[h]||l)}},Up=function(h,l,g){var f,k;if(fa){if(Ya){if(g)for(f in yc)if((k=C[f])&&Q(k,h))try{delete k[h]}catch(q){}if(xc[h]&&!g)return;try{return Ea(xc,h,g?l:Qc&&xc[h]||l)}catch(q){}}for(f in yc)!(k=C[f])||k[h]&&!g||Ea(k,h,l)}},Vp=xc,ig=kc,hy=C.ArrayBuffer,Yd=C.Int8Array,nk=!hg||!R(function(){Yd(1)})||!R(function(){new Yd(-1)})||!uh(function(h){new Yd,new Yd(null),new Yd(1.5),new Yd(h)},!0)||R(function(){return 1!==new Yd(new hy(2),1,void 0).length}),Kh=function(h,l){if(0>(h=fc(h)))throw RangeError("The argument can't be less than 0");if(h%l)throw RangeError("Wrong offset");return h},ok=function(h){var l=Va(h),g=arguments.length,f=1<g?arguments[1]:void 0,k=void 0!==f,q=Zf(l);if(null!=q&&!Kj(q)){var _r=q.call(l),_s=_r.next;for(l=[];!(q=_s.call(_r)).done;)l.push(q.value)}for(k&&2<g&&(f=pd(f,arguments[2],2)),q=va(l.length),_r=new(cf(this))(q),g=0;q>g;g++)_r[g]=k?f(l[g],g):l[g];return _r},Lh=function(h,l,g){var f,k;return Ya&&"function"==typeof(f=l.constructor)&&f!==g&&ha(k=f.prototype)&&k!==g.prototype&&Ya(h,k),h},jg=cb(function(h){var l=Rd.f,g=La.get,f=La.set,k=Wa.f,q=Jb.f,_r=Math.round,_s=C.RangeError,ga=gg.ArrayBuffer,_l=gg.DataView,bh=function(v_,S_){var x_=0,B_=S_.length;for(v_=new(cf(v_))(B_);B_>x_;)v_[x_]=S_[x_++];return v_},n_=function(v_,S_){k(v_,S_,{get:function(){return g(this)[S_]}})},_A=function(v_){var S_;return v_ instanceof ga||"ArrayBuffer"==(S_=We(v_))||"SharedArrayBuffer"==S_},r_=function(v_,S_){return Jh(v_)&&"symbol"!=typeof S_&&S_ in v_&&String(+S_)==String(S_)},p_=function(v_,S_){return r_(v_,S_=tc(S_,!0))?sc(2,v_[S_]):q(v_,S_)},I_=function(v_,S_,x_){return!(r_(v_,S_=tc(S_,!0))&&ha(x_)&&Q(x_,"value"))||Q(x_,"get")||Q(x_,"set")||x_.configurable||Q(x_,"writable")&&!x_.writable||Q(x_,"enumerable")&&!x_.enumerable?k(v_,S_,x_):(v_[S_]=x_.value,v_)};fa?(hg||(Jb.f=p_,Wa.f=I_,n_(ig,"buffer"),n_(ig,"byteOffset"),n_(ig,"byteLength"),n_(ig,"length")),M({target:"Object",stat:!0,forced:!hg},{getOwnPropertyDescriptor:p_,defineProperty:I_}),h.exports=function(v_,S_,x_){var B_=v_.match(/\d+$/)[0]/8,V_=v_+(x_?"Clamped":"")+"Array",_0="get"+v_,c0="set"+v_,Pv=C[V_],h0=Pv;v_=h0&&h0.prototype;var I0={},G_=function(e0,P_){k(e0,P_,{get:function(){var _v=g(this);return _v.view[_0](P_*B_+_v.byteOffset,!0)},set:function(_v){var E_=g(this);x_&&(_v=0>(_v=_r(_v))?0:255<_v?255:255&_v),E_.view[c0](P_*B_+E_.byteOffset,_v,!0)},enumerable:!0})};hg?nk&&(h0=S_(function(e0,P_,_v,E_){return hc(e0,h0,V_),Lh(ha(P_)?_A(P_)?void 0!==E_?new Pv(P_,Kh(_v,B_),E_):void 0!==_v?new Pv(P_,Kh(_v,B_)):new Pv(P_):Jh(P_)?bh(h0,P_):ok.call(h0,P_):new Pv(af(P_)),e0,h0)}),Ya&&Ya(h0,Vp),Sd(l(Pv),function(e0){e0 in h0||Sa(h0,e0,Pv[e0])}),h0.prototype=v_):(h0=S_(function(e0,P_,_v,E_){hc(e0,h0,V_);var L_=0,F_=0;if(ha(P_)){if(!_A(P_))return Jh(P_)?bh(h0,P_):ok.call(h0,P_);var J_=P_;if(F_=Kh(_v,B_),P_=P_.byteLength,void 0===E_){if(P_%B_||0>(E_=P_-F_))throw _s("Wrong length")}else if((E_=va(E_)*B_)+F_>P_)throw _s("Wrong length");P_=E_/B_}else P_=af(P_),J_=new ga(E_=P_*B_);for(f(e0,{buffer:J_,byteOffset:F_,byteLength:E_,length:P_,view:new _l(J_)});L_<P_;)G_(e0,L_++)}),Ya&&Ya(h0,Vp),v_=h0.prototype=Sb(ig)),v_.constructor!==h0&&Sa(v_,"constructor",h0),Tp&&Sa(v_,Tp,V_),I0[V_]=h0,M({global:!0,forced:h0!=Pv,sham:!hg},I0),"BYTES_PER_ELEMENT"in h0||Sa(h0,"BYTES_PER_ELEMENT",B_),"BYTES_PER_ELEMENT"in v_||Sa(v_,"BYTES_PER_ELEMENT",B_),ag(V_)}):h.exports=function(){}});jg("Uint8",function(h){return function(l,g,f){return h(this,l,g,f)}});var iy=Math.min,jy=[].copyWithin||function(h,l){var g=Va(this),f=va(g.length),k=Ab(h,f),q=Ab(l,f),_r=2<arguments.length?arguments[2]:void 0;for(f=iy((void 0===_r?f:Ab(_r,f))-q,f-k),_r=1,q<k&&k<q+f&&(_r=-1,q+=f-1,k+=f-1);0<f--;)q in g?g[k]=g[q]:delete g[k],k+=_r,q+=_r;return g};Ba("copyWithin",function(h,l){return jy.call(Fa(this),h,l,2<arguments.length?arguments[2]:void 0)}),Ba("every",function(h){return Sw(Fa(this),h,1<arguments.length?arguments[1]:void 0)}),Ba("fill",function(h){return ik.apply(Fa(this),arguments)}),Ba("filter",function(h){var l=Ko(Fa(this),h,1<arguments.length?arguments[1]:void 0),g=od(this,this.constructor),f=0,k=l.length;for(g=new(cf(g))(k);k>f;)g[f]=l[f++];return g}),Ba("find",function(h){return Lo(Fa(this),h,1<arguments.length?arguments[1]:void 0)}),Ba("findIndex",function(h){return Mo(Fa(this),h,1<arguments.length?arguments[1]:void 0)}),Ba("forEach",function(h){Sd(Fa(this),h,1<arguments.length?arguments[1]:void 0)}),Ba("includes",function(h){return so(Fa(this),h,1<arguments.length?arguments[1]:void 0)}),Ba("indexOf",function(h){return zj(Fa(this),h,1<arguments.length?arguments[1]:void 0)});var Wp=qa("iterator"),Xp=C.Uint8Array,ky=sd.values,ly=sd.keys,my=sd.entries,pk=Xp&&Xp.prototype[Wp],Yp=!!pk&&("values"==pk.name||null==pk.name),Zp=function(){return ky.call(Fa(this))};Ba("entries",function(){return my.call(Fa(this))}),Ba("keys",function(){return ly.call(Fa(this))}),Ba("values",Zp,!Yp),Ba(Wp,Zp,!Yp);var ny=[].join;Ba("join",function(h){return ny.apply(Fa(this),arguments)});var oy=Math.min,qk=[].lastIndexOf,$p=!!qk&&0>1/[1].lastIndexOf(1,-0),py=Te("lastIndexOf"),qy=$p||!py?function(h){if($p)return qk.apply(this,arguments)||0;var l=tb(this),g=va(l.length),f=g-1;for(1<arguments.length&&(f=oy(f,fc(arguments[1]))),0>f&&(f=g+f);0<=f;f--)if(f in l&&l[f]===h)return f||0;return-1}:qk;Ba("lastIndexOf",function(h){return qy.apply(Fa(this),arguments)}),Ba("map",function(h){return Jo(Fa(this),h,1<arguments.length?arguments[1]:void 0,function(l,g){return new(cf(od(l,l.constructor)))(g)})});var aq=function(h){return function(l,g,f,k){Bb(g),l=Va(l);var q=Tf(l),_r=va(l.length),_s=h?_r-1:0,ga=h?-1:1;if(2>f)for(;;){if(_s in q){k=q[_s],_s+=ga;break}if(_s+=ga,h?0>_s:_r<=_s)throw TypeError("Reduce of empty array with no initial value")}for(;h?0<=_s:_r>_s;_s+=ga)_s in q&&(k=g(k,q[_s],_s,l));return k}},bq=aq(!1),ry=aq(!0);Ba("reduce",function(h){return bq(Fa(this),h,arguments.length,1<arguments.length?arguments[1]:void 0)}),Ba("reduceRight",function(h){return ry(Fa(this),h,arguments.length,1<arguments.length?arguments[1]:void 0)});var sy=Math.floor;Ba("reverse",function(){for(var h,l=Fa(this).length,g=sy(l/2),f=0;f<g;)h=this[f],this[f++]=this[--l],this[l]=h;return this});var ty=R(function(){new Int8Array(1).set({})});Ba("set",function(h){Fa(this);var l=Kh(1<arguments.length?arguments[1]:void 0,1),g=this.length,f=Va(h),k=va(f.length),q=0;if(k+l>g)throw RangeError("Wrong length");for(;q<k;)this[l+q]=f[q++]},ty);var uy=[].slice,vy=R(function(){new Int8Array(1).slice()});Ba("slice",function(h,l){h=uy.call(Fa(this),h,l);var g=od(this,this.constructor);l=0;var f=h.length;for(g=new(cf(g))(f);f>l;)g[l]=h[l++];return g},vy),Ba("some",function(h){return Rw(Fa(this),h,1<arguments.length?arguments[1]:void 0)});var wy=[].sort;Ba("sort",function(h){return wy.call(Fa(this),h)}),Ba("subarray",function(h,l){var g=Fa(this),f=g.length;return h=Ab(h,f),new(od(g,g.constructor))(g.buffer,g.byteOffset+h*g.BYTES_PER_ELEMENT,va((void 0===l?f:Ab(l,f))-h))});var Mh=C.Int8Array,cq=[].toLocaleString,xy=[].slice,yy=!!Mh&&R(function(){cq.call(new Mh(1))}),zy=R(function(){return[1,2].toLocaleString()!=new Mh([1,2]).toLocaleString()})||!R(function(){Mh.prototype.toLocaleString.call([1,2])});Ba("toLocaleString",function(){return cq.apply(yy?xy.call(Fa(this)):Fa(this),arguments)},zy);var dq=C.Uint8Array,Ay=dq&&dq.prototype||{},Nh=[].toString,By=[].join;R(function(){Nh.call({})})&&(Nh=function(){return By.call(this)}),Ba("toString",Nh,Ay.toString!=Nh);var eq=gg.ArrayBuffer;M({global:!0,forced:C.ArrayBuffer!==eq},{ArrayBuffer:eq}),ag("ArrayBuffer");var Cy=Wa.f,rk=Function.prototype,Dy=rk.toString,Ey=/^\s*function ([^ (]*)/;!fa||"name"in rk||Cy(rk,"name",{configurable:!0,get:function(){try{return Dy.call(this).match(Ey)[1]}catch(h){return""}}});var fq=RegExp.prototype,gq=fq.toString,Fy=R(function(){return"/a/b"!=gq.call({source:"a",flags:"b"})}),Gy="toString"!=gq.name;(Fy||Gy)&&Ea(RegExp.prototype,"toString",function(){var h=sa(this),l=String(h.source),g=h.flags;return"/"+l+"/"+String(void 0===g&&h instanceof RegExp&&!("flags"in fq)?Aj.call(h):g)},{unsafe:!0});var Hy=Yf("splice"),Iy=Math.max,Jy=Math.min;M({target:"Array",proto:!0,forced:!Hy},{splice:function(h,l){var g,f,k=Va(this),q=va(k.length),_r=Ab(h,q),_s=arguments.length;if(0===_s?_s=g=0:1===_s?(_s=0,g=q-_r):(_s-=2,g=Jy(Iy(fc(l),0),q-_r)),9007199254740991<q+_s-g)throw TypeError("Maximum allowed length exceeded");var ga=th(k,g);for(f=0;f<g;f++){var _l=_r+f;_l in k&&Ve(ga,f,k[_l])}if(ga.length=g,_s<g){for(f=_r;f<q-g;f++){var bh=f+_s;(_l=f+g)in k?k[bh]=k[_l]:delete k[bh]}for(f=q;f>q-g+_s;f--)delete k[f-1]}else if(_s>g)for(f=q-g;f>_r;f--)bh=f+_s-1,(_l=f+g-1)in k?k[bh]=k[_l]:delete k[bh];for(f=0;f<_s;f++)k[f+_r]=arguments[f+2];return k.length=q-g+_s,ga}});var sk={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},tk=qa("iterator"),hq=qa("toStringTag"),uk=sd.values,Oh;for(Oh in sk){var iq=C[Oh],Rc=iq&&iq.prototype;if(Rc){if(Rc[tk]!==uk)try{Sa(Rc,tk,uk)}catch(h){Rc[tk]=uk}if(Rc[hq]||Sa(Rc,hq,Oh),sk[Oh])for(var df in sd)if(Rc[df]!==sd[df])try{Sa(Rc,df,sd[df])}catch(h){Rc[df]=sd[df]}}}var jq=Object.is||function(h,l){return h===l?0!==h||1/h==1/l:h!=h&&l!=l};rh("search",1,function(h,l,g){return[function(f){var k=mb(this),q=null==f?void 0:f[h];return void 0!==q?q.call(f,k):new RegExp(f)[h](String(k))},function(f){var k=g(l,f,this);if(k.done)return k.value;f=sa(f);var q=String(this);return jq(k=f.lastIndex,0)||(f.lastIndex=0),q=Se(f,q),jq(f.lastIndex,k)||(f.lastIndex=k),null===q?-1:q.index}]}),cb(function(h){var l,g;l="undefined"!=typeof self?self:Ka,g=function(l){function g(G_){return btoa(G_).replace(/=+$/,"").replace(/\+/g,"-").replace(/\//g,"_")}function f(G_){return G_=(G_+="===").slice(0,-G_.length%4),atob(G_.replace(/-/g,"+").replace(/_/g,"/"))}function k(G_){for(var e0=new Uint8Array(G_.length),P_=0;P_<G_.length;P_++)e0[P_]=G_.charCodeAt(P_);return e0}function q(G_){return G_ instanceof ArrayBuffer&&(G_=new Uint8Array(G_)),String.fromCharCode.apply(String,G_)}function _r(G_){var e0={name:(G_.name||G_||"").toUpperCase().replace("V","v")};switch(e0.name){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;case"AES-CBC":case"AES-GCM":case"AES-KW":G_.length&&(e0.length=G_.length);break;case"HMAC":G_.hash&&(e0.hash=_r(G_.hash)),G_.length&&(e0.length=G_.length);break;case"RSAES-PKCS1-v1_5":G_.publicExponent&&(e0.publicExponent=new Uint8Array(G_.publicExponent)),G_.modulusLength&&(e0.modulusLength=G_.modulusLength);break;case"RSASSA-PKCS1-v1_5":case"RSA-OAEP":G_.hash&&(e0.hash=_r(G_.hash)),G_.publicExponent&&(e0.publicExponent=new Uint8Array(G_.publicExponent)),G_.modulusLength&&(e0.modulusLength=G_.modulusLength);break;default:throw new SyntaxError("Bad algorithm name")}return e0}function _s(G_){return{HMAC:{"SHA-1":"HS1","SHA-256":"HS256","SHA-384":"HS384","SHA-512":"HS512"},"RSASSA-PKCS1-v1_5":{"SHA-1":"RS1","SHA-256":"RS256","SHA-384":"RS384","SHA-512":"RS512"},"RSAES-PKCS1-v1_5":{"":"RSA1_5"},"RSA-OAEP":{"SHA-1":"RSA-OAEP","SHA-256":"RSA-OAEP-256"},"AES-KW":{128:"A128KW",192:"A192KW",256:"A256KW"},"AES-GCM":{128:"A128GCM",192:"A192GCM",256:"A256GCM"},"AES-CBC":{128:"A128CBC",192:"A192CBC",256:"A256CBC"}}[G_.name][(G_.hash||{}).name||G_.length||""]}function ga(G_){(G_ instanceof ArrayBuffer||G_ instanceof Uint8Array)&&(G_=JSON.parse(decodeURIComponent(escape(q(G_)))));var e0={kty:G_.kty,alg:G_.alg,ext:G_.ext||G_.extractable};switch(e0.kty){case"oct":e0.k=G_.k;case"RSA":"n e d p q dp dq qi oth".split(" ").forEach(function(P_){P_ in G_&&(e0[P_]=G_[P_])});break;default:throw new TypeError("Unsupported key type")}return e0}function _l(G_){return G_=ga(G_),_0&&(G_.extractable=G_.ext,delete G_.ext),k(unescape(encodeURIComponent(JSON.stringify(G_)))).buffer}function bh(G_){var e0=n_(G_),P_=!1;if("1.2.840.113549.1.1.1"!==(2<e0.length&&(P_=!0,e0.shift()),G_={ext:!0},e0[0][0]))throw new TypeError("Unsupported key type");var _v="n e d p q dp dq qi".split(" ");for(e0=n_(e0[1]),P_&&e0.shift(),P_=0;P_<e0.length;P_++)e0[P_][0]||(e0[P_]=e0[P_].subarray(1)),G_[_v[P_]]=g(q(e0[P_]));return G_.kty="RSA",G_}function n_(G_,e0){if(G_ instanceof ArrayBuffer&&(G_=new Uint8Array(G_)),e0||(e0={pos:0,end:G_.length}),2>e0.end-e0.pos||e0.end>G_.length)throw new RangeError("Malformed DER");var P_=G_[e0.pos++],_v=G_[e0.pos++];if(128<=_v){if(e0.end-e0.pos<(_v&=127))throw new RangeError("Malformed DER");for(var E_=0;_v--;)E_<<=8,E_|=G_[e0.pos++];_v=E_}if(e0.end-e0.pos<_v)throw new RangeError("Malformed DER");switch(P_){case 2:P_=G_.subarray(e0.pos,e0.pos+=_v);break;case 3:if(G_[e0.pos++])throw Error("Unsupported bit string");_v--;case 4:P_=new Uint8Array(G_.subarray(e0.pos,e0.pos+=_v)).buffer;break;case 5:P_=null;break;case 6:if(!((G_=btoa(q(G_.subarray(e0.pos,e0.pos+=_v))))in Pv))throw Error("Unsupported OBJECT ID "+G_);P_=Pv[G_];break;case 48:for(P_=[],_v=e0.pos+_v;e0.pos<_v;)P_.push(n_(G_,e0));break;default:throw Error("Unsupported DER tag 0x"+P_.toString(16))}return P_}function _A(G_,e0){e0||(e0=[]);var P_=e0.length+2;if(e0.push(0,0),G_ instanceof Uint8Array)for(var _v=2,E_=G_.length,L_=0;L_<E_;L_++)e0.push(G_[L_]);else if(G_ instanceof ArrayBuffer)for(_v=4,E_=G_.byteLength,G_=new Uint8Array(G_),L_=0;L_<E_;L_++)e0.push(G_[L_]);else if(null===G_)_v=5,E_=0;else if("string"==typeof G_&&G_ in h0)for(_v=6,E_=(G_=k(atob(h0[G_]))).length,L_=0;L_<E_;L_++)e0.push(G_[L_]);else if(G_ instanceof Array){for(L_=0;L_<G_.length;L_++)_A(G_[L_],e0);_v=48,E_=e0.length-P_}else{if(!("object"===V(G_)&&3===G_.tag&&G_.value instanceof ArrayBuffer))throw Error("Unsupported DER value "+G_);for(_v=3,E_=(G_=new Uint8Array(G_.value)).byteLength,e0.push(0),L_=0;L_<E_;L_++)e0.push(G_[L_]);E_++}if(128<=E_){for(L_=E_,E_=4,e0.splice(P_,0,L_>>24&255,L_>>16&255,L_>>8&255,255&L_);1<E_&&!(L_>>24);)L_<<=8,E_--;4>E_&&e0.splice(P_,4-E_),E_|=128}return e0.splice(P_-2,2,_v,E_),e0}function r_(G_,e0,P_,_v){Object.defineProperties(this,{_key:{value:G_},type:{value:G_.type,enumerable:!0},extractable:{value:void 0===P_?G_.extractable:P_,enumerable:!0},algorithm:{value:void 0===e0?G_.algorithm:e0,enumerable:!0},usages:{value:void 0===_v?G_.usages:_v,enumerable:!0}})}function p_(G_){return"verify"===G_||"encrypt"===G_||"wrapKey"===G_}function I_(G_){return"sign"===G_||"decrypt"===G_||"unwrapKey"===G_}if("function"!=typeof Promise)throw"Promise support required";var v_=l.crypto||l.msCrypto;if(v_){var S_=v_.subtle||v_.webkitSubtle;if(S_){var x_=l.Crypto||v_.constructor||Object,B_=l.SubtleCrypto||S_.constructor||Object,V_=-1<l.navigator.userAgent.indexOf("Edge/"),_0=!!l.msCrypto&&!V_,c0=!v_.subtle&&!!v_.webkitSubtle;if(_0||c0){var Pv={KoZIhvcNAQEB:"1.2.840.113549.1.1.1"},h0={"1.2.840.113549.1.1.1":"KoZIhvcNAQEB"};if(["generateKey","importKey","unwrapKey"].forEach(function(G_){var e0=S_[G_];S_[G_]=function(P_,_v,E_){var L_=[].slice.call(arguments);switch(G_){case"generateKey":var F_=_r(P_),J_=_v,Y_=E_;break;case"importKey":F_=_r(E_),J_=L_[3],Y_=L_[4],"jwk"===P_&&((_v=ga(_v)).alg||(_v.alg=_s(F_)),_v.key_ops||(_v.key_ops="oct"!==_v.kty?Y_.filter("d"in _v?I_:p_):Y_.slice()),L_[1]=_l(_v));break;case"unwrapKey":F_=L_[4],J_=L_[5],Y_=L_[6],L_[2]=E_._key}if("generateKey"===G_&&"HMAC"===F_.name&&F_.hash)return F_.length=F_.length||{"SHA-1":512,"SHA-256":512,"SHA-384":1024,"SHA-512":1024}[F_.hash.name],S_.importKey("raw",v_.getRandomValues(new Uint8Array(F_.length+7>>3)),F_,J_,Y_);if(c0&&"generateKey"===G_&&"RSASSA-PKCS1-v1_5"===F_.name&&(!F_.modulusLength||2048<=F_.modulusLength))return(P_=_r(P_)).name="RSAES-PKCS1-v1_5",delete P_.hash,S_.generateKey(P_,!0,["encrypt","decrypt"]).then(function(O0){return Promise.all([S_.exportKey("jwk",O0.publicKey),S_.exportKey("jwk",O0.privateKey)])}).then(function(O0){return O0[0].alg=O0[1].alg=_s(F_),O0[0].key_ops=Y_.filter(p_),O0[1].key_ops=Y_.filter(I_),Promise.all([S_.importKey("jwk",O0[0],F_,!0,O0[0].key_ops),S_.importKey("jwk",O0[1],F_,J_,O0[1].key_ops)])}).then(function(O0){return{publicKey:O0[0],privateKey:O0[1]}});if((c0||_0&&"SHA-1"===(F_.hash||{}).name)&&"importKey"===G_&&"jwk"===P_&&"HMAC"===F_.name&&"oct"===_v.kty)return S_.importKey("raw",k(f(_v.k)),E_,L_[3],L_[4]);if(c0&&"importKey"===G_&&("spki"===P_||"pkcs8"===P_))return S_.importKey("jwk",bh(_v),E_,L_[3],L_[4]);if(_0&&"unwrapKey"===G_)return S_.decrypt(L_[3],E_,_v).then(function(O0){return S_.importKey(P_,O0,L_[4],L_[5],L_[6])});try{var D0=e0.apply(S_,L_)}catch(O0){return Promise.reject(O0)}return _0&&(D0=new Promise(function(O0,EI){D0.onabort=D0.onerror=function(eI){EI(eI)},D0.oncomplete=function(eI){O0(eI.target.result)}})),D0=D0.then(function(O0){return"HMAC"!==F_.name||F_.length||(F_.length=8*O0.algorithm.length),0==F_.name.search("RSA")&&(F_.modulusLength||(F_.modulusLength=(O0.publicKey||O0).algorithm.modulusLength),F_.publicExponent||(F_.publicExponent=(O0.publicKey||O0).algorithm.publicExponent)),O0.publicKey&&O0.privateKey?{publicKey:new r_(O0.publicKey,F_,J_,Y_.filter(p_)),privateKey:new r_(O0.privateKey,F_,J_,Y_.filter(I_))}:new r_(O0,F_,J_,Y_)})}}),["exportKey","wrapKey"].forEach(function(G_){var e0=S_[G_];S_[G_]=function(P_,_v,E_){var L_=[].slice.call(arguments);switch(G_){case"exportKey":L_[1]=_v._key;break;case"wrapKey":L_[1]=_v._key,L_[2]=E_._key}if((c0||_0&&"SHA-1"===(_v.algorithm.hash||{}).name)&&"exportKey"===G_&&"jwk"===P_&&"HMAC"===_v.algorithm.name&&(L_[0]="raw"),!c0||"exportKey"!==G_||"spki"!==P_&&"pkcs8"!==P_||(L_[0]="jwk"),_0&&"wrapKey"===G_)return S_.exportKey(P_,_v).then(function(J_){return"jwk"===P_&&(J_=k(unescape(encodeURIComponent(JSON.stringify(ga(J_)))))),S_.encrypt(L_[3],E_,J_)});try{var F_=e0.apply(S_,L_)}catch(J_){return Promise.reject(J_)}return _0&&(F_=new Promise(function(J_,Y_){F_.onabort=F_.onerror=function(D0){Y_(D0)},F_.oncomplete=function(D0){J_(D0.target.result)}})),"exportKey"===G_&&"jwk"===P_&&(F_=F_.then(function(J_){return(c0||_0&&"SHA-1"===(_v.algorithm.hash||{}).name)&&"HMAC"===_v.algorithm.name?{kty:"oct",alg:_s(_v.algorithm),key_ops:_v.usages.slice(),ext:!0,k:g(q(J_))}:((J_=ga(J_)).alg||(J_.alg=_s(_v.algorithm)),J_.key_ops||(J_.key_ops="public"===_v.type?_v.usages.filter(p_):"private"===_v.type?_v.usages.filter(I_):_v.usages.slice()),J_)})),!c0||"exportKey"!==G_||"spki"!==P_&&"pkcs8"!==P_||(F_=F_.then(function(J_){var Y_=[["",null]],D0=!1;if("RSA"!==(J_=ga(J_)).kty)throw new TypeError("Unsupported key type");for(var O0="n e d p q dp dq qi".split(" "),EI=[],eI=0;eI<O0.length&&O0[eI]in J_;eI++){var Y0=EI[eI]=k(f(J_[O0[eI]]));128&Y0[0]&&(EI[eI]=new Uint8Array(Y0.length+1),EI[eI].set(Y0,1))}return 2<EI.length&&(D0=!0,EI.unshift(new Uint8Array([0]))),Y_[0][0]="1.2.840.113549.1.1.1",Y_.push(new Uint8Array(_A(EI)).buffer),D0?Y_.unshift(new Uint8Array([0])):Y_[1]={tag:3,value:Y_[1]},new Uint8Array(_A(Y_)).buffer})),F_}}),["encrypt","decrypt","sign","verify"].forEach(function(G_){var e0=S_[G_];S_[G_]=function(P_,_v,E_,L_){if(_0&&(!E_.byteLength||L_&&!L_.byteLength))throw Error("Empty input is not allowed");var F_=[].slice.call(arguments),J_=_r(P_);if(!_0||"sign"!==G_&&"verify"!==G_||"RSASSA-PKCS1-v1_5"!==P_&&"HMAC"!==P_||(F_[0]={name:P_}),_0&&_v.algorithm.hash&&(F_[0].hash=F_[0].hash||_v.algorithm.hash),_0&&"decrypt"===G_&&"AES-GCM"===J_.name){var Y_=P_.tagLength>>3;F_[2]=(E_.buffer||E_).slice(0,E_.byteLength-Y_),P_.tag=(E_.buffer||E_).slice(E_.byteLength-Y_)}_0&&"AES-GCM"===J_.name&&void 0===F_[0].tagLength&&(F_[0].tagLength=128),F_[1]=_v._key;try{var D0=e0.apply(S_,F_)}catch(O0){return Promise.reject(O0)}return _0&&(D0=new Promise(function(O0,EI){D0.onabort=D0.onerror=function(eI){EI(eI)},D0.oncomplete=function(eI){if(eI=eI.target.result,"encrypt"===G_&&eI instanceof AesGcmEncryptResult){var Y0=eI.ciphertext,x1=eI.tag;(eI=new Uint8Array(Y0.byteLength+x1.byteLength)).set(new Uint8Array(Y0),0),eI.set(new Uint8Array(x1),Y0.byteLength),eI=eI.buffer}O0(eI)}})),D0}}),_0){var I0=S_.digest;S_.digest=function(G_,e0){if(!e0.byteLength)throw Error("Empty input is not allowed");try{var P_=I0.call(S_,G_,e0)}catch(_v){return Promise.reject(_v)}return P_=new Promise(function(_v,E_){P_.onabort=P_.onerror=function(L_){E_(L_)},P_.oncomplete=function(L_){_v(L_.target.result)}})},l.crypto=Object.create(v_,{getRandomValues:{value:function(G_){return v_.getRandomValues(G_)}},subtle:{value:S_}}),l.CryptoKey=r_}c0&&(v_.subtle=S_,l.Crypto=x_,l.SubtleCrypto=B_,l.CryptoKey=r_)}}}},h.exports?h.exports=g(l):g(l)}),function(h){h.console||(h.console={}),h=h.console;for(var l,g=function(){},f=["memory"],k="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profiles profileEnd show table time timeEnd timeline timelineEnd timeStamp trace warn".split(" ");l=f.pop();)h[l]||(h[l]={});for(;l=k.pop();)h[l]||(h[l]=g)}("undefined"==typeof window?Ka:window),M({target:"Object",stat:!0},{setPrototypeOf:Ya});var Ky=R(function(){ac(1)});M({target:"Object",stat:!0,forced:Ky,sham:!Ro},{getPrototypeOf:function(h){return ac(Va(h))}});var kq=[].slice,vk={},Ly=Function.bind||function(h){var l=Bb(this),g=kq.call(arguments,1),f=function(){var k=g.concat(kq.call(arguments));if(this instanceof f){var q=k.length;if(!(q in vk)){for(var _r=[],_s=0;_s<q;_s++)_r[_s]="a["+_s+"]";vk[q]=Function("C,a","return new C("+_r.join(",")+")")}k=vk[q](l,k)}else k=l.apply(h,k);return k};return ha(l.prototype)&&(f.prototype=l.prototype),f},wk=Rb("Reflect","construct"),lq=R(function(){function h(){}return!(wk(function(){},[],h)instanceof h)}),mq=!R(function(){wk(function(){})}),nq=lq||mq;M({target:"Reflect",stat:!0,forced:nq,sham:nq},{construct:function(h,l){Bb(h),sa(l);var g=3>arguments.length?h:Bb(arguments[2]);if(mq&&!lq)return wk(h,l,g);if(h==g){switch(l.length){case 0:return new h;case 1:return new h(l[0]);case 2:return new h(l[0],l[1]);case 3:return new h(l[0],l[1],l[2]);case 4:return new h(l[0],l[1],l[2],l[3])}return(g=[null]).push.apply(g,l),new(Ly.apply(h,g))}g=Sb(ha(g=g.prototype)?g:Object.prototype);var f=Function.apply.call(h,g,l);return ha(f)?f:g}}),M({target:"Reflect",stat:!0},{get:ym});var oq=Jb.f,My=R(function(){oq(1)});M({target:"Object",stat:!0,forced:!fa||My,sham:!fa},{getOwnPropertyDescriptor:function(h,l){return oq(tb(h),l)}});var pq=Rd.f,Ny={}.toString,qq="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],xk=function(h){if(qq&&"[object Window]"==Ny.call(h))try{var l=pq(h)}catch(g){l=qq.slice()}else l=pq(tb(h));return l},rq={f:qa},Oy=Wa.f,Ph=function(h){var l=C.Symbol||(C.Symbol={});Q(l,h)||Oy(l,h,{value:rq.f(h)})},ub=nh("hidden"),sq=qa("toPrimitive"),Py=La.set,tq=La.getterFor("Symbol"),Tb=Object.prototype,vb=C.Symbol,kg=Rb("JSON","stringify"),uq=Jb.f,vd=Wa.f,vq=xk,Qy=Sf,Sc=ld("symbols"),lg=ld("op-symbols"),yk=ld("string-to-symbol-registry"),zk=ld("symbol-to-string-registry"),Ry=ld("wks"),Ak=C.QObject,Bk=!Ak||!Ak.prototype||!Ak.prototype.findChild,Ck=fa&&R(function(){return 7!=Sb(vd({},"a",{get:function(){return vd(this,"a",{value:7}).a}})).a})?function(h,l,g){var f=uq(Tb,l);f&&delete Tb[l],vd(h,l,g),f&&h!==Tb&&vd(Tb,l,f)}:vd,Dk=function(h,l){var g=Sc[h]=Sb(vb.prototype);return Py(g,{type:"Symbol",tag:h,description:l}),fa||(g.description=l),g},Ek=Bo?function(h){return"symbol"==typeof h}:function(h){return Object(h)instanceof vb},Qh=function(h,l,g){return h===Tb&&Qh(lg,l,g),sa(h),l=tc(l,!0),sa(g),Q(Sc,l)?(g.enumerable?(Q(h,ub)&&h[ub][l]&&(h[ub][l]=!1),g=Sb(g,{enumerable:sc(0,!1)})):(Q(h,ub)||vd(h,ub,sc(1,{})),h[ub][l]=!0),Ck(h,l,g)):vd(h,l,g)},wq=function(h,l){sa(h);var g=tb(l);return l=Mc(g).concat(Fk(g)),Sd(l,function(f){fa&&!Gk.call(g,f)||Qh(h,f,g[f])}),h},Gk=function(h){h=tc(h,!0);var l=Qy.call(this,h);return!(this===Tb&&Q(Sc,h)&&!Q(lg,h))&&(!(l||!Q(this,h)||!Q(Sc,h)||Q(this,ub)&&this[ub][h])||l)},xq=function(h,l){if(h=tb(h),l=tc(l,!0),h!==Tb||!Q(Sc,l)||Q(lg,l)){var g=uq(h,l);return!g||!Q(Sc,l)||Q(h,ub)&&h[ub][l]||(g.enumerable=!0),g}},yq=function(h){h=vq(tb(h));var l=[];return Sd(h,function(g){Q(Sc,g)||Q(Pe,g)||l.push(g)}),l},Fk=function(h){var l=h===Tb;h=vq(l?lg:tb(h));var g=[];return Sd(h,function(f){!Q(Sc,f)||l&&!Q(Tb,f)||g.push(Sc[f])}),g};if(wc||(vb=function(){if(this instanceof vb)throw TypeError("Symbol is not a constructor");var h=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,l=Oe(h),g=function(f){this===Tb&&g.call(lg,f),Q(this,ub)&&Q(this[ub],l)&&(this[ub][l]=!1),Ck(this,l,sc(1,f))};return fa&&Bk&&Ck(Tb,l,{configurable:!0,set:g}),Dk(l,h)},Ea(vb.prototype,"toString",function(){return tq(this).tag}),Ea(vb,"withoutSetter",function(h){return Dk(Oe(h),h)}),Sf=Gk,Wa.f=Qh,Jb.f=xq,Rd.f=xk=yq,Uf.f=Fk,rq.f=function(h){return Dk(qa(h),h)},fa&&(vd(vb.prototype,"description",{configurable:!0,get:function(){return tq(this).description}}),Ea(Tb,"propertyIsEnumerable",Gk,{unsafe:!0}))),M({global:!0,wrap:!0,forced:!wc,sham:!wc},{Symbol:vb}),Sd(Mc(Ry),function(h){Ph(h)}),M({target:"Symbol",stat:!0,forced:!wc},{for:function(h){if(h=String(h),Q(yk,h))return yk[h];var l=vb(h);return yk[h]=l,zk[l]=h,l},keyFor:function(h){if(!Ek(h))throw TypeError(h+" is not a symbol");if(Q(zk,h))return zk[h]},useSetter:function(){Bk=!0},useSimple:function(){Bk=!1}}),M({target:"Object",stat:!0,forced:!wc,sham:!fa},{create:function(h,l){return void 0===l?Sb(h):wq(Sb(h),l)},defineProperty:Qh,defineProperties:wq,getOwnPropertyDescriptor:xq}),M({target:"Object",stat:!0,forced:!wc},{getOwnPropertyNames:yq,getOwnPropertySymbols:Fk}),M({target:"Object",stat:!0,forced:R(function(){Uf.f(1)})},{getOwnPropertySymbols:function(h){return Uf.f(Va(h))}}),kg){var Sy=!wc||R(function(){var h=vb();return"[null]"!=kg([h])||"{}"!=kg({a:h})||"{}"!=kg(Object(h))});M({target:"JSON",stat:!0,forced:Sy},{stringify:function(h,l,g){for(var f,k=[h],q=1;arguments.length>q;)k.push(arguments[q++]);if(f=l,(ha(l)||void 0!==h)&&!Ek(h))return qd(l)||(l=function(_r,_s){if("function"==typeof f&&(_s=f.call(this,_r,_s)),!Ek(_s))return _s}),k[1]=l,kg.apply(null,k)}})}vb.prototype[sq]||Sa(vb.prototype,sq,vb.prototype.valueOf),gc(vb,"Symbol"),Pe[ub]=!0;var Ty=Wa.f,Tc=C.Symbol;if(fa&&"function"==typeof Tc&&(!("description"in Tc.prototype)||void 0!==Tc().description)){var zq={},mg=function(){var h=1>arguments.length||void 0===arguments[0]?void 0:String(arguments[0]),l=this instanceof mg?new Tc(h):void 0===h?Tc():Tc(h);return""===h&&(zq[l]=!0),l};vo(mg,Tc);var Hk=mg.prototype=Tc.prototype;Hk.constructor=mg;var Uy=Hk.toString,Vy="Symbol(test)"==String(Tc("test")),Wy=/^Symbol\((.*)\)[^)]+$/;Ty(Hk,"description",{configurable:!0,get:function(){var h=ha(this)?this.valueOf():this,l=Uy.call(h);return Q(zq,h)?"":""===(h=Vy?l.slice(7,-1):l.replace(Wy,"$1"))?void 0:h}}),M({global:!0,forced:!0},{Symbol:mg})}Ph("toStringTag"),gc(C.JSON,"JSON",!0),gc(Math,"Math",!0),function(){function h(_A,r_){if(!(_A instanceof r_))throw new TypeError("Cannot call a class as a function")}function l(_A,r_){for(var p_=0;p_<r_.length;p_++){var I_=r_[p_];I_.enumerable=I_.enumerable||!1,I_.configurable=!0,"value"in I_&&(I_.writable=!0),Object.defineProperty(_A,I_.key,I_)}}function g(_A,r_,p_){return r_&&l(_A.prototype,r_),p_&&l(_A,p_),_A}function f(_A,r_){if("function"!=typeof r_&&null!==r_)throw new TypeError("Super expression must either be null or a function");_A.prototype=Object.create(r_&&r_.prototype,{constructor:{value:_A,writable:!0,configurable:!0}}),r_&&q(_A,r_)}function k(_A){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(r_){return r_.__proto__||Object.getPrototypeOf(r_)})(_A)}function q(_A,r_){return(q=Object.setPrototypeOf||function(p_,I_){return p_.__proto__=I_,p_})(_A,r_)}function _r(_A){if(void 0===_A)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _A}function ga(_A,r_,p_){return(ga="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(I_,v_,S_){for(;!Object.prototype.hasOwnProperty.call(I_,v_)&&null!==(I_=k(I_)););if(I_)return(v_=Object.getOwnPropertyDescriptor(I_,v_)).get?v_.get.call(S_):v_.value})(_A,r_,p_||_A)}var _l=function(){function _A(){h(this,_A),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return g(_A,[{key:"addEventListener",value:function(r_,p_,I_){r_ in this.listeners||(this.listeners[r_]=[]),this.listeners[r_].push({callback:p_,options:I_})}},{key:"removeEventListener",value:function(r_,p_){if(r_ in this.listeners)for(var I_=0,v_=(r_=this.listeners[r_]).length;I_<v_;I_++)if(r_[I_].callback===p_){r_.splice(I_,1);break}}},{key:"dispatchEvent",value:function(r_){if(r_.type in this.listeners){for(var p_=this.listeners[r_.type].slice(),I_=0,v_=p_.length;I_<v_;I_++){var S_=p_[I_];try{S_.callback.call(this,r_)}catch(x_){Promise.resolve().then(function(){throw x_})}S_.options&&S_.options.once&&this.removeEventListener(r_.type,S_.callback)}return!r_.defaultPrevented}}}]),_A}(),bh=function(_A){function r_(){h(this,r_);var I_=p_.call(this);return I_.listeners||_l.call(_r(I_)),Object.defineProperty(_r(I_),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(_r(I_),"onabort",{value:null,writable:!0,configurable:!0}),I_}f(r_,_A);var p_=function _s(_A){var r_=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(p_){return!1}}();return function(){var p_=k(_A);if(r_){var I_=k(this).constructor;p_=Reflect.construct(p_,arguments,I_)}else p_=p_.apply(this,arguments);return!p_||"object"!==V(p_)&&"function"!=typeof p_?_r(this):p_}}(r_);return g(r_,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(I_){"abort"===I_.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,I_)),ga(k(r_.prototype),"dispatchEvent",this).call(this,I_)}}]),r_}(_l),n_=function(){function _A(){h(this,_A),Object.defineProperty(this,"signal",{value:new bh,writable:!0,configurable:!0})}return g(_A,[{key:"abort",value:function(){try{var r_=new Event("abort")}catch(p_){"undefined"!=typeof document?document.createEvent?(r_=document.createEvent("Event")).initEvent("abort",!1,!1):(r_=document.createEventObject()).type="abort":r_={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(r_)}},{key:"toString",value:function(){return"[object AbortController]"}}]),_A}();"undefined"!=typeof Symbol&&Symbol.toStringTag&&(n_.prototype[Symbol.toStringTag]="AbortController",bh.prototype[Symbol.toStringTag]="AbortSignal"),function(_A){if(_A.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL){console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill");var r_=!0}else r_="function"==typeof _A.Request&&!_A.Request.prototype.hasOwnProperty("signal")||!_A.AbortController;r_&&(_A.AbortController=n_,_A.AbortSignal=bh)}("undefined"!=typeof self?self:Ka)}();var Xy=Math.floor,Yy=Math.log,Zy=Math.LOG2E;M({target:"Math",stat:!0},{clz32:function(h){return(h>>>=0)?31-Xy(Yy(h+.5)*Zy):32}});var $y=Math.log,az=Math.LN2,mu=Math.clz32||function(h){return 31-$y(h>>>0)/az|0},Gd=String.fromCharCode,Aq={}.toString,Ik=window.Uint8Array,Jk=Ik||Array,bz=Aq.call((window.ArrayBuffer||Jk).prototype),Kk,h,l,g,f,k,q,_r,_s,ga,_l,bh,n_,_A;zm.prototype.decode=function(h){if(Aq.call(h=h&&h.buffer||h)!==bz)throw Error("Failed to execute 'decode' on 'TextDecoder': The provided value is not of type '(ArrayBuffer or ArrayBufferView)'");for(var l="",g=0,f=0|(h=Ik?new Jk(h):h).length;g<f;g=g+32768|0)l+=Gd.apply(0,h[Ik?"slice":"subarray"](g,g+32768|0));return l.replace(/[\xc0-\xff][\x80-\xbf]*/g,lu)},window.TextDecoder||(window.TextDecoder=zm),Am.prototype.encode=function(h){for(var l=0|(h=void 0===h?"":(""+h).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,nu)).length,g=new Jk(l),f=0;f<l;f=f+1|0)g[f]=h.charCodeAt(f);return g},window.TextEncoder||(window.TextEncoder=Am),h=Kk||(Kk={}),(_A=l||(l={})).LOGIN="LOGIN",_A.LOGIN_SUCCESS="LOGIN_SUCCESS",_A.LOGIN_FAILURE="LOGIN_FAILURE",_A.LOGIN_TIMEOUT="LOGIN_TIMEOUT",_A.INTERRUPTED="INTERRUPTED",_A.LOGOUT="LOGOUT",_A.BANNED_BY_SERVER="BANNED_BY_SERVER",_A.REMOTE_LOGIN="REMOTE_LOGIN",h.ConnectionChangeReason=l,function(_A){_A.DISCONNECTED="DISCONNECTED",_A.CONNECTING="CONNECTING",_A.CONNECTED="CONNECTED",_A.RECONNECTING="RECONNECTING",_A.ABORTED="ABORTED"}(g||(g={})),h.ConnectionState=g,function(_A){_A.IDLE="IDLE",_A.SENT_TO_REMOTE="SENT_TO_REMOTE",_A.RECEIVED_BY_REMOTE="RECEIVED_BY_REMOTE",_A.ACCEPTED_BY_REMOTE="ACCEPTED_BY_REMOTE",_A.REFUSED_BY_REMOTE="REFUSED_BY_REMOTE",_A.CANCELED="CANCELED",_A.FAILURE="FAILURE"}(f||(f={})),h.LocalInvitationState=f,function(_A){_A.INVITATION_RECEIVED="INVITATION_RECEIVED",_A.ACCEPT_SENT_TO_LOCAL="ACCEPT_SENT_TO_LOCAL",_A.REFUSED="REFUSED",_A.ACCEPTED="ACCEPTED",_A.CANCELED="CANCELED",_A.FAILURE="FAILURE"}(k||(k={})),h.RemoteInvitationState=k,function(_A){_A.UNKNOWN="UNKNOWN",_A.PEER_NO_RESPONSE="PEER_NO_RESPONSE",_A.INVITATION_EXPIRE="INVITATION_EXPIRE",_A.PEER_OFFLINE="PEER_OFFLINE",_A.NOT_LOGGEDIN="NOT_LOGGEDIN"}(q||(q={})),h.LocalInvitationFailureReason=q,function(_A){_A.UNKNOWN="UNKNOWN",_A.PEER_OFFLINE="PEER_OFFLINE",_A.ACCEPT_FAILURE="ACCEPT_FAILURE",_A.INVITATION_EXPIRE="INVITATION_EXPIRE"}(_r||(_r={})),h.RemoteInvitationFailureReason=_r,function(_A){_A.ONLINE="ONLINE",_A.UNREACHABLE="UNREACHABLE",_A.OFFLINE="OFFLINE"}(_s||(_s={})),h.PeerOnlineState=_s,(ga||(ga={})).ONLINE_STATUS="ONLINE_STATUS",h.PeerSubscriptionOption=ga,function(_A){_A.TEXT="TEXT",_A.RAW="RAW",_A.IMAGE="IMAGE",_A.FILE="FILE"}(_l||(_l={})),h.MessageType=_l,function(_A){_A.CN="CN",_A.NA="NA",_A.EU="EU",_A.AS="AS",_A.JP="JP",_A.IN="IN",_A.GLOB="GLOB",_A.OC="OC",_A.SA="SA",_A.AF="AF",_A.OVS="OVS"}(bh||(bh={})),h.LegacyAreaCode=bh,function(_A){_A.GLOBAL="GLOBAL",_A.INDIA="INDIA",_A.JAPAN="JAPAN",_A.ASIA="ASIA",_A.EUROPE="EUROPE",_A.CHINA="CHINA",_A.NORTH_AMERICA="NORTH_AMERICA"}(n_||(n_={})),h.AreaCode=n_;var S=Kk;M({target:"Array",proto:!0},{includes:function(h){return so(this,h,1<arguments.length?arguments[1]:void 0)}}),Vd("includes");var Lk=function(h){if(Fj(h))throw TypeError("The method doesn't accept regular expressions");return h},cz=qa("match"),Mk=function(h){var l=/./;try{"/./"[h](l)}catch(g){try{return l[cz]=!1,"/./"[h](l)}catch(f){}}return!1};M({target:"String",proto:!0,forced:!Mk("includes")},{includes:function(h){return!!~String(mb(this)).indexOf(Lk(h),1<arguments.length?arguments[1]:void 0)}});var lc={RECONNECTING_AP_INTERVAL:2500,RECONNECTING_AP_NUM:2,DISABLE_MESSAGE_COMPRESSION:!1,LOG_UPLOAD_INTERVAL:3e3,LOG_HANDLER:void 0,ENABLE_EDGE_AUTO_FALLBACK:!0};Ph("iterator"),Ph("asyncIterator");var Nk=Te("forEach")?[].forEach:function(h){return Sd(this,h,1<arguments.length?arguments[1]:void 0)},Bq;for(Bq in sk){var Cq=C[Bq],Rh=Cq&&Cq.prototype;if(Rh&&Rh.forEach!==Nk)try{Sa(Rh,"forEach",Nk)}catch(h){Rh.forEach=Nk}}var dz=[].reverse,Dq=[1,2];M({target:"Array",proto:!0,forced:String(Dq)===String(Dq.reverse())},{reverse:function(){return qd(this)&&(this.length=this.length),dz.call(this)}});var x=cb(function(h){h=function(l){function g(E_,L_,F_){return Object.defineProperty(E_,L_,{value:F_,enumerable:!0,configurable:!0,writable:!0}),E_[L_]}function f(E_,L_,F_,J_){return L_=Object.create((L_&&L_.prototype instanceof q?L_:q).prototype),J_=new r_(J_||[]),L_._invoke=(Y_=E_,D0=F_,O0=J_,EI=Pv,function(eI,Y0){if(EI===I0)throw Error("Generator is already running");if(EI===G_){if("throw"===eI)throw Y0;return I_()}for(O0.method=eI,O0.arg=Y0;;){if((eI=O0.delegate)&&(eI=bh(eI,O0))){if(eI===e0)continue;return eI}if("next"===O0.method)O0.sent=O0._sent=O0.arg;else if("throw"===O0.method){if(EI===Pv)throw EI=G_,O0.arg;O0.dispatchException(O0.arg)}else"return"===O0.method&&O0.abrupt("return",O0.arg);if(EI=I0,"normal"===(eI=k(Y_,D0,O0)).type){if(EI=O0.done?G_:h0,eI.arg===e0)continue;return{value:eI.arg,done:O0.done}}"throw"===eI.type&&(EI=G_,O0.method="throw",O0.arg=eI.arg)}}),L_;var Y_,D0,O0,EI}function k(E_,L_,F_){try{return{type:"normal",arg:E_.call(L_,F_)}}catch(J_){return{type:"throw",arg:J_}}}function q(){}function _r(){}function _s(){}function ga(E_){["next","throw","return"].forEach(function(L_){g(E_,L_,function(F_){return this._invoke(L_,F_)})})}function _l(E_,L_){function F_(Y_,D0,O0,EI){if("throw"!==(Y_=k(E_[Y_],E_,D0)).type){var eI=Y_.arg;return(Y_=eI.value)&&"object"===V(Y_)&&x_.call(Y_,"__await")?L_.resolve(Y_.__await).then(function(Y0){F_("next",Y0,O0,EI)},function(Y0){F_("throw",Y0,O0,EI)}):L_.resolve(Y_).then(function(Y0){eI.value=Y0,O0(eI)},function(Y0){return F_("throw",Y0,O0,EI)})}EI(Y_.arg)}var J_;this._invoke=function(Y_,D0){function O0(){return new L_(function(EI,eI){F_(Y_,D0,EI,eI)})}return J_=J_?J_.then(O0,O0):O0()}}function bh(E_,L_){var F_=E_.iterator[L_.method];if(F_===v_){if(L_.delegate=null,"throw"===L_.method){if(E_.iterator.return&&(L_.method="return",L_.arg=v_,bh(E_,L_),"throw"===L_.method))return e0;L_.method="throw",L_.arg=new TypeError("The iterator does not provide a 'throw' method")}return e0}return"throw"===(F_=k(F_,E_.iterator,L_.arg)).type?(L_.method="throw",L_.arg=F_.arg,L_.delegate=null,e0):(F_=F_.arg)?F_.done?(L_[E_.resultName]=F_.value,L_.next=E_.nextLoc,"return"!==L_.method&&(L_.method="next",L_.arg=v_),L_.delegate=null,e0):F_:(L_.method="throw",L_.arg=new TypeError("iterator result is not an object"),L_.delegate=null,e0)}function n_(E_){var L_={tryLoc:E_[0]};1 in E_&&(L_.catchLoc=E_[1]),2 in E_&&(L_.finallyLoc=E_[2],L_.afterLoc=E_[3]),this.tryEntries.push(L_)}function _A(E_){var L_=E_.completion||{};L_.type="normal",delete L_.arg,E_.completion=L_}function r_(E_){this.tryEntries=[{tryLoc:"root"}],E_.forEach(n_,this),this.reset(!0)}function p_(E_){if(E_){var L_=E_[V_];if(L_)return L_.call(E_);if("function"==typeof E_.next)return E_;if(!isNaN(E_.length)){var F_=-1;return(L_=function J_(){for(;++F_<E_.length;)if(x_.call(E_,F_))return J_.value=E_[F_],J_.done=!1,J_;return J_.value=v_,J_.done=!0,J_}).next=L_}}return{next:I_}}function I_(){return{value:v_,done:!0}}var v_,S_=Object.prototype,x_=S_.hasOwnProperty,B_="function"==typeof Symbol?Symbol:{},V_=B_.iterator||"@@iterator",_0=B_.asyncIterator||"@@asyncIterator",c0=B_.toStringTag||"@@toStringTag";try{g({},"")}catch(E_){g=function(L_,F_,J_){return L_[F_]=J_}}l.wrap=f;var Pv="suspendedStart",h0="suspendedYield",I0="executing",G_="completed",e0={};g(B_={},V_,function(){return this});var P_=Object.getPrototypeOf;(P_=P_&&P_(P_(p_([]))))&&P_!==S_&&x_.call(P_,V_)&&(B_=P_);var _v=_s.prototype=q.prototype=Object.create(B_);return _r.prototype=_s,g(_v,"constructor",_s),g(_s,"constructor",_r),_r.displayName=g(_s,c0,"GeneratorFunction"),l.isGeneratorFunction=function(E_){return!!(E_="function"==typeof E_&&E_.constructor)&&(E_===_r||"GeneratorFunction"===(E_.displayName||E_.name))},l.mark=function(E_){return Object.setPrototypeOf?Object.setPrototypeOf(E_,_s):(E_.__proto__=_s,g(E_,c0,"GeneratorFunction")),E_.prototype=Object.create(_v),E_},l.awrap=function(E_){return{__await:E_}},ga(_l.prototype),g(_l.prototype,_0,function(){return this}),l.AsyncIterator=_l,l.async=function(E_,L_,F_,J_,Y_){void 0===Y_&&(Y_=Promise);var D0=new _l(f(E_,L_,F_,J_),Y_);return l.isGeneratorFunction(L_)?D0:D0.next().then(function(O0){return O0.done?O0.value:D0.next()})},ga(_v),g(_v,c0,"Generator"),g(_v,V_,function(){return this}),g(_v,"toString",function(){return"[object Generator]"}),l.keys=function(E_){var L_,F_=[];for(L_ in E_)F_.push(L_);return F_.reverse(),function J_(){for(;F_.length;){var Y_=F_.pop();if(Y_ in E_)return J_.value=Y_,J_.done=!1,J_}return J_.done=!0,J_}},l.values=p_,r_.prototype={constructor:r_,reset:function(E_){if(this.next=this.prev=0,this.sent=this._sent=v_,this.done=!1,this.delegate=null,this.method="next",this.arg=v_,this.tryEntries.forEach(_A),!E_)for(var L_ in this)"t"===L_.charAt(0)&&x_.call(this,L_)&&!isNaN(+L_.slice(1))&&(this[L_]=v_)},stop:function(){this.done=!0;var E_=this.tryEntries[0].completion;if("throw"===E_.type)throw E_.arg;return this.rval},dispatchException:function(E_){function L_(eI,Y0){return D0.type="throw",D0.arg=E_,F_.next=eI,Y0&&(F_.method="next",F_.arg=v_),!!Y0}if(this.done)throw E_;for(var F_=this,J_=this.tryEntries.length-1;0<=J_;--J_){var Y_=this.tryEntries[J_],D0=Y_.completion;if("root"===Y_.tryLoc)return L_("end");if(Y_.tryLoc<=this.prev){var O0=x_.call(Y_,"catchLoc"),EI=x_.call(Y_,"finallyLoc");if(O0&&EI){if(this.prev<Y_.catchLoc)return L_(Y_.catchLoc,!0);if(this.prev<Y_.finallyLoc)return L_(Y_.finallyLoc)}else if(O0){if(this.prev<Y_.catchLoc)return L_(Y_.catchLoc,!0)}else{if(!EI)throw Error("try statement without catch or finally");if(this.prev<Y_.finallyLoc)return L_(Y_.finallyLoc)}}}},abrupt:function(E_,L_){for(var F_=this.tryEntries.length-1;0<=F_;--F_){var J_=this.tryEntries[F_];if(J_.tryLoc<=this.prev&&x_.call(J_,"finallyLoc")&&this.prev<J_.finallyLoc){var Y_=J_;break}}return Y_&&("break"===E_||"continue"===E_)&&Y_.tryLoc<=L_&&L_<=Y_.finallyLoc&&(Y_=null),(F_=Y_?Y_.completion:{}).type=E_,F_.arg=L_,Y_?(this.method="next",this.next=Y_.finallyLoc,e0):this.complete(F_)},complete:function(E_,L_){if("throw"===E_.type)throw E_.arg;return"break"===E_.type||"continue"===E_.type?this.next=E_.arg:"return"===E_.type?(this.rval=this.arg=E_.arg,this.method="return",this.next="end"):"normal"===E_.type&&L_&&(this.next=L_),e0},finish:function(E_){for(var L_=this.tryEntries.length-1;0<=L_;--L_){var F_=this.tryEntries[L_];if(F_.finallyLoc===E_)return this.complete(F_.completion,F_.afterLoc),_A(F_),e0}},catch:function(E_){for(var L_=this.tryEntries.length-1;0<=L_;--L_){var F_=this.tryEntries[L_];if(F_.tryLoc===E_){if("throw"===(E_=F_.completion).type){var J_=E_.arg;_A(F_)}return J_}}throw Error("illegal catch attempt")},delegateYield:function(E_,L_,F_){return this.delegate={iterator:p_(E_),resultName:L_,nextLoc:F_},"next"===this.method&&(this.arg=v_),e0}},l}(h.exports);try{regeneratorRuntime=h}catch(l){"object"===("undefined"==typeof globalThis?"undefined":V(globalThis))?globalThis.regeneratorRuntime=h:Function("r","regeneratorRuntime = r")(h)}}),Eq=!R(function(){return Object.isExtensible(Object.preventExtensions({}))}),Ok=cb(function(h){var l=Wa.f,g=Oe("meta"),f=0,k=Object.isExtensible||function(){return!0},q=function(_s){l(_s,g,{value:{objectID:"O"+ ++f,weakData:{}}})},_r=h.exports={REQUIRED:!1,fastKey:function(_s,ga){if(!ha(_s))return"symbol"==typeof _s?_s:("string"==typeof _s?"S":"P")+_s;if(!Q(_s,g)){if(!k(_s))return"F";if(!ga)return"E";q(_s)}return _s[g].objectID},getWeakData:function(_s,ga){if(!Q(_s,g)){if(!k(_s))return!0;if(!ga)return!1;q(_s)}return _s[g].weakData},onFreeze:function(_s){return Eq&&_r.REQUIRED&&k(_s)&&!Q(_s,g)&&q(_s),_s}};Pe[g]=!0}),Fq=function(h,l,g){var f=-1!==h.indexOf("Map"),k=-1!==h.indexOf("Weak"),q=f?"set":"add",_r=C[h],_s=_r&&_r.prototype,ga=_r,_l={},bh=function(v_){var S_=_s[v_];Ea(_s,v_,"add"==v_?function(x_){return S_.call(this,0===x_?0:x_),this}:"delete"==v_?function(x_){return!(k&&!ha(x_))&&S_.call(this,0===x_?0:x_)}:"get"==v_?function(x_){return k&&!ha(x_)?void 0:S_.call(this,0===x_?0:x_)}:"has"==v_?function(x_){return!(k&&!ha(x_))&&S_.call(this,0===x_?0:x_)}:function(x_,B_){return S_.call(this,0===x_?0:x_,B_),this})};if(uc(h,"function"!=typeof _r||!(k||_s.forEach&&!R(function(){(new _r).entries().next()}))))ga=g.getConstructor(l,h,f,q),Ok.REQUIRED=!0;else if(uc(h,!0)){var n_=new ga,_A=n_[q](k?{}:-0,1)!=n_,r_=R(function(){n_.has(1)}),p_=uh(function(v_){new _r(v_)}),I_=!k&&R(function(){for(var v_=new _r,S_=5;S_--;)v_[q](S_,S_);return!v_.has(-0)});p_||((ga=l(function(v_,S_){return hc(v_,ga,h),v_=Lh(new _r,v_,ga),null!=S_&&yh(S_,v_[q],{that:v_,AS_ENTRIES:f}),v_})).prototype=_s,_s.constructor=ga),(r_||I_)&&(bh("delete"),bh("has"),f&&bh("get")),(I_||_A)&&bh(q),k&&_s.clear&&delete _s.clear}return _l[h]=ga,M({global:!0,forced:ga!=_r},_l),gc(ga,h),k||g.setStrong(ga,h,f),ga},ez=Wa.f,Gq=Ok.fastKey,Hq=La.set,Pk=La.getterFor,Iq={getConstructor:function(h,l,g,f){var k=h(function(ga,_l){hc(ga,k,l),Hq(ga,{type:l,index:Sb(null),first:void 0,last:void 0,size:0}),fa||(ga.size=0),null!=_l&&yh(_l,ga[f],{that:ga,AS_ENTRIES:g})}),q=Pk(l),_r=function(ga,_l,bh){var n_,_A=q(ga),r_=_s(ga,_l);return r_?r_.value=bh:(_A.last=r_={index:n_=Gq(_l,!0),key:_l,value:bh,previous:_l=_A.last,next:void 0,removed:!1},_A.first||(_A.first=r_),_l&&(_l.next=r_),fa?_A.size++:ga.size++,"F"!==n_&&(_A.index[n_]=r_)),ga},_s=function(ga,_l){ga=q(ga);var bh=Gq(_l);if("F"!==bh)return ga.index[bh];for(ga=ga.first;ga;ga=ga.next)if(ga.key==_l)return ga};return Xe(k.prototype,{clear:function(){for(var ga=q(this),_l=ga.index,bh=ga.first;bh;)bh.removed=!0,bh.previous&&(bh.previous=bh.previous.next=void 0),delete _l[bh.index],bh=bh.next;ga.first=ga.last=void 0,fa?ga.size=0:this.size=0},delete:function(ga){var _l=q(this);if(ga=_s(this,ga)){var bh=ga.next,n_=ga.previous;delete _l.index[ga.index],ga.removed=!0,n_&&(n_.next=bh),bh&&(bh.previous=n_),_l.first==ga&&(_l.first=bh),_l.last==ga&&(_l.last=n_),fa?_l.size--:this.size--}return!!ga},forEach:function(ga){for(var _l,bh=q(this),n_=pd(ga,1<arguments.length?arguments[1]:void 0,3);_l=_l?_l.next:bh.first;)for(n_(_l.value,_l.key,this);_l&&_l.removed;)_l=_l.previous},has:function(ga){return!!_s(this,ga)}}),Xe(k.prototype,g?{get:function(ga){return(ga=_s(this,ga))&&ga.value},set:function(ga,_l){return _r(this,0===ga?0:ga,_l)}}:{add:function(ga){return _r(this,ga=0===ga?0:ga,ga)}}),fa&&ez(k.prototype,"size",{get:function(){return q(this).size}}),k},setStrong:function(h,l,g){var f=l+" Iterator",k=Pk(l),q=Pk(f);Qj(h,l,function(_r,_s){Hq(this,{type:f,target:_r,state:k(_r),kind:_s,last:void 0})},function(){for(var _r=q(this),_s=_r.kind,ga=_r.last;ga&&ga.removed;)ga=ga.previous;return _r.target&&(_r.last=ga=ga?ga.next:_r.state.first)?"keys"==_s?{value:ga.key,done:!1}:"values"==_s?{value:ga.value,done:!1}:{value:[ga.key,ga.value],done:!1}:(_r.target=void 0,{value:void 0,done:!0})},g?"entries":"values",!g,!0),ag(l)}};Fq("Set",function(h){return function(){return h(this,arguments.length?arguments[0]:void 0)}},Iq);var fz=Rd.f,gz=Jb.f,hz=Wa.f,wd=C.Number,Sh=wd.prototype,iz="Number"==ec(Sb(Sh)),Jq=function(h){var l,g=tc(h,!1);if("string"==typeof g&&2<g.length)if(43===(h=(g=Ij(g)).charCodeAt(0))||45===h){if(88===(h=g.charCodeAt(2))||120===h)return NaN}else if(48===h){switch(g.charCodeAt(1)){case 66:case 98:h=2;var f=49;break;case 79:case 111:h=8,f=55;break;default:return+g}var k=(g=g.slice(2)).length;for(l=0;l<k;l++){var q=g.charCodeAt(l);if(48>q||q>f)return NaN}return parseInt(g,h)}return+g};if(uc("Number",!wd(" 0o1")||!wd("0b1")||wd("+0x1"))){for(var Zd=function(h){var l=1>arguments.length?0:h,g=this;return g instanceof Zd&&(iz?R(function(){Sh.valueOf.call(g)}):"Number"!=ec(g))?Lh(new wd(Jq(l)),g,Zd):Jq(l)},Kq=fa?fz(wd):"MAX_VALUE MIN_VALUE NaN NEGATIVE_INFINITY POSITIVE_INFINITY EPSILON isFinite isInteger isNaN isSafeInteger MAX_SAFE_INTEGER MIN_SAFE_INTEGER parseFloat parseInt isInteger fromString range".split(" "),Qk=0,Th;Kq.length>Qk;Qk++)Q(wd,Th=Kq[Qk])&&!Q(Zd,Th)&&hz(Zd,Th,gz(wd,Th));Zd.prototype=Sh,Sh.constructor=Zd,Ea(C,"Number",Zd)}var Lq=qa("isConcatSpreadable"),jz=51<=nd||!R(function(){var h=[];return h[Lq]=!1,h.concat()[0]!==h}),kz=Yf("concat");M({target:"Array",proto:!0,forced:!jz||!kz},{concat:function(h){var l,g=Va(this),f=th(g,0),k=0,q=-1;for(l=arguments.length;q<l;q++){var _r=-1===q?g:arguments[q],_s=_r;if(ha(_s)){var ga=_s[Lq];_s=void 0!==ga?!!ga:qd(_s)}else _s=!1;if(_s){if(9007199254740991<k+(ga=va(_r.length)))throw TypeError("Maximum allowed index exceeded");for(_s=0;_s<ga;_s++,k++)_s in _r&&Ve(f,k,_r[_s])}else{if(9007199254740991<=k)throw TypeError("Maximum allowed index exceeded");Ve(f,k++,_r)}}return f.length=k,f}});var Rk=Rb("Reflect","apply"),lz=Function.apply,mz=!R(function(){Rk(function(){})});M({target:"Reflect",stat:!0,forced:mz},{apply:function(h,l,g){return Bb(h),sa(g),Rk?Rk(h,l,g):lz.call(h,l,g)}}),M({target:"Reflect",stat:!0},{ownKeys:uo});var nz=xk,oz=R(function(){return!Object.getOwnPropertyNames(1)});M({target:"Object",stat:!0,forced:oz},{getOwnPropertyNames:nz});var ef="object"===("undefined"==typeof Reflect?"undefined":V(Reflect))?Reflect:null,Mq=ef&&"function"==typeof ef.apply?ef.apply:function(h,l,g){return Function.prototype.apply.call(h,l,g)},pz=ef&&"function"==typeof ef.ownKeys?ef.ownKeys:Object.getOwnPropertySymbols?function(h){return Object.getOwnPropertyNames(h).concat(Object.getOwnPropertySymbols(h))}:function(h){return Object.getOwnPropertyNames(h)},Nq=Number.isNaN||function(h){return h!=h};ia.EventEmitter=ia,ia.prototype._events=void 0,ia.prototype._eventsCount=0,ia.prototype._maxListeners=void 0;var Oq=10;Object.defineProperty(ia,"defaultMaxListeners",{enumerable:!0,get:function(){return Oq},set:function(h){if("number"!=typeof h||0>h||Nq(h))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+h+".");Oq=h}}),ia.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ia.prototype.setMaxListeners=function(h){if("number"!=typeof h||0>h||Nq(h))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+h+".");return this._maxListeners=h,this},ia.prototype.getMaxListeners=function(){return void 0===this._maxListeners?ia.defaultMaxListeners:this._maxListeners},ia.prototype.emit=function(h){for(var l=[],g=1;g<arguments.length;g++)l.push(arguments[g]);g="error"===h;var k,f=this._events;if(void 0!==f)g=g&&void 0===f.error;else if(!g)return!1;if(g)throw 0<l.length&&(k=l[0]),k instanceof Error?k:((l=Error("Unhandled error."+(k?" ("+k.message+")":""))).context=k,l);if(void 0===(g=f[h]))return!1;if("function"==typeof g)Mq(g,this,l);else for(f=Em(g,k=g.length),g=0;g<k;++g)Mq(f[g],this,l);return!0},ia.prototype.addListener=function(h,l){return Bm(this,h,l,!1)},ia.prototype.on=ia.prototype.addListener,ia.prototype.prependListener=function(h,l){return Bm(this,h,l,!0)},ia.prototype.once=function(h,l){return Kg(l),this.on(h,Cm(this,h,l)),this},ia.prototype.prependOnceListener=function(h,l){return Kg(l),this.prependListener(h,Cm(this,h,l)),this},ia.prototype.removeListener=function(h,l){var g;Kg(l);var f=this._events;if(void 0===f)return this;var k=f[h];if(void 0===k)return this;if(k===l||k.listener===l)0==--this._eventsCount?this._events=Object.create(null):(delete f[h],f.removeListener&&this.emit("removeListener",h,k.listener||l));else if("function"!=typeof k){var q=-1;for(g=k.length-1;0<=g;g--)if(k[g]===l||k[g].listener===l){var _r=k[g].listener;q=g;break}if(0>q)return this;if(0===q)k.shift();else{for(;q+1<k.length;q++)k[q]=k[q+1];k.pop()}1===k.length&&(f[h]=k[0]),void 0!==f.removeListener&&this.emit("removeListener",h,_r||l)}return this},ia.prototype.off=ia.prototype.removeListener,ia.prototype.removeAllListeners=function(h){var l=this._events;if(void 0===l)return this;if(void 0===l.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==l[h]&&(0==--this._eventsCount?this._events=Object.create(null):delete l[h]),this;if(0===arguments.length){var g=Object.keys(l);for(l=0;l<g.length;++l){var f=g[l];"removeListener"!==f&&this.removeAllListeners(f)}return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(g=l[h]))this.removeListener(h,g);else if(void 0!==g)for(l=g.length-1;0<=l;l--)this.removeListener(h,g[l]);return this},ia.prototype.listeners=function(h){return Dm(this,h,!0)},ia.prototype.rawListeners=function(h){return Dm(this,h,!1)},ia.listenerCount=function(h,l){return"function"==typeof h.listenerCount?h.listenerCount(l):Fm.call(h,l)},ia.prototype.listenerCount=Fm,ia.prototype.eventNames=function(){return 0<this._eventsCount?pz(this._events):[]},ia.once=function(h,l){return new Promise(function(g,f){function k(_r){h.removeListener(l,q),f(_r)}function q(){"function"==typeof h.removeListener&&h.removeListener("error",k),g([].slice.call(arguments))}Gm(h,l,q,{once:!0}),"error"!==l&&pu(h,k,{once:!0})})};var ff=Object.assign,Pq=Object.defineProperty,ng=!ff||R(function(){if(fa&&1!==ff({b:1},ff(Pq({},"a",{enumerable:!0,get:function(){Pq(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var h={},l={},g=Symbol();return h[g]=7,"abcdefghijklmnopqrst".split("").forEach(function(f){l[f]=f}),7!=ff({},h)[g]||"abcdefghijklmnopqrst"!=Mc(ff({},l)).join("")})?function(h,l){for(var g=Va(h),f=arguments.length,k=1,q=Uf.f,_r=Sf;f>k;)for(var _s,ga=Tf(arguments[k++]),_l=q?Mc(ga).concat(q(ga)):Mc(ga),bh=_l.length,n_=0;bh>n_;)_s=_l[n_++],(!fa||_r.call(ga,_s))&&(g[_s]=ga[_s]);return g}:ff;M({target:"Object",stat:!0,forced:Object.assign!==ng},{assign:ng}),Fq("Map",function(h){return function(){return h(this,arguments.length?arguments[0]:void 0)}},Iq);var qz=Math.log,rz=Math.LN2;M({target:"Math",stat:!0},{log2:function(h){return qz(h)/rz}});var sz=Wa.f,tz=Rd.f,uz=La.enforce,vz=qa("match"),zc=C.RegExp,Sk=zc.prototype,og=/a/g,Tk=/a/g,Uk=new zc(og)!==og;if(fa&&uc("RegExp",!Uk||vc||R(function(){return Tk[vz]=!1,zc(og)!=og||zc(Tk)==Tk||"/a/i"!=zc(og,"i")}))){for(var Uc=function(h,l){var g,f=this instanceof Uc,k=Fj(h),q=void 0===l;return!f&&k&&h.constructor===Uc&&q||(Uk?k&&!q&&(h=h.source):h instanceof Uc&&(q&&(l=Aj.call(h)),h=h.source),vc&&(g=!!l&&-1<l.indexOf("y"))&&(l=l.replace(/y/g,"")),h=Lh(Uk?new zc(h,l):zc(h,l),f?this:Sk,Uc),vc&&g&&(uz(h).sticky=!0)),h},wz=function(h){h in Uc||sz(Uc,h,{configurable:!0,get:function(){return zc[h]},set:function(l){zc[h]=l}})},Qq=tz(zc),Rq=0;Qq.length>Rq;)wz(Qq[Rq++]);Sk.constructor=Uc,Uc.prototype=Sk,Ea(C,"RegExp",Uc)}ag("RegExp"),jg("Float32",function(h){return function(l,g,f){return h(this,l,g,f)}}),jg("Float64",function(h){return function(l,g,f){return h(this,l,g,f)}}),jg("Uint32",function(h){return function(l,g,f){return h(this,l,g,f)}}),jg("Uint16",function(h){return function(l,g,f){return h(this,l,g,f)}});var Vk=function(h,l){return h===l?0:null==h?null==l?0:-1:null==l?null==h?0:1:"function"==typeof h.compare?h.compare(l):"function"==typeof l.compare?-l.compare(h):h<l?-1:h>l?1:0},Wk=[],Sq=Wk.sort,xz=R(function(){Wk.sort(void 0)}),yz=R(function(){Wk.sort(null)}),zz=Te("sort");M({target:"Array",proto:!0,forced:xz||!yz||!zz},{sort:function(h){return void 0===h?Sq.call(Va(this)):Sq.call(Va(this),Bb(h))}});var Tq=Object.getPrototypeOf({}),pg=function(h,l){var g;return h===l||(null==h?h==l:"function"===V(h.equiv)?h.equiv(l):null==l?h==l:"function"===V(l.equiv)?l.equiv(h):"string"!==V(h)&&"string"!==V(l)&&(null!=(g=Object.getPrototypeOf(h))&&g!==Tq||null!=(g=Object.getPrototypeOf(l))&&g!==Tq?"function"!==V(h)&&void 0!==h.length&&"function"!==V(l)&&void 0!==l.length?Bz(h,l):h instanceof Set&&l instanceof Set?Cz(h,l):h instanceof Map&&l instanceof Map?Dz(h,l):h instanceof Date&&l instanceof Date?h.getTime()===l.getTime():h instanceof RegExp&&l instanceof RegExp?h.toString()===l.toString():h!=h&&l!=l:Az(h,l)))},Bz=function(h,l){var g=2<arguments.length&&void 0!==arguments[2]?arguments[2]:pg,f=h.length;if(f===l.length)for(;0<=--f&&g(h[f],l[f]););return 0>f},Cz=function(h,l){var g=2<arguments.length&&void 0!==arguments[2]?arguments[2]:pg;return h.size===l.size&&g(G(h.keys()).sort(),G(l.keys()).sort())},Dz=function(h,l){var g=2<arguments.length&&void 0!==arguments[2]?arguments[2]:pg;return h.size===l.size&&g(G(h).sort(),G(l).sort())},Az=function(h,l){var g=2<arguments.length&&void 0!==arguments[2]?arguments[2]:pg;if(Object.keys(h).length!==Object.keys(l).length)return!1;for(var f in h)if(!l.hasOwnProperty(f)||!g(h[f],l[f]))return!1;return!0},Uq=function(h){var l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(g){return void 0!==g?": "+g:""};return function(g){function f(q){return X(this,f),k.call(this,h(q)+l(q))}ja(f,g);var k=ka(f);return f}(xf(Error))},Ez=Uq(function(){return"illegal argument(s)"}),Uh=function(h){throw new Ez(h)},Xk=Uq(function(){return"index out of bounds"}),Vq=1/4294967295,Fz=function(){function h(){X(this,h)}return Ia(h,[{key:"float",value:function(){var l=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return this.int()*Vq*l}},{key:"norm",value:function(){var l=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return 2*(this.int()*Vq-.5)*l}},{key:"minmax",value:function(l,g){return this.float()*(g-l)+l}}]),h}(),Yk=Math.random,Gz=new(function(h){function l(){return X(this,l),g.apply(this,arguments)}ja(l,h);var g=ka(l);return Ia(l,[{key:"int",value:function(){return 4294967296*Yk()>>>0}},{key:"float",value:function(){var f=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return Yk()*f}},{key:"norm",value:function(){var f=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return 2*(Yk()-.5)*f}}]),l}(Fz)),zi=Symbol(),Jm=function(){},Hz=Ok.onFreeze,Zk=Object.freeze,Iz=R(function(){Zk(1)});M({target:"Object",stat:!0,forced:Iz,sham:!Eq},{freeze:function(h){return Zk&&ha(h)?Zk(Hz(h)):h}});var Jz=Te("reduce"),Kz=!Oc&&79<nd&&83>nd;M({target:"Array",proto:!0,forced:!Jz||Kz},{reduce:function(h){return bq(this,h,arguments.length,1<arguments.length?arguments[1]:void 0)}});var Im=function(h){return null!=h&&"function"==typeof h.xform?h.xform():h},Lg=function(){function h(l){X(this,h),this.value=l}return Ia(h,[{key:"deref",value:function(){return this.value}}]),h}(),Ai=function(h){return h instanceof Lg?h.deref():h},ru=function(h,l){return[h,function(g){return g},l]},Lz=x.mark(function(h,l){var g,f,k,q,_s;return x.wrap(function(ga){for(;;)switch(ga.prev=ga.next){case 0:g=Im(h)(qu()),f=g[1],k=g[2],q=0;case 4:if(!(q<l.length)){ga.next=15;break}if(!((_s=k([],l[q]))instanceof Lg)){ga.next=10;break}return ga.delegateYield(Ai(f(_s.deref())),"t0",9);case 9:return ga.abrupt("return");case 10:if(!_s.length){ga.next=12;break}return ga.delegateYield(_s,"t1",12);case 12:q++,ga.next=4;break;case 15:return ga.delegateYield(Ai(f([])),"t2",16);case 16:case"end":return ga.stop()}},Lz)}),su=x.mark(Hm),tu=function(h,l){return[h[0],h[1],l]},Wq=!0;"findIndex"in[]&&Array(1).findIndex(function(){Wq=!1}),M({target:"Array",proto:!0,forced:Wq},{findIndex:function(h){return Mo(this,h,1<arguments.length?arguments[1]:void 0)}}),Vd("findIndex"),M({target:"Array",proto:!0},{fill:ik}),Vd("fill");var Mz=function(){function h(l){X(this,h),this._length=0,l&&this.into(l)}return Ia(h,[{key:"length",get:function(){return this._length}},{key:"copy",value:function(){return new h(this)}},{key:"empty",value:function(){return new h}},{key:"clear",value:function(){this.release()}},{key:"release",value:function(){for(var l,g=this.head;g;)l=g.next,delete g.value,delete g.prev,delete g.next,g=l;return delete this.head,delete this.tail,this._length=0,!0}},{key:"compare",value:function(l){var g=this._length;if(g<l._length)return-1;if(g>l._length)return 1;if(0===g)return 0;g=this.head,l=l.head;for(var f=0;g&&0==f;)f=Vk(g.value,l.value),g=g.next,l=l.next;return f}},{key:"equiv",value:function(l){if(!(l instanceof h||null!=l&&"function"!=typeof l&&void 0!==l.length)||this._length!==l.length)return!1;if(!this._length||this===l)return!0;for(var g=this.head,f=0;f<l.length;f++){if(!pg(g.value,l[f]))return!1;g=g.next}return!0}},{key:Symbol.iterator,value:x.mark(function l(){var g;return x.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:g=this.head;case 1:if(!g){f.next=7;break}return f.next=4,g.value;case 4:g=g.next,f.next=1;break;case 7:case"end":return f.stop()}},l,this)})},{key:"seq",value:function(){var l=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,g=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.length;if(!(l>=g||0>l)){l=this.nthCell(l);var f=this.nthCell(g-1);return g=function k(q){return{first:function(){return q.value},next:function(){return q!==f&&q.next?k(q.next):void 0}}},l?g(l):void 0}}},{key:"cycle",value:x.mark(function l(){return x.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.delegateYield(this,"t0",2);case 2:g.next=0;break;case 4:case"end":return g.stop()}},l,this)})},{key:"$reduce",value:function(l,g){for(var f=this.head;f&&!(g instanceof Lg);)g=l(g,f.value),f=f.next;return g}},{key:"drop",value:function(){var l=this.head;if(l)return(this.head=l.next)?delete this.head.prev:delete this.tail,this._length--,l.value}},{key:"cons",value:function(l){return l={value:l,next:this.head},this.head?this.head.prev=l:this.tail=l,this.head=l,this._length++,this}},{key:"insertBefore",value:function(l,g){return l||Uh("cell is undefined"),g={value:g,next:l,prev:l.prev},l.prev?l.prev.next=g:this.head=g,l.prev=g,this._length++,this}},{key:"insertAfter",value:function(l,g){return l||Uh("cell is undefined"),g={value:g,next:l.next,prev:l},l.next?l.next.prev=g:this.tail=g,l.next=g,this._length++,this}},{key:"insertBeforeNth",value:function(l,g){if(0>l&&(l+=this._length),0>=l)return this.cons(g);if(0>l||l>=this._length)throw new Xk(l);return this.insertBefore(this.nthCellUnsafe(l),g)}},{key:"insertAfterNth",value:function(l,g){if(0>l&&(l+=this._length),l>=this._length-1)return this.push(g);if(0>l||l>=this._length)throw new Xk(l);return this.insertAfter(this.nthCellUnsafe(l),g)}},{key:"insertSorted",value:function(l,g){g=g||Vk;for(var f=this.head;f;){if(0>=g(l,f.value))return this.insertBefore(f,l);f=f.next}return this.push(l)}},{key:"find",value:function(l){for(var g=this.head;g;){if(g.value===l)return g;g=g.next}}},{key:"findWith",value:function(l){for(var g=this.head;g;){if(l(g.value))return g;g=g.next}}},{key:"concat",value:function(){for(var l=this.copy(),g=arguments.length,f=Array(g),k=0;k<g;k++)f[k]=arguments[k];for(g=0;g<f.length;g++)l.into(f[g]);return l}},{key:"into",value:function(l){for(var g=0;g<l.length;g++)this.push(l[g])}},{key:"slice",value:function(){var l=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,g=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.length;g=0>g?g+this._length:g,(0>(l=0>l?l+this._length:l)||0>g)&&Uh("invalid indices: ${from} / ${to}");for(var f=new h,k=this.nthCell(l);k&&++l<=g;)f.push(k.value),k=k.next;return f}},{key:"splice",value:function(l){var g=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,f=2<arguments.length?arguments[2]:void 0;if("number"==typeof l){if(0>l&&(l+=this._length),0>l||l>=this._length)throw new Xk(l);var k=this.nthCellUnsafe(l)}else k=l;var q=new h;if(0<g)for(;k&&0<g--;)this.remove(k),q.push(k.value),k=k.next;else k&&(k=k.next);if(f)if(k)for(g=0;g<f.length;g++)this.insertBefore(k,f[g]);else for(k=0;k<f.length;k++)this.push(f[k]);return q}},{key:"remove",value:function(l){return l.prev?l.prev.next=l.next:this.head=l.next,l.next?l.next.prev=l.prev:this.tail=l.prev,this._length--,this}},{key:"swap",value:function(l,g){if(l!==g){var f=l.value;l.value=g.value,g.value=f}return this}},{key:"push",value:function(l){return this.tail?(this.tail=this.tail.next=l={value:l,prev:this.tail},this._length++,this):this.cons(l)}},{key:"pop",value:function(){var l=this.tail;if(l)return(this.tail=l.prev)?delete this.tail.next:delete this.head,this._length--,l.value}},{key:"first",value:function(){return this.head&&this.head.value}},{key:"peek",value:function(){return this.tail&&this.tail.value}},{key:"setHead",value:function(l){return this.head?(this.head.value=l,this):this.cons(l)}},{key:"setTail",value:function(l){return this.tail?(this.tail.value=l,this):this.push(l)}},{key:"setNth",value:function(l,g){var f=this.nthCell(l);return!f&&Uh("index out of bounds: ".concat(l)),f.value=g,this}},{key:"nth",value:function(l,g){return(l=this.nthCell(l))?l.value:g}},{key:"nthCell",value:function(l){if(0>l&&(l+=this._length),!(0>l||l>=this._length))return this.nthCellUnsafe(l)}},{key:"rotateLeft",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:return this.push(this.drop())}}},{key:"rotateRight",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:var l=this.peek();return this.pop(),this.cons(l)}}},{key:"map",value:function(l){for(var g=new h,f=this.head;f;)g.push(l(f.value)),f=f.next;return g}},{key:"filter",value:function(l){for(var g=new h,f=this.head;f;)l(f.value)&&g.push(f.value),f=f.next;return g}},{key:"reduce",value:function(l,g){for(var f=this.head;f;)g=l(g,f.value),f=f.next;return g}},{key:"shuffle",value:function(l){var g=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Gz;if(2>this._length)return this;for(l=null!=l?l:Math.ceil(1.5*Math.log2(this._length));0<l;l--)for(var f=this.head;f;){var k=f.next;.5>g.float()?this.asHead(f):this.asTail(f),f=k}return this}},{key:"sort",value:function(){var l=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Vk;if(!this._length)return this;for(var g=1;;){var f=this.head;this.tail=this.head=void 0;for(var k=0;f;){k++;for(var q=f,_r=0,_s=0;_s<g&&(_r++,q=q.next);_s++);for(_s=g;0<_r||0<_s&&q;){if(0===_r){var ga=q;q=q.next,_s--}else q&&0!==_s?0>=l(f.value,q.value)?(ga=f,f=f.next,_r--):(ga=q,q=q.next,_s--):(ga=f,f=f.next,_r--);this.tail?this.tail.next=ga:this.head=ga,ga.prev=this.tail,this.tail=ga}f=q}if(this.tail.next=void 0,1>=k)return this;g*=2}}},{key:"reverse",value:function(){for(var l=this.head,g=this.tail,f=(this._length>>>1)+(1&this._length);l&&g&&0<f;){var k=l.value;l.value=g.value,g.value=k,l=l.next,g=g.prev,f--}return this}},{key:"asHead",value:function(l){return l===this.head||(this.remove(l),this.head.prev=l,l.next=this.head,l.prev=void 0,this.head=l,this._length++),this}},{key:"asTail",value:function(l){return l===this.tail||(this.remove(l),this.tail.next=l,l.prev=this.tail,l.next=void 0,this.tail=l,this._length++),this}},{key:"toString",value:function(){for(var l=[],g=this.head;g;)l.push(String(g.value)),g=g.next;return l.join(", ")}},{key:"toJSON",value:function(){return G(this)}},{key:"nthCellUnsafe",value:function(l){if(l<=this._length>>1)var g=this.head,f="next";else g=this.tail,f="prev",l=this._length-l-1;for(;0<l--&&g;)g=g[f];return g}}]),h}(),Ac=function(){function h(l,g){X(this,h),g=Object.assign({maxlen:1/0,maxsize:1/0,map:function(){return new Map},ksize:function(){return 0},vsize:function(){return 0}},g),this.map=g.map(),this.items=new Mz,this._size=0,this.opts=g,l&&this.into(l)}return Ia(h,[{key:"length",get:function(){return this.items.length}},{key:"size",get:function(){return this._size}},{key:Symbol.iterator,value:function(){return this.entries()}},{key:"entries",value:function(){return Mg(function(l){return[l.k,l]},this.items)}},{key:"keys",value:function(){return Mg(function(l){return l.k},this.items)}},{key:"values",value:function(){return Mg(function(l){return l.v},this.items)}},{key:"copy",value:function(){var l=this.empty();l.items=this.items.copy();for(var g=l.items.head;g;)l.map.set(g.value.k,g),g=g.next;return l}},{key:"empty",value:function(){return new h(null,this.opts)}},{key:"release",value:function(){this._size=0,this.map.clear();var l=this.opts.release;if(l){for(var g;g=this.items.drop();)l(g.k,g.v);return!0}return this.items.release()}},{key:"has",value:function(l){return this.map.has(l)}},{key:"get",value:function(l,g){return(l=this.map.get(l))?this.resetEntry(l):g}},{key:"set",value:function(l,g){var f=this.opts.ksize(l)+this.opts.vsize(g),k=this.map.get(l);return this._size+=Math.max(0,f-(k?k.value.s:0)),this.ensureSize()&&this.doSetEntry(k,l,g,f),g}},{key:"into",value:function(l){for(var g=0;g<l.length;g++){var f=l[g];this.set(f[0],f[1])}return this}},{key:"getSet",value:function(l,g){var f=this,k=this.map.get(l);return k?Promise.resolve(this.resetEntry(k)):g().then(function(q){return f.set(l,q)})}},{key:"delete",value:function(l){return!!(l=this.map.get(l))&&(this.removeEntry(l),!0)}},{key:"resetEntry",value:function(l){return this.items.asTail(l),l.value.v}},{key:"ensureSize",value:function(){for(var l=this.opts.release,g=this.opts.maxsize,f=this.opts.maxlen;this._size>g||this.length>=f;){var k=this.items.drop();if(!k)return!1;this.map.delete(k.k),l&&l(k.k,k.v),this._size-=k.s}return!0}},{key:"removeEntry",value:function(l){var g=l.value;this.map.delete(g.k),this.items.remove(l),this.opts.release&&this.opts.release(g.k,g.v),this._size-=g.s}},{key:"doSetEntry",value:function(l,g,f,k){l?(l.value.v=f,l.value.s=k,this.items.asTail(l)):(this.items.push({k:g,v:f,s:k}),this.map.set(g,this.items.tail))}}]),h}(),Nz=function(h){function l(f,k){return X(this,l),k=Object.assign({ttl:36e5},k),g.call(this,f,k)}ja(l,h);var g=ka(l);return Ia(l,[{key:"empty",value:function(){return new l(null,this.opts)}},{key:"has",value:function(f){return void 0!==this.get(f)}},{key:"get",value:function(f,k){if(f=this.map.get(f)){if(f.value.t>=Date.now())return this.resetEntry(f);this.removeEntry(f)}return k}},{key:"set",value:function(f,k){var q=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.opts.ttl,_r=this.opts.ksize(f)+this.opts.vsize(k),_s=this.map.get(f);return this._size+=Math.max(0,_r-(_s?_s.value.s:0)),this.ensureSize()&&(q=Date.now()+q,_s?(_s.value.v=k,_s.value.s=_r,_s.value.t=q,this.items.asTail(_s)):(this.items.push({k:f,v:k,s:_r,t:q}),this.map.set(f,this.items.tail))),k}},{key:"getSet",value:function(f,k){var q=this,_r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.opts.ttl,_s=this.get(f);return _s?Promise.resolve(_s):k().then(function(ga){return q.set(f,ga,_r)})}},{key:"prune",value:function(){for(var f=Date.now(),k=this.items.head;k;)k.value.t<f&&this.removeEntry(k),k=k.next}},{key:"ensureSize",value:function(){for(var f=this.opts.maxsize,k=this.opts.maxlen,q=Date.now(),_r=this.items.head;_r&&(this._size>f||this.length>=k);)_r.value.t<q&&this.removeEntry(_r),_r=_r.next;return xi(Fd(l.prototype),"ensureSize",this).call(this)}}]),l}(Ac),Xq="object"==V(Ka)&&Ka&&Ka.Object===Object&&Ka,Oz="object"==("undefined"==typeof self?"undefined":V(self))&&self&&self.Object===Object&&self,Fb=Xq||Oz||Function("return this")(),Ub=Fb.Symbol,Yq=Object.prototype,Pz=Yq.hasOwnProperty,Qz=Yq.toString,qg=Ub?Ub.toStringTag:void 0,Rz=Object.prototype.toString,Zq=Ub?Ub.toStringTag:void 0,$d=function(h){if(null==h)h=void 0===h?"[object Undefined]":"[object Null]";else if(Zq&&Zq in Object(h)){var l=Pz.call(h,qg),g=h[qg];try{h[qg]=void 0;var f=!0}catch(q){}var k=Qz.call(h);f&&(l?h[qg]=g:delete h[qg]),h=k}else h=Rz.call(h);return h},ob=function(h){var l=V(h);return null!=h&&("object"==l||"function"==l)},Wi=function(h){return!!ob(h)&&("[object Function]"==(h=$d(h))||"[object GeneratorFunction]"==h||"[object AsyncFunction]"==h||"[object Proxy]"==h)},$k=Fb["__core-js_shared__"],$q=function(){var h=/[^.]+$/.exec($k&&$k.keys&&$k.keys.IE_PROTO||"");return h?"Symbol(src)_1."+h:""}(),Sz=Function.prototype.toString,ae=function(h){if(null!=h){try{return Sz.call(h)}catch(l){}return h+""}return""},Tz=/^\[object .+?Constructor\]$/,Uz=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),be=function(h,l){return!ob(h=null==h?void 0:h[l])||$q&&$q in h||!(Wi(h)?Uz:Tz).test(ae(h))?void 0:h},rg=be(Object,"create"),Vz=Object.prototype.hasOwnProperty,Wz=Object.prototype.hasOwnProperty;Id.prototype.clear=function(){this.__data__=rg?rg(null):{},this.size=0},Id.prototype.delete=function(h){return h=this.has(h)&&delete this.__data__[h],this.size-=h?1:0,h},Id.prototype.get=function(h){var l=this.__data__;return rg?"__lodash_hash_undefined__"===(h=l[h])?void 0:h:Vz.call(l,h)?l[h]:void 0},Id.prototype.has=function(h){var l=this.__data__;return rg?void 0!==l[h]:Wz.call(l,h)},Id.prototype.set=function(h,l){var g=this.__data__;return this.size+=this.has(h)?0:1,g[h]=rg&&void 0===l?"__lodash_hash_undefined__":l,this};var sg=function(h,l){return h===l||h!=h&&l!=l},Vh=function(h,l){for(var g=h.length;g--;)if(sg(h[g][0],l))return g;return-1},Xz=Array.prototype.splice;qe.prototype.clear=function(){this.__data__=[],this.size=0},qe.prototype.delete=function(h){var l=this.__data__;return!(0>(h=Vh(l,h))||(h==l.length-1?l.pop():Xz.call(l,h,1),--this.size,0))},qe.prototype.get=function(h){var l=this.__data__;return 0>(h=Vh(l,h))?void 0:l[h][1]},qe.prototype.has=function(h){return-1<Vh(this.__data__,h)},qe.prototype.set=function(h,l){var g=this.__data__,f=Vh(g,h);return 0>f?(++this.size,g.push([h,l])):g[f][1]=l,this};var Og=qe,tg=be(Fb,"Map"),Wh=function(h,l){h=h.__data__;var g=V(l);return("string"==g||"number"==g||"symbol"==g||"boolean"==g?"__proto__"!==l:null===l)?h["string"==typeof l?"string":"hash"]:h.map};re.prototype.clear=function(){this.size=0,this.__data__={hash:new Id,map:new(tg||Og),string:new Id}},re.prototype.delete=function(h){return h=Wh(this,h).delete(h),this.size-=h?1:0,h},re.prototype.get=function(h){return Wh(this,h).get(h)},re.prototype.has=function(h){return Wh(this,h).has(h)},re.prototype.set=function(h,l){var g=Wh(this,h),f=g.size;return g.set(h,l),this.size+=g.size==f?0:1,this};var Ng=re;zf.prototype.add=zf.prototype.push=function(h){return this.__data__.set(h,"__lodash_hash_undefined__"),this},zf.prototype.has=function(h){return this.__data__.has(h)};var ar=function(h,l,g,f){var k=h.length;for(g+=f?1:-1;f?g--:++g<k;)if(l(h[g],g,h))return g;return-1},Yz=function(h){return h!=h},Zz=function(h,l){var g;if(g=!(null==h||!h.length)){if(l==l)e:{g=-1;for(var f=h.length;++g<f;)if(h[g]===l){h=g;break e}h=-1}else h=ar(h,Yz,0);g=-1<h}return g},$z=function(h,l,g){for(var f=-1,k=null==h?0:h.length;++f<k;)if(g(l,h[f]))return!0;return!1},aA=function(h,l){return h.has(l)},gf=be(Fb,"Set"),bA=function(){},al=function(h){var l=-1,g=Array(h.size);return h.forEach(function(f){g[++l]=f}),g},cA=1/0,dA=gf&&1/al(new gf([,-0]))[1]==cA?function(h){return new gf(h)}:bA,bl=function(h,l,g){var f=-1,k=Zz,q=h.length,_r=!0,_s=[],ga=_s;if(g)_r=!1,k=$z;else if(200<=q){if(k=l?null:dA(h))return al(k);_r=!1,k=aA,ga=new zf}else ga=l?[]:_s;e:for(;++f<q;){var _l=h[f],bh=l?l(_l):_l;if(_l=g||0!==_l?_l:0,_r&&bh==bh){for(var n_=ga.length;n_--;)if(ga[n_]===bh)continue e;l&&ga.push(bh),_s.push(_l)}else k(ga,bh,g)||(ga!==_s&&ga.push(bh),_s.push(_l))}return _s},br=function(h){for(var l=-1,g=null==h?0:h.length,f={};++l<g;){var k=h[l];f[k[0]]=k[1]}return f},ve=function(h,l){for(var g=-1,f=null==h?0:h.length,k=Array(f);++g<f;)k[g]=l(h[g],g,h);return k};se.prototype.clear=function(){this.__data__=new Og,this.size=0},se.prototype.delete=function(h){var l=this.__data__;return h=l.delete(h),this.size=l.size,h},se.prototype.get=function(h){return this.__data__.get(h)},se.prototype.has=function(h){return this.__data__.has(h)},se.prototype.set=function(h,l){var g=this.__data__;if(g instanceof Og){var f=g.__data__;if(!tg||199>f.length)return f.push([h,l]),this.size=++g.size,this;g=this.__data__=new Ng(f)}return g.set(h,l),this.size=g.size,this};var ue=se,Cu=function(h,l){for(var g=-1,f=null==h?0:h.length;++g<f&&!1!==l(h[g],g,h););return h},Xh=function(){try{var h=be(Object,"defineProperty");return h({},"",{}),h}catch(l){}}(),ug=function(h,l,g){"__proto__"==l&&Xh?Xh(h,l,{configurable:!0,enumerable:!0,value:g,writable:!0}):h[l]=g},eA=Object.prototype.hasOwnProperty,Om=function(h,l,g){var f=h[l];eA.call(h,l)&&sg(f,g)&&(void 0!==g||l in h)||ug(h,l,g)},Fe=function(h,l,g,f){var k=!g;g||(g={});for(var q=-1,_r=l.length;++q<_r;){var _s=l[q],ga=f?f(g[_s],h[_s],_s,g,h):void 0;void 0===ga&&(ga=h[_s]),k?ug(g,_s,ga):Om(g,_s,ga)}return g},oc=function(h){return null!=h&&"object"==V(h)},cr=function(h){return oc(h)&&"[object Arguments]"==$d(h)},dr=Object.prototype,fA=dr.hasOwnProperty,gA=dr.propertyIsEnumerable,Jf=cr(function(){return arguments}())?cr:function(h){return oc(h)&&fA.call(h,"callee")&&!gA.call(h,"callee")},Za=Array.isArray,hA=function(){return!1},Bf=cb(function(h,l){var g=(l=l&&!l.nodeType&&l)&&h&&!h.nodeType&&h;h.exports=((l=g&&g.exports===l?Fb.Buffer:void 0)?l.isBuffer:void 0)||hA}),iA=/^(?:0|[1-9]\d*)$/,cl=function(h,l){var g=V(h);return!!(l=null==l?9007199254740991:l)&&("number"==g||"symbol"!=g&&iA.test(h))&&-1<h&&h%1==0&&h<l},dl=function(h){return"number"==typeof h&&-1<h&&h%1==0&&9007199254740991>=h},Ga={};Ga["[object Float32Array]"]=Ga["[object Float64Array]"]=Ga["[object Int8Array]"]=Ga["[object Int16Array]"]=Ga["[object Int32Array]"]=Ga["[object Uint8Array]"]=Ga["[object Uint8ClampedArray]"]=Ga["[object Uint16Array]"]=Ga["[object Uint32Array]"]=!0,Ga["[object Arguments]"]=Ga["[object Array]"]=Ga["[object ArrayBuffer]"]=Ga["[object Boolean]"]=Ga["[object DataView]"]=Ga["[object Date]"]=Ga["[object Error]"]=Ga["[object Function]"]=Ga["[object Map]"]=Ga["[object Number]"]=Ga["[object Object]"]=Ga["[object RegExp]"]=Ga["[object Set]"]=Ga["[object String]"]=Ga["[object WeakMap]"]=!1;var jA=function(h){return oc(h)&&dl(h.length)&&!!Ga[$d(h)]},Yh=function(h){return function(l){return h(l)}},hf=cb(function(h,l){var g=l&&!l.nodeType&&l;g=(l=g&&h&&!h.nodeType&&h)&&l.exports===g&&Xq.process;e:{try{var f=l&&l.require&&l.require("util").types;if(f){var k=f;break e}k=g&&g.binding&&g.binding("util");break e}catch(q){}k=void 0}h.exports=k}),er=hf&&hf.isTypedArray,Gi=er?Yh(er):jA,kA=Object.prototype.hasOwnProperty,fr=function(h,l){var g=Za(h),f=!g&&Jf(h),k=!g&&!f&&Bf(h),q=!g&&!f&&!k&&Gi(h);if(g=g||f||k||q){f=h.length;for(var _r=String,_s=-1,ga=Array(f);++_s<f;)ga[_s]=_r(_s);f=ga}else f=[];for(var _l in _r=f.length,h)!l&&!kA.call(h,_l)||g&&("length"==_l||k&&("offset"==_l||"parent"==_l)||q&&("buffer"==_l||"byteLength"==_l||"byteOffset"==_l)||cl(_l,_r))||f.push(_l);return f},lA=Object.prototype,el=function(h){var l=h&&h.constructor;return h===("function"==typeof l&&l.prototype||lA)},gr=function(h,l){return function(g){return h(l(g))}},mA=gr(Object.keys,Object),nA=Object.prototype.hasOwnProperty,Nd=function(h){return null!=h&&dl(h.length)&&!Wi(h)},Jd=function(h){if(Nd(h))h=fr(h);else if(el(h)){var l,g=[];for(l in Object(h))nA.call(h,l)&&"constructor"!=l&&g.push(l);h=g}else h=mA(h);return h},yu=function(h,l){return h&&Fe(l,Jd(l),h)},oA=Object.prototype.hasOwnProperty,Cf=function(h){if(Nd(h))h=fr(h,!0);else if(ob(h)){var l=el(h),g=[];for(f in h)("constructor"!=f||!l&&oA.call(h,f))&&g.push(f);h=g}else{var f=[];if(null!=h)for(l in Object(h))f.push(l);h=f}return h},wu=function(h,l){return h&&Fe(l,Cf(l),h)},Lm=cb(function(h,l){var g=(l=l&&!l.nodeType&&l)&&h&&!h.nodeType&&h,f=(l=g&&g.exports===l?Fb.Buffer:void 0)?l.allocUnsafe:void 0;h.exports=function(k,q){return q?k.slice():(q=k.length,q=f?f(q):new k.constructor(q),k.copy(q),q)}}),Bi=function(h,l){var g=-1,f=h.length;for(l||(l=Array(f));++g<f;)l[g]=h[g];return l},pA=function(h,l){for(var g=-1,f=null==h?0:h.length,k=0,q=[];++g<f;){var _r=h[g];l(_r,g,h)&&(q[k++]=_r)}return q},hr=function(){return[]},qA=Object.prototype.propertyIsEnumerable,ir=Object.getOwnPropertySymbols,fl=ir?function(h){return null==h?[]:(h=Object(h),pA(ir(h),function(l){return qA.call(h,l)}))}:hr,xu=function(h,l){return Fe(h,fl(h),l)},Fi=function(h,l){for(var g=-1,f=l.length,k=h.length;++g<f;)h[k+g]=l[g];return h},gl=gr(Object.getPrototypeOf,Object),jr=Object.getOwnPropertySymbols?function(h){for(var l=[];h;)Fi(l,fl(h)),h=gl(h);return l}:hr,vu=function(h,l){return Fe(h,jr(h),l)},kr=function(h,l,g){return l=l(h),Za(h)?l:Fi(l,g(h))},Ci=function(h){return kr(h,Jd,fl)},Nm=function(h){return kr(h,Cf,jr)},hl=be(Fb,"DataView"),il=be(Fb,"Promise"),jl=be(Fb,"WeakMap"),rA=ae(hl),sA=ae(tg),tA=ae(il),uA=ae(gf),vA=ae(jl),ce=$d;(hl&&"[object DataView]"!=ce(new hl(new ArrayBuffer(1)))||tg&&"[object Map]"!=ce(new tg)||il&&"[object Promise]"!=ce(il.resolve())||gf&&"[object Set]"!=ce(new gf)||jl&&"[object WeakMap]"!=ce(new jl))&&(ce=function(h){var l=$d(h);if(h=(h="[object Object]"==l?h.constructor:void 0)?ae(h):"")switch(h){case rA:return"[object DataView]";case sA:return"[object Map]";case tA:return"[object Promise]";case uA:return"[object Set]";case vA:return"[object WeakMap]"}return l});var Af=ce,wA=Object.prototype.hasOwnProperty,uu=function(h){var l=h.length,g=new h.constructor(l);return l&&"string"==typeof h[0]&&wA.call(h,"index")&&(g.index=h.index,g.input=h.input),g},Zh=Fb.Uint8Array,kl=function(h){var l=new h.constructor(h.byteLength);return new Zh(l).set(new Zh(h)),l},xA=/\w*$/,lr=Ub?Ub.prototype:void 0,mr=lr?lr.valueOf:void 0,An=function(h,l){return l=l?kl(h.buffer):h.buffer,new h.constructor(l,h.byteOffset,h.length)},zu=function(h,l,g){var f=h.constructor;switch(l){case"[object ArrayBuffer]":return kl(h);case"[object Boolean]":case"[object Date]":return new f(+h);case"[object DataView]":return l=g?kl(h.buffer):h.buffer,new h.constructor(l,h.byteOffset,h.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return An(h,g);case"[object Map]":case"[object Set]":return new f;case"[object Number]":case"[object String]":return new f(h);case"[object RegExp]":return(l=new h.constructor(h.source,xA.exec(h))).lastIndex=h.lastIndex,l;case"[object Symbol]":return mr?Object(mr.call(h)):{}}},nr=Object.create,yA=function(){function h(){}return function(l){return ob(l)?nr?nr(l):(h.prototype=l,l=new h,h.prototype=void 0,l):{}}}(),Mm=function(h){return"function"!=typeof h.constructor||el(h)?{}:yA(gl(h))},zA=function(h){return oc(h)&&"[object Map]"==Af(h)},or=hf&&hf.isMap,Bu=or?Yh(or):zA,AA=function(h){return oc(h)&&"[object Set]"==Af(h)},pr=hf&&hf.isSet,Au=pr?Yh(pr):AA,xa={};xa["[object Arguments]"]=xa["[object Array]"]=xa["[object ArrayBuffer]"]=xa["[object DataView]"]=xa["[object Boolean]"]=xa["[object Date]"]=xa["[object Float32Array]"]=xa["[object Float64Array]"]=xa["[object Int8Array]"]=xa["[object Int16Array]"]=xa["[object Int32Array]"]=xa["[object Map]"]=xa["[object Number]"]=xa["[object Object]"]=xa["[object RegExp]"]=xa["[object Set]"]=xa["[object String]"]=xa["[object Symbol]"]=xa["[object Uint8Array]"]=xa["[object Uint8ClampedArray]"]=xa["[object Uint16Array]"]=xa["[object Uint32Array]"]=!0,xa["[object Error]"]=xa["[object Function]"]=xa["[object WeakMap]"]=!1;var we=function(h){return"symbol"==V(h)||oc(h)&&"[object Symbol]"==$d(h)},BA=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,CA=/^\w*$/,ll=function(h,l){if(Za(h))return!1;var g=V(h);return!("number"!=g&&"symbol"!=g&&"boolean"!=g&&null!=h&&!we(h))||CA.test(h)||!BA.test(h)||null!=l&&h in Object(l)};Di.Cache=Ng;var DA=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,EA=/\\(\\)?/g,FA=function(h){var l=(h=Di(h,function(g){return 500===l.size&&l.clear(),g})).cache;return h}(function(h){var l=[];return 46===h.charCodeAt(0)&&l.push(""),h.replace(DA,function(g,f,k,q){l.push(k?q.replace(EA,"$1"):f||g)}),l}),Du=1/0,qr=Ub?Ub.prototype:void 0,Qm=qr?qr.toString:void 0,$h=function(h,l){return Za(h)?h:ll(h,l)?[h]:FA(null==h?"":Pm(h))},GA=1/0,vg=function(h){if("string"==typeof h||we(h))return h;var l=h+"";return"0"==l&&1/h==-GA?"-0":l},ai=function(h,l){for(var g=0,f=(l=$h(l,h)).length;null!=h&&g<f;)h=h[vg(l[g++])];return g&&g==f?h:void 0},HA=function(h,l){if(!(2>(l=$h(l,h)).length)){var g=l,f=0,k=-1,q=-1,_r=g.length;for(0>f&&(f=-f>_r?0:_r+f),0>(k=k>_r?_r:k)&&(k+=_r),_r=f>k?0:k-f>>>0,f>>>=0,k=Array(_r);++q<_r;)k[q]=g[q+f];h=ai(h,k)}return(g=null==h)||(g=delete h[vg((g=null==l?0:l.length)?l[g-1]:void 0)]),g},rr=Function.prototype.toString,IA=Object.prototype.hasOwnProperty,JA=rr.call(Object),Bn=function(h){return!(!oc(h)||"[object Object]"!=$d(h))&&(null===(h=gl(h))||"function"==typeof(h=IA.call(h,"constructor")&&h.constructor)&&h instanceof h&&rr.call(h)==JA)},KA=function(h){return Bn(h)?void 0:h},sr=Ub?Ub.isConcatSpreadable:void 0,Eu=function(h){return Za(h)||Jf(h)||!!(sr&&h&&h[sr])},LA=function(h){return null!=h&&h.length?Ei(h,1):[]},MA=function(h,l,g){switch(g.length){case 0:return h.call(l);case 1:return h.call(l,g[0]);case 2:return h.call(l,g[0],g[1]);case 3:return h.call(l,g[0],g[1],g[2])}return h.apply(l,g)},tr=Math.max,ur=function(h,l,g){return l=tr(void 0===l?h.length-1:l,0),function(){for(var f=arguments,k=-1,q=tr(f.length-l,0),_r=Array(q);++k<q;)_r[k]=f[l+k];for(k=-1,q=Array(l+1);++k<l;)q[k]=f[k];return q[l]=g(_r),MA(h,this,q)}},NA=function(h){return function(){return h}},bi=function(h){return h},OA=Date.now,vr=function(h){var l=0,g=0;return function(){var f=OA(),k=16-(f-g);if(g=f,0<k){if(800<=++l)return arguments[0]}else l=0;return h.apply(void 0,arguments)}}(Xh?function(h,l){return Xh(h,"toString",{configurable:!0,enumerable:!1,value:NA(l),writable:!0})}:bi),ml=function(h){return vr(ur(h,void 0,LA),h+"")}(function(h,l){var g={};if(null==h)return g;var f=!1;l=ve(l,function(q){return q=$h(q,h),f||(f=1<q.length),q}),Fe(h,Nm(h),g),f&&(g=te(g,7,KA));for(var k=l.length;k--;)HA(g,l[k]);return g}),PA=function(h,l,g,f){for(var k=-1,q=null==h?0:h.length;++k<q;){var _r=h[k];l(f,_r,g(_r),h)}return f},zn=function(h,l,g){for(var f=-1,k=Object(h),q=(g=g(h)).length;q--;){var _r=g[++f];if(!1===l(k[_r],_r,k))break}return h},wr=function(h,l){return h&&zn(h,l,Jd)},nl=function(h,l){return function(g,f){if(null==g)return g;if(!Nd(g))return h(g,f);for(var k=g.length,q=-1,_r=Object(g);++q<k&&!1!==f(_r[q],q,_r););return g}}(wr),QA=function(h,l,g,f){return nl(h,function(k,q,_r){l(f,k,g(k),_r)}),f},xr=function(h,l){for(var g=-1,f=null==h?0:h.length;++g<f;)if(l(h[g],g,h))return!0;return!1},Rm=function(h,l,g,f,k,q){var _r=1&g,_s=h.length,ga=l.length;if(_s!=ga&&!(_r&&ga>_s))return!1;ga=q.get(h);var _l=q.get(l);if(ga&&_l)return ga==l&&_l==h;ga=-1,_l=!0;var bh=2&g?new zf:void 0;for(q.set(h,l),q.set(l,h);++ga<_s;){var n_=h[ga],_A=l[ga];if(f)var r_=_r?f(_A,n_,ga,l,h,q):f(n_,_A,ga,h,l,q);if(void 0!==r_){if(r_)continue;_l=!1;break}if(bh){if(!xr(l,function(p_,I_){if(!bh.has(I_)&&(n_===p_||k(n_,p_,g,f,q)))return bh.push(I_)})){_l=!1;break}}else if(n_!==_A&&!k(n_,_A,g,f,q)){_l=!1;break}}return q.delete(h),q.delete(l),_l},RA=function(h){var l=-1,g=Array(h.size);return h.forEach(function(f,k){g[++l]=[k,f]}),g},yr=Ub?Ub.prototype:void 0,ol=yr?yr.valueOf:void 0,Fu=function(h,l,g,f,k,q,_r){switch(g){case"[object DataView]":if(h.byteLength!=l.byteLength||h.byteOffset!=l.byteOffset)break;h=h.buffer,l=l.buffer;case"[object ArrayBuffer]":if(h.byteLength!=l.byteLength||!q(new Zh(h),new Zh(l)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return sg(+h,+l);case"[object Error]":return h.name==l.name&&h.message==l.message;case"[object RegExp]":case"[object String]":return h==l+"";case"[object Map]":var _s=RA;case"[object Set]":if(_s||(_s=al),h.size!=l.size&&!(1&f))break;return(g=_r.get(h))?g==l:(f|=2,_r.set(h,l),l=Rm(_s(h),_s(l),f,k,q,_r),_r.delete(h),l);case"[object Symbol]":if(ol)return ol.call(h)==ol.call(l)}return!1},Gu=Object.prototype.hasOwnProperty,Sm=Object.prototype.hasOwnProperty,SA=function(h,l,g,f){var k=g.length,q=k,_r=!f;if(null==h)return!q;for(h=Object(h);k--;){var _s=g[k];if(_r&&_s[2]?_s[1]!==h[_s[0]]:!(_s[0]in h))return!1}for(;++k<q;){var ga=(_s=g[k])[0],_l=h[ga],bh=_s[1];if(_r&&_s[2]){if(void 0===_l&&!(ga in h))return!1}else{if(_s=new ue,f)var n_=f(_l,bh,ga,h,l,_s);if(void 0===n_?!xe(bh,_l,3,f,_s):!n_)return!1}}return!0},TA=function(h){for(var l=Jd(h),g=l.length;g--;){var f=l[g],k=h[f];l[g]=[f,k,k==k&&!ob(k)]}return l},zr=function(h,l){return function(g){return null!=g&&g[h]===l&&(void 0!==l||h in Object(g))}},UA=function(h){var l=TA(h);return 1==l.length&&l[0][2]?zr(l[0][0],l[0][1]):function(g){return g===h||SA(g,h,l)}},VA=function(h,l){return ll(h)&&l==l&&!ob(l)?zr(vg(h),l):function(g){var f=null==g?void 0:ai(g,h);if(void 0===(f=void 0===f?void 0:f)&&f===l){if(f=null!=g){for(var k=-1,q=(f=$h(f=h,g)).length,_r=!1;++k<q;){var _s=vg(f[k]);if(!(_r=null!=g&&null!=g&&_s in Object(g)))break;g=g[_s]}f=_r||++k!=q?_r:!!(q=null==g?0:g.length)&&dl(q)&&cl(_s,q)&&(Za(g)||Jf(g))}_s=f}else _s=xe(l,f,3);return _s}},WA=function(h){return function(l){return null==l?void 0:l[h]}},XA=function(h){return function(l){return ai(l,h)}},jf=function(h){return"function"==typeof h?h:null==h?bi:"object"==V(h)?Za(h)?VA(h[0],h[1]):UA(h):ll(h)?WA(vg(h)):XA(h)},pl=function(h,l){return function(g,f){return(Za(g)?PA:QA)(g,h,jf(f),{})}}(function(h,l,g){ug(h,g,l)}),Bc=function(h,l){var g={};return l=jf(l),wr(h,function(f,k,q){ug(g,k,l(f,k,q))}),g};M({target:"String",proto:!0,forced:R(function(){var h="".sub('"');return h!==h.toLowerCase()||3<h.split('"').length})},{sub:function(){return"<sub>"+String(mb(this))+"</sub>"}});var U=ya,Vb=null;try{Vb=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(h){}Object.defineProperty(ya.prototype,"__isLong__",{value:!0}),ya.isLong=pb;var Um={},Tm={};ya.fromInt=Kd,ya.fromNumber=Kb,ya.fromBits=za;var Pg=Math.pow;ya.fromString=Hi,ya.fromValue=bc;var ye=4294967296,Vm=ye*ye,Xm=Vm/2,Ar=Kd(16777216),Lb=Kd(0);ya.ZERO=Lb;var Ld=Kd(0,!0);ya.UZERO=Ld;var kf=Kd(1);ya.ONE=kf;var Br=Kd(1,!0);ya.UONE=Br;var ql=Kd(-1);ya.NEG_ONE=ql;var Ym=za(-1,2147483647,!1);ya.MAX_VALUE=Ym;var Wm=za(-1,-1,!0);ya.MAX_UNSIGNED_VALUE=Wm;var qb=za(0,-2147483648,!1);ya.MIN_VALUE=qb;var z=ya.prototype;z.toInt=function(){return this.unsigned?this.low>>>0:this.low},z.toNumber=function(){return this.unsigned?(this.high>>>0)*ye+(this.low>>>0):this.high*ye+(this.low>>>0)},z.toString=function(h){if(2>(h=h||10)||36<h)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(qb)){var l=Kb(h),g=this.div(l);return l=g.mul(l).sub(this),g.toString(h)+l.toInt().toString(h)}return"-"+this.neg().toString(h)}g=Kb(Pg(h,6),this.unsigned),l=this;for(var f="";;){var k=l.div(g),q=(l.sub(k.mul(g)).toInt()>>>0).toString(h);if((l=k).isZero())return q+f;for(;6>q.length;)q="0"+q;f=""+q+f}},z.getHighBits=function(){return this.high},z.getHighBitsUnsigned=function(){return this.high>>>0},z.getLowBits=function(){return this.low},z.getLowBitsUnsigned=function(){return this.low>>>0},z.getNumBitsAbs=function(){if(this.isNegative())return this.eq(qb)?64:this.neg().getNumBitsAbs();for(var h=0!=this.high?this.high:this.low,l=31;0<l&&0==(h&1<<l);l--);return 0!=this.high?l+33:l+1},z.isZero=function(){return 0===this.high&&0===this.low},z.eqz=z.isZero,z.isNegative=function(){return!this.unsigned&&0>this.high},z.isPositive=function(){return this.unsigned||0<=this.high},z.isOdd=function(){return 1==(1&this.low)},z.isEven=function(){return 0==(1&this.low)},z.equals=function(h){return pb(h)||(h=bc(h)),(this.unsigned===h.unsigned||this.high>>>31!=1||h.high>>>31!=1)&&this.high===h.high&&this.low===h.low},z.eq=z.equals,z.notEquals=function(h){return!this.eq(h)},z.neq=z.notEquals,z.ne=z.notEquals,z.lessThan=function(h){return 0>this.comp(h)},z.lt=z.lessThan,z.lessThanOrEqual=function(h){return 0>=this.comp(h)},z.lte=z.lessThanOrEqual,z.le=z.lessThanOrEqual,z.greaterThan=function(h){return 0<this.comp(h)},z.gt=z.greaterThan,z.greaterThanOrEqual=function(h){return 0<=this.comp(h)},z.gte=z.greaterThanOrEqual,z.ge=z.greaterThanOrEqual,z.compare=function(h){if(pb(h)||(h=bc(h)),this.eq(h))return 0;var l=this.isNegative(),g=h.isNegative();return l&&!g?-1:!l&&g?1:this.unsigned?h.high>>>0>this.high>>>0||h.high===this.high&&h.low>>>0>this.low>>>0?-1:1:this.sub(h).isNegative()?-1:1},z.comp=z.compare,z.negate=function(){return!this.unsigned&&this.eq(qb)?qb:this.not().add(kf)},z.neg=z.negate,z.add=function(h){pb(h)||(h=bc(h));var l=this.high>>>16,f=this.low>>>16,k=h.high>>>16,q=65535&h.high,_r=h.low>>>16;return f=(_r=((h=(65535&this.low)+(65535&h.low))>>>16)+(f+_r))>>>16,za((65535&_r)<<16|65535&h,(l=((f+=(65535&this.high)+q)>>>16)+(l+k)&65535)<<16|65535&f,this.unsigned)},z.subtract=function(h){return pb(h)||(h=bc(h)),this.add(h.neg())},z.sub=z.subtract,z.multiply=function(h){if(this.isZero())return Lb;if(pb(h)||(h=bc(h)),Vb){var l=Vb.mul(this.low,this.high,h.low,h.high);return za(l,Vb.get_high(),this.unsigned)}if(h.isZero())return Lb;if(this.eq(qb))return h.isOdd()?qb:Lb;if(h.eq(qb))return this.isOdd()?qb:Lb;if(this.isNegative())return h.isNegative()?this.neg().mul(h.neg()):this.neg().mul(h).neg();if(h.isNegative())return this.mul(h.neg()).neg();if(this.lt(Ar)&&h.lt(Ar))return Kb(this.toNumber()*h.toNumber(),this.unsigned);var g=65535&this.high,f=this.low>>>16,k=65535&this.low,q=h.high>>>16,_r=65535&h.high,_s=h.low>>>16,ga=k*(h=65535&h.low),_l=(ga>>>16)+f*h,bh=_l>>>16;bh+=(_l=(65535&_l)+k*_s)>>>16;var n_=(bh+=g*h)>>>16;return za((65535&_l)<<16|65535&ga,(n_=(n_+=(bh=(65535&bh)+f*_s)>>>16)+((bh=(65535&bh)+k*_r)>>>16)+((l=this.high>>>16)*h+g*_s+f*_r+k*q)&65535)<<16|65535&bh,this.unsigned)},z.mul=z.multiply,z.divide=function(h){if(pb(h)||(h=bc(h)),h.isZero())throw Error("division by zero");if(Vb)return this.unsigned||-2147483648!==this.high||-1!==h.low||-1!==h.high?za(h=(this.unsigned?Vb.div_u:Vb.div_s)(this.low,this.high,h.low,h.high),Vb.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?Ld:Lb;if(this.unsigned){if(h.unsigned||(h=h.toUnsigned()),h.gt(this))return Ld;if(h.gt(this.shru(1)))return Br;var l=Ld}else{if(this.eq(qb)){if(h.eq(kf)||h.eq(ql))return qb;if(h.eq(qb))return kf;var g=this.shr(1).div(h).shl(1);if(g.eq(Lb))return h.isNegative()?kf:ql;var f=this.sub(h.mul(g));return g.add(f.div(h))}if(h.eq(qb))return this.unsigned?Ld:Lb;if(this.isNegative())return h.isNegative()?this.neg().div(h.neg()):this.neg().div(h).neg();if(h.isNegative())return this.div(h.neg()).neg();l=Lb}for(f=this;f.gte(h);){g=Math.max(1,Math.floor(f.toNumber()/h.toNumber()));var k=Math.ceil(Math.log(g)/Math.LN2);k=48>=k?1:Pg(2,k-48);for(var q=Kb(g),_r=q.mul(h);_r.isNegative()||_r.gt(f);)_r=(q=Kb(g-=k,this.unsigned)).mul(h);q.isZero()&&(q=kf),l=l.add(q),f=f.sub(_r)}return l},z.div=z.divide,z.modulo=function(h){return pb(h)||(h=bc(h)),Vb?za(h=(this.unsigned?Vb.rem_u:Vb.rem_s)(this.low,this.high,h.low,h.high),Vb.get_high(),this.unsigned):this.sub(this.div(h).mul(h))},z.mod=z.modulo,z.rem=z.modulo,z.not=function(){return za(~this.low,~this.high,this.unsigned)},z.and=function(h){return pb(h)||(h=bc(h)),za(this.low&h.low,this.high&h.high,this.unsigned)},z.or=function(h){return pb(h)||(h=bc(h)),za(this.low|h.low,this.high|h.high,this.unsigned)},z.xor=function(h){return pb(h)||(h=bc(h)),za(this.low^h.low,this.high^h.high,this.unsigned)},z.shiftLeft=function(h){return pb(h)&&(h=h.toInt()),0==(h&=63)?this:32>h?za(this.low<<h,this.high<<h|this.low>>>32-h,this.unsigned):za(0,this.low<<h-32,this.unsigned)},z.shl=z.shiftLeft,z.shiftRight=function(h){return pb(h)&&(h=h.toInt()),0==(h&=63)?this:32>h?za(this.low>>>h|this.high<<32-h,this.high>>h,this.unsigned):za(this.high>>h-32,0<=this.high?0:-1,this.unsigned)},z.shr=z.shiftRight,z.shiftRightUnsigned=function(h){if(pb(h)&&(h=h.toInt()),0==(h&=63))return this;var l=this.high;return 32>h?za(this.low>>>h|l<<32-h,l>>>h,this.unsigned):za(32===h?l:l>>>h-32,0,this.unsigned)},z.shru=z.shiftRightUnsigned,z.shr_u=z.shiftRightUnsigned,z.toSigned=function(){return this.unsigned?za(this.low,this.high,!1):this},z.toUnsigned=function(){return this.unsigned?this:za(this.low,this.high,!0)},z.toBytes=function(h){return h?this.toBytesLE():this.toBytesBE()},z.toBytesLE=function(){var h=this.high,l=this.low;return[255&l,l>>>8&255,l>>>16&255,l>>>24,255&h,h>>>8&255,h>>>16&255,h>>>24]},z.toBytesBE=function(){var h=this.high,l=this.low;return[h>>>24,h>>>16&255,h>>>8&255,255&h,l>>>24,l>>>16&255,l>>>8&255,255&l]},ya.fromBytes=function(h,l,g){return g?ya.fromBytesLE(h,l):ya.fromBytesBE(h,l)},ya.fromBytesLE=function(h,l){return new ya(h[0]|h[1]<<8|h[2]<<16|h[3]<<24,h[4]|h[5]<<8|h[6]<<16|h[7]<<24,l)},ya.fromBytesBE=function(h,l){return new ya(h[4]<<24|h[5]<<16|h[6]<<8|h[7],h[0]<<24|h[1]<<16|h[2]<<8|h[3],l)};var Ii=function(h,l){return(Ii=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,f){g.__proto__=f}||function(g,f){for(var k in f)f.hasOwnProperty(k)&&(g[k]=f[k])})(h,l)},rl=!1,Mb={Promise:void 0,set useDeprecatedSynchronousErrorHandling(h){h?console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+Error().stack):rl&&console.log("RxJS: Back to a better error behavior. Thank you. <3"),rl=h},get useDeprecatedSynchronousErrorHandling(){return rl}},ci={closed:!0,next:function(h){},error:function(h){if(Mb.useDeprecatedSynchronousErrorHandling)throw h;Ae(h)},complete:function(){}},Nb=Array.isArray||function(h){return h&&"number"==typeof h.length},Df=function(){function h(l){return Error.call(this),this.message=l?l.length+" errors occurred during unsubscription:\n"+l.map(function(g,f){return f+1+") "+g.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=l,this}return h.prototype=Object.create(Error.prototype),h}(),Ta=function(){function h(l){this.closed=!1,this._subscriptions=this._parentOrParents=null,l&&(this._ctorUnsubscribe=!0,this._unsubscribe=l)}return h.prototype.unsubscribe=function(){if(!this.closed){var l=this._parentOrParents,g=this._ctorUnsubscribe,f=this._unsubscribe,k=this._subscriptions;if(this.closed=!0,this._subscriptions=this._parentOrParents=null,l instanceof h)l.remove(this);else if(null!==l)for(var q=0;q<l.length;++q)l[q].remove(this);if(ze(f)){g&&(this._unsubscribe=void 0);try{f.call(this)}catch(_s){var _r=_s instanceof Df?Zm(_s.errors):[_s]}}if(Nb(k))for(q=-1,l=k.length;++q<l;)if(Ji(g=k[q]))try{g.unsubscribe()}catch(_s){_r=_r||[],_s instanceof Df?_r=_r.concat(Zm(_s.errors)):_r.push(_s)}if(_r)throw new Df(_r)}},h.prototype.add=function(l){var g=l;if(!l)return h.EMPTY;switch(V(l)){case"function":g=new h(l);case"object":if(g===this||g.closed||"function"!=typeof g.unsubscribe)return g;if(this.closed)return g.unsubscribe(),g;g instanceof h||(l=g,(g=new h)._subscriptions=[l]);break;default:throw Error("unrecognized teardown "+l+" added to Subscription.")}if(null===(l=g._parentOrParents))g._parentOrParents=this;else if(l instanceof h){if(l===this)return g;g._parentOrParents=[l,this]}else{if(-1!==l.indexOf(this))return g;l.push(this)}return null===(l=this._subscriptions)?this._subscriptions=[g]:l.push(g),g},h.prototype.remove=function(l){var g=this._subscriptions;g&&-1!==(l=g.indexOf(l))&&g.splice(l,1)},h.EMPTY=function(l){return l.closed=!0,l}(new h),h}(),di="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),ma=function(h){function l(g,f,k){var q=h.call(this)||this;switch(q.syncErrorValue=null,q.syncErrorThrown=!1,q.syncErrorThrowable=!1,q.isStopped=!1,arguments.length){case 0:q.destination=ci;break;case 1:if(!g){q.destination=ci;break}if("object"===V(g)){g instanceof l?(q.syncErrorThrowable=g.syncErrorThrowable,q.destination=g,g.add(q)):(q.syncErrorThrowable=!0,q.destination=new Cr(q,g));break}default:q.syncErrorThrowable=!0,q.destination=new Cr(q,g,f,k)}return q}return O(l,h),l.prototype[di]=function(){return this},l.create=function(g,f,k){return(g=new l(g,f,k)).syncErrorThrowable=!1,g},l.prototype.next=function(g){this.isStopped||this._next(g)},l.prototype.error=function(g){this.isStopped||(this.isStopped=!0,this._error(g))},l.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},l.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,h.prototype.unsubscribe.call(this))},l.prototype._next=function(g){this.destination.next(g)},l.prototype._error=function(g){this.destination.error(g),this.unsubscribe()},l.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},l.prototype._unsubscribeAndRecycle=function(){var g=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.isStopped=this.closed=!1,this._parentOrParents=g,this},l}(Ta),Cr=function(h){function l(g,f,k,q){var _r=h.call(this)||this;if(_r._parentSubscriber=g,g=_r,ze(f))var _s=f;else f&&(_s=f.next,k=f.error,q=f.complete,f!==ci&&(ze((g=Object.create(f)).unsubscribe)&&_r.add(g.unsubscribe.bind(g)),g.unsubscribe=_r.unsubscribe.bind(_r)));return _r._context=g,_r._next=_s,_r._error=k,_r._complete=q,_r}return O(l,h),l.prototype.next=function(g){if(!this.isStopped&&this._next){var f=this._parentSubscriber;Mb.useDeprecatedSynchronousErrorHandling&&f.syncErrorThrowable?this.__tryOrSetError(f,this._next,g)&&this.unsubscribe():this.__tryOrUnsub(this._next,g)}},l.prototype.error=function(g){if(!this.isStopped){var f=this._parentSubscriber,k=Mb.useDeprecatedSynchronousErrorHandling;if(this._error)k&&f.syncErrorThrowable?this.__tryOrSetError(f,this._error,g):this.__tryOrUnsub(this._error,g),this.unsubscribe();else if(f.syncErrorThrowable)k?(f.syncErrorValue=g,f.syncErrorThrown=!0):Ae(g),this.unsubscribe();else{if(this.unsubscribe(),k)throw g;Ae(g)}}},l.prototype.complete=function(){var g=this;if(!this.isStopped){var f=this._parentSubscriber;if(this._complete){var k=function(){return g._complete.call(g._context)};Mb.useDeprecatedSynchronousErrorHandling&&f.syncErrorThrowable?this.__tryOrSetError(f,k):this.__tryOrUnsub(k)}this.unsubscribe()}},l.prototype.__tryOrUnsub=function(g,f){try{g.call(this._context,f)}catch(k){if(this.unsubscribe(),Mb.useDeprecatedSynchronousErrorHandling)throw k;Ae(k)}},l.prototype.__tryOrSetError=function(g,f,k){if(!Mb.useDeprecatedSynchronousErrorHandling)throw Error("bad call");try{f.call(this._context,k)}catch(q){return Mb.useDeprecatedSynchronousErrorHandling?(g.syncErrorValue=q,g.syncErrorThrown=!0):Ae(q),!0}return!1},l.prototype._unsubscribe=function(){var g=this._parentSubscriber;this._parentSubscriber=this._context=null,g.unsubscribe()},l}(ma),Be="function"==typeof Symbol&&Symbol.observable||"@@observable",Y=function(){function h(l){this._isScalar=!1,l&&(this._subscribe=l)}return h.prototype.lift=function(l){var g=new h;return g.source=this,g.operator=l,g},h.prototype.subscribe=function(l,g,f){var k=this.operator;e:{if(l){if(l instanceof ma)break e;if(l[di]){l=l[di]();break e}}l=l||g||f?new ma(l,g,f):new ma(ci)}if(l.add(k?k.call(l,this.source):this.source||Mb.useDeprecatedSynchronousErrorHandling&&!l.syncErrorThrowable?this._subscribe(l):this._trySubscribe(l)),Mb.useDeprecatedSynchronousErrorHandling&&l.syncErrorThrowable&&(l.syncErrorThrowable=!1,l.syncErrorThrown))throw l.syncErrorValue;return l},h.prototype._trySubscribe=function(l){try{return this._subscribe(l)}catch(g){Mb.useDeprecatedSynchronousErrorHandling&&(l.syncErrorThrown=!0,l.syncErrorValue=g),Ki(l)?l.error(g):console.warn(g)}},h.prototype.forEach=function(l,g){var f=this;return new(g=an(g))(function(k,q){var _r=f.subscribe(function(_s){try{l(_s)}catch(ga){q(ga),_r&&_r.unsubscribe()}},q,k)})},h.prototype._subscribe=function(l){var g=this.source;return g&&g.subscribe(l)},h.prototype[Be]=function(){return this},h.prototype.pipe=function(){for(var l=[],g=0;g<arguments.length;g++)l[g]=arguments[g];return 0===l.length?this:$m(l)(this)},h.prototype.toPromise=function(l){var g=this;return new(l=an(l))(function(f,k){var q;g.subscribe(function(_r){return q=_r},function(_r){return k(_r)},function(){return f(q)})})},h.create=function(l){return new h(l)},h}(),xd=function(){function h(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return h.prototype=Object.create(Error.prototype),h}(),Dr=function(h){function l(g,f){var k=h.call(this)||this;return k.subject=g,k.subscriber=f,k.closed=!1,k}return O(l,h),l.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var g=this.subject,f=g.observers;this.subject=null,!f||0===f.length||g.isStopped||g.closed||-1!==(g=f.indexOf(this.subscriber))&&f.splice(g,1)}},l}(Ta),Er=function(h){function l(g){var f=h.call(this,g)||this;return f.destination=g,f}return O(l,h),l}(ma),Ua=function(h){function l(){var g=h.call(this)||this;return g.observers=[],g.closed=!1,g.isStopped=!1,g.hasError=!1,g.thrownError=null,g}return O(l,h),l.prototype[di]=function(){return new Er(this)},l.prototype.lift=function(g){var f=new Fr(this,this);return f.operator=g,f},l.prototype.next=function(g){if(this.closed)throw new xd;if(!this.isStopped){var f=this.observers,k=f.length;f=f.slice();for(var q=0;q<k;q++)f[q].next(g)}},l.prototype.error=function(g){if(this.closed)throw new xd;this.hasError=!0,this.thrownError=g,this.isStopped=!0;var f=this.observers,k=f.length;f=f.slice();for(var q=0;q<k;q++)f[q].error(g);this.observers.length=0},l.prototype.complete=function(){if(this.closed)throw new xd;this.isStopped=!0;var g=this.observers,f=g.length;g=g.slice();for(var k=0;k<f;k++)g[k].complete();this.observers.length=0},l.prototype.unsubscribe=function(){this.closed=this.isStopped=!0,this.observers=null},l.prototype._trySubscribe=function(g){if(this.closed)throw new xd;return h.prototype._trySubscribe.call(this,g)},l.prototype._subscribe=function(g){if(this.closed)throw new xd;return this.hasError?(g.error(this.thrownError),Ta.EMPTY):this.isStopped?(g.complete(),Ta.EMPTY):(this.observers.push(g),new Dr(this,g))},l.prototype.asObservable=function(){var g=new Y;return g.source=this,g},l.create=function(g,f){return new Fr(g,f)},l}(Y),Fr=function(h){function l(g,f){var k=h.call(this)||this;return k.destination=g,k.source=f,k}return O(l,h),l.prototype.next=function(g){var f=this.destination;f&&f.next&&f.next(g)},l.prototype.error=function(g){var f=this.destination;f&&f.error&&this.destination.error(g)},l.prototype.complete=function(){var g=this.destination;g&&g.complete&&this.destination.complete()},l.prototype._subscribe=function(g){return this.source?this.source.subscribe(g):Ta.EMPTY},l}(Ua),Hu=function(){function h(l){this.connectable=l}return h.prototype.call=function(l,g){var f=this.connectable;return f._refCount++,l=new YA(l,f),g=g.subscribe(l),l.closed||(l.connection=f.connect()),g},h}(),YA=function(h){function l(g,f){return(g=h.call(this,g)||this).connectable=f,g}return O(l,h),l.prototype._unsubscribe=function(){var g=this.connectable;if(g){this.connectable=null;var f=g._refCount;0>=f?this.connection=null:(g._refCount=f-1,1<f?this.connection=null:(f=this.connection,g=g._connection,this.connection=null,!g||f&&g!==f||g.unsubscribe()))}else this.connection=null},l}(ma),Gr=function(h){function l(g,f){var k=h.call(this)||this;return k.source=g,k.subjectFactory=f,k._refCount=0,k._isComplete=!1,k}return O(l,h),l.prototype._subscribe=function(g){return this.getSubject().subscribe(g)},l.prototype.getSubject=function(){var g=this._subject;return g&&!g.isStopped||(this._subject=this.subjectFactory()),this._subject},l.prototype.connect=function(){var g=this._connection;return g||(this._isComplete=!1,(g=this._connection=new Ta).add(this.source.subscribe(new ZA(this.getSubject(),this))),g.closed&&(this._connection=null,g=Ta.EMPTY)),g},l.prototype.refCount=function(){return bn()(this)},l}(Y),uv=function(){var h=Gr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:h._subscribe},_isComplete:{value:h._isComplete,writable:!0},getSubject:{value:h.getSubject},connect:{value:h.connect},refCount:{value:h.refCount}}}(),ZA=function(h){function l(g,f){return(g=h.call(this,g)||this).connectable=f,g}return O(l,h),l.prototype._error=function(g){this._unsubscribe(),h.prototype._error.call(this,g)},l.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),h.prototype._complete.call(this)},l.prototype._unsubscribe=function(){var g=this.connectable;if(g){this.connectable=null;var f=g._connection;g._refCount=0,g._subject=null,g._connection=null,f&&f.unsubscribe()}},l}(Er);(function(h){function l(g,f){return(g=h.call(this,g)||this).connectable=f,g}O(l,h),l.prototype._unsubscribe=function(){var g=this.connectable;if(g){this.connectable=null;var f=g._refCount;0>=f?this.connection=null:(g._refCount=f-1,1<f?this.connection=null:(f=this.connection,g=g._connection,this.connection=null,!g||f&&g!==f||g.unsubscribe()))}else this.connection=null}})(ma),function(h){function l(g,f,k,q,_r){return(g=h.call(this,g)||this).keySelector=f,g.elementSelector=k,g.durationSelector=q,g.subjectSelector=_r,g.groups=null,g.attemptedToUnsubscribe=!1,g.count=0,g}O(l,h),l.prototype._next=function(g){try{var f=this.keySelector(g)}catch(k){return void this.error(k)}this._group(g,f)},l.prototype._group=function(g,f){var k=this.groups;k||(k=this.groups=new Map);var q=k.get(f);if(this.elementSelector)try{var _r=this.elementSelector(g)}catch(_s){this.error(_s)}else _r=g;if(!q&&(q=this.subjectSelector?this.subjectSelector():new Ua,k.set(f,q),g=new sl(f,q,this),this.destination.next(g),this.durationSelector)){g=void 0;try{g=this.durationSelector(new sl(f,q))}catch(_s){return void this.error(_s)}this.add(g.subscribe(new $A(f,q,this)))}q.closed||q.next(_r)},l.prototype._error=function(g){var f=this.groups;f&&(f.forEach(function(k,q){k.error(g)}),f.clear()),this.destination.error(g)},l.prototype._complete=function(){var g=this.groups;g&&(g.forEach(function(f,k){f.complete()}),g.clear()),this.destination.complete()},l.prototype.removeGroup=function(g){this.groups.delete(g)},l.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&h.prototype.unsubscribe.call(this))}}(ma);var $A=function(h){function l(g,f,k){var q=h.call(this,f)||this;return q.key=g,q.group=f,q.parent=k,q}return O(l,h),l.prototype._next=function(g){this.complete()},l.prototype._unsubscribe=function(){var g=this.parent,f=this.key;this.key=this.parent=null,g&&g.removeGroup(f)},l}(ma),sl=function(h){function l(g,f,k){var q=h.call(this)||this;return q.key=g,q.groupSubject=f,q.refCountSubscription=k,q}return O(l,h),l.prototype._subscribe=function(g){var f=new Ta,k=this.refCountSubscription,q=this.groupSubject;return k&&!k.closed&&f.add(new aB(k)),f.add(q.subscribe(g)),f},l}(Y),aB=function(h){function l(g){var f=h.call(this)||this;return f.parent=g,g.count++,f}return O(l,h),l.prototype.unsubscribe=function(){var g=this.parent;g.closed||this.closed||(h.prototype.unsubscribe.call(this),--g.count,0===g.count&&g.attemptedToUnsubscribe&&g.unsubscribe())},l}(Ta),bB=function(h){function l(g){var f=h.call(this)||this;return f._value=g,f}return O(l,h),Object.defineProperty(l.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),l.prototype._subscribe=function(g){var f=h.prototype._subscribe.call(this,g);return f&&!f.closed&&g.next(this._value),f},l.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new xd;return this._value},l.prototype.next=function(g){h.prototype.next.call(this,this._value=g)},l}(Ua),wg=function(h){function l(g,f){var k=h.call(this,g,f)||this;return k.scheduler=g,k.work=f,k.pending=!1,k}return O(l,h),l.prototype.schedule=function(g,f){if(void 0===f&&(f=0),this.closed)return this;this.state=g;var k=this.scheduler;return null!=(g=this.id)&&(this.id=this.recycleAsyncId(k,g,f)),this.pending=!0,this.delay=f,this.id=this.id||this.requestAsyncId(k,this.id,f),this},l.prototype.requestAsyncId=function(g,f,k){return void 0===k&&(k=0),setInterval(g.flush.bind(g,this),k)},l.prototype.recycleAsyncId=function(g,f,k){if(void 0===k&&(k=0),null!==k&&this.delay===k&&!1===this.pending)return f;clearInterval(f)},l.prototype.execute=function(g,f){return this.closed?Error("executing a cancelled action"):(this.pending=!1,(g=this._execute(g,f))?g:void(!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))))},l.prototype._execute=function(g,f){f=!1;var k=void 0;try{this.work(g)}catch(q){f=!0,k=!!q&&q||Error(q)}if(f)return this.unsubscribe(),k},l.prototype._unsubscribe=function(){var g=this.id,f=this.scheduler,k=f.actions,q=k.indexOf(this);this.state=this.work=null,this.pending=!1,this.scheduler=null,-1!==q&&k.splice(q,1),null!=g&&(this.id=this.recycleAsyncId(f,g,null)),this.delay=null},l}(function(h){function l(g,f){return h.call(this)||this}return O(l,h),l.prototype.schedule=function(g,f){return this},l}(Ta)),cB=function(h){function l(g,f){var k=h.call(this,g,f)||this;return k.scheduler=g,k.work=f,k}return O(l,h),l.prototype.schedule=function(g,f){return void 0===f&&(f=0),0<f?h.prototype.schedule.call(this,g,f):(this.delay=f,this.state=g,this.scheduler.flush(this),this)},l.prototype.execute=function(g,f){return 0<f||this.closed?h.prototype.execute.call(this,g,f):this._execute(g,f)},l.prototype.requestAsyncId=function(g,f,k){return void 0===k&&(k=0),null!==k&&0<k||null===k&&0<this.delay?h.prototype.requestAsyncId.call(this,g,f,k):g.flush(this)},l}(wg),tl=function(){function h(l,g){void 0===g&&(g=h.now),this.SchedulerAction=l,this.now=g}return h.prototype.schedule=function(l,g,f){return void 0===g&&(g=0),new this.SchedulerAction(this,l).schedule(f,g)},h.now=function(){return Date.now()},h}(),xg=function(h){function l(g,f){void 0===f&&(f=tl.now);var k=h.call(this,g,function(){return l.delegate&&l.delegate!==k?l.delegate.now():f()})||this;return k.actions=[],k.active=!1,k.scheduled=void 0,k}return O(l,h),l.prototype.schedule=function(g,f,k){return void 0===f&&(f=0),l.delegate&&l.delegate!==this?l.delegate.schedule(g,f,k):h.prototype.schedule.call(this,g,f,k)},l.prototype.flush=function(g){var f=this.actions;if(this.active)f.push(g);else{var k;this.active=!0;do{if(k=g.execute(g.state,g.delay))break}while(g=f.shift());if(this.active=!1,k){for(;g=f.shift();)g.unsubscribe();throw k}}},l}(tl),yg=new(function(h){function l(){return null!==h&&h.apply(this,arguments)||this}return O(l,h),l}(xg))(cB),yb=new Y(function(h){return h.complete()}),cn=function(h){return function(l){for(var g=0,f=h.length;g<f&&!l.closed;g++)l.next(h[g]);l.complete()}},ul;!function(h){h.NEXT="N",h.ERROR="E",h.COMPLETE="C"}(ul||(ul={}));var lf=function(){function h(l,g,f){this.kind=l,this.value=g,this.error=f,this.hasValue="N"===l}return h.prototype.observe=function(l){switch(this.kind){case"N":return l.next&&l.next(this.value);case"E":return l.error&&l.error(this.error);case"C":return l.complete&&l.complete()}},h.prototype.do=function(l,g,f){switch(this.kind){case"N":return l&&l(this.value);case"E":return g&&g(this.error);case"C":return f&&f()}},h.prototype.accept=function(l,g,f){return l&&"function"==typeof l.next?this.observe(l):this.do(l,g,f)},h.prototype.toObservable=function(){switch(this.kind){case"N":return eb(this.value);case"E":return Z(this.error);case"C":return Ef()}throw Error("unexpected notification kind value")},h.createNext=function(l){return void 0!==l?new h("N",l):h.undefinedValueNotification},h.createError=function(l){return new h("E",void 0,l)},h.createComplete=function(){return h.completeNotification},h.completeNotification=new h("C"),h.undefinedValueNotification=new h("N",void 0),h}(),Lu=function(){function h(l,g){void 0===g&&(g=0),this.scheduler=l,this.delay=g}return h.prototype.call=function(l,g){return g.subscribe(new Hr(l,this.scheduler,this.delay))},h}(),Hr=function(h){function l(g,f,k){return void 0===k&&(k=0),(g=h.call(this,g)||this).scheduler=f,g.delay=k,g}return O(l,h),l.dispatch=function(g){g.notification.observe(g.destination),this.unsubscribe()},l.prototype.scheduleMessage=function(g){this.destination.add(this.scheduler.schedule(l.dispatch,this.delay,new dB(g,this.destination)))},l.prototype._next=function(g){this.scheduleMessage(lf.createNext(g))},l.prototype._error=function(g){this.scheduleMessage(lf.createError(g)),this.unsubscribe()},l.prototype._complete=function(){this.scheduleMessage(lf.createComplete()),this.unsubscribe()},l}(ma),dB=function(h,l){this.notification=h,this.destination=l},Ee=function(h){function l(g,f,k){void 0===g&&(g=Number.POSITIVE_INFINITY),void 0===f&&(f=Number.POSITIVE_INFINITY);var q=h.call(this)||this;return q.scheduler=k,q._events=[],q._infiniteTimeWindow=!1,q._bufferSize=1>g?1:g,q._windowTime=1>f?1:f,f===Number.POSITIVE_INFINITY?(q._infiniteTimeWindow=!0,q.next=q.nextInfiniteTimeWindow):q.next=q.nextTimeWindow,q}return O(l,h),l.prototype.nextInfiniteTimeWindow=function(g){if(!this.isStopped){var f=this._events;f.push(g),f.length>this._bufferSize&&f.shift()}h.prototype.next.call(this,g)},l.prototype.nextTimeWindow=function(g){this.isStopped||(this._events.push(new eB(this._getNow(),g)),this._trimBufferThenGetEvents()),h.prototype.next.call(this,g)},l.prototype._subscribe=function(g){var f=this._infiniteTimeWindow,k=f?this._events:this._trimBufferThenGetEvents(),q=this.scheduler,_r=k.length;if(this.closed)throw new xd;if(this.isStopped||this.hasError)var _s=Ta.EMPTY;else this.observers.push(g),_s=new Dr(this,g);if(q&&g.add(g=new Hr(g,q)),f)for(f=0;f<_r&&!g.closed;f++)g.next(k[f]);else for(f=0;f<_r&&!g.closed;f++)g.next(k[f].value);return this.hasError?g.error(this.thrownError):this.isStopped&&g.complete(),_s},l.prototype._getNow=function(){return(this.scheduler||yg).now()},l.prototype._trimBufferThenGetEvents=function(){for(var g=this._getNow(),f=this._bufferSize,k=this._windowTime,q=this._events,_r=q.length,_s=0;_s<_r&&!(g-q[_s].time<k);)_s++;return _r>f&&(_s=Math.max(_s,_r-f)),0<_s&&q.splice(0,_s),q},l}(Ua),eB=function(h,l){this.time=h,this.value=l},Gf=function(h){function l(){var g=null!==h&&h.apply(this,arguments)||this;return g.value=null,g.hasNext=!1,g.hasCompleted=!1,g}return O(l,h),l.prototype._subscribe=function(g){return this.hasError?(g.error(this.thrownError),Ta.EMPTY):this.hasCompleted&&this.hasNext?(g.next(this.value),g.complete(),Ta.EMPTY):h.prototype._subscribe.call(this,g)},l.prototype.next=function(g){this.hasCompleted||(this.value=g,this.hasNext=!0)},l.prototype.error=function(g){this.hasCompleted||h.prototype.error.call(this,g)},l.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&h.prototype.next.call(this,this.value),h.prototype.complete.call(this)},l}(Ua),fB=1,gB=Promise.resolve(),Ni={},Ir={setImmediate:function(h){var l=fB++;return Ni[l]=!0,gB.then(function(){return dn(l)&&h()}),l},clearImmediate:function(h){dn(h)}},hB=function(h){function l(g,f){var k=h.call(this,g,f)||this;return k.scheduler=g,k.work=f,k}return O(l,h),l.prototype.requestAsyncId=function(g,f,k){return void 0===k&&(k=0),null!==k&&0<k?h.prototype.requestAsyncId.call(this,g,f,k):(g.actions.push(this),g.scheduled||(g.scheduled=Ir.setImmediate(g.flush.bind(g,null))))},l.prototype.recycleAsyncId=function(g,f,k){if(void 0===k&&(k=0),null!==k&&0<k||null===k&&0<this.delay)return h.prototype.recycleAsyncId.call(this,g,f,k);0===g.actions.length&&(Ir.clearImmediate(f),g.scheduled=void 0)},l}(wg),Xi=new(function(h){function l(){return null!==h&&h.apply(this,arguments)||this}return O(l,h),l.prototype.flush=function(g){this.active=!0,this.scheduled=void 0;var f,k=this.actions,q=-1,_r=k.length;g=g||k.shift();do{if(f=g.execute(g.state,g.delay))break}while(++q<_r&&(g=k.shift()));if(this.active=!1,f){for(;++q<_r&&(g=k.shift());)g.unsubscribe();throw f}},l}(xg))(hB),iB=Xi,vl=new xg(wg),id=vl,jB=function(h){function l(g,f){var k=h.call(this,g,f)||this;return k.scheduler=g,k.work=f,k}return O(l,h),l.prototype.requestAsyncId=function(g,f,k){return void 0===k&&(k=0),null!==k&&0<k?h.prototype.requestAsyncId.call(this,g,f,k):(g.actions.push(this),g.scheduled||(g.scheduled=requestAnimationFrame(function(){return g.flush(null)})))},l.prototype.recycleAsyncId=function(g,f,k){if(void 0===k&&(k=0),null!==k&&0<k||null===k&&0<this.delay)return h.prototype.recycleAsyncId.call(this,g,f,k);0===g.actions.length&&(cancelAnimationFrame(f),g.scheduled=void 0)},l}(wg),Jr=new(function(h){function l(){return null!==h&&h.apply(this,arguments)||this}return O(l,h),l.prototype.flush=function(g){this.active=!0,this.scheduled=void 0;var f,k=this.actions,q=-1,_r=k.length;g=g||k.shift();do{if(f=g.execute(g.state,g.delay))break}while(++q<_r&&(g=k.shift()));if(this.active=!1,f){for(;++q<_r&&(g=k.shift());)g.unsubscribe();throw f}},l}(xg))(jB),kB=function(h){function l(g,f){void 0===g&&(g=Kr),void 0===f&&(f=Number.POSITIVE_INFINITY);var k=h.call(this,g,function(){return k.frame})||this;return k.maxFrames=f,k.frame=0,k.index=-1,k}return O(l,h),l.prototype.flush=function(){for(var g,f,k=this.actions,q=this.maxFrames;(f=k[0])&&f.delay<=q&&(k.shift(),this.frame=f.delay,!(g=f.execute(f.state,f.delay))););if(g){for(;f=k.shift();)f.unsubscribe();throw g}},l.frameTimeFactor=10,l}(xg),Kr=function(h){function l(g,f,k){void 0===k&&(k=g.index+=1);var q=h.call(this,g,f)||this;return q.scheduler=g,q.work=f,q.index=k,q.active=!0,q.index=g.index=k,q}return O(l,h),l.prototype.schedule=function(g,f){if(void 0===f&&(f=0),!this.id)return h.prototype.schedule.call(this,g,f);this.active=!1;var k=new l(this.scheduler,this.work);return this.add(k),k.schedule(g,f)},l.prototype.requestAsyncId=function(g,f,k){return void 0===k&&(k=0),this.delay=g.frame+k,(g=g.actions).push(this),g.sort(l.sortActions),!0},l.prototype.recycleAsyncId=function(g,f,k){},l.prototype._execute=function(g,f){if(!0===this.active)return h.prototype._execute.call(this,g,f)},l.sortActions=function(g,f){return g.delay===f.delay?g.index===f.index?0:g.index>f.index?1:-1:g.delay>f.delay?1:-1},l}(wg),wl=function(){function h(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return h.prototype=Object.create(Error.prototype),h}(),Sg=function(){function h(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return h.prototype=Object.create(Error.prototype),h}(),sb=function(){function h(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return h.prototype=Object.create(Error.prototype),h}(),Mu=function(){function h(l,g){this.project=l,this.thisArg=g}return h.prototype.call=function(l,g){return g.subscribe(new lB(l,this.project,this.thisArg))},h}(),lB=function(h){function l(g,f,k){return(g=h.call(this,g)||this).project=f,g.count=0,g.thisArg=k||g,g}return O(l,h),l.prototype._next=function(g){try{var f=this.project.call(this.thisArg,g,this.count++)}catch(k){return void this.destination.error(k)}this.destination.next(f)},l}(ma),xl=function(h){function l(){return null!==h&&h.apply(this,arguments)||this}return O(l,h),l.prototype.notifyNext=function(g,f,k,q,_r){this.destination.next(f)},l.prototype.notifyError=function(g,f){this.destination.error(g)},l.prototype.notifyComplete=function(g){this.destination.complete()},l}(ma),Ru=function(h){function l(g,f,k){var q=h.call(this)||this;return q.parent=g,q.outerValue=f,q.outerIndex=k,q.index=0,q}return O(l,h),l.prototype._next=function(g){this.parent.notifyNext(this.outerValue,g,this.outerIndex,this.index++,this)},l.prototype._error=function(g){this.parent.notifyError(g,this),this.unsubscribe()},l.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},l}(ma),mB=function(h){return function(l){return h.then(function(g){l.closed||(l.next(g),l.complete())},function(g){return l.error(g)}).then(null,Ae),l}},gd="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",nB=function(h){return function(l){for(var g=h[gd]();;){var f=void 0;try{f=g.next()}catch(k){return l.error(k),l}if(f.done){l.complete();break}if(l.next(f.value),l.closed)break}return"function"==typeof g.return&&l.add(function(){g.return&&g.return()}),l}},oB=function(h){return function(l){var g=h[Be]();if("function"!=typeof g.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return g.subscribe(l)}},kn=function(h){return h&&"number"==typeof h.length&&"function"!=typeof h},Hf=function(h){if(h&&"function"==typeof h[Be])return oB(h);if(kn(h))return cn(h);if(hn(h))return mB(h);if(h&&"function"==typeof h[gd])return nB(h);throw h=Ji(h)?"an invalid object":"'"+h+"'",new TypeError("You provided "+h+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},Lr={},qB=function(){function h(l){this.resultSelector=l}return h.prototype.call=function(l,g){return g.subscribe(new pB(l,this.resultSelector))},h}(),pB=function(h){function l(g,f){return(g=h.call(this,g)||this).resultSelector=f,g.active=0,g.values=[],g.observables=[],g}return O(l,h),l.prototype._next=function(g){this.values.push(Lr),this.observables.push(g)},l.prototype._complete=function(){var g=this.observables,f=g.length;if(0===f)this.destination.complete();else{this.toRespond=this.active=f;for(var k=0;k<f;k++)this.add(Oi(this,g[k],void 0,k))}},l.prototype.notifyComplete=function(g){0==--this.active&&this.destination.complete()},l.prototype.notifyNext=function(g,f,k){var q=(g=this.values)[k];q=this.toRespond?q===Lr?--this.toRespond:this.toRespond:0,g[k]=f,0===q&&(this.resultSelector?this._tryResultSelector(g):this.destination.next(g.slice()))},l.prototype._tryResultSelector=function(g){try{var f=this.resultSelector.apply(this,g)}catch(k){return void this.destination.error(k)}this.destination.next(f)},l}(xl),Cc=function(h){function l(g){var f=h.call(this)||this;return f.parent=g,f}return O(l,h),l.prototype._next=function(g){this.parent.notifyNext(g)},l.prototype._error=function(g){this.parent.notifyError(g),this.unsubscribe()},l.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},l}(ma);!function(h){function l(g,f,k){var q=h.call(this)||this;return q.parent=g,q.outerValue=f,q.outerIndex=k,q}O(l,h),l.prototype._next=function(g){this.parent.notifyNext(this.outerValue,g,this.outerIndex,this)},l.prototype._error=function(g){this.parent.notifyError(g),this.unsubscribe()},l.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()}}(ma);var Dc=function(h){function l(){return null!==h&&h.apply(this,arguments)||this}return O(l,h),l.prototype.notifyNext=function(g){this.destination.next(g)},l.prototype.notifyError=function(g){this.destination.error(g)},l.prototype.notifyComplete=function(){this.destination.complete()},l}(ma);!function(h){function l(){return null!==h&&h.apply(this,arguments)||this}O(l,h),l.prototype.notifyNext=function(g,f,k,q){this.destination.next(f)},l.prototype.notifyError=function(g){this.destination.error(g)},l.prototype.notifyComplete=function(g){this.destination.complete()}}(ma);var Vu=function(){function h(l,g){void 0===g&&(g=Number.POSITIVE_INFINITY),this.project=l,this.concurrent=g}return h.prototype.call=function(l,g){return g.subscribe(new rB(l,this.project,this.concurrent))},h}(),rB=function(h){function l(g,f,k){return void 0===k&&(k=Number.POSITIVE_INFINITY),(g=h.call(this,g)||this).project=f,g.concurrent=k,g.hasCompleted=!1,g.buffer=[],g.active=0,g.index=0,g}return O(l,h),l.prototype._next=function(g){this.active<this.concurrent?this._tryNext(g):this.buffer.push(g)},l.prototype._tryNext=function(g){var f=this.index++;try{var k=this.project(g,f)}catch(q){return void this.destination.error(q)}this.active++,this._innerSub(k)},l.prototype._innerSub=function(g){var f=new Cc(this),k=this.destination;k.add(f),(g=qc(g,f))!==f&&k.add(g)},l.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},l.prototype.notifyNext=function(g){this.destination.next(g)},l.prototype.notifyComplete=function(){var g=this.buffer;this.active--,0<g.length?this._next(g.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},l}(Dc),yl=C.parseFloat,Mr=-1/0!=1/yl("\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff-0")?function(h){h=Ij(String(h));var l=yl(h);return 0===l&&"-"==h.charAt(0)?-0:l}:yl;M({global:!0,forced:parseFloat!=Mr},{parseFloat:Mr});var zl=new Y(pc),$u=function(){function h(l,g){this.predicate=l,this.thisArg=g}return h.prototype.call=function(l,g){return g.subscribe(new sB(l,this.predicate,this.thisArg))},h}(),sB=function(h){function l(g,f,k){return(g=h.call(this,g)||this).predicate=f,g.thisArg=k,g.count=0,g}return O(l,h),l.prototype._next=function(g){try{var f=this.predicate.call(this.thisArg,g,this.count++)}catch(k){return void this.destination.error(k)}f&&this.destination.next(g)},l}(ma),av=function(){function h(){}return h.prototype.call=function(l,g){return g.subscribe(new tB(l))},h}(),tB=function(h){function l(g){return(g=h.call(this,g)||this).hasFirst=!1,g.observables=[],g.subscriptions=[],g}return O(l,h),l.prototype._next=function(g){this.observables.push(g)},l.prototype._complete=function(){var g=this.observables,f=g.length;if(0===f)this.destination.complete();else{for(var k=0;k<f&&!this.hasFirst;k++){var q=Oi(this,g[k],void 0,k);this.subscriptions&&this.subscriptions.push(q),this.add(q)}this.observables=null}},l.prototype.notifyNext=function(g,f,k){if(!this.hasFirst){for(this.hasFirst=!0,g=0;g<this.subscriptions.length;g++)if(g!==k){var q=this.subscriptions[g];q.unsubscribe(),this.remove(q)}this.subscriptions=null}this.destination.next(f)},l}(xl),dv=function(){function h(l){this.resultSelector=l}return h.prototype.call=function(l,g){return g.subscribe(new uB(l,this.resultSelector))},h}(),uB=function(h){function l(g,f,k){return(g=h.call(this,g)||this).resultSelector=f,g.iterators=[],g.active=0,g.resultSelector="function"==typeof f?f:void 0,g}return O(l,h),l.prototype._next=function(g){var f=this.iterators;Nb(g)?f.push(new vB(g)):f.push("function"==typeof g[gd]?new wB(g[gd]()):new xB(this.destination,this,g))},l.prototype._complete=function(){var g=this.iterators,f=g.length;if(this.unsubscribe(),0===f)this.destination.complete();else{this.active=f;for(var k=0;k<f;k++){var q=g[k];q.stillUnsubscribed?this.destination.add(q.subscribe()):this.active--}}},l.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},l.prototype.checkIterators=function(){for(var g=this.iterators,f=g.length,k=this.destination,q=0;q<f;q++){var _r=g[q];if("function"==typeof _r.hasValue&&!_r.hasValue())return}var _s=!1,ga=[];for(q=0;q<f;q++){var _l=(_r=g[q]).next();if(_r.hasCompleted()&&(_s=!0),_l.done)return void k.complete();ga.push(_l.value)}this.resultSelector?this._tryresultSelector(ga):k.next(ga),_s&&k.complete()},l.prototype._tryresultSelector=function(g){try{var f=this.resultSelector.apply(this,g)}catch(k){return void this.destination.error(k)}this.destination.next(f)},l}(ma),wB=function(){function h(l){this.iterator=l,this.nextResult=l.next()}return h.prototype.hasValue=function(){return!0},h.prototype.next=function(){var l=this.nextResult;return this.nextResult=this.iterator.next(),l},h.prototype.hasCompleted=function(){var l=this.nextResult;return!(!l||!l.done)},h}(),vB=function(){function h(l){this.array=l,this.length=this.index=0,this.length=l.length}return h.prototype[gd]=function(){return this},h.prototype.next=function(l){return(l=this.index++)<this.length?{value:this.array[l],done:!1}:{value:null,done:!0}},h.prototype.hasValue=function(){return this.array.length>this.index},h.prototype.hasCompleted=function(){return this.array.length===this.index},h}(),xB=function(h){function l(g,f,k){return(g=h.call(this,g)||this).parent=f,g.observable=k,g.stillUnsubscribed=!0,g.buffer=[],g.isComplete=!1,g}return O(l,h),l.prototype[gd]=function(){return this},l.prototype.next=function(){var g=this.buffer;return 0===g.length&&this.isComplete?{value:null,done:!0}:{value:g.shift(),done:!1}},l.prototype.hasValue=function(){return 0<this.buffer.length},l.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},l.prototype.notifyComplete=function(){0<this.buffer.length?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},l.prototype.notifyNext=function(g){this.buffer.push(g),this.parent.checkIterators()},l.prototype.subscribe=function(){return qc(this.observable,new Cc(this))},l}(Dc),yB=Object.freeze({__proto__:null,Observable:Y,ConnectableObservable:Gr,GroupedObservable:sl,observable:Be,Subject:Ua,BehaviorSubject:bB,ReplaySubject:Ee,AsyncSubject:Gf,asap:iB,asapScheduler:Xi,async:id,asyncScheduler:vl,queue:yg,queueScheduler:yg,animationFrame:Jr,animationFrameScheduler:Jr,VirtualTimeScheduler:kB,VirtualAction:Kr,Scheduler:tl,Subscription:Ta,Subscriber:ma,Notification:lf,get NotificationKind(){return ul},pipe:Li,noop:pc,identity:ed,isObservable:function(h){return!!h&&(h instanceof Y||"function"==typeof h.lift&&"function"==typeof h.subscribe)},ArgumentOutOfRangeError:wl,EmptyError:Sg,ObjectUnsubscribedError:xd,UnsubscriptionError:Df,TimeoutError:sb,bindCallback:en,bindNodeCallback:fn,combineLatest:function(){for(var h=[],l=0;l<arguments.length;l++)h[l]=arguments[l];var g=l=void 0;return fd(h[h.length-1])&&(g=h.pop()),"function"==typeof h[h.length-1]&&(l=h.pop()),1===h.length&&Nb(h[0])&&(h=h[0]),Ff(h,g).lift(new qB(l))},concat:ln,defer:hd,empty:Ef,forkJoin:mn,from:Ob,fromEvent:jb,fromEventPattern:on,generate:function(h,l,g,f,k){if(1==arguments.length){var q=h.initialState;l=h.condition,g=h.iterate;var _r=h.resultSelector||ed;k=h.scheduler}else void 0===f||fd(f)?(q=h,_r=ed,k=f):(q=h,_r=f);return new Y(function(_s){var ga=q;if(k)return k.schedule(Wu,0,{subscriber:_s,iterate:g,condition:l,resultSelector:_r,state:ga});for(;;){if(l){var _l=void 0;try{_l=l(ga)}catch(bh){_s.error(bh);break}if(!_l){_s.complete();break}}_l=void 0;try{_l=_r(ga)}catch(bh){_s.error(bh);break}if(_s.next(_l),_s.closed)break;try{ga=g(ga)}catch(bh){_s.error(bh);break}}})},iif:function(h,l,g){return void 0===l&&(l=yb),void 0===g&&(g=yb),hd(function(){return h()?l:g})},interval:pn,merge:cc,never:function(){return zl},of:eb,onErrorResumeNext:Qi,pairs:function(h,l){return new Y(l?function(g){var f=Object.keys(h),k=new Ta;return k.add(l.schedule(Yu,0,{keys:f,index:0,subscriber:g,subscription:k,obj:h})),k}:function(g){for(var f=Object.keys(h),k=0;k<f.length&&!g.closed;k++){var q=f[k];h.hasOwnProperty(q)&&g.next([q,h[q]])}g.complete()})},partition:function(h,l,g){return[zb(l,g)(new Y(Hf(h))),zb(Zu(l,g))(new Y(Hf(h)))]},race:Da,range:function(h,l,g){return void 0===h&&(h=0),new Y(function(f){void 0===l&&(l=h,h=0);var k=0,q=h;if(g)return g.schedule(bv,0,{index:k,count:l,start:h,subscriber:f});for(;;){if(k++>=l){f.complete();break}if(f.next(q++),f.closed)break}})},throwError:Z,timer:Kc,using:function(h,l){return new Y(function(g){try{var f=h()}catch(_r){return void g.error(_r)}try{var k=l(f)}catch(_r){return void g.error(_r)}var q=(k?Ob(k):yb).subscribe(g);return function(){q.unsubscribe(),f&&f.unsubscribe()}})},zip:Ri,scheduled:jn,EMPTY:yb,NEVER:zl,config:Mb}),ev=function(){function h(l){this.selector=l}return h.prototype.call=function(l,g){return g.subscribe(new zB(l,this.selector,this.caught))},h}(),zB=function(h){function l(g,f,k){return(g=h.call(this,g)||this).selector=f,g.caught=k,g}return O(l,h),l.prototype.error=function(g){if(!this.isStopped){var f=void 0;try{f=this.selector(g,this.caught)}catch(k){return void h.prototype.error.call(this,k)}this._unsubscribeAndRecycle(),g=new Cc(this),this.add(g),(f=qc(f,g))!==g&&this.add(f)}},l}(Dc),fv=function(){function h(l){this.defaultValue=l}return h.prototype.call=function(l,g){return g.subscribe(new AB(l,this.defaultValue))},h}(),AB=function(h){function l(g,f){return(g=h.call(this,g)||this).defaultValue=f,g.isEmpty=!0,g}return O(l,h),l.prototype._next=function(g){this.isEmpty=!1,this.destination.next(g)},l.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},l}(ma),gv=function(){function h(l,g){this.delay=l,this.scheduler=g}return h.prototype.call=function(l,g){return g.subscribe(new BB(l,this.delay,this.scheduler))},h}(),BB=function(h){function l(g,f,k){return(g=h.call(this,g)||this).delay=f,g.scheduler=k,g.queue=[],g.active=!1,g.errored=!1,g}return O(l,h),l.dispatch=function(g){for(var f=g.source,k=f.queue,q=g.scheduler,_r=g.destination;0<k.length&&0>=k[0].time-q.now();)k.shift().notification.observe(_r);0<k.length?(f=Math.max(0,k[0].time-q.now()),this.schedule(g,f)):(this.unsubscribe(),f.active=!1)},l.prototype._schedule=function(g){this.active=!0,this.destination.add(g.schedule(l.dispatch,this.delay,{source:this,destination:this.destination,scheduler:g}))},l.prototype.scheduleNotification=function(g){if(!0!==this.errored){var f=this.scheduler;g=new CB(f.now()+this.delay,g),this.queue.push(g),!1===this.active&&this._schedule(f)}},l.prototype._next=function(g){this.scheduleNotification(lf.createNext(g))},l.prototype._error=function(g){this.errored=!0,this.queue=[],this.destination.error(g),this.unsubscribe()},l.prototype._complete=function(){this.scheduleNotification(lf.createComplete()),this.unsubscribe()},l}(ma),CB=function(h,l){this.time=h,this.notification=l},hv=function(){function h(l,g){this.keySelector=l,this.flushes=g}return h.prototype.call=function(l,g){return g.subscribe(new DB(l,this.keySelector,this.flushes))},h}(),DB=function(h){function l(g,f,k){return(g=h.call(this,g)||this).keySelector=f,g.values=new Set,k&&g.add(qc(k,new Cc(g))),g}return O(l,h),l.prototype.notifyNext=function(){this.values.clear()},l.prototype.notifyError=function(g){this._error(g)},l.prototype._next=function(g){this.keySelector?this._useKeySelector(g):this._finalizeNext(g,g)},l.prototype._useKeySelector=function(g){var f=this.destination;try{var k=this.keySelector(g)}catch(q){return void f.error(q)}this._finalizeNext(k,g)},l.prototype._finalizeNext=function(g,f){var k=this.values;k.has(g)||(k.add(g),this.destination.next(f))},l}(Dc),jv=function(){function h(l){this.errorFactory=l}return h.prototype.call=function(l,g){return g.subscribe(new EB(l,this.errorFactory))},h}(),EB=function(h){function l(g,f){return(g=h.call(this,g)||this).errorFactory=f,g.hasValue=!1,g}return O(l,h),l.prototype._next=function(g){this.hasValue=!0,this.destination.next(g)},l.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var g=void 0;try{g=this.errorFactory()}catch(f){g=f}this.destination.error(g)},l}(ma),kv=function(){function h(l){if(this.total=l,0>this.total)throw new wl}return h.prototype.call=function(l,g){return g.subscribe(new FB(l,this.total))},h}(),FB=function(h){function l(g,f){return(g=h.call(this,g)||this).total=f,g.count=0,g}return O(l,h),l.prototype._next=function(g){var f=this.total,k=++this.count;k<=f&&(this.destination.next(g),k===f&&(this.destination.complete(),this.unsubscribe()))},l}(ma),lv=function(){function h(l){this.project=l}return h.prototype.call=function(l,g){return g.subscribe(new GB(l,this.project))},h}(),GB=function(h){function l(g,f){return(g=h.call(this,g)||this).project=f,g.hasSubscription=!1,g.hasCompleted=!1,g.index=0,g}return O(l,h),l.prototype._next=function(g){this.hasSubscription||this.tryNext(g)},l.prototype.tryNext=function(g){var f=this.index++;try{var k=this.project(g,f)}catch(q){return void this.destination.error(q)}this.hasSubscription=!0,this._innerSub(k)},l.prototype._innerSub=function(g){var f=new Cc(this),k=this.destination;k.add(f),(g=qc(g,f))!==f&&k.add(g)},l.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},l.prototype.notifyNext=function(g){this.destination.next(g)},l.prototype.notifyError=function(g){this.destination.error(g)},l.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},l}(Dc),mv=function(){function h(l){this.callback=l}return h.prototype.call=function(l,g){return g.subscribe(new HB(l,this.callback))},h}(),HB=function(h){function l(g,f){return(g=h.call(this,g)||this).add(new Ta(f)),g}return O(l,h),l}(ma),ov=function(){function h(){}return h.prototype.call=function(l,g){return g.subscribe(new IB(l))},h}(),IB=function(h){function l(){return null!==h&&h.apply(this,arguments)||this}return O(l,h),l.prototype._next=function(g){},l}(ma),pv=function(){function h(l){if(this.total=l,0>this.total)throw new wl}return h.prototype.call=function(l,g){return g.subscribe(new JB(l,this.total))},h}(),JB=function(h){function l(g,f){return(g=h.call(this,g)||this).total=f,g.ring=[],g.count=0,g}return O(l,h),l.prototype._next=function(g){var f=this.ring,k=this.total,q=this.count++;f.length<k?f.push(g):f[q%k]=g},l.prototype._complete=function(){var g=this.destination,f=this.count;if(0<f)for(var k=this.count>=this.total?this.total:this.count,q=this.ring,_r=0;_r<k;_r++){var _s=f++%k;g.next(q[_s])}g.complete()},l}(ma),qv=function(){function h(l){this.value=l}return h.prototype.call=function(l,g){return g.subscribe(new KB(l,this.value))},h}(),KB=function(h){function l(g,f){return(g=h.call(this,g)||this).value=f,g}return O(l,h),l.prototype._next=function(g){this.destination.next(this.value)},l}(ma),rv=function(){function h(l,g,f){void 0===f&&(f=!1),this.accumulator=l,this.seed=g,this.hasSeed=f}return h.prototype.call=function(l,g){return g.subscribe(new LB(l,this.accumulator,this.seed,this.hasSeed))},h}(),LB=function(h){function l(g,f,k,q){return(g=h.call(this,g)||this).accumulator=f,g._seed=k,g.hasSeed=q,g.index=0,g}return O(l,h),Object.defineProperty(l.prototype,"seed",{get:function(){return this._seed},set:function(g){this.hasSeed=!0,this._seed=g},enumerable:!0,configurable:!0}),l.prototype._next=function(g){if(this.hasSeed)return this._tryNext(g);this.seed=g,this.destination.next(g)},l.prototype._tryNext=function(g){var f=this.index++;try{var k=this.accumulator(this.seed,g,f)}catch(q){this.destination.error(q)}this.seed=k,this.destination.next(k)},l}(ma),tv=function(){function h(l,g){this.subjectFactory=l,this.selector=g}return h.prototype.call=function(l,g){var f=this.selector,k=this.subjectFactory();return(l=f(k).subscribe(l)).add(g.subscribe(k)),l},h}(),vv=function(){function h(l,g){this.notifier=l,this.source=g}return h.prototype.call=function(l,g){return g.subscribe(new MB(l,this.notifier,this.source))},h}(),MB=function(h){function l(g,f,k){return(g=h.call(this,g)||this).notifier=f,g.source=k,g}return O(l,h),l.prototype.error=function(g){if(!this.isStopped){var f=this.errors,k=this.retries,q=this.retriesSubscription;if(k)this.retriesSubscription=this.errors=void 0;else{f=new Ua;try{k=(0,this.notifier)(f)}catch(_r){return h.prototype.error.call(this,_r)}q=qc(k,new Cc(this))}this._unsubscribeAndRecycle(),this.errors=f,this.retries=k,this.retriesSubscription=q,f.next(g)}},l.prototype._unsubscribe=function(){var g=this.errors,f=this.retriesSubscription;g&&(g.unsubscribe(),this.errors=void 0),f&&(f.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},l.prototype.notifyNext=function(){var g=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=g,this.source.subscribe(this)},l}(Dc),yv=function(){function h(l){this.project=l}return h.prototype.call=function(l,g){return g.subscribe(new NB(l,this.project))},h}(),NB=function(h){function l(g,f){return(g=h.call(this,g)||this).project=f,g.index=0,g}return O(l,h),l.prototype._next=function(g){var f=this.index++;try{var k=this.project(g,f)}catch(q){return void this.destination.error(q)}this._innerSub(k)},l.prototype._innerSub=function(g){var f=this.innerSubscription;f&&f.unsubscribe(),f=new Cc(this);var k=this.destination;k.add(f),this.innerSubscription=qc(g,f),this.innerSubscription!==f&&k.add(this.innerSubscription)},l.prototype._complete=function(){var g=this.innerSubscription;g&&!g.closed||h.prototype._complete.call(this),this.unsubscribe()},l.prototype._unsubscribe=function(){this.innerSubscription=void 0},l.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&h.prototype._complete.call(this)},l.prototype.notifyNext=function(g){this.destination.next(g)},l}(Dc),zv=function(){function h(l){this.notifier=l}return h.prototype.call=function(l,g){l=new OB(l);var f=qc(this.notifier,new Cc(l));return f&&!l.seenValue?(l.add(f),g.subscribe(l)):l},h}(),OB=function(h){function l(g){return(g=h.call(this,g)||this).seenValue=!1,g}return O(l,h),l.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},l.prototype.notifyComplete=function(){},l}(Dc),Bv=function(){function h(l,g){this.predicate=l,this.inclusive=g}return h.prototype.call=function(l,g){return g.subscribe(new PB(l,this.predicate,this.inclusive))},h}(),PB=function(h){function l(g,f,k){return(g=h.call(this,g)||this).predicate=f,g.inclusive=k,g.index=0,g}return O(l,h),l.prototype._next=function(g){var f=this.destination;try{var k=this.predicate(g,this.index++)}catch(q){return void f.error(q)}this.nextOrComplete(g,k)},l.prototype.nextOrComplete=function(g,f){var k=this.destination;f?k.next(g):(this.inclusive&&k.next(g),k.complete())},l}(ma),Cv=function(){function h(l,g,f){this.nextOrObserver=l,this.error=g,this.complete=f}return h.prototype.call=function(l,g){return g.subscribe(new QB(l,this.nextOrObserver,this.error,this.complete))},h}(),QB=function(h){function l(g,f,k,q){return(g=h.call(this,g)||this)._tapNext=pc,g._tapError=pc,g._tapComplete=pc,g._tapError=k||pc,g._tapComplete=q||pc,ze(f)?(g._context=g,g._tapNext=f):f&&(g._context=f,g._tapNext=f.next||pc,g._tapError=f.error||pc,g._tapComplete=f.complete||pc),g}return O(l,h),l.prototype._next=function(g){try{this._tapNext.call(this._context,g)}catch(f){return void this.destination.error(f)}this.destination.next(g)},l.prototype._error=function(g){try{this._tapError.call(this._context,g)}catch(f){return void this.destination.error(f)}this.destination.error(g)},l.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(g){return void this.destination.error(g)}return this.destination.complete()},l}(ma),Ev={leading:!0,trailing:!1};!function(h){function l(g,f,k,q){var _r=h.call(this,g)||this;return _r.destination=g,_r.durationSelector=f,_r._leading=k,_r._trailing=q,_r._hasValue=!1,_r}O(l,h),l.prototype._next=function(g){this._hasValue=!0,this._sendValue=g,this._throttled||(this._leading?this.send():this.throttle(g))},l.prototype.send=function(){var g=this._sendValue;this._hasValue&&(this.destination.next(g),this.throttle(g)),this._hasValue=!1,this._sendValue=void 0},l.prototype.throttle=function(g){(g=this.tryDurationSelector(g))&&this.add(this._throttled=qc(g,new Cc(this)))},l.prototype.tryDurationSelector=function(g){try{return this.durationSelector(g)}catch(f){return this.destination.error(f),null}},l.prototype.throttlingDone=function(){var g=this._throttled,f=this._trailing;g&&g.unsubscribe(),this._throttled=void 0,f&&this.send()},l.prototype.notifyNext=function(){this.throttlingDone()},l.prototype.notifyComplete=function(){this.throttlingDone()}}(Dc);for(var Fv=function(){function h(l,g,f,k){this.duration=l,this.scheduler=g,this.leading=f,this.trailing=k}return h.prototype.call=function(l,g){return g.subscribe(new RB(l,this.duration,this.scheduler,this.leading,this.trailing))},h}(),RB=function(h){function l(g,f,k,q,_r){return(g=h.call(this,g)||this).duration=f,g.scheduler=k,g.leading=q,g.trailing=_r,g._hasTrailingValue=!1,g._trailingValue=null,g}return O(l,h),l.prototype._next=function(g){this.throttled?this.trailing&&(this._trailingValue=g,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(Gv,this.duration,{subscriber:this})),this.leading?this.destination.next(g):this.trailing&&(this._trailingValue=g,this._hasTrailingValue=!0))},l.prototype._complete=function(){this._hasTrailingValue&&this.destination.next(this._trailingValue),this.destination.complete()},l.prototype.clearThrottle=function(){var g=this.throttled;g&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),g.unsubscribe(),this.remove(g),this.throttled=null)},l}(ma),Iv=function(){function h(l,g,f,k){this.waitFor=l,this.absoluteTimeout=g,this.withObservable=f,this.scheduler=k}return h.prototype.call=function(l,g){return g.subscribe(new SB(l,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},h}(),SB=function(h){function l(g,f,k,q,_r){return(g=h.call(this,g)||this).absoluteTimeout=f,g.waitFor=k,g.withObservable=q,g.scheduler=_r,g.scheduleTimeout(),g}return O(l,h),l.dispatchTimeout=function(g){var f=g.withObservable;g._unsubscribeAndRecycle(),g.add(qc(f,new Cc(g)))},l.prototype.scheduleTimeout=function(){var g=this.action;g?this.action=g.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(l.dispatchTimeout,this.waitFor,this))},l.prototype._next=function(g){this.absoluteTimeout||this.scheduleTimeout(),h.prototype._next.call(this,g)},l.prototype._unsubscribe=function(){this.action=void 0,this.withObservable=this.scheduler=null},l}(Dc),Kv=function(){function h(l,g){this.observables=l,this.project=g}return h.prototype.call=function(l,g){return g.subscribe(new TB(l,this.observables,this.project))},h}(),TB=function(h){function l(g,f,k){(g=h.call(this,g)||this).observables=f,g.project=k,g.toRespond=[],k=f.length,g.values=Array(k);for(var q=0;q<k;q++)g.toRespond.push(q);for(q=0;q<k;q++)g.add(Oi(g,f[q],void 0,q));return g}return O(l,h),l.prototype.notifyNext=function(g,f,k){this.values[k]=f,0<(g=this.toRespond).length&&-1!==(k=g.indexOf(k))&&g.splice(k,1)},l.prototype.notifyComplete=function(){},l.prototype._next=function(g){0===this.toRespond.length&&(g=[g].concat(this.values),this.project?this._tryProject(g):this.destination.next(g))},l.prototype._tryProject=function(g){try{var f=this.project.apply(this,g)}catch(k){return void this.destination.error(k)}this.destination.next(f)},l}(xl),Nr=cb(function(h){var l="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(l){var g=new Uint8Array(16);h.exports=function(){return l(g),g}}else{var f=Array(16);h.exports=function(){for(var k,q=0;16>q;q++)0==(3&q)&&(k=4294967296*Math.random()),f[q]=k>>>((3&q)<<3)&255;return f}}}),db=[],ei=0;256>ei;++ei)db[ei]=(ei+256).toString(16).substr(1);var Or=function(h,l){return l=l||0,[db[h[l++]],db[h[l++]],db[h[l++]],db[h[l++]],"-",db[h[l++]],db[h[l++]],"-",db[h[l++]],db[h[l++]],"-",db[h[l++]],db[h[l++]],"-",db[h[l++]],db[h[l++]],db[h[l++]],db[h[l++]],db[h[l++]],db[h[l++]]].join("")},de=function(h,l,g){if(g=l&&g||0,"string"==typeof h&&(l="binary"===h?Array(16):null,h=null),(h=(h=h||{}).random||(h.rng||Nr)())[6]=15&h[6]|64,h[8]=63&h[8]|128,l)for(var f=0;16>f;++f)l[g+f]=h[f];return l||Or(h)},zg=de(),Ti=!1,xn=new AbortController,Vc,yd,Al,Bl,zd,ee,mc,mf,Wb,Cl,Wc,fe,Xc,Yc,Zc,nf,$c,ad;(function(h){h[h.ATTRIBUTE_OPERATION_ERR_FAILURE=2]="ATTRIBUTE_OPERATION_ERR_FAILURE",h[h.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT=3]="ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT",h[h.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW=4]="ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW",h[h.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN=5]="ATTRIBUTE_OPERATION_ERR_TOO_OFTEN",h[h.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND=6]="ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND",h[h.ATTRIBUTE_OPERATION_ERR_TIMEOUT=7]="ATTRIBUTE_OPERATION_ERR_TIMEOUT",h[h.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN=102]="ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN"})(Vc||(Vc={})),function(h){h[h.CHANNEL_MESSAGE_ERR_FAILURE=1]="CHANNEL_MESSAGE_ERR_FAILURE",h[h.CHANNEL_MESSAGE_ERR_TIMEOUT=2]="CHANNEL_MESSAGE_ERR_TIMEOUT",h[h.CHANNEL_MESSAGE_ERR_TOO_OFTEN=3]="CHANNEL_MESSAGE_ERR_TOO_OFTEN",h[h.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE=4]="CHANNEL_MESSAGE_ERR_INVALID_MESSAGE",h[h.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL=5]="CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL",h[h.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(yd||(yd={})),function(h){h[h.CREATE_CHANNEL_ERR_INVALID_ARGUMENT=1]="CREATE_CHANNEL_ERR_INVALID_ARGUMENT"}(Al||(Al={})),function(h){h[h.CREATE_INSTANCE_ERR_INVALID_ARGUMENT=1]="CREATE_INSTANCE_ERR_INVALID_ARGUMENT"}(Bl||(Bl={})),function(h){h[h.GET_MEMBERS_ERR_FAILURE=1]="GET_MEMBERS_ERR_FAILURE",h[h.GET_MEMBERS_ERR_REJECTED=2]="GET_MEMBERS_ERR_REJECTED",h[h.GET_MEMBERS_ERR_TIMEOUT=3]="GET_MEMBERS_ERR_TIMEOUT",h[h.GET_MEMBERS_ERR_TOO_OFTEN=4]="GET_MEMBERS_ERR_TOO_OFTEN",h[h.GET_MEMBERS_ERR_NOT_IN_CHANNEL=5]="GET_MEMBERS_ERR_NOT_IN_CHANNEL",h[h.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN=102]="GET_MEMBERS_ERR_USER_NOT_LOGGED_IN"}(zd||(zd={})),function(h){h[h.INVITATION_API_CALL_ERR_INVALID_ARGUMENT=1]="INVITATION_API_CALL_ERR_INVALID_ARGUMENT",h[h.INVITATION_API_CALL_ERR_NOT_STARTED=2]="INVITATION_API_CALL_ERR_NOT_STARTED",h[h.INVITATION_API_CALL_ERR_ALREADY_END=3]="INVITATION_API_CALL_ERR_ALREADY_END",h[h.INVITATION_API_CALL_ERR_ALREADY_ACCEPT=4]="INVITATION_API_CALL_ERR_ALREADY_ACCEPT",h[h.INVITATION_API_CALL_ERR_ALREADY_SENT=5]="INVITATION_API_CALL_ERR_ALREADY_SENT"}(ee||(ee={})),function(h){h[h.JOIN_CHANNEL_ERR_FAILURE=1]="JOIN_CHANNEL_ERR_FAILURE",h[h.JOIN_CHANNEL_ERR_REJECTED=2]="JOIN_CHANNEL_ERR_REJECTED",h[h.JOIN_CHANNEL_ERR_INVALID_ARGUMENT=3]="JOIN_CHANNEL_ERR_INVALID_ARGUMENT",h[h.JOIN_CHANNEL_TIMEOUT=4]="JOIN_CHANNEL_TIMEOUT",h[h.JOIN_CHANNEL_ERR_EXCEED_LIMIT=5]="JOIN_CHANNEL_ERR_EXCEED_LIMIT",h[h.JOIN_CHANNEL_ERR_ALREADY_JOINED=6]="JOIN_CHANNEL_ERR_ALREADY_JOINED",h[h.JOIN_CHANNEL_ERR_TOO_OFTEN=7]="JOIN_CHANNEL_ERR_TOO_OFTEN",h[h.JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN=8]="JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN",h[h.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN",h[h.JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE=201]="JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE",h[h.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID=202]="JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID"}(mc||(mc={})),function(h){h[h.LEAVE_CHANNEL_ERR_FAILURE=1]="LEAVE_CHANNEL_ERR_FAILURE",h[h.LEAVE_CHANNEL_ERR_REJECTED=2]="LEAVE_CHANNEL_ERR_REJECTED",h[h.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL=3]="LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL",h[h.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN"}(mf||(mf={})),function(h){h[h.LOGIN_ERR_UNKNOWN=1]="LOGIN_ERR_UNKNOWN",h[h.LOGIN_ERR_REJECTED=2]="LOGIN_ERR_REJECTED",h[h.LOGIN_ERR_INVALID_ARGUMENT=3]="LOGIN_ERR_INVALID_ARGUMENT",h[h.LOGIN_ERR_INVALID_APP_ID=4]="LOGIN_ERR_INVALID_APP_ID",h[h.LOGIN_ERR_INVALID_TOKEN=5]="LOGIN_ERR_INVALID_TOKEN",h[h.LOGIN_ERR_TOKEN_EXPIRED=6]="LOGIN_ERR_TOKEN_EXPIRED",h[h.LOGIN_ERR_NOT_AUTHORIZED=7]="LOGIN_ERR_NOT_AUTHORIZED",h[h.LOGIN_ERR_ALREADY_LOGIN=8]="LOGIN_ERR_ALREADY_LOGIN",h[h.LOGIN_ERR_TIMEOUT=9]="LOGIN_ERR_TIMEOUT",h[h.LOGIN_ERR_TOO_OFTEN=10]="LOGIN_ERR_TOO_OFTEN",h[h.LOGIN_ERR_ABORTED_BY_LOGOUT=201]="LOGIN_ERR_ABORTED_BY_LOGOUT"}(Wb||(Wb={})),function(h){h[h.LOGOUT_ERR_USER_NOT_LOGGED_IN=102]="LOGOUT_ERR_USER_NOT_LOGGED_IN"}(Cl||(Cl={})),function(h){h[h.PEER_MESSAGE_ERR_FAILURE=1]="PEER_MESSAGE_ERR_FAILURE",h[h.PEER_MESSAGE_ERR_TIMEOUT=2]="PEER_MESSAGE_ERR_TIMEOUT",h[h.PEER_MESSAGE_ERR_TOO_OFTEN=5]="PEER_MESSAGE_ERR_TOO_OFTEN",h[h.PEER_MESSAGE_ERR_INVALID_USERID=6]="PEER_MESSAGE_ERR_INVALID_USERID",h[h.PEER_MESSAGE_ERR_INVALID_MESSAGE=7]="PEER_MESSAGE_ERR_INVALID_MESSAGE",h[h.PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE=8]="PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE",h[h.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(Wc||(Wc={})),function(h){h[h.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT=2]="QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT",h[h.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED=3]="QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED",h[h.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT=4]="QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT",h[h.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN=5]="QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN",h[h.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN"}(fe||(fe={})),function(h){h[h.RENEW_TOKEN_ERR_FAILURE=1]="RENEW_TOKEN_ERR_FAILURE",h[h.RENEW_TOKEN_ERR_INVALID_ARGUMENT=2]="RENEW_TOKEN_ERR_INVALID_ARGUMENT",h[h.RENEW_TOKEN_ERR_REJECTED=3]="RENEW_TOKEN_ERR_REJECTED",h[h.RENEW_TOKEN_ERR_TOO_OFTEN=4]="RENEW_TOKEN_ERR_TOO_OFTEN",h[h.RENEW_TOKEN_ERR_TOKEN_EXPIRED=5]="RENEW_TOKEN_ERR_TOKEN_EXPIRED",h[h.RENEW_TOKEN_ERR_INVALID_TOKEN=6]="RENEW_TOKEN_ERR_INVALID_TOKEN",h[h.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN=102]="RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN",h[h.RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT=201]="RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT"}(Xc||(Xc={})),function(h){h[h.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE=1]="GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE",h[h.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT=2]="GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT",h[h.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN=3]="GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN",h[h.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT=4]="GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT",h[h.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT=5]="GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT",h[h.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED=101]="GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED",h[h.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN=102]="GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN"}(Yc||(Yc={})),function(h){h[h.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE=1]="PEER_SUBSCRIPTION_STATUS_ERR_FAILURE",h[h.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT=2]="PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT",h[h.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED=3]="PEER_SUBSCRIPTION_STATUS_ERR_REJECTED",h[h.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT=4]="PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT",h[h.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN=5]="PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN",h[h.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW=6]="PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW",h[h.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN=102]="PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN"}(Zc||(Zc={})),function(h){h[h.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE=1]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE",h[h.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT=2]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT",h[h.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN=3]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN",h[h.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN"}(nf||(nf={})),function(h){h[h.UPLOAD_MEDIA_ERR_FAILURE=1]="UPLOAD_MEDIA_ERR_FAILURE",h[h.UPLOAD_MEDIA_ERR_INVALID_ARGUMENT=2]="UPLOAD_MEDIA_ERR_INVALID_ARGUMENT",h[h.UPLOAD_MEDIA_ERR_TIMEOUT=3]="UPLOAD_MEDIA_ERR_TIMEOUT",h[h.UPLOAD_MEDIA_ERR_SIZE_OVERFLOW=4]="UPLOAD_MEDIA_ERR_SIZE_OVERFLOW",h[h.UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED=5]="UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED",h[h.UPLOAD_MEDIA_ERR_INTERRUPTED=6]="UPLOAD_MEDIA_ERR_INTERRUPTED",h[h.UPLOAD_MEDIA_ERR_NOT_LOGGED_IN=102]="UPLOAD_MEDIA_ERR_NOT_LOGGED_IN"}($c||($c={})),function(h){h[h.DOWNLOAD_MEDIA_ERR_FAILURE=1]="DOWNLOAD_MEDIA_ERR_FAILURE",h[h.DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT=2]="DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT",h[h.DOWNLOAD_MEDIA_ERR_TIMEOUT=3]="DOWNLOAD_MEDIA_ERR_TIMEOUT",h[h.DOWNLOAD_MEDIA_ERR_NOT_EXIST=4]="DOWNLOAD_MEDIA_ERR_NOT_EXIST",h[h.DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED=5]="DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED",h[h.DOWNLOAD_MEDIA_ERR_INTERRUPTED=6]="DOWNLOAD_MEDIA_ERR_INTERRUPTED",h[h.DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN=102]="DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN"}(ad||(ad={}));var Xb=Vc.ATTRIBUTE_OPERATION_ERR_FAILURE,Oa=Vc.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,Ge=Vc.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW,Pr=Vc.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND,Yb=Vc.ATTRIBUTE_OPERATION_ERR_TIMEOUT,Zb=Vc.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,Ag=yd.CHANNEL_MESSAGE_ERR_FAILURE,Dl=yd.CHANNEL_MESSAGE_ERR_TIMEOUT,Qr=yd.CHANNEL_MESSAGE_ERR_TOO_OFTEN,fi=yd.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE,UB=yd.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL,El=yd.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN,VB=Al.CREATE_CHANNEL_ERR_INVALID_ARGUMENT,Rr=Bl.CREATE_INSTANCE_ERR_INVALID_ARGUMENT,Sr=Yc.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT,Tr=Yc.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT,WB=Yc.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT,XB=Yc.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN,YB=zd.GET_MEMBERS_ERR_FAILURE,ZB=zd.GET_MEMBERS_ERR_REJECTED,$B=zd.GET_MEMBERS_ERR_NOT_IN_CHANNEL,aC=zd.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN,Ec=ee.INVITATION_API_CALL_ERR_INVALID_ARGUMENT,bC=ee.INVITATION_API_CALL_ERR_NOT_STARTED,gi=ee.INVITATION_API_CALL_ERR_ALREADY_END,Ur=ee.INVITATION_API_CALL_ERR_ALREADY_ACCEPT,cC=ee.INVITATION_API_CALL_ERR_ALREADY_SENT,Vr=mc.JOIN_CHANNEL_ERR_FAILURE,dC=mc.JOIN_CHANNEL_ERR_INVALID_ARGUMENT,Wr=mc.JOIN_CHANNEL_TIMEOUT,Xr=mc.JOIN_CHANNEL_ERR_EXCEED_LIMIT,Yr=mc.JOIN_CHANNEL_ERR_ALREADY_JOINED,Zr=mc.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN,$r=mc.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID,as=mf.LEAVE_CHANNEL_ERR_FAILURE,bs=mf.LEAVE_CHANNEL_ERR_REJECTED,eC=mf.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL,fC=mf.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN,cs=Wb.LOGIN_ERR_UNKNOWN,Bg=Wb.LOGIN_ERR_REJECTED,hi=Wb.LOGIN_ERR_INVALID_ARGUMENT,ds=Wb.LOGIN_ERR_INVALID_APP_ID,es=Wb.LOGIN_ERR_INVALID_TOKEN,ii=Wb.LOGIN_ERR_TOKEN_EXPIRED,gC=Wb.LOGIN_ERR_ALREADY_LOGIN,hC=Wb.LOGIN_ERR_TIMEOUT,iC=Wb.LOGIN_ERR_TOO_OFTEN,fs=Cl.LOGOUT_ERR_USER_NOT_LOGGED_IN,gs=Wc.PEER_MESSAGE_ERR_FAILURE,Fl=Wc.PEER_MESSAGE_ERR_TIMEOUT,hs=Wc.PEER_MESSAGE_ERR_TOO_OFTEN,Gl=Wc.PEER_MESSAGE_ERR_INVALID_USERID,Ie=Wc.PEER_MESSAGE_ERR_INVALID_MESSAGE,Hl=Wc.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN,jC=Wc.PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE,is=fe.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT,kC=fe.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT,lC=fe.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN,mC=Xc.RENEW_TOKEN_ERR_FAILURE,nC=Xc.RENEW_TOKEN_ERR_INVALID_ARGUMENT,oC=Xc.RENEW_TOKEN_ERR_TOKEN_EXPIRED,pC=Xc.RENEW_TOKEN_ERR_INVALID_TOKEN,qC=Xc.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN,js=Zc.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE,Cg=Zc.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT,rC=Zc.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT,ks=Zc.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW,Il=Zc.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN,Dg=$c.UPLOAD_MEDIA_ERR_FAILURE,Of=$c.UPLOAD_MEDIA_ERR_INVALID_ARGUMENT,ji=$c.UPLOAD_MEDIA_ERR_TIMEOUT,sC=$c.UPLOAD_MEDIA_ERR_SIZE_OVERFLOW,tC=$c.UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED,ls=$c.UPLOAD_MEDIA_ERR_INTERRUPTED,uC=$c.UPLOAD_MEDIA_ERR_NOT_LOGGED_IN,Eg=ad.DOWNLOAD_MEDIA_ERR_FAILURE,Jl=ad.DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT,vC=ad.DOWNLOAD_MEDIA_ERR_TIMEOUT,wC=ad.DOWNLOAD_MEDIA_ERR_NOT_EXIST,xC=ad.DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED,ms=ad.DOWNLOAD_MEDIA_ERR_INTERRUPTED,yC=ad.DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN,zC=function(h,l){var g;return nl(h,function(f,k,q){return!(g=l(f,k,q))}),!!g},ki=function(h,l,g){if(!ob(g))return!1;var f=V(l);return!!("number"==f?Nd(g)&&cl(l,g.length):"string"==f&&l in g)&&sg(g[l],h)},Kl=function(h,l,g){var f=Za(h)?xr:zC;return g&&ki(h,l,g)&&(l=void 0),f(h,jf(l))},AC=function(h,l){var g=-1,f=Nd(h)?Array(h.length):[];return nl(h,function(k,q,_r){f[++g]=l(k,q,_r)}),f},BC=function(h,l){var g=h.length;for(h.sort(l);g--;)h[g]=h[g].value;return h},CC=function(h,l,g){l=l.length?ve(l,function(k){return Za(k)?function(q){return ai(q,1===k.length?k[0]:k)}:k}):[bi];var f=-1;return l=ve(l,Yh(jf)),h=AC(h,function(k,q,_r){return{criteria:ve(l,function(_s){return _s(k)}),index:++f,value:k}}),BC(h,function(k,q){e:{for(var _r=-1,_s=k.criteria,ga=q.criteria,_l=_s.length,bh=g.length;++_r<_l;){t:{var n_=_s[_r],_A=ga[_r];if(n_!==_A){var r_=void 0!==n_,p_=null===n_,I_=n_==n_,v_=we(n_),S_=void 0!==_A,x_=null===_A,B_=_A==_A,V_=we(_A);if(!x_&&!V_&&!v_&&n_>_A||v_&&S_&&B_&&!x_&&!V_||p_&&S_&&B_||!r_&&B_||!I_){n_=1;break t}if(!p_&&!v_&&!V_&&n_<_A||V_&&r_&&I_&&!p_&&!v_||x_&&r_&&I_||!S_&&I_||!B_){n_=-1;break t}}n_=0}if(n_){k=_r>=bh?n_:n_*("desc"==g[_r]?-1:1);break e}}k=k.index-q.index}return k})},ns=function(h,l){return vr(ur(h,l,bi),h+"")},os=ns(function(h,l){if(null==h)return[];var g=l.length;return 1<g&&ki(h,l[0],l[1])?l=[]:2<g&&ki(l[0],l[1],l[2])&&(l=[l[0]]),CC(h,Ei(l,1),[])}),ps=function(h){if(h.__esModule)return h;var l=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(h).forEach(function(g){var f=Object.getOwnPropertyDescriptor(h,g);Object.defineProperty(l,g,f.get?f:{enumerable:!0,get:function(){return h[g]}})}),l}(yB),qs=cb(function(h,l){Object.defineProperty(l,"__esModule",{value:!0});var g=[],f=function(k,q){return new WebSocket(k,q)};l.normalClosureMessage="Normal closure",l.default=function(k,q){var _r=(q=void 0===q?{protocols:g,makeWebSocket:f}:q).protocols,_s=void 0===_r?g:_r,ga=void 0===(q=q.makeWebSocket)?f:q;return new ps.Observable(function(_l){var bh,n_=new ps.Subject,_A=ga(k,_s),r_=!1,p_=!1,I_=function(v_){if(bh)throw r_=!0,v_=Error("Web socket message factory function called more than once"),_l.error(v_),v_;return bh=v_.subscribe(function(S_){_A.send(S_)}),n_};return _A.onopen=function(){p_?(r_=!0,_A.close()):_l.next(I_)},_A.onmessage=function(v_){n_.next(v_.data)},_A.onerror=function(v_){r_=!0,_l.error(Error(v_.message))},_A.onclose=function(v_){r_||(r_=!0,p_?(_l.complete(),n_.complete()):_l.error(Error(1e3===v_.code?l.normalClosureMessage:v_.reason)))},function(){p_=!0,bh&&bh.unsubscribe(),r_||(r_=!0,_A.close())}})}});!function(h){h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")}(qs);var Vi=function(h,l,g){(void 0===g||sg(h[l],g))&&(void 0!==g||l in h)||ug(h,l,g)},Ui=function(h,l){if(("constructor"!==l||"function"!=typeof h[l])&&"__proto__"!=l)return h[l]},DC=function(h){return ns(function(l,g){var f=-1,k=g.length,q=1<k?g[k-1]:void 0,_r=2<k?g[2]:void 0;for(q=3<h.length&&"function"==typeof q?(k--,q):void 0,_r&&ki(g[0],g[1],_r)&&(q=3>k?void 0:q,k=1),l=Object(l);++f<k;)(_r=g[f])&&h(l,_r,f,q);return l})}(function(h,l,g,f){yn(h,l,g,f)}),EC=Math.floor,FC=Math.random,rs=function(h,l){return h+EC(FC()*(l-h+1))},ss=function(h){var l=h.length;return l?h[rs(0,l-1)]:void 0},GC=function(h,l){return ve(l,function(g){return h[g]})},tj=function(h){return null==h?[]:GC(h,Jd(h))},HC=function(h){return ss(tj(h))},fo=function(h){return(Za(h)?ss:HC)(h)},Cn=[],Dn=function(h,l){return new WebSocket(h,l)},IC=Math.floor;M({target:"Number",stat:!0},{isInteger:function(h){return!ha(h)&&isFinite(h)&&IC(h)===h}}),Up("from",ok,nk);var JC=function(h,l){for(var g=Array(arguments.length-1),f=0,k=2,q=!0;k<arguments.length;)g[f++]=arguments[k++];return new Promise(function(_r,_s){g[f]=function(ga){if(q)if(q=!1,ga)_s(ga);else{for(var _l=Array(arguments.length-1),bh=0;bh<_l.length;)_l[bh++]=arguments[bh];_r.apply(null,_l)}};try{h.apply(l||null,g)}catch(ga){q&&(q=!1,_s(ga))}})},KC=cb(function(h,l){l.length=function(k){var q=k.length;if(!q)return 0;for(var _r=0;1<--q%4&&"="===k.charAt(q);)++_r;return Math.ceil(3*k.length)/4-_r};var g=Array(64),f=Array(123);for(h=0;64>h;)f[g[h]=26>h?h+65:52>h?h+71:62>h?h-4:h-59|43]=h++;l.encode=function(k,q,_r){for(var _s,ga=null,_l=[],bh=0,n_=0;q<_r;){var _A=k[q++];switch(n_){case 0:_l[bh++]=g[_A>>2],_s=(3&_A)<<4,n_=1;break;case 1:_l[bh++]=g[_s|_A>>4],_s=(15&_A)<<2,n_=2;break;case 2:_l[bh++]=g[_s|_A>>6],_l[bh++]=g[63&_A],n_=0}8191<bh&&((ga||(ga=[])).push(String.fromCharCode.apply(String,_l)),bh=0)}return n_&&(_l[bh++]=g[_s],_l[bh++]=61,1===n_&&(_l[bh++]=61)),ga?(bh&&ga.push(String.fromCharCode.apply(String,_l.slice(0,bh))),ga.join("")):String.fromCharCode.apply(String,_l.slice(0,bh))},l.decode=function(k,q,_r){for(var _s,ga=_r,_l=0,bh=0;bh<k.length;){var n_=k.charCodeAt(bh++);if(61===n_&&1<_l)break;if(void 0===(n_=f[n_]))throw Error("invalid encoding");switch(_l){case 0:_s=n_,_l=1;break;case 1:q[_r++]=_s<<2|(48&n_)>>4,_s=n_,_l=2;break;case 2:q[_r++]=(15&_s)<<4|(60&n_)>>2,_s=n_,_l=3;break;case 3:q[_r++]=(3&_s)<<6|n_,_l=0}}if(1===_l)throw Error("invalid encoding");return _r-ga},l.test=function(k){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(k)}});Vg.prototype.on=function(h,l,g){return(this._listeners[h]||(this._listeners[h]=[])).push({fn:l,ctx:g||this}),this},Vg.prototype.off=function(h,l){if(void 0===h)this._listeners={};else if(void 0===l)this._listeners[h]=[];else{h=this._listeners[h];for(var g=0;g<h.length;)h[g].fn===l?h.splice(g,1):++g}return this},Vg.prototype.emit=function(h){var l=this._listeners[h];if(l){for(var g=[],f=1;f<arguments.length;)g.push(arguments[f++]);for(f=0;f<l.length;)l[f].fn.apply(l[f++].ctx,g)}return this};var LC=En(En),MC=function(c){try{var a=eval("quire".replace(/^/,"re"))(c);if(a&&(a.length||Object.keys(a).length))return a}catch(h){}return null},NC=cb(function(h,l){l.length=function(g){for(var f,k=0,q=0;q<g.length;++q)128>(f=g.charCodeAt(q))?k+=1:2048>f?k+=2:55296==(64512&f)&&56320==(64512&g.charCodeAt(q+1))?(++q,k+=4):k+=3;return k},l.read=function(g,f,k){if(1>k-f)return"";for(var q,_r=null,_s=[],ga=0;f<k;)128>(q=g[f++])?_s[ga++]=q:191<q&&224>q?_s[ga++]=(31&q)<<6|63&g[f++]:239<q&&365>q?(q=((7&q)<<18|(63&g[f++])<<12|(63&g[f++])<<6|63&g[f++])-65536,_s[ga++]=55296+(q>>10),_s[ga++]=56320+(1023&q)):_s[ga++]=(15&q)<<12|(63&g[f++])<<6|63&g[f++],8191<ga&&((_r||(_r=[])).push(String.fromCharCode.apply(String,_s)),ga=0);return _r?(ga&&_r.push(String.fromCharCode.apply(String,_s.slice(0,ga))),_r.join("")):String.fromCharCode.apply(String,_s.slice(0,ga))},l.write=function(g,f,k){for(var q,_r,_s=k,ga=0;ga<g.length;++ga)128>(q=g.charCodeAt(ga))?f[k++]=q:(2048>q?f[k++]=q>>6|192:(55296==(64512&q)&&56320==(64512&(_r=g.charCodeAt(ga+1)))?(++ga,f[k++]=(q=65536+((1023&q)<<10)+(1023&_r))>>18|240,f[k++]=q>>12&63|128):f[k++]=q>>12|224,f[k++]=q>>6&63|128),f[k++]=63&q|128);return k-_s}}),OC=function(h,l,g){var f=g||8192,k=f>>>1,q=null,_r=f;return function(_s){return 1>_s||_s>k?h(_s):(_r+_s>f&&(q=h(f),_r=0),_s=l.call(q,_r,_r+=_s),7&_r&&(_r=1+(7|_r)),_s)}},ge=$a.zero=new $a(0,0);ge.toNumber=function(){return 0},ge.zzEncode=ge.zzDecode=function(){return this},ge.length=function(){return 1};var PC=$a.zeroHash="\0\0\0\0\0\0\0\0";$a.fromNumber=function(h){if(0===h)return ge;var l=0>h;l&&(h=-h);var g=h>>>0;return h=(h-g)/4294967296>>>0,l&&(h=~h>>>0,g=~g>>>0,4294967295<++g&&(g=0,4294967295<++h&&(h=0))),new $a(g,h)},$a.from=function(h){if("number"==typeof h)return $a.fromNumber(h);if(W.isString(h)){if(!W.Long)return $a.fromNumber(parseInt(h,10));h=W.Long.fromString(h)}return h.low||h.high?new $a(h.low>>>0,h.high>>>0):ge},$a.prototype.toNumber=function(h){if(!h&&this.hi>>>31){var l=~this.hi>>>0;return(h=1+~this.lo>>>0)||(l=l+1>>>0),-(h+4294967296*l)}return this.lo+4294967296*this.hi},$a.prototype.toLong=function(h){return W.Long?new W.Long(0|this.lo,0|this.hi,!!h):{low:0|this.lo,high:0|this.hi,unsigned:!!h}};var Ad=String.prototype.charCodeAt;$a.fromHash=function(h){return h===PC?ge:new $a((Ad.call(h,0)|Ad.call(h,1)<<8|Ad.call(h,2)<<16|Ad.call(h,3)<<24)>>>0,(Ad.call(h,4)|Ad.call(h,5)<<8|Ad.call(h,6)<<16|Ad.call(h,7)<<24)>>>0)},$a.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},$a.prototype.zzEncode=function(){var h=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^h)>>>0,this.lo=(this.lo<<1^h)>>>0,this},$a.prototype.zzDecode=function(){var h=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^h)>>>0,this.hi=(this.hi>>>1^h)>>>0,this},$a.prototype.length=function(){var h=this.lo,l=(this.lo>>>28|this.hi<<4)>>>0,g=this.hi>>>24;return 0===g?0===l?16384>h?128>h?1:2:2097152>h?3:4:16384>l?128>l?5:6:2097152>l?7:8:128>g?9:10};var W=cb(function(h,l){function g(k,q,_r){for(var _s=Object.keys(q),ga=0;ga<_s.length;++ga)void 0!==k[_s[ga]]&&_r||(k[_s[ga]]=q[_s[ga]]);return k}function f(k){function q(_r,_s){if(!(this instanceof q))return new q(_r,_s);Object.defineProperty(this,"message",{get:function(){return _r}}),Error.captureStackTrace?Error.captureStackTrace(this,q):Object.defineProperty(this,"stack",{value:Error().stack||""}),_s&&g(this,_s)}return(q.prototype=Object.create(Error.prototype)).constructor=q,Object.defineProperty(q.prototype,"name",{get:function(){return k}}),q.prototype.toString=function(){return this.name+": "+this.message},q}l.asPromise=JC,l.base64=KC,l.EventEmitter=Vg,l.float=LC,l.inquire=MC,l.utf8=NC,l.pool=OC,l.LongBits=$a,l.isNode=!!(void 0!==Ka&&Ka&&Ka.process&&Ka.process.versions&&Ka.process.versions.node),l.global=l.isNode&&Ka||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||Ka,l.emptyArray=Object.freeze?Object.freeze([]):[],l.emptyObject=Object.freeze?Object.freeze({}):{},l.isInteger=Number.isInteger||function(k){return"number"==typeof k&&isFinite(k)&&Math.floor(k)===k},l.isString=function(k){return"string"==typeof k||k instanceof String},l.isObject=function(k){return k&&"object"===V(k)},l.isset=l.isSet=function(k,q){var _r=k[q];return!(null==_r||!k.hasOwnProperty(q))&&("object"!==V(_r)||0<(Array.isArray(_r)?_r.length:Object.keys(_r).length))},l.Buffer=function(){try{var k=l.inquire("buffer").Buffer;return k.prototype.utf8Write?k:null}catch(q){return null}}(),l._Buffer_from=null,l._Buffer_allocUnsafe=null,l.newBuffer=function(k){return"number"==typeof k?l.Buffer?l._Buffer_allocUnsafe(k):new l.Array(k):l.Buffer?l._Buffer_from(k):"undefined"==typeof Uint8Array?k:new Uint8Array(k)},l.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,l.Long=l.global.dcodeIO&&l.global.dcodeIO.Long||l.global.Long||l.inquire("long"),l.key2Re=/^true|false|0|1$/,l.key32Re=/^-?(?:0|[1-9][0-9]*)$/,l.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,l.longToHash=function(k){return k?l.LongBits.from(k).toHash():l.LongBits.zeroHash},l.longFromHash=function(k,q){return k=l.LongBits.fromHash(k),l.Long?l.Long.fromBits(k.lo,k.hi,q):k.toNumber(!!q)},l.merge=g,l.lcFirst=function(k){return k.charAt(0).toLowerCase()+k.substring(1)},l.newError=f,l.ProtocolError=f("ProtocolError"),l.oneOfGetter=function(k){for(var q={},_r=0;_r<k.length;++_r)q[k[_r]]=1;return function(){for(var _s=Object.keys(this),ga=_s.length-1;-1<ga;--ga)if(1===q[_s[ga]]&&null!=this[_s[ga]])return _s[ga]}},l.oneOfSetter=function(k){return function(q){for(var _r=0;_r<k.length;++_r)k[_r]!==q&&delete this[k[_r]]}},l.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},l._configure=function(){var k=l.Buffer;k?(l._Buffer_from=k.from!==Uint8Array.from&&k.from||function(q,_r){return new k(q,_r)},l._Buffer_allocUnsafe=k.allocUnsafe||function(q){return new k(q)}):l._Buffer_from=l._Buffer_allocUnsafe=null}}),cj=na,Ll,li=W.LongBits,ts=W.base64,us=W.utf8,vs=function(){return W.Buffer?function(){return(na.create=function(){return new Ll})()}:function(){return new na}};na.create=vs(),na.alloc=function(h){return new W.Array(h)},W.Array!==Array&&(na.alloc=W.pool(na.alloc,W.Array.prototype.subarray)),na.prototype._push=function(h,l,g){return this.tail=this.tail.next=new Kf(h,l,g),this.len+=l,this},$i.prototype=Object.create(Kf.prototype),$i.prototype.fn=function(h,l,g){for(;127<h;)l[g++]=127&h|128,h>>>=7;l[g]=h},na.prototype.uint32=function(h){return this.len+=(this.tail=this.tail.next=new $i(128>(h>>>=0)?1:16384>h?2:2097152>h?3:268435456>h?4:5,h)).len,this},na.prototype.int32=function(h){return 0>h?this._push(aj,10,li.fromNumber(h)):this.uint32(h)},na.prototype.sint32=function(h){return this.uint32((h<<1^h>>31)>>>0)},na.prototype.uint64=function(h){return h=li.from(h),this._push(aj,h.length(),h)},na.prototype.int64=na.prototype.uint64,na.prototype.sint64=function(h){return h=li.from(h).zzEncode(),this._push(aj,h.length(),h)},na.prototype.bool=function(h){return this._push(Zi,1,h?1:0)},na.prototype.fixed32=function(h){return this._push(bj,4,h>>>0)},na.prototype.sfixed32=na.prototype.fixed32,na.prototype.fixed64=function(h){return h=li.from(h),this._push(bj,4,h.lo)._push(bj,4,h.hi)},na.prototype.sfixed64=na.prototype.fixed64,na.prototype.float=function(h){return this._push(W.float.writeFloatLE,4,h)},na.prototype.double=function(h){return this._push(W.float.writeDoubleLE,8,h)};var QC=W.Array.prototype.set?function(h,l,g){l.set(h,g)}:function(h,l,g){for(var f=0;f<h.length;++f)l[g+f]=h[f]};na.prototype.bytes=function(h){var l=h.length>>>0;if(!l)return this._push(Zi,1,0);if(W.isString(h)){var g=na.alloc(l=ts.length(h));ts.decode(h,g,0),h=g}return this.uint32(l)._push(QC,l,h)},na.prototype.string=function(h){var l=us.length(h);return l?this.uint32(l)._push(us.write,l,h):this._push(Zi,1,0)},na.prototype.fork=function(){return this.states=new Nv(this),this.head=this.tail=new Kf(Yi,0,0),this.len=0,this},na.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Kf(Yi,0,0),this.len=0),this},na.prototype.ldelim=function(){var h=this.head,l=this.tail,g=this.len;return this.reset().uint32(g),g&&(this.tail.next=h.next,this.tail=l,this.len+=g),this},na.prototype.finish=function(){for(var h=this.head.next,l=this.constructor.alloc(this.len),g=0;h;)h.fn(h.val,l,g),g+=h.len,h=h.next;return l},na._configure=function(h){Ll=h,na.create=vs(),Ll._configure()},(rc.prototype=Object.create(cj.prototype)).constructor=rc,rc._configure=function(){rc.alloc=W._Buffer_allocUnsafe,rc.writeBytesBuffer=W.Buffer&&W.Buffer.prototype instanceof Uint8Array&&"set"===W.Buffer.prototype.set.name?function(h,l,g){l.set(h,g)}:function(h,l,g){if(h.copy)h.copy(l,g,0,h.length);else for(var f=0;f<h.length;)l[g++]=h[f++]}},rc.prototype.bytes=function(h){W.isString(h)&&(h=W._Buffer_from(h,"base64"));var l=h.length>>>0;return this.uint32(l),l&&this._push(rc.writeBytesBuffer,l,h),this},rc.prototype.string=function(h){var l=W.Buffer.byteLength(h);return this.uint32(l),l&&this._push(Ov,l,h),this},rc._configure();var ej=Qa,Ml,Jn=W.LongBits,RC=W.utf8,ws="undefined"!=typeof Uint8Array?function(h){if(h instanceof Uint8Array||Array.isArray(h))return new Qa(h);throw Error("illegal buffer")}:function(h){if(Array.isArray(h))return new Qa(h);throw Error("illegal buffer")},xs=function(){return W.Buffer?function(h){return(Qa.create=function(l){return W.Buffer.isBuffer(l)?new Ml(l):ws(l)})(h)}:ws};Qa.create=xs(),Qa.prototype._slice=W.Array.prototype.subarray||W.Array.prototype.slice,Qa.prototype.uint32=function(){var h=4294967295;return function(){if(h=(127&this.buf[this.pos])>>>0,128>this.buf[this.pos++]||(h=(h|(127&this.buf[this.pos])<<7)>>>0,128>this.buf[this.pos++])||(h=(h|(127&this.buf[this.pos])<<14)>>>0,128>this.buf[this.pos++])||(h=(h|(127&this.buf[this.pos])<<21)>>>0,128>this.buf[this.pos++])||(h=(h|(15&this.buf[this.pos])<<28)>>>0,128>this.buf[this.pos++]))return h;if((this.pos+=5)>this.len)throw this.pos=this.len,dc(this,10);return h}}(),Qa.prototype.int32=function(){return 0|this.uint32()},Qa.prototype.sint32=function(){var h=this.uint32();return h>>>1^-(1&h)|0},Qa.prototype.bool=function(){return 0!==this.uint32()},Qa.prototype.fixed32=function(){if(this.pos+4>this.len)throw dc(this,4);return Wg(this.buf,this.pos+=4)},Qa.prototype.sfixed32=function(){if(this.pos+4>this.len)throw dc(this,4);return 0|Wg(this.buf,this.pos+=4)},Qa.prototype.float=function(){if(this.pos+4>this.len)throw dc(this,4);var h=W.float.readFloatLE(this.buf,this.pos);return this.pos+=4,h},Qa.prototype.double=function(){if(this.pos+8>this.len)throw dc(this,4);var h=W.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,h},Qa.prototype.bytes=function(){var h=this.uint32(),l=this.pos,g=this.pos+h;if(g>this.len)throw dc(this,h);return this.pos+=h,Array.isArray(this.buf)?this.buf.slice(l,g):l===g?new this.buf.constructor(0):this._slice.call(this.buf,l,g)},Qa.prototype.string=function(){var h=this.bytes();return RC.read(h,0,h.length)},Qa.prototype.skip=function(h){if("number"==typeof h){if(this.pos+h>this.len)throw dc(this,h);this.pos+=h}else do{if(this.pos>=this.len)throw dc(this)}while(128&this.buf[this.pos++]);return this},Qa.prototype.skipType=function(h){switch(h){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(h=7&this.uint32());)this.skipType(h);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+h+" at offset "+this.pos)}return this},Qa._configure=function(h){Ml=h,Qa.create=xs(),Ml._configure();var l=W.Long?"toLong":"toNumber";W.merge(Qa.prototype,{int64:function(){return dj.call(this)[l](!1)},uint64:function(){return dj.call(this)[l](!0)},sint64:function(){return dj.call(this).zzDecode()[l](!1)},fixed64:function(){return Kn.call(this)[l](!0)},sfixed64:function(){return Kn.call(this)[l](!1)}})},(Od.prototype=Object.create(ej.prototype)).constructor=Od,Od._configure=function(){W.Buffer&&(Od.prototype._slice=W.Buffer.prototype.slice)},Od.prototype.string=function(){var h=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+h,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+h,this.len))},Od._configure(),(Lf.prototype=Object.create(W.EventEmitter.prototype)).constructor=Lf,Lf.prototype.rpcCall=function h(l,g,f,k,q){if(!k)throw TypeError("request must be specified");var _r=this;if(!q)return W.asPromise(h,_r,l,g,f,k);if(_r.rpcImpl)try{return _r.rpcImpl(l,g[_r.requestDelimited?"encodeDelimited":"encode"](k).finish(),function(_s,ga){if(_s)return _r.emit("error",_s,l),q(_s);if(null!==ga){if(!(ga instanceof f))try{ga=f[_r.responseDelimited?"decodeDelimited":"decode"](ga)}catch(_l){return _r.emit("error",_l,l),q(_l)}return _r.emit("data",ga,l),q(null,ga)}_r.end(!0)})}catch(_s){_r.emit("error",_s,l),setTimeout(function(){q(_s)},0)}else setTimeout(function(){q(Error("already ended"))},0)},Lf.prototype.end=function(h){return this.rpcImpl&&(h||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var SC=cb(function(h,l){l.Service=Lf}),TC={},nc=cb(function(h,l){function g(){f.util._configure(),f.Writer._configure(f.BufferWriter),f.Reader._configure(f.BufferReader)}var f=l;f.build="minimal",f.Writer=cj,f.BufferWriter=rc,f.Reader=ej,f.BufferReader=Od,f.util=W,f.rpc=SC,f.roots=TC,f.configure=g,g()});nc.util.Long=U,nc.configure();var u=nc.Reader,N=nc.Writer,r=nc.util,t=nc.roots.default||(nc.roots.default={}),UC=t.URI=function(){var h={},l=Object.create(h);return l[h[0]="Unknown"]=0,l[h[1]="PingUri"]=1,l[h[2]="PongUri"]=2,l[h[11]="UserJoinUri"]=11,l[h[12]="UserRespUri"]=12,l[h[21]="UserQuitUri"]=21,l[h[22]="UserDropUri"]=22,l[h[31]="GroupEnterUri"]=31,l[h[32]="GroupLeaveUri"]=32,l[h[33]="GroupReplyUri"]=33,l[h[36]="GroupEnterNoticeUri"]=36,l[h[37]="GroupLeaveNoticeUri"]=37,l[h[38]="GroupEventNoticeUri"]=38,l[h[39]="GroupCountNoticeUri"]=39,l[h[41]="UserStatusListUri"]=41,l[h[42]="UserStatusResultUri"]=42,l[h[51]="GroupStatusListUri"]=51,l[h[52]="GroupStatusResultUri"]=52,l[h[55]="GroupAllUsersListUri"]=55,l[h[56]="GroupAllUsersResultUri"]=56,l[h[100]="MessageUri"]=100,l[h[101]="AckUri"]=101,l[h[115]="FileUploadIndexGetUri"]=115,l[h[116]="FileUploadIndexRetUri"]=116,l[h[117]="FileUploadIndexSetUri"]=117,l[h[118]="FileUploadIndexFinUri"]=118,l[h[119]="FileUploadIndexErrUri"]=119,l[h[125]="FileDownloadIndexGetUri"]=125,l[h[126]="FileDownloadIndexRetUri"]=126,l[h[127]="FileDownloadIndexErrUri"]=127,l[h[201]="UserJoinNoticeUri"]=201,l[h[202]="UserQuitNoticeUri"]=202,l[h[203]="UserWaitNoticeUri"]=203,l[h[301]="UserAttributeGetUri"]=301,l[h[302]="UserAttributeRetUri"]=302,l[h[303]="UserAttributeSetUri"]=303,l[h[304]="UserAttributeModUri"]=304,l[h[305]="UserAttributeDelUri"]=305,l[h[307]="UserAttributeRspUri"]=307,l[h[308]="UserAttributeErrUri"]=308,l[h[311]="UserAttributeKeysGetUri"]=311,l[h[312]="UserAttributeKeysRetUri"]=312,l[h[351]="GroupAttributeGetUri"]=351,l[h[352]="GroupAttributeRetUri"]=352,l[h[353]="GroupAttributeSetUri"]=353,l[h[354]="GroupAttributeModUri"]=354,l[h[355]="GroupAttributeDelUri"]=355,l[h[356]="GroupAttributeAltUri"]=356,l[h[357]="GroupAttributeRspUri"]=357,l[h[358]="GroupAttributeErrUri"]=358,l[h[361]="GroupAttributeKeysGetUri"]=361,l[h[362]="GroupAttributeKeysRetUri"]=362,l[h[401]="SubscribeUserStatusUri"]=401,l[h[402]="UnsubscribeUserStatusUri"]=402,l[h[499]="SubscribeResponseUri"]=499,l}(),mi=t.Wrapper=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.uri=0,h.prototype.data=r.newBuffer([]),h.encode=function(l,g){return g||(g=N.create()),null!=l.uri&&Object.hasOwnProperty.call(l,"uri")&&g.uint32(8).int32(l.uri),null!=l.data&&Object.hasOwnProperty.call(l,"data")&&g.uint32(18).bytes(l.data),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.Wrapper;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.uri=l.int32();break;case 2:f.data=l.bytes();break;default:l.skipType(7&k)}}return f},h}(),VC=t.Ping=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.ms=r.Long?r.Long.fromBits(0,0,!0):0,h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.ms&&Object.hasOwnProperty.call(l,"ms")&&g.uint32(16).uint64(l.ms),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.Ping;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.ms=l.uint64();break;default:l.skipType(7&k)}}return f},h}(),WC=t.Pong=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.ms=r.Long?r.Long.fromBits(0,0,!0):0,h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.ms&&Object.hasOwnProperty.call(l,"ms")&&g.uint32(16).uint64(l.ms),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.Pong;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.ms=l.uint64();break;default:l.skipType(7&k)}}return f},h}(),XC=t.UserJoin=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.opt=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.account="",h.prototype.ticket="",h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.opt&&Object.hasOwnProperty.call(l,"opt")&&g.uint32(16).uint64(l.opt),null!=l.instance&&Object.hasOwnProperty.call(l,"instance")&&g.uint32(24).uint64(l.instance),null!=l.account&&Object.hasOwnProperty.call(l,"account")&&g.uint32(34).string(l.account),null!=l.ticket&&Object.hasOwnProperty.call(l,"ticket")&&g.uint32(42).string(l.ticket),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserJoin;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.opt=l.uint64();break;case 3:f.instance=l.uint64();break;case 4:f.account=l.string();break;case 5:f.ticket=l.string();break;default:l.skipType(7&k)}}return f},h}(),YC=t.UserResp=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.account="",h.prototype.code=0,h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.account&&Object.hasOwnProperty.call(l,"account")&&g.uint32(18).string(l.account),null!=l.code&&Object.hasOwnProperty.call(l,"code")&&g.uint32(24).uint32(l.code),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserResp;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.account=l.string();break;case 3:f.code=l.uint32();break;default:l.skipType(7&k)}}return f},h}(),ZC=t.UserQuit=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.encode=function(l,g){return g||(g=N.create()),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserQuit;l.pos<g;){var k=l.uint32();l.skipType(7&k)}return f},h}(),$C=t.UserDrop=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.code=0,h.encode=function(l,g){return g||(g=N.create()),null!=l.code&&Object.hasOwnProperty.call(l,"code")&&g.uint32(8).uint32(l.code),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserDrop;l.pos<g;){var k=l.uint32();k>>>3==1?f.code=l.uint32():l.skipType(7&k)}return f},h}(),aD=t.GroupEnter=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.account="",h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.account&&Object.hasOwnProperty.call(l,"account")&&g.uint32(18).string(l.account),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupEnter;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.account=l.string();break;default:l.skipType(7&k)}}return f},h}(),bD=t.GroupLeave=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.account="",h.encode=function(l,g){return g||(g=N.create()),null!=l.account&&Object.hasOwnProperty.call(l,"account")&&g.uint32(10).string(l.account),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupLeave;l.pos<g;){var k=l.uint32();k>>>3==1?f.account=l.string():l.skipType(7&k)}return f},h}(),cD=t.GroupReply=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.account="",h.prototype.code=0,h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.account&&Object.hasOwnProperty.call(l,"account")&&g.uint32(18).string(l.account),null!=l.code&&Object.hasOwnProperty.call(l,"code")&&g.uint32(24).uint32(l.code),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupReply;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.account=l.string();break;case 3:f.code=l.uint32();break;default:l.skipType(7&k)}}return f},h}(),ys=t.GroupLeaveNotice=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.user="",h.prototype.group="",h.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.size=0,h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.user&&Object.hasOwnProperty.call(l,"user")&&g.uint32(18).string(l.user),null!=l.group&&Object.hasOwnProperty.call(l,"group")&&g.uint32(26).string(l.group),null!=l.instance&&Object.hasOwnProperty.call(l,"instance")&&g.uint32(32).uint64(l.instance),null!=l.size&&Object.hasOwnProperty.call(l,"size")&&g.uint32(40).uint32(l.size),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupLeaveNotice;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.user=l.string();break;case 3:f.group=l.string();break;case 4:f.instance=l.uint64();break;case 5:f.size=l.uint32();break;default:l.skipType(7&k)}}return f},h}(),zs=t.GroupEnterNotice=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.user="",h.prototype.group="",h.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.size=0,h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.user&&Object.hasOwnProperty.call(l,"user")&&g.uint32(18).string(l.user),null!=l.group&&Object.hasOwnProperty.call(l,"group")&&g.uint32(26).string(l.group),null!=l.instance&&Object.hasOwnProperty.call(l,"instance")&&g.uint32(32).uint64(l.instance),null!=l.size&&Object.hasOwnProperty.call(l,"size")&&g.uint32(40).uint32(l.size),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupEnterNotice;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.user=l.string();break;case 3:f.group=l.string();break;case 4:f.instance=l.uint64();break;case 5:f.size=l.uint32();break;default:l.skipType(7&k)}}return f},h}(),As=t.Message=function(){function h(l){if(this.MiscMap={},l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.dialogue=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.sequence=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.options=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.src="",h.prototype.dst="",h.prototype.payload=r.newBuffer([]),h.prototype.MiscMap=r.emptyObject,h.prototype.ms=r.Long?r.Long.fromBits(0,0,!0):0,h.encode=function(l,g){if(g||(g=N.create()),null!=l.instance&&Object.hasOwnProperty.call(l,"instance")&&g.uint32(8).uint64(l.instance),null!=l.dialogue&&Object.hasOwnProperty.call(l,"dialogue")&&g.uint32(16).uint64(l.dialogue),null!=l.sequence&&Object.hasOwnProperty.call(l,"sequence")&&g.uint32(24).uint64(l.sequence),null!=l.options&&Object.hasOwnProperty.call(l,"options")&&g.uint32(32).uint64(l.options),null!=l.src&&Object.hasOwnProperty.call(l,"src")&&g.uint32(42).string(l.src),null!=l.dst&&Object.hasOwnProperty.call(l,"dst")&&g.uint32(50).string(l.dst),null!=l.payload&&Object.hasOwnProperty.call(l,"payload")&&g.uint32(58).bytes(l.payload),null!=l.MiscMap&&Object.hasOwnProperty.call(l,"MiscMap"))for(var f=Object.keys(l.MiscMap),k=0;k<f.length;++k)g.uint32(66).fork().uint32(10).string(f[k]).uint32(18).bytes(l.MiscMap[f[k]]).ldelim();return null!=l.ms&&Object.hasOwnProperty.call(l,"ms")&&g.uint32(72).uint64(l.ms),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f,k,q=new t.Message;l.pos<g;)switch(f=l.uint32(),f>>>3){case 1:q.instance=l.uint64();break;case 2:q.dialogue=l.uint64();break;case 3:q.sequence=l.uint64();break;case 4:q.options=l.uint64();break;case 5:q.src=l.string();break;case 6:q.dst=l.string();break;case 7:q.payload=l.bytes();break;case 8:q.MiscMap===r.emptyObject&&(q.MiscMap={});var _r=l.uint32()+l.pos;for(f="",k=[];l.pos<_r;){var _s=l.uint32();switch(_s>>>3){case 1:f=l.string();break;case 2:k=l.bytes();break;default:l.skipType(7&_s)}}q.MiscMap[f]=k;break;case 9:q.ms=l.uint64();break;default:l.skipType(7&f)}return q},h}(),Bs=t.Ack=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.dialogue=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.sequence=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.code=0,h.encode=function(l,g){return g||(g=N.create()),null!=l.instance&&Object.hasOwnProperty.call(l,"instance")&&g.uint32(8).uint64(l.instance),null!=l.dialogue&&Object.hasOwnProperty.call(l,"dialogue")&&g.uint32(16).uint64(l.dialogue),null!=l.sequence&&Object.hasOwnProperty.call(l,"sequence")&&g.uint32(24).uint64(l.sequence),null!=l.code&&Object.hasOwnProperty.call(l,"code")&&g.uint32(32).uint32(l.code),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.Ack;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.instance=l.uint64();break;case 2:f.dialogue=l.uint64();break;case 3:f.sequence=l.uint64();break;case 4:f.code=l.uint32();break;default:l.skipType(7&k)}}return f},h}(),dD=t.FileUploadIndexGet=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.hash=r.newBuffer([]),h.prototype.size=0,h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.hash&&Object.hasOwnProperty.call(l,"hash")&&g.uint32(18).bytes(l.hash),null!=l.size&&Object.hasOwnProperty.call(l,"size")&&g.uint32(24).uint32(l.size),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.FileUploadIndexGet;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.hash=l.bytes();break;case 3:f.size=l.uint32();break;default:l.skipType(7&k)}}return f},h}(),eD=t.FileUploadIndexRet=function(){function h(l){if(this.servers=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.unit=0,h.prototype.servers=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.unit&&Object.hasOwnProperty.call(l,"unit")&&g.uint32(16).uint32(l.unit),null!=l.servers&&l.servers.length){g.uint32(26).fork();for(var f=0;f<l.servers.length;++f)g.uint32(l.servers[f]);g.ldelim()}return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.FileUploadIndexRet;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.unit=l.uint32();break;case 3:if(f.servers&&f.servers.length||(f.servers=[]),2==(7&k))for(k=l.uint32()+l.pos;l.pos<k;)f.servers.push(l.uint32());else f.servers.push(l.uint32());break;default:l.skipType(7&k)}}return f},h}(),fD=t.FileUploadIndexSet=function(){function h(l){if(this.servers=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.hash=r.newBuffer([]),h.prototype.unit=0,h.prototype.servers=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.hash&&Object.hasOwnProperty.call(l,"hash")&&g.uint32(18).bytes(l.hash),null!=l.unit&&Object.hasOwnProperty.call(l,"unit")&&g.uint32(24).uint32(l.unit),null!=l.servers&&l.servers.length){g.uint32(34).fork();for(var f=0;f<l.servers.length;++f)g.uint32(l.servers[f]);g.ldelim()}return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.FileUploadIndexSet;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.hash=l.bytes();break;case 3:f.unit=l.uint32();break;case 4:if(f.servers&&f.servers.length||(f.servers=[]),2==(7&k))for(k=l.uint32()+l.pos;l.pos<k;)f.servers.push(l.uint32());else f.servers.push(l.uint32());break;default:l.skipType(7&k)}}return f},h}(),gD=t.FileUploadIndexFin=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.zone=0,h.prototype.unit=0,h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.zone&&Object.hasOwnProperty.call(l,"zone")&&g.uint32(16).uint32(l.zone),null!=l.unit&&Object.hasOwnProperty.call(l,"unit")&&g.uint32(24).uint32(l.unit),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.FileUploadIndexFin;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.zone=l.uint32();break;case 3:f.unit=l.uint32();break;default:l.skipType(7&k)}}return f},h}(),hD=t.FileUploadIndexErr=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.code=0,h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.code&&Object.hasOwnProperty.call(l,"code")&&g.uint32(16).uint32(l.code),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.FileUploadIndexErr;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.code=l.uint32();break;default:l.skipType(7&k)}}return f},h}(),iD=t.FileDownloadIndexGet=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.zone=0,h.prototype.hash=r.newBuffer([]),h.prototype.size=0,h.prototype.unit=0,h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.zone&&Object.hasOwnProperty.call(l,"zone")&&g.uint32(16).uint32(l.zone),null!=l.hash&&Object.hasOwnProperty.call(l,"hash")&&g.uint32(26).bytes(l.hash),null!=l.size&&Object.hasOwnProperty.call(l,"size")&&g.uint32(32).uint32(l.size),null!=l.unit&&Object.hasOwnProperty.call(l,"unit")&&g.uint32(40).uint32(l.unit),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.FileDownloadIndexGet;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.zone=l.uint32();break;case 3:f.hash=l.bytes();break;case 4:f.size=l.uint32();break;case 5:f.unit=l.uint32();break;default:l.skipType(7&k)}}return f},h}(),jD=t.FileDownloadIndexRet=function(){function h(l){if(this.servers=[],this.backups=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.unit=0,h.prototype.zone=0,h.prototype.servers=r.emptyArray,h.prototype.backups=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.unit&&Object.hasOwnProperty.call(l,"unit")&&g.uint32(16).uint32(l.unit),null!=l.zone&&Object.hasOwnProperty.call(l,"zone")&&g.uint32(24).uint32(l.zone),null!=l.servers&&l.servers.length){g.uint32(34).fork();for(var f=0;f<l.servers.length;++f)g.uint32(l.servers[f]);g.ldelim()}if(null!=l.backups&&l.backups.length){for(g.uint32(42).fork(),f=0;f<l.backups.length;++f)g.uint32(l.backups[f]);g.ldelim()}return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.FileDownloadIndexRet;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.unit=l.uint32();break;case 3:f.zone=l.uint32();break;case 4:if(f.servers&&f.servers.length||(f.servers=[]),2==(7&k))for(k=l.uint32()+l.pos;l.pos<k;)f.servers.push(l.uint32());else f.servers.push(l.uint32());break;case 5:if(f.backups&&f.backups.length||(f.backups=[]),2==(7&k))for(k=l.uint32()+l.pos;l.pos<k;)f.backups.push(l.uint32());else f.backups.push(l.uint32());break;default:l.skipType(7&k)}}return f},h}(),kD=t.FileDownloadIndexErr=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.code=0,h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.code&&Object.hasOwnProperty.call(l,"code")&&g.uint32(16).uint32(l.code),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.FileDownloadIndexErr;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.code=l.uint32();break;default:l.skipType(7&k)}}return f},h}(),lD=t.GroupAllUsersList=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.group="",h.prototype.pageSize=0,h.prototype.pageNumber=0,h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.group&&Object.hasOwnProperty.call(l,"group")&&g.uint32(18).string(l.group),null!=l.pageSize&&Object.hasOwnProperty.call(l,"pageSize")&&g.uint32(24).uint32(l.pageSize),null!=l.pageNumber&&Object.hasOwnProperty.call(l,"pageNumber")&&g.uint32(32).uint32(l.pageNumber),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupAllUsersList;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.group=l.string();break;case 3:f.pageSize=l.uint32();break;case 4:f.pageNumber=l.uint32();break;default:l.skipType(7&k)}}return f},h}(),mD=t.GroupAllUsersResult=function(){function h(l){if(this.memberInfos=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.group="",h.prototype.totalSize=0,h.prototype.pageSize=0,h.prototype.pageNumber=0,h.prototype.memberInfos=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.group&&Object.hasOwnProperty.call(l,"group")&&g.uint32(18).string(l.group),null!=l.totalSize&&Object.hasOwnProperty.call(l,"totalSize")&&g.uint32(24).uint32(l.totalSize),null!=l.pageSize&&Object.hasOwnProperty.call(l,"pageSize")&&g.uint32(32).uint32(l.pageSize),null!=l.pageNumber&&Object.hasOwnProperty.call(l,"pageNumber")&&g.uint32(40).uint32(l.pageNumber),null!=l.memberInfos&&l.memberInfos.length)for(var f=0;f<l.memberInfos.length;++f)t.GroupAllUsersResult.MemberInfo.encode(l.memberInfos[f],g.uint32(50).fork()).ldelim();return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupAllUsersResult;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.group=l.string();break;case 3:f.totalSize=l.uint32();break;case 4:f.pageSize=l.uint32();break;case 5:f.pageNumber=l.uint32();break;case 6:f.memberInfos&&f.memberInfos.length||(f.memberInfos=[]),f.memberInfos.push(t.GroupAllUsersResult.MemberInfo.decode(l,l.uint32()));break;default:l.skipType(7&k)}}return f},h.MemberInfo=function(){function l(g){if(g)for(var f=Object.keys(g),k=0;k<f.length;++k)null!=g[f[k]]&&(this[f[k]]=g[f[k]])}return l.prototype.account="",l.prototype.ts=0,l.encode=function(g,f){return f||(f=N.create()),null!=g.account&&Object.hasOwnProperty.call(g,"account")&&f.uint32(10).string(g.account),null!=g.ts&&Object.hasOwnProperty.call(g,"ts")&&f.uint32(16).uint32(g.ts),f},l.decode=function(g,f){g instanceof u||(g=u.create(g)),f=void 0===f?g.len:g.pos+f;for(var k=new t.GroupAllUsersResult.MemberInfo;g.pos<f;){var q=g.uint32();switch(q>>>3){case 1:k.account=g.string();break;case 2:k.ts=g.uint32();break;default:g.skipType(7&q)}}return k},l}(),h}(),nD=t.UserStatusList=function(){function h(l){if(this.users=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.users=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.users&&l.users.length)for(var f=0;f<l.users.length;++f)g.uint32(18).string(l.users[f]);return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserStatusList;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.users&&f.users.length||(f.users=[]),f.users.push(l.string());break;default:l.skipType(7&k)}}return f},h}(),oD=t.UserStatusResult=function(){function h(l){if(this.userInfos=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.userInfos=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.userInfos&&l.userInfos.length)for(var f=0;f<l.userInfos.length;++f)t.UserStatusResult.UserStatusInfo.encode(l.userInfos[f],g.uint32(18).fork()).ldelim();return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserStatusResult;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.userInfos&&f.userInfos.length||(f.userInfos=[]),f.userInfos.push(t.UserStatusResult.UserStatusInfo.decode(l,l.uint32()));break;default:l.skipType(7&k)}}return f},h.UserStatusInfo=function(){function l(g){if(g)for(var f=Object.keys(g),k=0;k<f.length;++k)null!=g[f[k]]&&(this[f[k]]=g[f[k]])}return l.prototype.account="",l.prototype.ts=0,l.encode=function(g,f){return f||(f=N.create()),null!=g.account&&Object.hasOwnProperty.call(g,"account")&&f.uint32(10).string(g.account),null!=g.ts&&Object.hasOwnProperty.call(g,"ts")&&f.uint32(16).uint32(g.ts),f},l.decode=function(g,f){g instanceof u||(g=u.create(g)),f=void 0===f?g.len:g.pos+f;for(var k=new t.UserStatusResult.UserStatusInfo;g.pos<f;){var q=g.uint32();switch(q>>>3){case 1:k.account=g.string();break;case 2:k.ts=g.uint32();break;default:g.skipType(7&q)}}return k},l}(),h}(),pD=t.UserAttributeGet=function(){function h(l){if(this.attributes=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.account="",h.prototype.attributes=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.account&&Object.hasOwnProperty.call(l,"account")&&g.uint32(18).string(l.account),null!=l.attributes&&l.attributes.length)for(var f=0;f<l.attributes.length;++f)g.uint32(26).string(l.attributes[f]);return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserAttributeGet;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.account=l.string();break;case 3:f.attributes&&f.attributes.length||(f.attributes=[]),f.attributes.push(l.string());break;default:l.skipType(7&k)}}return f},h}(),qD=t.UserAttributeRet=function(){function h(l){if(this.attributeInfos=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.attributeInfos=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.attributeInfos&&l.attributeInfos.length)for(var f=0;f<l.attributeInfos.length;++f)t.UserAttributeRet.AttributeInfo.encode(l.attributeInfos[f],g.uint32(18).fork()).ldelim();return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserAttributeRet;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.attributeInfos&&f.attributeInfos.length||(f.attributeInfos=[]),f.attributeInfos.push(t.UserAttributeRet.AttributeInfo.decode(l,l.uint32()));break;default:l.skipType(7&k)}}return f},h.AttributeInfo=function(){function l(g){if(g)for(var f=Object.keys(g),k=0;k<f.length;++k)null!=g[f[k]]&&(this[f[k]]=g[f[k]])}return l.prototype.key="",l.prototype.value="",l.encode=function(g,f){return f||(f=N.create()),null!=g.key&&Object.hasOwnProperty.call(g,"key")&&f.uint32(10).string(g.key),null!=g.value&&Object.hasOwnProperty.call(g,"value")&&f.uint32(18).string(g.value),f},l.decode=function(g,f){g instanceof u||(g=u.create(g)),f=void 0===f?g.len:g.pos+f;for(var k=new t.UserAttributeRet.AttributeInfo;g.pos<f;){var q=g.uint32();switch(q>>>3){case 1:k.key=g.string();break;case 2:k.value=g.string();break;default:g.skipType(7&q)}}return k},l}(),h}(),rD=t.UserAttributeSet=function(){function h(l){if(this.attributeInfos=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.account="",h.prototype.attributeInfos=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.account&&Object.hasOwnProperty.call(l,"account")&&g.uint32(18).string(l.account),null!=l.attributeInfos&&l.attributeInfos.length)for(var f=0;f<l.attributeInfos.length;++f)t.UserAttributeSet.AttributeInfo.encode(l.attributeInfos[f],g.uint32(26).fork()).ldelim();return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserAttributeSet;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.account=l.string();break;case 3:f.attributeInfos&&f.attributeInfos.length||(f.attributeInfos=[]),f.attributeInfos.push(t.UserAttributeSet.AttributeInfo.decode(l,l.uint32()));break;default:l.skipType(7&k)}}return f},h.AttributeInfo=function(){function l(g){if(g)for(var f=Object.keys(g),k=0;k<f.length;++k)null!=g[f[k]]&&(this[f[k]]=g[f[k]])}return l.prototype.key="",l.prototype.value="",l.encode=function(g,f){return f||(f=N.create()),null!=g.key&&Object.hasOwnProperty.call(g,"key")&&f.uint32(10).string(g.key),null!=g.value&&Object.hasOwnProperty.call(g,"value")&&f.uint32(18).string(g.value),f},l.decode=function(g,f){g instanceof u||(g=u.create(g)),f=void 0===f?g.len:g.pos+f;for(var k=new t.UserAttributeSet.AttributeInfo;g.pos<f;){var q=g.uint32();switch(q>>>3){case 1:k.key=g.string();break;case 2:k.value=g.string();break;default:g.skipType(7&q)}}return k},l}(),h}(),sD=t.UserAttributeMod=function(){function h(l){if(this.attributeInfos=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.account="",h.prototype.attributeInfos=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.account&&Object.hasOwnProperty.call(l,"account")&&g.uint32(18).string(l.account),null!=l.attributeInfos&&l.attributeInfos.length)for(var f=0;f<l.attributeInfos.length;++f)t.UserAttributeMod.AttributeInfo.encode(l.attributeInfos[f],g.uint32(26).fork()).ldelim();return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserAttributeMod;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.account=l.string();break;case 3:f.attributeInfos&&f.attributeInfos.length||(f.attributeInfos=[]),f.attributeInfos.push(t.UserAttributeMod.AttributeInfo.decode(l,l.uint32()));break;default:l.skipType(7&k)}}return f},h.AttributeInfo=function(){function l(g){if(g)for(var f=Object.keys(g),k=0;k<f.length;++k)null!=g[f[k]]&&(this[f[k]]=g[f[k]])}return l.prototype.key="",l.prototype.value="",l.encode=function(g,f){return f||(f=N.create()),null!=g.key&&Object.hasOwnProperty.call(g,"key")&&f.uint32(10).string(g.key),null!=g.value&&Object.hasOwnProperty.call(g,"value")&&f.uint32(18).string(g.value),f},l.decode=function(g,f){g instanceof u||(g=u.create(g)),f=void 0===f?g.len:g.pos+f;for(var k=new t.UserAttributeMod.AttributeInfo;g.pos<f;){var q=g.uint32();switch(q>>>3){case 1:k.key=g.string();break;case 2:k.value=g.string();break;default:g.skipType(7&q)}}return k},l}(),h}(),tD=t.UserAttributeDel=function(){function h(l){if(this.attributes=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.account="",h.prototype.attributes=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.account&&Object.hasOwnProperty.call(l,"account")&&g.uint32(18).string(l.account),null!=l.attributes&&l.attributes.length)for(var f=0;f<l.attributes.length;++f)g.uint32(26).string(l.attributes[f]);return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserAttributeDel;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.account=l.string();break;case 3:f.attributes&&f.attributes.length||(f.attributes=[]),f.attributes.push(l.string());break;default:l.skipType(7&k)}}return f},h}(),uD=t.UserAttributeErr=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.code=0,h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.code&&Object.hasOwnProperty.call(l,"code")&&g.uint32(16).uint32(l.code),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserAttributeErr;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.code=l.uint32();break;default:l.skipType(7&k)}}return f},h}(),vD=t.UserAttributeKeysGet=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.account="",h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.account&&Object.hasOwnProperty.call(l,"account")&&g.uint32(18).string(l.account),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserAttributeKeysGet;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.account=l.string();break;default:l.skipType(7&k)}}return f},h}(),wD=t.UserAttributeKeysRet=function(){function h(l){if(this.keys=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.keys=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.keys&&l.keys.length)for(var f=0;f<l.keys.length;++f)g.uint32(18).string(l.keys[f]);return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserAttributeKeysRet;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.keys&&f.keys.length||(f.keys=[]),f.keys.push(l.string());break;default:l.skipType(7&k)}}return f},h}(),xD=t.UserAttributeRsp=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserAttributeRsp;l.pos<g;){var k=l.uint32();k>>>3==1?f.seq=l.uint64():l.skipType(7&k)}return f},h}(),yD=t.GroupStatusList=function(){function h(l){if(this.groups=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.groups=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.groups&&l.groups.length)for(var f=0;f<l.groups.length;++f)g.uint32(18).string(l.groups[f]);return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupStatusList;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.groups&&f.groups.length||(f.groups=[]),f.groups.push(l.string());break;default:l.skipType(7&k)}}return f},h}(),zD=t.GroupStatusResult=function(){function h(l){if(this.groupInfos=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.groupInfos=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.groupInfos&&l.groupInfos.length)for(var f=0;f<l.groupInfos.length;++f)t.GroupStatusResult.GroupInfo.encode(l.groupInfos[f],g.uint32(18).fork()).ldelim();return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupStatusResult;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.groupInfos&&f.groupInfos.length||(f.groupInfos=[]),f.groupInfos.push(t.GroupStatusResult.GroupInfo.decode(l,l.uint32()));break;default:l.skipType(7&k)}}return f},h.GroupInfo=function(){function l(g){if(g)for(var f=Object.keys(g),k=0;k<f.length;++k)null!=g[f[k]]&&(this[f[k]]=g[f[k]])}return l.prototype.group="",l.prototype.memberCount=0,l.encode=function(g,f){return f||(f=N.create()),null!=g.group&&Object.hasOwnProperty.call(g,"group")&&f.uint32(10).string(g.group),null!=g.memberCount&&Object.hasOwnProperty.call(g,"memberCount")&&f.uint32(16).uint32(g.memberCount),f},l.decode=function(g,f){g instanceof u||(g=u.create(g)),f=void 0===f?g.len:g.pos+f;for(var k=new t.GroupStatusResult.GroupInfo;g.pos<f;){var q=g.uint32();switch(q>>>3){case 1:k.group=g.string();break;case 2:k.memberCount=g.uint32();break;default:g.skipType(7&q)}}return k},l}(),h}(),AD=t.GroupCountNotice=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.group="",h.prototype.size=0,h.encode=function(l,g){return g||(g=N.create()),null!=l.instance&&Object.hasOwnProperty.call(l,"instance")&&g.uint32(8).uint64(l.instance),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(16).uint64(l.seq),null!=l.group&&Object.hasOwnProperty.call(l,"group")&&g.uint32(26).string(l.group),null!=l.size&&Object.hasOwnProperty.call(l,"size")&&g.uint32(32).uint32(l.size),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupCountNotice;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.instance=l.uint64();break;case 2:f.seq=l.uint64();break;case 3:f.group=l.string();break;case 4:f.size=l.uint32();break;default:l.skipType(7&k)}}return f},h}(),BD=t.GroupAttributeGet=function(){function h(l){if(this.attributes=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.group="",h.prototype.attributes=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.group&&Object.hasOwnProperty.call(l,"group")&&g.uint32(18).string(l.group),null!=l.attributes&&l.attributes.length)for(var f=0;f<l.attributes.length;++f)g.uint32(26).string(l.attributes[f]);return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupAttributeGet;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.group=l.string();break;case 3:f.attributes&&f.attributes.length||(f.attributes=[]),f.attributes.push(l.string());break;default:l.skipType(7&k)}}return f},h}(),CD=t.GroupAttributeRet=function(){function h(l){if(this.attributeMaps=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.attributeMaps=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.attributeMaps&&l.attributeMaps.length)for(var f=0;f<l.attributeMaps.length;++f)t.GroupAttributeRet.AttributeMap.encode(l.attributeMaps[f],g.uint32(18).fork()).ldelim();return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupAttributeRet;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.attributeMaps&&f.attributeMaps.length||(f.attributeMaps=[]),f.attributeMaps.push(t.GroupAttributeRet.AttributeMap.decode(l,l.uint32()));break;default:l.skipType(7&k)}}return f},h.AttributeMap=function(){function l(g){if(g)for(var f=Object.keys(g),k=0;k<f.length;++k)null!=g[f[k]]&&(this[f[k]]=g[f[k]])}return l.prototype.key="",l.prototype.value="",l.prototype.origin="",l.prototype.ms=r.Long?r.Long.fromBits(0,0,!0):0,l.encode=function(g,f){return f||(f=N.create()),null!=g.key&&Object.hasOwnProperty.call(g,"key")&&f.uint32(10).string(g.key),null!=g.value&&Object.hasOwnProperty.call(g,"value")&&f.uint32(18).string(g.value),null!=g.origin&&Object.hasOwnProperty.call(g,"origin")&&f.uint32(26).string(g.origin),null!=g.ms&&Object.hasOwnProperty.call(g,"ms")&&f.uint32(32).uint64(g.ms),f},l.decode=function(g,f){g instanceof u||(g=u.create(g)),f=void 0===f?g.len:g.pos+f;for(var k=new t.GroupAttributeRet.AttributeMap;g.pos<f;){var q=g.uint32();switch(q>>>3){case 1:k.key=g.string();break;case 2:k.value=g.string();break;case 3:k.origin=g.string();break;case 4:k.ms=g.uint64();break;default:g.skipType(7&q)}}return k},l}(),h}(),DD=t.GroupAttributeSet=function(){function h(l){if(this.attributeInfos=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.group="",h.prototype.broadcast=!1,h.prototype.attributeInfos=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.group&&Object.hasOwnProperty.call(l,"group")&&g.uint32(18).string(l.group),null!=l.broadcast&&Object.hasOwnProperty.call(l,"broadcast")&&g.uint32(24).bool(l.broadcast),null!=l.attributeInfos&&l.attributeInfos.length)for(var f=0;f<l.attributeInfos.length;++f)t.GroupAttributeSet.AttributeInfo.encode(l.attributeInfos[f],g.uint32(34).fork()).ldelim();return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupAttributeSet;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.group=l.string();break;case 3:f.broadcast=l.bool();break;case 4:f.attributeInfos&&f.attributeInfos.length||(f.attributeInfos=[]),f.attributeInfos.push(t.GroupAttributeSet.AttributeInfo.decode(l,l.uint32()));break;default:l.skipType(7&k)}}return f},h.AttributeInfo=function(){function l(g){if(g)for(var f=Object.keys(g),k=0;k<f.length;++k)null!=g[f[k]]&&(this[f[k]]=g[f[k]])}return l.prototype.key="",l.prototype.value="",l.encode=function(g,f){return f||(f=N.create()),null!=g.key&&Object.hasOwnProperty.call(g,"key")&&f.uint32(10).string(g.key),null!=g.value&&Object.hasOwnProperty.call(g,"value")&&f.uint32(18).string(g.value),f},l.decode=function(g,f){g instanceof u||(g=u.create(g)),f=void 0===f?g.len:g.pos+f;for(var k=new t.GroupAttributeSet.AttributeInfo;g.pos<f;){var q=g.uint32();switch(q>>>3){case 1:k.key=g.string();break;case 2:k.value=g.string();break;default:g.skipType(7&q)}}return k},l}(),h}(),ED=t.GroupAttributeMod=function(){function h(l){if(this.attributeInfos=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.group="",h.prototype.broadcast=!1,h.prototype.attributeInfos=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.group&&Object.hasOwnProperty.call(l,"group")&&g.uint32(18).string(l.group),null!=l.broadcast&&Object.hasOwnProperty.call(l,"broadcast")&&g.uint32(24).bool(l.broadcast),null!=l.attributeInfos&&l.attributeInfos.length)for(var f=0;f<l.attributeInfos.length;++f)t.GroupAttributeMod.AttributeInfo.encode(l.attributeInfos[f],g.uint32(34).fork()).ldelim();return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupAttributeMod;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.group=l.string();break;case 3:f.broadcast=l.bool();break;case 4:f.attributeInfos&&f.attributeInfos.length||(f.attributeInfos=[]),f.attributeInfos.push(t.GroupAttributeMod.AttributeInfo.decode(l,l.uint32()));break;default:l.skipType(7&k)}}return f},h.AttributeInfo=function(){function l(g){if(g)for(var f=Object.keys(g),k=0;k<f.length;++k)null!=g[f[k]]&&(this[f[k]]=g[f[k]])}return l.prototype.key="",l.prototype.value="",l.encode=function(g,f){return f||(f=N.create()),null!=g.key&&Object.hasOwnProperty.call(g,"key")&&f.uint32(10).string(g.key),null!=g.value&&Object.hasOwnProperty.call(g,"value")&&f.uint32(18).string(g.value),f},l.decode=function(g,f){g instanceof u||(g=u.create(g)),f=void 0===f?g.len:g.pos+f;for(var k=new t.GroupAttributeMod.AttributeInfo;g.pos<f;){var q=g.uint32();switch(q>>>3){case 1:k.key=g.string();break;case 2:k.value=g.string();break;default:g.skipType(7&q)}}return k},l}(),h}(),FD=t.GroupAttributeDel=function(){function h(l){if(this.attributes=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.group="",h.prototype.broadcast=!1,h.prototype.attributes=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.group&&Object.hasOwnProperty.call(l,"group")&&g.uint32(18).string(l.group),null!=l.broadcast&&Object.hasOwnProperty.call(l,"broadcast")&&g.uint32(24).bool(l.broadcast),null!=l.attributes&&l.attributes.length)for(var f=0;f<l.attributes.length;++f)g.uint32(34).string(l.attributes[f]);return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupAttributeDel;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.group=l.string();break;case 3:f.broadcast=l.bool();break;case 4:f.attributes&&f.attributes.length||(f.attributes=[]),f.attributes.push(l.string());break;default:l.skipType(7&k)}}return f},h}(),GD=t.GroupAttributeAlt=function(){function h(l){if(this.attributeMaps=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.group="",h.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.attributeMaps=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.group&&Object.hasOwnProperty.call(l,"group")&&g.uint32(18).string(l.group),null!=l.instance&&Object.hasOwnProperty.call(l,"instance")&&g.uint32(24).uint64(l.instance),null!=l.attributeMaps&&l.attributeMaps.length)for(var f=0;f<l.attributeMaps.length;++f)t.GroupAttributeAlt.AttributeMap.encode(l.attributeMaps[f],g.uint32(34).fork()).ldelim();return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupAttributeAlt;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.group=l.string();break;case 3:f.instance=l.uint64();break;case 4:f.attributeMaps&&f.attributeMaps.length||(f.attributeMaps=[]),f.attributeMaps.push(t.GroupAttributeAlt.AttributeMap.decode(l,l.uint32()));break;default:l.skipType(7&k)}}return f},h.AttributeMap=function(){function l(g){if(g)for(var f=Object.keys(g),k=0;k<f.length;++k)null!=g[f[k]]&&(this[f[k]]=g[f[k]])}return l.prototype.key="",l.prototype.value="",l.prototype.origin="",l.prototype.ms=r.Long?r.Long.fromBits(0,0,!0):0,l.encode=function(g,f){return f||(f=N.create()),null!=g.key&&Object.hasOwnProperty.call(g,"key")&&f.uint32(10).string(g.key),null!=g.value&&Object.hasOwnProperty.call(g,"value")&&f.uint32(18).string(g.value),null!=g.origin&&Object.hasOwnProperty.call(g,"origin")&&f.uint32(26).string(g.origin),null!=g.ms&&Object.hasOwnProperty.call(g,"ms")&&f.uint32(32).uint64(g.ms),f},l.decode=function(g,f){g instanceof u||(g=u.create(g)),f=void 0===f?g.len:g.pos+f;for(var k=new t.GroupAttributeAlt.AttributeMap;g.pos<f;){var q=g.uint32();switch(q>>>3){case 1:k.key=g.string();break;case 2:k.value=g.string();break;case 3:k.origin=g.string();break;case 4:k.ms=g.uint64();break;default:g.skipType(7&q)}}return k},l}(),h}(),HD=t.GroupAttributeRsp=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupAttributeRsp;l.pos<g;){var k=l.uint32();k>>>3==1?f.seq=l.uint64():l.skipType(7&k)}return f},h}(),ID=t.GroupAttributeErr=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.code=0,h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.code&&Object.hasOwnProperty.call(l,"code")&&g.uint32(16).uint32(l.code),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupAttributeErr;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.code=l.uint32();break;default:l.skipType(7&k)}}return f},h}(),JD=t.GroupAttributeKeysGet=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.group="",h.encode=function(l,g){return g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.group&&Object.hasOwnProperty.call(l,"group")&&g.uint32(18).string(l.group),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupAttributeKeysGet;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.group=l.string();break;default:l.skipType(7&k)}}return f},h}(),KD=t.GroupAttributeKeysRet=function(){function h(l){if(this.keys=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.keys=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.keys&&l.keys.length)for(var f=0;f<l.keys.length;++f)g.uint32(18).string(l.keys[f]);return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.GroupAttributeKeysRet;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.keys&&f.keys.length||(f.keys=[]),f.keys.push(l.string());break;default:l.skipType(7&k)}}return f},h}(),LD=t.SubscribeUserStatus=function(){function h(l){if(this.users=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.users=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.users&&l.users.length)for(var f=0;f<l.users.length;++f)g.uint32(18).string(l.users[f]);return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.SubscribeUserStatus;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.users&&f.users.length||(f.users=[]),f.users.push(l.string());break;default:l.skipType(7&k)}}return f},h}(),MD=t.UnsubscribeUserStatus=function(){function h(l){if(this.users=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.users=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.users&&l.users.length)for(var f=0;f<l.users.length;++f)g.uint32(18).string(l.users[f]);return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UnsubscribeUserStatus;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.users&&f.users.length||(f.users=[]),f.users.push(l.string());break;default:l.skipType(7&k)}}return f},h}(),ND=t.UserJoinNotice=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.user="",h.encode=function(l,g){return g||(g=N.create()),null!=l.instance&&Object.hasOwnProperty.call(l,"instance")&&g.uint32(8).uint64(l.instance),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(16).uint64(l.seq),null!=l.user&&Object.hasOwnProperty.call(l,"user")&&g.uint32(26).string(l.user),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserJoinNotice;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.instance=l.uint64();break;case 2:f.seq=l.uint64();break;case 3:f.user=l.string();break;default:l.skipType(7&k)}}return f},h}(),OD=t.UserQuitNotice=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.user="",h.encode=function(l,g){return g||(g=N.create()),null!=l.instance&&Object.hasOwnProperty.call(l,"instance")&&g.uint32(8).uint64(l.instance),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(16).uint64(l.seq),null!=l.user&&Object.hasOwnProperty.call(l,"user")&&g.uint32(26).string(l.user),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserQuitNotice;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.instance=l.uint64();break;case 2:f.seq=l.uint64();break;case 3:f.user=l.string();break;default:l.skipType(7&k)}}return f},h}(),PD=t.UserWaitNotice=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.user="",h.encode=function(l,g){return g||(g=N.create()),null!=l.instance&&Object.hasOwnProperty.call(l,"instance")&&g.uint32(8).uint64(l.instance),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(16).uint64(l.seq),null!=l.user&&Object.hasOwnProperty.call(l,"user")&&g.uint32(26).string(l.user),g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.UserWaitNotice;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.instance=l.uint64();break;case 2:f.seq=l.uint64();break;case 3:f.user=l.string();break;default:l.skipType(7&k)}}return f},h}(),QD=t.SubscribeResponse=function(){function h(l){if(this.errors=[],l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,h.prototype.errors=r.emptyArray,h.encode=function(l,g){if(g||(g=N.create()),null!=l.seq&&Object.hasOwnProperty.call(l,"seq")&&g.uint32(8).uint64(l.seq),null!=l.errors&&l.errors.length)for(var f=0;f<l.errors.length;++f)t.SubscribeResponse.SubscribeErrorsType.encode(l.errors[f],g.uint32(18).fork()).ldelim();return g},h.decode=function(l,g){l instanceof u||(l=u.create(l)),g=void 0===g?l.len:l.pos+g;for(var f=new t.SubscribeResponse;l.pos<g;){var k=l.uint32();switch(k>>>3){case 1:f.seq=l.uint64();break;case 2:f.errors&&f.errors.length||(f.errors=[]),f.errors.push(t.SubscribeResponse.SubscribeErrorsType.decode(l,l.uint32()));break;default:l.skipType(7&k)}}return f},h.SubscribeErrorsType=function(){function l(g){if(g)for(var f=Object.keys(g),k=0;k<f.length;++k)null!=g[f[k]]&&(this[f[k]]=g[f[k]])}return l.prototype.account="",l.prototype.code=0,l.encode=function(g,f){return f||(f=N.create()),null!=g.account&&Object.hasOwnProperty.call(g,"account")&&f.uint32(10).string(g.account),null!=g.code&&Object.hasOwnProperty.call(g,"code")&&f.uint32(16).uint32(g.code),f},l.decode=function(g,f){g instanceof u||(g=u.create(g)),f=void 0===f?g.len:g.pos+f;for(var k=new t.SubscribeResponse.SubscribeErrorsType;g.pos<f;){var q=g.uint32();switch(q>>>3){case 1:k.account=g.string();break;case 2:k.code=g.uint32();break;default:g.skipType(7&q)}}return k},l}(),h}(),RD=Object.freeze({__proto__:null,URI:UC,Wrapper:mi,Ping:VC,Pong:WC,UserJoin:XC,UserResp:YC,UserQuit:ZC,UserDrop:$C,GroupEnter:aD,GroupLeave:bD,GroupReply:cD,GroupLeaveNotice:ys,GroupEnterNotice:zs,Message:As,Ack:Bs,FileUploadIndexGet:dD,FileUploadIndexRet:eD,FileUploadIndexSet:fD,FileUploadIndexFin:gD,FileUploadIndexErr:hD,FileDownloadIndexGet:iD,FileDownloadIndexRet:jD,FileDownloadIndexErr:kD,GroupAllUsersList:lD,GroupAllUsersResult:mD,UserStatusList:nD,UserStatusResult:oD,UserAttributeGet:pD,UserAttributeRet:qD,UserAttributeSet:rD,UserAttributeMod:sD,UserAttributeDel:tD,UserAttributeErr:uD,UserAttributeKeysGet:vD,UserAttributeKeysRet:wD,UserAttributeRsp:xD,GroupStatusList:yD,GroupStatusResult:zD,GroupCountNotice:AD,GroupAttributeGet:BD,GroupAttributeRet:CD,GroupAttributeSet:DD,GroupAttributeMod:ED,GroupAttributeDel:FD,GroupAttributeAlt:GD,GroupAttributeRsp:HD,GroupAttributeErr:ID,GroupAttributeKeysGet:JD,GroupAttributeKeysRet:KD,SubscribeUserStatus:LD,UnsubscribeUserStatus:MD,UserJoinNotice:ND,UserQuitNotice:OD,UserWaitNotice:PD,SubscribeResponse:QD,default:t}),SD=Math.ceil,Cs=function(h){return function(l,g,f){var k=(l=String(mb(l))).length;return f=void 0===f?" ":String(f),(g=va(g))<=k||""==f?l:((k=ap.call(f,SD((g-=k)/f.length))).length>g&&(k=k.slice(0,g)),h?l+k:k+l)}},TD=Cs(!1),UD=Cs(!0),Ds=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(Re);M({target:"String",proto:!0,forced:Ds},{padEnd:function(h){return UD(this,h,1<arguments.length?arguments[1]:void 0)}});var VD=Sf,Es=function(h){return function(l){l=tb(l);for(var g,f=Mc(l),k=f.length,q=0,_r=[];k>q;)g=f[q++],fa&&!VD.call(l,g)||_r.push(h?[g,l[g]]:l[g]);return _r}},WD=Es(!0),XD=Es(!1);M({target:"Object",stat:!0},{entries:function(h){return WD(h)}});var YD=Jb.f,Fs="".endsWith,ZD=Math.min,Gs=Mk("endsWith"),$D=!Gs&&!!function(){var h=YD(String.prototype,"endsWith");return h&&!h.writable}();M({target:"String",proto:!0,forced:!$D&&!Gs},{endsWith:function(h){var l=String(mb(this));Lk(h);var g=1<arguments.length?arguments[1]:void 0,f=va(l.length);return g=void 0===g?f:ZD(va(g),f),f=String(h),Fs?Fs.call(l,f,g):l.slice(g-f.length,g)===f}}),rh("match",1,function(h,l,g){return[function(f){var k=mb(this),q=null==f?void 0:f[h];return void 0!==q?q.call(f,k):new RegExp(f)[h](String(k))},function(f){var k=g(l,f,this);if(k.done)return k.value;if(f=sa(f),k=String(this),!f.global)return Se(f,k);var q=f.unicode;f.lastIndex=0;for(var _r,_s=[],ga=0;null!==(_r=Se(f,k));)_r=String(_r[0]),_s[ga]=_r,""===_r&&(f.lastIndex=Gj(k,va(f.lastIndex),q)),ga++;return 0===ga?null:_s}]});var aE=Jb.f,Hs="".startsWith,bE=Math.min,Is=Mk("startsWith"),cE=!Is&&!!function(){var h=aE(String.prototype,"startsWith");return h&&!h.writable}();M({target:"String",proto:!0,forced:!cE&&!Is},{startsWith:function(h){var l=String(mb(this));Lk(h);var g=va(bE(1<arguments.length?arguments[1]:void 0,l.length)),f=String(h);return Hs?Hs.call(l,f,g):l.slice(g,g+f.length)===f}});var Sn=function(h){var l=/(%?)(%([jds]))/g,g=Array.prototype.slice.call(arguments,1);return g.length&&(h=h.replace(l,function(f,k,q,_r){switch(q=g.shift(),_r){case"s":q=""+q;break;case"d":q=Number(q);break;case"j":q=JSON.stringify(q)}return k?(g.unshift(q),f):q})),g.length&&(h+=" "+g.join(" ")),""+h.replace(/%{2,2}/g,"%")},dE=/\s/,eE=function(h){for(var l=h.length;l--&&dE.test(h.charAt(l)););return l},fE=/^\s+/,Js=NaN,gE=/^[-+]0x[0-9a-f]+$/i,hE=/^0b[01]+$/i,iE=/^0o[0-7]+$/i,jE=parseInt,Nl=function(h){if("number"==typeof h)return h;if(we(h))return Js;if(ob(h)&&(h="function"==typeof h.valueOf?h.valueOf():h,h=ob(h)?h+"":h),"string"!=typeof h)return 0===h?h:+h;h=h&&h.slice(0,eE(h)+1).replace(fE,"");var l=hE.test(h);return l||iE.test(h)?jE(h.slice(2),l?2:8):gE.test(h)?Js:+h},kE=Math.max,lE=Math.min,mE=function(h,l,g){function f(x_){var B_=ga,V_=_l;return ga=_l=void 0,r_=x_,bh=h.apply(V_,B_)}function k(x_){var B_=x_-_A;return x_-=r_,void 0===_A||B_>=l||0>B_||I_&&x_>=S_}function q(){var x_=Fb.Date.now();if(k(x_))return _r(x_);var B_=setTimeout,V_=x_-r_;x_=l-(x_-_A),V_=I_?lE(x_,S_-V_):x_,n_=B_(q,V_)}function _r(x_){return n_=void 0,v_&&ga?f(x_):(ga=_l=void 0,bh)}function _s(){var x_=Fb.Date.now(),B_=k(x_);if(ga=arguments,_l=this,_A=x_,B_){if(void 0===n_)return r_=x_=_A,n_=setTimeout(q,l),p_?f(x_):bh;if(I_)return clearTimeout(n_),n_=setTimeout(q,l),f(_A)}return void 0===n_&&(n_=setTimeout(q,l)),bh}var ga,_l,bh,n_,_A,r_=0,p_=!1,I_=!1,v_=!0;if("function"!=typeof h)throw new TypeError("Expected a function");if(l=Nl(l)||0,ob(g)){p_=!!g.leading;var S_=(I_="maxWait"in g)?kE(Nl(g.maxWait)||0,l):S_;v_="trailing"in g?!!g.trailing:v_}return _s.cancel=function(){void 0!==n_&&clearTimeout(n_),r_=0,ga=_A=_l=n_=void 0},_s.flush=function(){return void 0===n_?bh:_r(Fb.Date.now())},_s},Fc=function(h){function l(f,k){return X(this,l),m(n(f=g.call(this,Rn(f,k))),"originalError",void 0),m(n(f),"code",void 0),m(n(f),"serverCode",void 0),"number"==typeof k?f.code=k:"string"==typeof k?f.name=k:void 0!==k&&(k.originalError&&(f.originalError=k.originalError),void 0!==k.code&&(f.code=k.code),void 0!==k.serverCode&&(f.serverCode=k.serverCode)),f}ja(l,h);var g=ka(l);return l}(xf(Error)),Ma=function(h){function l(f,k){return X(this,l),m(n(f=g.call(this,Rn(f,k))),"name","RtmInternalError"),m(n(f),"code",void 0),f.code=k,f}ja(l,h);var g=ka(l);return l}(xf(Error)),ni=function(){return function(h){function l(f){X(this,l);var k=Object.keys(f);return g.call(this,f[k[0]],k[0])}ja(l,h);var g=ka(l);return l}(Ma)},Ha=ni(),gb=function(h){function l(){X(this,l);for(var f=arguments.length,k=Array(f),q=0;q<f;q++)k[q]=arguments[q];return m(n(f=g.call.apply(g,[this].concat(k))),"name","RtmTimeoutError"),f}ja(l,h);var g=ka(l);return l}(Fc),H=function(h){function l(){X(this,l);for(var f=arguments.length,k=Array(f),q=0;q<f;q++)k[q]=arguments[q];return m(n(f=g.call.apply(g,[this].concat(k))),"name","RtmInvalidArgumentError"),f}ja(l,h);var g=ka(l);return l}(Fc),L=function(h){function l(){X(this,l);for(var f=arguments.length,k=Array(f),q=0;q<f;q++)k[q]=arguments[q];return m(n(f=g.call.apply(g,[this].concat(k))),"name","RtmInvalidStatusError"),f}ja(l,h);var g=ka(l);return l}(Fc),Ol=function(h){function l(){X(this,l);for(var f=arguments.length,k=Array(f),q=0;q<f;q++)k[q]=arguments[q];return m(n(f=g.call.apply(g,[this].concat(k))),"name","RtmInterruptedError"),f}ja(l,h);var g=ka(l);return l}(Fc),lb=function(h){function l(){X(this,l);for(var f=arguments.length,k=Array(f),q=0;q<f;q++)k[q]=arguments[q];return m(n(f=g.call.apply(g,[this].concat(k))),"name","RtmLimitExceededError"),f}ja(l,h);var g=ka(l);return l}(Fc),nE=function(h){function l(){X(this,l);for(var f=arguments.length,k=Array(f),q=0;q<f;q++)k[q]=arguments[q];return m(n(f=g.call.apply(g,[this].concat(k))),"name","RtmInvokeTooOftenError"),f}ja(l,h);var g=ka(l);return l}(Fc),da=function(h){function l(){X(this,l);for(var f=arguments.length,k=Array(f),q=0;q<f;q++)k[q]=arguments[q];return m(n(f=g.call.apply(g,[this].concat(k))),"name","RtmUnavailableError"),m(n(f),"serverCode",void 0),m(n(f),"statusCode",void 0),f}ja(l,h);var g=ka(l);return l}(Fc),of=function(h){function l(){X(this,l);for(var f=arguments.length,k=Array(f),q=0;q<f;q++)k[q]=arguments[q];return m(n(f=g.call.apply(g,[this].concat(k))),"name","RtmUnauthenticatedError"),m(n(f),"serverCode",void 0),f}ja(l,h);var g=ka(l);return l}(Fc),bd=function(h){function l(){X(this,l);for(var f=arguments.length,k=Array(f),q=0;q<f;q++)k[q]=arguments[q];return m(n(f=g.call.apply(g,[this].concat(k))),"name","RtmUnknownError"),f}ja(l,h);var g=ka(l);return l}(Fc),Xa=function(h){return h instanceof gb||h instanceof sb},ta=function(h){return h instanceof Fc},he=function(h,l,g){return['Executing "%s.%s" timed out after %ds',h,l,g/1e3]},Qn=new Map,oE=function(){var h=new Date;return"".concat(h.toISOString().split("T")[1].replace(/\..+/,""),".").concat(h.getMilliseconds())},Pf=Object.keys,eh=Object.entries.bind(Object),Zg=function(h){return"string"==typeof h?h.endsWith(".")?h:"".concat(h,"."):h},Vn=function(h){for(var l="",g=(h=new Uint8Array(h)).byteLength,f=-1;++f<g;)l+=String.fromCharCode(h[f]);return l=btoa(l),"data:;base64,".concat(l)},pE=R(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})});M({target:"Date",proto:!0,forced:pE},{toJSON:function(h){h=Va(this);var l=tc(h);return"number"!=typeof l||isFinite(l)?h.toISOString():null}}),M({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}});var Vv=Object.prototype.hasOwnProperty,Ks=function(h,l,g){return JSON.stringify(ao(h),l,g)};Ks.ensureProperties=ao;var qE=function(h,l){l=l||{};var g=V(h);if("string"===g&&0<h.length)return Wv(h);if("number"===g&&isFinite(h))return l.long?864e5<=(l=Math.abs(h))?gh(h,l,864e5,"day"):36e5<=l?gh(h,l,36e5,"hour"):6e4<=l?gh(h,l,6e4,"minute"):1e3<=l?gh(h,l,1e3,"second"):h+" ms":864e5<=(l=Math.abs(h))?Math.round(h/864e5)+"d":36e5<=l?Math.round(h/36e5)+"h":6e4<=l?Math.round(h/6e4)+"m":1e3<=l?Math.round(h/1e3)+"s":h+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(h))},rE=function(h){function l(k){function q(){for(var ga=arguments.length,_l=Array(ga),bh=0;bh<ga;bh++)_l[bh]=arguments[bh];if(q.enabled){ga=Number(new Date),q.diff=ga-(_r||ga),q.prev=_r,_r=q.curr=ga,_l[0]=l.coerce(_l[0]),"string"!=typeof _l[0]&&_l.unshift("%O");var n_=0;_l[0]=_l[0].replace(/%([a-zA-Z%])/g,function(_A,r_){return"%%"===_A?"%":(n_++,"function"==typeof(r_=l.formatters[r_])&&(_A=r_.call(q,_l[n_]),_l.splice(n_,1),n_--),_A)}),l.formatArgs.call(q,_l),(q.log||l.log).apply(q,_l)}}var _r,_s=null;return q.namespace=k,q.useColors=l.useColors(),q.color=l.selectColor(k),q.extend=g,q.destroy=l.destroy,Object.defineProperty(q,"enabled",{enumerable:!0,configurable:!1,get:function(){return null===_s?l.enabled(k):_s},set:function(ga){_s=ga}}),"function"==typeof l.init&&l.init(q),q}function g(k,q){return(k=l(this.namespace+(void 0===q?":":q)+k)).log=this.log,k}function f(k){return k.toString().substring(2,k.toString().length-2).replace(/\.\*\?$/,"*")}return l.debug=l,l.default=l,l.coerce=function(k){return k instanceof Error?k.stack||k.message:k},l.disable=function(){var k=[].concat(G(l.names.map(f)),G(l.skips.map(f).map(function(q){return"-"+q}))).join(",");return l.enable(""),k},l.enable=function(k){l.save(k),l.names=[],l.skips=[];var q,_r=("string"==typeof k?k:"").split(/[\s,]+/),_s=_r.length;for(q=0;q<_s;q++)_r[q]&&("-"===(k=_r[q].replace(/\*/g,".*?"))[0]?l.skips.push(new RegExp("^"+k.substr(1)+"$")):l.names.push(new RegExp("^"+k+"$")))},l.enabled=function(k){if("*"===k[k.length-1])return!0;var q,_r=0;for(q=l.skips.length;_r<q;_r++)if(l.skips[_r].test(k))return!1;for(_r=0,q=l.names.length;_r<q;_r++)if(l.names[_r].test(k))return!0;return!1},l.humanize=qE,l.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(h).forEach(function(k){l[k]=h[k]}),l.names=[],l.skips=[],l.formatters={},l.selectColor=function(k){for(var q=0,_r=0;_r<k.length;_r++)q=(q<<5)-q+k.charCodeAt(_r),q|=0;return l.colors[Math.abs(q)%l.colors.length]},l.enable(l.load()),l},Ls=cb(function(h,l){l.formatArgs=function(f){if(f[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+f[0]+(this.useColors?"%c ":" ")+"+"+h.exports.humanize(this.diff),this.useColors){var k="color: "+this.color;f.splice(1,0,k,"color: inherit");var q=0,_r=0;f[0].replace(/%[a-zA-Z%]/g,function(_s){"%%"!==_s&&(q++,"%c"===_s&&(_r=q))}),f.splice(_r,0,k)}},l.save=function(f){try{f?l.storage.setItem("debug",f):l.storage.removeItem("debug")}catch(k){}},l.load=function(){try{var f=l.storage.getItem("debug")}catch(k){}return!f&&"undefined"!=typeof process&&"env"in process&&(f=process.env.DEBUG),f},l.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))};e:{try{var g=localStorage;break e}catch(f){}g=void 0}l.storage=g,l.destroy=function(){var f=!1;return function(){f||(f=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),l.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" "),l.log=console.debug||console.log||function(){},h.exports=rE(l),h.exports.formatters.j=function(f){try{return JSON.stringify(f)}catch(k){return"[UnexpectedJSONParseError]: "+k.message}}}),Ms=Ls("RTM:DEBUG"),pf;Ms.enabled=!1,function(h){h[h.Uploading=0]="Uploading",h[h.Free=1]="Free"}(pf||(pf={}));var sE=function(){function h(l){X(this,h),m(this,"uploadRequest",void 0),m(this,"uploadState",void 0),m(this,"uploadResendCount",void 0),m(this,"LogCache",void 0),m(this,"LogsToPost",void 0),m(this,"processId",void 0),m(this,"sdkVersion",void 0),m(this,"logId",void 0),m(this,"rtmConfig",void 0),this.processId=l.processId,this.sdkVersion=l.sdkVersion,this.rtmConfig=l.rtmConfig,this.uploadRequest=l.uploadRequest,this.uploadState=pf.Free,this.uploadResendCount=0,this.LogCache=[],this.LogsToPost=[],this.logId=0}return Ia(h,[{key:"upload",value:function(l){this.LogCache.push(l),this.uploadState===pf.Free&&(this.LogsToPost=this.LogCache.splice(0,40>this.LogCache.length?this.LogCache.length:40),this.postLog(this.LogsToPost))}},{key:"postLog",value:function(l){var g=this;this.uploadState=pf.Uploading,setTimeout(J(x.mark(function f(){var k,q,_r;return x.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:return k={sdk_version:g.sdkVersion,process_id:g.processId,payload:JSON.stringify(l)},_s.prev=1,_s.next=4,g.uploadRequest(k,null!==(q=g.rtmConfig.enableCloudProxy)&&void 0!==q&&q);case 4:if(!Ti){_s.next=6;break}throw Error("RTM is busy");case 6:_s.next=13;break;case 8:return _s.prev=8,_s.t0=_s.catch(1),_r=2>g.uploadResendCount++?2e3:1e4,setTimeout(function(){return g.postLog(g.LogsToPost)},_r),_s.abrupt("return");case 13:if(Ms('The logs uploaded for "process-'.concat(zg,'"')),0!==g.LogCache.length){_s.next=17;break}return g.uploadState=pf.Free,_s.abrupt("return");case 17:g.uploadResendCount=0,g.LogsToPost=g.LogCache.splice(0,40>g.LogCache.length?g.LogCache.length:40),g.postLog(g.LogsToPost);case 20:case"end":return _s.stop()}},f,null,[[1,8]])})),ie.getParameter("LOG_UPLOAD_INTERVAL"))}}]),h}(),Ns=function(h,l,g,f,k,q,_r,_s){var ga=0;for(_r=!!_r&&pd(_r,_s,3);ga<f;){if(ga in g){if(_s=_r?_r(g[ga],ga,l):g[ga],0<q&&qd(_s))k=Ns(h,l,_s,va(_s.length),k,q-1)-1;else{if(9007199254740991<=k)throw TypeError("Exceed the acceptable array length");h[k]=_s}k++}ga++}return k},tE=Ns;M({target:"Array",proto:!0},{flat:function(){var h=arguments.length?arguments[0]:void 0,l=Va(this),g=va(l.length),f=th(l,0);return f.length=tE(f,l,l,g,0,void 0===h?1:fc(h)),f}}),M({target:"Object",stat:!0},{values:function(h){return XD(h)}});var uE=["CODE"],Gb,Bd,D;!function(h){h.CHINA="CN",h.ASIA="AS",h.NORTH_AMERICA="NA",h.EUROPE="EU",h.JAPAN="JP",h.INDIA="IN",h.OCEANIA="OC",h.SOUTH_AMERICA="SA",h.AFRICA="AF",h.OVERSEA="OVERSEA",h.GLOBAL="GLOBAL"}(D||(D={}));var vE={CN:D.CHINA,NA:D.NORTH_AMERICA,EU:D.EUROPE,AS:D.ASIA,JP:D.JAPAN,IN:D.INDIA,GLOB:D.GLOBAL,AF:D.AFRICA,OC:D.OVERSEA,OVS:D.OVERSEA,SA:D.SOUTH_AMERICA},hh=Zn((Gb={},m(Gb,D.ASIA,{CODE:D.ASIA,AP_DOMAINS:["ap-web-1-asia.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-asia.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_AP:["proxy-ap-web-asia.agora.io"],PROXY_NGINX:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.NORTH_AMERICA,{CODE:D.NORTH_AMERICA,AP_DOMAINS:["ap-web-1-north-america.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-north-america.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_AP:["proxy-ap-web-america.agora.io"],PROXY_NGINX:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.EUROPE,{CODE:D.EUROPE,AP_DOMAINS:["ap-web-1-europe.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-europe.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_AP:["proxy-ap-web-europe.agora.io"],PROXY_NGINX:["europe.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.JAPAN,{CODE:D.JAPAN,AP_DOMAINS:["ap-web-1-japan.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-japan.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_AP:["proxy-ap-web-japan.agora.io"],PROXY_NGINX:["japan.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.INDIA,{CODE:D.INDIA,AP_DOMAINS:["ap-web-1-india.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-india.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_AP:["proxy-ap-web-india.agora.io"],PROXY_NGINX:["india.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.OVERSEA,{CODE:D.OVERSEA,AP_DOMAINS:["ap-web-1-oversea.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_AP:["proxy-ap-web-oversea.agora.io"],PROXY_NGINX:["webrtc-cloud-proxy.agora.io"]}),m(Gb,D.GLOBAL,{CODE:D.GLOBAL,AP_DOMAINS:["ap-web-1.agora.io","ap-web-2.agora.io"],AP_BACKUP_DOMAINS:["ap-web-3.agora.io","ap-web-4.agora.io"],EVENT_REPORT_DOMAIN:["webcollector-rtm.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["webcollector-1.agora.io"],LOG_UPLOAD_SERVER:["logservice-rtm.agora.io"],PROXY_AP:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],PROXY_NGINX:["webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.OCEANIA,{CODE:D.OCEANIA,AP_DOMAINS:["ap-web-1-oceania.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-oceania.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_AP:["proxy-ap-web-oceania.agora.io"],PROXY_NGINX:["oceania.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.SOUTH_AMERICA,{CODE:D.SOUTH_AMERICA,AP_DOMAINS:["ap-web-1-south-america.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-south-america.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_AP:["proxy-ap-web-south-america.agora.io"],PROXY_NGINX:["south-america.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.AFRICA,{CODE:D.AFRICA,AP_DOMAINS:["ap-web-1-africa.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-africa.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_AP:["proxy-ap-web-africa.agora.io"],PROXY_NGINX:["africa.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.CHINA,{CODE:D.CHINA,AP_DOMAINS:["webrtc2-2.ap.sd-rtn.com"],AP_BACKUP_DOMAINS:["webrtc2-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_AP:["proxy-ap-web.agoraio.cn"],PROXY_NGINX:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),Gb)),Qf=(Bd={},m(Bd,D.ASIA,[D.CHINA,D.JAPAN,D.INDIA]),m(Bd,D.EUROPE,[]),m(Bd,D.NORTH_AMERICA,[]),m(Bd,D.SOUTH_AMERICA,[]),m(Bd,D.OCEANIA,[]),m(Bd,D.AFRICA,[]),Bd),Os=[D.OVERSEA,D.GLOBAL,D.CHINA,D.NORTH_AMERICA,D.EUROPE,D.ASIA,D.JAPAN,D.INDIA,D.OCEANIA,D.SOUTH_AMERICA,D.AFRICA],bo=function(h){return Object.values(Qf).flat().includes(h)},Yv=function(h){var l;return null===(l=eh(Qf).find(function(g){return(g=ua(g,2))[1].includes(h)}))||void 0===l?void 0:l[0]},wE=function(h){return h.sort(function(l,g){return Os.indexOf(l)-Os.indexOf(g)})},Ke=function(h){var l=new Set;if(0===(h=wE(h).slice(0,3).map(function(g){var f=hh[g];if(void 0===f)throw new Ma("invalid area key");return g=f.CODE,f=yf(f,uE),l.add(g),f})).length)throw new Ma("areas cannot be empty");return wa({CODES:l},h.reduce(function(g,f){for(var k=0,q=eh(g);k<q.length;k++){var _r=ua(q[k],2),_s=_r[0];_r=_r[1],g[_s]=Array.from(new Set([].concat(G(f[_s]),G(_r))))}return g}))},P,Ps=function(){var h=J(x.mark(function l(g,f){var k,q,_r,_s,ga,_l=arguments;return x.wrap(function(bh){for(;;)switch(bh.prev=bh.next){case 0:if(!(2<(q=2<_l.length&&void 0!==_l[2]?_l[2]:0))){bh.next=3;break}return bh.abrupt("return");case 3:return _r={withCredentials:!0,body:g,timeout:2e4},_s=0<q?(null==P?void 0:P.LOG_UPLOAD_SERVER[0])||"rtm.logservice.sd-rtn.com":(null==P?void 0:P.LOG_UPLOAD_SERVER[0])||"logservice-rtm.agora.io",ga=f?"https://".concat(null!==(k=null==P?void 0:P.PROXY_NGINX[0])&&void 0!==k?k:"webrtc-cloud-proxy.sd-rtn.com","/ls/?h=").concat(_s,"&p=443&d=upload/v1"):"https://".concat(_s,"/upload/v1"),bh.next=8,He(ga,_r).catch(function(n_){return Ps(g,f,q+1)});case 8:case"end":return bh.stop()}},l)}));return function(l,g){return h.apply(this,arguments)}}(),Qs=new sE({processId:"process-".concat(zg),sdkVersion:"Agora_RTM_SDK_for_Web_".concat("v1.4.5-0-g9cf39592"),uploadRequest:Ps,rtmConfig:{}}),Pl="text payload rawMessage thumbnail attributeInfos keys value extra".split(" "),Rs="account ticket uid detail token account fileName cname user group key origin users src dst lastUpdateUserId channel cert wan_ip".split(" "),Ss="serverReceivedTs isOfflineMessage enableHistoricalMessaging enableOfflineMessaging hasPeerReceived messageType enableNotificationToChannelMembers lastUpdateTs".split(" "),xE="ChannelMessage MemberLeft MessageFromPeer LocalInvitationRefused LocalInvitationAccepted RemoteInvitationCanceled PeersOnlineStatusChanged AttributesUpdated MemberJoined".split(" "),Le=function(h){if("string"==typeof h)return pa(h);if(Array.isArray(h)&&h.every(function(q){return"string"==typeof q}))return h.map(function(q){return pa(q)});if(!Km(h)){for(var l={},g=0;g<Ss.length;g++){var f=Ss[g];f in h&&(l[f]=h[f])}if(0<Object.keys(l).length)return l;if(5>Object.keys(h).length){for(g=0,h=Object.entries(h);g<h.length;g++){var k=ua(h[g],2);f=k[0],k=k[1],Pl.includes(f)?l[f]="[Hidden Info]":l[pa(f)]="string"==typeof k?pa(k):"[Sensitive Info]"}return l}return"[Sensitive Info]"}return h},Ts=function(h){return"object"===V(h)?Hd(h)?Yn(te(h,5),Pl,Rs):h.constructor&&h.constructor.name:h},Us=function(h,l){return h instanceof Error?h.message:"string"!=typeof h?JSON.stringify(Yn(te(h,5),Pl,Rs)):(l=l.map(function(g){return g instanceof Error?g.message:"object"===V(g)?Ks(Array.isArray(g)?g.map(Ts):Ts(g)):g}),Sn.apply(void 0,[h.replace(/%[%Oo]/g,function(g){return"%%"===g?"%":"%o"===g||"%O"===g?"%s":g})].concat(G(l))))},yE=1,Vs=function(h,l,g){var f=Ls(h);return f.enabled=!0,f.log=g,f.useColors=!1,function(k){for(var q=arguments.length,_r=Array(1<q?q-1:0),_s=1;_s<q;_s++)_r[_s-1]=arguments[_s];if(l.enableLogUpload){q=Zg(k);var ga=Us(q,_r);Qs.upload({log_item_id:"".concat(yE++),log_level:h,payload_str:"[".concat(oE(),"] ").concat(h," - ").concat(256<ga.length?ga.slice(0,256):ga)})}switch(q=function(_l){var bh=ga||Us(Zg(k),_r),n_=lc.LOG_HANDLER;"function"==typeof n_&&n_({level:_l,message:bh}),f(bh)},h){case"RTM:INFO":l.logFilter.info&&q("log");break;case"RTM:WARN":l.logFilter.warn&&q("warning");break;case"RTM:ERROR":l.logFilter.error&&q("error");break;case"RTM:TRACK":l.logFilter.track&&q("log");break;case"RTM:MSG:RECV":case"RTM:MSG:SEND":case"RTM:DEBUG":l.logFilter.debug&&q("debug")}}},Ql,Ws=function(h){return function(l){var g=1===Ql||void 0===h?"":"Ins#".concat(h," ");return"".concat(g).concat(l)}},Rl=function(h,l,g){var f=Ws(Ql);return Vs("RTM:".concat(l),g,function(k){return h(f(k))})},wb=function(){return function(h){function l(f,k){var q=2<arguments.length&&void 0!==arguments[2]&&arguments[2];X(this,l);var _r=g.call(this);if(m(n(_r),"logError",void 0),m(n(_r),"invokeTracker",void 0),m(n(_r),"resultTracker",void 0),m(n(_r),"errorTracker",void 0),m(n(_r),"eventTracker",void 0),m(n(_r),"info",void 0),m(n(_r),"warn",void 0),m(n(_r),"log",void 0),m(n(_r),"genLogger",void 0),m(n(_r),"loggerId",void 0),m(n(_r),"logger",void 0),m(n(_r),"name",void 0),_r.logger=f,_r.name=k,_r.loggerId=f.loggerId,_r.info=f.info,_r.warn=f.warn,_r.logError=f.logError,_r.genLogger=f.genLogger,_r.log=f.genLogger("RTM:DEBUG","<".concat(k,"> ")),_r.invokeTracker=f.genTracker("Invoke"),_r.eventTracker=f.genTracker("Event"),_r.resultTracker=f.genTracker("Result"),_r.errorTracker=f.genTracker("Error"),q){var _s=_r.emit.bind(n(_r));_r.emit=function(){for(var ga=arguments.length,_l=Array(ga),bh=0;bh<ga;bh++)_l[bh]=arguments[bh];ga=_l[0],bh=_l.slice(1);var n_=xE.includes(ga);_r.eventTracker.apply(_r,["%s: ".concat(0<bh.length?"%s emitted with args: ".concat(bh.map(function(){return"%o"})):"%s emitted"),k,ga].concat(G(n_?bh.map(Le):bh)));try{_s.apply(void 0,_l)}catch(_A){_r.logError("Caught in the callback function of the event %s",ga,_A)}}}return _r}ja(l,h);var g=ka(l);return l}(ia)},zE=function(h){return Rl(console.log.bind(console),"INFO",h)},AE=function(h){return Rl(console.warn.bind(console),"WARN",h)},BE=function(h){return Rl(console.error.bind(console),"ERROR",h)},Xs=function(h,l){return function(g){var f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",k=Ws(h),q=console.debug.bind(console),_r=Vs(g,l,function(_s){return q(k(_s))});return function(_s){for(var ga=arguments.length,_l=Array(1<ga?ga-1:0),bh=1;bh<ga;bh++)_l[bh-1]=arguments[bh];return _r.apply(void 0,[f+_s].concat(_l))}}},CE=function(h,l){return function(g){return Xs(h,l)("RTM:TRACK","[".concat(g,"] "))}},rj=t.URI,$v=mi,DE=yf(RD,["Wrapper"]),co=ml(DE,"URI"),Ys=function(h,l){var g=-1,f=h.length,k=f-1;for(l=void 0===l?f:l;++g<l;){var q=h[f=rs(g,k)];h[f]=h[g],h[g]=q}return h.length=l,h},EE=function(h){return Ys(Bi(h))},FE=function(h){return Ys(tj(h))},qf=function(h){return(Za(h)?EE:FE)(h)},rf={0:9591,1:9593},je=function(h){var l=Pd(null);return"https://".concat(l?null:h,"/api/v1")},GE=eb.apply(void 0,G(qf(["web-1.ap.sd-rtn.com","web-2.ap.sd-rtn.com"].map(je)))),HE=eb.apply(void 0,G(qf(["ap-web-1.agora.io","ap-web-2.agora.io"].map(je)))),IE=eb.apply(void 0,G(qf(["web-3.ap.sd-rtn.com","web-4.ap.sd-rtn.com"].map(je)))),JE=eb.apply(void 0,G(qf(["ap-web-3.agora.io","ap-web-4.agora.io"].map(je)))),Zs=ni(),Sl=function(h){function l(f,k,q,_r,_s,ga){X(this,l);var _l=g.call(this,_s,fj("Socket-",_s.loggerId));if(m(n(_l),"isActiveClose",!1),m(n(_l),"loggedIn",!1),m(n(_l),"useNewDomain",void 0),m(n(_l),"receivedPacket",new Ua),m(n(_l),"open$",void 0),m(n(_l),"input$",new Ua),m(n(_l),"userJoin$",new Ua),m(n(_l),"attemptsSinceLastError",0),m(n(_l),"message$",new Ua),m(n(_l),"socket$",void 0),m(n(_l),"toClose",new Ua),m(n(_l),"toReconnect",new Ua),m(n(_l),"sendLogger",void 0),m(n(_l),"receiveLogger",void 0),m(n(_l),"ip",void 0),m(n(_l),"env",void 0),m(n(_l),"ticket",void 0),m(n(_l),"context",void 0),m(n(_l),"getDomain",function(){return eo(_l.ip,_l.useNewDomain)}),m(n(_l),"socketReconnector",function(_A){var r_=function(p_){return _l.attemptsSinceLastError+=1,_l.warn("The %s of Env %d reconnecting %s",_l.name,_l.env,p_.message),Kc(3e3)};return _A.pipe(Ja(function(p_){return _l.log("socket connection closed"),_l.loggedIn=!1,2<=_l.attemptsSinceLastError?(_l.warn("socket connection failure"),_l.emit("connectionFailure"),_l.close(),Z(p_)):_l.isActiveClose?yb:(_l.emit("reconnect"),_l.useNewDomain=!_l.useNewDomain,Z(p_))}),Ce(function(p_){return p_.pipe(Lc(r_))}))}),_l.ip=f,_l.env=k,_l.ticket=q,_l.context=_r,_l.useNewDomain=null!=ga?ga:.5<=Math.random(),_l.sendLogger=_l.genLogger("RTM:MSG:SEND"),_l.receiveLogger=_l.genLogger("RTM:MSG:RECV"),0!==k&&1!==k)throw new Zs({ILLEGAL_RTM_ENV:"The env number is out of rtm env count"});var bh=rf[k];_l.log("Opening websocket address %s for the Env %d",_l.ip,_l.env);var n_=cc(_l.input$,_l.userJoin$.pipe(Lv(2)),_l.message$).pipe(ea(function(_A){return mi.encode(_A).finish()}));return f=cc(Mv("",{protocols:[],makeWebSocket:function(){if(_l.context.config.enableCloudProxy||_l.context.socketUseProxy){if(0===_l.context.cloudProxyServers.length)throw _l.logError("No cloud proxy server to connect"),new da;var _A=Pd(null)?JSON.parse(null.replace(/-/g,".")):_l.context.cloudProxyServers;_A=Je(_A="wss://".concat(eo(fo(_A),!1),"/"),"sid",_l.context.sid),_A=Je(_A,"remote_port",bh.toString()),_A=Je(_A,"remote_ip",_l.ip),_A=Je(_A,"token",_l.context.key),_A=new WebSocket(_A)}else _A=new WebSocket("wss://".concat(_l.getDomain(),":").concat(bh));return _A.binaryType="arraybuffer",_A}}),_l.toReconnect),_l.socket$=Da(f,zl.pipe(kb(7e3),Ja(function(_A){return Xa(_A)&&_l.warn("socket open timed out"),Z(_A)}))).pipe(ea(function(_A){if(_A instanceof Error)throw _l.warn("Env_%d: Force reconnect the socket",_l.env),_A;return _A(n_).pipe(ea(function(r_){return mi.decode(new Uint8Array(r_))}))}),_l.socketReconnector),_l.open$=_l.socket$.pipe(ba(function(_A){_l.log("Websocket opened",_l.name),_A.subscribe(function(r_){var p_=r_.data;r_=rj[r_.uri].slice(0,-3),p_=co[r_].decode(p_);var I_=DC({},ml(p_,"toJSON"),function(B_,V_){return V_ instanceof U?Pn(V_):V_}),v_=!1;if((p_ instanceof zs||p_ instanceof ys)&&p_.instance.lessThanOrEqual(4294967295)&&(v_=!0),p_ instanceof As||p_ instanceof Bs){var S_=p_.instance,x_=p_.sequence;(p_.dialogue.lessThanOrEqual(4294967295)||S_.lessThanOrEqual(4294967295)||x_.lessThan(1))&&(v_=!0)}v_?_l.warn("Env_%d: Illegal %s, abandoned %o",_l.env,r_,I_):("Pong"!==r_&&_l.receiveLogger("Env_%d: %s %o",_l.env,r_,I_),_l.receivedPacket.next([r_,p_]))},function(){})}),If(void 0),rb(_l.toClose),De()),_l}ja(l,h);var g=ka(l);return Ia(l,[{key:"address",get:function(){return"".concat(this.ip,":").concat(rf[this.env])}},{key:"sendPacket",value:function(f,k){if("Ping"!==f){var q=Bc(k,function(_r){return _r instanceof U?Pn(_r):_r});this.sendLogger("Env_%d: %s %o",this.env,f,q)}k=Zv(f,k),"UserJoin"===f?this.userJoin$.next(k):"Message"===f?this.message$.next(k):this.input$.next(k)}},{key:"close",value:function(){this.isActiveClose=!0,this.loggedIn=!1,this.toClose.next()}},{key:"fromReceived",value:function(f){return this.receivedPacket.pipe(zb(function(k){return ua(k,1)[0]===f}),ea(function(k){return ua(k,2)[1]}))}},{key:"forceReconnect",value:function(){this.toReconnect.next(new Zs({FORCE_RECONNECTING:"Connection seems broken, try force reconnecting"}))}}]),l}(wb());M({target:"String",proto:!0,forced:Ds},{padStart:function(h){return TD(this,h,1<arguments.length?arguments[1]:void 0)}});var KE=function(h){var l=Pf(hh);h=Tv(h);for(var g=0;g<l.length;g++){var f=hh[l[g]];if(null!=f&&f.AP_DOMAINS.includes(h)||null!=f&&f.AP_BACKUP_DOMAINS.includes(h)||null!=f&&f.PROXY_AP.includes(h))return[f.CODE]}return[D.CHINA,D.GLOBAL]},LE={INVALID_APP_ID:"Illegal App ID",NO_AUTHORIZED:"Signature verification failed",TOKEN_TIMEOUT:"Dynamic key expired",INVALID_TOKEN_UID:"UID in the security key(token) is not valid",APP_ID_NO_ACTIVATED:"The vendor is not activated",DYNAMIC_KEY_NOT_ENABLED:"The vendor did not enable the dynamic key, but uses the dynamic key",DYNAMIC_ENABLED_BUT_STATIC_KEY:"The vendor enabled the dynamic key, but uses the static key",TOKEN_EXPIRED:"The token has expired",INVALID_USER_ID:"The user ID to login does not match the token",FORBIDDEN_REGION:"Forbidden to access the request in this area",CANNOT_MEET_AREA_DEMAND:"Cannot allocate to meet the requirements of the given area limit"},$s={5:"INVALID_APP_ID",7:"INVALID_USER_ID",9:"NO_AUTHORIZED",10:"TOKEN_TIMEOUT",11:"APP_ID_NO_ACTIVATED",12:"INVALID_TOKEN_UID",13:"TOKEN_EXPIRED",14:"DYNAMIC_KEY_NOT_ENABLED",15:"DYNAMIC_ENABLED_BUT_STATIC_KEY",18:"FORBIDDEN_REGION",19:"CANNOT_MEET_AREA_DEMAND"},ME=[100,101,102],oi=/web-(\d)/,at=function(h){function l(f,k){var q=2<arguments.length&&void 0!==arguments[2]&&arguments[2];X(this,l);var _r=g.call(this,k,"AccessPoint");return m(n(_r),"handleUniLbsError",function(_s,ga){var _l=_s;if(4<_s.toString().length){var bh=_s.toString().padStart(8,"0"),n_=parseInt(bh.slice(0,4),10);if(bh=parseInt(bh.slice(4,8),10),201===n_)_l=bh;else if(101===n_&&!ME.includes(bh))return Z(Error("service is currently unavailable"))}if(n_=_l.toString(),!Object.keys($s).includes(n_))return(_s=new da(["Login is rejected by the server. The response code is %d",_s],Bg)).serverCode=_l,Z(_s);switch(_l=LE[n_=$s[n_]],n_){case"INVALID_APP_ID":case"APP_ID_NO_ACTIVATED":return(ga=new of(_l,ds)).serverCode=_s,Z(ga);case"INVALID_USER_ID":return(ga=new of(_l,hi)).serverCode=_s,Z(ga);case"TOKEN_EXPIRED":case"TOKEN_TIMEOUT":return(ga=new of(_l,ii)).serverCode=_s,Z(ga);case"NO_AUTHORIZED":case"INVALID_TOKEN_UID":case"DYNAMIC_KEY_NOT_ENABLED":case"DYNAMIC_ENABLED_BUT_STATIC_KEY":return(ga=new of(_l,es)).serverCode=_s,Z(ga);case"CANNOT_MEET_AREA_DEMAND":return(ga=KE(ga)).forEach(function(_A){return _r.failedAreas.add(_A)}),_r.failedAreas.size===(void 0===P?2:P.CODES.size)?((ga=new H(_l,Bg)).serverCode=_s,Z(ga)):Z(Error("ap ".concat(ga.join(", ")," cannot meet requirement")));case"FORBIDDEN_REGION":return(ga=new da(_l,Bg)).serverCode=_s,Z(ga);default:return Z(Nn("ApResErrType",n_))}}),m(n(_r),"getApEdgeInfo$",void 0),m(n(_r),"getApEdgeInfoEndFirst$",void 0),m(n(_r),"apFinish$",new Ua),m(n(_r),"retryCount",0),m(n(_r),"failedAreas",new Set),m(n(_r),"usedUrl",[]),m(n(_r),"newDomainUsed",!1),m(n(_r),"backupNewDomainUsed",!1),m(n(_r),"genUrl",function(){return void 0===P?Ri.apply(void 0,G(qf([GE,HE]))).pipe(Si(function(_s){return eb.apply(void 0,G(_s))})):eb.apply(void 0,G(P.AP_DOMAINS.slice(0,3).map(je)))}),m(n(_r),"genBackupUrl",function(){return void 0===P?Ri.apply(void 0,G(qf([IE,JE]))).pipe(Si(function(_s){return eb.apply(void 0,G(_s))})):eb.apply(void 0,G(P.AP_BACKUP_DOMAINS.slice(0,3).map(je)))}),m(n(_r),"getApUrl$",function(_s){var ga,_l;return _r.genUrl().pipe(zb(function(bh){return!(_r.newDomainUsed&&bh.includes("sd-rtn.com")||(bh.includes("sd-rtn.com")&&(_r.newDomainUsed=!0),Kl(_r.usedUrl,function(n_){var _A;return n_===(null===(_A=bh.match(oi))||void 0===_A?void 0:_A[1])})))}),ba(function(bh){var n_;void 0===P&&"string"==typeof(bh=null===(n_=bh.match(oi))||void 0===n_?void 0:n_[1])&&_r.usedUrl.push(bh)}),Pa(_s?Math.max(lc.RECONNECTING_AP_NUM,null!==(ga=null==P?void 0:P.CODES.size)&&void 0!==ga?ga:0):null!==(_l=null==P?void 0:P.CODES.size)&&void 0!==_l?_l:2),Md(function(){return l.runOutOfUrlSymbol}),Ja(function(bh,n_){return _r.newDomainUsed=!1,bh===l.runOutOfUrlSymbol?(_r.usedUrl=[],n_):Z(bh)}))}),m(n(_r),"getBackupApUrl$",function(_s){var ga,_l;return _r.genBackupUrl().pipe(zb(function(bh){return!(_r.backupNewDomainUsed&&bh.includes("sd-rtn.com")||(bh.includes("sd-rtn.com")&&(_r.backupNewDomainUsed=!0),Kl(_r.usedUrl,function(n_){var _A;return n_===(null===(_A=bh.match(oi))||void 0===_A?void 0:_A[1])})))}),ba(function(bh){var n_;void 0===P&&"string"==typeof(bh=null===(n_=bh.match(oi))||void 0===n_?void 0:n_[1])&&_r.usedUrl.push(bh)}),Pa(_s?Math.max(lc.RECONNECTING_AP_NUM,null!==(ga=null==P?void 0:P.CODES.size)&&void 0!==ga?ga:0):null!==(_l=null==P?void 0:P.CODES.size)&&void 0!==_l?_l:2),Md(function(){return l.runOutOfUrlSymbol}),Ja(function(bh,n_){return _r.backupNewDomainUsed=!1,bh===l.runOutOfUrlSymbol?(_r.usedUrl=[],n_):Z(bh)}))}),m(n(_r),"getProxyApUrl$",function(_s){var ga,_l;return eb.apply(void 0,G(((null==P?void 0:P.PROXY_AP.slice(0,3))||["ap-proxy-1.agora.io","ap-proxy-2.agora.io"]).map(je))).pipe(Pa(_s?Math.max(lc.RECONNECTING_AP_NUM,null!==(ga=null==P?void 0:P.CODES.size)&&void 0!==ga?ga:0):null!==(_l=null==P?void 0:P.CODES.size)&&void 0!==_l?_l:2))}),m(n(_r),"context",void 0),m(n(_r),"fetchCloudProxy",function(_s,ga){var _l=fj("AP-",_r.loggerId);_r.log("The AccessPoint requests %s(%s)",_s,_l);var bh=new AbortController;return _r.apFinish$.pipe(Pa(1)).subscribe(function(){return bh.abort()}),hd(J(x.mark(function n_(){var _A;return x.wrap(function(r_){for(;;)switch(r_.prev=r_.next){case 0:return _A=Xg(0,Number.MAX_SAFE_INTEGER),_r.log("%s request opid: %d",_l,_A),r_.abrupt("return",He(_s,{headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"90","Content-Type":"application/json"},body:{sid:_r.context.sid,opid:_A,appid:_r.context.appId,client_ts:Math.ceil(Date.now()/1e3),request_bodies:[{uri:22,buffer:{service_ids:[7,16],key:null!=ga?ga:_r.context.key,cname:_r.context.uid,uid:0,detail:wa({},void 0===P?{11:[D.CHINA,D.GLOBAL].join()}:{11:Array.from(P.CODES).map(function(p_){return p_===D.OVERSEA?"".concat(D.ASIA,",").concat(D.EUROPE,",").concat(D.AFRICA,",").concat(D.NORTH_AMERICA,",").concat(D.SOUTH_AMERICA,",").concat(D.OCEANIA):p_}).join(",")})}}]},signal:bh.signal}));case 3:case"end":return r_.stop()}},n_)}))).pipe(Ja(function(n_){return"AbortError"!==n_.name&&(_r.logError(n_),_r.warn("The AP server %s request failure",_s,n_)),yb}),fb(function(){var n_=J(x.mark(function _A(r_){var I_,v_,S_,x_,B_,V_,_0,c0,Pv,h0,I0,G_,e0,P_,_v,E_,L_,F_;return x.wrap(function(J_){for(;;)switch(J_.prev=J_.next){case 0:if(I_=JSON.parse(r_.responseText),_r.log("The %s response is %o",_l,I_),(void 0===(v_=I_.response_body)||0===v_.length||v_.some(function(Y_){var D0;return void 0===(null===(D0=Y_.buffer)||void 0===D0?void 0:D0.code)||23!==Y_.uri}))&&Z(new da("cloud proxy response_body not valid",Bg)),0===(S_=v_.filter(function(Y_){return 0!==Y_.buffer.code})).length){J_.next=14;break}if(void 0===(x_=S_.find(function(Y_){return 128===Y_.buffer.flag}))){J_.next=12;break}return J_.abrupt("return",_r.handleUniLbsError(x_.buffer.code,_s));case 12:return _r.logError("cloud proxy error response"),J_.abrupt("return",_r.handleUniLbsError(S_[0].buffer.code,_s));case 14:for(B_=[],V_=0;V_<v_.length;V_++)if(262144===(null==(Pv=v_[V_])||null===(_0=Pv.buffer)||void 0===_0?void 0:_0.flag))null===(h0=Pv.buffer)||void 0===h0||null===(I0=h0.edges_services)||void 0===I0||null===(G_=I0.forEach)||void 0===G_||G_.call(I0,function(Y_){Ln(Y_=Y_.ip)&&-1===_r.context.cloudProxyServers.indexOf(Y_)&&(_r.log("got cloud proxy server: %s",Y_),_r.context.cloudProxyServers.push(Y_))});else if(128===(null==Pv||null===(c0=Pv.buffer)||void 0===c0?void 0:c0.flag)){for(E_=function(Y_,D0){var O0=D0[Y_];B_.some(function(EI){return EI.ip===O0.ip})||B_.push({ip:O0.ip,ticket:Pv.buffer.cert})},L_=0,F_=Pv.buffer.edges_services;L_<F_.length;L_++)E_(L_,F_);_r.context.rtmArea=null!==(e0=null===(P_=Pv.buffer)||void 0===P_||null===(_v=P_.detail)||void 0===_v?void 0:_v[9])&&void 0!==e0?e0:""}return J_.abrupt("return",eb.apply(void 0,G(B_).concat([yg])));case 19:case"end":return J_.stop()}},_A)}));return function(_A){return n_.apply(this,arguments)}}()),Ja(function(n_){return ta(n_)?Z(n_):yb}),Qg(),zb(function(n_){return void 0!==n_&&"string"==typeof n_.ip&&"string"==typeof n_.ticket&&Ln(n_.ip)}))}),m(n(_r),"fetchAp",function(_s,ga){var _l=fj("AP-",_r.loggerId);_r.log("The AccessPoint requests %s(%s)",_s,_l);var bh=new AbortController;return _r.apFinish$.pipe(Pa(1)).subscribe(function(){return bh.abort()}),hd(J(x.mark(function n_(){var _A;return x.wrap(function(r_){for(;;)switch(r_.prev=r_.next){case 0:return _A=Xg(0,Number.MAX_SAFE_INTEGER),_r.log("%s request opid: %d",_l,_A),r_.abrupt("return",He(_s,{headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"69","Content-Type":"application/json"},body:{flag:128,opid:_A,key:ga||_r.context.key,cname:_r.context.uid,detail:wa({},void 0===P?{11:[D.CHINA,D.GLOBAL].join()}:{11:Array.from(P.CODES).map(function(p_){return p_===D.OVERSEA?"".concat(D.ASIA,",").concat(D.EUROPE,",").concat(D.AFRICA,",").concat(D.NORTH_AMERICA,",").concat(D.SOUTH_AMERICA,",").concat(D.OCEANIA):p_}).join(",")}),uid:0,sid:_r.context.sid},signal:bh.signal}));case 3:case"end":return r_.stop()}},n_)}))).pipe(Ja(function(n_){return"AbortError"!==n_.name&&(_r.logError(n_),_r.warn("The AP server %s request failure",_s,n_)),yb}),fb(function(){var n_=J(x.mark(function _A(r_){var I_,v_,S_,x_,B_,V_,_0;return x.wrap(function(c0){for(;;)switch(c0.prev=c0.next){case 0:if(I_=JSON.parse(r_.responseText),_r.log("The %s response is %o",_l,I_),S_=(v_=I_).code,x_=v_.addresses,B_=v_.detail,0===S_){c0.next=6;break}return c0.abrupt("return",_r.handleUniLbsError(S_,_s));case 6:if(V_=x_,Pd(null)&&(_0=JSON.parse(null.replace(/-/g,".")),V_=_0.map(function(Pv){return{ip:Pv,ticket:V_[0].ticket}})),0!==V_.length){c0.next=11;break}return c0.abrupt("return",Z(Error("No available edge address to connect")));case 11:return _r.context.rtmArea=null==B_?void 0:B_[9],c0.abrupt("return",eb.apply(void 0,G(V_).concat([yg])));case 13:case"end":return c0.stop()}},_A)}));return function(_A){return n_.apply(this,arguments)}}()),Qg(),Ja(function(n_){return ta(n_)?Z(n_):yb}),zb(function(n_){return void 0!==n_&&"string"==typeof n_.ip&&"string"==typeof n_.ticket}))}),_r.context=f,_r.getApEdgeInfoEndFirst$=function(){var _s=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return Kc(0,_s||q?lc.RECONNECTING_AP_INTERVAL:2e3).pipe(Pa(1),ba(function(){_r.retryCount+=1}),fb(function(){return _r.context.config.enableCloudProxy||_r.context.socketUseProxy?_r.getProxyApUrl$(_s||q):(4<=_r.retryCount&&(_r.retryCount=0),3>=_r.retryCount?_r.getApUrl$(_s||q):_r.getBackupApUrl$(_s||q))}),fb(function(ga){return _r.context.config.enableCloudProxy||_r.context.socketUseProxy?_r.fetchCloudProxy(ga):_r.fetchAp(ga)}),Ja(function(ga){return ga instanceof sb&&_r.warn("AP request timeout"),Z(ga)}),rn(function(ga){return ga.ip}),rb(_r.apFinish$))},_r.getApEdgeInfo$=function(_s){return Kc(0,_s||q?lc.RECONNECTING_AP_INTERVAL:2e3).pipe(Pa(8),ba(function(){_r.retryCount+=1}),fb(function(){return _r.context.config.enableCloudProxy||_r.context.socketUseProxy?_r.getProxyApUrl$(_s||q):3>=_r.retryCount?_r.getApUrl$(_s||q):_r.getBackupApUrl$(_s||q)}),fb(function(ga){return(_r.context.config.enableCloudProxy||_r.context.socketUseProxy?_r.fetchCloudProxy(ga):_r.fetchAp(ga)).pipe()}),Ja(function(ga){return ga instanceof sb&&_r.warn("AP request timeout"),Z(ga)}),rn(function(ga){return ga.ip}),rb(_r.apFinish$))},_r}ja(l,h);var g=ka(l);return Ia(l,[{key:"clearUp",value:function(){this.failedAreas.clear(),this.retryCount=0}}]),l}(wb());m(at,"runOutOfUrlSymbol",Symbol("AP urls are used up"));var bt=ni(),ct=function(h){function l(f,k,q){X(this,l);var _r=g.call(this,k,"Connection");m(n(_r),"apClient",void 0),m(n(_r),"lastOpenSockets",[new Ee(1),new Ee(1)]),m(n(_r),"curOpenSockets",[void 0,void 0]),m(n(_r),"ipIterator",0),m(n(_r),"loginSocketOpenFailureCount",0),m(n(_r),"firstEnv",.5<=Math.random()?1:0),m(n(_r),"firstSocketOpener",void 0),m(n(_r),"secondSocketOpener",void 0),m(n(_r),"firstOpenKeeperSubject",new Ua),m(n(_r),"secondOpenKeeperSubject",new Ua),m(n(_r),"blacklistedIP",{}),m(n(_r),"edgeInfoReplayed",void 0),m(n(_r),"firstEnvOpenSocket",void 0),m(n(_r),"firstOpenKeeperSub",void 0),m(n(_r),"secondOpenKeeperSub",void 0),m(n(_r),"context",void 0),m(n(_r),"logger",void 0),_r.context=f,_r.logger=k,_r.apClient=new at(_r.context,k),_r.apClient.apFinish$.subscribe(function(){_r.log("Ap client fetch finished")});var _s,ga=[];return _r.edgeInfoReplayed=_r.apClient.getApEdgeInfo$(q).pipe(Ce(function(_l){return _l.pipe(ba(function(bh){if(ta(bh))throw bh}),jd(q?ie.getParameter("RECONNECTING_AP_INTERVAL"):900),rb(Kc(2e4)))}),zb(function(_l){var bh;return!Kl(ga,_l)&&1>=(null!==(bh=_r.blacklistedIP[_l.ip])&&void 0!==bh?bh:0)}),Md(function(){return new bt({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})}),ba(function(_l){ga.push(_l),_r.log("An edge info got %o",_l)}),ba({error:function(_l){_r.emit("connectionInitFailure",_l)}}),Tg(function(){_r.apClient.clearUp()}),vn()),_r.firstEnvOpenSocket=_r.edgeInfoReplayed.pipe(fb(function(_l){if(void 0===_l)return Z(Error("Invalid edge info"));var bh=new Sl(_l.ip,_r.firstEnv,_l.ticket,_r.context,k,_s);if(_r.firstEnv=1===_r.firstEnv?0:1,bh.once("connectionFailure",function(){return _r.onSocketConnectionFailure(bh)}),!q&&lc.ENABLE_EDGE_AUTO_FALLBACK&&!_r.context.config.enableCloudProxy){var n_,_A=Date.now();bh.on("reconnect",function(){var r_;_r.loginSocketOpenFailureCount+=1,null!==(r_=n_)&&void 0!==r_||(n_=Date.now()-_A),500>n_&&1<_r.loginSocketOpenFailureCount&&(_r.context.socketUseProxy=!0)})}return _s=!bh.useNewDomain,bh.open$.pipe(If(bh))}),ba(function(_l){_r.log("The websocket of ENV_%d opened to %s:%d",_l.env,_l.ip,rf[_l.env]),_r.curOpenSockets[_l.env]=_l,_r.lastOpenSockets[_l.env].next(_l),_r.firstEnv=_l.env,_r.openSecondSocket(_l.env,_l.ip,_l.useNewDomain)}),Pa(1),De()),_r.firstSocketOpener=_r.firstEnvOpenSocket.pipe(fb(function(_l){return _l.open$.pipe(ba(function(){_r.log("The websocket of first ENV_%d re-opened to %s:%d",_l.env,_l.ip,rf[_l.env]),_r.curOpenSockets[_l.env]=_l,_r.lastOpenSockets[_l.env].next(_l)}))})),f=_r.firstOpenKeeperSubject.pipe(Lc(ed)),_r.firstOpenKeeperSub=f.subscribe({error:_r.logError}),_r}ja(l,h);var g=ka(l);return Ia(l,[{key:"initConnection",value:function(){this.firstOpenKeeperSubject.next(this.firstSocketOpener)}},{key:"closeSocket",value:function(f,k){if(![0,1].includes(f))throw new Ha({INVALID_ENV:"The env argument is not 0 or 1"});var q=f===this.firstEnv?this.firstOpenKeeperSub:this.secondOpenKeeperSub;this.firstOpenKeeperSub=void 0;var _r=this.curOpenSockets[f];this.curOpenSockets[f]=void 0,_r&&(_r.isActiveClose=!0,setTimeout(function(){_r.close()},k)),void 0!==q&&setTimeout(function(){null==q||q.unsubscribe()},k)}},{key:"waitClosing",value:function(f){var k=this;return f.isActiveClose=!0,f.open$.pipe(nv(),Ja(function(q){return q.message===qs.normalClosureMessage?yb:Z(q)}),kb(5e3),Ja(function(q){return q instanceof sb?(k.warn("Force closing the ENV_%d connection",f.env),yb):Z(q)}))}},{key:"onSocketConnectionFailure",value:function(f){var k=[0,1].filter(function(q){return q!==f.env})[0];(k=this.curOpenSockets[k])&&k.loggedIn?this.reopenSocketWithApRequest(f.env):this.emit("socketsFailure")}},{key:"openSecondSocket",value:function(f,k,q){var _r=this,_s=1===f?0:1;this.secondSocketOpener=this.edgeInfoReplayed.pipe(un(function(ga,_l){return[].concat(G(ga),[_l])},[]),ea(function(ga){return os(ga,function(_l){return On(k,_l.ip)}).slice(-1)[0]}),Pa(1),fb(function(ga){if(void 0===ga)return Z(Error("Invalid edge info"));var _l=new Sl(ga.ip,_s,ga.ticket,_r.context,_r.logger,q);return _l.on("connectionFailure",function(){return _r.onSocketConnectionFailure(_l)}),_l.open$.pipe(ba(function(){_r.lastOpenSockets[_s].next(_l),_r.curOpenSockets[_s]=_l}))}),De()),this.secondOpenKeeperSub=this.secondOpenKeeperSubject.pipe(Lc(ed)).subscribe({error:this.logError}),this.secondOpenKeeperSubject.next(this.secondSocketOpener)}},{key:"reopenSocketWithApRequest",value:function(f){var k=this,q=[0,1].filter(function(ga){return ga!==f})[0];if(void 0!==(q=this.curOpenSockets[q])){var _r,_s=q.ip;q=this.apClient.getApEdgeInfoEndFirst$(!0).pipe(Md(function(){return new bt({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})}),Ce(function(ga){return ga.pipe(ba(function(_l){if(_l.code===ii)k.emit("tokenExpired"),k.apClient.apFinish$.next(void 0);else if(ta(_l))throw _l}),jd(ie.getParameter("RECONNECTING_AP_INTERVAL")),rb(Kc(15e3)))}),ba(function(ga){k.log("An edge info got %o",ga)}),Tg(function(){k.apClient.clearUp()})).pipe(un(function(ga,_l){return[].concat(G(ga),[_l])},[]),ea(function(ga){return(ga=os(ga,function(_l){return On(_s,_l.ip)})).length-1>=k.ipIterator?ga.slice(-k.ipIterator++-1)[0]:(k.ipIterator=0,ga.slice(-1)[0])}),Md(),fb(function(ga){if(void 0===ga)return Z(Error("Invalid edge info"));var _l=new Sl(ga.ip,f,ga.ticket,k.context,k.logger,_r);return _l.on("connectionFailure",function(){return k.onSocketConnectionFailure(_l)}),_r=!_l.useNewDomain,_l.open$.pipe(If(_l))}),ba(function(ga){k.log("The websocket of ENV_%d re-opened to %s:%d using ap",ga.env,ga.ip,rf[ga.env]),k.curOpenSockets[f]=ga,k.lastOpenSockets[f].next(ga)}),fb(function(ga){return ga.open$.pipe(ba(function(){k.log("The websocket of ENV_%d re-opened to %s:%d",ga.env,ga.ip,rf[ga.env]),k.curOpenSockets[f]=ga,k.lastOpenSockets[f].next(ga)}))}),De()),f===this.firstEnv?this.firstOpenKeeperSubject.next(q):this.secondOpenKeeperSubject.next(q)}}}]),l}(wb()),cd=nc.Writer,oa=nc.util,Gc=nc.roots.default||(nc.roots.default={}),NE=Gc.Session=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.sid="",h.prototype.userId="",h.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,h.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,h.prototype.appId="",h.prototype.ver="",h.prototype.buildno=0,h.prototype.installId="",h.prototype.os=0,h.prototype.did="",h.prototype.index=null,h.prototype.token="",h.prototype.version=0,h.prototype.subVersion=0,h.encode=function(l,g){return g||(g=cd.create()),null!=l.sid&&Object.hasOwnProperty.call(l,"sid")&&g.uint32(10).string(l.sid),null!=l.userId&&Object.hasOwnProperty.call(l,"userId")&&g.uint32(18).string(l.userId),null!=l.lts&&Object.hasOwnProperty.call(l,"lts")&&g.uint32(24).int64(l.lts),null!=l.elapse&&Object.hasOwnProperty.call(l,"elapse")&&g.uint32(32).int64(l.elapse),null!=l.appId&&Object.hasOwnProperty.call(l,"appId")&&g.uint32(42).string(l.appId),null!=l.ver&&Object.hasOwnProperty.call(l,"ver")&&g.uint32(50).string(l.ver),null!=l.buildno&&Object.hasOwnProperty.call(l,"buildno")&&g.uint32(56).int32(l.buildno),null!=l.installId&&Object.hasOwnProperty.call(l,"installId")&&g.uint32(66).string(l.installId),null!=l.os&&Object.hasOwnProperty.call(l,"os")&&g.uint32(128).int32(l.os),null!=l.did&&Object.hasOwnProperty.call(l,"did")&&g.uint32(138).string(l.did),null!=l.index&&Object.hasOwnProperty.call(l,"index")&&Gc.Session.CommonIndex.encode(l.index,g.uint32(162).fork()).ldelim(),null!=l.token&&Object.hasOwnProperty.call(l,"token")&&g.uint32(170).string(l.token),null!=l.version&&Object.hasOwnProperty.call(l,"version")&&g.uint32(176).int32(l.version),null!=l.subVersion&&Object.hasOwnProperty.call(l,"subVersion")&&g.uint32(184).int32(l.subVersion),g},h.CommonIndex=function(){function l(g){if(g)for(var f=Object.keys(g),k=0;k<f.length;++k)null!=g[f[k]]&&(this[f[k]]=g[f[k]])}return l.prototype.index1="",l.prototype.index2="",l.prototype.index3="",l.encode=function(g,f){return f||(f=cd.create()),null!=g.index1&&Object.hasOwnProperty.call(g,"index1")&&f.uint32(10).string(g.index1),null!=g.index2&&Object.hasOwnProperty.call(g,"index2")&&f.uint32(18).string(g.index2),null!=g.index3&&Object.hasOwnProperty.call(g,"index3")&&f.uint32(26).string(g.index3),f},l}(),h}(),OE=Gc.Link=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.sid="",h.prototype.userId="",h.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,h.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,h.prototype.ec=0,h.prototype.sc=0,h.prototype.destServerIp="",h.prototype.ackedServerIp="",h.prototype.responseTime=0,h.encode=function(l,g){return g||(g=cd.create()),null!=l.sid&&Object.hasOwnProperty.call(l,"sid")&&g.uint32(10).string(l.sid),null!=l.userId&&Object.hasOwnProperty.call(l,"userId")&&g.uint32(18).string(l.userId),null!=l.lts&&Object.hasOwnProperty.call(l,"lts")&&g.uint32(24).int64(l.lts),null!=l.elapse&&Object.hasOwnProperty.call(l,"elapse")&&g.uint32(32).int64(l.elapse),null!=l.ec&&Object.hasOwnProperty.call(l,"ec")&&g.uint32(40).int32(l.ec),null!=l.sc&&Object.hasOwnProperty.call(l,"sc")&&g.uint32(48).int32(l.sc),null!=l.destServerIp&&Object.hasOwnProperty.call(l,"destServerIp")&&g.uint32(58).string(l.destServerIp),null!=l.ackedServerIp&&Object.hasOwnProperty.call(l,"ackedServerIp")&&g.uint32(66).string(l.ackedServerIp),null!=l.responseTime&&Object.hasOwnProperty.call(l,"responseTime")&&g.uint32(72).int32(l.responseTime),g},h}(),PE=Gc.Logout=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.sid="",h.prototype.userId="",h.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,h.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,h.encode=function(l,g){return g||(g=cd.create()),null!=l.sid&&Object.hasOwnProperty.call(l,"sid")&&g.uint32(10).string(l.sid),null!=l.userId&&Object.hasOwnProperty.call(l,"userId")&&g.uint32(18).string(l.userId),null!=l.lts&&Object.hasOwnProperty.call(l,"lts")&&g.uint32(24).int64(l.lts),null!=l.elapse&&Object.hasOwnProperty.call(l,"elapse")&&g.uint32(32).int64(l.elapse),g},h}(),QE=Gc.KickedOff=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.sid="",h.prototype.userId="",h.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,h.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,h.prototype.linkId=0,h.prototype.code=0,h.prototype.server="",h.prototype.serverCode=0,h.encode=function(l,g){return g||(g=cd.create()),null!=l.sid&&Object.hasOwnProperty.call(l,"sid")&&g.uint32(10).string(l.sid),null!=l.userId&&Object.hasOwnProperty.call(l,"userId")&&g.uint32(18).string(l.userId),null!=l.lts&&Object.hasOwnProperty.call(l,"lts")&&g.uint32(24).int64(l.lts),null!=l.elapse&&Object.hasOwnProperty.call(l,"elapse")&&g.uint32(32).int64(l.elapse),null!=l.linkId&&Object.hasOwnProperty.call(l,"linkId")&&g.uint32(48).int32(l.linkId),null!=l.code&&Object.hasOwnProperty.call(l,"code")&&g.uint32(56).int32(l.code),null!=l.server&&Object.hasOwnProperty.call(l,"server")&&g.uint32(66).string(l.server),null!=l.serverCode&&Object.hasOwnProperty.call(l,"serverCode")&&g.uint32(72).int32(l.serverCode),g},h}(),RE=Gc.ChnJoin=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.sid="",h.prototype.userId="",h.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,h.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,h.prototype.cname="",h.prototype.errCode=0,h.encode=function(l,g){return g||(g=cd.create()),null!=l.sid&&Object.hasOwnProperty.call(l,"sid")&&g.uint32(10).string(l.sid),null!=l.userId&&Object.hasOwnProperty.call(l,"userId")&&g.uint32(18).string(l.userId),null!=l.lts&&Object.hasOwnProperty.call(l,"lts")&&g.uint32(24).int64(l.lts),null!=l.elapse&&Object.hasOwnProperty.call(l,"elapse")&&g.uint32(32).int64(l.elapse),null!=l.cname&&Object.hasOwnProperty.call(l,"cname")&&g.uint32(50).string(l.cname),null!=l.errCode&&Object.hasOwnProperty.call(l,"errCode")&&g.uint32(56).int32(l.errCode),g},h}(),SE=Gc.ChnJoinRes=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.sid="",h.prototype.userId="",h.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,h.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,h.prototype.cname="",h.prototype.errCode=0,h.prototype.serverErrCode=0,h.encode=function(l,g){return g||(g=cd.create()),null!=l.sid&&Object.hasOwnProperty.call(l,"sid")&&g.uint32(10).string(l.sid),null!=l.userId&&Object.hasOwnProperty.call(l,"userId")&&g.uint32(18).string(l.userId),null!=l.lts&&Object.hasOwnProperty.call(l,"lts")&&g.uint32(24).int64(l.lts),null!=l.elapse&&Object.hasOwnProperty.call(l,"elapse")&&g.uint32(32).int64(l.elapse),null!=l.cname&&Object.hasOwnProperty.call(l,"cname")&&g.uint32(50).string(l.cname),null!=l.errCode&&Object.hasOwnProperty.call(l,"errCode")&&g.uint32(56).int32(l.errCode),null!=l.serverErrCode&&Object.hasOwnProperty.call(l,"serverErrCode")&&g.uint32(64).int32(l.serverErrCode),g},h}(),TE=Gc.ChnLeave=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.sid="",h.prototype.userId="",h.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,h.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,h.prototype.cname="",h.prototype.errCode=0,h.encode=function(l,g){return g||(g=cd.create()),null!=l.sid&&Object.hasOwnProperty.call(l,"sid")&&g.uint32(10).string(l.sid),null!=l.userId&&Object.hasOwnProperty.call(l,"userId")&&g.uint32(18).string(l.userId),null!=l.lts&&Object.hasOwnProperty.call(l,"lts")&&g.uint32(24).int64(l.lts),null!=l.elapse&&Object.hasOwnProperty.call(l,"elapse")&&g.uint32(32).int64(l.elapse),null!=l.cname&&Object.hasOwnProperty.call(l,"cname")&&g.uint32(50).string(l.cname),null!=l.errCode&&Object.hasOwnProperty.call(l,"errCode")&&g.uint32(56).int32(l.errCode),g},h}(),UE=Gc.ConnectionStateChange=function(){function h(l){if(l)for(var g=Object.keys(l),f=0;f<g.length;++f)null!=l[g[f]]&&(this[g[f]]=l[g[f]])}return h.prototype.sid="",h.prototype.userId="",h.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,h.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,h.prototype.oldState=0,h.prototype.newState=0,h.prototype.reason=0,h.prototype.reconnId=0,h.encode=function(l,g){return g||(g=cd.create()),null!=l.sid&&Object.hasOwnProperty.call(l,"sid")&&g.uint32(10).string(l.sid),null!=l.userId&&Object.hasOwnProperty.call(l,"userId")&&g.uint32(18).string(l.userId),null!=l.lts&&Object.hasOwnProperty.call(l,"lts")&&g.uint32(24).int64(l.lts),null!=l.elapse&&Object.hasOwnProperty.call(l,"elapse")&&g.uint32(32).int64(l.elapse),null!=l.oldState&&Object.hasOwnProperty.call(l,"oldState")&&g.uint32(40).int32(l.oldState),null!=l.newState&&Object.hasOwnProperty.call(l,"newState")&&g.uint32(48).int32(l.newState),null!=l.reason&&Object.hasOwnProperty.call(l,"reason")&&g.uint32(56).int32(l.reason),null!=l.reconnId&&Object.hasOwnProperty.call(l,"reconnId")&&g.uint32(64).int32(l.reconnId),g},h}(),aw=Object.freeze({__proto__:null,Session:NE,Link:OE,Logout:PE,KickedOff:QE,ChnJoin:RE,ChnJoinRes:SE,ChnLeave:TE,ConnectionStateChange:UE,default:Gc}),bw=Object.freeze({__proto__:null,Counter:1,ApiExec:154,Session:164,ApEvent:165,Link:166,Logout:167,TxMessage:168,RxMessage:169,KickedOff:170,TxMessageRes:171,ChnJoin:172,ChnJoinRes:173,ChnLeave:174,ChnGetMembers:175,ChnGetMembersRes:176,ChnMemberJoined:177,ChnMemberLeft:178,QueryPeersOnlineStatus:179,QueryPeersOnlineStatusRes:180,RenewToken:181,OperateAttribute:186,OperateAttributeRes:187,ApRequest:188,LinkTcpEvent:189,LinkLoginRequest:190,ConnectionStateChange:191,default:{Counter:1,ApiExec:154,Session:164,ApEvent:165,Link:166,Logout:167,TxMessage:168,RxMessage:169,KickedOff:170,TxMessageRes:171,ChnJoin:172,ChnJoinRes:173,ChnLeave:174,ChnGetMembers:175,ChnGetMembersRes:176,ChnMemberJoined:177,ChnMemberLeft:178,QueryPeersOnlineStatus:179,QueryPeersOnlineStatusRes:180,RenewToken:181,OperateAttribute:186,OperateAttributeRes:187,ApRequest:188,LinkTcpEvent:189,LinkLoginRequest:190,ConnectionStateChange:191}}),VE=function(h){function l(f,k,q){return X(this,l),m(n(q=g.call(this,q,"Context")),"_token",void 0),m(n(q),"config",void 0),m(n(q),"_uid",void 0),m(n(q),"_sid",void 0),m(n(q),"_area","CN"),m(n(q),"_socketUseProxy",!1),m(n(q),"appId",void 0),m(n(q),"enableCloudProxy",!1),m(n(q),"cloudProxyServers",[]),q.appId=f,q.config=k,q}ja(l,h);var g=ka(l);return Ia(l,[{key:"socketUseProxy",get:function(){return this._socketUseProxy&&lc.ENABLE_EDGE_AUTO_FALLBACK},set:function(f){this.log("socketUseProxy is set to %s",f),this._socketUseProxy=f}},{key:"token",set:function(f){this._token="string"==typeof f&&f?f:void 0}},{key:"uid",get:function(){if("string"==typeof this._uid&&this._uid)return this._uid;throw new Ma("Cannot get illegal uid")},set:function(f){if(this.log("The user ID is set to %s",pa(f)),!Aa(f))throw new Ma;this._uid=f}},{key:"key",get:function(){if("string"==typeof this._token&&this._token)return this._token;if("string"==typeof this.appId&&this.appId)return this.appId;throw new Ma("Cannot get illegal key")}},{key:"sid",get:function(){if("string"==typeof this._sid&&this._sid)return this._sid;throw new Ma("Cannot get illegal sid")},set:function(f){if(this.log("sid is set to %s",f),"string"!=typeof f||!f)throw new Ma;this._sid=f}},{key:"rtmArea",get:function(){if("string"==typeof this._area&&this._area)return this._area;throw new Ma("Cannot get illegal area")},set:function(f){this.log("area is set to %s",f),"string"==typeof f&&f?this._area=f:this.warn("set area failed")}}]),l}(wb()),WE=!!Nc&&R(function(){Nc.prototype.finally.call({then:function(){}},function(){})});if(M({target:"Promise",proto:!0,real:!0,forced:WE},{finally:function(h){var l=od(this,Rb("Promise")),g="function"==typeof h;return this.then(g?function(f){return bk(l,h()).then(function(){return f})}:h,g?function(f){return bk(l,h()).then(function(){throw f})}:h)}}),"function"==typeof Nc){var dt=Rb("Promise").prototype.finally;Nc.prototype.finally!==dt&&Ea(Nc.prototype,"finally",dt,{unsafe:!0})}var XE=function(){var h=J(x.mark(function l(g){return x.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.t0=Uint8Array,f.next=3,crypto.subtle.digest("SHA-256",g);case 3:return f.t1=f.sent,f.abrupt("return",new f.t0(f.t1));case 5:case"end":return f.stop()}},l)}));return function(l){return h.apply(this,arguments)}}(),et=function(h){return Array.from(h).map(function(l){return l.toString(16).padStart(2,"0")}).join("")},YE=function(h){if("string"!=typeof h)throw new TypeError("Expected input to be a string");if(h.length%2!=0)throw new RangeError("Expected string to be an even number of characters");for(var l=new Uint8Array(h.length/2),g=0;g<h.length;g+=2)l[g/2]=parseInt(h.substring(g,g+2),16);return l},ft=function(h){return btoa(String.fromCharCode.apply(String,G(h))).replace(/={1,2}$/,"")},gt=function(){var h=J(x.mark(function l(g){var f;return x.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.prev=0,k.next=3,crypto.subtle.digest("SHA-1",g);case 3:f=k.sent,k.next=9;break;case 6:k.prev=6,k.t0=k.catch(0),f=sha1.arrayBuffer(g);case 9:return k.abrupt("return",ft(new Uint8Array(f)));case 10:case"end":return k.stop()}},l,null,[[0,6]])}));return function(l){return h.apply(this,arguments)}}(),ht=function(h,l,g,f){f[l]=!0,g.has(h)?g.get(h).add(l):g.set(h,new Set([l]))},ZE=function(h){switch(h){case"89504E47":return"image/png";case"47494638":return"image/gif";case"25504446":return"application/pdf";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":return"image/jpeg";case"504B0304":return"application/zip";default:return"application/octet-stream"}},it=function(h){function l(f,k,q,_r){X(this,l);var _s=g.call(this,q,"ChunkDownloadManager");if(m(n(_s),"abortController",new AbortController),m(n(_s),"downloadedSize",0),m(n(_s),"successCount",0),m(n(_s),"timer",void 0),m(n(_s),"chunks",[]),m(n(_s),"retUnit",void 0),m(n(_s),"singleThread",!1),m(n(_s),"initialized",!1),m(n(_s),"ee",void 0),m(n(_s),"chunkCount",void 0),m(n(_s),"aborted",!1),m(n(_s),"serverToIndices",new Map),m(n(_s),"backupToIndices",new Map),m(n(_s),"indexToBackupServers",[]),m(n(_s),"busyBackupServers",new Map),m(n(_s),"downloadingChunks",new Set),m(n(_s),"metaInfo",void 0),m(n(_s),"transHandler",void 0),_s.metaInfo=f,_s.transHandler=k,_s.ee=void 0===_r?new ia:_r,q=f.size,f=f.unit,0===q)throw new Ma("size cannot be 0");return void 0!==k.cancelSignal&&k.cancelSignal.addEventListener("abort",function(){_s.abortController.abort()},{once:!0}),_s.abortController.signal.addEventListener("abort",function(){_s.aborted=!0},{once:!0}),_s.chunkCount=Math.ceil(q/(32768*f)),_s}ja(l,h);var g=ka(l);return Ia(l,[{key:"setInfoByResponse",value:function(f){var k=this,q=f.serverList,_r=f.backupList;if(f=f.unit,q.length<this.chunkCount&&_r.length<this.chunkCount)throw new Ma("servers is not enough");this.updateProgress(0),this.initialized=!0;var _s=Array(this.chunkCount).fill(!1);if(q.forEach(function(ga,_l){return ga.forEach(function(bh){return ht(bh,_l,k.serverToIndices,_s)})}),_r.forEach(function(ga,_l){return ga.forEach(function(bh){return ht(bh,_l,k.backupToIndices,_s)})}),_s.some(function(){return!1}))throw new da("Not enough servers to download",Eg);this.indexToBackupServers=_r.map(function(ga){return new Set(ga)}),this.retUnit=f}},{key:"downloadChunks",value:function(){this.aborted?this.warn("downloadChunks after abort, ignored"):1===this.serverToIndices.size&&0===Array.from(this.serverToIndices.keys())[0]?this.serversDownload(this.backupToIndices):1<=this.serverToIndices.size?this.serversDownload(this.serverToIndices,!0):this.ee.emit("error",new da("not enough servers to download",Eg))}},{key:"updateProgress",value:function(f){var k=this,q=this.downloadedSize+f;this.downloadedSize>this.metaInfo.size?(this.warn("Invalid download size, overflowed"),this.ee.emit("error",new bd("Invalid download size",Eg))):(this.downloadedSize=q,void 0!==this.timer&&0!==f&&(clearTimeout(this.timer),this.timer=void 0),void 0===this.timer&&this.successCount!==this.chunkCount&&(this.timer=setTimeout(function(){k.ee.emit("timedOut"),k.abortController.abort()},12e4)),this.initialized&&0===f||void 0===this.transHandler.onOperationProgress||this.transHandler.onOperationProgress({totalSize:this.metaInfo.size,currentSize:this.downloadedSize}))}},{key:"getPayload",value:function(){for(var f=0,k=0,q=this.chunks;k<q.length;k++)f+=q[k].byteLength;if(f!==this.metaInfo.size)throw new Ma("invalid chunks total size");f=new Uint8Array(f),q=k=0;for(var _r=this.chunks;q<_r.length;q++){var _s=_r[q];f.set(new Uint8Array(_s),k),k+=_s.byteLength}return k=Array.from(f.subarray(0,4)).map(function(ga){return ga.toString(16)}).join("").toUpperCase(),Uv(f.buffer,ZE(k))}},{key:"getDownloadUrl",value:function(f){var k=this.metaInfo.useNewDomain?"sd-rtn.com":"agora.io";return"https://".concat($g(f).split(".").join("-"),".edge.").concat(Pd(null)?null:k,":9601/api/v1/chuck/download")}},{key:"serversDownload",value:function(){var f=J(x.mark(function k(q){var _r,_s=this,ga=arguments;return x.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:return _r=1<ga.length&&void 0!==ga[1]&&ga[1],_l.next=3,Promise.all(Array.from(q.entries()).map(function(bh){return bh=ua(bh,2),_s.postDownloadRequest(bh[0],Array.from(bh[1]),_r).catch(function(n_){404===n_.statusCode?(_s.ee.emit("notExist"),_s.abortController.abort()):"AbortError"!==n_.name&&(Xa(n_)?_s.singleThread?(_s.abortController.abort(),_s.ee.emit("timedOut")):(_s.warn("%d download timed out after %d, retrying use single thread",n_.index,_s.singleThread?6e4:3e4),_s.abortController.abort(),_s.singleThread=!0,_s.ee.emit("multiTimeOut")):(_s.ee.emit("error",n_),_s.abortController.abort()))})}));case 3:case"end":return _l.stop()}},k)}));return function(k){return f.apply(this,arguments)}}()},{key:"postDownloadRequest",value:function(){var f=J(x.mark(function k(q,_r,_s){var ga,_l,bh,n_,_A,r_,p_,I_,v_,S_=this;return x.wrap(function(x_){for(;;)switch(x_.prev=x_.next){case 0:if(v_=function(){return(v_=J(x.mark(function B_(V_){var _0,Pv,h0,I0,G_,e0,P_,_v;return x.wrap(function(E_){for(;;)switch(E_.prev=E_.next){case 0:if(E_.prev=0,void 0!==V_||0!==q){E_.next=5;break}throw new Ma("Invalid serverIp");case 5:_0=void 0===V_?p_.getDownloadUrl(q):V_;case 6:return p_.downloadingChunks.add(ga),E_.next=9,r_(_0);case 9:return Pv=E_.sent.responseData,p_.downloadingChunks.delete(ga),E_.abrupt("return",Pv);case 15:if(E_.prev=15,E_.t0=E_.catch(0),p_.downloadingChunks.delete(ga),_r.unshift(ga),p_.metaInfo.useNewDomain=!1,"AbortError"!==E_.t0.name){E_.next=22;break}throw E_.t0;case 22:if(!Xa(E_.t0)){E_.next=25;break}throw E_.t0.index=ga,E_.t0;case 25:if(h0=n_,n_+=1,!(2>h0)){E_.next=30;break}return E_.t0 instanceof Ma||p_.warn("%o, %d download failed, retrying",E_.t0,ga),E_.abrupt("return",I_());case 30:if(504!==E_.t0.statusCode){E_.next=34;break}throw(I0=new gb("download server timed out",{originalError:E_.t0,serverCode:504})).index=ga,I0;case 34:if(!_s||2!==h0||0===_A[0]){E_.next=45;break}return E_.t0 instanceof Ma||p_.warn("%d download failed, using backup: %d, %o",ga,_A[0],E_.t0),E_.next=38,p_.busyBackupServers.get(_A[0]);case 38:return G_=I_(p_.getDownloadUrl(_A[0])),p_.busyBackupServers.set(_A[0],G_),E_.next=42,G_;case 42:return e0=E_.sent,p_.busyBackupServers.delete(_A[0]),E_.abrupt("return",e0);case 45:if(!(_s&&2<h0&&void 0!==_A[1]&&0!==_A[1])){E_.next=56;break}return p_.warn("%d download failed, using backup 1: %d",ga,_A[1]),E_.next=49,p_.busyBackupServers.get(_A[1]);case 49:return P_=I_(p_.getDownloadUrl(_A[1])),p_.busyBackupServers.set(_A[1],P_),E_.next=53,P_;case 53:return _v=E_.sent,p_.busyBackupServers.delete(_A[1]),E_.abrupt("return",_v);case 56:throw E_.t0.index=ga,E_.t0;case 58:case"end":return E_.stop()}},B_,null,[[0,15]])}))).apply(this,arguments)},I_=function(B_){return v_.apply(this,arguments)},!this.aborted){x_.next=4;break}throw new Ma("download already aborted");case 4:if(void 0!==(ga=_r.shift())){x_.next=8;break}return this.log("%s download finished",q),x_.abrupt("return");case 8:if(!(this.singleThread&&0<this.downloadingChunks.size)){x_.next=10;break}return x_.abrupt("return");case 10:if(!this.downloadingChunks.has(ga)){x_.next=13;break}return this.log("%s already downloading, return",ga),x_.abrupt("return");case 13:if(void 0===this.chunks[ga]){x_.next=19;break}return this.successCount===this.chunkCount&&(this.log("chunks all download"),this.ee.emit("finished")),this.log("%s already downloaded, do next",ga),x_.next=18,this.postDownloadRequest(q,_r,_s);case 18:return x_.abrupt("return");case 19:return _l=new FormData,bh={hash:cw(this.metaInfo.hashHexStr),unit:void 0===this.retUnit?this.metaInfo.unit:this.retUnit,instance:this.metaInfo.instance,loginOpt:this.metaInfo.loginOpt,ticket:this.metaInfo.ticket,index:ga},_l.append("parameter",JSON.stringify(bh)),n_=0,_A=Array.from(this.indexToBackupServers[ga]),r_=function(B_){return He(B_,{body:_l,signal:S_.abortController.signal,timeout:S_.singleThread?12e4:3e4},{useBinaryResponse:!0})},p_=this,x_.next=28,I_().then(function(B_){return void 0!==S_.chunks[ga]?S_.log("chunk %d download duplicated",ga):(S_.chunks[ga]=B_,S_.log("chunk %d downloaded",ga),S_.successCount+=1,S_.updateProgress(S_.chunks[ga].byteLength)),S_.successCount===S_.chunkCount&&(S_.log("chunks all download"),S_.ee.emit("finished")),S_.singleThread?(S_.downloadChunks(),Promise.resolve()):S_.postDownloadRequest(q,_r,_s)});case 28:case"end":return x_.stop()}},k,this)}));return function(k,q,_r){return f.apply(this,arguments)}}()}]),l}(wb()),jt=function(h){function l(f,k,q,_r){X(this,l);var _s=g.call(this,q,"ChunkUploadManager");if(m(n(_s),"chunkCount",0),m(n(_s),"chunks",[]),m(n(_s),"uploadedChunks",[]),m(n(_s),"totalFailures",0),m(n(_s),"timer",void 0),m(n(_s),"initState","uninitialized"),m(n(_s),"ee",void 0),m(n(_s),"unit",0),m(n(_s),"uploadedSize",0),m(n(_s),"singleThread",!1),m(n(_s),"abortController",new AbortController),m(n(_s),"servers",[]),m(n(_s),"aborted",!1),m(n(_s),"metaInfo",void 0),m(n(_s),"transHandler",void 0),_s.metaInfo=f,_s.transHandler=k,_s.ee=void 0===_r?new ia:_r,0===f.file.length)throw new H("file not found or is empty",Of);return void 0!==k.cancelSignal&&k.cancelSignal.addEventListener("abort",function(){_s.abortController.abort()},{once:!0}),_s.abortController.signal.addEventListener("abort",function(){_s.aborted=!0},{once:!0}),_s}ja(l,h);var g=ka(l);return Ia(l,[{key:"initChunks",value:function(){var f=J(x.mark(function k(q){var _r,_s,ga,_l,bh,n_=this;return x.wrap(function(_A){for(;;)switch(_A.prev=_A.next){case 0:if("initialized"!==this.initState&&"initializing"!==this.initState){_A.next=2;break}throw new Ma("cannot re-initialize");case 2:for(this.initState="initializing",this.unit=q,_r=this.sliceFile(q,this.metaInfo.file),this.chunkCount=_r.length,_s=[],ga=function(r_,p_){var I_=(r_=ua(p_[r_],2))[0],v_=r_[1];r_=gt(v_).then(function(S_){n_.chunks[I_]={payload:v_,sha1:S_,uploadedTo:void 0,index:I_,processed:!1}}),_s.push(r_)},_l=0,bh=Array.from(_r.entries());_l<bh.length;_l++)ga(_l,bh);return _A.next=11,Promise.all(_s);case 11:this.updateProgress(0),this.initState="initialized",this.log("upload chunks initialized");case 14:case"end":return _A.stop()}},k,this)}));return function(k){return f.apply(this,arguments)}}()},{key:"uploadToServers",value:function(){var f=this;if(!this.aborted){for(var k=this.chunks.filter(function(_s){return!_s.processed}),q=function(_s){var ga=k[_s],_l=f.servers.filter(function(n_){return!n_.isUploading}).sort(function(n_,_A){return n_.successCount-_A.successCount}).sort(function(n_,_A){return n_.failureCount-_A.failureCount})[0];if(void 0===_l||1<_l.failureCount)return f.log("Upload server not available, waiting"),f.ee.emit("serverUsedUp"),gj(1e3).then(function(){f.totalFailures>2*f.chunkCount&&f.ee.emit("error"),f.totalFailures+=1,void 0!==_l&&(_l.failureCount=0),f.uploadToServers()}).catch(function(){}),"break";ga.processed=!0,_l.isUploading=!0,f.log("uploading chunk %d to server %s",ga.index,$g(_l.ip));var bh=f.getUploadUrl(_l.ip);return J(x.mark(function n_(){var _A;return x.wrap(function(r_){for(;;)switch(r_.prev=r_.next){case 0:return r_.prev=0,r_.next=3,f.postChunk(ga.payload,bh,ga.index);case 3:_A=f.chunks.findIndex(function(p_){return p_===ga}),ga.uploadedTo=_l.ip,f.chunks.splice(_A,1),f.uploadedChunks.push(ga),_l.successCount+=1,_l.isUploading=!1,f.updateProgress(ga.payload.byteLength),f.log("upload chunk %d successfully",ga.index),r_.next=31;break;case 13:if(r_.prev=13,r_.t0=r_.catch(0),_l.isUploading=!1,ga.processed=!1,504!==r_.t0.statusCode&&!Xa(r_.t0)){r_.next=27;break}if(f.singleThread){r_.next=24;break}return f.warn("%d upload timed out after %d, retrying use single thread",ga.index,f.singleThread?12e4:3e4),f.abortController.abort(),f.singleThread=!0,f.ee.emit("multiTimeOut"),r_.abrupt("return");case 24:return f.ee.emit("timedOut"),f.abortController.abort(),r_.abrupt("return");case 27:return f.metaInfo.useNewDomain=!1,_l.failureCount+=1,r_.next=31,gj(1e3);case 31:f.uploadedChunks.length===f.chunkCount?(f.log("chunks uploaded"),f.ee.emit("finished")):(f.singleThread||1===f.chunks.filter(function(p_){return!p_.processed}).length)&&f.uploadToServers();case 32:case"end":return r_.stop()}},n_,null,[[0,13]])}))(),f.singleThread?"break":void 0},_r=0;_r<k.length&&"break"!==q(_r);_r++);0===k.length&&this.uploadedChunks.length!==this.chunkCount&&this.log("%d chunks left uploading",this.chunkCount-this.uploadedChunks.length)}}},{key:"getUploadServerIPs",value:function(){var f=!0,k=[],q=G(this.uploadedChunks).sort(function(ga,_l){return ga.index-_l.index}),_r=0;for(q=Array.from(q.values());_r<q.length;_r++){var _s=q[_r].uploadedTo;if(void 0===_s){f=!1;break}k.push(_s)}if(!f)throw new Ma("some chunks not uploaded, cannot get upload server ips");return k}},{key:"addServers",value:function(f){var k=this;f.forEach(function(q){var _r=k.servers.findIndex(function(_s){return _s.ip===q});-1!==_r?k.servers[_r].failureCount=0:(k.log("server %s added",$g(q)),k.servers.push({successCount:0,isUploading:!1,ip:q,failureCount:0}))})}},{key:"updateProgress",value:function(f){var k=this,q=void 0!==f?this.uploadedSize+f:this.metaInfo.file.length;q>this.metaInfo.file.length?(this.warn("Invalid upload size, overflowed"),this.ee.emit("error",new bd("Invalid upload size",Dg))):(this.uploadedSize=q,void 0!==this.timer&&0!==f&&(clearTimeout(this.timer),this.timer=void 0),void 0===this.timer&&void 0!==f&&this.uploadedChunks.length!==this.chunkCount&&(this.timer=setTimeout(function(){k.ee.emit("timedOut"),k.abortController.abort()},12e4)),"initialized"===this.initState&&0===f||void 0===this.transHandler.onOperationProgress||this.transHandler.onOperationProgress({totalSize:this.metaInfo.file.length,currentSize:this.uploadedSize}))}},{key:"sliceFile",value:function(f,k){var q=0,_r=[],_s=k.length;for(f*=32768;q<_s;)_r.push(k.slice(q,q+f)),q+=f;return this.log("chunks split into %d",_r.length),_r}},{key:"postChunk",value:function(){var f=J(x.mark(function k(q,_r,_s){var ga,_l,bh,n_,_A,r_,p_;return x.wrap(function(v_){for(;;)switch(v_.prev=v_.next){case 0:if(!this.aborted){v_.next=2;break}throw new Ma("upload already aborted");case 2:if(void 0!==this.unit){v_.next=4;break}throw new Ma("unit is undefined");case 4:return _l=(ga=this.metaInfo).ticket,bh=ga.instance,n_=ga.loginOpt,_A=ga.hashStr,v_.t0=_s,v_.t1=_A,v_.next=9,gt(q);case 9:return v_.t2=v_.sent,v_.t3=this.unit,v_.t4=_l,v_.t5=bh,v_.t6=n_,r_={index:v_.t0,hash:v_.t1,sha1:v_.t2,unit:v_.t3,ticket:v_.t4,instance:v_.t5,loginOpt:v_.t6},(p_=new FormData).append("parameter",JSON.stringify(r_)),p_.append("payload",new Blob([q])),v_.next=20,He(_r,{headers:{Accept:"application/json"},body:p_,timeout:this.singleThread?12e4:3e4,signal:this.abortController.signal});case 20:if(201===v_.sent.status){v_.next=24;break}throw new da("uploading chunk ".concat(_s," failed"));case 24:case"end":return v_.stop()}},k,this)}));return function(k,q,_r){return f.apply(this,arguments)}}()},{key:"getUploadUrl",value:function(f){var k=this.metaInfo.useNewDomain?"sd-rtn.com":"agora.io";return"https://".concat($g(f).split(".").join("-"),".edge.").concat(Pd(null)?null:k,":9601/api/v1/chuck/upload")}}]),l}(wb()),kt=function(h){function l(f){X(this,l);var k=g.call(this,f,"MediaTaskManager");return m(n(k),"isProcessing",!1),m(n(k),"authInfo",void 0),m(n(k),"taskFinishers",{}),m(n(k),"mediaTasks",new Map),m(n(k),"ongoingTask",void 0),k.on("connectionStateChanged",function(q){if(q===S.ConnectionState.ABORTED||q===S.ConnectionState.DISCONNECTED){void 0!==k.ongoingTask&&k.cancelTask(k.ongoingTask),q=0;for(var _r=Array.from(k.mediaTasks.entries());q<_r.length;q++){var _s=ua(_r[q],2)[1];k.cancelTask(_s)}k.mediaTasks.clear(),k.taskFinishers={}}else q===S.ConnectionState.RECONNECTING?void 0!==k.ongoingTask&&k.ongoingTask.manager.abortController.abort():q===S.ConnectionState.CONNECTED&&void 0!==k.ongoingTask&&k.ongoingTask.manager.ee.emit("reconnected")}),k}ja(l,h);var g=ka(l);return Ia(l,[{key:"setAuthInfo",value:function(f){this.authInfo=f}},{key:"waitMediaTask",value:function(f){var k=this;return new Promise(function(q,_r){k.taskFinishers[f]={resolve:q,reject:_r},k.isProcessing||k.processMediaTask()}).finally(function(){void 0!==k.ongoingTask&&void 0!==k.ongoingTask.manager.timer&&clearTimeout(k.ongoingTask.manager.timer),delete k.taskFinishers[f],0!==k.mediaTasks.size?k.processMediaTask():k.isProcessing=!1})}},{key:"addUploadTask",value:function(f,k,q,_r){var _s=f.file;if(f=f.hash,void 0===this.authInfo)throw new Ma("session not found");if(this.mediaTasks.size>=l.MAX_PENDING_TASK_COUNT-1)throw new lb("Upload media failed, exceed max pending jobs",tC);return _r=new jt({hashStr:ft(f),file:_s,ticket:this.authInfo.ticket,instance:this.authInfo.instance.toString(),loginOpt:this.authInfo.loginOpt.toString(),useNewDomain:this.authInfo.useNewDomain},_r,this.logger),_s=de(),this.mediaTasks.set(_s,{type:"UPLOAD",manager:_r,hash:f,setter:q,fetcher:k,taskId:_s}),_s}},{key:"addDownloadTask",value:function(f,k,q){var _r=f.hashHexStr,_s=f.size,ga=f.unit;if(f=f.zone,void 0===this.authInfo)throw new Ma("session not found");if(this.mediaTasks.size>=l.MAX_PENDING_TASK_COUNT-1)throw new lb("Download media failed, exceed max pending jobs",xC);return q=new it({hashHexStr:_r,ticket:this.authInfo.ticket,useNewDomain:this.authInfo.useNewDomain,instance:this.authInfo.instance.toString(),loginOpt:this.authInfo.loginOpt.toString(),size:_s,zone:f,unit:ga},q,this.logger),_r=de(),this.mediaTasks.set(_r,{type:"DOWNLOAD",manager:q,fetcher:k,taskId:_r}),_r}},{key:"doDownloadTaskImpl",value:function(){var f=J(x.mark(function k(q,_r){var _s,ga,_l,bh,n_,_A,r_,p_,I_=this,v_=arguments;return x.wrap(function(S_){for(;;)switch(S_.prev=S_.next){case 0:return _l=ga=q.manager,(_s=2<v_.length&&void 0!==v_[2]&&v_[2])&&(ga=new it(_l.metaInfo,_l.transHandler,this.logger,_l.ee)),bh=q.fetcher,S_.next=7,bh();case 7:if(_A=(n_=S_.sent).serverList,r_=n_.backupList,p_=n_.unit,!_s||p_===_l.retUnit){S_.next=13;break}throw new da("download unit is different, reject to continue",Eg);case 13:_s&&(q.manager=ga,ga.downloadedSize=_l.downloadedSize,ga.successCount=_l.successCount,ga.timer=_l.timer,ga.chunks=_l.chunks,ga.initialized=_l.initialized,ga.singleThread=_l.singleThread,ga.updateProgress(0)),ga.ee.once("reconnected",function(){ga.ee.removeAllListeners(),I_.doDownloadTaskImpl(q,_r,!0).catch(function(x_){_r.reject(x_)})}),ga.ee.once("multiTimeOut",function(){ga.ee.removeAllListeners(),I_.doDownloadTaskImpl(q,_r,!0).catch(function(x_){_r.reject(x_)})}),ga.ee.once("error",function(x_){ga.ee.removeAllListeners(),_r.reject(new da(["download file file, index %d",x_.index],{code:Eg,originalError:x_}))}),ga.ee.once("notExist",function(){ga.abortController.abort(),ga.ee.removeAllListeners(),_r.reject(new da("download file not found",wC))}),ga.ee.once("timedOut",function(){ga.ee.removeAllListeners(),ga.abortController.abort(),_r.reject(new gb("download timed out",vC))}),void 0!==ga.transHandler.cancelSignal&&ga.transHandler.cancelSignal.addEventListener("abort",function(){_r.reject(new Ol("Downloading canceled",ms))},{once:!0}),ga.ee.once("finished",function(){_r.resolve({type:"DOWNLOAD",payload:ga.getPayload()})}),ga.setInfoByResponse({serverList:_A,backupList:r_,unit:p_}),ga.downloadChunks();case 23:case"end":return S_.stop()}},k,this)}));return function(k,q){return f.apply(this,arguments)}}()},{key:"doDownloadTask",value:function(f,k){var q=this,_r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],_s=f.taskId;return _r||(this.mediaTasks.delete(_s),this.ongoingTask=f),new Promise(function(ga,_l){q.doDownloadTaskImpl(f,k,_r).then(ga).catch(_l)})}},{key:"doUploadTaskImpl",value:function(){var f=J(x.mark(function k(q,_r){var _s,ga,_l,bh,n_,_A,r_,I_,v_=this,S_=arguments;return x.wrap(function(x_){for(;;)switch(x_.prev=x_.next){case 0:return _l=ga=q.manager,(_s=2<S_.length&&void 0!==S_[2]&&S_[2])&&(ga=new jt(_l.metaInfo,_l.transHandler,this.logger,_l.ee)),bh=q.fetcher,n_=new Ua,r_=new Promise(function(B_,V_){var I0,_0=bh(),c0=_0.ret,Pv=_0.err,h0=_0.timeout;_0.fin.pipe(rb(n_)).subscribe({next:function(I0){_r.resolve({type:"UPLOAD",retUnit:I0.unit,zone:I0.zone})},complete:function(){B_({hasExist:!0}),n_.next(),n_.complete()}}),c0.pipe(rb(n_),fb((I0=J(x.mark(function G_(e0){var P_,_v;return x.wrap(function(E_){for(;;)switch(E_.prev=E_.next){case 0:if(P_=e0.servers,_v=e0.unit,_s&&_l.unit!==_v?_r.reject(new da("upload unit is different, reject to continue",Dg)):_s&&(q.manager=ga,ga.chunkCount=_l.chunkCount,ga.chunks=_l.chunks,ga.totalFailures=_l.totalFailures,ga.uploadedChunks=_l.uploadedChunks,ga.timer=_l.timer,ga.initState=_l.initState,ga.unit=_l.unit,ga.uploadedSize=_l.uploadedSize,ga.singleThread=_l.singleThread,ga.updateProgress(0)),ga.addServers(P_),"uninitialized"!==ga.initState){E_.next=7;break}return _A=ga.initChunks(_v),E_.next=7,_A;case 7:case"end":return E_.stop()}},G_)})),function(G_){return I0.apply(this,arguments)}))).subscribe({complete:function(){return B_({hasExist:!1})},error:V_}),_0=function(I0){"uninitialized"!==ga.initState&&_A?B_(_A.then(function(){return{hasExist:!1}})):V_(I0)},Pv.pipe(rb(n_)).subscribe({error:_0}),h0.pipe(rb(n_)).subscribe({error:_0})}),x_.next=9,r_;case 9:if(!x_.sent.hasExist){x_.next=15;break}return ga.updateProgress(),this.log("file already exists, skipping upload"),x_.abrupt("return");case 15:n_.next(),n_.complete(),this.log("chunks initialization promise resolved"),I_=jb(ga.ee,"serverUsedUp").pipe(Av(function(){return ga.chunkCount!==ga.uploadedChunks.length}),Dv(5e3,void 0,{leading:!1}),sn(function(){return bh().ret})).subscribe(function(B_){ga.addServers(B_.servers)}),ga.ee.once("reconnected",function(){ga.ee.removeAllListeners(),v_.doUploadTask(q,_r,!0).catch(function(B_){_r.reject(B_)})}),ga.ee.once("multiTimeOut",function(){ga.ee.removeAllListeners(),v_.doUploadTask(q,_r,!0).catch(function(B_){_r.reject(B_)})}),ga.ee.once("timedOut",function(){I_.unsubscribe(),ga.ee.removeAllListeners(),ga.abortController.abort(),_r.reject(new gb("upload timed out",ji))}),ga.ee.once("error",function(B_){I_.unsubscribe(),ga.ee.removeAllListeners(),ga.abortController.abort(),_r.reject(B_||new da("upload error",Dg))}),void 0!==ga.transHandler.cancelSignal&&ga.transHandler.cancelSignal.addEventListener("abort",function(){_r.reject(new Ol("Uploading canceled",ls))},{once:!0}),ga.ee.once("finished",J(x.mark(function B_(){var V_,_0,c0;return x.wrap(function(Pv){for(;;)switch(Pv.prev=Pv.next){case 0:return I_.unsubscribe(),Pv.next=3,q.setter(ga.unit,ga.getUploadServerIPs());case 3:_0=(V_=Pv.sent).zone,c0=V_.unit,ga.ee.removeAllListeners(),_r.resolve({type:"UPLOAD",retUnit:c0,zone:_0});case 8:case"end":return Pv.stop()}},B_)}))),ga.uploadToServers();case 26:case"end":return x_.stop()}},k,this)}));return function(k,q){return f.apply(this,arguments)}}()},{key:"doUploadTask",value:function(f,k){var q=this,_r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],_s=f.taskId;return _r||(this.mediaTasks.delete(_s),this.ongoingTask=f),new Promise(function(ga,_l){q.doUploadTaskImpl(f,k,_r).then(ga).catch(_l)})}},{key:"processMediaTask",value:function(){var f=J(x.mark(function k(){var q,_r,_s;return x.wrap(function(ga){for(;;)switch(ga.prev=ga.next){case 0:if(0!==this.mediaTasks.size){ga.next=2;break}throw Error("no upload tasks");case 2:if(this.isProcessing=!0,q=this.mediaTasks.keys().next().value,void 0!==(_r=this.taskFinishers[q])){ga.next=7;break}throw Error("top task not found");case 7:if(void 0!==(_s=this.mediaTasks.get(q))){ga.next=10;break}throw new Ma("task invalid");case 10:if("UPLOAD"!==_s.type){ga.next=15;break}return ga.next=13,this.doUploadTask(_s,_r).catch(function(_l){_s.manager.ee.removeAllListeners(),_r.reject(_l)});case 13:ga.next=18;break;case 15:if("DOWNLOAD"!==_s.type){ga.next=18;break}return ga.next=18,this.doDownloadTask(_s,_r).catch(function(_l){_s.manager.ee.removeAllListeners(),_r.reject(_l)});case 18:case"end":return ga.stop()}},k,this)}));return function(){return f.apply(this,arguments)}}()},{key:"cancelTask",value:function(f){var k="DOWNLOAD"===f.type?ms:ls;f.manager.ee.removeAllListeners(),f.manager.abortController.abort(),void 0!==this.taskFinishers[f.taskId]&&this.taskFinishers[f.taskId].reject(new Ol("User logged out or kicked off, media task canceled",k))}}]),l}(wb());m(kt,"MAX_PENDING_TASK_COUNT",9),Up("of",function(){for(var h=0,l=arguments.length,g=new(cf(this))(l);l>h;)g[h]=arguments[h++];return g},nk);var lt=1/0,$E=Math.max,ew=function(h,l,g){var f=Object(h);if(!Nd(h)){var k=jf(l);h=Jd(h),l=function(q){return k(f[q],q,f)}}return-1<(l=function(q,_r,_s){var ga=null==q?0:q.length;if(!ga)return-1;if(null==_s)_s=0;else{var _l=(_s=_s?(_s=Nl(_s))===lt||_s===-lt?17976931348623157e292*(0>_s?-1:1):_s==_s?_s:0:0===_s?_s:0)%1;_s=_s==_s?_l?_s-_l:_s:0}return 0>_s&&(_s=$E(ga+_s,0)),ar(q,jf(_r),_s)}(h,l,g))?f[k?h[l]:l]:void 0},dw=function(h,l){return h&&h.length?bl(h,void 0,"function"==typeof l?l:void 0):[]},mt=function(){function h(){X(this,h),m(this,"size",0),m(this,"fields",new Map)}return Ia(h,[{key:"define",value:function(l,g,f){if(this.size+=f,64<this.size)throw new RangeError("the struct over 64 bits is not supported");jh(g={val:0,isNumber:"number"===g,isBoolean:"boolean"===g,oneof:"number"===g||"boolean"===g?void 0:g,len:f}),this.fields.set(l,g)}},{key:"set",value:function(l,g){if(!(l=this.fields.get(l)))throw Error("field not found");var f=l.oneof;if(!U.isLong(g)&&"number"!=typeof g)if("boolean"==typeof g)g=g?1:0;else{if(void 0===f)throw Error("invalid field type");if(void 0===(g=f[g]))throw Error("field type not found")}jh(l,g),l.val=g}},{key:"toNumber",value:function(){for(var l=0,g=0,f=0,k=Array.from(this.fields);f<k.length;f++){var q=ua(k[f],2)[1],_r=q.len;void 0!==(q=q.val)&&(l+=U.fromValue(q).shiftLeft(g).toNumber(),g+=_r)}return l}},{key:"toLong",value:function(){for(var l=U.fromNumber(0,!0),g=0,f=0,k=Array.from(this.fields);f<k.length;f++){var q=ua(k[f],2)[1],_r=q.len;void 0!==(q=q.val)&&(l=U.fromValue(q).shiftLeft(g).add(l),g+=_r)}return l}},{key:"assert",value:function(l,g){function f(_r){if(!U.isLong(_r)&&"number"!=typeof _r)if("boolean"==typeof _r)_r=_r?1:0;else{if(void 0===q)throw Error("invalid field type");if(void 0===(_r=q[_r]))throw Error("field type not found")}return jh(k,_r),ih(_r,k.val)}var k=this.fields.get(l);if(!k)throw Error("field not found");var q=k.oneof;if(!Array.isArray(g))return f(g);if(1===g.length)return f(g[0]);if(g.every(function(_r){return"string"==typeof _r})&&void 0!==q)return g.some(function(_r){return f(_r)});throw Error("invalid valueTypes")}},{key:"from",value:function(l){l=U.fromValue(l);for(var g=0,f=0,k=Array.from(this.fields);f<k.length;f++){var q=ua(k[f],2)[1],_r=q.len,_s=U.fromNumber(Math.pow(2,_r)-1,!0).shiftLeft(g);jh(q,_s=l.and(_s).shiftRightUnsigned(g)),q.val=_s,g+=_r}}},{key:"typeOf",value:function(l){if(void 0!==(l=this.fields.get(l))){var g=l.oneof;if(l=l.val,void 0!==g){var f=0;for(g=Object.entries(g);f<g.length;f++){var k=ua(g[f],2),q=k[0];if(ih(l,k[1]))return q}}}throw new TypeError("can only get type of oneof type")}}]),h}(),nt=function(h){function l(f){X(this,l);var k=g.call(this);return k.define("Rejoin","boolean",1),k.define("Unused","number",31),k.define("Platform","number",8),k.define("Version","number",12),k.define("Subversion","number",12),k.set("Platform",7),k.set("Version",4),k.set("Subversion",15),k.set("Rejoin",f),k}ja(l,h);var g=ka(l);return l}(mt),aF=wa(wa(wa(wa({},{PeerTextMessage:0,ChannelTextMessage:1,VendorTextMessage:2}),{PeerRawMessage:3,ChannelRawMessage:4,VendorRawMessage:5}),{PeerImageMessage:6,ChannelImageMessage:7,VendorImageMessage:8}),{PeerFileMessage:15,ChannelFileMessage:16,VendorFileMessage:17}),ot={CallInvite:101,CallAccept:102,CallReject:103,CallCancel:104},bF=wa(wa({},aF),ot),cF={Uncompressed:0,Zlib:1},ke=function(h){function l(f){X(this,l);var k=g.call(this);if(k.define("MessageType",bF,8),k.define("BroadcastJumps","number",2),k.define("ToCache","boolean",1),k.define("FromCache","boolean",1),k.define("CompressionMethod",cF,2),k.define("IterationNumber","number",4),k.define("BufferedMessage","boolean",1),k.define("ToArchive","boolean",1),k.define("FromArchive","boolean",1),"number"==typeof f||U.isLong(f))k.from(f);else if(void 0!==f){var q=0;for(f=eh(f);q<f.length;q++){var _r=ua(f[q],2);k.set(_r[0],_r[1])}}return k}ja(l,h);var g=ka(l);return Ia(l,[{key:"isTextMessage",value:function(){return this.assert("MessageType",["PeerTextMessage","ChannelTextMessage","VendorTextMessage"])}},{key:"isRawMessage",value:function(){return this.assert("MessageType",["ChannelRawMessage","PeerRawMessage","VendorRawMessage"])}},{key:"isRawPeerMessage",value:function(){return this.assert("MessageType","PeerRawMessage")}},{key:"isRawChannelMessage",value:function(){return this.assert("MessageType","ChannelRawMessage")}},{key:"isPeerTextMessage",value:function(){return this.assert("MessageType","PeerTextMessage")}},{key:"isChannelTextMessage",value:function(){return this.assert("MessageType","ChannelTextMessage")}},{key:"isInvitation",value:function(f){var k=this;return void 0!==f?this.assert("MessageType",f):Pf(ot).some(function(q){return k.assert("MessageType",q)})}},{key:"isFileMessage",value:function(){return this.assert("MessageType",["PeerFileMessage","ChannelFileMessage","VendorFileMessage"])}},{key:"isImageMessage",value:function(){return this.assert("MessageType",["PeerImageMessage","ChannelImageMessage","VendorImageMessage"])}},{key:"isPeerMessage",value:function(){return this.assert("MessageType",["PeerFileMessage","PeerTextMessage","PeerImageMessage","PeerRawMessage"])}},{key:"isZlibCompressed",value:function(){return this.assert("CompressionMethod","Zlib")}},{key:"isFromCache",value:function(){return this.assert("FromCache",!0)}},{key:"isBufferedMessage",value:function(){return this.assert("BufferedMessage",!0)}},{key:"getInvitationType",value:function(){if(!this.isInvitation())throw new TypeError("cannot get InvitationType of a normal message type");return this.typeOf("MessageType")}}]),l}(mt),dF=function(h){function l(f){return X(this,l),m(n(f=g.call(this,f,"ChatManager")),"dialogueLru",new Nz(void 0,{maxlen:1e4,ttl:1e4})),f}ja(l,h);var g=ka(l);return Ia(l,[{key:"getChatInfo",value:function(f){var k=this.dialogueLru.get(f);if(this.dialogueLru.prune(),k){var q=k.dialogue,_r={dialogue:q,sequence:k=k.sequence.add(1)};return this.dialogueLru.set(f,{dialogue:q,sequence:k}),_r}return q={dialogue:Yg(),sequence:U.fromNumber(1,!0)},this.dialogueLru.set(f,q),q}}]),l}(wb()),v={};"object"==V(module)&&(module.exports=v),v.parse=function(h,l){var g,f=v.bin.readUshort,k=v.bin.readUint,q={};for(g=(h=new Uint8Array(h)).length-4;101010256!=k(h,g);)g--;var _r=f(h,g=g+4+4);f(h,g+=2),k(h,g+=2),g=k(h,g+=4);for(var _s=0;_s<_r;_s++){k(h,g),g+=4,g+=4,g+=4,k(h,g+=4);var ga=k(h,g+=4),_l=k(h,g+=4),bh=f(h,g+=4),n_=f(h,g+2),_A=f(h,g+4);g+=6;var r_=k(h,g+=8);g+=4,g+=bh+n_+_A,v._readLocal(h,r_,q,ga,_l,l)}return q},v._readLocal=function(h,l,g,f,k,q){var _r=v.bin.readUshort,_s=v.bin.readUint;_s(h,l),_r(h,l+=4),_r(h,l+=2);var ga=_r(h,l+=2);_s(h,l+=2),_s(h,l+=4),_s=_r(h,l=l+4+8);var _l=_r(h,l+=2);if(_r=v.bin.readUTF8(h,l+=2,_s),l=l+_s+_l,q)g[_r]={size:k,csize:f};else if(h=new Uint8Array(h.buffer,l),0==ga)g[_r]=new Uint8Array(h.buffer.slice(l,l+f));else{if(8!=ga)throw"unknown compression method: "+ga;l=new Uint8Array(k),v.inflateRaw(h,l),g[_r]=l}},v.inflateRaw=function(h,l){return v.F.inflate(h,l)},v.inflate=function(h,l){return v.inflateRaw(new Uint8Array(h.buffer,h.byteOffset+2,h.length-2),l)},v.deflate=function(h,l){null==l&&(l={level:6});var g=0,f=new Uint8Array(50+Math.floor(1.1*h.length));return f[g]=120,f[g+1]=156,g=v.F.deflateRaw(h,f,g+2,l.level),h=v.adler(h,0,h.length),f[g+0]=h>>>24&255,f[g+1]=h>>>16&255,f[g+2]=h>>>8&255,f[g+3]=h>>>0&255,new Uint8Array(f.buffer,0,g+4)},v.deflateRaw=function(h,l){null==l&&(l={level:6});var g=new Uint8Array(50+Math.floor(1.1*h.length)),f=v.F.deflateRaw(h,g,f,l.level);return new Uint8Array(g.buffer,0,f)},v.encode=function(h,l){null==l&&(l=!1);var g,f=0,k=v.bin.writeUint,q=v.bin.writeUshort,_r={};for(g in h){var _s=!v._noNeed(g)&&!l,ga=h[g],_l=v.crc.crc(ga,0,ga.length);_r[g]={cpr:_s,usize:ga.length,crc:_l,file:_s?v.deflateRaw(ga):ga}}for(g in _r)f+=_r[g].file.length+30+46+2*v.bin.sizeUTF8(g);for(g in h=new Uint8Array(f+22),l=0,ga=[],_r)_l=_r[g],ga.push(l),l=v._writeHeader(h,l,g,_l,0);for(g in f=0,_s=l,_r)_l=_r[g],ga.push(l),l=v._writeHeader(h,l,g,_l,1,ga[f++]);return _r=l-_s,k(h,l,101010256),q(h,l=l+4+4,f),q(h,l+=2,f),k(h,l+=2,_r),k(h,l+4,_s),h.buffer},v._noNeed=function(h){return h=h.split(".").pop().toLowerCase(),-1!="png,jpg,jpeg,zip".indexOf(h)},v._writeHeader=function(h,l,g,f,k,q){var _r=v.bin.writeUint,_s=v.bin.writeUshort,ga=f.file;return _r(h,l,0==k?67324752:33639248),l+=4,1==k&&(l+=2),_s(h,l,20),_s(h,l+=2,0),_s(h,l+=2,f.cpr?8:0),_r(h,l+=2,0),_r(h,l+=4,f.crc),_r(h,l+=4,ga.length),_r(h,l+=4,f.usize),_s(h,l+=4,v.bin.sizeUTF8(g)),_s(h,l+=2,0),l+=2,1==k&&(_r(h,l=l+2+2+6,q),l+=4),l+=g=v.bin.writeUTF8(h,l,g),0==k&&(h.set(ga,l),l+=ga.length),l},v.crc={table:function(){for(var h=new Uint32Array(256),l=0;256>l;l++){for(var g=l,f=0;8>f;f++)g=1&g?3988292384^g>>>1:g>>>1;h[l]=g}return h}(),update:function(h,l,g,f){for(var k=0;k<f;k++)h=v.crc.table[255&(h^l[g+k])]^h>>>8;return h},crc:function(h,l,g){return 4294967295^v.crc.update(4294967295,h,l,g)}},v.adler=function(h,l,g){var f=1,k=0,q=l;for(l+=g;q<l;){for(g=Math.min(q+5552,l);q<g;)k+=f+=h[q++];f%=65521,k%=65521}return k<<16|f},v.bin={readUshort:function(h,l){return h[l]|h[l+1]<<8},writeUshort:function(h,l,g){h[l]=255&g,h[l+1]=g>>8&255},readUint:function(h,l){return 16777216*h[l+3]+(h[l+2]<<16|h[l+1]<<8|h[l])},writeUint:function(h,l,g){h[l]=255&g,h[l+1]=g>>8&255,h[l+2]=g>>16&255,h[l+3]=g>>24&255},readASCII:function(h,l,g){for(var f="",k=0;k<g;k++)f+=String.fromCharCode(h[l+k]);return f},writeASCII:function(h,l,g){for(var f=0;f<g.length;f++)h[l+f]=g.charCodeAt(f)},pad:function(h){return 2>h.length?"0"+h:h},readUTF8:function(h,l,g){for(var f,k="",q=0;q<g;q++)k+="%"+v.bin.pad(h[l+q].toString(16));try{f=decodeURIComponent(k)}catch(_r){return v.bin.readASCII(h,l,g)}return f},writeUTF8:function(h,l,g){for(var f=g.length,k=0,q=0;q<f;q++){var _r=g.charCodeAt(q);if(0==(4294967168&_r))h[l+k]=_r,k++;else if(0==(4294965248&_r))h[l+k]=192|_r>>6,h[l+k+1]=128|_r>>0&63,k+=2;else if(0==(4294901760&_r))h[l+k]=224|_r>>12,h[l+k+1]=128|_r>>6&63,h[l+k+2]=128|_r>>0&63,k+=3;else{if(0!=(4292870144&_r))throw"e";h[l+k]=240|_r>>18,h[l+k+1]=128|_r>>12&63,h[l+k+2]=128|_r>>6&63,h[l+k+3]=128|_r>>0&63,k+=4}}return k},sizeUTF8:function(h){for(var l=h.length,g=0,f=0;f<l;f++){var k=h.charCodeAt(f);if(0==(4294967168&k))g++;else if(0==(4294965248&k))g+=2;else if(0==(4294901760&k))g+=3;else{if(0!=(4292870144&k))throw"e";g+=4}}return g}},v.F={},v.F.deflateRaw=function(h,l,g,f){var k=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][f],q=v.F.U,_r=v.F._goodIndex,_s=v.F._putsE,ga=0;g<<=3;var _l=0,bh=h.length;if(0==f){for(;ga<bh;){var n_=Math.min(65535,bh-ga);_s(l,g,ga+n_==bh?1:0),g=v.F._copyExact(h,ga,n_,l,g+8),ga+=n_}return g>>>3}_s=q.lits,f=q.strt;var _A=q.prev,r_=0,p_=0,I_=0,v_=0,S_=0;for(2<bh&&(f[S_=v.F._hash(h,0)]=0),ga=0;ga<bh;ga++){if(n_=S_,ga+1<bh-2){S_=v.F._hash(h,ga+1);var x_=ga+1&32767;_A[x_]=f[S_],f[S_]=x_}if(_l<=ga){if((14e3<r_||26697<p_)&&100<bh-ga&&(_l<ga&&(_s[r_]=ga-_l,r_+=2,_l=ga),g=v.F._writeBlock(ga==bh-1||_l==bh?1:0,_s,r_,v_,h,I_,ga-I_,l,g),r_=p_=v_=0,I_=ga),x_=0,ga<bh-2&&(x_=v.F._bestMatch(h,ga,_A,n_,Math.min(k[2],bh-ga),k[3])),0!=x_){n_=x_>>>16,x_&=65535;var B_=_r(n_,q.of0);q.lhst[257+B_]++;var V_=_r(x_,q.df0);q.dhst[V_]++,v_+=q.exb[B_]+q.dxb[V_],_s[r_]=n_<<23|ga-_l,_s[r_+1]=x_<<16|B_<<8|V_,r_+=2,_l=ga+n_}else q.lhst[h[ga]]++;p_++}}for(I_==ga&&0!=h.length||(_l<ga&&(_s[r_]=ga-_l,r_+=2),g=v.F._writeBlock(1,_s,r_,v_,h,I_,ga-I_,l,g));0!=(7&g);)g++;return g>>>3},v.F._bestMatch=function(h,l,g,f,k,q){var _r=32767&l,_s=g[_r],ga=_r-_s+32768&32767;if(_s==_r||f!=v.F._hash(h,l-ga))return 0;for(var _l=f=0,bh=Math.min(32767,l);ga<=bh&&0!=--q&&_s!=_r;){if((0==f||h[l+f]==h[l+f-ga])&&(_r=v.F._howLong(h,l,ga))>f){if(_l=ga,(f=_r)>=k)break;ga+2<_r&&(_r=ga+2);for(var n_=0,_A=0;_A<_r-2;_A++){var r_=l-ga+_A+32768&32767,p_=r_-g[r_]+32768&32767;p_>n_&&(n_=p_,_s=r_)}}ga+=(_r=_s)-(_s=g[_r])+32768&32767}return f<<16|_l},v.F._howLong=function(h,l,g){if(h[l]!=h[l-g]||h[l+1]!=h[l+1-g]||h[l+2]!=h[l+2-g])return 0;var f=l,k=Math.min(h.length,l+258);for(l+=3;l<k&&h[l]==h[l-g];)l++;return l-f},v.F._hash=function(h,l){return(h[l]<<8|h[l+1])+(h[l+2]<<4)&65535},v.saved=0,v.F._writeBlock=function(h,l,g,f,k,q,_r,_s,ga){var _l=v.F.U,bh=v.F._putsF,n_=v.F._putsE;_l.lhst[256]++;var _A=v.F.getTrees(),r_=_A[0],p_=_A[1],I_=_A[2],v_=_A[3],S_=_A[4],x_=_A[5],B_=_A[6];_A=_A[7];var V_=32+(0==(ga+3&7)?0:8-(ga+3&7))+(_r<<3),_0=f+v.F.contSize(_l.fltree,_l.lhst)+v.F.contSize(_l.fdtree,_l.dhst);f=f+v.F.contSize(_l.ltree,_l.lhst)+v.F.contSize(_l.dtree,_l.dhst),f+=14+3*x_+v.F.contSize(_l.itree,_l.ihst)+(2*_l.ihst[16]+3*_l.ihst[17]+7*_l.ihst[18]);for(var c0=0;286>c0;c0++)_l.lhst[c0]=0;for(c0=0;30>c0;c0++)_l.dhst[c0]=0;for(c0=0;19>c0;c0++)_l.ihst[c0]=0;if(V_=V_<_0&&V_<f?0:_0<f?1:2,bh(_s,ga,h),bh(_s,ga+1,V_),ga+=3,0==V_){for(;0!=(7&ga);)ga++;ga=v.F._copyExact(k,q,_r,_s,ga)}else{if(1==V_)var Pv=_l.fltree,h0=_l.fdtree;if(2==V_){for(v.F.makeCodes(_l.ltree,r_),v.F.revCodes(_l.ltree,r_),v.F.makeCodes(_l.dtree,p_),v.F.revCodes(_l.dtree,p_),v.F.makeCodes(_l.itree,I_),v.F.revCodes(_l.itree,I_),Pv=_l.ltree,h0=_l.dtree,n_(_s,ga,v_-257),n_(_s,ga+=5,S_-1),n_(_s,ga+=5,x_-4),ga+=4,h=0;h<x_;h++)n_(_s,ga+3*h,_l.itree[1+(_l.ordr[h]<<1)]);ga=v.F._codeTiny(B_,_l.itree,_s,ga+3*x_),ga=v.F._codeTiny(_A,_l.itree,_s,ga)}for(x_=0;x_<g;x_+=2){for(B_=(h=l[x_])>>>23,h=q+(8388607&h);q<h;)ga=v.F._writeLit(k[q++],Pv,_s,ga);0!=B_&&(h=(r_=l[x_+1])>>16,_r=r_>>8&255,r_&=255,n_(_s,ga=v.F._writeLit(257+_r,Pv,_s,ga),B_-_l.of0[_r]),bh(_s,ga=v.F._writeLit(r_,h0,_s,ga+=_l.exb[_r]),h-_l.df0[r_]),ga+=_l.dxb[r_],q+=B_)}ga=v.F._writeLit(256,Pv,_s,ga)}return ga},v.F._copyExact=function(h,l,g,f,k){var q=k>>>3;return f[q]=g,f[q+1]=g>>>8,f[q+2]=255-f[q],f[q+3]=255-f[q+1],q+=4,f.set(new Uint8Array(h.buffer,l,g),q),k+(g+4<<3)},v.F.getTrees=function(){for(var h=v.F.U,l=v.F._hufTree(h.lhst,h.ltree,15),g=v.F._hufTree(h.dhst,h.dtree,15),f=[],k=v.F._lenCodes(h.ltree,f),q=[],_r=v.F._lenCodes(h.dtree,q),_s=0;_s<f.length;_s+=2)h.ihst[f[_s]]++;for(_s=0;_s<q.length;_s+=2)h.ihst[q[_s]]++;_s=v.F._hufTree(h.ihst,h.itree,7);for(var ga=19;4<ga&&0==h.itree[1+(h.ordr[ga-1]<<1)];)ga--;return[l,g,_s,k,_r,ga,f,q]},v.F.getSecond=function(h){for(var l=[],g=0;g<h.length;g+=2)l.push(h[g+1]);return l},v.F.nonZero=function(h){for(var l="",g=0;g<h.length;g+=2)0!=h[g+1]&&(l+=(g>>1)+",");return l},v.F.contSize=function(h,l){for(var g=0,f=0;f<l.length;f++)g+=l[f]*h[1+(f<<1)];return g},v.F._codeTiny=function(h,l,g,f){for(var k=0;k<h.length;k+=2){var q=h[k],_r=h[k+1];f=v.F._writeLit(q,l,g,f);var _s=16==q?2:17==q?3:7;15<q&&(v.F._putsE(g,f,_r,_s),f+=_s)}return f},v.F._lenCodes=function(h,l){for(var g=h.length;2!=g&&0==h[g-1];)g-=2;for(var f=0;f<g;f+=2){var k=h[f+1],q=f+3<g?h[f+3]:-1,_r=f+5<g?h[f+5]:-1,_s=0==f?-1:h[f-1];if(0==k&&q==k&&_r==k){for(q=f+5;q+2<g&&h[q+2]==k;)q+=2;11>(k=Math.min(q+1-f>>>1,138))?l.push(17,k-3):l.push(18,k-11),f+=2*k-2}else if(k==_s&&q==k&&_r==k){for(q=f+5;q+2<g&&h[q+2]==k;)q+=2;k=Math.min(q+1-f>>>1,6),l.push(16,k-3),f+=2*k-2}else l.push(k,0)}return g>>>1},v.F._hufTree=function(h,l,g){var f=[],k=h.length,q=l.length,_r=0;for(_r=0;_r<q;_r+=2)l[_r]=0,l[_r+1]=0;for(_r=0;_r<k;_r++)0!=h[_r]&&f.push({lit:_r,f:h[_r]});if(h=f.length,k=f.slice(0),0==h)return 0;if(1==h)return l[1+((g=f[0].lit)<<1)]=1,l[1+((0==g?1:0)<<1)]=1;f.sort(function(bh,n_){return bh.f-n_.f});var _s=0,ga=1,_l=2;for(f[0]={lit:-1,f:(_r=f[0]).f+(q=f[1]).f,l:_r,r:q,d:0};ga!=h-1;)_r=_s!=ga&&(_l==h||f[_s].f<f[_l].f)?f[_s++]:f[_l++],q=_s!=ga&&(_l==h||f[_s].f<f[_l].f)?f[_s++]:f[_l++],f[ga++]={lit:-1,f:_r.f+q.f,l:_r,r:q};for((f=v.F.setDepth(f[ga-1],0))>g&&(v.F.restrictDepth(k,g,f),f=g),_r=0;_r<h;_r++)l[1+(k[_r].lit<<1)]=k[_r].d;return f},v.F.setDepth=function(h,l){return-1!=h.lit?h.d=l:Math.max(v.F.setDepth(h.l,l+1),v.F.setDepth(h.r,l+1))},v.F.restrictDepth=function(h,l,g){var f=0,k=1<<g-l,q=0;for(h.sort(function(_s,ga){return ga.d==_s.d?_s.f-ga.f:ga.d-_s.d}),f=0;f<h.length&&h[f].d>l;f++){var _r=h[f].d;h[f].d=l,q+=k-(1<<g-_r)}for(q>>>=g-l;0<q;)(_r=h[f].d)<l?(h[f].d++,q-=1<<l-_r-1):f++;for(;0<=f;f--)h[f].d==l&&0>q&&(h[f].d--,q++);0!=q&&console.log("debt left")},v.F._goodIndex=function(h,l){var g=0;return l[16|g]<=h&&(g|=16),l[8|g]<=h&&(g|=8),l[4|g]<=h&&(g|=4),l[2|g]<=h&&(g|=2),l[1|g]<=h&&(g|=1),g},v.F._writeLit=function(h,l,g,f){return v.F._putsF(g,f,l[h<<1]),f+l[1+(h<<1)]},v.F.inflate=function(h,l){var g=Uint8Array;if(3==h[0]&&0==h[1])return l||new g(0);var f=v.F,k=f._bitsF,q=f._bitsE,_r=f._decodeTiny,_s=f.makeCodes,ga=f.codes2map,_l=f._get17,bh=f.U,n_=null==l;n_&&(l=new g(h.length>>>2<<3));for(var _A,r_,p_,I_,v_=0,S_=0,x_=r_=0,B_=0;0==v_;)if(v_=k(h,B_,1),_A=k(h,B_+1,2),B_+=3,0==_A)0!=(7&B_)&&(B_+=8-(7&B_)),_A=h[(B_=4+(B_>>>3))-4]|h[B_-3]<<8,n_&&(l=v.F._check(l,x_+_A)),l.set(new g(h.buffer,h.byteOffset+B_,_A),x_),B_=B_+_A<<3,x_+=_A;else{if(n_&&(l=v.F._check(l,x_+131072)),1==_A&&(p_=bh.flmap,I_=bh.fdmap,S_=511,r_=31),2==_A){for(r_=q(h,B_,5)+257,_A=q(h,B_+5,5)+1,p_=q(h,B_+10,4)+4,B_+=14,I_=0;38>I_;I_+=2)bh.itree[I_]=0,bh.itree[I_+1]=0;for(S_=1,I_=0;I_<p_;I_++){var V_=q(h,B_+3*I_,3);bh.itree[1+(bh.ordr[I_]<<1)]=V_,V_>S_&&(S_=V_)}B_+=3*p_,_s(bh.itree,S_),ga(bh.itree,S_,bh.imap),p_=bh.lmap,I_=bh.dmap,B_=_r(bh.imap,(1<<S_)-1,r_+_A,h,B_,bh.ttree),S_=(1<<(V_=f._copyOut(bh.ttree,0,r_,bh.ltree)))-1,r_=(1<<(_A=f._copyOut(bh.ttree,r_,_A,bh.dtree)))-1,_s(bh.ltree,V_),ga(bh.ltree,V_,p_),_s(bh.dtree,_A),ga(bh.dtree,_A,I_)}for(;;)if(B_+=15&(_A=p_[_l(h,B_)&S_]),(V_=_A>>>4)>>>8==0)l[x_++]=V_;else{if(256==V_)break;_A=x_+V_-254,264<V_&&(_A=x_+((V_=bh.ldef[V_-257])>>>3)+q(h,B_,7&V_),B_+=7&V_),B_+=15&(V_=I_[_l(h,B_)&r_]);var _0=((V_=bh.ddef[V_>>>4])>>>4)+k(h,B_,15&V_);for(B_+=15&V_,n_&&(l=v.F._check(l,x_+131072));x_<_A;)l[x_]=l[x_++-_0],l[x_]=l[x_++-_0],l[x_]=l[x_++-_0],l[x_]=l[x_++-_0];x_=_A}}return l.length==x_?l:l.slice(0,x_)},v.F._check=function(h,l){var g=h.length;return l<=g?h:((l=new Uint8Array(Math.max(g<<1,l))).set(h,0),l)},v.F._decodeTiny=function(h,l,g,f,k,q){for(var _r=v.F._bitsE,_s=v.F._get17,ga=0;ga<g;){var _l=h[_s(f,k)&l];k+=15&_l;var bh=_l>>>4;if(15>=bh)q[ga]=bh,ga++;else{var n_=_l=0;for(16==bh?(n_=3+_r(f,k,2),k+=2,_l=q[ga-1]):17==bh?(n_=3+_r(f,k,3),k+=3):18==bh&&(n_=11+_r(f,k,7),k+=7),bh=ga+n_;ga<bh;)q[ga]=_l,ga++}}return k},v.F._copyOut=function(h,l,g,f){for(var k=0,q=0,_r=f.length>>>1;q<g;){var _s=h[q+l];f[q<<1]=0,f[1+(q<<1)]=_s,_s>k&&(k=_s),q++}for(;q<_r;)f[q<<1]=0,f[1+(q<<1)]=0,q++;return k},v.F.makeCodes=function(h,l){var g,f,k=v.F.U,q=h.length,_r=k.bl_count;for(g=0;g<=l;g++)_r[g]=0;for(g=1;g<q;g+=2)_r[h[g]]++;for(k=k.next_code,g=0,_r[0]=0,f=1;f<=l;f++)k[f]=g=g+_r[f-1]<<1;for(l=0;l<q;l+=2)0!=(_r=h[l+1])&&(h[l]=k[_r],k[_r]++)},v.F.codes2map=function(h,l,g){for(var f=h.length,k=v.F.U.rev15,q=0;q<f;q+=2)if(0!=h[q+1]){var _r=h[q+1],_s=q>>1<<4|_r,ga=l-_r;for(ga=(_r=h[q]<<ga)+(1<<ga);_r!=ga;)g[k[_r]>>>15-l]=_s,_r++}},v.F.revCodes=function(h,l){for(var g=v.F.U.rev15,f=15-l,k=0;k<h.length;k+=2)h[k]=g[h[k]<<l-h[k+1]]>>>f},v.F._putsE=function(h,l,g){g<<=7&l,h[l>>>=3]|=g,h[l+1]|=g>>>8},v.F._putsF=function(h,l,g){g<<=7&l,h[l>>>=3]|=g,h[l+1]|=g>>>8,h[l+2]|=g>>>16},v.F._bitsE=function(h,l,g){return(h[l>>>3]|h[1+(l>>>3)]<<8)>>>(7&l)&(1<<g)-1},v.F._bitsF=function(h,l,g){return(h[l>>>3]|h[1+(l>>>3)]<<8|h[2+(l>>>3)]<<16)>>>(7&l)&(1<<g)-1},v.F._get17=function(h,l){return(h[l>>>3]|h[1+(l>>>3)]<<8|h[2+(l>>>3)]<<16)>>>(7&l)},v.F._get25=function(h,l){return(h[l>>>3]|h[1+(l>>>3)]<<8|h[2+(l>>>3)]<<16|h[3+(l>>>3)]<<24)>>>(7&l)},v.F.U=function(){var h=Uint16Array,l=Uint32Array;return{next_code:new h(16),bl_count:new h(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new h(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new l(32),flmap:new h(512),fltree:[],fdmap:new h(32),fdtree:[],lmap:new h(32768),ltree:[],ttree:[],dmap:new h(32768),dtree:[],imap:new h(512),itree:[],rev15:new h(32768),lhst:new l(286),dhst:new l(30),ihst:new l(19),lits:new l(15e3),strt:new h(65536),prev:new h(32768)}}(),function(){function h(k,q,_r){for(;0!=q--;)k.push(0,_r)}for(var l=v.F.U,g=0;32768>g;g++){var f=g;f=(4278255360&(f=(4042322160&(f=(3435973836&(f=(2863311530&f)>>>1|(1431655765&f)<<1))>>>2|(858993459&f)<<2))>>>4|(252645135&f)<<4))>>>8|(16711935&f)<<8,l.rev15[g]=(f>>>16|f<<16)>>>17}for(g=0;32>g;g++)l.ldef[g]=l.of0[g]<<3|l.exb[g],l.ddef[g]=l.df0[g]<<4|l.dxb[g];h(l.fltree,144,8),h(l.fltree,112,9),h(l.fltree,24,7),h(l.fltree,8,8),v.F.makeCodes(l.fltree,9),v.F.codes2map(l.fltree,9,l.flmap),v.F.revCodes(l.fltree,9),h(l.fdtree,32,5),v.F.makeCodes(l.fdtree,5),v.F.codes2map(l.fdtree,5,l.fdmap),v.F.revCodes(l.fdtree,5),h(l.itree,19,0),h(l.ltree,286,0),h(l.dtree,30,0),h(l.ttree,320,0)}();var eF=Array.isArray||function(h){return h&&"number"==typeof h.length},fF=Object.defineProperty({isArray:eF},"__esModule",{value:!0}),gF=Object.defineProperty({isObject:function(h){return null!==h&&"object"===V(h)}},"__esModule",{value:!0}),hF=Object.defineProperty({isFunction:function(h){return"function"==typeof h}},"__esModule",{value:!0}),iF=function(){function h(l){return Error.call(this),this.message=l?l.length+" errors occurred during unsubscription:\n"+l.map(function(g,f){return f+1+") "+g.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=l,this}return h.prototype=Object.create(Error.prototype),h}(),kh=Object.defineProperty({UnsubscriptionError:iF},"__esModule",{value:!0}),jF=function(){function h(l){this.closed=!1,this._subscriptions=this._parentOrParents=null,l&&(this._ctorUnsubscribe=!0,this._unsubscribe=l)}return h.prototype.unsubscribe=function(){if(!this.closed){var l=this._parentOrParents,g=this._ctorUnsubscribe,f=this._unsubscribe,k=this._subscriptions;if(this.closed=!0,this._subscriptions=this._parentOrParents=null,l instanceof h)l.remove(this);else if(null!==l)for(var q=0;q<l.length;++q)l[q].remove(this);if(hF.isFunction(f)){g&&(this._unsubscribe=void 0);try{f.call(this)}catch(_s){var _r=_s instanceof kh.UnsubscriptionError?go(_s.errors):[_s]}}if(fF.isArray(k))for(q=-1,l=k.length;++q<l;)if(gF.isObject(g=k[q]))try{g.unsubscribe()}catch(_s){_r=_r||[],_s instanceof kh.UnsubscriptionError?_r=_r.concat(go(_s.errors)):_r.push(_s)}if(_r)throw new kh.UnsubscriptionError(_r)}},h.prototype.add=function(l){var g=l;if(!l)return h.EMPTY;switch(V(l)){case"function":g=new h(l);case"object":if(g===this||g.closed||"function"!=typeof g.unsubscribe)return g;if(this.closed)return g.unsubscribe(),g;g instanceof h||(l=g,(g=new h)._subscriptions=[l]);break;default:throw Error("unrecognized teardown "+l+" added to Subscription.")}if(null===(l=g._parentOrParents))g._parentOrParents=this;else if(l instanceof h){if(l===this)return g;g._parentOrParents=[l,this]}else{if(-1!==l.indexOf(this))return g;l.push(this)}return null===(l=this._subscriptions)?this._subscriptions=[g]:l.push(g),g},h.prototype.remove=function(l){var g=this._subscriptions;g&&-1!==(l=g.indexOf(l))&&g.splice(l,1)},h.EMPTY=function(l){return l.closed=!0,l}(new h),h}(),kF=Object.defineProperty({Subscription:jF},"__esModule",{value:!0}),lF=Ka&&Ka.__extends||function(){var h=function(l,g){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,k){f.__proto__=k}||function(f,k){for(var q in k)k.hasOwnProperty(q)&&(f[q]=k[q])})(l,g)};return function(l,g){function f(){this.constructor=l}h(l,g),l.prototype=null===g?Object.create(g):(f.prototype=g.prototype,new f)}}(),mF=function(h){function l(g,f){return h.call(this)||this}return lF(l,h),l.prototype.schedule=function(g,f){return this},l}(kF.Subscription),nF=Object.defineProperty({Action:mF},"__esModule",{value:!0}),oF=Ka&&Ka.__extends||function(){var h=function(l,g){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,k){f.__proto__=k}||function(f,k){for(var q in k)k.hasOwnProperty(q)&&(f[q]=k[q])})(l,g)};return function(l,g){function f(){this.constructor=l}h(l,g),l.prototype=null===g?Object.create(g):(f.prototype=g.prototype,new f)}}(),pt=function(h){function l(g,f){var k=h.call(this,g,f)||this;return k.scheduler=g,k.work=f,k.pending=!1,k}return oF(l,h),l.prototype.schedule=function(g,f){if(void 0===f&&(f=0),this.closed)return this;this.state=g;var k=this.scheduler;return null!=(g=this.id)&&(this.id=this.recycleAsyncId(k,g,f)),this.pending=!0,this.delay=f,this.id=this.id||this.requestAsyncId(k,this.id,f),this},l.prototype.requestAsyncId=function(g,f,k){return void 0===k&&(k=0),setInterval(g.flush.bind(g,this),k)},l.prototype.recycleAsyncId=function(g,f,k){if(void 0===k&&(k=0),null!==k&&this.delay===k&&!1===this.pending)return f;clearInterval(f)},l.prototype.execute=function(g,f){return this.closed?Error("executing a cancelled action"):(this.pending=!1,(g=this._execute(g,f))?g:void(!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))))},l.prototype._execute=function(g,f){f=!1;var k=void 0;try{this.work(g)}catch(q){f=!0,k=!!q&&q||Error(q)}if(f)return this.unsubscribe(),k},l.prototype._unsubscribe=function(){var g=this.id,f=this.scheduler,k=f.actions,q=k.indexOf(this);this.state=this.work=null,this.pending=!1,this.scheduler=null,-1!==q&&k.splice(q,1),null!=g&&(this.id=this.recycleAsyncId(f,g,null)),this.delay=null},l}(nF.Action);Object.defineProperty({AsyncAction:pt},"__esModule",{value:!0});var pF=function(){function h(l,g){void 0===g&&(g=h.now),this.SchedulerAction=l,this.now=g}return h.prototype.schedule=function(l,g,f){return void 0===g&&(g=0),new this.SchedulerAction(this,l).schedule(f,g)},h.now=function(){return Date.now()},h}(),qt=Object.defineProperty({Scheduler:pF},"__esModule",{value:!0}),qF=Ka&&Ka.__extends||function(){var h=function(l,g){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,k){f.__proto__=k}||function(f,k){for(var q in k)k.hasOwnProperty(q)&&(f[q]=k[q])})(l,g)};return function(l,g){function f(){this.constructor=l}h(l,g),l.prototype=null===g?Object.create(g):(f.prototype=g.prototype,new f)}}(),rt=function(h){function l(g,f){void 0===f&&(f=qt.Scheduler.now);var k=h.call(this,g,function(){return l.delegate&&l.delegate!==k?l.delegate.now():f()})||this;return k.actions=[],k.active=!1,k.scheduled=void 0,k}return qF(l,h),l.prototype.schedule=function(g,f,k){return void 0===f&&(f=0),l.delegate&&l.delegate!==this?l.delegate.schedule(g,f,k):h.prototype.schedule.call(this,g,f,k)},l.prototype.flush=function(g){var f=this.actions;if(this.active)f.push(g);else{var k;this.active=!0;do{if(k=g.execute(g.state,g.delay))break}while(g=f.shift());if(this.active=!1,k){for(;g=f.shift();)g.unsubscribe();throw k}}},l}(qt.Scheduler);Object.defineProperty({AsyncScheduler:rt},"__esModule",{value:!0});var rF=qa("iterator"),Tl=!R(function(){var h=new URL("b?a=1&b=2&c=3","http://a"),l=h.searchParams,g="";return h.pathname="c%20d",l.forEach(function(f,k){l.delete("b"),g+=k+f}),!l.sort||"http://a/c%20d?a=1&c=3"!==h.href||"3"!==l.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!l[rF]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://\u0442\u0435\u0441\u0442").host||"#%D0%B1"!==new URL("http://a#\u0431").hash||"a1c3"!==g||"x"!==new URL("http://x",void 0).host}),sF=/[^\0-\u007E]/,tF=/[.\u3002\uFF0E\uFF61]/g,sf=Math.floor,Ul=String.fromCharCode,st=function(h){return h+22+75*(26>h)},uF=function(h){for(var l=[],g=[],f=0,k=h.length;f<k;){var q=h.charCodeAt(f++);if(55296<=q&&56319>=q&&f<k){var _r=h.charCodeAt(f++);56320==(64512&_r)?g.push(((1023&q)<<10)+(1023&_r)+65536):(g.push(q),f--)}else g.push(q)}g=(h=g).length,f=128;var _s=0,ga=72;for(k=0;k<h.length;k++){var _l=h[k];128>_l&&l.push(Ul(_l))}for((_r=q=l.length)&&l.push("-");_r<g;){var bh=2147483647;for(k=0;k<h.length;k++)(_l=h[k])>=f&&_l<bh&&(bh=_l);var n_=_r+1;if(bh-f>sf((2147483647-_s)/n_))throw RangeError("Overflow: input needs wider integers to process");for(_s+=(bh-f)*n_,f=bh,k=0;k<h.length;k++){if((_l=h[k])<f&&2147483647<++_s)throw RangeError("Overflow: input needs wider integers to process");if(_l==f){var _A=_s;for(_l=36;!(_A<(bh=_l<=ga?1:_l>=ga+26?26:_l-ga));_l+=36){var r_=36-bh;l.push(Ul(st(bh+(_A-=bh)%r_))),_A=sf(_A/r_)}for(l.push(Ul(st(_A))),ga=n_,_l=0,_s=_r==q?sf(_s/700):_s>>1,_s+=sf(_s/ga);455<_s;_l+=36)_s=sf(_s/35);ga=sf(_l+36*_s/(_s+38)),_s=0,++_r}}++_s,++f}return l.join("")},tt=function(h){var l=Zf(h);if("function"!=typeof l)throw TypeError(String(h)+" is not iterable");return sa(l.call(h))},ut=Rb("fetch"),Vl=Rb("Headers"),vF=qa("iterator"),vt=La.set,Hb=La.getterFor("URLSearchParams"),wF=La.getterFor("URLSearchParamsIterator"),xF=/\+/g,wt=Array(4),yF=function(h){return wt[h-1]||(wt[h-1]=RegExp("((?:%[\\da-f]{2}){"+h+"})","gi"))},zF=function(h){try{return decodeURIComponent(h)}catch(l){return h}},xt=function(h){h=h.replace(xF," ");var l=4;try{return decodeURIComponent(h)}catch(g){for(;l;)h=h.replace(yF(l--),zF);return h}},yt=/[!'()~]|%20/g,AF={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},zt=function(h){return AF[h]},At=function(h,l){if(l){l=l.split("&");for(var g,f=0;f<l.length;)(g=l[f++]).length&&(g=g.split("="),h.push({key:xt(g.shift()),value:xt(g.join("="))}))}},BF=function(h){this.entries.length=0,At(this.entries,h)},tf=function(h,l){if(h<l)throw TypeError("Not enough arguments")},Wl=Zo(function(h,l){vt(this,{type:"URLSearchParamsIterator",iterator:tt(Hb(h).entries),kind:l})},"Iterator",function(){var h=wF(this),l=h.kind,g=(h=h.iterator.next()).value;return h.done||(h.value="keys"===l?g.key:"values"===l?g.value:[g.key,g.value]),h}),Fg=function(){hc(this,Fg,"URLSearchParams");var h,l,g,f=0<arguments.length?arguments[0]:void 0,k=[];if(vt(this,{type:"URLSearchParams",entries:k,updateURL:function(){},updateSearchParams:BF}),void 0!==f)if(ha(f)){var q=Zf(f);if("function"==typeof q)for(f=q.call(f),q=f.next;!(h=q.call(f)).done;){var _r=(h=tt(sa(h.value))).next;if((l=_r.call(h)).done||(g=_r.call(h)).done||!_r.call(h).done)throw TypeError("Expected sequence with length 2");k.push({key:l.value+"",value:g.value+""})}else for(h in f)Q(f,h)&&k.push({key:h,value:f[h]+""})}else At(k,"string"==typeof f?"?"===f.charAt(0)?f.slice(1):f:f+"")},pi=Fg.prototype;Xe(pi,{append:function(h,l){tf(arguments.length,2);var g=Hb(this);g.entries.push({key:h+"",value:l+""}),g.updateURL()},delete:function(h){tf(arguments.length,1);for(var l=Hb(this),g=l.entries,f=h+"",k=0;k<g.length;)g[k].key===f?g.splice(k,1):k++;l.updateURL()},get:function(h){tf(arguments.length,1);for(var l=Hb(this).entries,g=h+"",f=0;f<l.length;f++)if(l[f].key===g)return l[f].value;return null},getAll:function(h){tf(arguments.length,1);for(var l=Hb(this).entries,g=h+"",f=[],k=0;k<l.length;k++)l[k].key===g&&f.push(l[k].value);return f},has:function(h){tf(arguments.length,1);for(var l=Hb(this).entries,g=h+"",f=0;f<l.length;)if(l[f++].key===g)return!0;return!1},set:function(h,l){tf(arguments.length,1);for(var g,f=Hb(this),k=f.entries,q=!1,_r=h+"",_s=l+"",ga=0;ga<k.length;ga++)(g=k[ga]).key===_r&&(q?k.splice(ga--,1):(q=!0,g.value=_s));q||k.push({key:_r,value:_s}),f.updateURL()},sort:function(){var h,l,g=Hb(this),f=g.entries,k=f.slice();for(l=f.length=0;l<k.length;l++){var q=k[l];for(h=0;h<l;h++)if(f[h].key>q.key){f.splice(h,0,q);break}h===l&&f.push(q)}g.updateURL()},forEach:function(h){for(var l,g=Hb(this).entries,f=pd(h,1<arguments.length?arguments[1]:void 0,3),k=0;k<g.length;)f((l=g[k++]).value,l.key,this)},keys:function(){return new Wl(this,"keys")},values:function(){return new Wl(this,"values")},entries:function(){return new Wl(this,"entries")}},{enumerable:!0}),Ea(pi,vF,pi.entries),Ea(pi,"toString",function(){for(var h,l=Hb(this).entries,g=[],f=0;f<l.length;)h=l[f++],g.push(encodeURIComponent(h.key).replace(yt,zt)+"="+encodeURIComponent(h.value).replace(yt,zt));return g.join("&")},{enumerable:!0}),gc(Fg,"URLSearchParams"),M({global:!0,forced:!Tl},{URLSearchParams:Fg}),Tl||"function"!=typeof ut||"function"!=typeof Vl||M({global:!0,enumerable:!0,forced:!0},{fetch:function(h){var l=[h];if(1<arguments.length){var g=arguments[1];if(ha(g)){var f=g.body;if("URLSearchParams"===We(f)){var k=g.headers?new Vl(g.headers):new Vl;k.has("content-type")||k.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),g=Sb(g,{body:sc(0,String(f)),headers:sc(0,k)})}}l.push(g)}return ut.apply(this,l)}});var Gg=C.URL,CF=Fg,DF=La.set,Na=La.getterFor("URL"),EF=Math.floor,Bt=Math.pow,Ct=/[A-Za-z]/,FF=/[\d+-.A-Za-z]/,Xl=/\d/,GF=/^(0x|0X)/,HF=/^[0-7]+$/,IF=/^\d+$/,Dt=/^[\dA-Fa-f]+$/,JF=/[\0\t\n\r #%/:?@[\\]]/,KF=/[\0\t\n\r #/:?@[\\]]/,LF=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,MF=/[\t\n\r]/g,Yl=function(h,l){var g;if("["==l.charAt(0)){if("]"!=l.charAt(l.length-1))return"Invalid host";var f=NF(l.slice(1,-1));if(!f)return"Invalid host"}else if(bb(h)){for(f=[],l=l.toLowerCase().replace(tF,".").split("."),g=0;g<l.length;g++){var k=l[g];f.push(sF.test(k)?"xn--"+uF(k):k)}if(l=f.join("."),JF.test(l)||null===(f=OF(l)))return"Invalid host"}else{if(KF.test(l))return"Invalid host";for(f="",l=Td(l),g=0;g<l.length;g++)f+=Cd(l[g],qi)}h.host=f},OF=function(h){var l,g=h.split(".");g.length&&""==g[g.length-1]&&g.pop();var f=g.length;if(4<f)return h;var k=[];for(l=0;l<f;l++){var q=g[l];if(""==q)return h;var _r=10;if(1<q.length&&"0"==q.charAt(0)&&(_r=GF.test(q)?16:8,q=q.slice(8==_r?1:2)),""===q)q=0;else{if(!(10==_r?IF:8==_r?HF:Dt).test(q))return h;q=parseInt(q,_r)}k.push(q)}for(l=0;l<f;l++)if(q=k[l],l==f-1){if(q>=Bt(256,5-f))return null}else if(255<q)return null;for(h=k.pop(),l=0;l<k.length;l++)h+=k[l]*Bt(256,3-l);return h},NF=function(h){var l,g,f=[0,0,0,0,0,0,0,0],k=0,q=null,_r=0,_s=function(){return h.charAt(_r)};if(":"==_s()){if(":"!=h.charAt(1))return;_r+=2,q=++k}for(;_s();){if(8==k)return;if(":"==_s()){if(null!==q)return;_r++,q=++k}else{for(l=g=0;4>g&&Dt.test(_s());)l=16*l+parseInt(_s(),16),_r++,g++;if("."==_s()){if(0==g||(_r-=g,6<k))return;for(l=0;_s();){if(g=null,0<l){if(!("."==_s()&&4>l))return;_r++}if(!Xl.test(_s()))return;for(;Xl.test(_s());){var ga=parseInt(_s(),10);if(null===g)g=ga;else{if(0==g)return;g=10*g+ga}if(255<g)return;_r++}f[k]=256*f[k]+g,2!=++l&&4!=l||k++}if(4!=l)return;break}if(":"==_s()){if(_r++,!_s())return}else if(_s())return;f[k++]=l}}if(null!==q)for(_s=k-q,k=7;0!=k&&0<_s;)l=f[k],f[k--]=f[q+_s-1],f[q+--_s]=l;else if(8!=k)return;return f},Hg=function(h){var l,g;if("number"==typeof h){var f=[];for(l=0;4>l;l++)f.unshift(h%256),h=EF(h/256);return f.join(".")}if("object"==typeof h){f="",l=null;for(var k=1,q=null,_r=0,_s=0;8>_s;_s++)0!==h[_s]?(_r>k&&(l=q,k=_r),q=null,_r=0):(null===q&&(q=_s),++_r);for(_r>k&&(l=q),k=l,l=0;8>l;l++)g&&0===h[l]||(g&&(g=!1),k===l?(f+=l?":":"::",g=!0):(f+=h[l].toString(16),7>l&&(f+=":")));return"["+f+"]"}return h},qi={},Et=ng({},qi,{" ":1,'"':1,"<":1,">":1,"`":1}),Ft=ng({},Et,{"#":1,"?":1,"{":1,"}":1}),Zl=ng({},Ft,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Cd=function(h,l){var g=Kw(h,0);return 32<g&&127>g&&!Q(l,h)?h:encodeURIComponent(h)},ri={ftp:21,file:null,http:80,https:443,ws:80,wss:443},bb=function(h){return Q(ri,h.scheme)},$l=function(h){return!h.host||h.cannotBeABaseURL||"file"==h.scheme},Ig=function(h,l){var g;return 2==h.length&&Ct.test(h.charAt(0))&&(":"==(g=h.charAt(1))||!l&&"|"==g)},Gt=function(h){var l;return 1<h.length&&Ig(h.slice(0,2))&&(2==h.length||"/"===(l=h.charAt(2))||"\\"===l||"?"===l||"#"===l)},Ht=function(h){var l=h.path,g=l.length;!g||"file"==h.scheme&&1==g&&Ig(l[0],!0)||l.pop()},am={},It={},bm={},Jt={},Kt={},cm={},Lt={},Mt={},si={},ti={},dm={},em={},fm={},gm={},Nt={},hm={},Jg={},Hc={},Ot={},le={},dd={},Ic=function(h,l,g,f){var k=g||am,q=0,_r="",_s=!1,ga=!1,_l=!1;for(g||(h.scheme="",h.username="",h.password="",h.host=null,h.port=null,h.path=[],h.query=null,h.fragment=null,h.cannotBeABaseURL=!1,l=l.replace(LF,"")),l=l.replace(MF,""),l=Td(l);q<=l.length;){var bh=l[q];switch(k){case am:if(!bh||!Ct.test(bh)){if(g)return"Invalid scheme";k=bm;continue}_r+=bh.toLowerCase(),k=It;break;case It:if(bh&&(FF.test(bh)||"+"==bh||"-"==bh||"."==bh))_r+=bh.toLowerCase();else{if(":"!=bh){if(g)return"Invalid scheme";_r="",k=bm,q=0;continue}if(g&&(bb(h)!=Q(ri,_r)||"file"==_r&&(""!=h.username||""!=h.password||null!==h.port)||"file"==h.scheme&&!h.host))return;if(h.scheme=_r,g)return void(bb(h)&&ri[h.scheme]==h.port&&(h.port=null));_r="","file"==h.scheme?k=gm:bb(h)&&f&&f.scheme==h.scheme?k=Jt:bb(h)?k=Mt:"/"==l[q+1]?(k=Kt,q++):(h.cannotBeABaseURL=!0,h.path.push(""),k=Ot)}break;case bm:if(!f||f.cannotBeABaseURL&&"#"!=bh)return"Invalid scheme";if(f.cannotBeABaseURL&&"#"==bh){h.scheme=f.scheme,h.path=f.path.slice(),h.query=f.query,h.fragment="",h.cannotBeABaseURL=!0,k=dd;break}k="file"==f.scheme?gm:cm;continue;case Jt:if("/"!=bh||"/"!=l[q+1]){k=cm;continue}k=si,q++;break;case Kt:if("/"==bh){k=ti;break}k=Hc;continue;case cm:if(h.scheme=f.scheme,null==bh)h.username=f.username,h.password=f.password,h.host=f.host,h.port=f.port,h.path=f.path.slice(),h.query=f.query;else if("/"==bh||"\\"==bh&&bb(h))k=Lt;else if("?"==bh)h.username=f.username,h.password=f.password,h.host=f.host,h.port=f.port,h.path=f.path.slice(),h.query="",k=le;else{if("#"!=bh){h.username=f.username,h.password=f.password,h.host=f.host,h.port=f.port,h.path=f.path.slice(),h.path.pop(),k=Hc;continue}h.username=f.username,h.password=f.password,h.host=f.host,h.port=f.port,h.path=f.path.slice(),h.query=f.query,h.fragment="",k=dd}break;case Lt:if(!bb(h)||"/"!=bh&&"\\"!=bh){if("/"!=bh){h.username=f.username,h.password=f.password,h.host=f.host,h.port=f.port,k=Hc;continue}k=ti}else k=si;break;case Mt:if(k=si,"/"!=bh||"/"!=_r.charAt(q+1))continue;q++;break;case si:if("/"!=bh&&"\\"!=bh){k=ti;continue}break;case ti:if("@"==bh){for(_s&&(_r="%40"+_r),_s=!0,_r=Td(_r),bh=0;bh<_r.length;bh++){var n_=_r[bh];":"!=n_||_l?(n_=Cd(n_,Zl),_l?h.password+=n_:h.username+=n_):_l=!0}_r=""}else if(null==bh||"/"==bh||"?"==bh||"#"==bh||"\\"==bh&&bb(h)){if(_s&&""==_r)return"Invalid authority";q-=Td(_r).length+1,_r="",k=dm}else _r+=bh;break;case dm:case em:if(g&&"file"==h.scheme){k=hm;continue}if(":"!=bh||ga){if(null==bh||"/"==bh||"?"==bh||"#"==bh||"\\"==bh&&bb(h)){if(bb(h)&&""==_r)return"Invalid host";if(g&&""==_r&&(""!=h.username||""!=h.password||null!==h.port))return;if(k=Yl(h,_r))return k;if(_r="",k=Jg,g)return;continue}"["==bh?ga=!0:"]"==bh&&(ga=!1),_r+=bh}else{if(""==_r)return"Invalid host";if(k=Yl(h,_r))return k;if(_r="",k=fm,g==em)return}break;case fm:if(!Xl.test(bh)){if(null==bh||"/"==bh||"?"==bh||"#"==bh||"\\"==bh&&bb(h)||g){if(""!=_r){if(65535<(k=parseInt(_r,10)))return"Invalid port";h.port=bb(h)&&k===ri[h.scheme]?null:k,_r=""}if(g)return;k=Jg;continue}return"Invalid port"}_r+=bh;break;case gm:if(h.scheme="file","/"==bh||"\\"==bh)k=Nt;else{if(!f||"file"!=f.scheme){k=Hc;continue}if(null==bh)h.host=f.host,h.path=f.path.slice(),h.query=f.query;else if("?"==bh)h.host=f.host,h.path=f.path.slice(),h.query="",k=le;else{if("#"!=bh){Gt(l.slice(q).join(""))||(h.host=f.host,h.path=f.path.slice(),Ht(h)),k=Hc;continue}h.host=f.host,h.path=f.path.slice(),h.query=f.query,h.fragment="",k=dd}}break;case Nt:if("/"==bh||"\\"==bh){k=hm;break}f&&"file"==f.scheme&&!Gt(l.slice(q).join(""))&&(Ig(f.path[0],!0)?h.path.push(f.path[0]):h.host=f.host),k=Hc;continue;case hm:if(null==bh||"/"==bh||"\\"==bh||"?"==bh||"#"==bh){if(!g&&Ig(_r))k=Hc;else{if(""==_r){if(h.host="",g)return}else{if(k=Yl(h,_r))return k;if("localhost"==h.host&&(h.host=""),g)return;_r=""}k=Jg}continue}_r+=bh;break;case Jg:if(bb(h)){if(k=Hc,"/"!=bh&&"\\"!=bh)continue}else if(g||"?"!=bh)if(g||"#"!=bh){if(null!=bh&&(k=Hc,"/"!=bh))continue}else h.fragment="",k=dd;else h.query="",k=le;break;case Hc:if(null==bh||"/"==bh||"\\"==bh&&bb(h)||!g&&("?"==bh||"#"==bh)){if(".."===(n_=(n_=_r).toLowerCase())||"%2e."===n_||".%2e"===n_||"%2e%2e"===n_?(Ht(h),"/"==bh||"\\"==bh&&bb(h)||h.path.push("")):"."===_r||"%2e"===_r.toLowerCase()?"/"==bh||"\\"==bh&&bb(h)||h.path.push(""):("file"==h.scheme&&!h.path.length&&Ig(_r)&&(h.host&&(h.host=""),_r=_r.charAt(0)+":"),h.path.push(_r)),_r="","file"==h.scheme&&(null==bh||"?"==bh||"#"==bh))for(;1<h.path.length&&""===h.path[0];)h.path.shift();"?"==bh?(h.query="",k=le):"#"==bh&&(h.fragment="",k=dd)}else _r+=Cd(bh,Ft);break;case Ot:"?"==bh?(h.query="",k=le):"#"==bh?(h.fragment="",k=dd):null!=bh&&(h.path[0]+=Cd(bh,qi));break;case le:g||"#"!=bh?null!=bh&&("'"==bh&&bb(h)?h.query+="%27":h.query="#"==bh?h.query+"%23":h.query+Cd(bh,qi)):(h.fragment="",k=dd);break;case dd:null!=bh&&(h.fragment+=Cd(bh,Et))}q++}},Dd=function(h){var l=hc(this,Dd,"URL"),g=1<arguments.length?arguments[1]:void 0,f=String(h),k=DF(l,{type:"URL"});if(void 0!==g)if(g instanceof Dd)var q=Na(g);else if(g=Ic(q={},String(g)))throw TypeError(g);if(g=Ic(k,f,null,q))throw TypeError(g);var _r=k.searchParams=new CF;(f=Hb(_r)).updateSearchParams(k.query),f.updateURL=function(){k.query=String(_r)||null},fa||(l.href=ui.call(l),l.origin=Pt.call(l),l.protocol=Qt.call(l),l.username=Rt.call(l),l.password=St.call(l),l.host=Tt.call(l),l.hostname=Ut.call(l),l.port=Vt.call(l),l.pathname=Wt.call(l),l.search=Xt.call(l),l.searchParams=Yt.call(l),l.hash=Zt.call(l))},im=Dd.prototype,ui=function(){var h=Na(this),l=h.scheme,f=h.password,k=h.host,q=h.port,_r=h.path,_s=h.query,ga=h.fragment,_l=l+":";return null!==k?(_l+="//",""==h.username&&""==h.password||(_l+=h.username+(f?":"+f:"")+"@"),_l+=Hg(k),null!==q&&(_l+=":"+q)):"file"==l&&(_l+="//"),_l+=h.cannotBeABaseURL?_r[0]:_r.length?"/"+_r.join("/"):"",null!==_s&&(_l+="?"+_s),null!==ga&&(_l+="#"+ga),_l},Pt=function(){var h=Na(this),l=h.scheme,g=h.port;if("blob"==l)try{return new Dd(l.path[0]).origin}catch(f){return"null"}return"file"!=l&&bb(h)?l+"://"+Hg(h.host)+(null!==g?":"+g:""):"null"},Qt=function(){return Na(this).scheme+":"},Rt=function(){return Na(this).username},St=function(){return Na(this).password},Tt=function(){var h=Na(this),l=h.host;return h=h.port,null===l?"":null===h?Hg(l):Hg(l)+":"+h},Ut=function(){var h=Na(this).host;return null===h?"":Hg(h)},Vt=function(){var h=Na(this).port;return null===h?"":String(h)},Wt=function(){var h=Na(this),l=h.path;return h.cannotBeABaseURL?l[0]:l.length?"/"+l.join("/"):""},Xt=function(){var h=Na(this).query;return h?"?"+h:""},Yt=function(){return Na(this).searchParams},Zt=function(){var h=Na(this).fragment;return h?"#"+h:""},$b=function(h,l){return{get:h,set:l,configurable:!0,enumerable:!0}};if(fa&&Wo(im,{href:$b(ui,function(h){var l=Na(this);if(h=Ic(l,String(h)))throw TypeError(h);Hb(l.searchParams).updateSearchParams(l.query)}),origin:$b(Pt),protocol:$b(Qt,function(h){var l=Na(this);Ic(l,String(h)+":",am)}),username:$b(Rt,function(h){var l=Na(this);if(h=Td(String(h)),!$l(l)){l.username="";for(var g=0;g<h.length;g++)l.username+=Cd(h[g],Zl)}}),password:$b(St,function(h){var l=Na(this);if(h=Td(String(h)),!$l(l)){l.password="";for(var g=0;g<h.length;g++)l.password+=Cd(h[g],Zl)}}),host:$b(Tt,function(h){var l=Na(this);l.cannotBeABaseURL||Ic(l,String(h),dm)}),hostname:$b(Ut,function(h){var l=Na(this);l.cannotBeABaseURL||Ic(l,String(h),em)}),port:$b(Vt,function(h){var l=Na(this);$l(l)||(""==(h=String(h))?l.port=null:Ic(l,h,fm))}),pathname:$b(Wt,function(h){var l=Na(this);l.cannotBeABaseURL||(l.path=[],Ic(l,h+"",Jg))}),search:$b(Xt,function(h){var l=Na(this);""==(h=String(h))?l.query=null:("?"==h.charAt(0)&&(h=h.slice(1)),l.query="",Ic(l,h,le)),Hb(l.searchParams).updateSearchParams(l.query)}),searchParams:$b(Yt),hash:$b(Zt,function(h){var l=Na(this);""==(h=String(h))?l.fragment=null:("#"==h.charAt(0)&&(h=h.slice(1)),l.fragment="",Ic(l,h,dd))})}),Ea(im,"toJSON",function(){return ui.call(this)},{enumerable:!0}),Ea(im,"toString",function(){return ui.call(this)},{enumerable:!0}),Gg){var $t=Gg.createObjectURL,au=Gg.revokeObjectURL;$t&&Ea(Dd,"createObjectURL",function(h){return $t.apply(Gg,arguments)}),au&&Ea(Dd,"revokeObjectURL",function(h){return au.apply(Gg,arguments)})}gc(Dd,"URL"),M({global:!0,forced:!Tl,sham:!fa},{URL:Dd});var PF=new Blob(["var fakeIdToId = {};onmessage = function (event) {\tvar data = event.data,\t\tname = data.name,\t\tfakeId = data.fakeId,\t\ttime;\tif(data.hasOwnProperty('time')) {\t\ttime = data.time;\t}\tswitch (name) {\t\tcase 'setInterval':\t\t\tfakeIdToId[fakeId] = setInterval(function () {\t\t\t\tpostMessage({fakeId: fakeId});\t\t\t}, time);\t\t\tbreak;\t\tcase 'clearInterval':\t\t\tif (fakeIdToId.hasOwnProperty (fakeId)) {\t\t\t\tclearInterval(fakeIdToId[fakeId]);\t\t\t\tdelete fakeIdToId[fakeId];\t\t\t}\t\t\tbreak;\t}}"]),QF=window.URL.createObjectURL(PF),Me={},Rf=0,uj=new Worker(QF);uj.onmessage=function(h){if(Me.hasOwnProperty(h=h.data.fakeId)){var l=Me[h];h=l.callback,l=l.parameters,h.apply(window,l)}};var RF=function(h){function l(){return X(this,l),g.apply(this,arguments)}ja(l,h);var g=ka(l);return Ia(l,[{key:"requestAsyncId",value:function(f,k){var q=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return fw(f.flush.bind(f,this),q)}},{key:"recycleAsyncId",value:function(f,k){var q=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(null!==q&&this.delay===q&&!1===this.pending)return k;Me.hasOwnProperty(k)&&(delete Me[k],uj.postMessage({name:"clearInterval",fakeId:k}))}}]),l}(pt),SF=new rt(RF),TF=["backups","servers"],UF=["backups","servers"],VF=["group"],jm=v.inflate,bu=v.deflate,cu=function(h){function l(f,k,q,_r){X(this,l);var _s=g.call(this,_r,"Session");return m(n(_s),"chatManager",void 0),m(n(_s),"usedChannelIds",[]),m(n(_s),"msgDedupLru",new Ac(void 0,{maxlen:200})),m(n(_s),"startTime",Date.now()),m(n(_s),"seq",U.fromNumber(1,!0)),m(n(_s),"userJoinOptions",new nt(!1)),m(n(_s),"seqSentStatuses",[!1,!1]),m(n(_s),"dialogueSequenceLru",new Ac(void 0,{maxlen:1e4})),m(n(_s),"loggedOut",!1),m(n(_s),"messageSentTimes",[]),m(n(_s),"curLoginSockets",[void 0,void 0]),m(n(_s),"loginSocketSubs",[{channels:new Map,receivers:[]},{channels:new Map,receivers:[]}]),m(n(_s),"lastLoginSockets",[new Ee(1),new Ee(1)]),m(n(_s),"dialPendingMsgSubjectMap",new Map),m(n(_s),"context",void 0),m(n(_s),"connection",void 0),m(n(_s),"instanceId",void 0),m(n(_s),"lastPingTime",void 0),m(n(_s),"registerSocketsFailureListener",function(){_s.connection.once("socketsFailure",function(){_s.log("socketsFailure, creating a new connection"),hd(function(){return _s.connection.removeAllListeners(),_s.connection=new ct(_s.context,_s.logger,!0),_s.loginHandler(15e3,!0)}).pipe(Ce(function(ga){return ga.pipe(jd(ie.getParameter("RECONNECTING_AP_INTERVAL")))}),rb(_s.connection.apClient.apFinish$)).subscribe(function(){_s.log("new connection connected")})}),0===_s.connection.listenerCount("tokenExpired")&&_s.connection.on("tokenExpired",function(){_s.emit("tokenExpired")})}),_s.context=f,_s.connection=k,_s.instanceId=q,_s.chatManager=new dF(_r),_s.lastPingTime=[0,0],_s.setMaxListeners(512),_s.log("The instanceId is %s",_s.instanceId.toString()),_s}ja(l,h);var g=ka(l);return Ia(l,[{key:"fetchFileUploadIndexGet",value:function(f){var k=f.hash,q=f.size;if(0===(f=this.getLoginSockets()).length)throw new L("Client is not logged in");var _r=this.incGetSeq();return f.forEach(function(_s){_s.sendPacket("FileUploadIndexGet",{seq:_r,hash:k,size:q})}),{ret:Da.apply(void 0,G(f.map(function(_s){return _s.fromReceived("FileUploadIndexRet").pipe(aa(function(ga){return _r.eq(ga.seq)}))}))),fin:Da.apply(void 0,G(f.map(function(_s){return _s.fromReceived("FileUploadIndexFin").pipe(aa(function(ga){return _r.eq(ga.seq)}))}))),err:cc.apply(void 0,G(f.map(function(_s){return _s.fromReceived("FileUploadIndexErr").pipe(aa(function(ga){return _r.eq(ga.seq)}),ea(function(ga){throw new da(["The media message upload failure, code %d",ga.code],Dg)}))}))),timeout:l.genTimeoutError(ji)}}},{key:"requestFileUploadIndexSet",value:function(f){var k=f.hash,q=f.unit,_r=f.servers;if(0===(f=this.getLoginSockets()).length)throw new L("Client is not logged in");var _s=this.incGetSeq();return f.forEach(function(ga){ga.sendPacket("FileUploadIndexSet",{seq:_s,servers:_r,hash:k,unit:q})}),Da.apply(void 0,[l.genTimeoutError(ji)].concat(G(f.map(function(ga){return ga.fromReceived("FileUploadIndexErr").pipe(aa(function(_l){return _s.eq(_l.seq)}),ea(function(_l){throw new da(["FileUploadIndexSet failure, code %d",_l.code],Dg)}))})),G(f.map(function(ga){return ga.fromReceived("FileUploadIndexFin").pipe(aa(function(_l){return _s.eq(_l.seq)}))}))))}},{key:"requestFileDownloadIndexGet",value:function(f){var k=f.size,q=f.zone,_r=f.unit,_s=f.hash,ga=this.getLoginSockets();if(0===ga.length)throw new L("Client is not logged in");var _l=this.incGetSeq();return ga.forEach(function(bh){bh.sendPacket("FileDownloadIndexGet",{seq:_l,size:k,zone:q,unit:_r,hash:_s})}),f=Da.apply(void 0,G(ga.map(function(bh){return bh.fromReceived("FileDownloadIndexRet").pipe(aa(function(n_){return _l.eq(n_.seq)}))}))).pipe(ea(function(bh){var n_=bh.backups,_A=bh.servers;return bh=yf(bh,TF),wa({backupList:n_.map(function(r_){return[r_]}),serverList:_A.map(function(r_){return[r_]})},bh)}),jd(500)),ga=mn(ga.map(function(bh){return bh.fromReceived("FileDownloadIndexRet").pipe(aa(function(n_){return _l.eq(n_.seq)}))})),Da(f,ga.pipe(ea(function(bh){return bh.reduce(function(n_,_A){var r_=n_.backupList,p_=n_.serverList;n_=_A.backups;var I_=_A.servers;return _A=yf(_A,UF),wa({backupList:n_.map(function(v_,S_){return[v_].concat(G(void 0!==r_&&Array.isArray(r_[S_])?r_[S_]:[]))}),serverList:I_.map(function(v_,S_){return[v_].concat(G(void 0!==r_&&Array.isArray(p_[S_])?p_[S_]:[]))})},_A)},{})})),l.genTimeoutError(ji))}},{key:"loginHandler",value:function(){var f=this,k=0<arguments.length&&void 0!==arguments[0]?arguments[0]:12e3,q=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(this.loggedOut&&q)throw new L("Already logged out, request ignored");q&&this.registerSocketsFailureListener(),this.connection.initConnection();var _r=this.getSocketLoginObservables(this.connection.lastOpenSockets,this.seq),_s=Date.now();return _r.forEach(function(ga,_l){var bh=f.loginSocketSubs[_l].login;void 0!==bh&&bh.unsubscribe(),f.loginSocketSubs[_l].login=ga.pipe(ba(function(n_){var _A;f.curLoginSockets[_l]=n_;var r_=Date.now();hb("Link",{ackedServerIp:n_.address,destServerIp:n_.ip,ec:0,sc:0,elapse:ib(f.startTime),lts:U.fromNumber(r_),responseTime:r_-_s,sid:ab(f.instanceId),userId:f.context.uid},null!==(_A=f.context.config.enableCloudProxy)&&void 0!==_A&&_A),f.emit("userJoined",n_.env),q&&f.connection.apClient.apFinish$.next(void 0)})).subscribe(f.lastLoginSockets[_l])}),this.initKeepAliveSender(),this.initKeepAliveReconnector(),this.initLoginReceiver(),cc.apply(void 0,G(_r).concat([jb(this.connection,"connectionInitFailure").pipe(ba(function(ga){throw ta(ga)||Xa(ga)?ga:new da("Login failure",{code:cs,originalError:ga})}))])).pipe(Pa(1),kb(k),Ja(function(ga){return ga instanceof sb&&f.warn("Client login timeout"),ga&&ga.code===ii&&(f.connection.emit("tokenExpired"),f.connection.apClient.apFinish$.next(void 0)),f.clearSockets(0,q),Z(ga)}),ba(function(){q||f.registerSocketsFailureListener()}),Tg(function(){q||f.connection.apClient.apFinish$.next(void 0)}))}},{key:"logoutHandler",value:function(){var f=J(x.mark(function k(){var q,_r,_s,ga=this;return x.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:return this.loggedOut=!0,this.connection.apClient.apFinish$.next(void 0),q=this.getLoginSockets(),_r=q.map(function(bh){return bh.sendPacket("UserQuit",{}),ga.connection.waitClosing(bh)}),this.clearSockets(5e3),_s=q.map(function(bh){return bh.env}),[0,1].filter(function(bh){return!_s.includes(bh)}).forEach(function(bh){ga.connection.closeSocket(bh,0)}),_l.abrupt("return",cc.apply(void 0,G(_r)).toPromise());case 9:case"end":return _l.stop()}},k,this)}));return function(){return f.apply(this,arguments)}}()},{key:"requestChannelJoin",value:function(){var f=J(x.mark(function k(q){var _r,_s,ga,_l=this;return x.wrap(function(bh){for(;;)switch(bh.prev=bh.next){case 0:if(0!==this.getLoginSockets().length){bh.next=2;break}throw new L("Client is not logged in. Cannot join the channel",Zr);case 2:return _r=jb(this,"channelLeft").pipe(zb(function(n_){return q===n_}),Pa(1)),_s=this.incGetSeq(),(ga=this.lastLoginSockets.map(function(n_){return n_.pipe(Lc(function(_A,r_){0!==r_&&_l.incSeqIfNeeded(_A.env);var p_=0===r_?_s:_l.seq;return _A.sendPacket("GroupEnter",{account:q,seq:p_}),_A.fromReceived("GroupReply").pipe(aa(function(I_){return p_.eq(I_.seq)}),ba(function(I_){if(0!==(I_=I_.code))throw new da(["Channel join failure. The response code is %d",I_],Vr)}))}),rb(_r),De())})).forEach(function(n_,_A){var r_=function(){return _l.loginSocketSubs[_A].channels.delete(q)};_l.loginSocketSubs[_A].channels.set(q,n_.subscribe({error:r_,complete:r_}))}),bh.next=8,cc.apply(void 0,G(ga)).pipe(Pa(1),kb(1e4),Ja(function(n_){return n_ instanceof sb&&_l.warn("Channel join timeout"),Z(n_)})).toPromise();case 8:case"end":return bh.stop()}},k,this)}));return function(k){return f.apply(this,arguments)}}()},{key:"requestChannelLeave",value:function(f){this.getLoginSockets().forEach(function(k){k.sendPacket("GroupLeave",{account:f})})}},{key:"requestChannelMemberList",value:function(f){var k=this.getLoginSockets();if(0===k.length)throw new L("Client is not logged in. Cannot get the channel members",ZB);var q=this.incGetSeq();return k.forEach(function(_r){_r.sendPacket("GroupAllUsersList",{group:f,pageNumber:0,pageSize:200,seq:q})}),Da.apply(void 0,[l.genTimeoutError(Tr)].concat(G(k.map(function(_r){return _r.fromReceived("GroupAllUsersResult").pipe(aa(function(_s){return _s.group===f&&q.eq(_s.seq)}))}))))}},{key:"requestPeersOnlineStatus",value:function(f){var k=this.getLoginSockets();if(0===k.length)throw new L("Client is not logged in");var q=this.incGetSeq();return k.forEach(function(_r){_r.sendPacket("UserStatusList",{users:f,seq:q})}),Da.apply(void 0,[l.genTimeoutError(kC)].concat(G(k.map(function(_r){return _r.fromReceived("UserStatusResult").pipe(aa(function(_s){return q.eq(_s.seq)}))}))))}},{key:"requestSetLocalUserAttributes",value:function(f,k){var q=this,_r=this.getLoginSockets();if(0===_r.length)throw new L("Client is not logged in");var _s=this.incGetSeq();return _r.forEach(function(ga,_l){void 0!==k&&_l!==k||ga.sendPacket("UserAttributeSet",{account:q.context.uid,attributeInfos:Object.entries(f).map(function(bh){return{key:(bh=ua(bh,2))[0],value:bh[1]}}),seq:_s})}),Da.apply(void 0,G(_r.map(function(ga){return ga.fromReceived("UserAttributeErr").pipe(aa(function(_l){return _s.eq(_l.seq)}),ea(function(_l){throw new da(["The user attributes set failure, code %d",_l.code],Xb)}))})).concat([l.genTimeoutError(Yb)],G(_r.map(function(ga){return ga.fromReceived("UserAttributeRsp").pipe(aa(function(_l){return _s.eq(_l.seq)}))}))))}},{key:"requestSetChannelAttributes",value:function(f,k,q){var _r=this.getLoginSockets();if(0===_r.length)throw new L("Client is not logged in");var _s=this.incGetSeq();return _r.forEach(function(ga){ga.sendPacket("GroupAttributeSet",{broadcast:q,group:f,attributeInfos:Object.entries(k).map(function(_l){return{key:(_l=ua(_l,2))[0],value:_l[1]}}),seq:_s})}),Da.apply(void 0,G(_r.map(function(ga){return ga.fromReceived("GroupAttributeErr").pipe(aa(function(_l){return _s.eq(_l.seq)}),ea(function(_l){throw new da(["The group attributes set failure, code %d",_l.code],Xb)}))})).concat([l.genTimeoutError(Yb)],G(_r.map(function(ga){return ga.fromReceived("GroupAttributeRsp").pipe(aa(function(_l){return _s.eq(_l.seq)}))}))))}},{key:"requestAddOrUpdateLocalUserAttributes",value:function(f){var k=this,q=this.getLoginSockets();if(0===q.length)throw new L("Client is not logged in");var _r=this.incGetSeq();return q.forEach(function(_s){_s.sendPacket("UserAttributeMod",{account:k.context.uid,attributeInfos:Object.entries(f).map(function(ga){return{key:(ga=ua(ga,2))[0],value:ga[1]}}),seq:_r})}),Da.apply(void 0,G(q.map(function(_s){return _s.fromReceived("UserAttributeErr").pipe(aa(function(ga){return _r.eq(ga.seq)}),ea(function(ga){throw new da(["The user attributes add or update failure, code %d",ga.code],Xb)}))})).concat([l.genTimeoutError(Yb)],G(q.map(function(_s){return _s.fromReceived("UserAttributeRsp").pipe(aa(function(ga){return _r.eq(ga.seq)}))}))))}},{key:"requestAddOrUpdateChannelAttributes",value:function(f,k,q){var _r=this.getLoginSockets();if(0===_r.length)throw new L("Client is not logged in");var _s=this.incGetSeq();return _r.forEach(function(ga){ga.sendPacket("GroupAttributeMod",{broadcast:q,group:f,attributeInfos:Object.entries(k).map(function(_l){return{key:(_l=ua(_l,2))[0],value:_l[1]}}),seq:_s})}),Da.apply(void 0,G(_r.map(function(ga){return ga.fromReceived("GroupAttributeErr").pipe(aa(function(_l){return _s.eq(_l.seq)}),ea(function(_l){throw new da(["The group attributes add or update failure, code %d",_l.code],Xb)}))})).concat([l.genTimeoutError(Yb)],G(_r.map(function(ga){return ga.fromReceived("GroupAttributeRsp").pipe(aa(function(_l){return _s.eq(_l.seq)}))}))))}},{key:"requestDeleteLocalUserAttributesByKeys",value:function(f){var k=this,q=this.getLoginSockets();if(0===q.length)throw new L("Client is not logged in");var _r=this.incGetSeq();return q.forEach(function(_s){_s.sendPacket("UserAttributeDel",{account:k.context.uid,attributes:f,seq:_r})}),Da.apply(void 0,G(q.map(function(_s){return _s.fromReceived("UserAttributeErr").pipe(aa(function(ga){return _r.eq(ga.seq)}),ea(function(ga){throw new da(["The user attributes delete failure, code %d",ga.code],Xb)}))})).concat([l.genTimeoutError(Yb)],G(q.map(function(_s){return _s.fromReceived("UserAttributeRsp").pipe(aa(function(ga){return _r.eq(ga.seq)}))}))))}},{key:"requestDeleteChannelAttributesByKeys",value:function(f,k,q){var _r=this.getLoginSockets();if(0===_r.length)throw new L("Client is not logged in");var _s=this.incGetSeq();return _r.forEach(function(ga){ga.sendPacket("GroupAttributeDel",{group:f,broadcast:q,attributes:k,seq:_s})}),Da.apply(void 0,G(_r.map(function(ga){return ga.fromReceived("GroupAttributeErr").pipe(aa(function(_l){return _s.eq(_l.seq)}),ea(function(_l){throw new da(["The channel attributes delete failure, code %d",_l.code],Xb)}))})).concat([l.genTimeoutError(Yb)],G(_r.map(function(ga){return ga.fromReceived("GroupAttributeRsp").pipe(aa(function(_l){return _s.eq(_l.seq)}))}))))}},{key:"requestClearLocalUserAttributes",value:function(){var f=this,k=this.getLoginSockets();if(0===k.length)throw new L("Client is not logged in");var q=this.incGetSeq();return k.forEach(function(_r){_r.sendPacket("UserAttributeSet",{account:f.context.uid,seq:q,attributeInfos:[]})}),Da.apply(void 0,G(k.map(function(_r){return _r.fromReceived("UserAttributeErr").pipe(aa(function(_s){return q.eq(_s.seq)}),ea(function(_s){throw new da(["The user attributes clear failure, code %d",_s.code],Xb)}))})).concat([l.genTimeoutError(Yb)],G(k.map(function(_r){return _r.fromReceived("UserAttributeRsp").pipe(aa(function(_s){return q.eq(_s.seq)}))}))))}},{key:"requestClearChannelAttributes",value:function(f,k){var q=this.getLoginSockets();if(0===q.length)throw new L("Client is not logged in");var _r=this.incGetSeq();return q.forEach(function(_s){_s.sendPacket("GroupAttributeSet",{group:f,seq:_r,attributeInfos:[],broadcast:k})}),Da.apply(void 0,G(q.map(function(_s){return _s.fromReceived("GroupAttributeErr").pipe(aa(function(ga){return _r.eq(ga.seq)}),ea(function(ga){throw new da(["The channel attributes clear failure, code %d",ga.code],Xb)}))})).concat([l.genTimeoutError(Yb)],G(q.map(function(_s){return _s.fromReceived("GroupAttributeRsp").pipe(aa(function(ga){return _r.eq(ga.seq)}))}))))}},{key:"requestGetUserAttributesByKeys",value:function(f,k){var q=this.getLoginSockets();if(0===q.length)throw new L("Client is not logged in");var _r=this.incGetSeq();return q.forEach(function(_s){_s.sendPacket("UserAttributeGet",{account:f,seq:_r,attributes:k})}),Da.apply(void 0,[l.genTimeoutError(Yb)].concat(G(q.map(function(_s){return _s.fromReceived("UserAttributeErr").pipe(aa(function(ga){return _r.eq(ga.seq)}),ea(function(ga){throw 10008===(ga=ga.code)?new da("The user requested is not online",Pr):new bd(["User attribute operation unknown error code: %d",ga],Xb)}))})),G(q.map(function(_s){return _s.fromReceived("UserAttributeRet").pipe(aa(function(ga){return _r.eq(ga.seq)}))}))))}},{key:"requestGetChannelAttributesByKeys",value:function(f,k){var q=this.getLoginSockets();if(0===q.length)throw new L("Client is not logged in");var _r=this.incGetSeq();return q.forEach(function(_s){_s.sendPacket("GroupAttributeGet",{group:f,seq:_r,attributes:k})}),Da.apply(void 0,[l.genTimeoutError(Yb)].concat(G(q.map(function(_s){return _s.fromReceived("GroupAttributeErr").pipe(aa(function(ga){return _r.eq(ga.seq)}),ea(function(ga){throw new da(["The channel attributes get failure, code %d",ga.code],Xb)}))})),G(q.map(function(_s){return _s.fromReceived("GroupAttributeRet").pipe(aa(function(ga){return _r.eq(ga.seq)}))}))))}},{key:"requestGetUserAttributeKeys",value:function(f){var k=this.getLoginSockets();if(0===k.length)throw new L("Client is not logged in");var q=this.incGetSeq();return k.forEach(function(_r){_r.sendPacket("UserAttributeKeysGet",{account:f,seq:q})}),Da.apply(void 0,[l.genTimeoutError(Yb)].concat(G(k.map(function(_r){return _r.fromReceived("UserAttributeErr").pipe(aa(function(_s){return q.eq(_s.seq)}),ea(function(_s){throw 10008===(_s=_s.code)?new da("The user requested is not online",Pr):new bd(["User attribute operation unknown error code: %d",_s],Xb)}))})),G(k.map(function(_r){return _r.fromReceived("UserAttributeKeysRet").pipe(aa(function(_s){return q.eq(_s.seq)}))}))))}},{key:"requestGetChannelAttributesKeys",value:function(f){var k=this.getLoginSockets();if(0===k.length)throw new L("Client is not logged in");var q=this.incGetSeq();return k.forEach(function(_r){_r.sendPacket("GroupAttributeKeysGet",{group:f,seq:q})}),Da.apply(void 0,[l.genTimeoutError(Yb)].concat(G(k.map(function(_r){return _r.fromReceived("GroupAttributeErr").pipe(aa(function(_s){return q.eq(_s.seq)}),ea(function(_s){throw new bd(["Channel attribute operation unknown error code: %d",_s.code],Xb)}))})),G(k.map(function(_r){return _r.fromReceived("GroupAttributeKeysRet").pipe(aa(function(_s){return q.eq(_s.seq)}))}))))}},{key:"requestGetChannelMemberCount",value:function(f){var k=this.getLoginSockets();if(0===k.length)throw new L("Client is not logged in");var q=this.incGetSeq();return k.forEach(function(_r){_r.sendPacket("GroupStatusList",{groups:f,seq:q})}),Da.apply(void 0,[l.genTimeoutError(Tr)].concat(G(k.map(function(_r){return _r.fromReceived("GroupStatusResult").pipe(aa(function(_s){return q.eq(_s.seq)}))}))))}},{key:"requestSubscribePeersOnlineStatus",value:function(f){var k=this.getLoginSockets();if(0===k.length)throw new L("Client is not logged in");var q=this.incGetSeq();return k.forEach(function(_r){_r.sendPacket("SubscribeUserStatus",{seq:q,users:f})}),Da.apply(void 0,[l.genTimeoutError(rC)].concat(G(k.map(function(_r){return _r.fromReceived("SubscribeResponse").pipe(aa(function(_s){return q.eq(_s.seq)}))}))))}},{key:"requestUnsubscribePeersOnlineStatus",value:function(f){var k=this.getLoginSockets();if(0===k.length)throw new L("Client is not logged in");var q=this.incGetSeq();k.forEach(function(_r){_r.sendPacket("UnsubscribeUserStatus",{seq:q,users:f})})}},{key:"sendInvitationMessage",value:function(){var f=J(x.mark(function k(q){var _r,ga,_l,bh,n_,_A,r_,p_,I_,x_=this;return x.wrap(function(B_){for(;;)switch(B_.prev=B_.next){case 0:if(_r=q.peerId,ga=q.extra,bh=q.channelId,n_=q.type,_A={callId:q.callId},void 0===(_l=q.isAcceptAck)){B_.next=6;break}if("CallAccept"===n_){B_.next=5;break}throw Error("invalid invitation type");case 5:_A.type=_l?"ack":"request";case 6:return _A.channel=bh,("CallInvite"===n_||"CallCancel"===n_||"CallReject"===n_||"CallAccept"===n_&&!1===_l)&&void 0!==ga&&(_A.extra=ga),r_=Yg(),this.log("The sent invitation body is %o",_A),p_=function(V_){return{MiscMap:{},sequence:U.fromNumber(1),dialogue:r_,instance:x_.instanceId,dst:_r,ms:U.fromNumber(Date.now(),!0),options:new ke({IterationNumber:V_,MessageType:n_}).toLong(),payload:(new TextEncoder).encode(JSON.stringify(_A)),src:x_.context.uid}},B_.next=14,Ob(this.sendMessageToRetry(p_,!0)).pipe(kb(1e4),Ja(function(V_){return V_ instanceof sb&&x_.warn("Send invitation timeout"),Z(V_)})).toPromise();case 14:return B_.abrupt("return",{hasPeerReceived:0===(I_=B_.sent).code,hasReSent:0!==I_.retryTimes});case 18:case"end":return B_.stop()}},k,this)}));return function(k){return f.apply(this,arguments)}}()},{key:"sendMediaMessage",value:function(){var f=J(x.mark(function k(q,_r,_s,ga,_l,bh){var n_,_A,r_,p_,I_,v_,S_,x_,B_,V_,_0,c0,Pv,h0,I0,G_,e0,P_,_v,E_,L_,F_,J_,Y_,D0,O0,EI,Y0,x1=this;return x.wrap(function(_1){for(;;)switch(_1.prev=_1.next){case 0:if(r_=void 0===(_A=_r.width)?0:_A,I_=void 0===(p_=_r.height)?0:p_,S_=void 0===(v_=_r.fileName)?"":v_,B_=void 0===(x_=_r.description)?"":x_,_0=void 0===(V_=_r.thumbnail)?new Blob:V_,Pv=void 0===(c0=_r.thumbnailHeight)?0:c0,I0=void 0===(h0=_r.thumbnailWidth)?0:h0,e0=void 0===(G_=_r.size)?0:G_,P_=_r.mediaId,_v=_l.enableOfflineMessaging,E_=_l.enableHistoricalMessaging,Aa(_s)){_1.next=4;break}throw new H("The send message arguments are not valid",ga?Gl:Ag);case 4:if(!(32768<new Blob([S_,_0,B_]).size)){_1.next=6;break}throw new H("The size of message overflowed ",ga?Ie:fi);case 6:return L_=this.chatManager.getChatInfo(_s),F_=L_.dialogue,J_=L_.sequence,this.log('A%s media message is sending to %s: "'.concat(Y_=this.instanceId,"-").concat(F_,"#").concat(J_,'"'),ga?" peer":" channel",pa(_s)),m(n_={},"media_description",B_),m(n_,"media_width",r_),m(n_,"media_height",I_),m(n_,"media_thumbnailwidth",I0),m(n_,"media_thumbnailheight",Pv),m(n_,"media_size",e0),m(n_,"media_id",P_),m(n_,"media_filename",S_),D0=Bc(n_,function(UI){return(new TextEncoder).encode(UI.toString())}),_1.t0=Uint8Array,_1.next=14,pj(_0);case 14:return _1.t1=_1.sent,D0.media_thumbnail=new _1.t0(_1.t1),O0=ga&&"IMAGE"===q?"PeerImageMessage":ga&&"FILE"===q?"PeerFileMessage":ga||"IMAGE"!==q?"ChannelFileMessage":"ChannelImageMessage",EI=function(UI){return{MiscMap:D0,sequence:J_,dialogue:F_,instance:Y_,dst:_s,ms:U.fromNumber(Date.now(),!0),options:new ke({IterationNumber:UI,CompressionMethod:"Uncompressed",MessageType:O0,ToCache:_v,ToArchive:E_}).toLong(),payload:new Uint8Array,src:x1.context.uid}},_1.next=20,Ob(this.sendMessageToRetry(EI,!0)).pipe(kb(void 0===bh?1e4:bh),Ja(function(UI){return UI instanceof sb&&x1.warn("Send message timeout"),Z(UI)})).toPromise();case 20:if(2!==(Y0=_1.sent.code)){_1.next=24;break}throw new da("The peer does not support this type of message",jC);case 24:return _1.abrupt("return",{hasPeerReceived:0===Y0});case 25:case"end":return _1.stop()}},k,this)}));return function(k,q,_r,_s,ga,_l){return f.apply(this,arguments)}}()},{key:"sendRawMessage",value:function(){var f=J(x.mark(function k(q,_r,_s,ga,_l,bh){var n_,_A,r_,p_,I_,v_,S_,x_,_0=this;return x.wrap(function(c0){for(;;)switch(c0.prev=c0.next){case 0:if(n_=_l.enableOfflineMessaging,_A=_l.enableHistoricalMessaging,Aa(_s)&&q instanceof Uint8Array&&"string"==typeof _r){c0.next=3;break}throw new H("The send message arguments are not valid",ga?Gl:Ag);case 3:if(!(32768<q.byteLength+new Blob([_r]).size)){c0.next=5;break}throw new lb("The message size is over the 32KB limit",ga?Ie:fi);case 5:return r_=!ie.getParameter("DISABLE_MESSAGE_COMPRESSION")&&128<=q.byteLength,p_=this.chatManager.getChatInfo(_s),I_=p_.dialogue,v_=p_.sequence,this.log('A%s %s raw message is sending to %s: "'.concat(S_=this.instanceId,"-").concat(I_,"#").concat(v_,'"'),r_?" compressed":"",ga?"peer":"channel",pa(_s)),x_=function(Pv){return{MiscMap:{description:(new TextEncoder).encode(_r)},sequence:v_,dialogue:I_,instance:S_,dst:_s,ms:U.fromNumber(Date.now(),!0),options:new ke({IterationNumber:Pv,CompressionMethod:r_?"Zlib":"Uncompressed",MessageType:ga?"PeerRawMessage":"ChannelRawMessage",ToCache:n_,ToArchive:_A}).toLong(),payload:r_?bu(q):q,src:_0.context.uid}},c0.next=12,Ob(this.sendMessageToRetry(x_,!0)).pipe(kb(void 0===bh?1e4:bh),Ja(function(Pv){return Pv instanceof sb&&_0.warn("Send message timeout"),Z(Pv)})).toPromise();case 12:return c0.abrupt("return",{hasPeerReceived:0===c0.sent.code});case 15:case"end":return c0.stop()}},k,this)}));return function(k,q,_r,_s,ga,_l){return f.apply(this,arguments)}}()},{key:"sendTextMessage",value:function(){var f=J(x.mark(function k(q,_r,_s,ga,_l){var bh,n_,_A,r_,p_,I_,v_,S_,x_,_0=this;return x.wrap(function(c0){for(;;)switch(c0.prev=c0.next){case 0:if(bh=ga.enableOfflineMessaging,n_=ga.enableHistoricalMessaging,Aa(_r)){c0.next=3;break}throw new H("The send message arguments are not valid",_s?Gl:Ag);case 3:if(!(32768<new Blob([q]).size)){c0.next=5;break}throw new lb("The message size is over the 32KB limit",_s?Ie:fi);case 5:return _A=!ie.getParameter("DISABLE_MESSAGE_COMPRESSION")&&128<=new Blob([q]).size,r_=this.chatManager.getChatInfo(_r),p_=r_.dialogue,I_=r_.sequence,this.log('A%s %s message is sending to %s: "'.concat(v_=this.instanceId,"-").concat(p_,"#").concat(I_,'"'),_A?" compressed":"",_s?"peer":"channel",pa(_r)),S_=(new TextEncoder).encode(q),x_=function(Pv){return{MiscMap:{},sequence:I_,dialogue:p_,instance:v_,dst:_r,ms:U.fromNumber(Date.now(),!0),options:new ke({IterationNumber:Pv,CompressionMethod:_A?"Zlib":"Uncompressed",MessageType:_s?"PeerTextMessage":"ChannelTextMessage",ToCache:bh,ToArchive:n_}).toLong(),payload:_A?bu(S_):S_,src:_0.context.uid}},c0.next=13,Ob(this.sendMessageToRetry(x_,!0)).pipe(kb(void 0===_l?1e4:_l),Ja(function(Pv){return Pv instanceof sb&&_0.warn("Send message timeout"),Z(Pv)})).toPromise();case 13:return c0.abrupt("return",{hasPeerReceived:0===c0.sent.code});case 16:case"end":return c0.stop()}},k,this)}));return function(k,q,_r,_s,ga){return f.apply(this,arguments)}}()},{key:"cleanLoginSubs",value:function(f,k){Object.entries(this.loginSocketSubs[f]).forEach(function(q){var _r=(q=ua(q,2))[1];"channels"===q[0]&&k||(Array.isArray(_r)||_r instanceof Map?_r.forEach(function(_s){return _s.unsubscribe()}):_r&&_r.unsubscribe())}),this.loginSocketSubs[f]={channels:k?this.loginSocketSubs[f].channels:new Map,receivers:[]}}},{key:"sendMessageToRetry",value:function(){var f=J(x.mark(function k(q,_r){var _s,ga,_l,bh,n_,_A,r_,I_,v_=this,S_=arguments;return x.wrap(function(x_){for(;;)switch(x_.prev=x_.next){case 0:if(_s=2<S_.length&&void 0!==S_[2]?S_[2]:0,this.log("Attempt to send the message ".concat(_r?" with retrying, %o":"without retrying"),{retryTimes:_s}),0!==(ga=this.getLoginSockets()).length){x_.next=5;break}throw Error("no logged-in sockets");case 5:return _l=q(_s),ga.forEach(function(B_){B_.sendPacket("Message",_l)}),bh=_l.dialogue,n_=_l.sequence,_A=_l.instance,r_=ga.map(function(B_){return B_.fromReceived("Ack").pipe(zb(function(V_){return bh.eq(V_.dialogue)&&n_.eq(V_.sequence)&&_A.eq(V_.instance)}))}),x_.prev=9,x_.next=12,cc.apply(void 0,G(r_)).pipe(kb(6e3),Ja(function(B_){return Xa(B_)&&v_.warn("Message send timeout, retry times %d",_s),Z(B_)}),Pa(1)).toPromise();case 12:return this.log("The message has been acked, %o",{code:I_=x_.sent.code}),x_.abrupt("return",{code:I_,retryTimes:_s});case 18:if(x_.prev=18,x_.t0=x_.catch(9),!(x_.t0 instanceof sb&&_r)){x_.next=22;break}return x_.abrupt("return",this.sendMessageToRetry(q,!1,_s+1));case 22:throw x_.t0;case 23:case"end":return x_.stop()}},k,this,[[9,18]])}));return function(k,q){return f.apply(this,arguments)}}()},{key:"initKeepAliveSender",value:function(){var f=this;this.lastLoginSockets.map(function(k){return k.pipe(Lc(function(q){return Kc(0,2500,pe()?void 0:SF).pipe(ba(function(){f.sendPing(q)}))}))}).forEach(function(k,q){var _r=f.loginSocketSubs[q].keepAlive;void 0!==_r&&_r.unsubscribe(),f.loginSocketSubs[q].keepAlive=k.subscribe({error:function(){}})})}},{key:"initKeepAliveReconnector",value:function(){var f=this;this.lastLoginSockets.map(function(k){return k.pipe(Lc(function(q){var _r,_s=!1,ga=q.userJoin$.pipe(ba(function(){_s=!0})),_l=q.input$.pipe(ba(function(bh){"Ping"!==rj[bh.uri].slice(0,-3)&&(_s=!1)}));return cc(Kc(6e3,1e4).pipe(Jv(q.receivedPacket),ba(function(bh){bh=ua(bh,2),bh=ua(bh[1],2)[1],_r!==bh||_s||q.forceReconnect(),_r=bh})),ga,_l)}))}).forEach(function(k,q){var _r=f.loginSocketSubs[q].keepAliveReconnector;void 0!==_r&&_r.unsubscribe(),f.loginSocketSubs[q].keepAliveReconnector=k.subscribe({error:function(){}})})}},{key:"initLoginReceiver",value:function(){var f=this;this.lastLoginSockets.map(function(k){return k.pipe(Lc(function(q){return cc(jb(q,"reconnect").pipe(ba(f.onSocketReconnect(q))),q.fromReceived("Message").pipe(ba(f.onMessage(q))),q.fromReceived("GroupEnterNotice").pipe(ba(f.onGroupEnterNotice())),q.fromReceived("GroupLeaveNotice").pipe(ba(f.onGroupLeaveNotice())),q.fromReceived("GroupCountNotice").pipe(ba(f.onGroupCountNotice())),q.fromReceived("GroupAttributeAlt").pipe(ba(f.onGroupAttributeAlt())),q.fromReceived("UserJoinNotice").pipe(ba(f.onUserNotice(S.PeerOnlineState.ONLINE))),q.fromReceived("UserQuitNotice").pipe(ba(f.onUserNotice(S.PeerOnlineState.OFFLINE))),q.fromReceived("UserWaitNotice").pipe(ba(f.onUserNotice(S.PeerOnlineState.UNREACHABLE))),q.fromReceived("Pong").pipe(ba(f.onPong())),q.fromReceived("UserDrop").pipe(ba(f.onUserDrop(q)))).pipe(If(void 0))}))}).forEach(function(k,q){f.loginSocketSubs[q].receivers.push(k.subscribe({error:function(){}}))})}},{key:"requestSocketLogin",value:function(f,k,q){var _r=this;return ln(hd(function(){_r.userJoinOptions=new nt(k),f.sendPacket("UserJoin",{account:_r.context.uid,instance:_r.instanceId,opt:_r.userJoinOptions.toLong(),seq:q,ticket:f.ticket})}),f.fromReceived("UserResp").pipe(aa(function(_s){return q.eq(_s.seq)}),ba(function(_s){if(0!==(_s=_s.code))throw _r.clearSockets(),_r.logError("Connected to gateway success but the Rtm server rejected login"),new da(["Login failure. The response code from the RTM service is %d",_s],Bg);f.attemptsSinceLastError=0,f.loggedIn=!0,_r.log("ENV_%d logged in",f.env)}),If(f),kb(6e3))).pipe(zb(function(_s){return void 0!==_s}),Ja(function(_s){return _s instanceof sb&&_r.warn("Login response timeout, rejoin: %s",k),_r.clearSockets(),_s.name="loginRespTimeout",_r.emit("banEdgeIP",f.ip),Z(_s)}))}},{key:"getSocketLoginObservables",value:function(f,k){var q=this;return f.map(function(_r){return _r.pipe(Lc(function(_s,ga){return q.incSeqIfNeeded(_s.env),q.requestSocketLogin(_s,0!==ga,0===ga?k:q.seq)}),De())})}},{key:"incSeqIfNeeded",value:function(f){if(![0,1].includes(f))throw new Ha({INVALID_ENV:"The env argument is not 0 or 1"});this.seqSentStatuses[f]&&(this.seq=this.seq.add(1),this.seqSentStatuses=[!1,!1]),this.seqSentStatuses[f]=!0}},{key:"incGetSeq",value:function(){return this.seq=this.seq.add(1),this.seqSentStatuses=[!0,!0],this.seq}},{key:"getLoginSockets",value:function(){for(var f=this.curLoginSockets,k=-1,q=null==f?0:f.length,_r=0,_s=[];++k<q;){var ga=f[k];ga&&(_s[_r++]=ga)}return _s}},{key:"emitMessage",value:function(f,k){var p_,q=f.options,_r=f.payload,_s=f.src,ga=f.dst,_l=f.instance,bh=f.dialogue,n_=f.sequence,_A=f.ms,r_=f.MiscMap;this.dialogueSequenceLru.set(bh.toString(),n_),_l="".concat(_l,"-").concat(bh,"#").concat(n_),this.msgDedupLru.has(_l)?this.warn("Env_%d: Messages out-of-order or not start with 1: %s",k,_l):(this.msgDedupLru.set(_l,void 0),k=new ke(q),this.lastLoginSockets.forEach((p_=J(x.mark(function I_(v_){return x.wrap(function(x_){for(;;)switch(x_.prev=x_.next){case 0:return x_.next=2,v_.pipe(Pa(1)).toPromise();case 2:l.sendMessageAck(f,x_.sent);case 4:case"end":return x_.stop()}},I_)})),function(I_){return p_.apply(this,arguments)})),q=k.isZlibCompressed(),k.isInvitation()?(ga=ra(q?jm($n(_r,Uint8Array.of(0,0,0,0))):_r),ga=JSON.parse(ga),this.log("The received invitation body is %o",ga),this.emit("invitationMessage",{body:ga,type:k.getInvitationType(),peerId:_s,serverReceivedTs:_A.toNumber()})):k.isTextMessage()?(r_=k.isPeerTextMessage(),_r=ra(q?jm($n(_r,Uint8Array.of(0,0,0,0))):_r),this.info("Received a %s %s text message from %s to %s, %s",q?" compressed":"",r_?"peer":"channel",pa(_s),pa(ga),_l),r_?(_s={text:_r,peerId:_s,properties:{serverReceivedTs:_A.toNumber(),isOfflineMessage:k.isFromCache()}},this.emit("peerTextMessage",_s)):this.emit("channelTextMessage",{channelId:ga,memberId:_s,text:_r,properties:{serverReceivedTs:_A.toNumber(),isOfflineMessage:!1}})):k.isRawMessage()?(bh=k.isRawPeerMessage(),r_=void 0===(r_=r_.description)?"":ra(r_),_r=q?jm(_r):_r,this.info("Received a %s %s raw message from %s to %s, %s",q?" compressed":"",bh?"peer":"channel",pa(_s),pa(ga),_l),bh?(_s={desc:r_,raw:_r,peerId:_s,properties:{serverReceivedTs:_A.toNumber(),isOfflineMessage:k.isFromCache()}},this.emit("peerRawMessage",_s)):this.emit("channelRawMessage",{desc:r_,raw:_r,channelId:ga,memberId:_s,properties:{serverReceivedTs:_A.toNumber(),isOfflineMessage:!1}})):(k.isImageMessage()||k.isFileMessage())&&(_r=k.isPeerMessage(),this.info("Received a %s media message from %s to %s, %s",_r?"peer":"channel",pa(_s),pa(ga),_l),_r?this.emit("peerMediaMessage",{messageType:k.isImageMessage()?"IMAGE":"FILE",details:r_,peerId:_s,properties:{serverReceivedTs:_A.toNumber(),isOfflineMessage:k.isFromCache()}}):this.emit("channelMediaMessage",{messageType:k.isImageMessage()?"IMAGE":"FILE",details:r_,memberId:_s,channelId:ga,properties:{serverReceivedTs:_A.toNumber(),isOfflineMessage:k.isFromCache()}})))}},{key:"onSocketReconnect",value:function(f){var k=this;return function(){var q=[0,1].filter(function(_r){return _r!==f.env})[0];(q=k.connection.curOpenSockets[q])&&!q.loggedIn&&k.emit("connectionLost")}}},{key:"onUserDrop",value:function(f){var k=this;return function(q){var _r;q=q.code,hb("KickedOff",{code:0,elapse:ib(k.startTime),linkId:parseInt(f.name.split("-")[1],10),lts:U.fromNumber(Date.now()),server:f.address,serverCode:q,sid:ab(k.instanceId),userId:k.context.uid},null!==(_r=k.context.config.enableCloudProxy)&&void 0!==_r&&_r),10006===q||10001===q?k.warn("Login too often and kicked off, reconnect and login"):10009===q?(k.warn("The instance ID conflicts, reconnecting"),k.instanceId=Yg(),k.context.sid=ab(k.instanceId),k.emit("instanceChanged",k.instanceId)):[11,14,15,16].includes(q)&&(k.emit("userDrop",q),k.clearSockets())}}},{key:"clearSockets",value:function(){var f=this,k=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,q=1<arguments.length&&void 0!==arguments[1]&&arguments[1];[0,1].forEach(function(_r){f.cleanLoginSubs(_r,q),f.connection.closeSocket(_r,k)})}},{key:"onMessage",value:function(f){var k=this;return function(q){var _r=q.dialogue,_s=q.instance,ga=q.sequence,_l=q.options;if(q.src===k.context.uid)k.log("The message is from the local account, ignored");else{var bh=_r.toString(),n_=k.dialPendingMsgSubjectMap.get(bh);if(_r="".concat(_s,"-").concat(_r,"#").concat(ga),n_)n_.next(q),k.log("Env_%d: The dialogue has pending messages, next: %s",f.env,_r);else{var _A=k.dialogueSequenceLru.get(bh);if(n_=!_A&&ga.eq(1),_s=void 0!==_A&&ga.sub(_A).eq(1),n_||_s)k.emitMessage(q,f.env);else{if(_A){if(ga.lte(_A))return;k.log("Env_%d: The message pended, the sequence is not continuous with the last: %s",f.env,_r)}else k.log("Env_%d: The message pended, the first sequence is not equal to 1: %s",f.env,_r);ga=new Ua,k.dialPendingMsgSubjectMap.set(bh,ga);var r_=ga.pipe(Ku(vl),Ug(function(p_,I_){return[].concat(G(p_),[I_])},[]),ea(function(p_){return G(p_).sort(function(I_,v_){return(I_=I_.sequence).eq(v_=v_.sequence)?0:I_.gt(v_)?1:-1})}),vn(1));_l=!(_l=new ke(_l)).isFromCache()&&!_l.isBufferedMessage(),r_.pipe(rb(Kc(_l?750:1500)),aa(function(p_){if(2>p_.length)return!1;for(var I_=void 0===_A?U.fromNumber(1,!0):_A.add(1),v_=0;v_<p_.length;I_=I_.add(1),v_++)if(!p_[v_].sequence.eq(I_))return!1;return!0}),Tg(function(){k.dialPendingMsgSubjectMap.delete(bh)})).subscribe(function(p_){p_.forEach(function(I_){k.emitMessage(I_,f.env),k.log("Env_%d: The message queue has fully ordered, emitting: %s",f.env,"".concat(I_.instance,"-").concat(I_.dialogue,"#").concat(I_.sequence))})},function(p_){p_ instanceof Sg&&r_.pipe(Pa(1)).subscribe(function(I_){return I_.forEach(function(v_){k.log("Env_%d: The message pending queue expired, emitting: %s",f.env,"".concat(v_.instance,"-").concat(v_.dialogue,"#").concat(v_.sequence)),k.emitMessage(v_,f.env)})})}),ga.next(q)}}}}}},{key:"onPong",value:function(){var f=this;return function(){document.hidden&&f.getLoginSockets().forEach(function(k){f.sendPing(k)})}}},{key:"onGroupEnterNotice",value:function(){var f=this;return function(k){f.emit("memberNotice",{channelId:k.group,seq:k.seq,instance:k.instance,memberId:k.user,type:"MemberJoined",size:k.size})}}},{key:"onGroupLeaveNotice",value:function(){var f=this;return function(k){f.emit("memberNotice",{channelId:k.group,seq:k.seq,instance:k.instance,memberId:k.user,type:"MemberLeft",size:k.size})}}},{key:"onGroupCountNotice",value:function(){var f=this;return function(k){f.emit("memberNotice",{channelId:k.group,seq:k.seq,instance:k.instance,type:"MemberCountUpdated",size:k.size})}}},{key:"onGroupAttributeAlt",value:function(){var f=this;return function(k){var q=k.group;k=yf(k,VF),f.emit("channelAttributesUpdated",wa({channelId:q},k))}}},{key:"onUserNotice",value:function(f){var k=this;return function(q){k.emit("peerOnlineStatusChanged",{peerId:q.user,instance:q.instance,seq:q.seq,state:f})}}},{key:"sendPing",value:function(f){2500>=Date.now()-this.lastPingTime[f.env]||(this.incSeqIfNeeded(f.env),f.sendPacket("Ping",{ms:U.fromNumber(Date.now(),!0),seq:this.seq}),this.lastPingTime[f.env]=Date.now())}}],[{key:"sendMessageAck",value:function(f,k){var q=new ke(f.options);(q.isInvitation()||q.isPeerMessage())&&k.sendPacket("Ack",{code:0,dialogue:f.dialogue,instance:f.instance,sequence:f.sequence})}}]),l}(wb());m(cu,"genTimeoutError",function(h,l){return eb(void 0).pipe(jd(void 0===l?1e4:l),ea(function(){throw new gb(["Request timed out after %ds",void 0===l?1e4:l],h)}))});var du,km,lm=0,mm=0;de.v1=function(h,l,g){g=l&&g||0;var f=l||[],k=(h=h||{}).node||du,q=void 0!==h.clockseq?h.clockseq:km;if(null==k||null==q){var _r=Nr();null==k&&(k=du=[1|_r[0],_r[1],_r[2],_r[3],_r[4],_r[5]]),null==q&&(q=km=16383&(_r[6]<<8|_r[7]))}_r=void 0!==h.msecs?h.msecs:(new Date).getTime();var _s=void 0!==h.nsecs?h.nsecs:mm+1,ga=_r-lm+(_s-mm)/1e4;if(0>ga&&void 0===h.clockseq&&(q=q+1&16383),(0>ga||_r>lm)&&void 0===h.nsecs&&(_s=0),1e4<=_s)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");for(lm=_r,mm=_s,km=q,h=(1e4*(268435455&(_r+=122192928e5))+_s)%4294967296,f[g++]=h>>>24&255,f[g++]=h>>>16&255,f[g++]=h>>>8&255,f[g++]=255&h,f[g++]=(h=_r/4294967296*1e4&268435455)>>>8&255,f[g++]=255&h,f[g++]=h>>>24&15|16,f[g++]=h>>>16&255,f[g++]=q>>>8|128,f[g++]=255&q,q=0;6>q;++q)f[g+q]=k[q];return l||Or(f)},de.v4=de;var nm=ni(),Ed,uf=S.LocalInvitationFailureReason,Ca=S.LocalInvitationState,WF=(Ed=function(h){function l(f,k,q){X(this,l);var _r=g.call(this,q,"RtmLocalInvitation",!0);return m(n(_r),"state",Ca.IDLE),m(n(_r),"localInvitationEnd$",Da(jb(n(_r),"LocalInvitationAccepted"),jb(n(_r),"LocalInvitationRefused"),jb(n(_r),"LocalInvitationFailure"),jb(n(_r),"LocalInvitationCanceled")).pipe(Pa(1))),m(n(_r),"callId",de.v4()),m(n(_r),"_content",""),m(n(_r),"_channelId",""),m(n(_r),"_response",""),m(n(_r),"calleeId",void 0),m(n(_r),"logger",void 0),m(n(_r),"getSession",void 0),_r.calleeId=f,_r.getSession=k,_r.logger=q,_r}ja(l,h);var g=ka(l);return Ia(l,[{key:"channelId",get:function(){return this._channelId},set:function(f){this.state!==Ca.IDLE?this.info("set channelId only allow before invitation sent to remote"):(this.log("set channelId for %s",this.callId),this._channelId=f)}},{key:"content",get:function(){return this._content},set:function(f){this.log("set content for %s",this.callId),this._content=f}},{key:"response",get:function(){return this._response},set:function(f){throw new H('Cannot set the "response" of the LocalInvitation instance.',Ec)}},{key:"send",value:function(){var f,k=this;if(this.state===Ca.SENT_TO_REMOTE||this.state===Ca.RECEIVED_BY_REMOTE)throw new L("The local invitation send failure. The call invitation has already been sent.",cC);if(this.isLocalInvitationEnd())throw new L("The local invitation send failure. The call invitation has ended.",gi);if(0<this._channelId.length&&!Aa(this._channelId))throw new H("Illegal invitation channel ID",Ec);if(!Aa(this.calleeId))throw new H("Illegal invitation callee user ID",Ec);if(8192<fh(this._content))throw new H('The length of the "content" overflows. The number of bytes representing content must not exceed 8 \xd7 1024 if encoded in UTF-8.',Ec);this.state=Ca.SENT_TO_REMOTE,hd(J(x.mark(function q(){var _r,_s,ga;return x.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:return _l.next=2,k.getSession().sendInvitationMessage({peerId:k.calleeId,callId:k.callId,extra:k._content,type:"CallInvite",channelId:k._channelId});case 2:if(_s=(_r=_l.sent).hasPeerReceived,ga=_r.hasReSent,!k.isLocalInvitationEnd()){_l.next=7;break}throw new gb("send invitation timeout");case 7:if(k.log("The local invitation has sent to the callee"),_s||ga){_l.next=11;break}throw f=new nm({PEER_NOT_ONLINE:"The peer of the invitation is not online"});case 11:if(_s){_l.next=14;break}throw f=new nm({RESENT_AND_OFFLINE:"Resent and the peer of the invitation is not online"});case 14:case"end":return _l.stop()}},q)}))).pipe(Ce(function(q){return q.pipe(ba(function(_r){if(!(_r instanceof nm))throw _r}),jd(2e3))}),kb(3e4),Ja(function(q){return Xa(q)&&k.warn("local invitation ack timed out"),Z(q)}),rb(this.localInvitationEnd$)).subscribe({next:function(){k.state===Ca.RECEIVED_BY_REMOTE?k.log('The local invitation state is already "RECEIVED_BY_REMOTE", skipped emitting "LocalInvitationReceivedByPeer"'):k.state!==Ca.SENT_TO_REMOTE?k.log("The invitation has ended, skipped emitting the %s event","LocalInvitationReceivedByPeer"):(k.info("The peer received the local invitation %s.",k.callId),k.state=Ca.RECEIVED_BY_REMOTE,k.emit("LocalInvitationReceivedByPeer"),k.localInvitationEnd$.pipe(kb(6e4),Ja(function(q){return Xa(q)&&k.warn("local invitation expired"),Z(q)})).subscribe({error:function(){k.state=Ca.FAILURE,k.emit("LocalInvitationFailure",uf.INVITATION_EXPIRE)}}))},error:function(q){k.isLocalInvitationEnd()?k.log("The invitation has ended, skipped emitting the %s event","LocalInvitationFailure"):(k.state=Ca.FAILURE,Xa(q)&&f?"PEER_NOT_ONLINE"===f.code?k.emit("LocalInvitationFailure",uf.PEER_OFFLINE):"RESENT_AND_OFFLINE"===f.code&&k.emit("LocalInvitationFailure",uf.PEER_NO_RESPONSE):Xa(q)?k.emit("LocalInvitationFailure",uf.PEER_NO_RESPONSE):k.emit("LocalInvitationFailure","RtmInvalidStatusError"===q.name?uf.NOT_LOGGEDIN:uf.UNKNOWN))}})}},{key:"cancel",value:function(){if(this.isLocalInvitationEnd())throw new L("The local invitation cancel failure",gi);if(this.state===Ca.IDLE)throw new L("The local invitation has not been sent",bC);if(8192<fh(this._content))throw new H('The length of the "content" overflows. The number of bytes representing content must not exceed 8 \xd7 1024 if encoded in UTF-8.',Ec);this.getSession().sendInvitationMessage({callId:this.callId,peerId:this.calleeId,type:"CallCancel",channelId:this._channelId,extra:this._content}),this.state=Ca.CANCELED,this.emit("LocalInvitationCanceled")}},{key:"onAcceptReceived",value:function(f){if(this.isLocalInvitationEnd()&&this.state!==Ca.ACCEPTED_BY_REMOTE)this.log("The invitation has ended, skipped emitting the %s event","LocalInvitationAccepted");else{if(this.state===Ca.IDLE)throw new L("the local have not sent the invitation, how can remote accept it?");this.getSession().sendInvitationMessage({callId:this.callId,isAcceptAck:!0,type:"CallAccept",peerId:this.calleeId,channelId:this.channelId}),this.state===Ca.ACCEPTED_BY_REMOTE?this.log("already in ACCEPTED_BY_REMOTE state, ignore emit ACCEPTED_BY_REMOTE"):(this.state===Ca.SENT_TO_REMOTE&&(this.log("receive LocalInvitationAccepted before remote response to the invitation"),this.state=Ca.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this.state=Ca.ACCEPTED_BY_REMOTE,this._response=f,this.emit("LocalInvitationAccepted",f))}}},{key:"onRefuseReceived",value:function(f){if(this.isLocalInvitationEnd())this.log("The invitation has ended, skipped emitting the %s event","LocalInvitationRefused");else{if(this.state===Ca.IDLE)throw new L("the local have not sent the invitation, how can remote refuse it?");this.state===Ca.SENT_TO_REMOTE&&(this.log("receive LocalInvitationRefused before remote response to the invitation"),this.state=Ca.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this._response=f,this.state=Ca.REFUSED_BY_REMOTE,this.emit("LocalInvitationRefused",f)}}},{key:"isLocalInvitationEnd",value:function(){return[Ca.CANCELED,Ca.FAILURE,Ca.ACCEPTED_BY_REMOTE,Ca.REFUSED_BY_REMOTE].includes(this.state)}}]),l}(wb()),la(Ed.prototype,"send",[Qb],Object.getOwnPropertyDescriptor(Ed.prototype,"send"),Ed.prototype),la(Ed.prototype,"cancel",[Qb],Object.getOwnPropertyDescriptor(Ed.prototype,"cancel"),Ed.prototype),Ed),vi=S.RemoteInvitationFailureReason,nb=S.RemoteInvitationState,XF=function(h){function l(f){var k=f.invitationChannel,q=f.extraContent,_r=f.callId,_s=f.callerId,ga=f.logger;f=f.getSession,X(this,l);var _l=g.call(this,ga,"RtmRemoteInvitation",!0);return m(n(_l),"state",nb.INVITATION_RECEIVED),m(n(_l),"remoteInvitationEnd$",Da(jb(n(_l),"RemoteInvitationCanceled"),jb(n(_l),"RemoteInvitationRefused"),jb(n(_l),"RemoteInvitationAccepted"),jb(n(_l),"RemoteInvitationFailure")).pipe(Pa(1))),m(n(_l),"callerId",void 0),m(n(_l),"callId",void 0),m(n(_l),"_getSession",void 0),m(n(_l),"logger",void 0),m(n(_l),"_content",void 0),m(n(_l),"_channelId",void 0),m(n(_l),"_response",""),_l._channelId=k,_l._content=q,_l.callId=_r,_l.callerId=_s,_l._getSession=f,_l.logger=ga,_l.remoteInvitationEnd$.pipe(kb(6e4),Ja(function(bh){return Xa(bh)&&_l.warn("Remote invitation expired"),Z(bh)})).subscribe({error:function(){_l.state=nb.FAILURE,_l.emit("RemoteInvitationFailure",vi.INVITATION_EXPIRE)}}),_l}ja(l,h);var g=ka(l);return Ia(l,[{key:"channelId",get:function(){return this._channelId},set:function(f){throw new H('Cannot set the "response" of the RemoteInvitation instance.',Ec)}},{key:"content",get:function(){return this._content},set:function(f){throw new H('Cannot set the "content" of the RemoteInvitation instance.',Ec)}},{key:"response",get:function(){return this._response},set:function(f){this._response=f}},{key:"accept",value:function(){var f,k=this;if(this.isRemoteInvitationEnd())throw new L("The local invitation has ended. Cannot accept.",gi);if(this.state===nb.ACCEPT_SENT_TO_LOCAL)throw new L("The remote invitation is accepting. Cannot do the operation.",Ur);if(8192<fh(this._response))throw new H('The length of the "response" overflows. The number of bytes representing content must not exceed 8 \xd7 1024 if encoded in UTF-8.',Ec);this.state=nb.ACCEPT_SENT_TO_LOCAL,cc(pn(1e3).pipe(fb(function(){return hd(J(x.mark(function q(){return x.wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:return _r.abrupt("return",k._getSession().sendInvitationMessage({peerId:k.callerId,callId:k.callId,extra:k.response,type:"CallAccept",isAcceptAck:!1,channelId:k.channelId}));case 1:case"end":return _r.stop()}},q)})))}),zb(function(q){return f=q.hasPeerReceived}),Pa(1)),jb(this,"RemoteInvitationAccepted")).pipe(kb(5e3),rb(this.remoteInvitationEnd$)).subscribe({error:function(q){if(k.logError(q),k.state=nb.FAILURE,Xa(q))switch(f){case void 0:case!0:return void k.emit("RemoteInvitationFailure",vi.ACCEPT_FAILURE);case!1:return void k.emit("RemoteInvitationFailure",vi.PEER_OFFLINE)}k.emit("RemoteInvitationFailure",vi.UNKNOWN)}})}},{key:"refuse",value:function(){if(this.state===nb.ACCEPT_SENT_TO_LOCAL)throw new L("The remote invitation is accepting. Cannot do the operation.",Ur);if(this.isRemoteInvitationEnd())throw new L("The invitation is end. Cannot refuse",gi);if(8192<fh(this._response))throw new H('The length of the "response" overflows. The number of bytes representing content must not exceed 8 \xd7 1024 if encoded in UTF-8.',Ec);this._getSession().sendInvitationMessage({peerId:this.callerId,callId:this.callId,extra:this.response,type:"CallReject",channelId:this.channelId}),this.state=nb.REFUSED,this.emit("RemoteInvitationRefused")}},{key:"onCancelReceived",value:function(f){this.isRemoteInvitationEnd()?this.log("The invitation has ended, skipped emitting the %s event","RemoteInvitationCanceled"):(this.state===nb.ACCEPT_SENT_TO_LOCAL&&this.log("caller canceled before receive accept"),this._content=f,this.state=nb.CANCELED,this.emit("RemoteInvitationCanceled",f))}},{key:"onAcceptAckReceived",value:function(){this.state!==nb.ACCEPT_SENT_TO_LOCAL?this.log("The invitation has ended, skipped emitting the %s event","ori:".concat(this.state,", to: RemoteInvitationAccepted")):(this.state=nb.ACCEPTED,this.emit("RemoteInvitationAccepted"))}},{key:"isRemoteInvitationEnd",value:function(){return[nb.ACCEPTED,nb.REFUSED,nb.CANCELED,nb.FAILURE].includes(this.state)}}]),l}(wb()),YF=function(h){function l(f,k){X(this,l);var q=g.call(this,k,"InvitationManager");return m(n(q),"getSession",void 0),m(n(q),"invitationDispatcher",new ia.EventEmitter),m(n(q),"outgoingLocalInvitations",new Map),m(n(q),"receivedRemoteInvitations",new Ac(void 0,{maxlen:1e4})),m(n(q),"logger",void 0),q.getSession=ho(f),q.logger=k,q.invitationDispatcher.on("remoteInvitationToManager",function(_r){var _s=_r.callId,ga=_r.extra,_l=_r.callerId;_r=_r.channelId,q.receivedRemoteInvitations.has(_s)||((ga=new XF({callerId:_l,callId:_s,getSession:q.getSession,logger:k,extraContent:ga,invitationChannel:_r})).remoteInvitationEnd$.subscribe(function(){q.receivedRemoteInvitations.delete(_s)}),q.receivedRemoteInvitations.set(_s,ga),q.emit("remoteInvitationInstance",ga))}),q.invitationDispatcher.on("acceptAckToRemoteInvitation",function(_r){(_r=q.receivedRemoteInvitations.get(_r.callId))&&_r.onAcceptAckReceived()}),q.invitationDispatcher.on("cancelToRemoteInvitation",function(_r){var _s=_r.extra;(_r=q.receivedRemoteInvitations.get(_r.callId))&&_r.onCancelReceived(_s)}),q.invitationDispatcher.on("acceptToLocalInvitation",function(_r){var _s=_r.extra;(_r=q.outgoingLocalInvitations.get(_r.callId))&&_r.onAcceptReceived(_s)}),q.invitationDispatcher.on("refuseToLocalInvitation",function(_r){var _s=_r.extra;(_r=q.outgoingLocalInvitations.get(_r.callId))&&_r.onRefuseReceived(_s)}),q}ja(l,h);var g=ka(l);return Ia(l,[{key:"invitationMessageHandler",value:function(f){var k=f.body,q=k.callId,_r=k.extra;_r=void 0===_r?"":_r;var _s=k.type,ga=void 0===(k=k.channel)?"":k,_l=f.type;switch(k=f.peerId,f=f.serverReceivedTs,_l){case"CallAccept":"ack"===_s?this.invitationDispatcher.emit("acceptAckToRemoteInvitation",{callId:q}):"request"===_s&&this.invitationDispatcher.emit("acceptToLocalInvitation",{callId:q,extra:_r});break;case"CallInvite":this.invitationDispatcher.emit("remoteInvitationToManager",{callId:q,callerId:k,extra:_r,channelId:ga});break;case"CallCancel":if("0"===q){q="".concat("AgoraRTMLegacyEndcallCompatibleMessagePrefix","_").concat(ga,"_").concat(_r),this.getSession().emit("peerTextMessage",{peerId:k,properties:{serverReceivedTs:f,isOfflineMessage:!1},text:q});break}this.invitationDispatcher.emit("cancelToRemoteInvitation",{callId:q,extra:_r});break;case"CallReject":this.invitationDispatcher.emit("refuseToLocalInvitation",{callId:q,extra:_r});break;default:throw Nn("invitationType",_l)}}},{key:"genLocalInvitation",value:function(f){var k=this,q=new WF(f,this.getSession,this.logger);return q.localInvitationEnd$.subscribe(function(){k.outgoingLocalInvitations.delete(q.callId)}),this.outgoingLocalInvitations.set(q.callId,q),q}}]),l}(wb()),ZF=function(h,l,g){var f=!0,k=!0;if("function"!=typeof h)throw new TypeError("Expected a function");return ob(g)&&(f="leading"in g?!!g.leading:f,k="trailing"in g?!!g.trailing:k),mE(h,l,{leading:f,maxWait:l,trailing:k})},xb,vf;!function(h){h[h.JOINED=0]="JOINED",h[h.LEFT=1]="LEFT"}(vf||(vf={}));var om=S.ConnectionState,$F=(xb=function(h){function l(f,k,q,_r){X(this,l);var _s=g.call(this,_r,"RtmChannel",!0);return m(n(_s),"onMemberCountUpdated",ZF(function(ga){ga!==_s.memberCount&&(_s.memberCount=ga,_s.emit("MemberCountUpdated",ga))},1e3)),m(n(_s),"getSession",void 0),m(n(_s),"memberCount",0),m(n(_s),"joinState","LEFT"),m(n(_s),"joinPromise",void 0),m(n(_s),"memberJoinedLru",new Ac(void 0,{maxlen:1e4})),m(n(_s),"memberLeftLru",new Ac(void 0,{maxlen:1e4})),m(n(_s),"memberJoinStateLru",new Ac(void 0,{maxlen:1e4})),m(n(_s),"attributesSeqLru",new Ac(void 0,{maxlen:1e4})),m(n(_s),"channelId",void 0),m(n(_s),"client",void 0),m(n(_s),"onChannelMemberCountUpdated",function(ga,_l){_s.channelId===ga&&_s.onMemberCountUpdated(_l)}),m(n(_s),"onLogout",function(){try{_s.clearChannel(_s.getSession())}catch(ga){}}),m(n(_s),"onAttributesUpdated",function(ga){var _l=ga.channelId,bh=ga.attributeMaps,n_=ga.seq;ga=ga.instance.toString();var _A=_s.attributesSeqLru.get(ga);if((!_A||n_.greaterThan(_A))&&(_s.attributesSeqLru.set(ga,n_),_l===_s.channelId)){for(_l={},n_=0;n_<bh.length;n_++){var r_=bh[n_];ga=r_.key,_A=r_.ms;var p_=r_.value;if(r_=r_.origin,"string"!=typeof ga||!U.isLong(_A)||"string"!=typeof p_||!Aa(r_))break;_l[ga]={value:p_,lastUpdateUserId:r_,lastUpdateTs:_A.toNumber()}}_s.emit("AttributesUpdated",_l)}}),m(n(_s),"onChannelTextMessage",function(ga){ga.channelId===_s.channelId&&_s.emit("ChannelMessage",{text:ga.text,messageType:S.MessageType.TEXT},ga.memberId,ga.properties)}),m(n(_s),"onChannelMediaMessage",function(ga){var _l=ga.memberId,bh=ga.properties,n_=ga.details,_A=ga.messageType;ga.channelId===_s.channelId&&("FILE"===_A?_s.emit("ChannelMessage",{messageType:S.MessageType.FILE,size:parseInt(ra(n_.media_size),10),description:ra(n_.media_description),fileName:ra(n_.media_filename),mediaId:ra(n_.media_id),thumbnail:new Blob([n_.media_thumbnail])},_l,bh):"IMAGE"===_A&&_s.emit("ChannelMessage",{messageType:S.MessageType.IMAGE,size:parseInt(ra(n_.media_size),10),description:ra(n_.media_description),fileName:ra(n_.media_filename),mediaId:ra(n_.media_id),thumbnail:new Blob([n_.media_thumbnail]),height:parseInt(ra(n_.media_height),10),width:parseInt(ra(n_.media_width),10),thumbnailHeight:parseInt(ra(n_.media_thumbnailheight),10),thumbnailWidth:parseInt(ra(n_.media_thumbnailwidth),10)},_l,bh))}),m(n(_s),"onChannelRawMessage",function(ga){ga.channelId===_s.channelId&&_s.emit("ChannelMessage",{messageType:S.MessageType.RAW,rawMessage:ga.raw,description:ga.desc},ga.memberId,ga.properties)}),m(n(_s),"onMemberNotice",function(ga){var _l=ga.memberId,bh=ga.type,n_=ga.size;if(ga.channelId===_s.channelId){var _A=ga.instance.toString();ga=ga.seq.toString();var r_={MemberLeft:_s.memberLeftLru,MemberJoined:_s.memberJoinedLru,MemberCountUpdated:void 0}[bh];if(r_){if(r_.has(_A+ga))return void _s.log("received duplicated %s notice (seq: %s), channel '%s', member '%s'",bh,ga,pa(_s.channelId),pa(_l||""));if(r_.set(_A+ga,void 0),"string"!=typeof _l)return;if(_l!==_s.getSession().context.uid&&((_A=_s.memberJoinStateLru.get(_l))===vf.JOINED&&"MemberJoined"===bh||_A===vf.LEFT&&"MemberLeft"===bh))return void _s.log("received duplicated %s state (seq: %s), channel '%s', member '%s'",bh,ga,pa(_s.channelId),pa(_l||""));_s.memberJoinStateLru.set(_l,"MemberJoined"===bh?vf.JOINED:vf.LEFT)}_s.info("Channel %s - %s, memberId: %s",bh,pa(_s.channelId),"MemberCountUpdated"===bh?"[unknown]":pa(_l||"")),_A=_l===_s.getSession().context.uid,"MemberLeft"===bh&&Aa(_l)||"MemberJoined"===bh&&Aa(_l)?(_A||_s.emit(bh,_l),_s.onMemberCountUpdated(n_)):"MemberCountUpdated"===bh&&"number"==typeof n_&&_s.onMemberCountUpdated(n_)}}),_s.getSession=ho(k),_s.channelId=f,_s.client=q,_s.info("A channel created, id %s",pa(f)),_s}ja(l,h);var g=ka(l);return Ia(l,[{key:"join",value:function(){var f=J(x.mark(function k(){var q,_r,_s,ga,_l,bh,n_,_A=this;return x.wrap(function(r_){for(;;)switch(r_.prev=r_.next){case 0:r_.prev=0,q=this.getSession(),r_.next=7;break;case 4:throw r_.prev=4,r_.t0=r_.catch(0),new L("The client is not logged in. Cannot do the operation",Zr);case 7:if(r_.prev=7,Aa(this.channelId)){r_.next=10;break}throw new H(["The %s in the arguments is invalid","channelId"],dC);case 10:if("LEFT"===this.joinState){r_.next=13;break}throw hb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:q.context.uid,elapse:ib(q.startTime),errCode:Yr,sid:ab(q.instanceId)},null!==(ga=this.client.context.config.enableCloudProxy)&&void 0!==ga&&ga),new L("The channel has joined. Cannot rejoin",Yr);case 13:if(!q.usedChannelIds.includes(this.channelId)){r_.next=16;break}throw hb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:q.context.uid,elapse:ib(q.startTime),errCode:$r,sid:ab(q.instanceId)},null!==(_l=this.client.context.config.enableCloudProxy)&&void 0!==_l&&_l),new L("A channel of the same channel ID has already joined. Cannot rejoin",$r);case 16:if(!(20<=q.usedChannelIds.length)){r_.next=19;break}throw hb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:q.context.uid,elapse:ib(q.startTime),errCode:Xr,sid:ab(q.instanceId)},null!==(bh=this.client.context.config.enableCloudProxy)&&void 0!==bh&&bh),new lb("The joined channels has exceeded the limit of 20",Xr);case 19:return hb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:q.context.uid,elapse:ib(q.startTime),errCode:0,sid:ab(q.instanceId)},null!==(_r=this.client.context.config.enableCloudProxy)&&void 0!==_r&&_r),this.log("Joining the channel %s",pa(this.channelId)),this.joinState="JOINING",q.usedChannelIds.push(this.channelId),this.joinPromise=q.requestChannelJoin(this.channelId).then(function(){_A.joinState="JOINED"}),r_.next=26,this.joinPromise;case 26:hb("ChnJoinRes",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:ib(q.startTime),errCode:0,sid:ab(q.instanceId),serverErrCode:0,userId:q.context.uid},null!==(_s=this.client.context.config.enableCloudProxy)&&void 0!==_s&&_s),this.info("The channel %s joined successfully",pa(this.channelId)),q.on("channelTextMessage",this.onChannelTextMessage),q.on("channelRawMessage",this.onChannelRawMessage),q.on("channelMediaMessage",this.onChannelMediaMessage),q.on("memberNotice",this.onMemberNotice),q.on("channelAttributesUpdated",this.onAttributesUpdated),this.client.internalEmitter.on("channelMemberCountUpdated",this.onChannelMemberCountUpdated),this.client.internalEmitter.once("LOGOUT",this.onLogout),r_.next=47;break;case 37:if(r_.prev=37,r_.t1=r_.catch(7),"JOINING"===this.joinState&&(this.joinState="LEFT"),this.logError(r_.t1),!ta(r_.t1)){r_.next=43;break}throw r_.t1;case 43:if(!Xa(r_.t1)){r_.next=46;break}throw hb("ChnJoinRes",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:ib(q.startTime),errCode:Wr,sid:ab(q.instanceId),serverErrCode:0,userId:q.context.uid},null!==(n_=this.client.context.config.enableCloudProxy)&&void 0!==n_&&n_),new gb(["Join channel %s timed out",pa(this.channelId)],Wr);case 46:throw new bd(["The channel %s join failure",pa(this.channelId)],{code:Vr,originalError:r_.t1});case 47:case"end":return r_.stop()}},k,this,[[0,4],[7,37]])}));return function(){return f.apply(this,arguments)}}()},{key:"leave",value:function(){var f=J(x.mark(function k(){var q,_r,_s,ga;return x.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:_l.prev=0,_r=this.getSession(),_l.next=7;break;case 4:throw _l.prev=4,_l.t0=_l.catch(0),new L("The client is not logged in. Cannot do the operation",fC);case 7:if("LEFT"!==this.joinState){_l.next=9;break}throw new L("The channel does not join. Cannot do the operation",eC);case 9:return _l.prev=9,_r.requestChannelLeave(this.channelId),_l.next=13,this.clearChannel(_r);case 13:_l.next=24;break;case 15:if(_l.prev=15,_l.t1=_l.catch(9),this.logError(_l.t1),!ta(_l.t1)){_l.next=22;break}throw void 0===_l.t1.code&&(_l.t1.code=bs),hb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:ib(_r.startTime),errCode:bs,sid:ab(_r.instanceId),userId:_r.context.uid},null!==(ga=this.client.context.config.enableCloudProxy)&&void 0!==ga&&ga),_l.t1;case 22:throw hb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:ib(_r.startTime),errCode:as,sid:ab(_r.instanceId),userId:_r.context.uid},null!==(_s=this.client.context.config.enableCloudProxy)&&void 0!==_s&&_s),new bd("The channel leave failure",{code:as,originalError:_l.t1});case 24:hb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:ib(_r.startTime),errCode:0,sid:ab(_r.instanceId),userId:_r.context.uid},null!==(q=this.client.context.config.enableCloudProxy)&&void 0!==q&&q);case 25:case"end":return _l.stop()}},k,this,[[0,4],[9,15]])}));return function(){return f.apply(this,arguments)}}()},{key:"sendMessage",value:function(){var f=J(x.mark(function k(q){var _s,ga,_l,bh=this,n_=arguments;return x.wrap(function(_A){for(;;)switch(_A.prev=_A.next){case 0:if(ga=void 0!==(_s=(1<n_.length&&void 0!==n_[1]?n_[1]:{}).enableHistoricalMessaging)&&_s,Wn(q,fi),"JOINED"===this.joinState){_A.next=4;break}throw new L("The channel does not join. Cannot do the operation",UB);case 4:if(this.client.connectionState!==om.RECONNECTING){_A.next=9;break}return _l=Date.now(),_A.next=8,new Promise(function(r_,p_){var S_,I_=(S_=J(x.mark(function x_(){var B_;return x.wrap(function(V_){for(;;)switch(V_.prev=V_.next){case 0:return B_=Date.now()-_l,V_.prev=1,V_.next=4,dh({message:q,peerId:bh.channelId,toPeer:!1,session:bh.getSession(),errorCodes:{NOT_LOGGED_IN:El,TOO_OFTEN:Qr},diff:B_,logger:bh.logger,options:{enableHistoricalMessaging:ga,enableOfflineMessaging:!1}});case 4:r_(),V_.next=12;break;case 7:V_.prev=7,V_.t0=V_.catch(1),Xa(V_.t0)&&p_(new gb(he(bh.name,"sendMessageToPeer",1e4),Dl)),ta(V_.t0)&&p_(V_.t0),p_(new da("Channel message send failure",{code:Ag,originalError:V_.t0}));case 12:return V_.prev=12,clearTimeout(v_),V_.finish(12);case 15:case"end":return V_.stop()}},x_,null,[[1,7,12,15]])})),function(){return S_.apply(this,arguments)});bh.client.internalEmitter.once("RECONNECTED",I_);var v_=setTimeout(function(){bh.client.internalEmitter.off("RECONNECTED",I_),p_(new gb(he(bh.name,"sendMessageToPeer",1e4),Dl))},9e3)});case 8:return _A.abrupt("return");case 9:if(this.client.connectionState===om.CONNECTED){_A.next=11;break}throw new L("The client is not logged in. Cannot do the operation",El);case 11:return _A.prev=11,_A.next=14,dh({message:q,peerId:this.channelId,toPeer:!1,session:this.getSession(),errorCodes:{NOT_LOGGED_IN:El,TOO_OFTEN:Qr},diff:0,logger:this.logger,options:{enableHistoricalMessaging:ga,enableOfflineMessaging:!1}});case 14:_A.next=24;break;case 16:if(_A.prev=16,_A.t0=_A.catch(11),!Xa(_A.t0)){_A.next=20;break}throw new gb(he(this.name,"sendMessage",1e4),Dl);case 20:if(!ta(_A.t0)){_A.next=23;break}throw this.logError(_A.t0),_A.t0;case 23:throw new bd("The channel message send failure",Ag);case 24:case"end":return _A.stop()}},k,this,[[11,16]])}));return function(k){return f.apply(this,arguments)}}()},{key:"getMembers",value:function(){var f=J(x.mark(function k(){var q,_r;return x.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:if(_s.prev=0,this.client.connectionState===om.CONNECTED){_s.next=3;break}throw new L("The client is not logged in. Cannot do the operation",aC);case 3:if("JOINED"===this.joinState){_s.next=5;break}throw new L("The channel does not join. Cannot do the operation",$B);case 5:return q=this.getSession().requestChannelMemberList(this.channelId),_s.next=8,q.pipe(ea(function(ga){return ga.memberInfos.map(function(_l){return _l.account})})).toPromise();case 8:return _r=_s.sent,this.info("Channel %s - get members success, %o",pa(this.channelId),_r.map(pa)),_s.abrupt("return",_r);case 13:if(_s.prev=13,_s.t0=_s.catch(0),!ta(_s.t0)){_s.next=18;break}throw this.logError(_s.t0),_s.t0;case 18:throw new bd("The channel members get failure",YB);case 19:case"end":return _s.stop()}},k,this,[[0,13]])}));return function(){return f.apply(this,arguments)}}()},{key:"clearChannel",value:function(){var f=J(x.mark(function k(q){var _r=this;return x.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:if(q.emit("channelLeft",this.channelId),"JOINING"!==this.joinState){_s.next=4;break}return _s.next=4,this.joinPromise;case 4:this.joinState="LEFT",this.memberLeftLru.empty(),this.memberJoinedLru.empty(),this.attributesSeqLru.empty(),this.memberJoinStateLru.empty(),this.memberCount=0,q.removeListener("channelTextMessage",this.onChannelTextMessage),q.removeListener("channelRawMessage",this.onChannelRawMessage),q.removeListener("channelMediaMessage",this.onChannelMediaMessage),q.removeListener("memberNotice",this.onMemberNotice),q.removeListener("channelAttributesUpdated",this.onAttributesUpdated),this.client.internalEmitter.removeListener("channelMemberCountUpdated",this.onChannelMemberCountUpdated),this.client.internalEmitter.removeListener("LOGOUT",this.onLogout),q.usedChannelIds=q.usedChannelIds.filter(function(ga){return ga!==_r.channelId});case 18:case"end":return _s.stop()}},k,this)}));return function(k){return f.apply(this,arguments)}}()}]),l}(wb()),la(xb.prototype,"join",[Qb],Object.getOwnPropertyDescriptor(xb.prototype,"join"),xb.prototype),la(xb.prototype,"leave",[Qb],Object.getOwnPropertyDescriptor(xb.prototype,"leave"),xb.prototype),la(xb.prototype,"sendMessage",[Qb],Object.getOwnPropertyDescriptor(xb.prototype,"sendMessage"),xb.prototype),la(xb.prototype,"getMembers",[Ra],Object.getOwnPropertyDescriptor(xb.prototype,"getMembers"),xb.prototype),xb),E,Ib=S.ConnectionChangeReason,T=S.ConnectionState,eu={DISCONNECTED:1,CONNECTING:2,CONNECTED:3,RECONNECTING:4,ABORTED:5},aG={LOGIN:1,LOGIN_SUCCESS:2,LOGIN_FAILURE:3,LOGIN_TIMEOUT:4,INTERRUPTED:5,LOGOUT:6,BANNED_BY_SERVER:7,REMOTE_LOGIN:8},bG=(E=function(h){function l(f,k,q,_r){X(this,l);var _s=g.call(this,k,"RtmClient",!0);return m(n(_s),"connectionState",T.DISCONNECTED),m(n(_s),"internalEmitter",new ia),m(n(_s),"context",void 0),m(n(_s),"attributes",{}),m(n(_s),"loginPromise",void 0),m(n(_s),"attributeDrafts",new Set),m(n(_s),"session",void 0),m(n(_s),"lastLoginTime",void 0),m(n(_s),"reconnId",0),m(n(_s),"channelAttributesCacheLru",new Ac(void 0,{maxlen:1e4})),m(n(_s),"invitationManager",void 0),m(n(_s),"subscribedPeerStatusCache",{}),m(n(_s),"pendingPeerStatusSubCount",0),m(n(_s),"peerStatusSeqLru",new Ac(void 0,{maxlen:1e4})),m(n(_s),"peerUnreachableTimers",{}),m(n(_s),"mediaTaskManager",void 0),m(n(_s),"setParameters",void 0),m(n(_s),"updateConfig",void 0),m(n(_s),"blacklistedIP",{}),m(n(_s),"userDropHandler",function(ga){if(_s.connectionState!==T.ABORTED)switch(ga){case 11:_s.logError("Kicked off by remote session"),_s.onConnectionStateChanged(T.ABORTED,Ib.REMOTE_LOGIN);break;case 14:case 15:case 16:_s.logError("Server banned because of illegal ".concat({14:"User ID",15:"IP",16:"Channel Name"}[ga])),_s.onConnectionStateChanged(T.ABORTED,Ib.BANNED_BY_SERVER);break;default:_s.logError("User kicked off for unknown code: ".concat(ga)),_s.onConnectionStateChanged(T.ABORTED,Ib.INTERRUPTED)}}),_s.context=new VE(f,q,k),_s.mediaTaskManager=new kt(k),_s.context.config=q,_s.internalEmitter.setMaxListeners(512),_s.setParameters=_r.bind(n(_s)),_s.updateConfig=_r.bind(n(_s)),_s.invitationManager=new YF(function(){return _s.session},k),_s.invitationManager.on("remoteInvitationInstance",function(ga){_s.emit("RemoteInvitationReceived",ga)}),_s.setMaxListeners(512),_s.internalEmitter.setMaxListeners(512),_s}ja(l,h);var g=ka(l);return Ia(l,[{key:"renewToken",value:function(){var f=J(x.mark(function k(q){var _r,ga,_l=this;return x.wrap(function(bh){for(;;)switch(bh.prev=bh.next){case 0:if("string"==typeof q&&0!==q.length){bh.next=2;break}throw new H("Invalid argument",nC);case 2:if(this.connectionState!==T.ABORTED){bh.next=5;break}return bh.next=5,new Promise(function(){});case 5:if(this.connectionState===T.CONNECTED||this.connectionState===T.RECONNECTING){bh.next=7;break}throw new L("The client is not logged in",qC);case 7:if(void 0!==this.session){bh.next=9;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return bh.prev=9,_r=this.context.token,this.context.token=q,bh.next=14,this.session.connection.apClient.getApEdgeInfo$(!1).pipe(Md(function(){return Error("No available edge address to connect")}),Ce(function(n_){return n_.pipe(ba(function(_A){if(ta(_A))throw _A}),jd(2500),Pa(4))}),Pa(1),kb(2e4),Ja(function(n_){return Xa(n_)&&_l.warn("renewToken timed out"),Z(n_)})).toPromise();case 14:ga=bh.sent.ticket,bh.next=27;break;case 18:if(bh.prev=18,bh.t0=bh.catch(9),this.context.token=_r,bh.t0.code!==ds&&bh.t0.code!==es){bh.next=23;break}throw new of("Invalid token",pC);case 23:if(bh.t0.code!==ii){bh.next=25;break}throw new of("The token expired",oC);case 25:if(!Xa(bh.t0)){bh.next=27;break}throw new gb("Renew token timed out",mC);case 27:this.session.curLoginSockets.filter(function(n_){return void 0!==n_}).forEach(function(n_){return n_.ticket=ga});case 28:case"end":return bh.stop()}},k,this,[[9,18]])}));return function(k){return f.apply(this,arguments)}}()},{key:"queryPeersOnlineStatus",value:function(){var f=J(x.mark(function k(q){var _s,ga=this;return x.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:if(this.connectionState===T.CONNECTED){_l.next=2;break}throw new L("The client is not logged in",lC);case 2:if(void 0!==this.session){_l.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(!(!Array.isArray(q)||0===q.length||q.some(function(bh){return!Aa(bh)})||256<q.length)){_l.next=6;break}throw new H("invalid arguments",is);case 6:return _l.next=8,this.session.requestPeersOnlineStatus(q).toPromise();case 8:return _s=Bc(pl(_l.sent.userInfos,"account"),function(bh){return!!bh.ts}),Object.keys(_s).forEach(function(bh){if(bh in ga.subscribedPeerStatusCache&&ga.subscribedPeerStatusCache[bh]!==S.PeerOnlineState.UNREACHABLE){var n_=_s[bh]?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE;ga.emit("PeersOnlineStatusChanged",m({},bh,n_)),ga.subscribedPeerStatusCache[bh]=n_}}),_l.abrupt("return",_s);case 12:case"end":return _l.stop()}},k,this)}));return function(k){return f.apply(this,arguments)}}()},{key:"getChannelMemberCount",value:function(){var f=J(x.mark(function k(q){var _r,_s,_l,bh,n_,_A,r_,p_;return x.wrap(function(I_){for(;;)switch(I_.prev=I_.next){case 0:if(this.connectionState===T.CONNECTED){I_.next=2;break}throw new L("The client is not logged in",XB);case 2:if(void 0!==this.session){I_.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(q)&&q.every(function(v_){return"string"==typeof v_})&&0!==q.length){I_.next=6;break}throw new H("Invalid arguments: channelIds",Sr);case 6:if(!(32<q.length)){I_.next=8;break}throw new H("getChannelMemberCount exceed limit of 32 channelIds",WB);case 8:_r=0;case 9:if(!(_r<q.length)){I_.next=16;break}if(Aa(_s=q[_r])){I_.next=13;break}throw new H(["getChannelMemberCount channel id %s is invalid",_s],Sr);case 13:_r++,I_.next=9;break;case 16:return I_.next=18,this.session.requestGetChannelMemberCount(q).toPromise();case 18:for(_l=I_.sent.groupInfos,bh={},n_=0;n_<_l.length;n_++)p_=(_A=_l[n_]).memberCount,Aa(r_=_A.group)&&"number"==typeof p_&&(this.internalEmitter.emit("channelMemberCountUpdated",r_,p_),bh[r_]=p_);return I_.abrupt("return",bh);case 23:case"end":return I_.stop()}},k,this)}));return function(k){return f.apply(this,arguments)}}()},{key:"setLocalUserAttributes",value:function(){var f=J(x.mark(function k(q){var _r,_s;return x.wrap(function(ga){for(;;)switch(ga.prev=ga.next){case 0:if(Mf({attributes:q,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),this.connectionState===T.CONNECTED){ga.next=3;break}throw new L("The client is not logged in",Zb);case 3:if(void 0!==this.session){ga.next=5;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return _r=this.session.requestSetLocalUserAttributes(q).toPromise(),this.attributeDrafts.add(_s={attribute:q,promise:_r}),ga.prev=8,ga.next=11,_r;case 11:this.attributes=q,ga.next=19;break;case 14:if(ga.prev=14,ga.t0=ga.catch(8),!ta(ga.t0)){ga.next=18;break}throw ga.t0;case 18:throw new H("arguments is not valid",Oa);case 19:return ga.prev=19,this.attributeDrafts.delete(_s),ga.finish(19);case 22:case"end":return ga.stop()}},k,this,[[8,14,19,22]])}));return function(k){return f.apply(this,arguments)}}()},{key:"setChannelAttributes",value:function(){var f=J(x.mark(function k(q,_r){var ga,_l,bh,n_,_A=arguments;return x.wrap(function(r_){for(;;)switch(r_.prev=r_.next){case 0:if(_l=void 0!==(ga=(2<_A.length&&void 0!==_A[2]?_A[2]:{}).enableNotificationToChannelMembers)&&ga,Mf({attributes:_r,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===T.CONNECTED){r_.next=4;break}throw new L("The client is not logged in",Zb);case 4:if(void 0!==this.session){r_.next=6;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return bh=this.session.requestSetChannelAttributes(q,_r,_l).toPromise(),r_.prev=7,r_.next=10,bh;case 10:n_=Bc(_r,function(p_){return new Blob([p_]).size}),this.channelAttributesCacheLru.set(q,n_),r_.next=19;break;case 14:if(r_.prev=14,r_.t0=r_.catch(7),!ta(r_.t0)){r_.next=18;break}throw r_.t0;case 18:throw new H("arguments is not valid",Oa);case 19:case"end":return r_.stop()}},k,this,[[7,14]])}));return function(k,q){return f.apply(this,arguments)}}()},{key:"addOrUpdateLocalUserAttributes",value:function(){var f=J(x.mark(function k(q){var _r,_s,ga;return x.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:if(_r=wa(wa({},this.attributes),q),Mf({attributes:q,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),Mf({attributes:_r,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),this.connectionState===T.CONNECTED){_l.next=5;break}throw new L("The client is not logged in",Zb);case 5:if(void 0!==this.session){_l.next=7;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return _s=this.session.requestAddOrUpdateLocalUserAttributes(q).toPromise(),this.attributeDrafts.add(ga={attribute:_r,promise:_s}),_l.prev=10,_l.next=13,_s;case 13:this.attributes=_r,_l.next=21;break;case 16:if(_l.prev=16,_l.t0=_l.catch(10),!ta(_l.t0)){_l.next=20;break}throw _l.t0;case 20:throw new H("arguments is not valid",is);case 21:return _l.prev=21,this.attributeDrafts.delete(ga),_l.finish(21);case 24:case"end":return _l.stop()}},k,this,[[10,16,21,24]])}));return function(k){return f.apply(this,arguments)}}()},{key:"addOrUpdateChannelAttributes",value:function(){var f=J(x.mark(function k(q,_r){var ga,_l,bh,n_,_A,r_,p_=arguments;return x.wrap(function(I_){for(;;)switch(I_.prev=I_.next){case 0:if(_l=void 0!==(ga=(2<p_.length&&void 0!==p_[2]?p_[2]:{}).enableNotificationToChannelMembers)&&ga,bh=this.channelAttributesCacheLru.get(q,{}),n_=Bc(_r,function(v_){return new Blob([v_]).size}),_A=wa(wa({},bh),n_),Mf({attributes:_r,attrSizeMap:_A,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===T.CONNECTED){I_.next=7;break}throw new L("The client is not logged in",Zb);case 7:if(void 0!==this.session){I_.next=9;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return r_=this.session.requestAddOrUpdateChannelAttributes(q,_r,_l).toPromise(),I_.prev=10,I_.next=13,r_;case 13:this.channelAttributesCacheLru.set(q,_A),I_.next=21;break;case 16:if(I_.prev=16,I_.t0=I_.catch(10),!ta(I_.t0)){I_.next=20;break}throw I_.t0;case 20:throw new H("arguments is not valid",Oa);case 21:case"end":return I_.stop()}},k,this,[[10,16]])}));return function(k,q){return f.apply(this,arguments)}}()},{key:"deleteLocalUserAttributesByKeys",value:function(){var f=J(x.mark(function k(q){var _r,_s,ga;return x.wrap(function(bh){for(;;)switch(bh.prev=bh.next){case 0:if(Array.isArray(q)&&0!==q.length&&!q.some(function(n_){return 0===n_.length})){bh.next=2;break}throw new L("arguments is not valid",Oa);case 2:if(this.connectionState===T.CONNECTED){bh.next=4;break}throw new L("The client is not logged in",Zb);case 4:if(void 0!==this.session){bh.next=6;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return _r=this.session.requestDeleteLocalUserAttributesByKeys(q).toPromise(),_s={attribute:ml(this.attributes,q),promise:_r},this.attributeDrafts.add(_s),bh.prev=9,bh.next=12,_r;case 12:for(ga=0;ga<q.length;ga++)delete this.attributes[q[ga]];bh.next=20;break;case 15:if(bh.prev=15,bh.t0=bh.catch(9),!ta(bh.t0)){bh.next=19;break}throw bh.t0;case 19:throw new H("arguments is not valid",Oa);case 20:return bh.prev=20,this.attributeDrafts.delete(_s),bh.finish(20);case 23:case"end":return bh.stop()}},k,this,[[9,15,20,23]])}));return function(k){return f.apply(this,arguments)}}()},{key:"deleteChannelAttributesByKeys",value:function(){var f=J(x.mark(function k(q,_r){var ga,_l,bh,n_,_A,p_=arguments;return x.wrap(function(I_){for(;;)switch(I_.prev=I_.next){case 0:if(_l=void 0!==(ga=(2<p_.length&&void 0!==p_[2]?p_[2]:{}).enableNotificationToChannelMembers)&&ga,Array.isArray(_r)&&0!==_r.length&&Aa(q)&&!_r.some(function(v_){return 0===v_.length||512<v_.length})){I_.next=3;break}throw new L("arguments is not valid",Oa);case 3:if(this.connectionState===T.CONNECTED){I_.next=5;break}throw new L("The client is not logged in",Zb);case 5:if(void 0!==this.session){I_.next=7;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return bh=this.session.requestDeleteChannelAttributesByKeys(q,_r,_l).toPromise(),I_.prev=8,I_.next=11,bh;case 11:if(n_=this.channelAttributesCacheLru.get(q))for(_A=0;_A<_r.length;_A++)delete n_[_r[_A]];I_.next=20;break;case 15:if(I_.prev=15,I_.t0=I_.catch(8),!ta(I_.t0)){I_.next=19;break}throw I_.t0;case 19:throw new H("arguments is not valid",Oa);case 20:case"end":return I_.stop()}},k,this,[[8,15]])}));return function(k,q){return f.apply(this,arguments)}}()},{key:"clearLocalUserAttributes",value:function(){var f=J(x.mark(function k(){var q,_r;return x.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:if(this.connectionState===T.CONNECTED){_s.next=2;break}throw new L("The client is not logged in",Zb);case 2:if(void 0!==this.session){_s.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return q=this.session.requestClearLocalUserAttributes().toPromise(),this.attributeDrafts.add(_r={attribute:{},promise:q}),_s.prev=7,_s.next=10,q;case 10:this.attributes={},_s.next=18;break;case 13:if(_s.prev=13,_s.t0=_s.catch(7),!ta(_s.t0)){_s.next=17;break}throw _s.t0;case 17:throw new H("arguments is not valid",Oa);case 18:return _s.prev=18,this.attributeDrafts.delete(_r),_s.finish(18);case 21:case"end":return _s.stop()}},k,this,[[7,13,18,21]])}));return function(){return f.apply(this,arguments)}}()},{key:"clearChannelAttributes",value:function(){var f=J(x.mark(function k(q){var _s,ga,_l,bh=arguments;return x.wrap(function(n_){for(;;)switch(n_.prev=n_.next){case 0:if(ga=void 0!==(_s=(1<bh.length&&void 0!==bh[1]?bh[1]:{}).enableNotificationToChannelMembers)&&_s,this.connectionState===T.CONNECTED){n_.next=3;break}throw new L("The client is not logged in",Zb);case 3:if(void 0!==this.session){n_.next=5;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return _l=this.session.requestClearChannelAttributes(q,ga).toPromise(),n_.prev=6,n_.next=9,_l;case 9:this.channelAttributesCacheLru.delete(q),n_.next=17;break;case 12:if(n_.prev=12,n_.t0=n_.catch(6),!ta(n_.t0)){n_.next=16;break}throw n_.t0;case 16:throw new H("arguments is not valid",Oa);case 17:case"end":return n_.stop()}},k,this,[[6,12]])}));return function(k){return f.apply(this,arguments)}}()},{key:"getUserAttributes",value:function(){var f=J(x.mark(function k(q){var _s,ga;return x.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:if(Aa(q)){_l.next=2;break}throw new H("Not a valid user ID",Oa);case 2:if(this.connectionState===T.CONNECTED){_l.next=4;break}throw new L("The client is not logged in",Zb);case 4:if(void 0!==this.session){_l.next=6;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return _l.prev=6,_l.next=9,this.session.requestGetUserAttributeKeys(q).toPromise();case 9:return _s=_l.sent.keys,_l.next=13,this.session.requestGetUserAttributesByKeys(q,_s.slice(0,512)).toPromise();case 13:ga=_l.sent,_l.next=21;break;case 16:if(_l.prev=16,_l.t0=_l.catch(6),!ta(_l.t0)){_l.next=20;break}throw _l.t0;case 20:throw new H("arguments is not valid",Oa);case 21:return _l.abrupt("return",br(ga.attributeInfos.map(function(bh){return[bh.key,bh.value]})));case 22:case"end":return _l.stop()}},k,this,[[6,16]])}));return function(k){return f.apply(this,arguments)}}()},{key:"getChannelAttributes",value:function(){var f=J(x.mark(function k(q){var _s,_l,bh,n_,_A,r_,p_,I_,v_;return x.wrap(function(S_){for(;;)switch(S_.prev=S_.next){case 0:if(Aa(q)){S_.next=2;break}throw new H("Not a valid channel ID",Oa);case 2:if(this.connectionState===T.CONNECTED){S_.next=4;break}throw new L("The client is not logged in",Zb);case 4:if(void 0!==this.session){S_.next=6;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return S_.prev=6,S_.next=9,this.session.requestGetChannelAttributesKeys(q).toPromise();case 9:return _s=S_.sent.keys,S_.next=13,this.session.requestGetChannelAttributesByKeys(q,_s).toPromise();case 13:_l=S_.sent.attributeMaps,S_.next=22;break;case 17:if(S_.prev=17,S_.t0=S_.catch(6),!ta(S_.t0)){S_.next=21;break}throw S_.t0;case 21:throw new H("arguments is not valid",Oa);case 22:bh={},n_=0;case 24:if(!(n_<_l.length)){S_.next=32;break}if(p_=(_A=_l[n_]).ms,I_=_A.value,v_=_A.origin,"string"==typeof(r_=_A.key)&&U.isLong(p_)&&"string"==typeof I_&&Aa(v_)){S_.next=28;break}return S_.abrupt("break",32);case 28:bh[r_]={value:I_,lastUpdateUserId:v_,lastUpdateTs:p_.toNumber()};case 29:n_++,S_.next=24;break;case 32:return this.channelAttributesCacheLru.set(q,Bc(bh,function(x_){return new Blob([x_.value]).size})),S_.abrupt("return",bh);case 34:case"end":return S_.stop()}},k,this,[[6,17]])}));return function(k){return f.apply(this,arguments)}}()},{key:"getChannelAttributesByKeys",value:function(){var f=J(x.mark(function k(q,_r){var ga,_l,bh,n_,_A,r_,p_,I_,v_;return x.wrap(function(S_){for(;;)switch(S_.prev=S_.next){case 0:if(this.connectionState===T.CONNECTED){S_.next=2;break}throw new L("The client is not logged in",Zb);case 2:if(void 0!==this.session){S_.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return Mn(q,_r),S_.prev=5,S_.next=8,this.session.requestGetChannelAttributesByKeys(q,_r).toPromise();case 8:ga=S_.sent.attributeMaps,S_.next=17;break;case 12:if(S_.prev=12,S_.t0=S_.catch(5),!ta(S_.t0)){S_.next=16;break}throw S_.t0;case 16:throw new H("arguments is not valid",Oa);case 17:_l={},bh=this.channelAttributesCacheLru.get(q,{}),n_=0;case 20:if(!(n_<ga.length)){S_.next=29;break}if(p_=(_A=ga[n_]).ms,I_=_A.value,v_=_A.origin,"string"==typeof(r_=_A.key)&&U.isLong(p_)&&"string"==typeof I_&&Aa(v_)){S_.next=24;break}return S_.abrupt("break",29);case 24:bh[r_]=new Blob([I_]).size,_l[r_]={value:I_,lastUpdateUserId:v_,lastUpdateTs:p_.toNumber()};case 26:n_++,S_.next=20;break;case 29:return this.channelAttributesCacheLru.set(q,bh),S_.abrupt("return",_l);case 31:case"end":return S_.stop()}},k,this,[[5,12]])}));return function(k,q){return f.apply(this,arguments)}}()},{key:"getUserAttributesByKeys",value:function(){var f=J(x.mark(function k(q,_r){var _s;return x.wrap(function(ga){for(;;)switch(ga.prev=ga.next){case 0:if(this.connectionState===T.CONNECTED){ga.next=2;break}throw new L("The client is not logged in",Zb);case 2:if(void 0!==this.session){ga.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return Mn(q,_r),ga.prev=5,ga.next=8,this.session.requestGetUserAttributesByKeys(q,_r).toPromise();case 8:_s=ga.sent,ga.next=16;break;case 11:if(ga.prev=11,ga.t0=ga.catch(5),!ta(ga.t0)){ga.next=15;break}throw ga.t0;case 15:throw new H("arguments is not valid",Oa);case 16:return ga.abrupt("return",br(_s.attributeInfos.map(function(_l){return[_l.key,_l.value]})));case 17:case"end":return ga.stop()}},k,this,[[5,11]])}));return function(k,q){return f.apply(this,arguments)}}()},{key:"login",value:function(){var f=J(x.mark(function k(q){var _r,_s,ga,_l,bh;return x.wrap(function(n_){for(;;)switch(n_.prev=n_.next){case 0:if(wn(!0),_s=Yg(),ga=q.token,q.token===this.context.appId&&(ga=void 0),hb("Session",{appId:this.context.appId,did:navigator.userAgent,elapse:ib(this.session&&this.session.startTime),index:{index1:q.uid,index2:this.context.appId,index3:"enableLogUpload=".concat(this.context.config.enableLogUpload)},installId:zg,lts:U.fromNumber(Date.now()),os:7,sid:ab(_s),token:ga||"",userId:q.uid,ver:"1.4.5",buildno:415,subVersion:15,version:4},null!==(_r=this.context.config.enableCloudProxy)&&void 0!==_r&&_r,!0),Hd(q)&&Aa(q.uid)){n_.next=7;break}throw new H("not a valid user id",hi);case 7:if("string"!=typeof ga||!ga){n_.next=11;break}this.context.token=ga,n_.next=13;break;case 11:if("string"==typeof ga||null==ga){n_.next=13;break}throw new H('The "token" is not a valid string.',hi);case 13:return _l=Date.now(),this.context.sid=ab(_s),this.loginPromise=this.loginImpl({uid:q.uid,instanceId:_s}),this.info("RTM Client logging in as ".concat(pa(q.uid))),n_.prev=17,n_.next=20,this.loginPromise;case 20:n_.next=28;break;case 22:throw n_.prev=22,n_.t0=n_.catch(17),ta(n_.t0)&&hb("Link",{ackedServerIp:"",destServerIp:"",ec:n_.t0.code||1,sc:n_.t0.serverCode,elapse:ib(this.session&&this.session.startTime),lts:U.fromNumber(Date.now()),responseTime:Date.now()-_l,sid:ab(_s),userId:q.uid},null!==(bh=this.context.config.enableCloudProxy)&&void 0!==bh&&bh),this.context.token=void 0,this.context.socketUseProxy=!1,n_.t0;case 28:return n_.prev=28,this.loginPromise=void 0,n_.finish(28);case 31:this.context.socketUseProxy&&this.emit("FallbackProxyConnected"),wn(!1);case 33:case"end":return n_.stop()}},k,this,[[17,22,28,31]])}));return function(k){return f.apply(this,arguments)}}()},{key:"logout",value:function(){var f=J(x.mark(function k(){var q;return x.wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:if(!this.loginPromise){_r.next=3;break}return _r.next=3,this.loginPromise;case 3:if(this.connectionState!==T.DISCONNECTED){_r.next=6;break}throw this.logError("Already in logout state"),new L("Logout failure. The client has already been logged out",fs);case 6:if(this.internalEmitter.emit("LOGOUT"),this.connectionState!==T.ABORTED){_r.next=11;break}return this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'),this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGOUT),_r.abrupt("return");case 11:if(void 0!==this.session){_r.next=14;break}return this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGOUT),_r.abrupt("return");case 14:return hb("Logout",{elapse:ib(this.session.startTime),lts:U.fromNumber(Date.now()),sid:ab(this.session.instanceId),userId:this.context.uid},null!==(q=this.context.config.enableCloudProxy)&&void 0!==q&&q),_r.next=17,this.session.logoutHandler();case 17:this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGOUT),this.log("Log out success");case 19:case"end":return _r.stop()}},k,this)}));return function(){return f.apply(this,arguments)}}()},{key:"logoutSync",value:function(){var f,k=this;if(this.connectionState===T.DISCONNECTED)throw this.logError("Already in logout state"),new L("Logout failure. The client has already been logged out",fs);this.connectionState===T.ABORTED?this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'):void 0!==this.session&&(hb("Logout",{elapse:ib(this.session.startTime),lts:U.fromNumber(Date.now()),sid:ab(this.session.instanceId),userId:this.context.uid},null!==(f=this.context.config.enableCloudProxy)&&void 0!==f&&f),this.session.logoutHandler().then(function(){k.log("Log out success")})),this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGOUT)}},{key:"sendMessageToPeer",value:function(){var f=J(x.mark(function k(q,_r){var _s,ga,_l,bh,n_,_A,r_=this,p_=arguments;return x.wrap(function(I_){for(;;)switch(I_.prev=I_.next){case 0:if(_l=void 0!==(ga=(_s=2<p_.length&&void 0!==p_[2]?p_[2]:{}).enableOfflineMessaging)&&ga,n_=void 0!==(bh=_s.enableHistoricalMessaging)&&bh,Wn(q,Ie),this.connectionState!==T.RECONNECTING){I_.next=5;break}return _A=Date.now(),I_.abrupt("return",new Promise(function(v_,S_){var V_,x_=(V_=J(x.mark(function _0(){var c0;return x.wrap(function(Pv){for(;;)switch(Pv.prev=Pv.next){case 0:if(void 0!==r_.session){Pv.next=2;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 2:return c0=Date.now()-_A,Pv.prev=3,Pv.t0=v_,Pv.next=7,dh({message:q,peerId:_r,toPeer:!0,session:r_.session,errorCodes:{NOT_LOGGED_IN:Hl,TOO_OFTEN:hs},diff:c0,logger:r_.logger,options:{enableHistoricalMessaging:n_,enableOfflineMessaging:_l}});case 7:Pv.t1=Pv.sent,(0,Pv.t0)(Pv.t1),Pv.next=16;break;case 11:Pv.prev=11,Pv.t2=Pv.catch(3),Xa(Pv.t2)&&S_(new gb(he(r_.name,"sendMessageToPeer",1e4),Fl)),ta(Pv.t2)&&S_(Pv.t2),S_(new da("Peer-to-peer message send failure",{code:gs,originalError:Pv.t2}));case 16:return Pv.prev=16,clearTimeout(B_),Pv.finish(16);case 19:case"end":return Pv.stop()}},_0,null,[[3,11,16,19]])})),function(){return V_.apply(this,arguments)});r_.internalEmitter.once("RECONNECTED",x_);var B_=setTimeout(function(){r_.internalEmitter.off("RECONNECTED",x_),S_(new gb(he(r_.name,"sendMessageToPeer",1e4),Fl))},9e3)}));case 5:if(this.connectionState===T.CONNECTED){I_.next=7;break}throw new L("Failed to send the peer-to-peer message. The client is not logged in",Hl);case 7:if(void 0!==this.session){I_.next=9;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return I_.prev=9,I_.next=12,dh({message:q,peerId:_r,toPeer:!0,session:this.session,errorCodes:{NOT_LOGGED_IN:Hl,TOO_OFTEN:hs},diff:0,logger:this.logger,options:{enableHistoricalMessaging:n_,enableOfflineMessaging:_l}});case 12:return I_.abrupt("return",I_.sent);case 15:if(I_.prev=15,I_.t0=I_.catch(9),!Xa(I_.t0)){I_.next=19;break}throw new gb(he(this.name,"sendMessageToPeer",1e4),Fl);case 19:if(!ta(I_.t0)){I_.next=21;break}throw I_.t0;case 21:throw new da("Peer-to-peer message send failure",{code:gs,originalError:I_.t0});case 22:case"end":return I_.stop()}},k,this,[[9,15]])}));return function(k,q){return f.apply(this,arguments)}}()},{key:"createChannel",value:function(f){var k=this;if(!Aa(f))throw new H(["The %s in the arguments is invalid",Object.keys({channelId:f})[0]],VB);return new $F(f,function(){return k.session},this,this.logger)}},{key:"createLocalInvitation",value:function(f){if(!Aa(f))throw new H(["The %s in the arguments is invalid",Object.keys({calleeId:f})[0]],Ec);return this.invitationManager.genLocalInvitation(f)}},{key:"subscribePeersOnlineStatus",value:function(){var f=J(x.mark(function k(q){var _r,_s,ga,bh,n_,_A,r_,p_,I_,v_,S_,x_,B_=this;return x.wrap(function(V_){for(;;)switch(V_.prev=V_.next){case 0:if(this.connectionState===T.CONNECTED){V_.next=2;break}throw new L("The client is not logged in",Il);case 2:if(void 0!==this.session){V_.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(q)&&0!==q.length){V_.next=6;break}throw new H("Invalid arguments: peerIds",Cg);case 6:_r=0;case 7:if(!(_r<q.length)){V_.next=14;break}if(Aa(_s=q[_r])){V_.next=11;break}throw new H(["subscribePeersOnlineStatus peer id %s is invalid",_s],Cg);case 11:_r++,V_.next=7;break;case 14:if(!(512<(ga=q&&q.length?bl(q):[]).length+Object.keys(this.subscribedPeerStatusCache).length+this.pendingPeerStatusSubCount)){V_.next=17;break}throw new lb("Subscribed peers overflows",ks);case 17:return this.pendingPeerStatusSubCount+=ga.length,V_.next=20,this.session.requestSubscribePeersOnlineStatus(ga).toPromise();case 20:bh=V_.sent.errors,this.pendingPeerStatusSubCount-=ga.length,n_=[],_A=[],r_=0;case 26:if(!(r_<bh.length)){V_.next=34;break}if(I_=(p_=bh[r_]).code,"string"==typeof(v_=p_.account)){V_.next=30;break}throw new da("Returned account is invalid",js);case 30:0!==I_&&n_.push(v_);case 31:r_++,V_.next=26;break;case 34:for(S_=0;S_<ga.length;S_++)n_.includes(x_=ga[S_])||(_A.push(x_),this.subscribedPeerStatusCache[x_]=void 0);if(this.session.requestPeersOnlineStatus(_A).pipe(ea(function(_0){return Bc(pl(_0.userInfos,"account"),function(c0){return!!c0.ts})})).subscribe(function(_0){_0=Bc(_0,function(c0,Pv){return B_.subscribedPeerStatusCache[Pv]=c0?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE}),B_.emit("PeersOnlineStatusChanged",_0)}),0===n_.length){V_.next=38;break}throw new da("Subscription failed",js);case 38:case"end":return V_.stop()}},k,this)}));return function(k){return f.apply(this,arguments)}}()},{key:"unsubscribePeersOnlineStatus",value:function(){var f=J(x.mark(function k(q){var _r,_s,ga,_l;return x.wrap(function(n_){for(;;)switch(n_.prev=n_.next){case 0:if(this.connectionState===T.CONNECTED){n_.next=2;break}throw new L("The client is not logged in",Il);case 2:if(void 0!==this.session){n_.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(q)&&0!==q.length){n_.next=6;break}throw new H("Invalid arguments: peerIds",Cg);case 6:_r=0;case 7:if(!(_r<q.length)){n_.next=14;break}if(Aa(_s=q[_r])){n_.next=11;break}throw new H(["subscribePeersOnlineStatus peer id %s is invalid",_s],Cg);case 11:_r++,n_.next=7;break;case 14:if(!(512<q.length)){n_.next=16;break}throw new lb("Unsubscribed peers overflows",ks);case 16:for(ga=q&&q.length?bl(q):[],this.session.requestUnsubscribePeersOnlineStatus(ga),_l=0;_l<ga.length;_l++)delete this.subscribedPeerStatusCache[ga[_l]];case 19:case"end":return n_.stop()}},k,this)}));return function(k){return f.apply(this,arguments)}}()},{key:"queryPeersBySubscriptionOption",value:function(){var f=J(x.mark(function k(q){return x.wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:if(this.connectionState===T.CONNECTED){_r.next=2;break}throw new L("The client is not logged in",Il);case 2:if(q!==S.PeerSubscriptionOption.ONLINE_STATUS){_r.next=4;break}return _r.abrupt("return",Object.keys(this.subscribedPeerStatusCache));case 4:throw new H("Subscription option not supported",Cg);case 5:case"end":return _r.stop()}},k,this)}));return function(k){return f.apply(this,arguments)}}()},{key:"createMessage",value:function(f){return"IMAGE"===f.messageType?wa({width:0,height:0,fileName:"",description:"",thumbnail:new Blob,thumbnailWidth:0,thumbnailHeight:0,size:0},f):"FILE"===f.messageType?wa({fileName:"",description:"",thumbnail:new Blob,size:0},f):f}},{key:"downloadMedia",value:function(){var f=J(x.mark(function k(q){var _r,_s,ga,_l,bh,n_,_A,r_,p_,I_,v_,S_,V_=this,_0=arguments;return x.wrap(function(c0){for(;;)switch(c0.prev=c0.next){case 0:if(_r=1<_0.length&&void 0!==_0[1]?_0[1]:{},"string"==typeof q){c0.next=3;break}throw new H("invalid mediaId format",Jl);case 3:if(c0.prev=3,_s=q.split("z"),ga=ua(_s,3),bh=ga[1],n_=ga[2],_A=(_l=ga[0]).slice(1,65),r_=YE(_A),p_=parseInt(_l.slice(65),10),I_=parseInt(bh,10),v_=parseInt(n_,10),!(Number.isNaN(p_)||Number.isNaN(I_)||Number.isNaN(v_))){c0.next=12;break}throw new H("Invalid mediaId content",Jl);case 12:c0.next=19;break;case 14:if(c0.prev=14,c0.t0=c0.catch(3),!ta(c0.t0)){c0.next=18;break}throw c0.t0;case 18:throw new H("parse mediaId failure",{code:Jl,originalError:c0.t0});case 19:if(this.connectionState===T.CONNECTED){c0.next=21;break}throw new L("The client is not logged in, cannot download",yC);case 21:if(void 0!==this.session){c0.next=23;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 23:return S_=this.mediaTaskManager.addDownloadTask({unit:I_,zone:p_,hashHexStr:_A,size:v_},function(){if(void 0===V_.session)throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});return V_.session.requestFileDownloadIndexGet({hash:r_,zone:p_,unit:I_,size:v_}).toPromise()},_r),c0.next=26,this.mediaTaskManager.waitMediaTask(S_);case 26:return c0.abrupt("return",c0.sent.payload);case 29:case"end":return c0.stop()}},k,this,[[3,14]])}));return function(k){return f.apply(this,arguments)}}()},{key:"createMediaMessageByUploading",value:function(){var f=J(x.mark(function k(q){var _r,_s,ga,_l,bh,n_,_A,r_,p_,I_,v_,S_,x_,B_,V_,_0,c0,Pv,h0,I0,G_,e0,P_,_v,E_=this,L_=arguments;return x.wrap(function(F_){for(;;)switch(F_.prev=F_.next){case 0:if(_s=2<L_.length&&void 0!==L_[2]?L_[2]:{},Hd(_r=1<L_.length&&void 0!==L_[1]?L_[1]:{})){F_.next=4;break}throw new H("Invalid params",Of);case 4:if(ga="thumbnailWidth"in _r||"thumbnailHeight"in _r||"width"in _r||"height"in _r,bh=void 0===(_l=_r.messageType)?ga?"IMAGE":"FILE":_l,_A=void 0===(n_=_r.description)?"":n_,p_=void 0===(r_=_r.fileName)?"":r_,I_=_r.thumbnail,"string"==typeof _r.messageType&&"string"==typeof _A&&"string"==typeof p_&&(Tn(I_)||void 0===I_)&&Tn(q)){F_.next=8;break}throw new H("Invalid message params type",Of);case 8:if(!ga||"FILE"!==bh){F_.next=10;break}throw new H("Invalid message params, unexpected field in RtmFileMessage",Of);case 10:if(!(33554432<(v_=q.size))){F_.next=13;break}throw new lb("The payload size overflow 32 MB",sC);case 13:return F_.next=15,pj(q);case 15:return S_=F_.sent,F_.next=18,XE(S_);case 18:if(x_=F_.sent,this.connectionState===T.CONNECTED){F_.next=21;break}throw new L("The client is not logged in",uC);case 21:if("IMAGE"!==bh){F_.next=29;break}return F_.next=24,Sv(_r,S_);case 24:V_=(B_=F_.sent).height,_0=B_.width,c0=B_.thumbnailWidth,Pv=B_.thumbnailHeight;case 29:return h0=this.mediaTaskManager.addUploadTask({file:new Uint8Array(S_),hash:x_},function(){if(void 0===E_.session)throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});return E_.session.fetchFileUploadIndexGet({hash:x_,size:v_})},function(J_,Y_){if(void 0===E_.session)throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});return E_.session.requestFileUploadIndexSet({hash:x_,unit:J_,servers:Y_}).toPromise()},_s),F_.next=32,this.mediaTaskManager.waitMediaTask(h0);case 32:if(G_=(I0=F_.sent).zone,e0=I0.retUnit,"IMAGE"!==bh){F_.next=38;break}return P_={height:V_,width:_0,fileName:p_,size:v_,description:_A,thumbnail:I_,messageType:bh,thumbnailWidth:c0,thumbnailHeight:Pv,mediaId:"0".concat(et(x_)).concat(G_,"z").concat(e0,"z").concat(v_,"z").concat(V_,"z").concat(_0)},F_.abrupt("return",P_);case 38:return _v={fileName:p_,size:v_,description:_A,mediaId:"0".concat(et(x_)).concat(G_,"z").concat(e0,"z").concat(v_),thumbnail:I_,messageType:bh},F_.abrupt("return",_v);case 40:case"end":return F_.stop()}},k,this)}));return function(k){return f.apply(this,arguments)}}()},{key:"loginImpl",value:function(){var f=J(x.mark(function k(q){var _r,_s,ga,_l,bh,n_,_A,p_=this;return x.wrap(function(I_){for(;;)switch(I_.prev=I_.next){case 0:if(_r=q.uid,_l=void 0===(ga=q.forceLoginTime)?0:ga,bh=_s=q.instanceId,!(void 0!==this.lastLoginTime&&500>Date.now()-this.lastLoginTime)){I_.next=4;break}throw new nE(["The frequency of login exceeded the limit of %d queries per second",2],iC);case 4:if(this.connectionState===T.DISCONNECTED||0!==_l){I_.next=6;break}throw new L("The SDK is either logging in or has logged in the Agora RTM system",gC);case 6:I_.prev=6,this.context.uid=_r,I_.next=13;break;case 10:throw I_.prev=10,I_.t0=I_.catch(6),new H(["The %s in the arguments is invalid",Object.keys({uid:_r})[0]],hi);case 13:return 0===_l&&this.onConnectionStateChanged(T.CONNECTING,Ib.LOGIN),(n_=new ct(this.context,this.logger,!1)).blacklistedIP=this.blacklistedIP,this.session=_A=new cu(this.context,n_,bh,this.logger),_A.on("connectionLost",function(){p_.connectionState===T.CONNECTED&&(p_.onConnectionStateChanged(T.RECONNECTING,Ib.INTERRUPTED),p_.session)&&p_.session.once("userJoined",function(){p_.onConnectionStateChanged(T.CONNECTED,Ib.LOGIN_SUCCESS)})}),_A.on("tokenExpired",function(){p_.emit("TokenExpired")}),_A.once("userDrop",this.userDropHandler),this.session.on("peerTextMessage",function(v_){p_.emit("MessageFromPeer",{text:v_.text,messageType:S.MessageType.TEXT},v_.peerId,v_.properties)}),this.session.on("peerMediaMessage",function(v_){var S_=v_.peerId,x_=v_.properties,B_=v_.messageType;v_=v_.details,"FILE"===B_?p_.emit("MessageFromPeer",{messageType:S.MessageType.FILE,size:parseInt(ra(v_.media_size),10),description:ra(v_.media_description),fileName:ra(v_.media_filename),mediaId:ra(v_.media_id),thumbnail:new Blob([v_.media_thumbnail])},S_,x_):"IMAGE"===B_&&p_.emit("MessageFromPeer",{messageType:S.MessageType.IMAGE,size:parseInt(ra(v_.media_size),10),description:ra(v_.media_description),fileName:ra(v_.media_filename),mediaId:ra(v_.media_id),thumbnail:new Blob([v_.media_thumbnail]),height:parseInt(ra(v_.media_height),10),width:parseInt(ra(v_.media_width),10),thumbnailHeight:parseInt(ra(v_.media_thumbnailheight),10),thumbnailWidth:parseInt(ra(v_.media_thumbnailwidth),10)},S_,x_)}),this.session.on("peerRawMessage",function(v_){p_.emit("MessageFromPeer",{rawMessage:v_.raw,description:v_.desc,messageType:S.MessageType.RAW},v_.peerId,v_.properties)}),_A.on("instanceChanged",function(v_){return bh=v_}),_A.on("peerOnlineStatusChanged",function(v_){var S_=v_.instance.toString()+v_.state,x_=p_.peerStatusSeqLru.get(S_);!x_||v_.seq.greaterThan(x_)?(p_.peerStatusSeqLru.set(S_,v_.seq),v_.state!==p_.subscribedPeerStatusCache[v_.peerId]&&p_.emit("PeersOnlineStatusChanged",m({},v_.peerId,v_.state)),p_.subscribedPeerStatusCache[v_.peerId]=v_.state,clearTimeout(p_.peerUnreachableTimers[S_]),v_.state===S.PeerOnlineState.UNREACHABLE&&(p_.peerUnreachableTimers[S_]=setTimeout(function(){p_.subscribedPeerStatusCache[v_.peerId]===S.PeerOnlineState.UNREACHABLE&&(p_.subscribedPeerStatusCache[v_.peerId]=S.PeerOnlineState.ONLINE,p_.emit("PeersOnlineStatusChanged",m({},v_.peerId,S.PeerOnlineState.ONLINE)))},3e4))):p_.log("peerOnlineStatusChanged dedup for %s, %d",S_,v_.seq.toNumber())}),_A.on("invitationMessage",this.invitationManager.invitationMessageHandler.bind(this.invitationManager)),_A.on("channelAttributesUpdated",function(v_){var S_=v_.channelId;v_=v_.attributeMaps;for(var x_={},B_=0;B_<v_.length;B_++){var V_=v_[B_],_0=V_.key,c0=V_.ms,Pv=V_.value;if(V_=V_.origin,"string"!=typeof _0||!U.isLong(c0)||"string"!=typeof Pv||!Aa(V_))break;x_[_0]=new Blob([Pv]).size}p_.channelAttributesCacheLru.set(S_,x_)}),_A.on("userJoined",function(v_){if(0!==Object.keys(p_.attributes).length){if(void 0===p_.session)return;p_.session.requestSetLocalUserAttributes(p_.attributes,v_).toPromise()}if(0!==p_.attributeDrafts.size)for(var S_=function(V_,_0){var c0=(V_=_0[V_]).attribute;V_.promise.then(function(){void 0!==p_.session&&p_.session.requestSetLocalUserAttributes(c0,v_).toPromise()})},x_=0,B_=Array.from(p_.attributeDrafts);x_<B_.length;x_++)S_(x_,B_);0!==Object.keys(p_.subscribedPeerStatusCache).length&&_A.requestSubscribePeersOnlineStatus(Object.keys(p_.subscribedPeerStatusCache))}),_A.on("banEdgeIP",function(v_){p_.banIP(v_)}),this.lastLoginTime=Date.now(),I_.prev=32,I_.next=35,_A.loginHandler().toPromise();case 35:this.mediaTaskManager.setAuthInfo({ticket:_A.connection.curOpenSockets.filter(function(v_){return void 0!==v_})[0].ticket,instance:_A.instanceId,useNewDomain:.5<=Math.random(),loginOpt:_A.userJoinOptions.toLong()}),I_.next=54;break;case 38:if(I_.prev=38,I_.t1=I_.catch(32),!("loginRespTimeout"===I_.t1.name&&2>_l)){I_.next=47;break}return _A.removeAllListeners(),I_.next=44,this.loginImpl({uid:_r,instanceId:_s,forceLoginTime:_l+1});case 44:return I_.abrupt("return");case 47:if(!Xa(I_.t1)){I_.next=50;break}throw this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGIN_TIMEOUT),new gb(he(this.name,"login",12e3),hC);case 50:if(this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGIN_FAILURE),!ta(I_.t1)){I_.next=53;break}throw I_.t1;case 53:throw new da("Login failure",{code:cs,originalError:I_.t1});case 54:this.onConnectionStateChanged(T.CONNECTED,Ib.LOGIN_SUCCESS);case 55:case"end":return I_.stop()}},k,this,[[6,10],[32,38]])}));return function(k){return f.apply(this,arguments)}}()},{key:"onConnectionStateChanged",value:function(f,k){var q,_r=this;f===T.RECONNECTING&&(this.reconnId+=1),hb("ConnectionStateChange",{elapse:ib(this.session&&this.session.startTime),lts:U.fromNumber(Date.now()),newState:eu[f],oldState:eu[this.connectionState],reason:aG[k],sid:ab(this.session&&this.session.instanceId||U.fromNumber(0)),userId:this.context.uid,reconnId:this.reconnId},null!==(q=this.context.config.enableCloudProxy)&&void 0!==q&&q),this.connectionState===T.RECONNECTING&&f===T.CONNECTED&&(0!==Object.keys(this.subscribedPeerStatusCache).length&&void 0!==this.session&&this.session.requestPeersOnlineStatus(Object.keys(this.subscribedPeerStatusCache)).pipe(ea(function(_s){return Bc(pl(_s.userInfos,"account"),function(ga){return!!ga.ts})})).subscribe(function(_s){_s=Bc(_s,function(ga,_l){return _r.subscribedPeerStatusCache[_l]=ga?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE}),_r.emit("PeersOnlineStatusChanged",_s)}),this.internalEmitter.emit("RECONNECTED")),this.connectionState=f,f!==T.ABORTED&&f!==T.DISCONNECTED||(this.pendingPeerStatusSubCount=this.reconnId=0,this.attributes={},this.session&&(this.session.removeAllListeners(),this.session.msgDedupLru.empty(),this.session.dialogueSequenceLru.empty(),this.session.dialPendingMsgSubjectMap.clear()),this.channelAttributesCacheLru.empty(),this.peerStatusSeqLru.empty(),this.peerUnreachableTimers={},this.subscribedPeerStatusCache={},this.attributeDrafts.clear(),this.context.token=void 0),this.mediaTaskManager.emit("connectionStateChanged",f),this.emit("ConnectionStateChanged",f,k)}},{key:"banIP",value:function(f){var k;this.log("ip banned",f);var q=null!==(k=this.blacklistedIP[f])&&void 0!==k?k:0;this.blacklistedIP[f]=q+1}}]),l}(wb()),la(E.prototype,"renewToken",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"renewToken"),E.prototype),la(E.prototype,"queryPeersOnlineStatus",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"queryPeersOnlineStatus"),E.prototype),la(E.prototype,"getChannelMemberCount",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"getChannelMemberCount"),E.prototype),la(E.prototype,"setLocalUserAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"setLocalUserAttributes"),E.prototype),la(E.prototype,"setChannelAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"setChannelAttributes"),E.prototype),la(E.prototype,"addOrUpdateLocalUserAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"addOrUpdateLocalUserAttributes"),E.prototype),la(E.prototype,"addOrUpdateChannelAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"addOrUpdateChannelAttributes"),E.prototype),la(E.prototype,"deleteLocalUserAttributesByKeys",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"deleteLocalUserAttributesByKeys"),E.prototype),la(E.prototype,"deleteChannelAttributesByKeys",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"deleteChannelAttributesByKeys"),E.prototype),la(E.prototype,"clearLocalUserAttributes",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"clearLocalUserAttributes"),E.prototype),la(E.prototype,"clearChannelAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"clearChannelAttributes"),E.prototype),la(E.prototype,"getUserAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"getUserAttributes"),E.prototype),la(E.prototype,"getChannelAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"getChannelAttributes"),E.prototype),la(E.prototype,"getChannelAttributesByKeys",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"getChannelAttributesByKeys"),E.prototype),la(E.prototype,"getUserAttributesByKeys",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"getUserAttributesByKeys"),E.prototype),la(E.prototype,"login",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"login"),E.prototype),la(E.prototype,"logout",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"logout"),E.prototype),la(E.prototype,"logoutSync",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"logoutSync"),E.prototype),la(E.prototype,"sendMessageToPeer",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"sendMessageToPeer"),E.prototype),la(E.prototype,"createChannel",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"createChannel"),E.prototype),la(E.prototype,"createLocalInvitation",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"createLocalInvitation"),E.prototype),la(E.prototype,"subscribePeersOnlineStatus",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"subscribePeersOnlineStatus"),E.prototype),la(E.prototype,"unsubscribePeersOnlineStatus",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"unsubscribePeersOnlineStatus"),E.prototype),la(E.prototype,"queryPeersBySubscriptionOption",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"queryPeersBySubscriptionOption"),E.prototype),la(E.prototype,"createMessage",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"createMessage"),E.prototype),la(E.prototype,"downloadMedia",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"downloadMedia"),E.prototype),la(E.prototype,"createMediaMessageByUploading",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"createMediaMessageByUploading"),E.prototype),E),pm,qm,rm,sm,fu=null===(pm=/Chrome\/([0-9.]+)/.exec(null===(rm=window)||void 0===rm||null===(sm=rm.navigator)||void 0===sm?void 0:sm.userAgent))||void 0===pm||null===(qm=pm[1])||void 0===qm?void 0:qm.split(".")[0];if(fu&&88<=parseInt(fu,10)&&!pe()){var tm,me=document.createElement("video"),ne=document.createElement("canvas");me.setAttribute("style","display:none"),me.setAttribute("muted",""),me.muted=!0,me.setAttribute("autoplay",""),me.autoplay=!0,me.setAttribute("playsinline",""),ne.setAttribute("style","display:none"),ne.setAttribute("width","1"),ne.setAttribute("height","1"),null===(tm=ne.getContext("2d"))||void 0===tm||tm.fillRect(0,0,1,1),me.srcObject=null==ne?void 0:ne.captureStream()}var gu={LOG_FILTER_OFF:{error:!1,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_ERROR:{error:!0,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_WARNING:{error:!0,warn:!0,info:!1,track:!1,debug:!1},LOG_FILTER_INFO:{error:!0,warn:!0,info:!0,track:!1,debug:!1},LOG_FILTER_DEBUG:{error:!0,warn:!0,info:!0,track:!0,debug:!0}},hu={enableLogUpload:!1,logFilter:gu.LOG_FILTER_INFO,enableCloudProxy:!1},ie=wa(wa({createInstance:function(h){var l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},g=2<arguments.length?arguments[2]:void 0;if(!/^[\dA-Za-z]{32}$/.test(h))throw new H(["The %s in the arguments is invalid",Object.keys({appId:h})[0]],Rr);var f=Object.keys(l).filter(function(bh){return!(bh in hu)});if(0!==f.length)throw new H("Invalid RTM config: ".concat(f.join(", ")),Rr);var k=wa(wa({},hu),l);if(void 0!==g&&(!Array.isArray(g)||0===g.length))throw new H("Invalid area config");if(null!=g){if(!g.every(function(bh){return bh in S.LegacyAreaCode}))throw new H("Invalid area codes: ".concat(g.filter(function(bh){return!(bh in S)}).join(", ")));P=Ke(g.map(function(bh){return vE[bh]}))}g=Ql=Ka.__global_unique_id__=(Ka.__global_unique_id__||0)+1;var q=zE(k);f=AE(k);var _r=BE(k),_s=CE(g,k),ga=Xs(g,k),_l=ga("RTM:DEBUG","<Entry> ");return Qs.rtmConfig=k,q("The Agora RTM Web SDK version is %s","1.4.5"),l.enableCloudProxy&&q("RTM cloud proxy enabled"),l.enableLogUpload&&q("Log upload enabled"),P&&_l("Area is set to %s",Array.from(P.CODES).map(function(bh){return Pf(D).find(function(n_){return D[n_]===bh})}).join(", ")),_l("Creating an RtmClient instance"),_l('The Git commit ID is "'.concat("v1.4.5-0-g9cf39592",'"')),_l("The App ID is %s",Xn(h,4,10,"*".repeat(6))),q("The process ID is %s",zg),_l("The build is %s","v1.4.5-0-g9cf39592"),_l("NODE_ENV is %s","production"),new bG(h,{genLogger:ga,genTracker:_s,info:q,warn:f,logError:_r,loggerId:g},k,function(bh){for(var n_=0,_A=Pf(bh);n_<_A.length;n_++){var r_=_A[n_];try{var p_=bh[r_];null!=p_&&(bh.enableCloudProxy&&q("RTM cloud proxy enabled"),bh.enableLogUpload&&q("Log upload enabled"),k[r_]=p_)}catch(I_){throw new H(["The %s in the arguments is invalid",r_],void 0)}}})},BUILD:"v1.4.5-0-g9cf39592",VERSION:"1.4.5",END_CALL_PREFIX:"AgoraRTMLegacyEndcallCompatibleMessagePrefix",processId:zg,ConnectionChangeReason:S.ConnectionChangeReason,ConnectionState:S.ConnectionState,LocalInvitationFailureReason:S.LocalInvitationFailureReason,LocalInvitationState:S.LocalInvitationState,RemoteInvitationFailureReason:S.RemoteInvitationFailureReason,RemoteInvitationState:S.RemoteInvitationState,MessageType:S.MessageType,PeerOnlineState:S.PeerOnlineState,PeerSubscriptionOption:S.PeerSubscriptionOption},gu),{},{setParameter:function(h,l){Object.keys(lc).includes(h)&&(lc[h]=l)},getParameter:function(h){return lc[h]},setArea:function(h){var l=h.areaCodes;if(h=h.excludedArea,!Array.isArray(l)||0===l.length||!l.every(function(g){return g in S.AreaCode}))throw new H("Invalid area config");if(void 0!==h&&h===S.AreaCode.GLOBAL)throw new H("Excluded area cannot be global");if(void 0===h)P=Ke(l.map(function(g){return D[g]}));else{if(l.includes(h))throw new H("Excluded area cannot be in areaCodes");if(!(h in D))throw new H("Invalid excludedArea:",h);P=Xv({areas:l.map(function(g){return D[g]}),excludedArea:D[h]})}}});return ie},module.exports=l()},5867:(h,l,g)=>{"use strict";g.d(l,{C6:()=>f.getApps,Mq:()=>f.getApp});var f=g(9681);(0,f.registerVersion)("firebase","9.8.1","app")},127:(h,l,g)=>{"use strict";g.d(l,{Z:()=>f.Z});var f=g(3942);f.Z.registerVersion("firebase","9.8.1","app-compat")},7092:(h,l,g)=>{"use strict";g.r(l);var f=g(5861),k=g(3942),q=g(2090),_r=g(9681),_s=g(655),ga=g(1877),_l=g(4859);const S_=function I_(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},x_=function v_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},B_=new q.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),_0=new ga.Yd("@firebase/auth");function c0(Nf,..._c){_0.logLevel<=ga.in.ERROR&&_0.error(`Auth (${_r.SDK_VERSION}): ${Nf}`,..._c)}function Pv(Nf,..._c){throw e0(Nf,..._c)}function h0(Nf,..._c){return e0(Nf,..._c)}function I0(Nf,_c,ah){const _m=Object.assign(Object.assign({},x_()),{[_c]:ah});return new q.LL("auth","Firebase",_m).create(_c,{appName:Nf.name})}function G_(Nf,_c,ah){if(!(_c instanceof ah))throw ah.name!==_c.constructor.name&&Pv(Nf,"argument-error"),I0(Nf,"argument-error",`Type of ${_c.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function e0(Nf,..._c){if("string"!=typeof Nf){const ah=_c[0],_m=[..._c.slice(1)];return _m[0]&&(_m[0].appName=Nf.name),Nf._errorFactory.create(ah,..._m)}return B_.create(Nf,..._c)}function P_(Nf,_c,...ah){if(!Nf)throw e0(_c,...ah)}function _v(Nf){const _c="INTERNAL ASSERTION FAILED: "+Nf;throw c0(_c),new Error(_c)}function E_(Nf,_c){Nf||_v(_c)}const L_=new Map;function F_(Nf){E_(Nf instanceof Function,"Expected a class definition");let _c=L_.get(Nf);return _c?(E_(_c instanceof Nf,"Instance stored in cache mismatched with class"),_c):(_c=new Nf,L_.set(Nf,_c),_c)}function D0(){var Nf;return"undefined"!=typeof self&&(null===(Nf=self.location)||void 0===Nf?void 0:Nf.href)||""}function O0(){return"http:"===EI()||"https:"===EI()}function EI(){var Nf;return"undefined"!=typeof self&&(null===(Nf=self.location)||void 0===Nf?void 0:Nf.protocol)||null}class x1{constructor(_c,ah){this.shortDelay=_c,this.longDelay=ah,E_(ah>_c,"Short delay should be less than long delay!"),this.isMobile=(0,q.uI)()||(0,q.b$)()}get(){return function eI(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(O0()||(0,q.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function _1(Nf,_c){E_(Nf.emulator,"Emulator should always be set here");const{url:ah}=Nf.emulator;return _c?`${ah}${_c.startsWith("/")?_c.slice(1):_c}`:ah}class UI{static initialize(_c,ah,_m){this.fetchImpl=_c,ah&&(this.headersImpl=ah),_m&&(this.responseImpl=_m)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void _v("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void _v("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void _v("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Z1={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},sT=new x1(3e4,6e4);function L1(Nf,_c){return Nf.tenantId&&!_c.tenantId?Object.assign(Object.assign({},_c),{tenantId:Nf.tenantId}):_c}function w1(Nf,_c,ah,_m){return SN.apply(this,arguments)}function SN(){return(SN=(0,f.Z)(function*(Nf,_c,ah,_m,m_={}){return _T(Nf,m_,(0,f.Z)(function*(){let O_={},s0={};_m&&("GET"===_c?s0=_m:O_={body:JSON.stringify(_m)});const N0=(0,q.xO)(Object.assign({key:Nf.config.apiKey},s0)).slice(1),tI=yield Nf._getAdditionalHeaders();return tI["Content-Type"]="application/json",Nf.languageCode&&(tI["X-Firebase-Locale"]=Nf.languageCode),UI.fetch()(RN(Nf,Nf.config.apiHost,ah,N0),Object.assign({method:_c,headers:tI,referrerPolicy:"no-referrer"},O_))}))})).apply(this,arguments)}function _T(Nf,_c,ah){return NT.apply(this,arguments)}function NT(){return(NT=(0,f.Z)(function*(Nf,_c,ah){Nf._canInitEmulator=!1;const _m=Object.assign(Object.assign({},Z1),_c);try{const m_=new jR(Nf),O_=yield Promise.race([ah(),m_.promise]);m_.clearNetworkTimeout();const s0=yield O_.json();if("needConfirmation"in s0)throw ZO(Nf,"account-exists-with-different-credential",s0);if(O_.ok&&!("errorMessage"in s0))return s0;{const N0=O_.ok?s0.errorMessage:s0.error.message,[tI,AI]=N0.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===tI)throw ZO(Nf,"credential-already-in-use",s0);if("EMAIL_EXISTS"===tI)throw ZO(Nf,"email-already-in-use",s0);const VI=_m[tI]||tI.toLowerCase().replace(/[_\s]+/g,"-");if(AI)throw I0(Nf,VI,AI);Pv(Nf,VI)}}catch(m_){if(m_ instanceof q.ZR)throw m_;Pv(Nf,"network-request-failed")}})).apply(this,arguments)}function YT(Nf,_c,ah,_m){return $O.apply(this,arguments)}function $O(){return($O=(0,f.Z)(function*(Nf,_c,ah,_m,m_={}){const O_=yield w1(Nf,_c,ah,_m,m_);return"mfaPendingCredential"in O_&&Pv(Nf,"multi-factor-auth-required",{_serverResponse:O_}),O_})).apply(this,arguments)}function RN(Nf,_c,ah,_m){const m_=`${_c}${ah}?${_m}`;return Nf.config.emulator?_1(Nf.config,m_):`${Nf.config.apiScheme}://${m_}`}class jR{constructor(_c){this.auth=_c,this.timer=null,this.promise=new Promise((ah,_m)=>{this.timer=setTimeout(()=>_m(h0(this.auth,"network-request-failed")),sT.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ZO(Nf,_c,ah){const _m={appName:Nf.name};ah.email&&(_m.email=ah.email),ah.phoneNumber&&(_m.phoneNumber=ah.phoneNumber);const m_=h0(Nf,_c,_m);return m_.customData._tokenResponse=ah,m_}function dO(){return(dO=(0,f.Z)(function*(Nf,_c){return w1(Nf,"POST","/v1/accounts:delete",_c)})).apply(this,arguments)}function TT(Nf,_c){return GT.apply(this,arguments)}function GT(){return(GT=(0,f.Z)(function*(Nf,_c){return w1(Nf,"POST","/v1/accounts:update",_c)})).apply(this,arguments)}function dP(Nf,_c){return VR.apply(this,arguments)}function VR(){return(VR=(0,f.Z)(function*(Nf,_c){return w1(Nf,"POST","/v1/accounts:lookup",_c)})).apply(this,arguments)}function IS(Nf){if(Nf)try{const _c=new Date(Number(Nf));if(!isNaN(_c.getTime()))return _c.toUTCString()}catch(_c){}}function _x(){return(_x=(0,f.Z)(function*(Nf,_c=!1){const ah=(0,q.m9)(Nf),_m=yield ah.getIdToken(_c),m_=kI(_m);P_(m_&&m_.exp&&m_.auth_time&&m_.iat,ah.auth,"internal-error");const O_="object"==typeof m_.firebase?m_.firebase:void 0,s0=null==O_?void 0:O_.sign_in_provider;return{claims:m_,token:_m,authTime:IS(M1(m_.auth_time)),issuedAtTime:IS(M1(m_.iat)),expirationTime:IS(M1(m_.exp)),signInProvider:s0||null,signInSecondFactor:(null==O_?void 0:O_.sign_in_second_factor)||null}})).apply(this,arguments)}function M1(Nf){return 1e3*Number(Nf)}function kI(Nf){const[_c,ah,_m]=Nf.split(".");if(void 0===_c||void 0===ah||void 0===_m)return c0("JWT malformed, contained fewer than 3 sections"),null;try{const m_=(0,q.tV)(ah);return m_?JSON.parse(m_):(c0("Failed to decode base64 JWT payload"),null)}catch(m_){return c0("Caught error parsing JWT payload as JSON",m_),null}}function gR(Nf,_c){return rR.apply(this,arguments)}function rR(){return(rR=(0,f.Z)(function*(Nf,_c,ah=!1){if(ah)return _c;try{return yield _c}catch(_m){throw _m instanceof q.ZR&&D1(_m)&&Nf.auth.currentUser===Nf&&(yield Nf.auth.signOut()),_m}})).apply(this,arguments)}function D1({code:Nf}){return"auth/user-disabled"===Nf||"auth/user-token-expired"===Nf}class eL{constructor(_c){this.user=_c,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(_c){var ah;if(_c){const _m=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),_m}{this.errorBackoff=3e4;const m_=(null!==(ah=this.user.stsTokenManager.expirationTime)&&void 0!==ah?ah:0)-Date.now()-3e5;return Math.max(0,m_)}}schedule(_c=!1){var ah=this;if(!this.isRunning)return;const _m=this.getInterval(_c);this.timerId=setTimeout((0,f.Z)(function*(){yield ah.iteration()}),_m)}iteration(){var _c=this;return(0,f.Z)(function*(){try{yield _c.user.getIdToken(!0)}catch(ah){return void("auth/network-request-failed"===ah.code&&_c.schedule(!0))}_c.schedule()})()}}class mR{constructor(_c,ah){this.createdAt=_c,this.lastLoginAt=ah,this._initializeTime()}_initializeTime(){this.lastSignInTime=IS(this.lastLoginAt),this.creationTime=IS(this.createdAt)}_copy(_c){this.createdAt=_c.createdAt,this.lastLoginAt=_c.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function $T(Nf){return $_.apply(this,arguments)}function $_(){return($_=(0,f.Z)(function*(Nf){var _c;const ah=Nf.auth,_m=yield Nf.getIdToken(),m_=yield gR(Nf,dP(ah,{idToken:_m}));P_(null==m_?void 0:m_.users.length,ah,"internal-error");const O_=m_.users[0];Nf._notifyReloadListener(O_);const s0=(null===(_c=O_.providerUserInfo)||void 0===_c?void 0:_c.length)?_y(O_.providerUserInfo):[],N0=M0(Nf.providerData,s0),VI=!!Nf.isAnonymous&&!(Nf.email&&O_.passwordHash||(null==N0?void 0:N0.length)),GI={uid:O_.localId,displayName:O_.displayName||null,photoURL:O_.photoUrl||null,email:O_.email||null,emailVerified:O_.emailVerified||!1,phoneNumber:O_.phoneNumber||null,tenantId:O_.tenantId||null,providerData:N0,metadata:new mR(O_.createdAt,O_.lastLoginAt),isAnonymous:VI};Object.assign(Nf,GI)})).apply(this,arguments)}function r0(){return(r0=(0,f.Z)(function*(Nf){const _c=(0,q.m9)(Nf);yield $T(_c),yield _c.auth._persistUserIfCurrent(_c),_c.auth._notifyListenersIfCurrent(_c)})).apply(this,arguments)}function M0(Nf,_c){return[...Nf.filter(_m=>!_c.some(m_=>m_.providerId===_m.providerId)),..._c]}function _y(Nf){return Nf.map(_c=>{var{providerId:ah}=_c,_m=(0,_s._T)(_c,["providerId"]);return{providerId:ah,uid:_m.rawId||"",displayName:_m.displayName||null,email:_m.email||null,phoneNumber:_m.phoneNumber||null,photoURL:_m.photoUrl||null}})}function G0(){return(G0=(0,f.Z)(function*(Nf,_c){const ah=yield _T(Nf,{},(0,f.Z)(function*(){const _m=(0,q.xO)({grant_type:"refresh_token",refresh_token:_c}).slice(1),{tokenApiHost:m_,apiKey:O_}=Nf.config,s0=RN(Nf,m_,"/v1/token",`key=${O_}`),N0=yield Nf._getAdditionalHeaders();return N0["Content-Type"]="application/x-www-form-urlencoded",UI.fetch()(s0,{method:"POST",headers:N0,body:_m})}));return{accessToken:ah.access_token,expiresIn:ah.expires_in,refreshToken:ah.refresh_token}})).apply(this,arguments)}class yI{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(_c){P_(_c.idToken,"internal-error"),P_(void 0!==_c.idToken,"internal-error"),P_(void 0!==_c.refreshToken,"internal-error");const ah="expiresIn"in _c&&void 0!==_c.expiresIn?Number(_c.expiresIn):function JI(Nf){const _c=kI(Nf);return P_(_c,"internal-error"),P_(void 0!==_c.exp,"internal-error"),P_(void 0!==_c.iat,"internal-error"),Number(_c.exp)-Number(_c.iat)}(_c.idToken);this.updateTokensAndExpiration(_c.idToken,_c.refreshToken,ah)}getToken(_c,ah=!1){var _m=this;return(0,f.Z)(function*(){return P_(!_m.accessToken||_m.refreshToken,_c,"user-token-expired"),ah||!_m.accessToken||_m.isExpired?_m.refreshToken?(yield _m.refresh(_c,_m.refreshToken),_m.accessToken):null:_m.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(_c,ah){var _m=this;return(0,f.Z)(function*(){const{accessToken:m_,refreshToken:O_,expiresIn:s0}=yield function m0(Nf,_c){return G0.apply(this,arguments)}(_c,ah);_m.updateTokensAndExpiration(m_,O_,Number(s0))})()}updateTokensAndExpiration(_c,ah,_m){this.refreshToken=ah||null,this.accessToken=_c||null,this.expirationTime=Date.now()+1e3*_m}static fromJSON(_c,ah){const{refreshToken:_m,accessToken:m_,expirationTime:O_}=ah,s0=new yI;return _m&&(P_("string"==typeof _m,"internal-error",{appName:_c}),s0.refreshToken=_m),m_&&(P_("string"==typeof m_,"internal-error",{appName:_c}),s0.accessToken=m_),O_&&(P_("number"==typeof O_,"internal-error",{appName:_c}),s0.expirationTime=O_),s0}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(_c){this.accessToken=_c.accessToken,this.refreshToken=_c.refreshToken,this.expirationTime=_c.expirationTime}_clone(){return Object.assign(new yI,this.toJSON())}_performRefresh(){return _v("not implemented")}}function qI(Nf,_c){P_("string"==typeof Nf||void 0===Nf,"internal-error",{appName:_c})}class XI{constructor(_c){var{uid:ah,auth:_m,stsTokenManager:m_}=_c,O_=(0,_s._T)(_c,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new eL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=ah,this.auth=_m,this.stsTokenManager=m_,this.accessToken=m_.accessToken,this.displayName=O_.displayName||null,this.email=O_.email||null,this.emailVerified=O_.emailVerified||!1,this.phoneNumber=O_.phoneNumber||null,this.photoURL=O_.photoURL||null,this.isAnonymous=O_.isAnonymous||!1,this.tenantId=O_.tenantId||null,this.providerData=O_.providerData?[...O_.providerData]:[],this.metadata=new mR(O_.createdAt||void 0,O_.lastLoginAt||void 0)}getIdToken(_c){var ah=this;return(0,f.Z)(function*(){const _m=yield gR(ah,ah.stsTokenManager.getToken(ah.auth,_c));return P_(_m,ah.auth,"internal-error"),ah.accessToken!==_m&&(ah.accessToken=_m,yield ah.auth._persistUserIfCurrent(ah),ah.auth._notifyListenersIfCurrent(ah)),_m})()}getIdTokenResult(_c){return function SO(Nf){return _x.apply(this,arguments)}(this,_c)}reload(){return function _E(Nf){return r0.apply(this,arguments)}(this)}_assign(_c){this!==_c&&(P_(this.uid===_c.uid,this.auth,"internal-error"),this.displayName=_c.displayName,this.photoURL=_c.photoURL,this.email=_c.email,this.emailVerified=_c.emailVerified,this.phoneNumber=_c.phoneNumber,this.isAnonymous=_c.isAnonymous,this.tenantId=_c.tenantId,this.providerData=_c.providerData.map(ah=>Object.assign({},ah)),this.metadata._copy(_c.metadata),this.stsTokenManager._assign(_c.stsTokenManager))}_clone(_c){return new XI(Object.assign(Object.assign({},this),{auth:_c,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(_c){P_(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=_c,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(_c){this.reloadListener?this.reloadListener(_c):this.reloadUserInfo=_c}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(_c,ah=!1){var _m=this;return(0,f.Z)(function*(){let m_=!1;_c.idToken&&_c.idToken!==_m.stsTokenManager.accessToken&&(_m.stsTokenManager.updateFromServerResponse(_c),m_=!0),ah&&(yield $T(_m)),yield _m.auth._persistUserIfCurrent(_m),m_&&_m.auth._notifyListenersIfCurrent(_m)})()}delete(){var _c=this;return(0,f.Z)(function*(){const ah=yield _c.getIdToken();return yield gR(_c,function KI(Nf,_c){return dO.apply(this,arguments)}(_c.auth,{idToken:ah})),_c.stsTokenManager.clearRefreshToken(),_c.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(_c=>Object.assign({},_c)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(_c,ah){var _m,m_,O_,s0,N0,tI,AI,VI;const GI=null!==(_m=ah.displayName)&&void 0!==_m?_m:void 0,oS=null!==(m_=ah.email)&&void 0!==m_?m_:void 0,FO=null!==(O_=ah.phoneNumber)&&void 0!==O_?O_:void 0,K3=null!==(s0=ah.photoURL)&&void 0!==s0?s0:void 0,FV=null!==(N0=ah.tenantId)&&void 0!==N0?N0:void 0,qG=null!==(tI=ah._redirectEventId)&&void 0!==tI?tI:void 0,yU=null!==(AI=ah.createdAt)&&void 0!==AI?AI:void 0,T5=null!==(VI=ah.lastLoginAt)&&void 0!==VI?VI:void 0,{uid:OT,emailVerified:S5,isAnonymous:qT,providerData:jV,stsTokenManager:WG}=ah;P_(OT&&WG,_c,"internal-error");const z3=yI.fromJSON(this.name,WG);P_("string"==typeof OT,_c,"internal-error"),qI(GI,_c.name),qI(oS,_c.name),P_("boolean"==typeof S5,_c,"internal-error"),P_("boolean"==typeof qT,_c,"internal-error"),qI(FO,_c.name),qI(K3,_c.name),qI(FV,_c.name),qI(qG,_c.name),qI(yU,_c.name),qI(T5,_c.name);const R5=new XI({uid:OT,auth:_c,email:oS,emailVerified:S5,displayName:GI,isAnonymous:qT,photoURL:K3,phoneNumber:FO,tenantId:FV,stsTokenManager:z3,createdAt:yU,lastLoginAt:T5});return jV&&Array.isArray(jV)&&(R5.providerData=jV.map(rT=>Object.assign({},rT))),qG&&(R5._redirectEventId=qG),R5}static _fromIdTokenResponse(_c,ah,_m=!1){return(0,f.Z)(function*(){const m_=new yI;m_.updateFromServerResponse(ah);const O_=new XI({uid:ah.localId,auth:_c,stsTokenManager:m_,isAnonymous:_m});return yield $T(O_),O_})()}}const _b=(()=>{class Nf{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,f.Z)(function*(){return!0})()}_set(ah,_m){var m_=this;return(0,f.Z)(function*(){m_.storage[ah]=_m})()}_get(ah){var _m=this;return(0,f.Z)(function*(){const m_=_m.storage[ah];return void 0===m_?null:m_})()}_remove(ah){var _m=this;return(0,f.Z)(function*(){delete _m.storage[ah]})()}_addListener(ah,_m){}_removeListener(ah,_m){}}return Nf.type="NONE",Nf})();function ZT(Nf,_c,ah){return`firebase:${Nf}:${_c}:${ah}`}class AR{constructor(_c,ah,_m){this.persistence=_c,this.auth=ah,this.userKey=_m;const{config:m_,name:O_}=this.auth;this.fullUserKey=ZT(this.userKey,m_.apiKey,O_),this.fullPersistenceKey=ZT("persistence",m_.apiKey,O_),this.boundEventHandler=ah._onStorageEvent.bind(ah),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(_c){return this.persistence._set(this.fullUserKey,_c.toJSON())}getCurrentUser(){var _c=this;return(0,f.Z)(function*(){const ah=yield _c.persistence._get(_c.fullUserKey);return ah?XI._fromJSON(_c.auth,ah):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(_c){var ah=this;return(0,f.Z)(function*(){if(ah.persistence===_c)return;const _m=yield ah.getCurrentUser();return yield ah.removeCurrentUser(),ah.persistence=_c,_m?ah.setCurrentUser(_m):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(_c,ah,_m="authUser"){return(0,f.Z)(function*(){if(!ah.length)return new AR(F_(_b),_c,_m);const m_=(yield Promise.all(ah.map(function(){var AI=(0,f.Z)(function*(VI){if(yield VI._isAvailable())return VI});return function(VI){return AI.apply(this,arguments)}}()))).filter(AI=>AI);let O_=m_[0]||F_(_b);const s0=ZT(_m,_c.config.apiKey,_c.name);let N0=null;for(const AI of ah)try{const VI=yield AI._get(s0);if(VI){const GI=XI._fromJSON(_c,VI);AI!==O_&&(N0=GI),O_=AI;break}}catch(VI){}const tI=m_.filter(AI=>AI._shouldAllowMigration);return O_._shouldAllowMigration&&tI.length?(O_=tI[0],N0&&(yield O_._set(s0,N0.toJSON())),yield Promise.all(ah.map(function(){var AI=(0,f.Z)(function*(VI){if(VI!==O_)try{yield VI._remove(s0)}catch(GI){}});return function(VI){return AI.apply(this,arguments)}}())),new AR(O_,_c,_m)):new AR(O_,_c,_m)})()}}function g3(Nf){const _c=Nf.toLowerCase();if(_c.includes("opera/")||_c.includes("opr/")||_c.includes("opios/"))return"Opera";if(bS(_c))return"IEMobile";if(_c.includes("msie")||_c.includes("trident/"))return"IE";if(_c.includes("edge/"))return"Edge";if(YM(_c))return"Firefox";if(_c.includes("silk/"))return"Silk";if(g2(_c))return"Blackberry";if(CS(_c))return"Webos";if(ON(_c))return"Safari";if((_c.includes("chrome/")||JM(_c))&&!_c.includes("edge/"))return"Chrome";if(X1(_c))return"Android";{const _m=Nf.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===(null==_m?void 0:_m.length))return _m[1]}return"Other"}function YM(Nf=(0,q.z$)()){return/firefox\//i.test(Nf)}function ON(Nf=(0,q.z$)()){const _c=Nf.toLowerCase();return _c.includes("safari/")&&!_c.includes("chrome/")&&!_c.includes("crios/")&&!_c.includes("android")}function JM(Nf=(0,q.z$)()){return/crios\//i.test(Nf)}function bS(Nf=(0,q.z$)()){return/iemobile/i.test(Nf)}function X1(Nf=(0,q.z$)()){return/android/i.test(Nf)}function g2(Nf=(0,q.z$)()){return/blackberry/i.test(Nf)}function CS(Nf=(0,q.z$)()){return/webos/i.test(Nf)}function hO(Nf=(0,q.z$)()){return/iphone|ipad|ipod/i.test(Nf)}function hP(Nf=(0,q.z$)()){return hO(Nf)||X1(Nf)||CS(Nf)||g2(Nf)||/windows phone/i.test(Nf)||bS(Nf)}function $L(Nf,_c=[]){let ah;switch(Nf){case"Browser":ah=g3((0,q.z$)());break;case"Worker":ah=`${g3((0,q.z$)())}-${Nf}`;break;default:ah=Nf}const _m=_c.length?_c.join(","):"FirebaseCore-web";return`${ah}/JsCore/${_r.SDK_VERSION}/${_m}`}class GR{constructor(_c){this.auth=_c,this.queue=[]}pushCallback(_c,ah){const _m=O_=>new Promise((s0,N0)=>{try{s0(_c(O_))}catch(tI){N0(tI)}});_m.onAbort=ah,this.queue.push(_m);const m_=this.queue.length-1;return()=>{this.queue[m_]=()=>Promise.resolve()}}runMiddleware(_c){var ah=this;return(0,f.Z)(function*(){if(ah.auth.currentUser===_c)return;const _m=[];try{for(const m_ of ah.queue)yield m_(_c),m_.onAbort&&_m.push(m_.onAbort)}catch(m_){_m.reverse();for(const O_ of _m)try{O_()}catch(s0){}throw ah.auth._errorFactory.create("login-blocked",{originalMessage:m_.message})}})()}}class dI{constructor(_c,ah,_m){this.app=_c,this.heartbeatServiceProvider=ah,this.config=_m,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new B1(this),this.idTokenSubscription=new B1(this),this.beforeStateQueue=new GR(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=B_,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=_c.name,this.clientVersion=_m.sdkClientVersion}_initializeWithPersistence(_c,ah){var _m=this;return ah&&(this._popupRedirectResolver=F_(ah)),this._initializationPromise=this.queue((0,f.Z)(function*(){var m_,O_;if(!_m._deleted&&(_m.persistenceManager=yield AR.create(_m,_c),!_m._deleted)){if(null===(m_=_m._popupRedirectResolver)||void 0===m_?void 0:m_._shouldInitProactively)try{yield _m._popupRedirectResolver._initialize(_m)}catch(s0){}yield _m.initializeCurrentUser(ah),_m.lastNotifiedUid=(null===(O_=_m.currentUser)||void 0===O_?void 0:O_.uid)||null,!_m._deleted&&(_m._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var _c=this;return(0,f.Z)(function*(){if(_c._deleted)return;const ah=yield _c.assertedPersistence.getCurrentUser();if(_c.currentUser||ah){if(_c.currentUser&&ah&&_c.currentUser.uid===ah.uid)return _c._currentUser._assign(ah),void(yield _c.currentUser.getIdToken());yield _c._updateCurrentUser(ah,!0)}})()}initializeCurrentUser(_c){var ah=this;return(0,f.Z)(function*(){var _m;const m_=yield ah.assertedPersistence.getCurrentUser();let O_=m_,s0=!1;if(_c&&ah.config.authDomain){yield ah.getOrInitRedirectPersistenceManager();const N0=null===(_m=ah.redirectUser)||void 0===_m?void 0:_m._redirectEventId,tI=null==O_?void 0:O_._redirectEventId,AI=yield ah.tryRedirectSignIn(_c);(!N0||N0===tI)&&(null==AI?void 0:AI.user)&&(O_=AI.user,s0=!0)}if(!O_)return ah.directlySetCurrentUser(null);if(!O_._redirectEventId){if(s0)try{yield ah.beforeStateQueue.runMiddleware(O_)}catch(N0){O_=m_,ah._popupRedirectResolver._overrideRedirectResult(ah,()=>Promise.reject(N0))}return O_?ah.reloadAndSetCurrentUserOrClear(O_):ah.directlySetCurrentUser(null)}return P_(ah._popupRedirectResolver,ah,"argument-error"),yield ah.getOrInitRedirectPersistenceManager(),ah.redirectUser&&ah.redirectUser._redirectEventId===O_._redirectEventId?ah.directlySetCurrentUser(O_):ah.reloadAndSetCurrentUserOrClear(O_)})()}tryRedirectSignIn(_c){var ah=this;return(0,f.Z)(function*(){let _m=null;try{_m=yield ah._popupRedirectResolver._completeRedirectFn(ah,_c,!0)}catch(m_){yield ah._setRedirectUser(null)}return _m})()}reloadAndSetCurrentUserOrClear(_c){var ah=this;return(0,f.Z)(function*(){try{yield $T(_c)}catch(_m){if("auth/network-request-failed"!==_m.code)return ah.directlySetCurrentUser(null)}return ah.directlySetCurrentUser(_c)})()}useDeviceLanguage(){this.languageCode=function Y0(){if("undefined"==typeof navigator)return null;const Nf=navigator;return Nf.languages&&Nf.languages[0]||Nf.language||null}()}_delete(){var _c=this;return(0,f.Z)(function*(){_c._deleted=!0})()}updateCurrentUser(_c){var ah=this;return(0,f.Z)(function*(){const _m=_c?(0,q.m9)(_c):null;return _m&&P_(_m.auth.config.apiKey===ah.config.apiKey,ah,"invalid-user-token"),ah._updateCurrentUser(_m&&_m._clone(ah))})()}_updateCurrentUser(_c,ah=!1){var _m=this;return(0,f.Z)(function*(){if(!_m._deleted)return _c&&P_(_m.tenantId===_c.tenantId,_m,"tenant-id-mismatch"),ah||(yield _m.beforeStateQueue.runMiddleware(_c)),_m.queue((0,f.Z)(function*(){yield _m.directlySetCurrentUser(_c),_m.notifyAuthListeners()}))})()}signOut(){var _c=this;return(0,f.Z)(function*(){return yield _c.beforeStateQueue.runMiddleware(null),(_c.redirectPersistenceManager||_c._popupRedirectResolver)&&(yield _c._setRedirectUser(null)),_c._updateCurrentUser(null,!0)})()}setPersistence(_c){var ah=this;return this.queue((0,f.Z)(function*(){yield ah.assertedPersistence.setPersistence(F_(_c))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(_c){this._errorFactory=new q.LL("auth","Firebase",_c())}onAuthStateChanged(_c,ah,_m){return this.registerStateListener(this.authStateSubscription,_c,ah,_m)}beforeAuthStateChanged(_c,ah){return this.beforeStateQueue.pushCallback(_c,ah)}onIdTokenChanged(_c,ah,_m){return this.registerStateListener(this.idTokenSubscription,_c,ah,_m)}toJSON(){var _c;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(_c=this._currentUser)||void 0===_c?void 0:_c.toJSON()}}_setRedirectUser(_c,ah){var _m=this;return(0,f.Z)(function*(){const m_=yield _m.getOrInitRedirectPersistenceManager(ah);return null===_c?m_.removeCurrentUser():m_.setCurrentUser(_c)})()}getOrInitRedirectPersistenceManager(_c){var ah=this;return(0,f.Z)(function*(){if(!ah.redirectPersistenceManager){const _m=_c&&F_(_c)||ah._popupRedirectResolver;P_(_m,ah,"argument-error"),ah.redirectPersistenceManager=yield AR.create(ah,[F_(_m._redirectPersistence)],"redirectUser"),ah.redirectUser=yield ah.redirectPersistenceManager.getCurrentUser()}return ah.redirectPersistenceManager})()}_redirectUserForId(_c){var ah=this;return(0,f.Z)(function*(){var _m,m_;return ah._isInitialized&&(yield ah.queue((0,f.Z)(function*(){}))),(null===(_m=ah._currentUser)||void 0===_m?void 0:_m._redirectEventId)===_c?ah._currentUser:(null===(m_=ah.redirectUser)||void 0===m_?void 0:m_._redirectEventId)===_c?ah.redirectUser:null})()}_persistUserIfCurrent(_c){var ah=this;return(0,f.Z)(function*(){if(_c===ah.currentUser)return ah.queue((0,f.Z)(function*(){return ah.directlySetCurrentUser(_c)}))})()}_notifyListenersIfCurrent(_c){_c===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var _c,ah;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const _m=null!==(ah=null===(_c=this.currentUser)||void 0===_c?void 0:_c.uid)&&void 0!==ah?ah:null;this.lastNotifiedUid!==_m&&(this.lastNotifiedUid=_m,this.authStateSubscription.next(this.currentUser))}registerStateListener(_c,ah,_m,m_){if(this._deleted)return()=>{};const O_="function"==typeof ah?ah:ah.next.bind(ah),s0=this._isInitialized?Promise.resolve():this._initializationPromise;return P_(s0,this,"internal-error"),s0.then(()=>O_(this.currentUser)),"function"==typeof ah?_c.addObserver(ah,_m,m_):_c.addObserver(ah)}directlySetCurrentUser(_c){var ah=this;return(0,f.Z)(function*(){ah.currentUser&&ah.currentUser!==_c&&(ah._currentUser._stopProactiveRefresh(),_c&&ah.isProactiveRefreshEnabled&&_c._startProactiveRefresh()),ah.currentUser=_c,_c?yield ah.assertedPersistence.setCurrentUser(_c):yield ah.assertedPersistence.removeCurrentUser()})()}queue(_c){return this.operations=this.operations.then(_c,_c),this.operations}get assertedPersistence(){return P_(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(_c){!_c||this.frameworks.includes(_c)||(this.frameworks.push(_c),this.frameworks.sort(),this.clientVersion=$L(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var _c=this;return(0,f.Z)(function*(){var ah;const _m={"X-Client-Version":_c.clientVersion};_c.app.options.appId&&(_m["X-Firebase-gmpid"]=_c.app.options.appId);const m_=yield null===(ah=_c.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===ah?void 0:ah.getHeartbeatsHeader();return m_&&(_m["X-Firebase-Client"]=m_),_m})()}}function NI(Nf){return(0,q.m9)(Nf)}class B1{constructor(_c){this.auth=_c,this.observer=null,this.addObserver=(0,q.ne)(ah=>this.observer=ah)}get next(){return P_(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function DN(Nf){const _c=Nf.indexOf(":");return _c<0?"":Nf.substr(0,_c+1)}function NN(Nf){if(!Nf)return null;const _c=Number(Nf);return isNaN(_c)?null:_c}class RO{constructor(_c,ah){this.providerId=_c,this.signInMethod=ah}toJSON(){return _v("not implemented")}_getIdTokenResponse(_c){return _v("not implemented")}_linkToIdToken(_c,ah){return _v("not implemented")}_getReauthenticationResolver(_c){return _v("not implemented")}}function XT(Nf,_c){return f1.apply(this,arguments)}function f1(){return(f1=(0,f.Z)(function*(Nf,_c){return w1(Nf,"POST","/v1/accounts:resetPassword",L1(Nf,_c))})).apply(this,arguments)}function ZL(Nf,_c){return fP.apply(this,arguments)}function fP(){return(fP=(0,f.Z)(function*(Nf,_c){return w1(Nf,"POST","/v1/accounts:update",_c)})).apply(this,arguments)}function m3(Nf,_c){return pP.apply(this,arguments)}function pP(){return(pP=(0,f.Z)(function*(Nf,_c){return w1(Nf,"POST","/v1/accounts:update",L1(Nf,_c))})).apply(this,arguments)}function kN(){return(kN=(0,f.Z)(function*(Nf,_c){return YT(Nf,"POST","/v1/accounts:signInWithPassword",L1(Nf,_c))})).apply(this,arguments)}function A2(Nf,_c){return QT.apply(this,arguments)}function QT(){return(QT=(0,f.Z)(function*(Nf,_c){return w1(Nf,"POST","/v1/accounts:sendOobCode",L1(Nf,_c))})).apply(this,arguments)}function cT(Nf,_c){return tL.apply(this,arguments)}function tL(){return(tL=(0,f.Z)(function*(Nf,_c){return A2(Nf,_c)})).apply(this,arguments)}function ZM(Nf,_c){return HR.apply(this,arguments)}function HR(){return(HR=(0,f.Z)(function*(Nf,_c){return A2(Nf,_c)})).apply(this,arguments)}function PN(Nf,_c){return A3.apply(this,arguments)}function A3(){return(A3=(0,f.Z)(function*(Nf,_c){return A2(Nf,_c)})).apply(this,arguments)}function X6(Nf,_c){return xN.apply(this,arguments)}function xN(){return(xN=(0,f.Z)(function*(Nf,_c){return A2(Nf,_c)})).apply(this,arguments)}function mj(){return(mj=(0,f.Z)(function*(Nf,_c){return YT(Nf,"POST","/v1/accounts:signInWithEmailLink",L1(Nf,_c))})).apply(this,arguments)}function eV(){return(eV=(0,f.Z)(function*(Nf,_c){return YT(Nf,"POST","/v1/accounts:signInWithEmailLink",L1(Nf,_c))})).apply(this,arguments)}class iR extends RO{constructor(_c,ah,_m,m_=null){super("password",_m),this._email=_c,this._password=ah,this._tenantId=m_}static _fromEmailAndPassword(_c,ah){return new iR(_c,ah,"password")}static _fromEmailAndCode(_c,ah,_m=null){return new iR(_c,ah,"emailLink",_m)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(_c){const ah="string"==typeof _c?JSON.parse(_c):_c;if((null==ah?void 0:ah.email)&&(null==ah?void 0:ah.password)){if("password"===ah.signInMethod)return this._fromEmailAndPassword(ah.email,ah.password);if("emailLink"===ah.signInMethod)return this._fromEmailAndCode(ah.email,ah.password,ah.tenantId)}return null}_getIdTokenResponse(_c){var ah=this;return(0,f.Z)(function*(){switch(ah.signInMethod){case"password":return function HS(Nf,_c){return kN.apply(this,arguments)}(_c,{returnSecureToken:!0,email:ah._email,password:ah._password});case"emailLink":return function LN(Nf,_c){return mj.apply(this,arguments)}(_c,{email:ah._email,oobCode:ah._password});default:Pv(_c,"internal-error")}})()}_linkToIdToken(_c,ah){var _m=this;return(0,f.Z)(function*(){switch(_m.signInMethod){case"password":return ZL(_c,{idToken:ah,returnSecureToken:!0,email:_m._email,password:_m._password});case"emailLink":return function _9(Nf,_c){return eV.apply(this,arguments)}(_c,{idToken:ah,email:_m._email,oobCode:_m._password});default:Pv(_c,"internal-error")}})()}_getReauthenticationResolver(_c){return this._getIdTokenResponse(_c)}}function yT(Nf,_c){return _j.apply(this,arguments)}function _j(){return(_j=(0,f.Z)(function*(Nf,_c){return YT(Nf,"POST","/v1/accounts:signInWithIdp",L1(Nf,_c))})).apply(this,arguments)}class _2 extends RO{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(_c){const ah=new _2(_c.providerId,_c.signInMethod);return _c.idToken||_c.accessToken?(_c.idToken&&(ah.idToken=_c.idToken),_c.accessToken&&(ah.accessToken=_c.accessToken),_c.nonce&&!_c.pendingToken&&(ah.nonce=_c.nonce),_c.pendingToken&&(ah.pendingToken=_c.pendingToken)):_c.oauthToken&&_c.oauthTokenSecret?(ah.accessToken=_c.oauthToken,ah.secret=_c.oauthTokenSecret):Pv("argument-error"),ah}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(_c){const ah="string"==typeof _c?JSON.parse(_c):_c,{providerId:_m,signInMethod:m_}=ah,O_=(0,_s._T)(ah,["providerId","signInMethod"]);if(!_m||!m_)return null;const s0=new _2(_m,m_);return s0.idToken=O_.idToken||void 0,s0.accessToken=O_.accessToken||void 0,s0.secret=O_.secret,s0.nonce=O_.nonce,s0.pendingToken=O_.pendingToken||null,s0}_getIdTokenResponse(_c){return yT(_c,this.buildRequest())}_linkToIdToken(_c,ah){const _m=this.buildRequest();return _m.idToken=ah,yT(_c,_m)}_getReauthenticationResolver(_c){const ah=this.buildRequest();return ah.autoCreate=!1,yT(_c,ah)}buildRequest(){const _c={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)_c.pendingToken=this.pendingToken;else{const ah={};this.idToken&&(ah.id_token=this.idToken),this.accessToken&&(ah.access_token=this.accessToken),this.secret&&(ah.oauth_token_secret=this.secret),ah.providerId=this.providerId,this.nonce&&!this.pendingToken&&(ah.nonce=this.nonce),_c.postBody=(0,q.xO)(ah)}return _c}}function v9(Nf,_c){return tV.apply(this,arguments)}function tV(){return(tV=(0,f.Z)(function*(Nf,_c){return w1(Nf,"POST","/v1/accounts:sendVerificationCode",L1(Nf,_c))})).apply(this,arguments)}function gP(){return(gP=(0,f.Z)(function*(Nf,_c){return YT(Nf,"POST","/v1/accounts:signInWithPhoneNumber",L1(Nf,_c))})).apply(this,arguments)}function nV(){return(nV=(0,f.Z)(function*(Nf,_c){const ah=yield YT(Nf,"POST","/v1/accounts:signInWithPhoneNumber",L1(Nf,_c));if(ah.temporaryProof)throw ZO(Nf,"account-exists-with-different-credential",ah);return ah})).apply(this,arguments)}const XM={USER_NOT_FOUND:"user-not-found"};function rV(){return(rV=(0,f.Z)(function*(Nf,_c){return YT(Nf,"POST","/v1/accounts:signInWithPhoneNumber",L1(Nf,Object.assign(Object.assign({},_c),{operation:"REAUTH"})),XM)})).apply(this,arguments)}class mP extends RO{constructor(_c){super("phone","phone"),this.params=_c}static _fromVerification(_c,ah){return new mP({verificationId:_c,verificationCode:ah})}static _fromTokenResponse(_c,ah){return new mP({phoneNumber:_c,temporaryProof:ah})}_getIdTokenResponse(_c){return function wS(Nf,_c){return gP.apply(this,arguments)}(_c,this._makeVerificationRequest())}_linkToIdToken(_c,ah){return function y9(Nf,_c){return nV.apply(this,arguments)}(_c,Object.assign({idToken:ah},this._makeVerificationRequest()))}_getReauthenticationResolver(_c){return function EG(Nf,_c){return rV.apply(this,arguments)}(_c,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:_c,phoneNumber:ah,verificationId:_m,verificationCode:m_}=this.params;return _c&&ah?{temporaryProof:_c,phoneNumber:ah}:{sessionInfo:_m,code:m_}}toJSON(){const _c={providerId:this.providerId};return this.params.phoneNumber&&(_c.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(_c.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(_c.verificationCode=this.params.verificationCode),this.params.verificationId&&(_c.verificationId=this.params.verificationId),_c}static fromJSON(_c){"string"==typeof _c&&(_c=JSON.parse(_c));const{verificationId:ah,verificationCode:_m,phoneNumber:m_,temporaryProof:O_}=_c;return _m||ah||m_||O_?new mP({verificationId:ah,verificationCode:_m,phoneNumber:m_,temporaryProof:O_}):null}}class _3{constructor(_c){var ah,_m,m_,O_,s0,N0;const tI=(0,q.zd)((0,q.pd)(_c)),AI=null!==(ah=tI.apiKey)&&void 0!==ah?ah:null,VI=null!==(_m=tI.oobCode)&&void 0!==_m?_m:null,GI=function IG(Nf){switch(Nf){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(m_=tI.mode)&&void 0!==m_?m_:null);P_(AI&&VI&&GI,"argument-error"),this.apiKey=AI,this.operation=GI,this.code=VI,this.continueUrl=null!==(O_=tI.continueUrl)&&void 0!==O_?O_:null,this.languageCode=null!==(s0=tI.languageCode)&&void 0!==s0?s0:null,this.tenantId=null!==(N0=tI.tenantId)&&void 0!==N0?N0:null}static parseLink(_c){const ah=function _B(Nf){const _c=(0,q.zd)((0,q.pd)(Nf)).link,ah=_c?(0,q.zd)((0,q.pd)(_c)).deep_link_id:null,_m=(0,q.zd)((0,q.pd)(Nf)).deep_link_id;return(_m?(0,q.zd)((0,q.pd)(_m)).link:null)||_m||ah||_c||Nf}(_c);try{return new _3(ah)}catch(_m){return null}}}let oV=(()=>{class Nf{constructor(){this.providerId=Nf.PROVIDER_ID}static credential(ah,_m){return iR._fromEmailAndPassword(ah,_m)}static credentialWithLink(ah,_m){const m_=_3.parseLink(_m);return P_(m_,"argument-error"),iR._fromEmailAndCode(ah,m_.code,m_.tenantId)}}return Nf.PROVIDER_ID="password",Nf.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Nf.EMAIL_LINK_SIGN_IN_METHOD="emailLink",Nf})();class _R{constructor(_c){this.providerId=_c,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(_c){this.defaultLanguageCode=_c}setCustomParameters(_c){return this.customParameters=_c,this}getCustomParameters(){return this.customParameters}}class TS extends _R{constructor(){super(...arguments),this.scopes=[]}addScope(_c){return this.scopes.includes(_c)||this.scopes.push(_c),this}getScopes(){return[...this.scopes]}}class eS extends TS{static credentialFromJSON(_c){const ah="string"==typeof _c?JSON.parse(_c):_c;return P_("providerId"in ah&&"signInMethod"in ah,"argument-error"),_2._fromParams(ah)}credential(_c){return this._credential(Object.assign(Object.assign({},_c),{nonce:_c.rawNonce}))}_credential(_c){return P_(_c.idToken||_c.accessToken,"argument-error"),_2._fromParams(Object.assign(Object.assign({},_c),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(_c){return eS.oauthCredentialFromTaggedObject(_c)}static credentialFromError(_c){return eS.oauthCredentialFromTaggedObject(_c.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:_c}){if(!_c)return null;const{oauthIdToken:ah,oauthAccessToken:_m,oauthTokenSecret:m_,pendingToken:O_,nonce:s0,providerId:N0}=_c;if(!_m&&!m_&&!ah&&!O_||!N0)return null;try{return new eS(N0)._credential({idToken:ah,accessToken:_m,nonce:s0,pendingToken:O_})}catch(tI){return null}}}let XL=(()=>{class Nf extends TS{constructor(){super("facebook.com")}static credential(ah){return _2._fromParams({providerId:Nf.PROVIDER_ID,signInMethod:Nf.FACEBOOK_SIGN_IN_METHOD,accessToken:ah})}static credentialFromResult(ah){return Nf.credentialFromTaggedObject(ah)}static credentialFromError(ah){return Nf.credentialFromTaggedObject(ah.customData||{})}static credentialFromTaggedObject({_tokenResponse:ah}){if(!ah||!("oauthAccessToken"in ah)||!ah.oauthAccessToken)return null;try{return Nf.credential(ah.oauthAccessToken)}catch(_m){return null}}}return Nf.FACEBOOK_SIGN_IN_METHOD="facebook.com",Nf.PROVIDER_ID="facebook.com",Nf})(),v3=(()=>{class Nf extends TS{constructor(){super("google.com"),this.addScope("profile")}static credential(ah,_m){return _2._fromParams({providerId:Nf.PROVIDER_ID,signInMethod:Nf.GOOGLE_SIGN_IN_METHOD,idToken:ah,accessToken:_m})}static credentialFromResult(ah){return Nf.credentialFromTaggedObject(ah)}static credentialFromError(ah){return Nf.credentialFromTaggedObject(ah.customData||{})}static credentialFromTaggedObject({_tokenResponse:ah}){if(!ah)return null;const{oauthIdToken:_m,oauthAccessToken:m_}=ah;if(!_m&&!m_)return null;try{return Nf.credential(_m,m_)}catch(O_){return null}}}return Nf.GOOGLE_SIGN_IN_METHOD="google.com",Nf.PROVIDER_ID="google.com",Nf})(),CG=(()=>{class Nf extends TS{constructor(){super("github.com")}static credential(ah){return _2._fromParams({providerId:Nf.PROVIDER_ID,signInMethod:Nf.GITHUB_SIGN_IN_METHOD,accessToken:ah})}static credentialFromResult(ah){return Nf.credentialFromTaggedObject(ah)}static credentialFromError(ah){return Nf.credentialFromTaggedObject(ah.customData||{})}static credentialFromTaggedObject({_tokenResponse:ah}){if(!ah||!("oauthAccessToken"in ah)||!ah.oauthAccessToken)return null;try{return Nf.credential(ah.oauthAccessToken)}catch(_m){return null}}}return Nf.GITHUB_SIGN_IN_METHOD="github.com",Nf.PROVIDER_ID="github.com",Nf})();class XO extends RO{constructor(_c,ah){super(_c,_c),this.pendingToken=ah}_getIdTokenResponse(_c){return yT(_c,this.buildRequest())}_linkToIdToken(_c,ah){const _m=this.buildRequest();return _m.idToken=ah,yT(_c,_m)}_getReauthenticationResolver(_c){const ah=this.buildRequest();return ah.autoCreate=!1,yT(_c,ah)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(_c){const ah="string"==typeof _c?JSON.parse(_c):_c,{providerId:_m,signInMethod:m_,pendingToken:O_}=ah;return _m&&m_&&O_&&_m===m_?new XO(_m,O_):null}static _create(_c,ah){return new XO(_c,ah)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class qS extends _R{constructor(_c){P_(_c.startsWith("saml."),"argument-error"),super(_c)}static credentialFromResult(_c){return qS.samlCredentialFromTaggedObject(_c)}static credentialFromError(_c){return qS.samlCredentialFromTaggedObject(_c.customData||{})}static credentialFromJSON(_c){const ah=XO.fromJSON(_c);return P_(ah,"argument-error"),ah}static samlCredentialFromTaggedObject({_tokenResponse:_c}){if(!_c)return null;const{pendingToken:ah,providerId:_m}=_c;if(!ah||!_m)return null;try{return XO._create(_m,ah)}catch(m_){return null}}}let sV=(()=>{class Nf extends TS{constructor(){super("twitter.com")}static credential(ah,_m){return _2._fromParams({providerId:Nf.PROVIDER_ID,signInMethod:Nf.TWITTER_SIGN_IN_METHOD,oauthToken:ah,oauthTokenSecret:_m})}static credentialFromResult(ah){return Nf.credentialFromTaggedObject(ah)}static credentialFromError(ah){return Nf.credentialFromTaggedObject(ah.customData||{})}static credentialFromTaggedObject({_tokenResponse:ah}){if(!ah)return null;const{oauthAccessToken:_m,oauthTokenSecret:m_}=ah;if(!_m||!m_)return null;try{return Nf.credential(_m,m_)}catch(O_){return null}}}return Nf.TWITTER_SIGN_IN_METHOD="twitter.com",Nf.PROVIDER_ID="twitter.com",Nf})();function qR(Nf,_c){return rL.apply(this,arguments)}function rL(){return(rL=(0,f.Z)(function*(Nf,_c){return YT(Nf,"POST","/v1/accounts:signUp",L1(Nf,_c))})).apply(this,arguments)}class OO{constructor(_c){this.user=_c.user,this.providerId=_c.providerId,this._tokenResponse=_c._tokenResponse,this.operationType=_c.operationType}static _fromIdTokenResponse(_c,ah,_m,m_=!1){return(0,f.Z)(function*(){const O_=yield XI._fromIdTokenResponse(_c,_m,m_),s0=kj(_m);return new OO({user:O_,providerId:s0,_tokenResponse:_m,operationType:ah})})()}static _forOperation(_c,ah,_m){return(0,f.Z)(function*(){yield _c._updateTokensIfNecessary(_m,!0);const m_=kj(_m);return new OO({user:_c,providerId:m_,_tokenResponse:_m,operationType:ah})})()}}function kj(Nf){return Nf.providerId?Nf.providerId:"phoneNumber"in Nf?"phone":null}function y3(){return(y3=(0,f.Z)(function*(Nf){var _c;const ah=NI(Nf);if(yield ah._initializationPromise,null===(_c=ah.currentUser)||void 0===_c?void 0:_c.isAnonymous)return new OO({user:ah.currentUser,providerId:null,operationType:"signIn"});const _m=yield qR(ah,{returnSecureToken:!0}),m_=yield OO._fromIdTokenResponse(ah,"signIn",_m,!0);return yield ah._updateCurrentUser(m_.user),m_})).apply(this,arguments)}class AP extends q.ZR{constructor(_c,ah,_m,m_){var O_;super(ah.code,ah.message),this.operationType=_m,this.user=m_,Object.setPrototypeOf(this,AP.prototype),this.customData={appName:_c.name,tenantId:null!==(O_=_c.tenantId)&&void 0!==O_?O_:void 0,_serverResponse:ah.customData._serverResponse,operationType:_m}}static _fromErrorAndOperation(_c,ah,_m,m_){return new AP(_c,ah,_m,m_)}}function eU(Nf,_c,ah,_m){return("reauthenticate"===_c?ah._getReauthenticationResolver(Nf):ah._getIdTokenResponse(Nf)).catch(O_=>{throw"auth/multi-factor-auth-required"===O_.code?AP._fromErrorAndOperation(Nf,O_,_c,_m):O_})}function MN(Nf){return new Set(Nf.map(({providerId:_c})=>_c).filter(_c=>!!_c))}function nT(){return(nT=(0,f.Z)(function*(Nf,_c){const ah=(0,q.m9)(Nf);yield K1(!0,ah,_c);const{providerUserInfo:_m}=yield TT(ah.auth,{idToken:yield ah.getIdToken(),deleteProvider:[_c]}),m_=MN(_m||[]);return ah.providerData=ah.providerData.filter(O_=>m_.has(O_.providerId)),m_.has("phone")||(ah.phoneNumber=null),yield ah.auth._persistUserIfCurrent(ah),ah})).apply(this,arguments)}function tU(Nf,_c){return iL.apply(this,arguments)}function iL(){return(iL=(0,f.Z)(function*(Nf,_c,ah=!1){const _m=yield gR(Nf,_c._linkToIdToken(Nf.auth,yield Nf.getIdToken()),ah);return OO._forOperation(Nf,"link",_m)})).apply(this,arguments)}function K1(Nf,_c,ah){return oL.apply(this,arguments)}function oL(){return(oL=(0,f.Z)(function*(Nf,_c,ah){yield $T(_c);const m_=!1===Nf?"provider-already-linked":"no-such-provider";P_(MN(_c.providerData).has(ah)===Nf,_c.auth,m_)})).apply(this,arguments)}function E3(Nf,_c){return _P.apply(this,arguments)}function _P(){return(_P=(0,f.Z)(function*(Nf,_c,ah=!1){const{auth:_m}=Nf,m_="reauthenticate";try{const O_=yield gR(Nf,eU(_m,m_,_c,Nf),ah);P_(O_.idToken,_m,"internal-error");const s0=kI(O_.idToken);P_(s0,_m,"internal-error");const{sub:N0}=s0;return P_(Nf.uid===N0,_m,"user-mismatch"),OO._forOperation(Nf,m_,O_)}catch(O_){throw"auth/user-not-found"===(null==O_?void 0:O_.code)&&Pv(_m,"user-mismatch"),O_}})).apply(this,arguments)}function WS(Nf,_c){return nU.apply(this,arguments)}function nU(){return(nU=(0,f.Z)(function*(Nf,_c,ah=!1){const m_=yield eU(Nf,"signIn",_c),O_=yield OO._fromIdTokenResponse(Nf,"signIn",m_);return ah||(yield Nf._updateCurrentUser(O_.user)),O_})).apply(this,arguments)}function kT(Nf,_c){return oR.apply(this,arguments)}function oR(){return(oR=(0,f.Z)(function*(Nf,_c){return WS(NI(Nf),_c)})).apply(this,arguments)}function sR(Nf,_c){return vP.apply(this,arguments)}function vP(){return(vP=(0,f.Z)(function*(Nf,_c){const ah=(0,q.m9)(Nf);return yield K1(!1,ah,_c.providerId),tU(ah,_c)})).apply(this,arguments)}function y2(Nf,_c){return BN.apply(this,arguments)}function BN(){return(BN=(0,f.Z)(function*(Nf,_c){return E3((0,q.m9)(Nf),_c)})).apply(this,arguments)}function PT(Nf,_c){return DO.apply(this,arguments)}function DO(){return(DO=(0,f.Z)(function*(Nf,_c){return YT(Nf,"POST","/v1/accounts:signInWithCustomToken",L1(Nf,_c))})).apply(this,arguments)}function zI(){return(zI=(0,f.Z)(function*(Nf,_c){const ah=NI(Nf),_m=yield PT(ah,{token:_c,returnSecureToken:!0}),m_=yield OO._fromIdTokenResponse(ah,"signIn",_m);return yield ah._updateCurrentUser(m_.user),m_})).apply(this,arguments)}class yP{constructor(_c,ah){this.factorId=_c,this.uid=ah.mfaEnrollmentId,this.enrollmentTime=new Date(ah.enrolledAt).toUTCString(),this.displayName=ah.displayName}static _fromServerResponse(_c,ah){return"phoneInfo"in ah?rU._fromServerResponse(_c,ah):Pv(_c,"internal-error")}}class rU extends yP{constructor(_c){super("phone",_c),this.phoneNumber=_c.phoneInfo}static _fromServerResponse(_c,ah){return new rU(ah)}}function sL(Nf,_c,ah){var _m;P_((null===(_m=ah.url)||void 0===_m?void 0:_m.length)>0,Nf,"invalid-continue-uri"),P_(void 0===ah.dynamicLinkDomain||ah.dynamicLinkDomain.length>0,Nf,"invalid-dynamic-link-domain"),_c.continueUrl=ah.url,_c.dynamicLinkDomain=ah.dynamicLinkDomain,_c.canHandleCodeInApp=ah.handleCodeInApp,ah.iOS&&(P_(ah.iOS.bundleId.length>0,Nf,"missing-ios-bundle-id"),_c.iOSBundleId=ah.iOS.bundleId),ah.android&&(P_(ah.android.packageName.length>0,Nf,"missing-android-pkg-name"),_c.androidInstallApp=ah.android.installApp,_c.androidMinimumVersionCode=ah.android.minimumVersion,_c.androidPackageName=ah.android.packageName)}function iU(){return(iU=(0,f.Z)(function*(Nf,_c,ah){const _m=(0,q.m9)(Nf),m_={requestType:"PASSWORD_RESET",email:_c};ah&&sL(_m,m_,ah),yield ZM(_m,m_)})).apply(this,arguments)}function b3(){return(b3=(0,f.Z)(function*(Nf,_c,ah){yield XT((0,q.m9)(Nf),{oobCode:_c,newPassword:ah})})).apply(this,arguments)}function j0(){return(j0=(0,f.Z)(function*(Nf,_c){yield m3((0,q.m9)(Nf),{oobCode:_c})})).apply(this,arguments)}function T1(Nf,_c){return nM.apply(this,arguments)}function nM(){return(nM=(0,f.Z)(function*(Nf,_c){const ah=(0,q.m9)(Nf),_m=yield XT(ah,{oobCode:_c}),m_=_m.requestType;switch(P_(m_,ah,"internal-error"),m_){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":P_(_m.newEmail,ah,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":P_(_m.mfaInfo,ah,"internal-error");default:P_(_m.email,ah,"internal-error")}let O_=null;return _m.mfaInfo&&(O_=yP._fromServerResponse(NI(ah),_m.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===_m.requestType?_m.newEmail:_m.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===_m.requestType?_m.email:_m.newEmail)||null,multiFactorInfo:O_},operation:m_}})).apply(this,arguments)}function C3(){return(C3=(0,f.Z)(function*(Nf,_c){const{data:ah}=yield T1((0,q.m9)(Nf),_c);return ah.email})).apply(this,arguments)}function NO(){return(NO=(0,f.Z)(function*(Nf,_c,ah){const _m=NI(Nf),m_=yield qR(_m,{returnSecureToken:!0,email:_c,password:ah}),O_=yield OO._fromIdTokenResponse(_m,"signIn",m_);return yield _m._updateCurrentUser(O_.user),O_})).apply(this,arguments)}function e5(){return(e5=(0,f.Z)(function*(Nf,_c,ah){const _m=(0,q.m9)(Nf),m_={requestType:"EMAIL_SIGNIN",email:_c};P_(ah.handleCodeInApp,_m,"argument-error"),ah&&sL(_m,m_,ah),yield PN(_m,m_)})).apply(this,arguments)}function kO(){return(kO=(0,f.Z)(function*(Nf,_c,ah){const _m=(0,q.m9)(Nf),m_=oV.credentialWithLink(_c,ah||D0());return P_(m_._tenantId===(_m.tenantId||null),_m,"tenant-id-mismatch"),kT(_m,m_)})).apply(this,arguments)}function vR(Nf,_c){return PO.apply(this,arguments)}function PO(){return(PO=(0,f.Z)(function*(Nf,_c){return w1(Nf,"POST","/v1/accounts:createAuthUri",L1(Nf,_c))})).apply(this,arguments)}function EP(){return(EP=(0,f.Z)(function*(Nf,_c){const _m={identifier:_c,continueUri:O0()?D0():"http://localhost"},{signinMethods:m_}=yield vR((0,q.m9)(Nf),_m);return m_||[]})).apply(this,arguments)}function t5(){return(t5=(0,f.Z)(function*(Nf,_c){const ah=(0,q.m9)(Nf),m_={requestType:"VERIFY_EMAIL",idToken:yield Nf.getIdToken()};_c&&sL(ah.auth,m_,_c);const{email:O_}=yield cT(ah.auth,m_);O_!==Nf.email&&(yield Nf.reload())})).apply(this,arguments)}function T3(){return(T3=(0,f.Z)(function*(Nf,_c,ah){const _m=(0,q.m9)(Nf),O_={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield Nf.getIdToken(),newEmail:_c};ah&&sL(_m.auth,O_,ah);const{email:s0}=yield X6(_m.auth,O_);s0!==Nf.email&&(yield Nf.reload())})).apply(this,arguments)}function S3(Nf,_c){return oU.apply(this,arguments)}function oU(){return(oU=(0,f.Z)(function*(Nf,_c){return w1(Nf,"POST","/v1/accounts:update",_c)})).apply(this,arguments)}function R3(){return(R3=(0,f.Z)(function*(Nf,{displayName:_c,photoURL:ah}){if(void 0===_c&&void 0===ah)return;const _m=(0,q.m9)(Nf),O_={idToken:yield _m.getIdToken(),displayName:_c,photoUrl:ah,returnSecureToken:!0},s0=yield gR(_m,S3(_m.auth,O_));_m.displayName=s0.displayName||null,_m.photoURL=s0.photoUrl||null;const N0=_m.providerData.find(({providerId:tI})=>"password"===tI);N0&&(N0.displayName=_m.displayName,N0.photoURL=_m.photoURL),yield _m._updateTokensIfNecessary(s0)})).apply(this,arguments)}function sU(Nf,_c,ah){return IP.apply(this,arguments)}function IP(){return(IP=(0,f.Z)(function*(Nf,_c,ah){const{auth:_m}=Nf,O_={idToken:yield Nf.getIdToken(),returnSecureToken:!0};_c&&(O_.email=_c),ah&&(O_.password=ah);const s0=yield gR(Nf,ZL(_m,O_));yield Nf._updateTokensIfNecessary(s0,!0)})).apply(this,arguments)}class iM{constructor(_c,ah,_m={}){this.isNewUser=_c,this.providerId=ah,this.profile=_m}}class hV extends iM{constructor(_c,ah,_m,m_){super(_c,ah,_m),this.username=m_}}class aU extends iM{constructor(_c,ah){super(_c,"facebook.com",ah)}}class fO extends hV{constructor(_c,ah){super(_c,"github.com",ah,"string"==typeof(null==ah?void 0:ah.login)?null==ah?void 0:ah.login:null)}}class wG extends iM{constructor(_c,ah){super(_c,"google.com",ah)}}class n5 extends hV{constructor(_c,ah,_m){super(_c,"twitter.com",ah,_m)}}function KS(Nf){const{user:_c,_tokenResponse:ah}=Nf;return _c.isAnonymous&&!ah?{providerId:null,isNewUser:!1,profile:null}:function O3(Nf){var _c,ah;if(!Nf)return null;const{providerId:_m}=Nf,m_=Nf.rawUserInfo?JSON.parse(Nf.rawUserInfo):{},O_=Nf.isNewUser||"identitytoolkit#SignupNewUserResponse"===Nf.kind;if(!_m&&(null==Nf?void 0:Nf.idToken)){const s0=null===(ah=null===(_c=kI(Nf.idToken))||void 0===_c?void 0:_c.firebase)||void 0===ah?void 0:ah.sign_in_provider;if(s0)return new iM(O_,"anonymous"!==s0&&"custom"!==s0?s0:null)}if(!_m)return null;switch(_m){case"facebook.com":return new aU(O_,m_);case"github.com":return new fO(O_,m_);case"google.com":return new wG(O_,m_);case"twitter.com":return new n5(O_,m_,Nf.screenName||null);case"custom":case"anonymous":return new iM(O_,null);default:return new iM(O_,_m,m_)}}(ah)}class I2{constructor(_c,ah){this.type=_c,this.credential=ah}static _fromIdtoken(_c){return new I2("enroll",_c)}static _fromMfaPendingCredential(_c){return new I2("signin",_c)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(_c){var ah,_m;if(null==_c?void 0:_c.multiFactorSession){if(null===(ah=_c.multiFactorSession)||void 0===ah?void 0:ah.pendingCredential)return I2._fromMfaPendingCredential(_c.multiFactorSession.pendingCredential);if(null===(_m=_c.multiFactorSession)||void 0===_m?void 0:_m.idToken)return I2._fromIdtoken(_c.multiFactorSession.idToken)}return null}}class eN{constructor(_c,ah,_m){this.session=_c,this.hints=ah,this.signInResolver=_m}static _fromError(_c,ah){const _m=NI(_c),m_=ah.customData._serverResponse,O_=(m_.mfaInfo||[]).map(N0=>yP._fromServerResponse(_m,N0));P_(m_.mfaPendingCredential,_m,"internal-error");const s0=I2._fromMfaPendingCredential(m_.mfaPendingCredential);return new eN(s0,O_,function(){var N0=(0,f.Z)(function*(tI){const AI=yield tI._process(_m,s0);delete m_.mfaInfo,delete m_.mfaPendingCredential;const VI=Object.assign(Object.assign({},m_),{idToken:AI.idToken,refreshToken:AI.refreshToken});switch(ah.operationType){case"signIn":const GI=yield OO._fromIdTokenResponse(_m,ah.operationType,VI);return yield _m._updateCurrentUser(GI.user),GI;case"reauthenticate":return P_(ah.user,_m,"internal-error"),OO._forOperation(ah.user,ah.operationType,VI);default:Pv(_m,"internal-error")}});return function(tI){return N0.apply(this,arguments)}}())}resolveSignIn(_c){var ah=this;return(0,f.Z)(function*(){return ah.signInResolver(_c)})()}}function gV(Nf,_c){return w1(Nf,"POST","/v2/accounts/mfaEnrollment:start",L1(Nf,_c))}class bP{constructor(_c){this.user=_c,this.enrolledFactors=[],_c._onReload(ah=>{ah.mfaInfo&&(this.enrolledFactors=ah.mfaInfo.map(_m=>yP._fromServerResponse(_c.auth,_m)))})}static _fromUser(_c){return new bP(_c)}getSession(){var _c=this;return(0,f.Z)(function*(){return I2._fromIdtoken(yield _c.user.getIdToken())})()}enroll(_c,ah){var _m=this;return(0,f.Z)(function*(){const m_=_c,O_=yield _m.getSession(),s0=yield gR(_m.user,m_._process(_m.user.auth,O_,ah));return yield _m.user._updateTokensIfNecessary(s0),_m.user.reload()})()}unenroll(_c){var ah=this;return(0,f.Z)(function*(){const _m="string"==typeof _c?_c:_c.uid,m_=yield ah.user.getIdToken(),O_=yield gR(ah.user,function cL(Nf,_c){return w1(Nf,"POST","/v2/accounts/mfaEnrollment:withdraw",L1(Nf,_c))}(ah.user.auth,{idToken:m_,mfaEnrollmentId:_m}));ah.enrolledFactors=ah.enrolledFactors.filter(({uid:s0})=>s0!==_m),yield ah.user._updateTokensIfNecessary(O_);try{yield ah.user.reload()}catch(s0){if("auth/user-token-expired"!==s0.code)throw s0}})()}}const oM=new WeakMap,FN="__sak";class uU{constructor(_c,ah){this.storageRetriever=_c,this.type=ah}_isAvailable(){try{return this.storage?(this.storage.setItem(FN,"1"),this.storage.removeItem(FN),Promise.resolve(!0)):Promise.resolve(!1)}catch(_c){return Promise.resolve(!1)}}_set(_c,ah){return this.storage.setItem(_c,JSON.stringify(ah)),Promise.resolve()}_get(_c){const ah=this.storage.getItem(_c);return Promise.resolve(ah?JSON.parse(ah):null)}_remove(_c){return this.storage.removeItem(_c),Promise.resolve()}get storage(){return this.storageRetriever()}}const xT=(()=>{class Nf extends uU{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(ah,_m)=>this.onStorageEvent(ah,_m),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function C9(){const Nf=(0,q.z$)();return ON(Nf)||hO(Nf)}()&&function QS(){try{return!(!window||window===window.top)}catch(Nf){return!1}}(),this.fallbackToPolling=hP(),this._shouldAllowMigration=!0}forAllChangedKeys(ah){for(const _m of Object.keys(this.listeners)){const m_=this.storage.getItem(_m),O_=this.localCache[_m];m_!==O_&&ah(_m,O_,m_)}}onStorageEvent(ah,_m=!1){if(!ah.key)return void this.forAllChangedKeys((N0,tI,AI)=>{this.notifyListeners(N0,AI)});const m_=ah.key;if(_m?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const N0=this.storage.getItem(m_);if(ah.newValue!==N0)null!==ah.newValue?this.storage.setItem(m_,ah.newValue):this.storage.removeItem(m_);else if(this.localCache[m_]===ah.newValue&&!_m)return}const O_=()=>{const N0=this.storage.getItem(m_);!_m&&this.localCache[m_]===N0||this.notifyListeners(m_,N0)},s0=this.storage.getItem(m_);!function $M(){return(0,q.w1)()&&10===document.documentMode}()||s0===ah.newValue||ah.newValue===ah.oldValue?O_():setTimeout(O_,10)}notifyListeners(ah,_m){this.localCache[ah]=_m;const m_=this.listeners[ah];if(m_)for(const O_ of Array.from(m_))O_(_m&&JSON.parse(_m))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((ah,_m,m_)=>{this.onStorageEvent(new StorageEvent("storage",{key:ah,oldValue:_m,newValue:m_}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(ah,_m){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[ah]||(this.listeners[ah]=new Set,this.localCache[ah]=this.storage.getItem(ah)),this.listeners[ah].add(_m)}_removeListener(ah,_m){this.listeners[ah]&&(this.listeners[ah].delete(_m),0===this.listeners[ah].size&&delete this.listeners[ah]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(ah,_m){var m_=()=>super._set,O_=this;return(0,f.Z)(function*(){yield m_().call(O_,ah,_m),O_.localCache[ah]=JSON.stringify(_m)})()}_get(ah){var _m=()=>super._get,m_=this;return(0,f.Z)(function*(){const O_=yield _m().call(m_,ah);return m_.localCache[ah]=JSON.stringify(O_),O_})()}_remove(ah){var _m=()=>super._remove,m_=this;return(0,f.Z)(function*(){yield _m().call(m_,ah),delete m_.localCache[ah]})()}}return Nf.type="LOCAL",Nf})(),LT=(()=>{class Nf extends uU{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(ah,_m){}_removeListener(ah,_m){}}return Nf.type="SESSION",Nf})();let AV=(()=>{class Nf{constructor(ah){this.eventTarget=ah,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(ah){const _m=this.receivers.find(O_=>O_.isListeningto(ah));if(_m)return _m;const m_=new Nf(ah);return this.receivers.push(m_),m_}isListeningto(ah){return this.eventTarget===ah}handleEvent(ah){var _m=this;return(0,f.Z)(function*(){const m_=ah,{eventId:O_,eventType:s0,data:N0}=m_.data,tI=_m.handlersMap[s0];if(!(null==tI?void 0:tI.size))return;m_.ports[0].postMessage({status:"ack",eventId:O_,eventType:s0});const AI=Array.from(tI).map(function(){var GI=(0,f.Z)(function*(oS){return oS(m_.origin,N0)});return function(oS){return GI.apply(this,arguments)}}()),VI=yield function aM(Nf){return Promise.all(Nf.map(function(){var _c=(0,f.Z)(function*(ah){try{return{fulfilled:!0,value:yield ah}}catch(_m){return{fulfilled:!1,reason:_m}}});return function(ah){return _c.apply(this,arguments)}}()))}(AI);m_.ports[0].postMessage({status:"done",eventId:O_,eventType:s0,response:VI})})()}_subscribe(ah,_m){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[ah]||(this.handlersMap[ah]=new Set),this.handlersMap[ah].add(_m)}_unsubscribe(ah,_m){this.handlersMap[ah]&&_m&&this.handlersMap[ah].delete(_m),(!_m||0===this.handlersMap[ah].size)&&delete this.handlersMap[ah],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return Nf.receivers=[],Nf})();function cM(Nf="",_c=10){let ah="";for(let _m=0;_m<_c;_m++)ah+=Math.floor(10*Math.random());return Nf+ah}class CP{constructor(_c){this.target=_c,this.handlers=new Set}removeMessageHandler(_c){_c.messageChannel&&(_c.messageChannel.port1.removeEventListener("message",_c.onMessage),_c.messageChannel.port1.close()),this.handlers.delete(_c)}_send(_c,ah,_m=50){var m_=this;return(0,f.Z)(function*(){const O_="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!O_)throw new Error("connection_unavailable");let s0,N0;return new Promise((tI,AI)=>{const VI=cM("",20);O_.port1.start();const GI=setTimeout(()=>{AI(new Error("unsupported_event"))},_m);N0={messageChannel:O_,onMessage(oS){const FO=oS;if(FO.data.eventId===VI)switch(FO.data.status){case"ack":clearTimeout(GI),s0=setTimeout(()=>{AI(new Error("timeout"))},3e3);break;case"done":clearTimeout(s0),tI(FO.data.response);break;default:clearTimeout(GI),clearTimeout(s0),AI(new Error("invalid_response"))}}},m_.handlers.add(N0),O_.port1.addEventListener("message",N0.onMessage),m_.target.postMessage({eventType:_c,eventId:VI,data:ah},[O_.port2])}).finally(()=>{N0&&m_.removeMessageHandler(N0)})})()}}function tS(){return window}function tN(){return void 0!==tS().WorkerGlobalScope&&"function"==typeof tS().importScripts}function _V(){return(_V=(0,f.Z)(function*(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(Nf){return null}})).apply(this,arguments)}const uL="firebaseLocalStorageDb",TP="firebaseLocalStorage",uM="fbase_key";class SP{constructor(_c){this.request=_c}toPromise(){return new Promise((_c,ah)=>{this.request.addEventListener("success",()=>{_c(this.request.result)}),this.request.addEventListener("error",()=>{ah(this.request.error)})})}}function uS(Nf,_c){return Nf.transaction([TP],_c?"readwrite":"readonly").objectStore(TP)}function RP(){const Nf=indexedDB.open(uL,1);return new Promise((_c,ah)=>{Nf.addEventListener("error",()=>{ah(Nf.error)}),Nf.addEventListener("upgradeneeded",()=>{const _m=Nf.result;try{_m.createObjectStore(TP,{keyPath:uM})}catch(m_){ah(m_)}}),Nf.addEventListener("success",(0,f.Z)(function*(){const _m=Nf.result;_m.objectStoreNames.contains(TP)?_c(_m):(_m.close(),yield function lL(){const Nf=indexedDB.deleteDatabase(uL);return new SP(Nf).toPromise()}(),_c(yield RP()))}))})}function jN(Nf,_c,ah){return OP.apply(this,arguments)}function OP(){return(OP=(0,f.Z)(function*(Nf,_c,ah){const _m=uS(Nf,!0).put({[uM]:_c,value:ah});return new SP(_m).toPromise()})).apply(this,arguments)}function DP(){return(DP=(0,f.Z)(function*(Nf,_c){const ah=uS(Nf,!1).get(_c),_m=yield new SP(ah).toPromise();return void 0===_m?null:_m.value})).apply(this,arguments)}function VN(Nf,_c){const ah=uS(Nf,!0).delete(_c);return new SP(ah).toPromise()}const dL=(()=>{class Nf{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var ah=this;return(0,f.Z)(function*(){return ah.db||(ah.db=yield RP()),ah.db})()}_withRetries(ah){var _m=this;return(0,f.Z)(function*(){let m_=0;for(;;)try{const O_=yield _m._openDb();return yield ah(O_)}catch(O_){if(m_++>3)throw O_;_m.db&&(_m.db.close(),_m.db=void 0)}})()}initializeServiceWorkerMessaging(){var ah=this;return(0,f.Z)(function*(){return tN()?ah.initializeReceiver():ah.initializeSender()})()}initializeReceiver(){var ah=this;return(0,f.Z)(function*(){ah.receiver=AV._getInstance(function D3(){return tN()?self:null}()),ah.receiver._subscribe("keyChanged",function(){var _m=(0,f.Z)(function*(m_,O_){return{keyProcessed:(yield ah._poll()).includes(O_.key)}});return function(m_,O_){return _m.apply(this,arguments)}}()),ah.receiver._subscribe("ping",function(){var _m=(0,f.Z)(function*(m_,O_){return["keyChanged"]});return function(m_,O_){return _m.apply(this,arguments)}}())})()}initializeSender(){var ah=this;return(0,f.Z)(function*(){var _m,m_;if(ah.activeServiceWorker=yield function RI(){return _V.apply(this,arguments)}(),!ah.activeServiceWorker)return;ah.sender=new CP(ah.activeServiceWorker);const O_=yield ah.sender._send("ping",{},800);!O_||(null===(_m=O_[0])||void 0===_m?void 0:_m.fulfilled)&&(null===(m_=O_[0])||void 0===m_?void 0:m_.value.includes("keyChanged"))&&(ah.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(ah){var _m=this;return(0,f.Z)(function*(){if(_m.sender&&_m.activeServiceWorker&&function vV(){var Nf;return(null===(Nf=null==navigator?void 0:navigator.serviceWorker)||void 0===Nf?void 0:Nf.controller)||null}()===_m.activeServiceWorker)try{yield _m.sender._send("keyChanged",{key:ah},_m.serviceWorkerReceiverAvailable?800:50)}catch(m_){}})()}_isAvailable(){return(0,f.Z)(function*(){try{if(!indexedDB)return!1;const ah=yield RP();return yield jN(ah,FN,"1"),yield VN(ah,FN),!0}catch(ah){}return!1})()}_withPendingWrite(ah){var _m=this;return(0,f.Z)(function*(){_m.pendingWrites++;try{yield ah()}finally{_m.pendingWrites--}})()}_set(ah,_m){var m_=this;return(0,f.Z)(function*(){return m_._withPendingWrite((0,f.Z)(function*(){return yield m_._withRetries(O_=>jN(O_,ah,_m)),m_.localCache[ah]=_m,m_.notifyServiceWorker(ah)}))})()}_get(ah){var _m=this;return(0,f.Z)(function*(){const m_=yield _m._withRetries(O_=>function lM(Nf,_c){return DP.apply(this,arguments)}(O_,ah));return _m.localCache[ah]=m_,m_})()}_remove(ah){var _m=this;return(0,f.Z)(function*(){return _m._withPendingWrite((0,f.Z)(function*(){return yield _m._withRetries(m_=>VN(m_,ah)),delete _m.localCache[ah],_m.notifyServiceWorker(ah)}))})()}_poll(){var ah=this;return(0,f.Z)(function*(){const _m=yield ah._withRetries(s0=>{const N0=uS(s0,!1).getAll();return new SP(N0).toPromise()});if(!_m)return[];if(0!==ah.pendingWrites)return[];const m_=[],O_=new Set;for(const{fbase_key:s0,value:N0}of _m)O_.add(s0),JSON.stringify(ah.localCache[s0])!==JSON.stringify(N0)&&(ah.notifyListeners(s0,N0),m_.push(s0));for(const s0 of Object.keys(ah.localCache))ah.localCache[s0]&&!O_.has(s0)&&(ah.notifyListeners(s0,null),m_.push(s0));return m_})()}notifyListeners(ah,_m){this.localCache[ah]=_m;const m_=this.listeners[ah];if(m_)for(const O_ of Array.from(m_))O_(_m)}startPolling(){var ah=this;this.stopPolling(),this.pollTimer=setInterval((0,f.Z)(function*(){return ah._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(ah,_m){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[ah]||(this.listeners[ah]=new Set,this._get(ah)),this.listeners[ah].add(_m)}_removeListener(ah,_m){this.listeners[ah]&&(this.listeners[ah].delete(_m),0===this.listeners[ah].size&&delete this.listeners[ah]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return Nf.type="LOCAL",Nf})();function rS(Nf,_c){return w1(Nf,"POST","/v2/accounts/mfaSignIn:start",L1(Nf,_c))}function HT(){return(HT=(0,f.Z)(function*(Nf){return(yield w1(Nf,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function GN(Nf){return new Promise((_c,ah)=>{const _m=document.createElement("script");_m.setAttribute("src",Nf),_m.onload=_c,_m.onerror=m_=>{const O_=h0("internal-error");O_.customData=m_,ah(O_)},_m.type="text/javascript",_m.charset="UTF-8",function hL(){var Nf,_c;return null!==(_c=null===(Nf=document.getElementsByTagName("head"))||void 0===Nf?void 0:Nf[0])&&void 0!==_c?_c:document}().appendChild(_m)})}function C2(Nf){return`__${Nf}${Math.floor(1e6*Math.random())}`}const aR=1e12;class OS{constructor(_c){this.auth=_c,this.counter=aR,this._widgets=new Map}render(_c,ah){const _m=this.counter;return this._widgets.set(_m,new LO(_c,this.auth.name,ah||{})),this.counter++,_m}reset(_c){var ah;const _m=_c||aR;null===(ah=this._widgets.get(_m))||void 0===ah||ah.delete(),this._widgets.delete(_m)}getResponse(_c){var ah;return(null===(ah=this._widgets.get(_c||aR))||void 0===ah?void 0:ah.getResponse())||""}execute(_c){var ah=this;return(0,f.Z)(function*(){var _m;return null===(_m=ah._widgets.get(_c||aR))||void 0===_m||_m.execute(),""})()}}class LO{constructor(_c,ah,_m){this.params=_m,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const m_="string"==typeof _c?document.getElementById(_c):_c;P_(m_,"argument-error",{appName:ah}),this.container=m_,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function k3(Nf){const _c=[],ah="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let _m=0;_m<Nf;_m++)_c.push(ah.charAt(Math.floor(Math.random()*ah.length)));return _c.join("")}(50);const{callback:_c,"expired-callback":ah}=this.params;if(_c)try{_c(this.responseToken)}catch(_m){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,ah)try{ah()}catch(_m){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const i5=C2("rcb"),RT=new x1(3e4,6e4);class gY{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!tS().grecaptcha}load(_c,ah=""){return P_(function dM(Nf){return Nf.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(Nf)}(ah),_c,"argument-error"),this.shouldResolveImmediately(ah)?Promise.resolve(tS().grecaptcha):new Promise((_m,m_)=>{const O_=tS().setTimeout(()=>{m_(h0(_c,"network-request-failed"))},RT.get());tS()[i5]=()=>{tS().clearTimeout(O_),delete tS()[i5];const N0=tS().grecaptcha;if(!N0)return void m_(h0(_c,"internal-error"));const tI=N0.render;N0.render=(AI,VI)=>{const GI=tI(AI,VI);return this.counter++,GI},this.hostLanguage=ah,_m(N0)},GN(`https://www.google.com/recaptcha/api.js??${(0,q.xO)({onload:i5,render:"explicit",hl:ah})}`).catch(()=>{clearTimeout(O_),m_(h0(_c,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(_c){return!!tS().grecaptcha&&(_c===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class pO{load(_c){return(0,f.Z)(function*(){return new OS(_c)})()}clearedOneInstance(){}}const yV="recaptcha",PP={theme:"light",type:"image"};class o5{constructor(_c,ah=Object.assign({},PP),_m){this.parameters=ah,this.type=yV,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=NI(_m),this.isInvisible="invisible"===this.parameters.size,P_("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const m_="string"==typeof _c?document.getElementById(_c):_c;P_(m_,this.auth,"argument-error"),this.container=m_,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new pO:new gY,this.validateStartingState()}verify(){var _c=this;return(0,f.Z)(function*(){_c.assertNotDestroyed();const ah=yield _c.render(),_m=_c.getAssertedRecaptcha();return _m.getResponse(ah)||new Promise(O_=>{const s0=N0=>{!N0||(_c.tokenChangeListeners.delete(s0),O_(N0))};_c.tokenChangeListeners.add(s0),_c.isInvisible&&_m.execute(ah)})})()}render(){try{this.assertNotDestroyed()}catch(_c){return Promise.reject(_c)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(_c=>{throw this.renderPromise=null,_c})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(_c=>{this.container.removeChild(_c)})}validateStartingState(){P_(!this.parameters.sitekey,this.auth,"argument-error"),P_(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),P_("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(_c){return ah=>{if(this.tokenChangeListeners.forEach(_m=>_m(ah)),"function"==typeof _c)_c(ah);else if("string"==typeof _c){const _m=tS()[_c];"function"==typeof _m&&_m(ah)}}}assertNotDestroyed(){P_(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var _c=this;return(0,f.Z)(function*(){if(yield _c.init(),!_c.widgetId){let ah=_c.container;if(!_c.isInvisible){const _m=document.createElement("div");ah.appendChild(_m),ah=_m}_c.widgetId=_c.getAssertedRecaptcha().render(ah,_c.parameters)}return _c.widgetId})()}init(){var _c=this;return(0,f.Z)(function*(){P_(O0()&&!tN(),_c.auth,"internal-error"),yield function w2(){let Nf=null;return new Promise(_c=>{"complete"!==document.readyState?(Nf=()=>_c(),window.addEventListener("load",Nf)):_c()}).catch(_c=>{throw Nf&&window.removeEventListener("load",Nf),_c})}(),_c.recaptcha=yield _c._recaptchaLoader.load(_c.auth,_c.auth.languageCode||void 0);const ah=yield function kP(Nf){return HT.apply(this,arguments)}(_c.auth);P_(ah,_c.auth,"internal-error"),_c.parameters.sitekey=ah})()}getAssertedRecaptcha(){return P_(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class P3{constructor(_c,ah){this.verificationId=_c,this.onConfirmation=ah}confirm(_c){const ah=mP._fromVerification(this.verificationId,_c);return this.onConfirmation(ah)}}function dU(){return(dU=(0,f.Z)(function*(Nf,_c,ah){const _m=NI(Nf),m_=yield KR(_m,_c,(0,q.m9)(ah));return new P3(m_,O_=>kT(_m,O_))})).apply(this,arguments)}function EV(){return(EV=(0,f.Z)(function*(Nf,_c,ah){const _m=(0,q.m9)(Nf);yield K1(!1,_m,"phone");const m_=yield KR(_m.auth,_c,(0,q.m9)(ah));return new P3(m_,O_=>sR(_m,O_))})).apply(this,arguments)}function yR(){return(yR=(0,f.Z)(function*(Nf,_c,ah){const _m=(0,q.m9)(Nf),m_=yield KR(_m.auth,_c,(0,q.m9)(ah));return new P3(m_,O_=>y2(_m,O_))})).apply(this,arguments)}function KR(Nf,_c,ah){return hM.apply(this,arguments)}function hM(){return(hM=(0,f.Z)(function*(Nf,_c,ah){var _m;const m_=yield ah.verify();try{let O_;if(P_("string"==typeof m_,Nf,"argument-error"),P_(ah.type===yV,Nf,"argument-error"),O_="string"==typeof _c?{phoneNumber:_c}:_c,"session"in O_){const s0=O_.session;if("phoneNumber"in O_)return P_("enroll"===s0.type,Nf,"internal-error"),(yield gV(Nf,{idToken:s0.credential,phoneEnrollmentInfo:{phoneNumber:O_.phoneNumber,recaptchaToken:m_}})).phoneSessionInfo.sessionInfo;{P_("signin"===s0.type,Nf,"internal-error");const N0=(null===(_m=O_.multiFactorHint)||void 0===_m?void 0:_m.uid)||O_.multiFactorUid;return P_(N0,Nf,"missing-multi-factor-info"),(yield rS(Nf,{mfaPendingCredential:s0.credential,mfaEnrollmentId:N0,phoneSignInInfo:{recaptchaToken:m_}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:s0}=yield v9(Nf,{phoneNumber:O_.phoneNumber,recaptchaToken:m_});return s0}}finally{ah._reset()}})).apply(this,arguments)}function T2(){return(T2=(0,f.Z)(function*(Nf,_c){yield tU((0,q.m9)(Nf),_c)})).apply(this,arguments)}let S2=(()=>{class Nf{constructor(ah){this.providerId=Nf.PROVIDER_ID,this.auth=NI(ah)}verifyPhoneNumber(ah,_m){return KR(this.auth,ah,(0,q.m9)(_m))}static credential(ah,_m){return mP._fromVerification(ah,_m)}static credentialFromResult(ah){return Nf.credentialFromTaggedObject(ah)}static credentialFromError(ah){return Nf.credentialFromTaggedObject(ah.customData||{})}static credentialFromTaggedObject({_tokenResponse:ah}){if(!ah)return null;const{phoneNumber:_m,temporaryProof:m_}=ah;return _m&&m_?mP._fromTokenResponse(_m,m_):null}}return Nf.PROVIDER_ID="phone",Nf.PHONE_SIGN_IN_METHOD="phone",Nf})();function R2(Nf,_c){return _c?F_(_c):(P_(Nf._popupRedirectResolver,Nf,"argument-error"),Nf._popupRedirectResolver)}class O2 extends RO{constructor(_c){super("custom","custom"),this.params=_c}_getIdTokenResponse(_c){return yT(_c,this._buildIdpRequest())}_linkToIdToken(_c,ah){return yT(_c,this._buildIdpRequest(ah))}_getReauthenticationResolver(_c){return yT(_c,this._buildIdpRequest())}_buildIdpRequest(_c){const ah={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return _c&&(ah.idToken=_c),ah}}function v1(Nf){return WS(Nf.auth,new O2(Nf),Nf.bypassAuthState)}function s5(Nf){const{auth:_c,user:ah}=Nf;return P_(ah,_c,"internal-error"),E3(ah,new O2(Nf),Nf.bypassAuthState)}function fL(Nf){return ER.apply(this,arguments)}function ER(){return(ER=(0,f.Z)(function*(Nf){const{auth:_c,user:ah}=Nf;return P_(ah,_c,"internal-error"),tU(ah,new O2(Nf),Nf.bypassAuthState)})).apply(this,arguments)}class pM{constructor(_c,ah,_m,m_,O_=!1){this.auth=_c,this.resolver=_m,this.user=m_,this.bypassAuthState=O_,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(ah)?ah:[ah]}execute(){var _c=this;return new Promise(function(){var ah=(0,f.Z)(function*(_m,m_){_c.pendingPromise={resolve:_m,reject:m_};try{_c.eventManager=yield _c.resolver._initialize(_c.auth),yield _c.onExecution(),_c.eventManager.registerConsumer(_c)}catch(O_){_c.reject(O_)}});return function(_m,m_){return ah.apply(this,arguments)}}())}onAuthEvent(_c){var ah=this;return(0,f.Z)(function*(){const{urlResponse:_m,sessionId:m_,postBody:O_,tenantId:s0,error:N0,type:tI}=_c;if(N0)return void ah.reject(N0);const AI={auth:ah.auth,requestUri:_m,sessionId:m_,tenantId:s0||void 0,postBody:O_||void 0,user:ah.user,bypassAuthState:ah.bypassAuthState};try{ah.resolve(yield ah.getIdpTask(tI)(AI))}catch(VI){ah.reject(VI)}})()}onError(_c){this.reject(_c)}getIdpTask(_c){switch(_c){case"signInViaPopup":case"signInViaRedirect":return v1;case"linkViaPopup":case"linkViaRedirect":return fL;case"reauthViaPopup":case"reauthViaRedirect":return s5;default:Pv(this.auth,"internal-error")}}resolve(_c){E_(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(_c),this.unregisterAndCleanUp()}reject(_c){E_(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(_c),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const pL=new x1(2e3,1e4);function D2(){return(D2=(0,f.Z)(function*(Nf,_c,ah){const _m=NI(Nf);G_(Nf,_c,_R);const m_=R2(_m,ah);return new bV(_m,"signInViaPopup",_c,m_).executeNotNull()})).apply(this,arguments)}function L3(){return(L3=(0,f.Z)(function*(Nf,_c,ah){const _m=(0,q.m9)(Nf);G_(_m.auth,_c,_R);const m_=R2(_m.auth,ah);return new bV(_m.auth,"reauthViaPopup",_c,m_,_m).executeNotNull()})).apply(this,arguments)}function nN(){return(nN=(0,f.Z)(function*(Nf,_c,ah){const _m=(0,q.m9)(Nf);G_(_m.auth,_c,_R);const m_=R2(_m.auth,ah);return new bV(_m.auth,"linkViaPopup",_c,m_,_m).executeNotNull()})).apply(this,arguments)}let bV=(()=>{class Nf extends pM{constructor(ah,_m,m_,O_,s0){super(ah,_m,O_,s0),this.provider=m_,this.authWindow=null,this.pollId=null,Nf.currentPopupAction&&Nf.currentPopupAction.cancel(),Nf.currentPopupAction=this}executeNotNull(){var ah=this;return(0,f.Z)(function*(){const _m=yield ah.execute();return P_(_m,ah.auth,"internal-error"),_m})()}onExecution(){var ah=this;return(0,f.Z)(function*(){E_(1===ah.filter.length,"Popup operations only handle one event");const _m=cM();ah.authWindow=yield ah.resolver._openPopup(ah.auth,ah.provider,ah.filter[0],_m),ah.authWindow.associatedEvent=_m,ah.resolver._originValidation(ah.auth).catch(m_=>{ah.reject(m_)}),ah.resolver._isIframeWebStorageSupported(ah.auth,m_=>{m_||ah.reject(h0(ah.auth,"web-storage-unsupported"))}),ah.pollUserCancellation()})()}get eventId(){var ah;return(null===(ah=this.authWindow)||void 0===ah?void 0:ah.associatedEvent)||null}cancel(){this.reject(h0(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Nf.currentPopupAction=null}pollUserCancellation(){const ah=()=>{var _m,m_;this.pollId=(null===(m_=null===(_m=this.authWindow)||void 0===_m?void 0:_m.window)||void 0===m_?void 0:m_.closed)?window.setTimeout(()=>{this.pollId=null,this.reject(h0(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(ah,pL.get())};ah()}}return Nf.currentPopupAction=null,Nf})();const DS=new Map;class a5 extends pM{constructor(_c,ah,_m=!1){super(_c,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],ah,void 0,_m),this.eventId=null}execute(){var _c=()=>super.execute,ah=this;return(0,f.Z)(function*(){let _m=DS.get(ah.auth._key());if(!_m){try{const O_=(yield function RG(Nf,_c){return BO.apply(this,arguments)}(ah.resolver,ah.auth))?yield _c().call(ah):null;_m=()=>Promise.resolve(O_)}catch(m_){_m=()=>Promise.reject(m_)}DS.set(ah.auth._key(),_m)}return ah.bypassAuthState||DS.set(ah.auth._key(),()=>Promise.resolve(null)),_m()})()}onAuthEvent(_c){var ah=()=>super.onAuthEvent,_m=this;return(0,f.Z)(function*(){if("signInViaRedirect"===_c.type)return ah().call(_m,_c);if("unknown"!==_c.type){if(_c.eventId){const m_=yield _m.auth._redirectUserForId(_c.eventId);if(m_)return _m.user=m_,ah().call(_m,_c);_m.resolve(null)}}else _m.resolve(null)})()}onExecution(){return(0,f.Z)(function*(){})()}cleanUp(){}}function BO(){return(BO=(0,f.Z)(function*(Nf,_c){const ah=K_(_c),_m=T_(Nf);if(!(yield _m._isAvailable()))return!1;const m_="true"===(yield _m._get(ah));return yield _m._remove(ah),m_})).apply(this,arguments)}function gL(Nf,_c){return N2.apply(this,arguments)}function N2(){return(N2=(0,f.Z)(function*(Nf,_c){return T_(Nf)._set(K_(_c),"true")})).apply(this,arguments)}function d_(Nf,_c){DS.set(Nf._key(),_c)}function T_(Nf){return F_(Nf._redirectPersistence)}function K_(Nf){return ZT("pendingRedirect",Nf.config.apiKey,Nf.name)}function k0(){return(k0=(0,f.Z)(function*(Nf,_c,ah){const _m=NI(Nf);G_(Nf,_c,_R);const m_=R2(_m,ah);return yield gL(m_,_m),m_._openRedirect(_m,_c,"signInViaRedirect")})).apply(this,arguments)}function jI(){return(jI=(0,f.Z)(function*(Nf,_c,ah){const _m=(0,q.m9)(Nf);G_(_m.auth,_c,_R);const m_=R2(_m.auth,ah);yield gL(m_,_m.auth);const O_=yield cR(_m);return m_._openRedirect(_m.auth,_c,"reauthViaRedirect",O_)})).apply(this,arguments)}function dS(){return(dS=(0,f.Z)(function*(Nf,_c,ah){const _m=(0,q.m9)(Nf);G_(_m.auth,_c,_R);const m_=R2(_m.auth,ah);yield K1(!1,_m,_c.providerId),yield gL(m_,_m.auth);const O_=yield cR(_m);return m_._openRedirect(_m.auth,_c,"linkViaRedirect",O_)})).apply(this,arguments)}function QN(){return(QN=(0,f.Z)(function*(Nf,_c){return yield NI(Nf)._initializationPromise,rN(Nf,_c,!1)})).apply(this,arguments)}function rN(Nf,_c){return zR.apply(this,arguments)}function zR(){return(zR=(0,f.Z)(function*(Nf,_c,ah=!1){const _m=NI(Nf),m_=R2(_m,_c),s0=yield new a5(_m,m_,ah).execute();return s0&&!ah&&(delete s0.user._redirectEventId,yield _m._persistUserIfCurrent(s0.user),yield _m._setRedirectUser(null,_c)),s0})).apply(this,arguments)}function cR(Nf){return k2.apply(this,arguments)}function k2(){return(k2=(0,f.Z)(function*(Nf){const _c=cM(`${Nf.uid}:::`);return Nf._redirectEventId=_c,yield Nf.auth._setRedirectUser(Nf),yield Nf.auth._persistUserIfCurrent(Nf),_c})).apply(this,arguments)}class gM{constructor(_c){this.auth=_c,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(_c){this.consumers.add(_c),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,_c)&&(this.sendToConsumer(this.queuedRedirectEvent,_c),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(_c){this.consumers.delete(_c)}onEvent(_c){if(this.hasEventBeenHandled(_c))return!1;let ah=!1;return this.consumers.forEach(_m=>{this.isEventForConsumer(_c,_m)&&(ah=!0,this.sendToConsumer(_c,_m),this.saveEventToCache(_c))}),this.hasHandledPotentialRedirect||!function CV(Nf){switch(Nf.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return c5(Nf);default:return!1}}(_c)||(this.hasHandledPotentialRedirect=!0,ah||(this.queuedRedirectEvent=_c,ah=!0)),ah}sendToConsumer(_c,ah){var _m;if(_c.error&&!c5(_c)){const m_=(null===(_m=_c.error.code)||void 0===_m?void 0:_m.split("auth/")[1])||"internal-error";ah.onError(h0(this.auth,m_))}else ah.onAuthEvent(_c)}isEventForConsumer(_c,ah){const _m=null===ah.eventId||!!_c.eventId&&_c.eventId===ah.eventId;return ah.filter.includes(_c.type)&&_m}hasEventBeenHandled(_c){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(YR(_c))}saveEventToCache(_c){this.cachedEventUids.add(YR(_c)),this.lastProcessedEventTime=Date.now()}}function YR(Nf){return[Nf.type,Nf.eventId,Nf.sessionId,Nf.tenantId].filter(_c=>_c).join("-")}function c5({type:Nf,error:_c}){return"unknown"===Nf&&"auth/no-auth-event"===(null==_c?void 0:_c.code)}function wV(Nf){return OG.apply(this,arguments)}function OG(){return(OG=(0,f.Z)(function*(Nf,_c={}){return w1(Nf,"GET","/v1/projects",_c)})).apply(this,arguments)}const TV=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,hU=/^https?/;function SV(){return(SV=(0,f.Z)(function*(Nf){if(Nf.config.emulator)return;const{authorizedDomains:_c}=yield wV(Nf);for(const ah of _c)try{if(jX(ah))return}catch(_m){}Pv(Nf,"unauthorized-domain")})).apply(this,arguments)}function jX(Nf){const _c=D0(),{protocol:ah,hostname:_m}=new URL(_c);if(Nf.startsWith("chrome-extension://")){const s0=new URL(Nf);return""===s0.hostname&&""===_m?"chrome-extension:"===ah&&Nf.replace("chrome-extension://","")===_c.replace("chrome-extension://",""):"chrome-extension:"===ah&&s0.hostname===_m}if(!hU.test(ah))return!1;if(TV.test(Nf))return _m===Nf;const m_=Nf.replace(/\./g,"\\.");return new RegExp("^(.+\\."+m_+"|"+m_+")$","i").test(_m)}const T9=new x1(3e4,6e4);function l5(){const Nf=tS().___jsl;if(null==Nf?void 0:Nf.H)for(const _c of Object.keys(Nf.H))if(Nf.H[_c].r=Nf.H[_c].r||[],Nf.H[_c].L=Nf.H[_c].L||[],Nf.H[_c].r=[...Nf.H[_c].L],Nf.CP)for(let ah=0;ah<Nf.CP.length;ah++)Nf.CP[ah]=null}let M3=null;function x2(Nf){return M3=M3||function RV(Nf){return new Promise((_c,ah)=>{var _m,m_,O_;function s0(){l5(),gapi.load("gapi.iframes",{callback:()=>{_c(gapi.iframes.getContext())},ontimeout:()=>{l5(),ah(h0(Nf,"network-request-failed"))},timeout:T9.get()})}if(null===(m_=null===(_m=tS().gapi)||void 0===_m?void 0:_m.iframes)||void 0===m_?void 0:m_.Iframe)_c(gapi.iframes.getContext());else{if(!(null===(O_=tS().gapi)||void 0===O_?void 0:O_.load)){const N0=C2("iframefcb");return tS()[N0]=()=>{gapi.load?s0():ah(h0(Nf,"network-request-failed"))},GN(`https://apis.google.com/js/api.js?onload=${N0}`).catch(tI=>ah(tI))}s0()}}).catch(_c=>{throw M3=null,_c})}(Nf),M3}const B3=new x1(5e3,15e3),mM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},iN=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function S9(Nf){const _c=Nf.config;P_(_c.authDomain,Nf,"auth-domain-config-required");const ah=_c.emulator?_1(_c,"emulator/auth/iframe"):`https://${Nf.config.authDomain}/__/auth/iframe`,_m={apiKey:_c.apiKey,appName:Nf.name,v:_r.SDK_VERSION},m_=iN.get(Nf.config.apiHost);m_&&(_m.eid=m_);const O_=Nf._getFrameworks();return O_.length&&(_m.fw=O_.join(",")),`${ah}?${(0,q.xO)(_m).slice(1)}`}function L2(){return L2=(0,f.Z)(function*(Nf){const _c=yield x2(Nf),ah=tS().gapi;return P_(ah,Nf,"internal-error"),_c.open({where:document.body,url:S9(Nf),messageHandlersFilter:ah.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:mM,dontclear:!0},_m=>new Promise(function(){var m_=(0,f.Z)(function*(O_,s0){yield _m.restyle({setHideOnLeave:!1});const N0=h0(Nf,"network-request-failed"),tI=tS().setTimeout(()=>{s0(N0)},B3.get());function AI(){tS().clearTimeout(tI),O_(_m)}_m.ping(AI).then(AI,()=>{s0(N0)})});return function(O_,s0){return m_.apply(this,arguments)}}()))}),L2.apply(this,arguments)}const d5={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class pU{constructor(_c){this.window=_c,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(_c){}}}function gO(Nf,_c,ah,_m,m_,O_){P_(Nf.config.authDomain,Nf,"auth-domain-config-required"),P_(Nf.config.apiKey,Nf,"invalid-api-key");const s0={apiKey:Nf.config.apiKey,appName:Nf.name,authType:ah,redirectUrl:_m,v:_r.SDK_VERSION,eventId:m_};if(_c instanceof _R){_c.setDefaultLanguage(Nf.languageCode),s0.providerId=_c.providerId||"",(0,q.xb)(_c.getCustomParameters())||(s0.customParameters=JSON.stringify(_c.getCustomParameters()));for(const[tI,AI]of Object.entries(O_||{}))s0[tI]=AI}if(_c instanceof TS){const tI=_c.getScopes().filter(AI=>""!==AI);tI.length>0&&(s0.scopes=tI.join(","))}Nf.tenantId&&(s0.tid=Nf.tenantId);const N0=s0;for(const tI of Object.keys(N0))void 0===N0[tI]&&delete N0[tI];return`${function LP({config:Nf}){return Nf.emulator?_1(Nf,"emulator/auth/handler"):`https://${Nf.authDomain}/__/auth/handler`}(Nf)}?${(0,q.xO)(N0).slice(1)}`}const F3="webStorageSupport";class f5 extends class N9{constructor(_c){this.factorId=_c}_process(_c,ah,_m){switch(ah.type){case"enroll":return this._finalizeEnroll(_c,ah.credential,_m);case"signin":return this._finalizeSignIn(_c,ah.credential);default:return _v("unexpected MultiFactorSessionType")}}}{constructor(_c){super("phone"),this.credential=_c}static _fromCredential(_c){return new f5(_c)}_finalizeEnroll(_c,ah,_m){return function b9(Nf,_c){return w1(Nf,"POST","/v2/accounts/mfaEnrollment:finalize",L1(Nf,_c))}(_c,{idToken:ah,displayName:_m,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(_c,ah){return function N3(Nf,_c){return w1(Nf,"POST","/v2/accounts/mfaSignIn:finalize",L1(Nf,_c))}(_c,{mfaPendingCredential:ah,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let kG=(()=>{class Nf{constructor(){}static assertion(ah){return f5._fromCredential(ah)}}return Nf.FACTOR_ID="phone",Nf})();var PG="@firebase/auth";class P9{constructor(_c){this.auth=_c,this.internalListeners=new Map}getUid(){var _c;return this.assertAuthConfigured(),(null===(_c=this.auth.currentUser)||void 0===_c?void 0:_c.uid)||null}getToken(_c){var ah=this;return(0,f.Z)(function*(){return ah.assertAuthConfigured(),yield ah.auth._initializationPromise,ah.auth.currentUser?{accessToken:yield ah.auth.currentUser.getIdToken(_c)}:null})()}addAuthTokenListener(_c){if(this.assertAuthConfigured(),this.internalListeners.has(_c))return;const ah=this.auth.onIdTokenChanged(_m=>{var m_;_c((null===(m_=_m)||void 0===m_?void 0:m_.stsTokenManager.accessToken)||null)});this.internalListeners.set(_c,ah),this.updateProactiveRefresh()}removeAuthTokenListener(_c){this.assertAuthConfigured();const ah=this.internalListeners.get(_c);!ah||(this.internalListeners.delete(_c),ah(),this.updateProactiveRefresh())}assertAuthConfigured(){P_(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function AM(){return window}function sN(){return(sN=(0,f.Z)(function*(Nf,_c,ah){var _m;const{BuildInfo:m_}=AM();E_(_c.sessionId,"AuthEvent did not contain a session ID");const O_=yield VX(_c.sessionId),s0={};return hO()?s0.ibi=m_.packageName:X1()?s0.apn=m_.packageName:Pv(Nf,"operation-not-supported-in-this-environment"),m_.displayName&&(s0.appDisplayName=m_.displayName),s0.sessionId=O_,gO(Nf,ah,_c.type,void 0,null!==(_m=_c.eventId)&&void 0!==_m?_m:void 0,s0)})).apply(this,arguments)}function V3(){return(V3=(0,f.Z)(function*(Nf){const{BuildInfo:_c}=AM(),ah={};hO()?ah.iosBundleId=_c.packageName:X1()?ah.androidPackageName=_c.packageName:Pv(Nf,"operation-not-supported-in-this-environment"),yield wV(Nf,ah)})).apply(this,arguments)}function M9(){return(M9=(0,f.Z)(function*(Nf,_c,ah){const{cordova:_m}=AM();let m_=()=>{};try{yield new Promise((O_,s0)=>{let N0=null;function tI(){var GI;O_();const oS=null===(GI=_m.plugins.browsertab)||void 0===GI?void 0:GI.close;"function"==typeof oS&&oS(),"function"==typeof(null==ah?void 0:ah.close)&&ah.close()}function AI(){N0||(N0=window.setTimeout(()=>{s0(h0(Nf,"redirect-cancelled-by-user"))},2e3))}function VI(){"visible"===(null==document?void 0:document.visibilityState)&&AI()}_c.addPassiveListener(tI),document.addEventListener("resume",AI,!1),X1()&&document.addEventListener("visibilitychange",VI,!1),m_=()=>{_c.removePassiveListener(tI),document.removeEventListener("resume",AI,!1),document.removeEventListener("visibilitychange",VI,!1),N0&&window.clearTimeout(N0)}})}finally{m_()}})).apply(this,arguments)}function VX(Nf){return Q3.apply(this,arguments)}function Q3(){return(Q3=(0,f.Z)(function*(Nf){const _c=xG(Nf),ah=yield crypto.subtle.digest("SHA-256",_c);return Array.from(new Uint8Array(ah)).map(m_=>m_.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function xG(Nf){if(E_(/[0-9a-zA-Z]+/.test(Nf),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(Nf);const _c=new ArrayBuffer(Nf.length),ah=new Uint8Array(_c);for(let _m=0;_m<Nf.length;_m++)ah[_m]=Nf.charCodeAt(_m);return ah}!function x9(Nf){(0,_r._registerComponent)(new _l.wA("auth",(_c,{options:ah})=>{const _m=_c.getProvider("app").getImmediate(),m_=_c.getProvider("heartbeat"),{apiKey:O_,authDomain:s0}=_m.options;return((N0,tI)=>{P_(O_&&!O_.includes(":"),"invalid-api-key",{appName:N0.name}),P_(!(null==s0?void 0:s0.includes(":")),"argument-error",{appName:N0.name});const AI={apiKey:O_,authDomain:s0,clientPlatform:Nf,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$L(Nf)},VI=new dI(N0,tI,AI);return function Y_(Nf,_c){const ah=(null==_c?void 0:_c.persistence)||[],_m=(Array.isArray(ah)?ah:[ah]).map(F_);(null==_c?void 0:_c.errorMap)&&Nf._updateErrorMap(_c.errorMap),Nf._initializeWithPersistence(_m,null==_c?void 0:_c.popupRedirectResolver)}(VI,ah),VI})(_m,m_)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((_c,ah,_m)=>{_c.getProvider("auth-internal").initialize()})),(0,_r._registerComponent)(new _l.wA("auth-internal",_c=>{const ah=NI(_c.getProvider("auth").getImmediate());return new P9(ah)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,_r.registerVersion)(PG,"0.20.1",function j3(Nf){switch(Nf){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Nf)),(0,_r.registerVersion)(PG,"0.20.1","esm2017")}("Browser");class H3 extends gM{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(_c=>{this.resolveInialized=_c})}addPassiveListener(_c){this.passiveListeners.add(_c)}removePassiveListener(_c){this.passiveListeners.delete(_c)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(_c){return this.resolveInialized(),this.passiveListeners.forEach(ah=>ah(_c)),super.onEvent(_c)}initialized(){var _c=this;return(0,f.Z)(function*(){yield _c.initPromise})()}}function mU(Nf){return A5.apply(this,arguments)}function A5(){return(A5=(0,f.Z)(function*(Nf){const _c=yield aN()._get(q3(Nf));return _c&&(yield aN()._remove(q3(Nf))),_c})).apply(this,arguments)}function _5(){const Nf=[],_c="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let ah=0;ah<20;ah++){const _m=Math.floor(Math.random()*_c.length);Nf.push(_c.charAt(_m))}return Nf.join("")}function aN(){return F_(xT)}function q3(Nf){return ZT("authEvent",Nf.config.apiKey,Nf.name)}function JR(Nf){if(!(null==Nf?void 0:Nf.includes("?")))return{};const[_c,...ah]=Nf.split("?");return(0,q.zd)(ah.join("?"))}function AU(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:h0("no-auth-event")}}function _U(){var Nf;return(null===(Nf=null==self?void 0:self.location)||void 0===Nf?void 0:Nf.protocol)||null}function B9(Nf=(0,q.z$)()){return!("file:"!==_U()&&"ionic:"!==_U()||!Nf.toLowerCase().match(/iphone|ipad|ipod|android/))}function UG(){try{const Nf=self.localStorage,_c=cM();if(Nf)return Nf.setItem(_c,"1"),Nf.removeItem(_c),!function LV(Nf=(0,q.z$)()){return function vU(){return(0,q.w1)()&&11===(null==document?void 0:document.documentMode)}()||function hS(Nf=(0,q.z$)()){return/Edge\/\d+/.test(Nf)}(Nf)}()||(0,q.hl)()}catch(Nf){return y5()&&(0,q.hl)()}return!1}function y5(){return"undefined"!=typeof global&&"WorkerGlobalScope"in global&&"importScripts"in global}function kS(){return(function MG(){return"http:"===_U()||"https:"===_U()}()||(0,q.ru)()||B9())&&!function BG(){return(0,q.b$)()||(0,q.UG)()}()&&UG()&&!y5()}function W3(){return B9()&&"undefined"!=typeof document}function I5(){return(I5=(0,f.Z)(function*(){return!!W3()&&new Promise(Nf=>{const _c=setTimeout(()=>{Nf(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(_c),Nf(!0)})})})).apply(this,arguments)}const uR={LOCAL:"local",NONE:"none",SESSION:"session"},vL=P_,FG="persistence";function vM(Nf){return jG.apply(this,arguments)}function jG(){return(jG=(0,f.Z)(function*(Nf){yield Nf._initializationPromise;const _c=UP(),ah=ZT(FG,Nf.config.apiKey,Nf.name);_c&&_c.setItem(ah,Nf._getPersistence())})).apply(this,arguments)}function UP(){var Nf;try{return(null===(Nf=function vY(){return"undefined"!=typeof window?window:null}())||void 0===Nf?void 0:Nf.sessionStorage)||null}catch(_c){return null}}const FP=P_;class $R{constructor(){this.browserResolver=F_(class D9{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=LT,this._completeRedirectFn=rN,this._overrideRedirectResult=d_}_openPopup(_c,ah,_m,m_){var O_=this;return(0,f.Z)(function*(){var s0;E_(null===(s0=O_.eventManagers[_c._key()])||void 0===s0?void 0:s0.manager,"_initialize() not called before _openPopup()");const N0=gO(_c,ah,_m,D0(),m_);return function gU(Nf,_c,ah,_m=500,m_=600){const O_=Math.max((window.screen.availHeight-m_)/2,0).toString(),s0=Math.max((window.screen.availWidth-_m)/2,0).toString();let N0="";const tI=Object.assign(Object.assign({},d5),{width:_m.toString(),height:m_.toString(),top:O_,left:s0}),AI=(0,q.z$)().toLowerCase();ah&&(N0=JM(AI)?"_blank":ah),YM(AI)&&(_c=_c||"http://localhost",tI.scrollbars="yes");const VI=Object.entries(tI).reduce((oS,[FO,K3])=>`${oS}${FO}=${K3},`,"");if(function m2(Nf=(0,q.z$)()){var _c;return hO(Nf)&&!!(null===(_c=window.navigator)||void 0===_c?void 0:_c.standalone)}(AI)&&"_self"!==N0)return function DG(Nf,_c){const ah=document.createElement("a");ah.href=Nf,ah.target=_c;const _m=document.createEvent("MouseEvent");_m.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),ah.dispatchEvent(_m)}(_c||"",N0),new pU(null);const GI=window.open(_c||"",N0,VI);P_(GI,Nf,"popup-blocked");try{GI.focus()}catch(oS){}return new pU(GI)}(_c,N0,cM())})()}_openRedirect(_c,ah,_m,m_){var O_=this;return(0,f.Z)(function*(){return yield O_._originValidation(_c),function wP(Nf){tS().location.href=Nf}(gO(_c,ah,_m,D0(),m_)),new Promise(()=>{})})()}_initialize(_c){const ah=_c._key();if(this.eventManagers[ah]){const{manager:m_,promise:O_}=this.eventManagers[ah];return m_?Promise.resolve(m_):(E_(O_,"If manager is not set, promise should be"),O_)}const _m=this.initAndGetManager(_c);return this.eventManagers[ah]={promise:_m},_m.catch(()=>{delete this.eventManagers[ah]}),_m}initAndGetManager(_c){var ah=this;return(0,f.Z)(function*(){const _m=yield function R9(Nf){return L2.apply(this,arguments)}(_c),m_=new gM(_c);return _m.register("authEvent",O_=>(P_(null==O_?void 0:O_.authEvent,_c,"invalid-auth-event"),{status:m_.onEvent(O_.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),ah.eventManagers[_c._key()]={manager:m_},ah.iframes[_c._key()]=_m,m_})()}_isIframeWebStorageSupported(_c,ah){this.iframes[_c._key()].send(F3,{type:F3},m_=>{var O_;const s0=null===(O_=null==m_?void 0:m_[0])||void 0===O_?void 0:O_[F3];void 0!==s0&&ah(!!s0),Pv(_c,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(_c){const ah=_c._key();return this.originValidationPromises[ah]||(this.originValidationPromises[ah]=function u5(Nf){return SV.apply(this,arguments)}(_c)),this.originValidationPromises[ah]}get _shouldInitProactively(){return hP()||ON()||hO()}}),this.cordovaResolver=F_(class kV{constructor(){this._redirectPersistence=LT,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=rN,this._overrideRedirectResult=d_}_initialize(_c){var ah=this;return(0,f.Z)(function*(){const _m=_c._key();let m_=ah.eventManagers.get(_m);return m_||(m_=new H3(_c),ah.eventManagers.set(_m,m_),ah.attachCallbackListeners(_c,m_)),m_})()}_openPopup(_c){Pv(_c,"operation-not-supported-in-this-environment")}_openRedirect(_c,ah,_m,m_){var O_=this;return(0,f.Z)(function*(){!function G3(Nf){var _c,ah,_m,m_,O_,s0,N0,tI,AI,VI;const GI=AM();P_("function"==typeof(null===(_c=null==GI?void 0:GI.universalLinks)||void 0===_c?void 0:_c.subscribe),Nf,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),P_(void 0!==(null===(ah=null==GI?void 0:GI.BuildInfo)||void 0===ah?void 0:ah.packageName),Nf,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),P_("function"==typeof(null===(O_=null===(m_=null===(_m=null==GI?void 0:GI.cordova)||void 0===_m?void 0:_m.plugins)||void 0===m_?void 0:m_.browsertab)||void 0===O_?void 0:O_.openUrl),Nf,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),P_("function"==typeof(null===(tI=null===(N0=null===(s0=null==GI?void 0:GI.cordova)||void 0===s0?void 0:s0.plugins)||void 0===N0?void 0:N0.browsertab)||void 0===tI?void 0:tI.isAvailable),Nf,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),P_("function"==typeof(null===(VI=null===(AI=null==GI?void 0:GI.cordova)||void 0===AI?void 0:AI.InAppBrowser)||void 0===VI?void 0:VI.open),Nf,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(_c);const s0=yield O_._initialize(_c);yield s0.initialized(),s0.resetRedirect(),function c_(){DS.clear()}(),yield O_._originValidation(_c);const N0=function m5(Nf,_c,ah=null){return{type:_c,eventId:ah,urlResponse:null,sessionId:_5(),postBody:null,tenantId:Nf.tenantId,error:h0(Nf,"no-auth-event")}}(_c,_m,m_);yield function LG(Nf,_c){return aN()._set(q3(Nf),_c)}(_c,N0);const tI=yield function DV(Nf,_c,ah){return sN.apply(this,arguments)}(_c,N0,ah),AI=yield function g5(Nf){const{cordova:_c}=AM();return new Promise(ah=>{_c.plugins.browsertab.isAvailable(_m=>{let m_=null;_m?_c.plugins.browsertab.openUrl(Nf):m_=_c.InAppBrowser.open(Nf,function Z6(Nf=(0,q.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(Nf)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(Nf)}()?"_blank":"_system","location=yes"),ah(m_)})})}(tI);return function _L(Nf,_c,ah){return M9.apply(this,arguments)}(_c,s0,AI)})()}_isIframeWebStorageSupported(_c,ah){throw new Error("Method not implemented.")}_originValidation(_c){const ah=_c._key();return this.originValidationPromises[ah]||(this.originValidationPromises[ah]=function p5(Nf){return V3.apply(this,arguments)}(_c)),this.originValidationPromises[ah]}attachCallbackListeners(_c,ah){const{universalLinks:_m,handleOpenURL:m_,BuildInfo:O_}=AM(),s0=setTimeout((0,f.Z)(function*(){yield mU(_c),ah.onEvent(AU())}),500),N0=function(){var VI=(0,f.Z)(function*(GI){clearTimeout(s0);const oS=yield mU(_c);let FO=null;oS&&(null==GI?void 0:GI.url)&&(FO=function mY(Nf,_c){var ah,_m;const m_=function _M(Nf){const _c=JR(Nf),ah=_c.link?decodeURIComponent(_c.link):void 0,_m=JR(ah).link,m_=_c.deep_link_id?decodeURIComponent(_c.deep_link_id):void 0;return JR(m_).link||m_||_m||ah||Nf}(_c);if(m_.includes("/__/auth/callback")){const O_=JR(m_),s0=O_.firebaseError?function MP(Nf){try{return JSON.parse(Nf)}catch(_c){return null}}(decodeURIComponent(O_.firebaseError)):null,N0=null===(_m=null===(ah=null==s0?void 0:s0.code)||void 0===ah?void 0:ah.split("auth/"))||void 0===_m?void 0:_m[1],tI=N0?h0(N0):null;return tI?{type:Nf.type,eventId:Nf.eventId,tenantId:Nf.tenantId,error:tI,urlResponse:null,sessionId:null,postBody:null}:{type:Nf.type,eventId:Nf.eventId,tenantId:Nf.tenantId,sessionId:Nf.sessionId,urlResponse:m_,postBody:null}}return null}(oS,GI.url)),ah.onEvent(FO||AU())});return function(oS){return VI.apply(this,arguments)}}();void 0!==_m&&"function"==typeof _m.subscribe&&_m.subscribe(null,N0);const tI=m_,AI=`${O_.packageName.toLowerCase()}://`;AM().handleOpenURL=function(){var VI=(0,f.Z)(function*(GI){if(GI.toLowerCase().startsWith(AI)&&N0({url:GI}),"function"==typeof tI)try{tI(GI)}catch(oS){console.error(oS)}});return function(GI){return VI.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=LT,this._completeRedirectFn=rN,this._overrideRedirectResult=d_}_initialize(_c){var ah=this;return(0,f.Z)(function*(){return yield ah.selectUnderlyingResolver(),ah.assertedUnderlyingResolver._initialize(_c)})()}_openPopup(_c,ah,_m,m_){var O_=this;return(0,f.Z)(function*(){return yield O_.selectUnderlyingResolver(),O_.assertedUnderlyingResolver._openPopup(_c,ah,_m,m_)})()}_openRedirect(_c,ah,_m,m_){var O_=this;return(0,f.Z)(function*(){return yield O_.selectUnderlyingResolver(),O_.assertedUnderlyingResolver._openRedirect(_c,ah,_m,m_)})()}_isIframeWebStorageSupported(_c,ah){this.assertedUnderlyingResolver._isIframeWebStorageSupported(_c,ah)}_originValidation(_c){return this.assertedUnderlyingResolver._originValidation(_c)}get _shouldInitProactively(){return W3()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return FP(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var _c=this;return(0,f.Z)(function*(){if(_c.underlyingResolver)return;const ah=yield function E5(){return I5.apply(this,arguments)}();_c.underlyingResolver=ah?_c.cordovaResolver:_c.browserResolver})()}}function C5(Nf){return Nf.unwrap()}function GG(Nf){return U9(Nf)}function U9(Nf){const{_tokenResponse:_c}=Nf instanceof q.ZR?Nf.customData:Nf;if(!_c)return null;if(!(Nf instanceof q.ZR)&&"temporaryProof"in _c&&"phoneNumber"in _c)return S2.credentialFromResult(Nf);const ah=_c.providerId;if(!ah||"password"===ah)return null;let _m;switch(ah){case"google.com":_m=v3;break;case"facebook.com":_m=XL;break;case"github.com":_m=CG;break;case"twitter.com":_m=sV;break;default:const{oauthIdToken:m_,oauthAccessToken:O_,oauthTokenSecret:s0,pendingToken:N0,nonce:tI}=_c;return O_||s0||m_||N0?N0?ah.startsWith("saml.")?XO._create(ah,N0):_2._fromParams({providerId:ah,signInMethod:ah,pendingToken:N0,idToken:m_,accessToken:O_}):new eS(ah).credential({idToken:m_,accessToken:O_,rawNonce:tI}):null}return Nf instanceof q.ZR?_m.credentialFromError(Nf):_m.credentialFromResult(Nf)}function UO(Nf,_c){return _c.catch(ah=>{throw ah instanceof q.ZR&&function yL(Nf,_c){var ah;const _m=null===(ah=_c.customData)||void 0===ah?void 0:ah._tokenResponse;if("auth/multi-factor-auth-required"===_c.code)_c.resolver=new F9(Nf,function RS(Nf,_c){var ah;const _m=(0,q.m9)(Nf),m_=_c;return P_(_c.customData.operationType,_m,"argument-error"),P_(null===(ah=m_.customData._serverResponse)||void 0===ah?void 0:ah.mfaPendingCredential,_m,"argument-error"),eN._fromError(_m,m_)}(Nf,_c));else if(_m){const m_=U9(_c),O_=_c;m_&&(O_.credential=m_,O_.tenantId=_m.tenantId||void 0,O_.email=_m.email||void 0,O_.phoneNumber=_m.phoneNumber||void 0)}}(Nf,ah),ah}).then(ah=>{const m_=ah.user;return{operationType:ah.operationType,credential:GG(ah),additionalUserInfo:KS(ah),user:mO.getOrCreate(m_)}})}function MV(Nf,_c){return BV.apply(this,arguments)}function BV(){return(BV=(0,f.Z)(function*(Nf,_c){const ah=yield _c;return{verificationId:ah.verificationId,confirm:_m=>UO(Nf,ah.confirm(_m))}})).apply(this,arguments)}class F9{constructor(_c,ah){this.resolver=ah,this.auth=function VG(Nf){return Nf.wrapped()}(_c)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(_c){return UO(C5(this.auth),this.resolver.resolveSignIn(_c))}}class mO{constructor(_c){this._delegate=_c,this.multiFactor=function mV(Nf){const _c=(0,q.m9)(Nf);return oM.has(_c)||oM.set(_c,bP._fromUser(_c)),oM.get(_c)}(_c)}static getOrCreate(_c){return mO.USER_MAP.has(_c)||mO.USER_MAP.set(_c,new mO(_c)),mO.USER_MAP.get(_c)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(_c){return this._delegate.getIdTokenResult(_c)}getIdToken(_c){return this._delegate.getIdToken(_c)}linkAndRetrieveDataWithCredential(_c){return this.linkWithCredential(_c)}linkWithCredential(_c){var ah=this;return(0,f.Z)(function*(){return UO(ah.auth,sR(ah._delegate,_c))})()}linkWithPhoneNumber(_c,ah){var _m=this;return(0,f.Z)(function*(){return MV(_m.auth,function x3(Nf,_c,ah){return EV.apply(this,arguments)}(_m._delegate,_c,ah))})()}linkWithPopup(_c){var ah=this;return(0,f.Z)(function*(){return UO(ah.auth,function IV(Nf,_c,ah){return nN.apply(this,arguments)}(ah._delegate,_c,$R))})()}linkWithRedirect(_c){var ah=this;return(0,f.Z)(function*(){return yield vM(NI(ah.auth)),function Q1(Nf,_c,ah){return function t1(Nf,_c,ah){return dS.apply(this,arguments)}(Nf,_c,ah)}(ah._delegate,_c,$R)})()}reauthenticateAndRetrieveDataWithCredential(_c){return this.reauthenticateWithCredential(_c)}reauthenticateWithCredential(_c){var ah=this;return(0,f.Z)(function*(){return UO(ah.auth,y2(ah._delegate,_c))})()}reauthenticateWithPhoneNumber(_c,ah){return MV(this.auth,function SG(Nf,_c,ah){return yR.apply(this,arguments)}(this._delegate,_c,ah))}reauthenticateWithPopup(_c){return UO(this.auth,function MO(Nf,_c,ah){return L3.apply(this,arguments)}(this._delegate,_c,$R))}reauthenticateWithRedirect(_c){var ah=this;return(0,f.Z)(function*(){return yield vM(NI(ah.auth)),function vI(Nf,_c,ah){return function SI(Nf,_c,ah){return jI.apply(this,arguments)}(Nf,_c,ah)}(ah._delegate,_c,$R)})()}sendEmailVerification(_c){return function SS(Nf,_c){return t5.apply(this,arguments)}(this._delegate,_c)}unlink(_c){var ah=this;return(0,f.Z)(function*(){return yield function cV(Nf,_c){return nT.apply(this,arguments)}(ah._delegate,_c),ah})()}updateEmail(_c){return function lV(Nf,_c){return sU((0,q.m9)(Nf),_c,null)}(this._delegate,_c)}updatePassword(_c){return function dV(Nf,_c){return sU((0,q.m9)(Nf),null,_c)}(this._delegate,_c)}updatePhoneNumber(_c){return function fM(Nf,_c){return T2.apply(this,arguments)}(this._delegate,_c)}updateProfile(_c){return function rM(Nf,_c){return R3.apply(this,arguments)}(this._delegate,_c)}verifyBeforeUpdateEmail(_c,ah){return function w3(Nf,_c,ah){return T3.apply(this,arguments)}(this._delegate,_c,ah)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}mO.USER_MAP=new WeakMap;const w5=P_;let QG=(()=>{class Nf{constructor(ah,_m){if(this.app=ah,_m.isInitialized())return this._delegate=_m.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:m_}=ah.options;w5(m_,"invalid-api-key",{appName:ah.name}),w5(m_,"invalid-api-key",{appName:ah.name});const O_="undefined"!=typeof window?$R:void 0;this._delegate=_m.initialize({options:{persistence:j9(m_,ah.name),popupRedirectResolver:O_}}),this._delegate._updateErrorMap(S_),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?mO.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(ah){this._delegate.languageCode=ah}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(ah){this._delegate.tenantId=ah}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(ah,_m){!function QR(Nf,_c,ah){const _m=NI(Nf);P_(_m._canInitEmulator,_m,"emulator-config-failed"),P_(/^https?:\/\//.test(_c),_m,"invalid-emulator-scheme");const m_=!!(null==ah?void 0:ah.disableWarnings),O_=DN(_c),{host:s0,port:N0}=function E1(Nf){const _c=DN(Nf),ah=/(\/\/)?([^?#/]+)/.exec(Nf.substr(_c.length));if(!ah)return{host:"",port:null};const _m=ah[2].split("@").pop()||"",m_=/^(\[[^\]]+\])(:|$)/.exec(_m);if(m_){const O_=m_[1];return{host:O_,port:NN(_m.substr(O_.length+1))}}{const[O_,s0]=_m.split(":");return{host:O_,port:NN(s0)}}}(_c);_m.config.emulator={url:`${O_}//${s0}${null===N0?"":`:${N0}`}/`},_m.settings.appVerificationDisabledForTesting=!0,_m.emulatorConfig=Object.freeze({host:s0,port:N0,protocol:O_.replace(":",""),options:Object.freeze({disableWarnings:m_})}),m_||function fT(){function Nf(){const _c=document.createElement("p"),ah=_c.style;_c.innerText="Running in emulator mode. Do not use with production credentials.",ah.position="fixed",ah.width="100%",ah.backgroundColor="#ffffff",ah.border=".1em solid #000000",ah.color="#b50000",ah.bottom="0px",ah.left="0px",ah.margin="0px",ah.zIndex="10000",ah.textAlign="center",_c.classList.add("firebase-emulator-warning"),document.body.appendChild(_c)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",Nf):Nf())}()}(this._delegate,ah,_m)}applyActionCode(ah){return function tM(Nf,_c){return j0.apply(this,arguments)}(this._delegate,ah)}checkActionCode(ah){return T1(this._delegate,ah)}confirmPasswordReset(ah,_m){return function I3(Nf,_c,ah){return b3.apply(this,arguments)}(this._delegate,ah,_m)}createUserWithEmailAndPassword(ah,_m){var m_=this;return(0,f.Z)(function*(){return UO(m_._delegate,function _D(Nf,_c,ah){return NO.apply(this,arguments)}(m_._delegate,ah,_m))})()}fetchProvidersForEmail(ah){return this.fetchSignInMethodsForEmail(ah)}fetchSignInMethodsForEmail(ah){return function E2(Nf,_c){return EP.apply(this,arguments)}(this._delegate,ah)}isSignInWithEmailLink(ah){return function uV(Nf,_c){const ah=_3.parseLink(_c);return"EMAIL_SIGNIN"===(null==ah?void 0:ah.operation)}(0,ah)}getRedirectResult(){var ah=this;return(0,f.Z)(function*(){w5(kS(),ah._delegate,"operation-not-supported-in-this-environment");const _m=yield function NS(Nf,_c){return QN.apply(this,arguments)}(ah._delegate,$R);return _m?UO(ah._delegate,Promise.resolve(_m)):{credential:null,user:null}})()}addFrameworkForLogging(ah){!function xV(Nf,_c){NI(Nf)._logFramework(_c)}(this._delegate,ah)}onAuthStateChanged(ah,_m,m_){const{next:O_,error:s0,complete:N0}=HG(ah,_m,m_);return this._delegate.onAuthStateChanged(O_,s0,N0)}onIdTokenChanged(ah,_m,m_){const{next:O_,error:s0,complete:N0}=HG(ah,_m,m_);return this._delegate.onIdTokenChanged(O_,s0,N0)}sendSignInLinkToEmail(ah,_m){return function UN(Nf,_c,ah){return e5.apply(this,arguments)}(this._delegate,ah,_m)}sendPasswordResetEmail(ah,_m){return function jj(Nf,_c,ah){return iU.apply(this,arguments)}(this._delegate,ah,_m||void 0)}setPersistence(ah){var _m=this;return(0,f.Z)(function*(){let m_;switch(function BP(Nf,_c){vL(Object.values(uR).includes(_c),Nf,"invalid-persistence-type"),(0,q.b$)()?vL(_c!==uR.SESSION,Nf,"unsupported-persistence-type"):(0,q.UG)()?vL(_c===uR.NONE,Nf,"unsupported-persistence-type"):y5()?vL(_c===uR.NONE||_c===uR.LOCAL&&(0,q.hl)(),Nf,"unsupported-persistence-type"):vL(_c===uR.NONE||UG(),Nf,"unsupported-persistence-type")}(_m._delegate,ah),ah){case uR.SESSION:m_=LT;break;case uR.LOCAL:m_=(yield F_(dL)._isAvailable())?dL:xT;break;case uR.NONE:m_=_b;break;default:return Pv("argument-error",{appName:_m._delegate.name})}return _m._delegate.setPersistence(m_)})()}signInAndRetrieveDataWithCredential(ah){return this.signInWithCredential(ah)}signInAnonymously(){return UO(this._delegate,function aV(Nf){return y3.apply(this,arguments)}(this._delegate))}signInWithCredential(ah){return UO(this._delegate,kT(this._delegate,ah))}signInWithCustomToken(ah){return UO(this._delegate,function eM(Nf,_c){return zI.apply(this,arguments)}(this._delegate,ah))}signInWithEmailAndPassword(ah,_m){return UO(this._delegate,function $j(Nf,_c,ah){return kT((0,q.m9)(Nf),oV.credential(_c,ah))}(this._delegate,ah,_m))}signInWithEmailLink(ah,_m){return UO(this._delegate,function E9(Nf,_c,ah){return kO.apply(this,arguments)}(this._delegate,ah,_m))}signInWithPhoneNumber(ah,_m){return MV(this._delegate,function lS(Nf,_c,ah){return dU.apply(this,arguments)}(this._delegate,ah,_m))}signInWithPopup(ah){var _m=this;return(0,f.Z)(function*(){return w5(kS(),_m._delegate,"operation-not-supported-in-this-environment"),UO(_m._delegate,function w9(Nf,_c,ah){return D2.apply(this,arguments)}(_m._delegate,ah,$R))})()}signInWithRedirect(ah){var _m=this;return(0,f.Z)(function*(){return w5(kS(),_m._delegate,"operation-not-supported-in-this-environment"),yield vM(_m._delegate),function p0(Nf,_c,ah){return function E0(Nf,_c,ah){return k0.apply(this,arguments)}(Nf,_c,ah)}(_m._delegate,ah,$R)})()}updateCurrentUser(ah){return this._delegate.updateCurrentUser(ah)}verifyPasswordResetCode(ah){return function ST(Nf,_c){return C3.apply(this,arguments)}(this._delegate,ah)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return Nf.Persistence=uR,Nf})();function HG(Nf,_c,ah){let _m=Nf;"function"!=typeof Nf&&({next:_m,error:_c,complete:ah}=Nf);const m_=_m;return{next:s0=>m_(s0&&mO.getOrCreate(s0)),error:_c,complete:ah}}function j9(Nf,_c){const ah=function b5(Nf,_c){const ah=UP();if(!ah)return[];const _m=ZT(FG,Nf,_c);switch(ah.getItem(_m)){case uR.NONE:return[_b];case uR.LOCAL:return[dL,LT];case uR.SESSION:return[LT];default:return[]}}(Nf,_c);if("undefined"!=typeof self&&!ah.includes(dL)&&ah.push(dL),"undefined"!=typeof window)for(const _m of[xT,LT])ah.includes(_m)||ah.push(_m);return ah.includes(_b)||ah.push(_b),ah}class UV{constructor(){this.providerId="phone",this._delegate=new S2(C5(k.Z.auth()))}static credential(_c,ah){return S2.credential(_c,ah)}verifyPhoneNumber(_c,ah){return this._delegate.verifyPhoneNumber(_c,ah)}unwrap(){return this._delegate}}UV.PHONE_SIGN_IN_METHOD=S2.PHONE_SIGN_IN_METHOD,UV.PROVIDER_ID=S2.PROVIDER_ID;const V9=P_;class yY{constructor(_c,ah,_m=k.Z.app()){var m_;V9(null===(m_=_m.options)||void 0===m_?void 0:m_.apiKey,"invalid-api-key",{appName:_m.name}),this._delegate=new o5(_c,ah,_m.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function HN(Nf){Nf.INTERNAL.registerComponent(new _l.wA("auth-compat",_c=>{const ah=_c.getProvider("app-compat").getImmediate(),_m=_c.getProvider("auth");return new QG(ah,_m)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:oV,FacebookAuthProvider:XL,GithubAuthProvider:CG,GoogleAuthProvider:v3,OAuthProvider:eS,SAMLAuthProvider:qS,PhoneAuthProvider:UV,PhoneMultiFactorGenerator:kG,RecaptchaVerifier:yY,TwitterAuthProvider:sV,Auth:QG,AuthCredential:RO,Error:q.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),Nf.registerVersion("@firebase/auth-compat","0.2.14")}(k.Z)},8306:(h,l,g)=>{"use strict";g.d(l,{y:()=>_A});var f=g(930),k=g(727),q=g(8822),_r=g(4671);var _l=g(2416),bh=g(576),n_=g(2806);let _A=(()=>{class v_{constructor(x_){x_&&(this._subscribe=x_)}lift(x_){const B_=new v_;return B_.source=this,B_.operator=x_,B_}subscribe(x_,B_,V_){const _0=function I_(v_){return v_&&v_ instanceof f.Lv||function p_(v_){return v_&&(0,bh.m)(v_.next)&&(0,bh.m)(v_.error)&&(0,bh.m)(v_.complete)}(v_)&&(0,k.Nn)(v_)}(x_)?x_:new f.Hp(x_,B_,V_);return(0,n_.x)(()=>{const{operator:c0,source:Pv}=this;_0.add(c0?c0.call(_0,Pv):Pv?this._subscribe(_0):this._trySubscribe(_0))}),_0}_trySubscribe(x_){try{return this._subscribe(x_)}catch(B_){x_.error(B_)}}forEach(x_,B_){return new(B_=r_(B_))((V_,_0)=>{const c0=new f.Hp({next:Pv=>{try{x_(Pv)}catch(h0){_0(h0),c0.unsubscribe()}},error:_0,complete:V_});this.subscribe(c0)})}_subscribe(x_){var B_;return null===(B_=this.source)||void 0===B_?void 0:B_.subscribe(x_)}[q.L](){return this}pipe(...x_){return function ga(v_){return 0===v_.length?_r.y:1===v_.length?v_[0]:function(x_){return v_.reduce((B_,V_)=>V_(B_),x_)}}(x_)(this)}toPromise(x_){return new(x_=r_(x_))((B_,V_)=>{let _0;this.subscribe(c0=>_0=c0,c0=>V_(c0),()=>B_(_0))})}}return v_.create=S_=>new v_(S_),v_})();function r_(v_){var S_;return null!==(S_=null!=v_?v_:_l.v.Promise)&&void 0!==S_?S_:Promise}},7579:(h,l,g)=>{"use strict";g.d(l,{x:()=>_l});var f=g(8306),k=g(727);const _r=(0,g(3888).d)(n_=>function(){n_(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var _s=g(8737),ga=g(2806);let _l=(()=>{class n_ extends f.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(r_){const p_=new bh(this,this);return p_.operator=r_,p_}_throwIfClosed(){if(this.closed)throw new _r}next(r_){(0,ga.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const p_ of this.currentObservers)p_.next(r_)}})}error(r_){(0,ga.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=r_;const{observers:p_}=this;for(;p_.length;)p_.shift().error(r_)}})}complete(){(0,ga.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:r_}=this;for(;r_.length;)r_.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var r_;return(null===(r_=this.observers)||void 0===r_?void 0:r_.length)>0}_trySubscribe(r_){return this._throwIfClosed(),super._trySubscribe(r_)}_subscribe(r_){return this._throwIfClosed(),this._checkFinalizedStatuses(r_),this._innerSubscribe(r_)}_innerSubscribe(r_){const{hasError:p_,isStopped:I_,observers:v_}=this;return p_||I_?k.Lc:(this.currentObservers=null,v_.push(r_),new k.w0(()=>{this.currentObservers=null,(0,_s.P)(v_,r_)}))}_checkFinalizedStatuses(r_){const{hasError:p_,thrownError:I_,isStopped:v_}=this;p_?r_.error(I_):v_&&r_.complete()}asObservable(){const r_=new f.y;return r_.source=this,r_}}return n_.create=(_A,r_)=>new bh(_A,r_),n_})();class bh extends _l{constructor(_A,r_){super(),this.destination=_A,this.source=r_}next(_A){var r_,p_;null===(p_=null===(r_=this.destination)||void 0===r_?void 0:r_.next)||void 0===p_||p_.call(r_,_A)}error(_A){var r_,p_;null===(p_=null===(r_=this.destination)||void 0===r_?void 0:r_.error)||void 0===p_||p_.call(r_,_A)}complete(){var _A,r_;null===(r_=null===(_A=this.destination)||void 0===_A?void 0:_A.complete)||void 0===r_||r_.call(_A)}_subscribe(_A){var r_,p_;return null!==(p_=null===(r_=this.source)||void 0===r_?void 0:r_.subscribe(_A))&&void 0!==p_?p_:k.Lc}}},930:(h,l,g)=>{"use strict";g.d(l,{Hp:()=>x_,Lv:()=>p_});var f=g(576),k=g(727),q=g(2416),_r=g(7849),_s=g(5032);const ga=n_("C",void 0,void 0);function n_(Pv,h0,I0){return{kind:Pv,value:h0,error:I0}}var _A=g(3410),r_=g(2806);class p_ extends k.w0{constructor(h0){super(),this.isStopped=!1,h0?(this.destination=h0,(0,k.Nn)(h0)&&h0.add(this)):this.destination=c0}static create(h0,I0,G_){return new x_(h0,I0,G_)}next(h0){this.isStopped?_0(function bh(Pv){return n_("N",Pv,void 0)}(h0),this):this._next(h0)}error(h0){this.isStopped?_0(function _l(Pv){return n_("E",void 0,Pv)}(h0),this):(this.isStopped=!0,this._error(h0))}complete(){this.isStopped?_0(ga,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(h0){this.destination.next(h0)}_error(h0){try{this.destination.error(h0)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const I_=Function.prototype.bind;function v_(Pv,h0){return I_.call(Pv,h0)}class S_{constructor(h0){this.partialObserver=h0}next(h0){const{partialObserver:I0}=this;if(I0.next)try{I0.next(h0)}catch(G_){B_(G_)}}error(h0){const{partialObserver:I0}=this;if(I0.error)try{I0.error(h0)}catch(G_){B_(G_)}else B_(h0)}complete(){const{partialObserver:h0}=this;if(h0.complete)try{h0.complete()}catch(I0){B_(I0)}}}class x_ extends p_{constructor(h0,I0,G_){let e0;if(super(),(0,f.m)(h0)||!h0)e0={next:null!=h0?h0:void 0,error:null!=I0?I0:void 0,complete:null!=G_?G_:void 0};else{let P_;this&&q.v.useDeprecatedNextContext?(P_=Object.create(h0),P_.unsubscribe=()=>this.unsubscribe(),e0={next:h0.next&&v_(h0.next,P_),error:h0.error&&v_(h0.error,P_),complete:h0.complete&&v_(h0.complete,P_)}):e0=h0}this.destination=new S_(e0)}}function B_(Pv){q.v.useDeprecatedSynchronousErrorHandling?(0,r_.O)(Pv):(0,_r.h)(Pv)}function _0(Pv,h0){const{onStoppedNotification:I0}=q.v;I0&&_A.z.setTimeout(()=>I0(Pv,h0))}const c0={closed:!0,next:_s.Z,error:function V_(Pv){throw Pv},complete:_s.Z}},727:(h,l,g)=>{"use strict";g.d(l,{Lc:()=>ga,w0:()=>_s,Nn:()=>_l});var f=g(576);const q=(0,g(3888).d)(n_=>function(r_){n_(this),this.message=r_?`${r_.length} errors occurred during unsubscription:\n${r_.map((p_,I_)=>`${I_+1}) ${p_.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=r_});var _r=g(8737);class _s{constructor(_A){this.initialTeardown=_A,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let _A;if(!this.closed){this.closed=!0;const{_parentage:r_}=this;if(r_)if(this._parentage=null,Array.isArray(r_))for(const v_ of r_)v_.remove(this);else r_.remove(this);const{initialTeardown:p_}=this;if((0,f.m)(p_))try{p_()}catch(v_){_A=v_ instanceof q?v_.errors:[v_]}const{_finalizers:I_}=this;if(I_){this._finalizers=null;for(const v_ of I_)try{bh(v_)}catch(S_){_A=null!=_A?_A:[],S_ instanceof q?_A=[..._A,...S_.errors]:_A.push(S_)}}if(_A)throw new q(_A)}}add(_A){var r_;if(_A&&_A!==this)if(this.closed)bh(_A);else{if(_A instanceof _s){if(_A.closed||_A._hasParent(this))return;_A._addParent(this)}(this._finalizers=null!==(r_=this._finalizers)&&void 0!==r_?r_:[]).push(_A)}}_hasParent(_A){const{_parentage:r_}=this;return r_===_A||Array.isArray(r_)&&r_.includes(_A)}_addParent(_A){const{_parentage:r_}=this;this._parentage=Array.isArray(r_)?(r_.push(_A),r_):r_?[r_,_A]:_A}_removeParent(_A){const{_parentage:r_}=this;r_===_A?this._parentage=null:Array.isArray(r_)&&(0,_r.P)(r_,_A)}remove(_A){const{_finalizers:r_}=this;r_&&(0,_r.P)(r_,_A),_A instanceof _s&&_A._removeParent(this)}}_s.EMPTY=(()=>{const n_=new _s;return n_.closed=!0,n_})();const ga=_s.EMPTY;function _l(n_){return n_ instanceof _s||n_&&"closed"in n_&&(0,f.m)(n_.remove)&&(0,f.m)(n_.add)&&(0,f.m)(n_.unsubscribe)}function bh(n_){(0,f.m)(n_)?n_():n_.unsubscribe()}},2416:(h,l,g)=>{"use strict";g.d(l,{v:()=>f});const f={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(h,l,g)=>{"use strict";g.d(l,{E:()=>k});const k=new(g(8306).y)(_s=>_s.complete())},8996:(h,l,g)=>{"use strict";g.d(l,{D:()=>h0});var f=g(8421),k=g(5363),q=g(9468),ga=g(8306),bh=g(2202),n_=g(576),_A=g(9672);function p_(I0,G_){if(!I0)throw new Error("Iterable cannot be null");return new ga.y(e0=>{(0,_A.f)(e0,G_,()=>{const P_=I0[Symbol.asyncIterator]();(0,_A.f)(e0,G_,()=>{P_.next().then(_v=>{_v.done?e0.complete():e0.next(_v.value)})},0,!0)})})}var I_=g(3670),v_=g(8239),S_=g(1144),x_=g(6495),B_=g(2206),V_=g(4532),_0=g(3260);function h0(I0,G_){return G_?function Pv(I0,G_){if(null!=I0){if((0,I_.c)(I0))return function _r(I0,G_){return(0,f.Xf)(I0).pipe((0,q.R)(G_),(0,k.Q)(G_))}(I0,G_);if((0,S_.z)(I0))return function _l(I0,G_){return new ga.y(e0=>{let P_=0;return G_.schedule(function(){P_===I0.length?e0.complete():(e0.next(I0[P_++]),e0.closed||this.schedule())})})}(I0,G_);if((0,v_.t)(I0))return function _s(I0,G_){return(0,f.Xf)(I0).pipe((0,q.R)(G_),(0,k.Q)(G_))}(I0,G_);if((0,B_.D)(I0))return p_(I0,G_);if((0,x_.T)(I0))return function r_(I0,G_){return new ga.y(e0=>{let P_;return(0,_A.f)(e0,G_,()=>{P_=I0[bh.h](),(0,_A.f)(e0,G_,()=>{let _v,E_;try{({value:_v,done:E_}=P_.next())}catch(L_){return void e0.error(L_)}E_?e0.complete():e0.next(_v)},0,!0)}),()=>(0,n_.m)(null==P_?void 0:P_.return)&&P_.return()})}(I0,G_);if((0,_0.L)(I0))return function c0(I0,G_){return p_((0,_0.Q)(I0),G_)}(I0,G_)}throw(0,V_.z)(I0)}(I0,G_):(0,f.Xf)(I0)}},8421:(h,l,g)=>{"use strict";g.d(l,{Xf:()=>I_});var f=g(655),k=g(1144),q=g(8239),_r=g(8306),_s=g(3670),ga=g(2206),_l=g(4532),bh=g(6495),n_=g(3260),_A=g(576),r_=g(7849),p_=g(8822);function I_(Pv){if(Pv instanceof _r.y)return Pv;if(null!=Pv){if((0,_s.c)(Pv))return function v_(Pv){return new _r.y(h0=>{const I0=Pv[p_.L]();if((0,_A.m)(I0.subscribe))return I0.subscribe(h0);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Pv);if((0,k.z)(Pv))return function S_(Pv){return new _r.y(h0=>{for(let I0=0;I0<Pv.length&&!h0.closed;I0++)h0.next(Pv[I0]);h0.complete()})}(Pv);if((0,q.t)(Pv))return function x_(Pv){return new _r.y(h0=>{Pv.then(I0=>{h0.closed||(h0.next(I0),h0.complete())},I0=>h0.error(I0)).then(null,r_.h)})}(Pv);if((0,ga.D)(Pv))return V_(Pv);if((0,bh.T)(Pv))return function B_(Pv){return new _r.y(h0=>{for(const I0 of Pv)if(h0.next(I0),h0.closed)return;h0.complete()})}(Pv);if((0,n_.L)(Pv))return function _0(Pv){return V_((0,n_.Q)(Pv))}(Pv)}throw(0,_l.z)(Pv)}function V_(Pv){return new _r.y(h0=>{(function c0(Pv,h0){var I0,G_,e0,P_;return(0,f.mG)(this,void 0,void 0,function*(){try{for(I0=(0,f.KL)(Pv);!(G_=yield I0.next()).done;)if(h0.next(G_.value),h0.closed)return}catch(_v){e0={error:_v}}finally{try{G_&&!G_.done&&(P_=I0.return)&&(yield P_.call(I0))}finally{if(e0)throw e0.error}}h0.complete()})})(Pv,h0).catch(I0=>h0.error(I0))})}},6451:(h,l,g)=>{"use strict";g.d(l,{T:()=>ga});var f=g(8189),k=g(8421),q=g(515),_r=g(7669),_s=g(8996);function ga(..._l){const bh=(0,_r.yG)(_l),n_=(0,_r._6)(_l,1/0),_A=_l;return _A.length?1===_A.length?(0,k.Xf)(_A[0]):(0,f.J)(n_)((0,_s.D)(_A,bh)):q.E}},5403:(h,l,g)=>{"use strict";g.d(l,{x:()=>k});var f=g(930);function k(_r,_s,ga,_l,bh){return new q(_r,_s,ga,_l,bh)}class q extends f.Lv{constructor(_s,ga,_l,bh,n_,_A){super(_s),this.onFinalize=n_,this.shouldUnsubscribe=_A,this._next=ga?function(r_){try{ga(r_)}catch(p_){_s.error(p_)}}:super._next,this._error=bh?function(r_){try{bh(r_)}catch(p_){_s.error(p_)}finally{this.unsubscribe()}}:super._error,this._complete=_l?function(){try{_l()}catch(r_){_s.error(r_)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var _s;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:ga}=this;super.unsubscribe(),!ga&&(null===(_s=this.onFinalize)||void 0===_s||_s.call(this))}}}},4004:(h,l,g)=>{"use strict";g.d(l,{U:()=>q});var f=g(4482),k=g(5403);function q(_r,_s){return(0,f.e)((ga,_l)=>{let bh=0;ga.subscribe((0,k.x)(_l,n_=>{_l.next(_r.call(_s,n_,bh++))}))})}},8189:(h,l,g)=>{"use strict";g.d(l,{J:()=>q});var f=g(5577),k=g(4671);function q(_r=1/0){return(0,f.z)(k.y,_r)}},5577:(h,l,g)=>{"use strict";g.d(l,{z:()=>bh});var f=g(4004),k=g(8421),q=g(4482),_r=g(9672),_s=g(5403),_l=g(576);function bh(n_,_A,r_=1/0){return(0,_l.m)(_A)?bh((p_,I_)=>(0,f.U)((v_,S_)=>_A(p_,v_,I_,S_))((0,k.Xf)(n_(p_,I_))),r_):("number"==typeof _A&&(r_=_A),(0,q.e)((p_,I_)=>function ga(n_,_A,r_,p_,I_,v_,S_,x_){const B_=[];let V_=0,_0=0,c0=!1;const Pv=()=>{c0&&!B_.length&&!V_&&_A.complete()},h0=G_=>V_<p_?I0(G_):B_.push(G_),I0=G_=>{v_&&_A.next(G_),V_++;let e0=!1;(0,k.Xf)(r_(G_,_0++)).subscribe((0,_s.x)(_A,P_=>{null==I_||I_(P_),v_?h0(P_):_A.next(P_)},()=>{e0=!0},void 0,()=>{if(e0)try{for(V_--;B_.length&&V_<p_;){const P_=B_.shift();S_?(0,_r.f)(_A,S_,()=>I0(P_)):I0(P_)}Pv()}catch(P_){_A.error(P_)}}))};return n_.subscribe((0,_s.x)(_A,h0,()=>{c0=!0,Pv()})),()=>{null==x_||x_()}}(p_,I_,n_,r_)))}},5363:(h,l,g)=>{"use strict";g.d(l,{Q:()=>_r});var f=g(9672),k=g(4482),q=g(5403);function _r(_s,ga=0){return(0,k.e)((_l,bh)=>{_l.subscribe((0,q.x)(bh,n_=>(0,f.f)(bh,_s,()=>bh.next(n_),ga),()=>(0,f.f)(bh,_s,()=>bh.complete(),ga),n_=>(0,f.f)(bh,_s,()=>bh.error(n_),ga)))})}},3099:(h,l,g)=>{"use strict";g.d(l,{B:()=>ga});var f=g(8996),k=g(5698),q=g(7579),_r=g(930),_s=g(4482);function ga(bh={}){const{connector:n_=(()=>new q.x),resetOnError:_A=!0,resetOnComplete:r_=!0,resetOnRefCountZero:p_=!0}=bh;return I_=>{let v_=null,S_=null,x_=null,B_=0,V_=!1,_0=!1;const c0=()=>{null==S_||S_.unsubscribe(),S_=null},Pv=()=>{c0(),v_=x_=null,V_=_0=!1},h0=()=>{const I0=v_;Pv(),null==I0||I0.unsubscribe()};return(0,_s.e)((I0,G_)=>{B_++,!_0&&!V_&&c0();const e0=x_=null!=x_?x_:n_();G_.add(()=>{B_--,0===B_&&!_0&&!V_&&(S_=_l(h0,p_))}),e0.subscribe(G_),v_||(v_=new _r.Hp({next:P_=>e0.next(P_),error:P_=>{_0=!0,c0(),S_=_l(Pv,_A,P_),e0.error(P_)},complete:()=>{V_=!0,c0(),S_=_l(Pv,r_),e0.complete()}}),(0,f.D)(I0).subscribe(v_))})(I_)}}function _l(bh,n_,..._A){return!0===n_?(bh(),null):!1===n_?null:n_(..._A).pipe((0,k.q)(1)).subscribe(()=>bh())}},9468:(h,l,g)=>{"use strict";g.d(l,{R:()=>k});var f=g(4482);function k(q,_r=0){return(0,f.e)((_s,ga)=>{ga.add(q.schedule(()=>_s.subscribe(ga),_r))})}},5698:(h,l,g)=>{"use strict";g.d(l,{q:()=>_r});var f=g(515),k=g(4482),q=g(5403);function _r(_s){return _s<=0?()=>f.E:(0,k.e)((ga,_l)=>{let bh=0;ga.subscribe((0,q.x)(_l,n_=>{++bh<=_s&&(_l.next(n_),_s<=bh&&_l.complete())}))})}},8505:(h,l,g)=>{"use strict";g.d(l,{b:()=>_s});var f=g(576),k=g(4482),q=g(5403),_r=g(4671);function _s(ga,_l,bh){const n_=(0,f.m)(ga)||_l||bh?{next:ga,error:_l,complete:bh}:ga;return n_?(0,k.e)((_A,r_)=>{var p_;null===(p_=n_.subscribe)||void 0===p_||p_.call(n_);let I_=!0;_A.subscribe((0,q.x)(r_,v_=>{var S_;null===(S_=n_.next)||void 0===S_||S_.call(n_,v_),r_.next(v_)},()=>{var v_;I_=!1,null===(v_=n_.complete)||void 0===v_||v_.call(n_),r_.complete()},v_=>{var S_;I_=!1,null===(S_=n_.error)||void 0===S_||S_.call(n_,v_),r_.error(v_)},()=>{var v_,S_;I_&&(null===(v_=n_.unsubscribe)||void 0===v_||v_.call(n_)),null===(S_=n_.finalize)||void 0===S_||S_.call(n_)}))}):_r.y}},4408:(h,l,g)=>{"use strict";g.d(l,{o:()=>_s});var f=g(727);class k extends f.w0{constructor(_l,bh){super()}schedule(_l,bh=0){return this}}const q={setInterval(ga,_l,...bh){const{delegate:n_}=q;return(null==n_?void 0:n_.setInterval)?n_.setInterval(ga,_l,...bh):setInterval(ga,_l,...bh)},clearInterval(ga){const{delegate:_l}=q;return((null==_l?void 0:_l.clearInterval)||clearInterval)(ga)},delegate:void 0};var _r=g(8737);class _s extends k{constructor(_l,bh){super(_l,bh),this.scheduler=_l,this.work=bh,this.pending=!1}schedule(_l,bh=0){if(this.closed)return this;this.state=_l;const n_=this.id,_A=this.scheduler;return null!=n_&&(this.id=this.recycleAsyncId(_A,n_,bh)),this.pending=!0,this.delay=bh,this.id=this.id||this.requestAsyncId(_A,this.id,bh),this}requestAsyncId(_l,bh,n_=0){return q.setInterval(_l.flush.bind(_l,this),n_)}recycleAsyncId(_l,bh,n_=0){if(null!=n_&&this.delay===n_&&!1===this.pending)return bh;q.clearInterval(bh)}execute(_l,bh){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n_=this._execute(_l,bh);if(n_)return n_;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(_l,bh){let _A,n_=!1;try{this.work(_l)}catch(r_){n_=!0,_A=r_||new Error("Scheduled action threw falsy error")}if(n_)return this.unsubscribe(),_A}unsubscribe(){if(!this.closed){const{id:_l,scheduler:bh}=this,{actions:n_}=bh;this.work=this.state=this.scheduler=null,this.pending=!1,(0,_r.P)(n_,this),null!=_l&&(this.id=this.recycleAsyncId(bh,_l,null)),this.delay=null,super.unsubscribe()}}}},7565:(h,l,g)=>{"use strict";g.d(l,{v:()=>q});var f=g(6063);class k{constructor(_s,ga=k.now){this.schedulerActionCtor=_s,this.now=ga}schedule(_s,ga=0,_l){return new this.schedulerActionCtor(this,_s).schedule(_l,ga)}}k.now=f.l.now;class q extends k{constructor(_s,ga=k.now){super(_s,ga),this.actions=[],this._active=!1,this._scheduled=void 0}flush(_s){const{actions:ga}=this;if(this._active)return void ga.push(_s);let _l;this._active=!0;do{if(_l=_s.execute(_s.state,_s.delay))break}while(_s=ga.shift());if(this._active=!1,_l){for(;_s=ga.shift();)_s.unsubscribe();throw _l}}}},4986:(h,l,g)=>{"use strict";g.d(l,{z:()=>q});var f=g(4408);const q=new(g(7565).v)(f.o)},6063:(h,l,g)=>{"use strict";g.d(l,{l:()=>f});const f={now:()=>(f.delegate||Date).now(),delegate:void 0}},3410:(h,l,g)=>{"use strict";g.d(l,{z:()=>f});const f={setTimeout(k,q,..._r){const{delegate:_s}=f;return(null==_s?void 0:_s.setTimeout)?_s.setTimeout(k,q,..._r):setTimeout(k,q,..._r)},clearTimeout(k){const{delegate:q}=f;return((null==q?void 0:q.clearTimeout)||clearTimeout)(k)},delegate:void 0}},2202:(h,l,g)=>{"use strict";g.d(l,{h:()=>k});const k=function f(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(h,l,g)=>{"use strict";g.d(l,{L:()=>f});const f="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(h,l,g)=>{"use strict";g.d(l,{_6:()=>ga,jO:()=>_r,yG:()=>_s});var f=g(576);function q(_l){return _l[_l.length-1]}function _r(_l){return(0,f.m)(q(_l))?_l.pop():void 0}function _s(_l){return function k(_l){return _l&&(0,f.m)(_l.schedule)}(q(_l))?_l.pop():void 0}function ga(_l,bh){return"number"==typeof q(_l)?_l.pop():bh}},8737:(h,l,g)=>{"use strict";function f(k,q){if(k){const _r=k.indexOf(q);0<=_r&&k.splice(_r,1)}}g.d(l,{P:()=>f})},3888:(h,l,g)=>{"use strict";function f(k){const _r=k(_s=>{Error.call(_s),_s.stack=(new Error).stack});return _r.prototype=Object.create(Error.prototype),_r.prototype.constructor=_r,_r}g.d(l,{d:()=>f})},2806:(h,l,g)=>{"use strict";g.d(l,{O:()=>_r,x:()=>q});var f=g(2416);let k=null;function q(_s){if(f.v.useDeprecatedSynchronousErrorHandling){const ga=!k;if(ga&&(k={errorThrown:!1,error:null}),_s(),ga){const{errorThrown:_l,error:bh}=k;if(k=null,_l)throw bh}}else _s()}function _r(_s){f.v.useDeprecatedSynchronousErrorHandling&&k&&(k.errorThrown=!0,k.error=_s)}},9672:(h,l,g)=>{"use strict";function f(k,q,_r,_s=0,ga=!1){const _l=q.schedule(function(){_r(),ga?k.add(this.schedule(null,_s)):this.unsubscribe()},_s);if(k.add(_l),!ga)return _l}g.d(l,{f:()=>f})},4671:(h,l,g)=>{"use strict";function f(k){return k}g.d(l,{y:()=>f})},1144:(h,l,g)=>{"use strict";g.d(l,{z:()=>f});const f=k=>k&&"number"==typeof k.length&&"function"!=typeof k},2206:(h,l,g)=>{"use strict";g.d(l,{D:()=>k});var f=g(576);function k(q){return Symbol.asyncIterator&&(0,f.m)(null==q?void 0:q[Symbol.asyncIterator])}},576:(h,l,g)=>{"use strict";function f(k){return"function"==typeof k}g.d(l,{m:()=>f})},3670:(h,l,g)=>{"use strict";g.d(l,{c:()=>q});var f=g(8822),k=g(576);function q(_r){return(0,k.m)(_r[f.L])}},6495:(h,l,g)=>{"use strict";g.d(l,{T:()=>q});var f=g(2202),k=g(576);function q(_r){return(0,k.m)(null==_r?void 0:_r[f.h])}},8239:(h,l,g)=>{"use strict";g.d(l,{t:()=>k});var f=g(576);function k(q){return(0,f.m)(null==q?void 0:q.then)}},3260:(h,l,g)=>{"use strict";g.d(l,{L:()=>_r,Q:()=>q});var f=g(655),k=g(576);function q(_s){return(0,f.FC)(this,arguments,function*(){const _l=_s.getReader();try{for(;;){const{value:bh,done:n_}=yield(0,f.qq)(_l.read());if(n_)return yield(0,f.qq)(void 0);yield yield(0,f.qq)(bh)}}finally{_l.releaseLock()}})}function _r(_s){return(0,k.m)(null==_s?void 0:_s.getReader)}},4482:(h,l,g)=>{"use strict";g.d(l,{A:()=>k,e:()=>q});var f=g(576);function k(_r){return(0,f.m)(null==_r?void 0:_r.lift)}function q(_r){return _s=>{if(k(_s))return _s.lift(function(ga){try{return _r(ga,this)}catch(_l){this.error(_l)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(h,l,g)=>{"use strict";function f(){}g.d(l,{Z:()=>f})},7849:(h,l,g)=>{"use strict";g.d(l,{h:()=>q});var f=g(2416),k=g(3410);function q(_r){k.z.setTimeout(()=>{const{onUnhandledError:_s}=f.v;if(!_s)throw _r;_s(_r)})}},4532:(h,l,g)=>{"use strict";function f(k){return new TypeError(`You provided ${null!==k&&"object"==typeof k?"an invalid object":`'${k}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}g.d(l,{z:()=>f})},8926:h=>{function l(f,k,q,_r,_s,ga,_l){try{var bh=f[ga](_l),n_=bh.value}catch(_A){return void q(_A)}bh.done?k(n_):Promise.resolve(n_).then(_r,_s)}h.exports=function g(f){return function(){var k=this,q=arguments;return new Promise(function(_r,_s){var ga=f.apply(k,q);function _l(n_){l(ga,_r,_s,_l,bh,"next",n_)}function bh(n_){l(ga,_r,_s,_l,bh,"throw",n_)}_l(void 0)})}},h.exports.__esModule=!0,h.exports.default=h.exports},655:(h,l,g)=>{"use strict";function _r(E_,L_){var F_={};for(var J_ in E_)Object.prototype.hasOwnProperty.call(E_,J_)&&L_.indexOf(J_)<0&&(F_[J_]=E_[J_]);if(null!=E_&&"function"==typeof Object.getOwnPropertySymbols){var Y_=0;for(J_=Object.getOwnPropertySymbols(E_);Y_<J_.length;Y_++)L_.indexOf(J_[Y_])<0&&Object.prototype.propertyIsEnumerable.call(E_,J_[Y_])&&(F_[J_[Y_]]=E_[J_[Y_]])}return F_}function bh(E_,L_,F_,J_){return new(F_||(F_=Promise))(function(D0,O0){function EI(x1){try{Y0(J_.next(x1))}catch(_1){O0(_1)}}function eI(x1){try{Y0(J_.throw(x1))}catch(_1){O0(_1)}}function Y0(x1){x1.done?D0(x1.value):function Y_(D0){return D0 instanceof F_?D0:new F_(function(O0){O0(D0)})}(x1.value).then(EI,eI)}Y0((J_=J_.apply(E_,L_||[])).next())})}function B_(E_){return this instanceof B_?(this.v=E_,this):new B_(E_)}function V_(E_,L_,F_){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Y_,J_=F_.apply(E_,L_||[]),D0=[];return Y_={},O0("next"),O0("throw"),O0("return"),Y_[Symbol.asyncIterator]=function(){return this},Y_;function O0(UI){J_[UI]&&(Y_[UI]=function(Z1){return new Promise(function(sT,L1){D0.push([UI,Z1,sT,L1])>1||EI(UI,Z1)})})}function EI(UI,Z1){try{!function eI(UI){UI.value instanceof B_?Promise.resolve(UI.value.v).then(Y0,x1):_1(D0[0][2],UI)}(J_[UI](Z1))}catch(sT){_1(D0[0][3],sT)}}function Y0(UI){EI("next",UI)}function x1(UI){EI("throw",UI)}function _1(UI,Z1){UI(Z1),D0.shift(),D0.length&&EI(D0[0][0],D0[0][1])}}function c0(E_){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var F_,L_=E_[Symbol.asyncIterator];return L_?L_.call(E_):(E_=function p_(E_){var L_="function"==typeof Symbol&&Symbol.iterator,F_=L_&&E_[L_],J_=0;if(F_)return F_.call(E_);if(E_&&"number"==typeof E_.length)return{next:function(){return E_&&J_>=E_.length&&(E_=void 0),{value:E_&&E_[J_++],done:!E_}}};throw new TypeError(L_?"Object is not iterable.":"Symbol.iterator is not defined.")}(E_),F_={},J_("next"),J_("throw"),J_("return"),F_[Symbol.asyncIterator]=function(){return this},F_);function J_(D0){F_[D0]=E_[D0]&&function(O0){return new Promise(function(EI,eI){!function Y_(D0,O0,EI,eI){Promise.resolve(eI).then(function(Y0){D0({value:Y0,done:EI})},O0)}(EI,eI,(O0=E_[D0](O0)).done,O0.value)})}}}g.d(l,{FC:()=>V_,KL:()=>c0,_T:()=>_r,mG:()=>bh,qq:()=>B_})},5e3:(h,l,g)=>{"use strict";g.d(l,{$8M:()=>GN,$Z:()=>G5,AFp:()=>tO,AaK:()=>bh,BQk:()=>o8,CHM:()=>nM,CRH:()=>t$,CZH:()=>NW,CqO:()=>a8,EJc:()=>Mse,EiD:()=>MP,EpF:()=>xH,F4k:()=>cJ,FYo:()=>W7,FiY:()=>cR,G48:()=>jse,GfV:()=>gW,Gpc:()=>r_,JOm:()=>O_,JVY:()=>D9,L6k:()=>mL,LAX:()=>f5,LFG:()=>SI,LSH:()=>AU,Lbi:()=>zP,NdJ:()=>LH,O4$:()=>r5,OlP:()=>RT,Oqu:()=>vJ,PXZ:()=>jW,Q6J:()=>m1,QGY:()=>s8,Qsj:()=>Ste,R0b:()=>$2,RDi:()=>eU,Rgc:()=>u6,SBq:()=>q7,Sil:()=>nne,Suo:()=>Kte,TTD:()=>eS,TgZ:()=>A7,Tol:()=>Vee,Udp:()=>pJ,VLi:()=>FW,WLB:()=>vse,X6Q:()=>dQ,XFs:()=>KI,Xpm:()=>qI,Y36:()=>YN,YKP:()=>VU,YNc:()=>SH,Yjl:()=>JM,Yz7:()=>Z1,ZZ4:()=>p6,_Bn:()=>E4,_UZ:()=>i8,_Vd:()=>H7,_c5:()=>_ne,_uU:()=>S7,aQg:()=>N8,c2e:()=>_$,cJS:()=>L1,cg1:()=>SJ,d8E:()=>p8,dDg:()=>uQ,deG:()=>TG,dqk:()=>D1,eBb:()=>N9,eFA:()=>b$,ekj:()=>gJ,g9A:()=>l6,h0i:()=>b4,hGG:()=>vne,hij:()=>d8,iGM:()=>Wte,ifc:()=>M1,ip1:()=>sQ,kL8:()=>RJ,kcU:()=>I9,lG2:()=>ON,mCW:()=>AL,n5z:()=>HT,oAB:()=>AR,oJD:()=>kV,oxw:()=>u4,pB0:()=>kG,q3G:()=>iS,q4F:()=>K7,qLn:()=>yL,qOj:()=>bH,qZA:()=>bT,qzn:()=>LP,sBO:()=>dne,sIi:()=>n4,s_b:()=>TW,soG:()=>v$,tBr:()=>zR,tb:()=>kW,tp0:()=>P2,uIk:()=>YY,vHH:()=>S_,vpe:()=>NL,wAp:()=>$I,xp6:()=>J9,yhl:()=>F3,ynx:()=>TL,z2F:()=>GW,z3N:()=>gO,zSh:()=>f7,zs3:()=>G2});var f=g(7579),k=g(727),q=g(8306),_r=g(6451),_s=g(3099);function ga(I){for(let b in I)if(I[b]===ga)return b;throw Error("Could not find renamed property on target object.")}function _l(I,b){for(const F in b)b.hasOwnProperty(F)&&!I.hasOwnProperty(F)&&(I[F]=b[F])}function bh(I){if("string"==typeof I)return I;if(Array.isArray(I))return"["+I.map(bh).join(", ")+"]";if(null==I)return""+I;if(I.overriddenName)return`${I.overriddenName}`;if(I.name)return`${I.name}`;const b=I.toString();if(null==b)return""+b;const F=b.indexOf("\n");return-1===F?b:b.substring(0,F)}function n_(I,b){return null==I||""===I?null===b?"":b:null==b||""===b?I:I+" "+b}const _A=ga({__forward_ref__:ga});function r_(I){return I.__forward_ref__=r_,I.toString=function(){return bh(this())},I}function p_(I){return I_(I)?I():I}function I_(I){return"function"==typeof I&&I.hasOwnProperty(_A)&&I.__forward_ref__===r_}class S_ extends Error{constructor(b,F){super(function x_(I,b){return`NG0${Math.abs(I)}${b?": "+b:""}`}(b,F)),this.code=b}}function B_(I){return"string"==typeof I?I:null==I?"":String(I)}function V_(I){return"function"==typeof I?I.name||I.toString():"object"==typeof I&&null!=I&&"function"==typeof I.type?I.type.name||I.type.toString():B_(I)}function h0(I,b){const F=b?` in ${b}`:"";throw new S_(-201,`No provider for ${V_(I)} found${F}`)}function eI(I,b){null==I&&function Y0(I,b,F,_n){throw new Error(`ASSERTION ERROR: ${I}`+(null==_n?"":` [Expected=> ${F} ${_n} ${b} <=Actual]`))}(b,I,null,"!=")}function Z1(I){return{token:I.token,providedIn:I.providedIn||null,factory:I.factory,value:void 0}}function L1(I){return{providers:I.providers||[],imports:I.imports||[]}}function w1(I){return SN(I,$O)||SN(I,jR)}function SN(I,b){return I.hasOwnProperty(b)?I[b]:null}function YT(I){return I&&(I.hasOwnProperty(RN)||I.hasOwnProperty(ZO))?I[RN]:null}const $O=ga({\u0275prov:ga}),RN=ga({\u0275inj:ga}),jR=ga({ngInjectableDef:ga}),ZO=ga({ngInjectorDef:ga});var KI=(()=>((KI=KI||{})[KI.Default=0]="Default",KI[KI.Host=1]="Host",KI[KI.Self=2]="Self",KI[KI.SkipSelf=4]="SkipSelf",KI[KI.Optional=8]="Optional",KI))();let dO;function GT(I){const b=dO;return dO=I,b}function dP(I,b,F){const _n=w1(I);return _n&&"root"==_n.providedIn?void 0===_n.value?_n.value=_n.factory():_n.value:F&KI.Optional?null:void 0!==b?b:void h0(bh(I),"Injector")}function IS(I){return{toString:I}.toString()}var JT=(()=>((JT=JT||{})[JT.OnPush=0]="OnPush",JT[JT.Default=1]="Default",JT))(),M1=(()=>{return(I=M1||(M1={}))[I.Emulated=0]="Emulated",I[I.None=2]="None",I[I.ShadowDom=3]="ShadowDom",M1;var I})();const kI="undefined"!=typeof globalThis&&globalThis,JI="undefined"!=typeof window&&window,gR="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,D1=kI||"undefined"!=typeof global&&global||JI||gR,$T={},$_=[],_E=ga({\u0275cmp:ga}),r0=ga({\u0275dir:ga}),M0=ga({\u0275pipe:ga}),_y=ga({\u0275mod:ga}),m0=ga({\u0275fac:ga}),G0=ga({__NG_ELEMENT_ID__:ga});let yI=0;function qI(I){return IS(()=>{const F={},_n={type:I.type,providersResolver:null,decls:I.decls,vars:I.vars,factory:null,template:I.template||null,consts:I.consts||null,ngContentSelectors:I.ngContentSelectors,hostBindings:I.hostBindings||null,hostVars:I.hostVars||0,hostAttrs:I.hostAttrs||null,contentQueries:I.contentQueries||null,declaredInputs:F,inputs:null,outputs:null,exportAs:I.exportAs||null,onPush:I.changeDetection===JT.OnPush,directiveDefs:null,pipeDefs:null,selectors:I.selectors||$_,viewQuery:I.viewQuery||null,features:I.features||null,data:I.data||{},encapsulation:I.encapsulation||M1.Emulated,id:"c",styles:I.styles||$_,_:null,setInput:null,schemas:I.schemas||null,tView:null},ca=I.directives,_d=I.features,_p=I.pipes;return _n.id+=yI++,_n.inputs=YM(I.inputs,F),_n.outputs=YM(I.outputs),_d&&_d.forEach(t_=>t_(_n)),_n.directiveDefs=ca?()=>("function"==typeof ca?ca():ca).map(vT):null,_n.pipeDefs=_p?()=>("function"==typeof _p?_p():_p).map(_b):null,_n})}function vT(I){return bS(I)||function X1(I){return I[r0]||null}(I)}function _b(I){return function g2(I){return I[M0]||null}(I)}const ZT={};function AR(I){return IS(()=>{const b={type:I.type,bootstrap:I.bootstrap||$_,declarations:I.declarations||$_,imports:I.imports||$_,exports:I.exports||$_,transitiveCompileScopes:null,schemas:I.schemas||null,id:I.id||null};return null!=I.id&&(ZT[I.id]=I.type),b})}function YM(I,b){if(null==I)return $T;const F={};for(const _n in I)if(I.hasOwnProperty(_n)){let ca=I[_n],_d=ca;Array.isArray(ca)&&(_d=ca[1],ca=ca[0]),F[ca]=_n,b&&(b[ca]=_d)}return F}const ON=qI;function JM(I){return{type:I.type,name:I.name,factory:null,pure:!1!==I.pure,onDestroy:I.type.prototype.ngOnDestroy||null}}function bS(I){return I[_E]||null}function CS(I,b){const F=I[_y]||null;if(!F&&!0===b)throw new Error(`Type ${bh(I)} does not have '\u0275mod' property.`);return F}function HR(I){return Array.isArray(I)&&"object"==typeof I[1]}function PN(I){return Array.isArray(I)&&!0===I[1]}function A3(I){return 0!=(8&I.flags)}function X6(I){return 2==(2&I.flags)}function xN(I){return 1==(1&I.flags)}function LN(I){return null!==I.template}function mj(I){return 0!=(512&I[2])}function _R(I,b){return I.hasOwnProperty(m0)?I[m0]:null}class TS{constructor(b,F,_n){this.previousValue=b,this.currentValue=F,this.firstChange=_n}isFirstChange(){return this.firstChange}}function eS(){return XL}function XL(I){return I.type.prototype.ngOnChanges&&(I.setInput=CG),v3}function v3(){const I=XO(this),b=null==I?void 0:I.current;if(b){const F=I.previous;if(F===$T)I.previous=b;else for(let _n in b)F[_n]=b[_n];I.current=null,this.ngOnChanges(b)}}function CG(I,b,F,_n){const ca=XO(I)||function v2(I,b){return I[nL]=b}(I,{previous:$T,current:null}),_d=ca.current||(ca.current={}),_p=ca.previous,t_=this.declaredInputs[F],s_=_p[t_];_d[t_]=new TS(s_&&s_.currentValue,b,_p===$T),I[_n]=b}eS.ngInherit=!0;const nL="__ngSimpleChanges__";function XO(I){return I[nL]||null}let AP;function eU(I){AP=I}function MN(){return void 0!==AP?AP:"undefined"!=typeof document?document:void 0}function nT(I){return!!I.listen}const tU={createRenderer:(I,b)=>MN()};function K1(I){for(;Array.isArray(I);)I=I[0];return I}function _P(I,b){return K1(b[I])}function WS(I,b){return K1(b[I.index])}function kT(I,b){return I.data[b]}function sR(I,b){const F=b[I];return HR(F)?F:F[0]}function vP(I){return 4==(4&I[2])}function y2(I){return 128==(128&I[2])}function PT(I,b){return null==b?null:I[b]}function DO(I){I[18]=0}function eM(I,b){I[5]+=b;let F=I,_n=I[3];for(;null!==_n&&(1===b&&1===F[5]||-1===b&&0===F[5]);)_n[5]+=b,F=_n,_n=_n[3]}const zI={lFrame:iM(null),bindingsEnabled:!0};function I3(){return zI.bindingsEnabled}function j0(){return zI.lFrame.lView}function T1(){return zI.lFrame.tView}function nM(I){return zI.lFrame.contextLView=I,I[8]}function ST(){let I=C3();for(;null!==I&&64===I.type;)I=I.parent;return I}function C3(){return zI.lFrame.currentTNode}function NO(I,b){const F=zI.lFrame;F.currentTNode=I,F.isParent=b}function $j(){return zI.lFrame.isParent}function UN(){zI.lFrame.isParent=!1}function EP(){return zI.lFrame.bindingIndex++}function SS(I){const b=zI.lFrame,F=b.bindingIndex;return b.bindingIndex=b.bindingIndex+I,F}function T3(I,b){const F=zI.lFrame;F.bindingIndex=F.bindingRootIndex=I,oU(b)}function oU(I){zI.lFrame.currentDirectiveIndex=I}function rM(I){const b=zI.lFrame.currentDirectiveIndex;return-1===b?null:I[b]}function R3(){return zI.lFrame.currentQueryIndex}function lV(I){zI.lFrame.currentQueryIndex=I}function dV(I){const b=I[1];return 2===b.type?b.declTNode:1===b.type?I[6]:null}function sU(I,b,F){if(F&KI.SkipSelf){let ca=b,_d=I;for(;!(ca=ca.parent,null!==ca||F&KI.Host||(ca=dV(_d),null===ca||(_d=_d[15],10&ca.type))););if(null===ca)return!1;b=ca,I=_d}const _n=zI.lFrame=O3();return _n.currentTNode=b,_n.lView=I,!0}function IP(I){const b=O3(),F=I[1];zI.lFrame=b,b.currentTNode=F.firstChild,b.lView=I,b.tView=F,b.contextLView=I,b.bindingIndex=F.bindingStartIndex,b.inI18n=!1}function O3(){const I=zI.lFrame,b=null===I?null:I.child;return null===b?iM(I):b}function iM(I){const b={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:I,child:null,inI18n:!1};return null!==I&&(I.child=b),b}function hV(){const I=zI.lFrame;return zI.lFrame=I.parent,I.currentTNode=null,I.lView=null,I}const aU=hV;function fO(){const I=hV();I.isParent=!0,I.tView=null,I.selectedIndex=-1,I.contextLView=null,I.elementDepthCount=0,I.currentDirectiveIndex=-1,I.currentNamespace=null,I.bindingRootIndex=-1,I.bindingIndex=-1,I.currentQueryIndex=0}function KS(){return zI.lFrame.selectedIndex}function aL(I){zI.lFrame.selectedIndex=I}function cS(){const I=zI.lFrame;return kT(I.tView,I.selectedIndex)}function r5(){zI.lFrame.currentNamespace="svg"}function I9(){!function fV(){zI.lFrame.currentNamespace=null}()}function cU(I,b){for(let F=b.directiveStart,_n=b.directiveEnd;F<_n;F++){const _d=I.data[F].type.prototype,{ngAfterContentInit:_p,ngAfterContentChecked:t_,ngAfterViewInit:s_,ngAfterViewChecked:A_,ngOnDestroy:C_}=_d;_p&&(I.contentHooks||(I.contentHooks=[])).push(-F,_p),t_&&((I.contentHooks||(I.contentHooks=[])).push(F,t_),(I.contentCheckHooks||(I.contentCheckHooks=[])).push(F,t_)),s_&&(I.viewHooks||(I.viewHooks=[])).push(-F,s_),A_&&((I.viewHooks||(I.viewHooks=[])).push(F,A_),(I.viewCheckHooks||(I.viewCheckHooks=[])).push(F,A_)),null!=C_&&(I.destroyHooks||(I.destroyHooks=[])).push(F,C_)}}function I2(I,b,F){gV(I,b,3,F)}function eN(I,b,F,_n){(3&I[2])===F&&gV(I,b,F,_n)}function RS(I,b){let F=I[2];(3&F)===b&&(F&=2047,F+=1,I[2]=F)}function gV(I,b,F,_n){const _d=null!=_n?_n:-1,_p=b.length-1;let t_=0;for(let s_=void 0!==_n?65535&I[18]:0;s_<_p;s_++)if("number"==typeof b[s_+1]){if(t_=b[s_],null!=_n&&t_>=_n)break}else b[s_]<0&&(I[18]+=65536),(t_<_d||-1==_d)&&(b9(I,F,b,s_),I[18]=(4294901760&I[18])+s_+2),s_++}function b9(I,b,F,_n){const ca=F[_n]<0,_d=F[_n+1],t_=I[ca?-F[_n]:F[_n]];if(ca){if(I[2]>>11<I[18]>>16&&(3&I[2])===b){I[2]+=2048;try{_d.call(t_)}finally{}}}else try{_d.call(t_)}finally{}}class bP{constructor(b,F,_n){this.factory=b,this.resolving=!1,this.canSeeViewProviders=F,this.injectImpl=_n}}function xT(I,b,F){const _n=nT(I);let ca=0;for(;ca<F.length;){const _d=F[ca];if("number"==typeof _d){if(0!==_d)break;ca++;const _p=F[ca++],t_=F[ca++],s_=F[ca++];_n?I.setAttribute(b,t_,s_,_p):b.setAttributeNS(_p,t_,s_)}else{const _p=_d,t_=F[++ca];LT(_p)?_n&&I.setProperty(b,_p,t_):_n?I.setAttribute(b,_p,t_):b.setAttribute(_p,t_),ca++}}return ca}function WR(I){return 3===I||4===I||6===I}function LT(I){return 64===I.charCodeAt(0)}function aM(I,b){if(null!==b&&0!==b.length)if(null===I||0===I.length)I=b.slice();else{let F=-1;for(let _n=0;_n<b.length;_n++){const ca=b[_n];"number"==typeof ca?F=ca:0===F||AV(I,F,ca,null,-1===F||2===F?b[++_n]:null)}}return I}function AV(I,b,F,_n,ca){let _d=0,_p=I.length;if(-1===b)_p=-1;else for(;_d<I.length;){const t_=I[_d++];if("number"==typeof t_){if(t_===b){_p=-1;break}if(t_>b){_p=_d-1;break}}}for(;_d<I.length;){const t_=I[_d];if("number"==typeof t_)break;if(t_===F){if(null===_n)return void(null!==ca&&(I[_d+1]=ca));if(_n===I[_d+1])return void(I[_d+2]=ca)}_d++,null!==_n&&_d++,null!==ca&&_d++}-1!==_p&&(I.splice(_p,0,b),_d=_p+1),I.splice(_d++,0,F),null!==_n&&I.splice(_d++,0,_n),null!==ca&&I.splice(_d++,0,ca)}function cM(I){return-1!==I}function CP(I){return 32767&I}function wP(I,b){let F=function tS(I){return I>>16}(I),_n=b;for(;F>0;)_n=_n[15],F--;return _n}let tN=!0;function RI(I){const b=tN;return tN=I,b}let uL=0;function TP(I,b){const F=SP(I,b);if(-1!==F)return F;const _n=b[1];_n.firstCreatePass&&(I.injectorIndex=b.length,uM(_n.data,I),uM(b,null),uM(_n.blueprint,null));const ca=uS(I,b),_d=I.injectorIndex;if(cM(ca)){const _p=CP(ca),t_=wP(ca,b),s_=t_[1].data;for(let A_=0;A_<8;A_++)b[_d+A_]=t_[_p+A_]|s_[_p+A_]}return b[_d+8]=ca,_d}function uM(I,b){I.push(0,0,0,0,0,0,0,0,b)}function SP(I,b){return-1===I.injectorIndex||I.parent&&I.parent.injectorIndex===I.injectorIndex||null===b[I.injectorIndex+8]?-1:I.injectorIndex}function uS(I,b){if(I.parent&&-1!==I.parent.injectorIndex)return I.parent.injectorIndex;let F=0,_n=null,ca=b;for(;null!==ca;){const _d=ca[1],_p=_d.type;if(_n=2===_p?_d.declTNode:1===_p?ca[6]:null,null===_n)return-1;if(F++,ca=ca[15],-1!==_n.injectorIndex)return _n.injectorIndex|F<<16}return-1}function lL(I,b,F){!function nS(I,b,F){let _n;"string"==typeof F?_n=F.charCodeAt(0)||0:F.hasOwnProperty(G0)&&(_n=F[G0]),null==_n&&(_n=F[G0]=uL++);const ca=255&_n;b.data[I+(ca>>5)]|=1<<ca}(I,b,F)}function jN(I,b,F){if(F&KI.Optional)return I;h0(b,"NodeInjector")}function OP(I,b,F,_n){if(F&KI.Optional&&void 0===_n&&(_n=null),0==(F&(KI.Self|KI.Host))){const ca=I[9],_d=GT(void 0);try{return ca?ca.get(b,_n,F&KI.Optional):dP(b,_n,F&KI.Optional)}finally{GT(_d)}}return jN(_n,b,F)}function lM(I,b,F,_n=KI.Default,ca){if(null!==I){const _d=function dL(I){if("string"==typeof I)return I.charCodeAt(0)||0;const b=I.hasOwnProperty(G0)?I[G0]:void 0;return"number"==typeof b?b>=0?255&b:VN:b}(F);if("function"==typeof _d){if(!sU(b,I,_n))return _n&KI.Host?jN(ca,F,_n):OP(b,F,_n,ca);try{const _p=_d(_n);if(null!=_p||_n&KI.Optional)return _p;h0(F)}finally{aU()}}else if("number"==typeof _d){let _p=null,t_=SP(I,b),s_=-1,A_=_n&KI.Host?b[16][6]:null;for((-1===t_||_n&KI.SkipSelf)&&(s_=-1===t_?uS(I,b):b[t_+8],-1!==s_&&N3(_n,!1)?(_p=b[1],t_=CP(s_),b=wP(s_,b)):t_=-1);-1!==t_;){const C_=b[1];if(rS(_d,t_,C_.data)){const Q_=NP(t_,b,F,_p,_n,A_);if(Q_!==DP)return Q_}s_=b[t_+8],-1!==s_&&N3(_n,b[1].data[t_+8]===A_)&&rS(_d,t_,b)?(_p=C_,t_=CP(s_),b=wP(s_,b)):t_=-1}}}return OP(b,F,_n,ca)}const DP={};function VN(){return new kP(ST(),j0())}function NP(I,b,F,_n,ca,_d){const _p=b[1],t_=_p.data[I+8],C_=lU(t_,_p,F,null==_n?X6(t_)&&tN:_n!=_p&&0!=(3&t_.type),ca&KI.Host&&_d===t_);return null!==C_?b2(b,_p,C_,t_):DP}function lU(I,b,F,_n,ca){const _d=I.providerIndexes,_p=b.data,t_=1048575&_d,s_=I.directiveStart,C_=_d>>20,Qv=ca?t_+C_:I.directiveEnd;for(let g0=_n?t_:t_+C_;g0<Qv;g0++){const P0=_p[g0];if(g0<s_&&F===P0||g0>=s_&&P0.type===F)return g0}if(ca){const g0=_p[s_];if(g0&&LN(g0)&&g0.type===F)return s_}return null}function b2(I,b,F,_n){let ca=I[F];const _d=b.data;if(function oM(I){return I instanceof bP}(ca)){const _p=ca;_p.resolving&&function _0(I,b){const F=b?`. Dependency path: ${b.join(" > ")} > ${I}`:"";throw new S_(-200,`Circular dependency in DI detected for ${I}${F}`)}(V_(_d[F]));const t_=RI(_p.canSeeViewProviders);_p.resolving=!0;const s_=_p.injectImpl?GT(_p.injectImpl):null;sU(I,_n,KI.Default);try{ca=I[F]=_p.factory(void 0,_d,I,_n),b.firstCreatePass&&F>=_n.directiveStart&&function pY(I,b,F){const{ngOnChanges:_n,ngOnInit:ca,ngDoCheck:_d}=b.type.prototype;if(_n){const _p=XL(b);(F.preOrderHooks||(F.preOrderHooks=[])).push(I,_p),(F.preOrderCheckHooks||(F.preOrderCheckHooks=[])).push(I,_p)}ca&&(F.preOrderHooks||(F.preOrderHooks=[])).push(0-I,ca),_d&&((F.preOrderHooks||(F.preOrderHooks=[])).push(I,_d),(F.preOrderCheckHooks||(F.preOrderCheckHooks=[])).push(I,_d))}(F,_d[F],b)}finally{null!==s_&&GT(s_),RI(t_),_p.resolving=!1,aU()}}return ca}function rS(I,b,F){return!!(F[b+(I>>5)]&1<<I)}function N3(I,b){return!(I&KI.Self||I&KI.Host&&b)}class kP{constructor(b,F){this._tNode=b,this._lView=F}get(b,F,_n){return lM(this._tNode,this._lView,b,_n,F)}}function HT(I){return IS(()=>{const b=I.prototype.constructor,F=b[m0]||hL(b),_n=Object.prototype;let ca=Object.getPrototypeOf(I.prototype).constructor;for(;ca&&ca!==_n;){const _d=ca[m0]||hL(ca);if(_d&&_d!==F)return _d;ca=Object.getPrototypeOf(ca)}return _d=>new _d})}function hL(I){return I_(I)?()=>{const b=hL(p_(I));return b&&b()}:_R(I)}function GN(I){return function RP(I,b){if("class"===b)return I.classes;if("style"===b)return I.styles;const F=I.attrs;if(F){const _n=F.length;let ca=0;for(;ca<_n;){const _d=F[ca];if(WR(_d))break;if(0===_d)ca+=2;else if("number"==typeof _d)for(ca++;ca<_n&&"string"==typeof F[ca];)ca++;else{if(_d===b)return F[ca+1];ca+=2}}}return null}(ST(),I)}const xO="__parameters__";function LO(I,b,F){return IS(()=>{const _n=function OS(I){return function(...F){if(I){const _n=I(...F);for(const ca in _n)this[ca]=_n[ca]}}}(b);function ca(..._d){if(this instanceof ca)return _n.apply(this,_d),this;const _p=new ca(..._d);return t_.annotation=_p,t_;function t_(s_,A_,C_){const Q_=s_.hasOwnProperty(xO)?s_[xO]:Object.defineProperty(s_,xO,{value:[]})[xO];for(;Q_.length<=C_;)Q_.push(null);return(Q_[C_]=Q_[C_]||[]).push(_p),s_}}return F&&(ca.prototype=Object.create(F.prototype)),ca.prototype.ngMetadataName=I,ca.annotationCls=ca,ca})}class RT{constructor(b,F){this._desc=b,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof F?this.__NG_ELEMENT_ID__=F:void 0!==F&&(this.\u0275prov=Z1({token:this,providedIn:F.providedIn||"root",factory:F.factory}))}toString(){return`InjectionToken ${this._desc}`}}const TG=new RT("AnalyzeForEntryComponents");function yR(I,b){void 0===b&&(b=I);for(let F=0;F<I.length;F++){let _n=I[F];Array.isArray(_n)?(b===I&&(b=I.slice(0,F)),yR(_n,b)):b!==I&&b.push(_n)}return b}function KR(I,b){I.forEach(F=>Array.isArray(F)?KR(F,b):b(F))}function hM(I,b,F){b>=I.length?I.push(F):I.splice(b,0,F)}function fM(I,b){return b>=I.length-1?I.pop():I.splice(b,1)[0]}function ER(I,b,F){let _n=pL(I,b);return _n>=0?I[1|_n]=F:(_n=~_n,function O2(I,b,F,_n){let ca=I.length;if(ca==b)I.push(F,_n);else if(1===ca)I.push(_n,I[0]),I[0]=F;else{for(ca--,I.push(I[ca-1],I[ca]);ca>b;)I[ca]=I[ca-2],ca--;I[b]=F,I[b+1]=_n}}(I,_n,b,F)),_n}function pM(I,b){const F=pL(I,b);if(F>=0)return I[1|F]}function pL(I,b){return function D2(I,b,F){let _n=0,ca=I.length>>F;for(;ca!==_n;){const _d=_n+(ca-_n>>1),_p=I[_d<<F];if(b===_p)return _d<<F;_p>b?ca=_d:_n=_d+1}return~(ca<<F)}(I,b,1)}const BO={},gL="__NG_DI_FLAG__",N2="ngTempTokenPath",d_=/\n/gm,K_="__source",p0=ga({provide:String,useValue:ga});let E0;function k0(I){const b=E0;return E0=I,b}function vI(I,b=KI.Default){if(void 0===E0)throw new S_(203,"");return null===E0?dP(I,void 0,b):E0.get(I,b&KI.Optional?null:void 0,b)}function SI(I,b=KI.Default){return(function TT(){return dO}()||vI)(p_(I),b)}const Q1=SI;function t1(I){const b=[];for(let F=0;F<I.length;F++){const _n=p_(I[F]);if(Array.isArray(_n)){if(0===_n.length)throw new S_(900,"");let ca,_d=KI.Default;for(let _p=0;_p<_n.length;_p++){const t_=_n[_p],s_=NS(t_);"number"==typeof s_?-1===s_?ca=t_.token:_d|=s_:ca=t_}b.push(SI(ca,_d))}else b.push(SI(_n))}return b}function dS(I,b){return I[gL]=b,I.prototype[gL]=b,I}function NS(I){return I[gL]}const zR=dS(LO("Inject",I=>({token:I})),-1),cR=dS(LO("Optional"),8),P2=dS(LO("SkipSelf"),4);let U3,L2;function mM(I){var b;return(null===(b=function OV(){if(void 0===U3&&(U3=null,D1.trustedTypes))try{U3=D1.trustedTypes.createPolicy("angular",{createHTML:I=>I,createScript:I=>I,createScriptURL:I=>I})}catch(I){}return U3}())||void 0===b?void 0:b.createHTML(I))||I}function h5(I){var b;return(null===(b=function d5(){if(void 0===L2&&(L2=null,D1.trustedTypes))try{L2=D1.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:I=>I,createScript:I=>I,createScriptURL:I=>I})}catch(I){}return L2}())||void 0===b?void 0:b.createHTML(I))||I}class oN{constructor(b){this.changingThisBreaksApplicationSecurity=b}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class pU extends oN{getTypeName(){return"HTML"}}class gU extends oN{getTypeName(){return"Style"}}class DG extends oN{getTypeName(){return"Script"}}class NG extends oN{getTypeName(){return"URL"}}class O9 extends oN{getTypeName(){return"ResourceURL"}}function gO(I){return I instanceof oN?I.changingThisBreaksApplicationSecurity:I}function LP(I,b){const F=F3(I);if(null!=F&&F!==b){if("ResourceURL"===F&&"URL"===b)return!0;throw new Error(`Required a safe ${b}, got a ${F} (see https://g.co/ng/security#xss)`)}return F===b}function F3(I){return I instanceof oN&&I.getTypeName()||null}function D9(I){return new pU(I)}function mL(I){return new gU(I)}function N9(I){return new DG(I)}function f5(I){return new NG(I)}function kG(I){return new O9(I)}class k9{constructor(b){this.inertDocumentHelper=b}getInertBodyElement(b){b="<body><remove></remove>"+b;try{const F=(new window.DOMParser).parseFromString(mM(b),"text/html").body;return null===F?this.inertDocumentHelper.getInertBodyElement(b):(F.removeChild(F.firstChild),F)}catch(F){return null}}}class P9{constructor(b){if(this.defaultDoc=b,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const F=this.inertDocument.createElement("html");this.inertDocument.appendChild(F);const _n=this.inertDocument.createElement("body");F.appendChild(_n)}}getInertBodyElement(b){const F=this.inertDocument.createElement("template");if("content"in F)return F.innerHTML=mM(b),F;const _n=this.inertDocument.createElement("body");return _n.innerHTML=mM(b),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(_n),_n}stripCustomNsAttrs(b){const F=b.attributes;for(let ca=F.length-1;0<ca;ca--){const _p=F.item(ca).name;("xmlns:ns1"===_p||0===_p.indexOf("ns1:"))&&b.removeAttribute(_p)}let _n=b.firstChild;for(;_n;)_n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(_n),_n=_n.nextSibling}}const x9=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,AM=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function AL(I){return(I=String(I)).match(x9)||I.match(AM)?I:"unsafe:"+I}function sN(I){const b={};for(const F of I.split(","))b[F]=!0;return b}function p5(...I){const b={};for(const F of I)for(const _n in F)F.hasOwnProperty(_n)&&(b[_n]=!0);return b}const V3=sN("area,br,col,hr,img,wbr"),g5=sN("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),_L=sN("rp,rt"),Q3=p5(V3,p5(g5,sN("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),p5(_L,sN("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),p5(_L,g5)),xG=sN("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),NV=sN("srcset"),LG=p5(xG,NV,sN("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),sN("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),mU=sN("script,style,template");class A5{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(b){let F=b.firstChild,_n=!0;for(;F;)if(F.nodeType===Node.ELEMENT_NODE?_n=this.startElement(F):F.nodeType===Node.TEXT_NODE?this.chars(F.nodeValue):this.sanitizedSomething=!0,_n&&F.firstChild)F=F.firstChild;else for(;F;){F.nodeType===Node.ELEMENT_NODE&&this.endElement(F);let ca=this.checkClobberedElement(F,F.nextSibling);if(ca){F=ca;break}F=this.checkClobberedElement(F,F.parentNode)}return this.buf.join("")}startElement(b){const F=b.nodeName.toLowerCase();if(!Q3.hasOwnProperty(F))return this.sanitizedSomething=!0,!mU.hasOwnProperty(F);this.buf.push("<"),this.buf.push(F);const _n=b.attributes;for(let ca=0;ca<_n.length;ca++){const _d=_n.item(ca),_p=_d.name,t_=_p.toLowerCase();if(!LG.hasOwnProperty(t_)){this.sanitizedSomething=!0;continue}let s_=_d.value;xG[t_]&&(s_=AL(s_)),NV[t_]&&(I=s_,s_=(I=String(I)).split(",").map(b=>AL(b.trim())).join(", ")),this.buf.push(" ",_p,'="',aN(s_),'"')}var I;return this.buf.push(">"),!0}endElement(b){const F=b.nodeName.toLowerCase();Q3.hasOwnProperty(F)&&!V3.hasOwnProperty(F)&&(this.buf.push("</"),this.buf.push(F),this.buf.push(">"))}chars(b){this.buf.push(aN(b))}checkClobberedElement(b,F){if(F&&(b.compareDocumentPosition(F)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${b.outerHTML}`);return F}}const mY=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,_5=/([^\#-~ |!])/g;function aN(I){return I.replace(/&/g,"&amp;").replace(mY,function(b){return"&#"+(1024*(b.charCodeAt(0)-55296)+(b.charCodeAt(1)-56320)+65536)+";"}).replace(_5,function(b){return"&#"+b.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let q3;function MP(I,b){let F=null;try{q3=q3||function PG(I){const b=new P9(I);return function j3(){try{return!!(new window.DOMParser).parseFromString(mM(""),"text/html")}catch(I){return!1}}()?new k9(b):b}(I);let _n=b?String(b):"";F=q3.getInertBodyElement(_n);let ca=5,_d=_n;do{if(0===ca)throw new Error("Failed to sanitize html because the input is unstable");ca--,_n=_d,_d=F.innerHTML,F=q3.getInertBodyElement(_n)}while(_n!==_d);return mM((new A5).sanitizeChildren(_M(F)||F))}finally{if(F){const _n=_M(F)||F;for(;_n.firstChild;)_n.removeChild(_n.firstChild)}}}function _M(I){return"content"in I&&function JR(I){return I.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===I.nodeName}(I)?I.content:null}var iS=(()=>((iS=iS||{})[iS.NONE=0]="NONE",iS[iS.HTML=1]="HTML",iS[iS.STYLE=2]="STYLE",iS[iS.SCRIPT=3]="SCRIPT",iS[iS.URL=4]="URL",iS[iS.RESOURCE_URL=5]="RESOURCE_URL",iS))();function kV(I){const b=vU();return b?h5(b.sanitize(iS.HTML,I)||""):LP(I,"HTML")?h5(gO(I)):MP(MN(),B_(I))}function AU(I){const b=vU();return b?b.sanitize(iS.URL,I)||"":LP(I,"URL")?gO(I):AL(B_(I))}function vU(){const I=j0();return I&&I[12]}const y5="__ngContext__";function kS(I,b){I[y5]=b}function E5(I){const b=function W3(I){return I[y5]||null}(I);return b?Array.isArray(b)?b:b.lView:null}function C5(I){return I.ngOriginalError}function GG(I,...b){I.error(...b)}class yL{constructor(){this._console=console}handleError(b){const F=this._findOriginalError(b),_n=function VG(I){return I&&I.ngErrorLogger||GG}(b);_n(this._console,"ERROR",b),F&&_n(this._console,"ORIGINAL ERROR",F)}_findOriginalError(b){let F=b&&C5(b);for(;F&&C5(F);)F=C5(F);return F||null}}const UV=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(D1))();function Nf(I){return I instanceof Function?I():I}var O_=(()=>((O_=O_||{})[O_.Important=1]="Important",O_[O_.DashCase=2]="DashCase",O_))();function N0(I,b){return undefined(I,b)}function VI(I){const b=I[3];return PN(b)?b[3]:b}function FO(I){return FV(I[13])}function K3(I){return FV(I[4])}function FV(I){for(;null!==I&&!PN(I);)I=I[4];return I}function yU(I,b,F,_n,ca){if(null!=_n){let _d,_p=!1;PN(_n)?_d=_n:HR(_n)&&(_p=!0,_n=_n[0]);const t_=K1(_n);0===I&&null!==F?null==ca?B2(b,F,t_):jP(b,F,t_,ca||null,!0):1===I&&null!==F?jP(b,F,t_,ca||null,!0):2===I?function VV(I,b,F){const _n=AO(I,b);_n&&function YG(I,b,F,_n){nT(I)?I.removeChild(b,F,_n):b.removeChild(F)}(I,_n,b,F)}(b,t_,_p):3===I&&b.destroyNode(t_),null!=_d&&function EU(I,b,F,_n,ca){const _d=F[7];_d!==K1(F)&&yU(b,I,_n,_d,ca);for(let t_=10;t_<F.length;t_++){const s_=F[t_];C0(s_[1],s_,I,b,_n,_d)}}(b,I,_d,F,ca)}}function qT(I,b,F){if(nT(I))return I.createElement(b,F);{const _n=null!==F?function y3(I){const b=I.toLowerCase();return"svg"===b?"http://www.w3.org/2000/svg":"math"===b?"http://www.w3.org/1998/MathML/":null}(F):null;return null===_n?I.createElement(b):I.createElementNS(_n,b)}}function KG(I,b){const F=I[9],_n=F.indexOf(b),ca=b[3];1024&b[2]&&(b[2]&=-1025,eM(ca,-1)),F.splice(_n,1)}function n1(I,b){if(I.length<=10)return;const F=10+b,_n=I[F];if(_n){const ca=_n[17];null!==ca&&ca!==I&&KG(ca,_n),b>0&&(I[F-1][4]=_n[4]);const _d=fM(I,10+b);!function jV(I,b){C0(I,b,b[11],2,null,null),b[0]=null,b[6]=null}(_n[1],_n);const _p=_d[19];null!==_p&&_p.detachView(_d[1]),_n[3]=null,_n[4]=null,_n[2]&=-129}return _n}function GX(I,b){if(!(256&b[2])){const F=b[11];nT(F)&&F.destroyNode&&C0(I,b,F,3,null,null),function R5(I){let b=I[13];if(!b)return zG(I[1],I);for(;b;){let F=null;if(HR(b))F=b[13];else{const _n=b[10];_n&&(F=_n)}if(!F){for(;b&&!b[4]&&b!==I;)HR(b)&&zG(b[1],b),b=b[3];null===b&&(b=I),HR(b)&&zG(b[1],b),F=b&&b[4]}b=F}}(b)}}function zG(I,b){if(!(256&b[2])){b[2]&=-129,b[2]|=256,function Q9(I,b){let F;if(null!=I&&null!=(F=I.destroyHooks))for(let _n=0;_n<F.length;_n+=2){const ca=b[F[_n]];if(!(ca instanceof bP)){const _d=F[_n+1];if(Array.isArray(_d))for(let _p=0;_p<_d.length;_p+=2){const t_=ca[_d[_p]],s_=_d[_p+1];try{s_.call(t_)}finally{}}else try{_d.call(ca)}finally{}}}}(I,b),function EY(I,b){const F=I.cleanup,_n=b[7];let ca=-1;if(null!==F)for(let _d=0;_d<F.length-1;_d+=2)if("string"==typeof F[_d]){const _p=F[_d+1],t_="function"==typeof _p?_p(b):K1(b[_p]),s_=_n[ca=F[_d+2]],A_=F[_d+3];"boolean"==typeof A_?t_.removeEventListener(F[_d],s_,A_):A_>=0?_n[ca=A_]():_n[ca=-A_].unsubscribe(),_d+=2}else{const _p=_n[ca=F[_d+1]];F[_d].call(_p)}if(null!==_n){for(let _d=ca+1;_d<_n.length;_d++)_n[_d]();b[7]=null}}(I,b),1===b[1].type&&nT(b[11])&&b[11].destroy();const F=b[17];if(null!==F&&PN(b[3])){F!==b[3]&&KG(F,b);const _n=b[19];null!==_n&&_n.detachView(I)}}}function IY(I,b,F){return function MT(I,b,F){let _n=b;for(;null!==_n&&40&_n.type;)_n=(b=_n).parent;if(null===_n)return F[0];if(2&_n.flags){const ca=I.data[_n.directiveStart].encapsulation;if(ca===M1.None||ca===M1.Emulated)return null}return WS(_n,F)}(I,b.parent,F)}function jP(I,b,F,_n,ca){nT(I)?I.insertBefore(b,F,_n,ca):b.insertBefore(F,_n,ca)}function B2(I,b,F){nT(I)?I.appendChild(b,F):b.appendChild(F)}function QX(I,b,F,_n,ca){null!==_n?jP(I,b,F,_n,ca):B2(I,b,F)}function AO(I,b){return nT(I)?I.parentNode(b):b.parentNode}let HX=function q9(I,b,F){return 40&I.type?WS(I,F):null};function U2(I,b,F,_n){const ca=IY(I,_n,b),_d=b[11],t_=function bY(I,b,F){return HX(I,b,F)}(_n.parent||b[6],_n,b);if(null!=ca)if(Array.isArray(F))for(let s_=0;s_<F.length;s_++)QX(_d,ca,F[s_],t_,!1);else QX(_d,ca,F,t_,!1)}function $G(I,b){if(null!==b){const F=b.type;if(3&F)return WS(b,I);if(4&F)return W9(-1,I[b.index]);if(8&F){const _n=b.child;if(null!==_n)return $G(I,_n);{const ca=I[b.index];return PN(ca)?W9(-1,ca):K1(ca)}}if(32&F)return N0(b,I)()||K1(I[b.index]);{const _n=qX(I,b);return null!==_n?Array.isArray(_n)?_n[0]:$G(VI(I[16]),_n):$G(I,b.next)}}return null}function qX(I,b){return null!==b?I[16][6].projection[b.projection]:null}function W9(I,b){const F=10+I+1;if(F<b.length){const _n=b[F],ca=_n[1].firstChild;if(null!==ca)return $G(_n,ca)}return b[7]}function WX(I,b,F,_n,ca,_d,_p){for(;null!=F;){const t_=_n[F.index],s_=F.type;if(_p&&0===b&&(t_&&kS(K1(t_),_n),F.flags|=4),64!=(64&F.flags))if(8&s_)WX(I,b,F.child,_n,ca,_d,!1),yU(b,I,ca,t_,_d);else if(32&s_){const A_=N0(F,_n);let C_;for(;C_=A_();)yU(b,I,ca,C_,_d);yU(b,I,ca,t_,_d)}else 16&s_?ZG(I,b,_n,F,ca,_d):yU(b,I,ca,t_,_d);F=_p?F.projectionNext:F.next}}function C0(I,b,F,_n,ca,_d){WX(F,_n,I.firstChild,b,ca,_d,!1)}function ZG(I,b,F,_n,ca,_d){const _p=F[16],s_=_p[6].projection[_n.projection];if(Array.isArray(s_))for(let A_=0;A_<s_.length;A_++)yU(b,I,ca,s_[A_],_d);else WX(I,b,s_,_p[3],ca,_d,!0)}function zX(I,b,F){nT(I)?I.setAttribute(b,"style",F):b.style.cssText=F}function GV(I,b,F){nT(I)?""===F?I.removeAttribute(b,"class"):I.setAttribute(b,"class",F):b.className=F}function YX(I,b,F){let _n=I.length;for(;;){const ca=I.indexOf(b,F);if(-1===ca)return ca;if(0===ca||I.charCodeAt(ca-1)<=32){const _d=b.length;if(ca+_d===_n||I.charCodeAt(ca+_d)<=32)return ca}F=ca+1}}const EM="ng-template";function VP(I,b,F){let _n=0;for(;_n<I.length;){let ca=I[_n++];if(F&&"class"===ca){if(ca=I[_n],-1!==YX(ca.toLowerCase(),b,0))return!0}else if(1===ca){for(;_n<I.length&&"string"==typeof(ca=I[_n++]);)if(ca.toLowerCase()===b)return!0;return!1}}return!1}function F2(I){return 4===I.type&&I.value!==EM}function IU(I,b,F){return b===(4!==I.type||F?I.value:EM)}function CY(I,b,F){let _n=4;const ca=I.attrs||[],_d=function IL(I){for(let b=0;b<I.length;b++)if(WR(I[b]))return b;return I.length}(ca);let _p=!1;for(let t_=0;t_<b.length;t_++){const s_=b[t_];if("number"!=typeof s_){if(!_p)if(4&_n){if(_n=2|1&_n,""!==s_&&!IU(I,s_,F)||""===s_&&1===b.length){if(qN(_n))return!1;_p=!0}}else{const A_=8&_n?s_:b[++t_];if(8&_n&&null!==I.attrs){if(!VP(I.attrs,A_,F)){if(qN(_n))return!1;_p=!0}continue}const Q_=JX(8&_n?"class":s_,ca,F2(I),F);if(-1===Q_){if(qN(_n))return!1;_p=!0;continue}if(""!==A_){let Qv;Qv=Q_>_d?"":ca[Q_+1].toLowerCase();const g0=8&_n?Qv:null;if(g0&&-1!==YX(g0,A_,0)||2&_n&&A_!==Qv){if(qN(_n))return!1;_p=!0}}}}else{if(!_p&&!qN(_n)&&!qN(s_))return!1;if(_p&&qN(s_))continue;_p=!1,_n=s_|1&_n}}return qN(_n)||_p}function qN(I){return 0==(1&I)}function JX(I,b,F,_n){if(null===b)return-1;let ca=0;if(_n||!F){let _d=!1;for(;ca<b.length;){const _p=b[ca];if(_p===I)return ca;if(3===_p||6===_p)_d=!0;else{if(1===_p||2===_p){let t_=b[++ca];for(;"string"==typeof t_;)t_=b[++ca];continue}if(4===_p)break;if(0===_p){ca+=4;continue}}ca+=_d?1:2}return-1}return function YS(I,b){let F=I.indexOf(4);if(F>-1)for(F++;F<I.length;){const _n=I[F];if("number"==typeof _n)return-1;if(_n===b)return F;F++}return-1}(b,I)}function z9(I,b,F=!1){for(let _n=0;_n<b.length;_n++)if(CY(I,b[_n],F))return!0;return!1}function e7(I,b){return I?":not("+b.trim()+")":b}function t7(I){let b=I[0],F=1,_n=2,ca="",_d=!1;for(;F<I.length;){let _p=I[F];if("string"==typeof _p)if(2&_n){const t_=I[++F];ca+="["+_p+(t_.length>0?'="'+t_+'"':"")+"]"}else 8&_n?ca+="."+_p:4&_n&&(ca+=" "+_p);else""!==ca&&!qN(_p)&&(b+=e7(_d,ca),ca=""),_n=_p,_d=_d||!qN(_n);F++}return""!==ca&&(b+=e7(_d,ca)),b}const r1={};function J9(I){TY(T1(),j0(),KS()+I,!1)}function TY(I,b,F,_n){if(!_n)if(3==(3&b[2])){const _d=I.preOrderCheckHooks;null!==_d&&I2(b,_d,F)}else{const _d=I.preOrderHooks;null!==_d&&eN(b,_d,0,F)}aL(F)}function Z9(I,b){return I<<17|b<<2}function IM(I){return I>>17&32767}function $X(I){return 2|I}function Y3(I){return(131068&I)>>2}function X9(I,b){return-131069&I|b<<2}function QV(I){return 1|I}function ree(I,b){const F=I.contentQueries;if(null!==F)for(let _n=0;_n<F.length;_n+=2){const ca=F[_n],_d=F[_n+1];if(-1!==_d){const _p=I.data[_d];lV(ca),_p.contentQueries(2,b[_d],_d)}}}function a7(I,b,F,_n,ca,_d,_p,t_,s_,A_){const C_=b.blueprint.slice();return C_[0]=ca,C_[2]=140|_n,DO(C_),C_[3]=C_[15]=I,C_[8]=F,C_[10]=_p||I&&I[10],C_[11]=t_||I&&I[11],C_[12]=s_||I&&I[12]||null,C_[9]=A_||I&&I[9]||null,C_[6]=_d,C_[16]=2==b.type?I[16]:C_,C_}function qV(I,b,F,_n,ca){let _d=I.data[b];if(null===_d)_d=function c7(I,b,F,_n,ca){const _d=C3(),_p=$j(),s_=I.data[b]=function boe(I,b,F,_n,ca,_d){return{type:F,index:_n,insertBeforeIndex:null,injectorIndex:b?b.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:ca,attrs:_d,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:b,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,_p?_d:_d&&_d.parent,F,b,_n,ca);return null===I.firstChild&&(I.firstChild=s_),null!==_d&&(_p?null==_d.child&&null!==s_.parent&&(_d.child=s_):null===_d.next&&(_d.next=s_)),s_}(I,b,F,_n,ca),function t5(){return zI.lFrame.inI18n}()&&(_d.flags|=64);else if(64&_d.type){_d.type=F,_d.value=_n,_d.attrs=ca;const _p=function _D(){const I=zI.lFrame,b=I.currentTNode;return I.isParent?b:b.parent}();_d.injectorIndex=null===_p?-1:_p.injectorIndex}return NO(_d,!0),_d}function WV(I,b,F,_n){if(0===F)return-1;const ca=b.length;for(let _d=0;_d<F;_d++)b.push(_n),I.blueprint.push(_n),I.data.push(null);return ca}function N5(I,b,F){IP(b);try{const _n=I.viewQuery;null!==_n&&xS(1,_n,F);const ca=I.template;null!==ca&&NY(I,b,ca,1,F),I.firstCreatePass&&(I.firstCreatePass=!1),I.staticContentQueries&&ree(I,b),I.staticViewQueries&&xS(2,I.viewQuery,F);const _d=I.components;null!==_d&&function Eoe(I,b){for(let F=0;F<b.length;F++)Doe(I,b[F])}(b,_d)}catch(_n){throw I.firstCreatePass&&(I.incompleteFirstPass=!0,I.firstCreatePass=!1),_n}finally{b[2]&=-5,fO()}}function KV(I,b,F,_n){const ca=b[2];if(256!=(256&ca)){IP(b);try{DO(b),function E2(I){return zI.lFrame.bindingIndex=I}(I.bindingStartIndex),null!==F&&NY(I,b,F,2,_n);const _p=3==(3&ca);if(_p){const A_=I.preOrderCheckHooks;null!==A_&&I2(b,A_,null)}else{const A_=I.preOrderHooks;null!==A_&&eN(b,A_,0,null),RS(b,0)}if(function hee(I){for(let b=FO(I);null!==b;b=K3(b)){if(!b[2])continue;const F=b[9];for(let _n=0;_n<F.length;_n++){const ca=F[_n],_d=ca[3];0==(1024&ca[2])&&eM(_d,1),ca[2]|=1024}}}(b),function dee(I){for(let b=FO(I);null!==b;b=K3(b))for(let F=10;F<b.length;F++){const _n=b[F],ca=_n[1];y2(_n)&&KV(ca,_n,ca.template,_n[8])}}(b),null!==I.contentQueries&&ree(I,b),_p){const A_=I.contentCheckHooks;null!==A_&&I2(b,A_)}else{const A_=I.contentHooks;null!==A_&&eN(b,A_,1),RS(b,1)}!function voe(I,b){const F=I.hostBindingOpCodes;if(null!==F)try{for(let _n=0;_n<F.length;_n++){const ca=F[_n];if(ca<0)aL(~ca);else{const _d=ca,_p=F[++_n],t_=F[++_n];T3(_p,_d),t_(2,b[_d])}}}finally{aL(-1)}}(I,b);const t_=I.components;null!==t_&&function yoe(I,b){for(let F=0;F<b.length;F++)CU(I,b[F])}(b,t_);const s_=I.viewQuery;if(null!==s_&&xS(2,s_,_n),_p){const A_=I.viewCheckHooks;null!==A_&&I2(b,A_)}else{const A_=I.viewHooks;null!==A_&&eN(b,A_,2),RS(b,2)}!0===I.firstUpdatePass&&(I.firstUpdatePass=!1),b[2]&=-73,1024&b[2]&&(b[2]&=-1025,eM(b[3],-1))}finally{fO()}}}function zV(I,b,F,_n){const ca=b[10],_p=vP(b);try{!_p&&ca.begin&&ca.begin(),_p&&N5(I,b,_n),KV(I,b,F,_n)}finally{!_p&&ca.end&&ca.end()}}function NY(I,b,F,_n,ca){const _d=KS(),_p=2&_n;try{aL(-1),_p&&b.length>20&&TY(I,b,20,!1),F(_n,ca)}finally{aL(_d)}}function u7(I,b,F){if(A3(b)){const ca=b.directiveEnd;for(let _d=b.directiveStart;_d<ca;_d++){const _p=I.data[_d];_p.contentQueries&&_p.contentQueries(1,F[_d],_d)}}}function kY(I,b,F){!I3()||(function sH(I,b,F,_n){const ca=F.directiveStart,_d=F.directiveEnd;I.firstCreatePass||TP(F,b),kS(_n,b);const _p=F.initialInputs;for(let t_=ca;t_<_d;t_++){const s_=I.data[t_],A_=LN(s_);A_&&lR(b,F,s_);const C_=b2(b,I,t_,F);kS(C_,b),null!==_p&&bL(0,t_-ca,C_,s_,0,_p),A_&&(sR(F.index,b)[8]=C_)}}(I,b,F,WS(F,b)),128==(128&F.flags)&&function MY(I,b,F){const _n=F.directiveStart,ca=F.directiveEnd,_p=F.index,t_=function S3(){return zI.lFrame.currentDirectiveIndex}();try{aL(_p);for(let s_=_n;s_<ca;s_++){const A_=I.data[s_],C_=b[s_];oU(s_),(null!==A_.hostBindings||0!==A_.hostVars||null!==A_.hostAttrs)&&BY(A_,C_)}}finally{aL(-1),oU(t_)}}(I,b,F))}function PY(I,b,F=WS){const _n=b.localNames;if(null!==_n){let ca=b.index+1;for(let _d=0;_d<_n.length;_d+=2){const _p=_n[_d+1],t_=-1===_p?F(b,I):I[_p];I[ca++]=t_}}}function iee(I){const b=I.tView;return null===b||b.incompleteFirstPass?I.tView=rH(1,null,I.template,I.decls,I.vars,I.directiveDefs,I.pipeDefs,I.viewQuery,I.schemas,I.consts):b}function rH(I,b,F,_n,ca,_d,_p,t_,s_,A_){const C_=20+_n,Q_=C_+ca,Qv=function Ioe(I,b){const F=[];for(let _n=0;_n<b;_n++)F.push(_n<I?null:r1);return F}(C_,Q_),g0="function"==typeof A_?A_():A_;return Qv[1]={type:I,blueprint:Qv,template:F,queries:null,viewQuery:t_,declTNode:b,data:Qv.slice().fill(null,C_),bindingStartIndex:C_,expandoStartIndex:Q_,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof _d?_d():_d,pipeRegistry:"function"==typeof _p?_p():_p,firstChild:null,schemas:s_,consts:g0,incompleteFirstPass:!1}}function LY(I,b,F,_n){const ca=X3(b);null===F?ca.push(_n):(ca.push(F),I.firstCreatePass&&cH(I).push(_n,ca.length-1))}function Coe(I,b,F){for(let _n in I)if(I.hasOwnProperty(_n)){const ca=I[_n];(F=null===F?{}:F).hasOwnProperty(_n)?F[_n].push(b,ca):F[_n]=[b,ca]}return F}function j2(I,b,F,_n,ca,_d,_p,t_){const s_=WS(b,F);let C_,A_=b.inputs;!t_&&null!=A_&&(C_=A_[_n])?(wM(I,F,C_,_n,ca),X6(b)&&function iH(I,b){const F=sR(b,I);16&F[2]||(F[2]|=64)}(F,b.index)):3&b.type&&(_n=function l7(I){return"class"===I?"className":"for"===I?"htmlFor":"formaction"===I?"formAction":"innerHtml"===I?"innerHTML":"readonly"===I?"readOnly":"tabindex"===I?"tabIndex":I}(_n),ca=null!=_p?_p(ca,b.value||"",_n):ca,nT(_d)?_d.setProperty(s_,_n,ca):LT(_n)||(s_.setProperty?s_.setProperty(_n,ca):s_[_n]=ca))}function CM(I,b,F,_n){let ca=!1;if(I3()){const _d=function uee(I,b,F){const _n=I.directiveRegistry;let ca=null;if(_n)for(let _d=0;_d<_n.length;_d++){const _p=_n[_d];z9(F,_p.selectors,!1)&&(ca||(ca=[]),lL(TP(F,b),I,_p.type),LN(_p)?(KN(I,F),ca.unshift(_p)):ca.push(_p))}return ca}(I,b,F),_p=null===_n?null:{"":-1};if(null!==_d){ca=!0,lee(F,I.data.length,_d.length);for(let C_=0;C_<_d.length;C_++){const Q_=_d[C_];Q_.providersResolver&&Q_.providersResolver(Q_)}let t_=!1,s_=!1,A_=WV(I,b,_d.length,null);for(let C_=0;C_<_d.length;C_++){const Q_=_d[C_];F.mergedAttrs=aM(F.mergedAttrs,Q_.hostAttrs),H1(I,F,b,A_,Q_),Ooe(A_,Q_,_p),null!==Q_.contentQueries&&(F.flags|=8),(null!==Q_.hostBindings||null!==Q_.hostAttrs||0!==Q_.hostVars)&&(F.flags|=128);const Qv=Q_.type.prototype;!t_&&(Qv.ngOnChanges||Qv.ngOnInit||Qv.ngDoCheck)&&((I.preOrderHooks||(I.preOrderHooks=[])).push(F.index),t_=!0),!s_&&(Qv.ngOnChanges||Qv.ngDoCheck)&&((I.preOrderCheckHooks||(I.preOrderCheckHooks=[])).push(F.index),s_=!0),A_++}!function woe(I,b){const _n=b.directiveEnd,ca=I.data,_d=b.attrs,_p=[];let t_=null,s_=null;for(let A_=b.directiveStart;A_<_n;A_++){const C_=ca[A_],Q_=C_.inputs,Qv=null===_d||F2(b)?null:uN(Q_,_d);_p.push(Qv),t_=Coe(Q_,A_,t_),s_=Coe(C_.outputs,A_,s_)}null!==t_&&(t_.hasOwnProperty("class")&&(b.flags|=16),t_.hasOwnProperty("style")&&(b.flags|=32)),b.initialInputs=_p,b.inputs=t_,b.outputs=s_}(I,F)}_p&&function Roe(I,b,F){if(b){const _n=I.localNames=[];for(let ca=0;ca<b.length;ca+=2){const _d=F[b[ca+1]];if(null==_d)throw new S_(-301,!1);_n.push(b[ca],_d)}}}(F,_n,_p)}return F.mergedAttrs=aM(F.mergedAttrs,F.attrs),ca}function GP(I,b,F,_n,ca,_d){const _p=_d.hostBindings;if(_p){let t_=I.hostBindingOpCodes;null===t_&&(t_=I.hostBindingOpCodes=[]);const s_=~b.index;(function cee(I){let b=I.length;for(;b>0;){const F=I[--b];if("number"==typeof F&&F<0)return F}return 0})(t_)!=s_&&t_.push(s_),t_.push(_n,ca,_p)}}function BY(I,b){null!==I.hostBindings&&I.hostBindings(1,b)}function KN(I,b){b.flags|=2,(I.components||(I.components=[])).push(b.index)}function Ooe(I,b,F){if(F){if(b.exportAs)for(let _n=0;_n<b.exportAs.length;_n++)F[b.exportAs[_n]]=I;LN(b)&&(F[""]=I)}}function lee(I,b,F){I.flags|=1,I.directiveStart=b,I.directiveEnd=b+F,I.providerIndexes=b}function H1(I,b,F,_n,ca){I.data[_n]=ca;const _d=ca.factory||(ca.factory=_R(ca.type)),_p=new bP(_d,LN(ca),null);I.blueprint[_n]=_p,F[_n]=_p,GP(I,b,0,_n,WV(I,F,ca.hostVars,r1),ca)}function lR(I,b,F){const _n=WS(b,I),ca=iee(F),_d=I[10],_p=d7(I,a7(I,ca,null,F.onPush?64:16,_n,b,_d,_d.createRenderer(_n,F),null,null));I[b.index]=_p}function bU(I,b,F,_n,ca,_d){const _p=WS(I,b);!function k5(I,b,F,_n,ca,_d,_p){if(null==_d)nT(I)?I.removeAttribute(b,ca,F):b.removeAttribute(ca);else{const t_=null==_p?B_(_d):_p(_d,_n||"",ca);nT(I)?I.setAttribute(b,ca,t_,F):F?b.setAttributeNS(F,ca,t_):b.setAttribute(ca,t_)}}(b[11],_p,_d,I.value,F,_n,ca)}function bL(I,b,F,_n,ca,_d){const _p=_d[b];if(null!==_p){const t_=_n.setInput;for(let s_=0;s_<_p.length;){const A_=_p[s_++],C_=_p[s_++],Q_=_p[s_++];null!==t_?_n.setInput(F,Q_,A_,C_):F[C_]=Q_}}}function uN(I,b){let F=null,_n=0;for(;_n<b.length;){const ca=b[_n];if(0!==ca)if(5!==ca){if("number"==typeof ca)break;I.hasOwnProperty(ca)&&(null===F&&(F=[]),F.push(ca,I[ca],b[_n+1])),_n+=2}else _n+=2;else _n+=4}return F}function QP(I,b,F,_n){return new Array(I,!0,!1,b,null,0,_n,F,null,null)}function CU(I,b){const F=sR(b,I);if(y2(F)){const _n=F[1];80&F[2]?KV(_n,F,_n.template,F[8]):F[5]>0&&P5(F)}}function P5(I){for(let _n=FO(I);null!==_n;_n=K3(_n))for(let ca=10;ca<_n.length;ca++){const _d=_n[ca];if(1024&_d[2]){const _p=_d[1];KV(_p,_d,_p.template,_d[8])}else _d[5]>0&&P5(_d)}const F=I[1].components;if(null!==F)for(let _n=0;_n<F.length;_n++){const ca=sR(F[_n],I);y2(ca)&&ca[5]>0&&P5(ca)}}function Doe(I,b){const F=sR(b,I),_n=F[1];(function Noe(I,b){for(let F=b.length;F<I.blueprint.length;F++)b.push(I.blueprint[F])})(_n,F),N5(_n,F,F[8])}function d7(I,b){return I[13]?I[14][4]=b:I[13]=b,I[14]=b,b}function wU(I){for(;I;){I[2]|=64;const b=VI(I);if(mj(I)&&!b)return I;I=b}return null}function Z3(I){!function V2(I){for(let b=0;b<I.components.length;b++){const F=I.components[b],_n=E5(F),ca=_n[1];zV(ca,_n,ca.template,F)}}(I[8])}function xS(I,b,F){lV(0),b(I,F)}const ZR=(()=>Promise.resolve(null))();function X3(I){return I[7]||(I[7]=[])}function cH(I){return I.cleanup||(I.cleanup=[])}function _O(I,b){const F=I[9],_n=F?F.get(yL,null):null;_n&&_n.handleError(b)}function wM(I,b,F,_n,ca){for(let _d=0;_d<F.length;){const _p=F[_d++],t_=F[_d++],s_=b[_p],A_=I.data[_p];null!==A_.setInput?A_.setInput(s_,ca,_n,t_):s_[t_]=ca}}function HP(I,b,F){const _n=_P(b,I);!function OT(I,b,F){nT(I)?I.setValue(b,F):b.textContent=F}(I[11],_n,F)}function uH(I,b,F){let _n=F?I.styles:null,ca=F?I.classes:null,_d=0;if(null!==b)for(let _p=0;_p<b.length;_p++){const t_=b[_p];"number"==typeof t_?_d=t_:1==_d?ca=n_(ca,t_):2==_d&&(_n=n_(_n,t_+": "+b[++_p]+";"))}F?I.styles=_n:I.stylesWithoutHost=_n,F?I.classes=ca:I.classesWithoutHost=ca}const lH=new RT("INJECTOR",-1);class $V{get(b,F=BO){if(F===BO){const _n=new Error(`NullInjectorError: No provider for ${bh(b)}!`);throw _n.name="NullInjectorError",_n}return F}}const f7=new RT("Set Injector scope."),e4={},JS={};let dH;function FY(){return void 0===dH&&(dH=new $V),dH}function fee(I,b=null,F=null,_n){const ca=pee(I,b,F,_n);return ca._resolveInjectorDefTypes(),ca}function pee(I,b=null,F=null,_n){return new t4(I,F,b||FY(),_n)}class t4{constructor(b,F,_n,ca=null){this.parent=_n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const _d=[];F&&KR(F,t_=>this.processProvider(t_,b,F)),KR([b],t_=>this.processInjectorType(t_,[],_d)),this.records.set(lH,x5(void 0,this));const _p=this.records.get(f7);this.scope=null!=_p?_p.value:null,this.source=ca||("object"==typeof b?null:bh(b))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(b=>b.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(b,F=BO,_n=KI.Default){this.assertNotDestroyed();const ca=k0(this),_d=GT(void 0);try{if(!(_n&KI.SkipSelf)){let t_=this.records.get(b);if(void 0===t_){const s_=function mH(I){return"function"==typeof I||"object"==typeof I&&I instanceof RT}(b)&&w1(b);t_=s_&&this.injectableDefInScope(s_)?x5(hH(b),e4):null,this.records.set(b,t_)}if(null!=t_)return this.hydrate(b,t_)}return(_n&KI.Self?FY():this.parent).get(b,F=_n&KI.Optional&&F===BO?null:F)}catch(_p){if("NullInjectorError"===_p.name){if((_p[N2]=_p[N2]||[]).unshift(bh(b)),ca)throw _p;return function QN(I,b,F,_n){const ca=I[N2];throw b[K_]&&ca.unshift(b[K_]),I.message=function rN(I,b,F,_n=null){I=I&&"\n"===I.charAt(0)&&"\u0275"==I.charAt(1)?I.substr(2):I;let ca=bh(b);if(Array.isArray(b))ca=b.map(bh).join(" -> ");else if("object"==typeof b){let _d=[];for(let _p in b)if(b.hasOwnProperty(_p)){let t_=b[_p];_d.push(_p+":"+("string"==typeof t_?JSON.stringify(t_):bh(t_)))}ca=`{${_d.join(", ")}}`}return`${F}${_n?"("+_n+")":""}[${ca}]: ${I.replace(d_,"\n  ")}`}("\n"+I.message,ca,F,_n),I.ngTokenPath=ca,I[N2]=null,I}(_p,b,"R3InjectorError",this.source)}throw _p}finally{GT(_d),k0(ca)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(b=>this.get(b))}toString(){const b=[];return this.records.forEach((_n,ca)=>b.push(bh(ca))),`R3Injector[${b.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new S_(205,!1)}processInjectorType(b,F,_n){if(!(b=p_(b)))return!1;let ca=YT(b);const _d=null==ca&&b.ngModule||void 0,_p=void 0===_d?b:_d,t_=-1!==_n.indexOf(_p);if(void 0!==_d&&(ca=YT(_d)),null==ca)return!1;if(null!=ca.imports&&!t_){let C_;_n.push(_p);try{KR(ca.imports,Q_=>{this.processInjectorType(Q_,F,_n)&&(void 0===C_&&(C_=[]),C_.push(Q_))})}finally{}if(void 0!==C_)for(let Q_=0;Q_<C_.length;Q_++){const{ngModule:Qv,providers:g0}=C_[Q_];KR(g0,P0=>this.processProvider(P0,Qv,g0||$_))}}this.injectorDefTypes.add(_p);const s_=_R(_p)||(()=>new _p);this.records.set(_p,x5(s_,e4));const A_=ca.providers;if(null!=A_&&!t_){const C_=b;KR(A_,Q_=>this.processProvider(Q_,C_,A_))}return void 0!==_d&&void 0!==b.providers}processProvider(b,F,_n){let ca=lN(b=p_(b))?b:p_(b&&b.provide);const _d=function fH(I,b,F){return qP(I)?x5(void 0,I.useValue):x5(SU(I),e4)}(b);if(lN(b)||!0!==b.multi)this.records.get(ca);else{let _p=this.records.get(ca);_p||(_p=x5(void 0,e4,!0),_p.factory=()=>t1(_p.multi),this.records.set(ca,_p)),ca=b,_p.multi.push(b)}this.records.set(ca,_d)}hydrate(b,F){return F.value===e4&&(F.value=JS,F.value=F.factory()),"object"==typeof F.value&&F.value&&function gH(I){return null!==I&&"object"==typeof I&&"function"==typeof I.ngOnDestroy}(F.value)&&this.onDestroy.add(F.value),F.value}injectableDefInScope(b){if(!b.providedIn)return!1;const F=p_(b.providedIn);return"string"==typeof F?"any"===F||F===this.scope:this.injectorDefTypes.has(F)}}function hH(I){const b=w1(I),F=null!==b?b.factory:_R(I);if(null!==F)return F;if(I instanceof RT)throw new S_(204,!1);if(I instanceof Function)return function jY(I){const b=I.length;if(b>0)throw function T2(I,b){const F=[];for(let _n=0;_n<I;_n++)F.push(b);return F}(b,"?"),new S_(204,!1);const F=function _T(I){const b=I&&(I[$O]||I[jR]);if(b){const F=function NT(I){if(I.hasOwnProperty("name"))return I.name;const b=(""+I).match(/^function\s*([^\s(]+)/);return null===b?"":b[1]}(I);return console.warn(`DEPRECATED: DI is instantiating a token "${F}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${F}" class.`),b}return null}(I);return null!==F?()=>F.factory(I):()=>new I}(I);throw new S_(204,!1)}function SU(I,b,F){let _n;if(lN(I)){const ca=p_(I);return _R(ca)||hH(ca)}if(qP(I))_n=()=>p_(I.useValue);else if(function xoe(I){return!(!I||!I.useFactory)}(I))_n=()=>I.useFactory(...t1(I.deps||[]));else if(function Poe(I){return!(!I||!I.useExisting)}(I))_n=()=>SI(p_(I.useExisting));else{const ca=p_(I&&(I.useClass||I.provide));if(!function VY(I){return!!I.deps}(I))return _R(ca)||hH(ca);_n=()=>new ca(...t1(I.deps))}return _n}function x5(I,b,F=!1){return{factory:I,value:b,multi:F?[]:void 0}}function qP(I){return null!==I&&"object"==typeof I&&p0 in I}function lN(I){return"function"==typeof I}let G2=(()=>{class I{static create(F,_n){var ca;if(Array.isArray(F))return fee({name:""},_n,F,"");{const _d=null!==(ca=F.name)&&void 0!==ca?ca:"";return fee({name:_d},F.parent,F.providers,_d)}}}return I.THROW_IF_NOT_FOUND=BO,I.NULL=new $V,I.\u0275prov=Z1({token:I,providedIn:"any",factory:()=>SI(lH)}),I.__NG_ELEMENT_ID__=-1,I})();function IH(I,b){cU(E5(I)[1],ST())}function bH(I){let b=function bee(I){return Object.getPrototypeOf(I.prototype).constructor}(I.type),F=!0;const _n=[I];for(;b;){let ca;if(LN(I))ca=b.\u0275cmp||b.\u0275dir;else{if(b.\u0275cmp)throw new S_(903,"");ca=b.\u0275dir}if(ca){if(F){_n.push(ca);const _p=I;_p.inputs=H2(I.inputs),_p.declaredInputs=H2(I.declaredInputs),_p.outputs=H2(I.outputs);const t_=ca.hostBindings;t_&&Voe(I,t_);const s_=ca.viewQuery,A_=ca.contentQueries;if(s_&&KY(I,s_),A_&&joe(I,A_),_l(I.inputs,ca.inputs),_l(I.declaredInputs,ca.declaredInputs),_l(I.outputs,ca.outputs),LN(ca)&&ca.data.animation){const C_=I.data;C_.animation=(C_.animation||[]).concat(ca.data.animation)}}const _d=ca.features;if(_d)for(let _p=0;_p<_d.length;_p++){const t_=_d[_p];t_&&t_.ngInherit&&t_(I),t_===bH&&(F=!1)}}b=Object.getPrototypeOf(b)}!function XV(I){let b=0,F=null;for(let _n=I.length-1;_n>=0;_n--){const ca=I[_n];ca.hostVars=b+=ca.hostVars,ca.hostAttrs=aM(ca.hostAttrs,F=aM(F,ca.hostAttrs))}}(_n)}function H2(I){return I===$T?{}:I===$_?[]:I}function KY(I,b){const F=I.viewQuery;I.viewQuery=F?(_n,ca)=>{b(_n,ca),F(_n,ca)}:b}function joe(I,b){const F=I.contentQueries;I.contentQueries=F?(_n,ca,_d)=>{b(_n,ca,_d),F(_n,ca,_d)}:b}function Voe(I,b){const F=I.hostBindings;I.hostBindings=F?(_n,ca)=>{b(_n,ca),F(_n,ca)}:b}let wH=null;function t8(){if(!wH){const I=D1.Symbol;if(I&&I.iterator)wH=I.iterator;else{const b=Object.getOwnPropertyNames(Map.prototype);for(let F=0;F<b.length;++F){const _n=b[F];"entries"!==_n&&"size"!==_n&&Map.prototype[_n]===Map.prototype.entries&&(wH=_n)}}}return wH}function n4(I){return!!zY(I)&&(Array.isArray(I)||!(I instanceof Map)&&t8()in I)}function zY(I){return null!==I&&("function"==typeof I||"object"==typeof I)}function IR(I,b,F){return!Object.is(I[b],F)&&(I[b]=F,!0)}function YY(I,b,F,_n){const ca=j0();return IR(ca,EP(),b)&&(T1(),bU(cS(),ca,I,b,F,_n)),YY}function SH(I,b,F,_n,ca,_d,_p,t_){const s_=j0(),A_=T1(),C_=I+20,Q_=A_.firstCreatePass?function Tee(I,b,F,_n,ca,_d,_p,t_,s_){const A_=b.consts,C_=qV(b,I,4,_p||null,PT(A_,t_));CM(b,F,C_,PT(A_,s_)),cU(b,C_);const Q_=C_.tViews=rH(2,C_,_n,ca,_d,b.directiveRegistry,b.pipeRegistry,null,b.schemas,A_);return null!==b.queries&&(b.queries.template(b,C_),Q_.queries=b.queries.embeddedTView(C_)),C_}(C_,A_,s_,b,F,_n,ca,_d,_p):A_.data[C_];NO(Q_,!1);const Qv=s_[11].createComment("");U2(A_,s_,Qv,Q_),kS(Qv,s_),d7(s_,s_[C_]=QP(Qv,s_,Qv,Q_)),xN(Q_)&&kY(A_,s_,Q_),null!=_p&&PY(s_,Q_,t_)}function YN(I,b=KI.Default){const F=j0();return null===F?SI(I,b):lM(ST(),F,p_(I),b)}function G5(){throw new Error("invalid")}function m1(I,b,F){const _n=j0();return IR(_n,EP(),b)&&j2(T1(),cS(),_n,I,b,_n[11],F,!1),m1}function Q5(I,b,F,_n,ca){const _p=ca?"class":"style";wM(I,F,b.inputs[_p],_p,_n)}function A7(I,b,F,_n){const ca=j0(),_d=T1(),_p=20+I,t_=ca[11],s_=ca[_p]=qT(t_,b,function pV(){return zI.lFrame.currentNamespace}()),A_=_d.firstCreatePass?function H5(I,b,F,_n,ca,_d,_p){const t_=b.consts,A_=qV(b,I,2,ca,PT(t_,_d));return CM(b,F,A_,PT(t_,_p)),null!==A_.attrs&&uH(A_,A_.attrs,!1),null!==A_.mergedAttrs&&uH(A_,A_.mergedAttrs,!0),null!==b.queries&&b.queries.elementStart(b,A_),A_}(_p,_d,ca,0,b,F,_n):_d.data[_p];NO(A_,!0);const C_=A_.mergedAttrs;null!==C_&&xT(t_,s_,C_);const Q_=A_.classes;null!==Q_&&GV(t_,s_,Q_);const Qv=A_.styles;return null!==Qv&&zX(t_,s_,Qv),64!=(64&A_.flags)&&U2(_d,ca,s_,A_),0===function sL(){return zI.lFrame.elementDepthCount}()&&kS(s_,ca),function jj(){zI.lFrame.elementDepthCount++}(),xN(A_)&&(kY(_d,ca,A_),u7(_d,A_,ca)),null!==_n&&PY(ca,A_),A7}function bT(){let I=ST();$j()?UN():(I=I.parent,NO(I,!1));const b=I;!function iU(){zI.lFrame.elementDepthCount--}();const F=T1();return F.firstCreatePass&&(cU(F,I),A3(I)&&F.queries.elementEnd(I)),null!=b.classesWithoutHost&&function C9(I){return 0!=(16&I.flags)}(b)&&Q5(F,b,j0(),b.classesWithoutHost,!0),null!=b.stylesWithoutHost&&function uT(I){return 0!=(32&I.flags)}(b)&&Q5(F,b,j0(),b.stylesWithoutHost,!1),bT}function i8(I,b,F,_n){return A7(I,b,F,_n),bT(),i8}function TL(I,b,F){const _n=j0(),ca=T1(),_d=I+20,_p=ca.firstCreatePass?function PH(I,b,F,_n,ca){const _d=b.consts,_p=PT(_d,_n),t_=qV(b,I,8,"ng-container",_p);return null!==_p&&uH(t_,_p,!0),CM(b,F,t_,PT(_d,ca)),null!==b.queries&&b.queries.elementStart(b,t_),t_}(_d,ca,_n,b,F):ca.data[_d];NO(_p,!0);const t_=_n[_d]=_n[11].createComment("");return U2(ca,_n,t_,_p),kS(t_,_n),xN(_p)&&(kY(ca,_n,_p),u7(ca,_p,_n)),null!=F&&PY(_n,_p),TL}function o8(){let I=ST();const b=T1();return $j()?UN():(I=I.parent,NO(I,!1)),b.firstCreatePass&&(cU(b,I),A3(I)&&b.queries.elementEnd(I)),o8}function xH(){return j0()}function s8(I){return!!I&&"function"==typeof I.then}function cJ(I){return!!I&&"function"==typeof I.subscribe}const a8=cJ;function LH(I,b,F,_n){const ca=j0(),_d=T1(),_p=ST();return function c8(I,b,F,_n,ca,_d,_p,t_){const s_=xN(_n),C_=I.firstCreatePass&&cH(I),Q_=b[8],Qv=X3(b);let g0=!0;if(3&_n.type||t_){const uI=WS(_n,b),wI=t_?t_(uI):uI,V0=Qv.length,YI=t_?j1=>t_(K1(j1[_n.index])):_n.index;if(nT(F)){let j1=null;if(!t_&&s_&&(j1=function _7(I,b,F,_n){const ca=I.cleanup;if(null!=ca)for(let _d=0;_d<ca.length-1;_d+=2){const _p=ca[_d];if(_p===F&&ca[_d+1]===_n){const t_=b[7],s_=ca[_d+2];return t_.length>s_?t_[s_]:null}"string"==typeof _p&&(_d+=2)}return null}(I,b,ca,_n.index)),null!==j1)(j1.__ngLastListenerFn__||j1).__ngNextListenerFn__=_d,j1.__ngLastListenerFn__=_d,g0=!1;else{_d=v7(_n,b,Q_,_d,!1);const _w=F.listen(wI,ca,_d);Qv.push(_d,_w),C_&&C_.push(ca,YI,V0,V0+1)}}else _d=v7(_n,b,Q_,_d,!0),wI.addEventListener(ca,_d,_p),Qv.push(_d),C_&&C_.push(ca,YI,V0,_p)}else _d=v7(_n,b,Q_,_d,!1);const P0=_n.outputs;let Q0;if(g0&&null!==P0&&(Q0=P0[ca])){const uI=Q0.length;if(uI)for(let wI=0;wI<uI;wI+=2){const MS=b[Q0[wI]][Q0[wI+1]].subscribe(_d),NM=Qv.length;Qv.push(_d,MS),C_&&C_.push(ca,_n.index,NM,-(NM+1))}}}(_d,ca,ca[11],_p,I,b,!!F,_n),LH}function uJ(I,b,F,_n){try{return!1!==F(_n)}catch(ca){return _O(I,ca),!1}}function v7(I,b,F,_n,ca){return function _d(_p){if(_p===Function)return _n;const t_=2&I.flags?sR(I.index,b):b;0==(32&b[2])&&wU(t_);let s_=uJ(b,0,_n,_p),A_=_d.__ngNextListenerFn__;for(;A_;)s_=uJ(b,0,A_,_p)&&s_,A_=A_.__ngNextListenerFn__;return ca&&!1===s_&&(_p.preventDefault(),_p.returnValue=!1),s_}}function u4(I=1){return function wG(I){return(zI.lFrame.contextLView=function n5(I,b){for(;I>0;)b=b[15],I--;return b}(I,zI.lFrame.contextLView))[8]}(I)}function UH(I,b,F,_n,ca){const _d=I[F+1],_p=null===b;let t_=_n?IM(_d):Y3(_d),s_=!1;for(;0!==t_&&(!1===s_||_p);){const C_=I[t_+1];FH(I[t_],b)&&(s_=!0,I[t_+1]=_n?QV(C_):$X(C_)),t_=_n?IM(C_):Y3(C_)}s_&&(I[F+1]=_n?$X(_d):QV(_d))}function FH(I,b){return null===I||null==b||(Array.isArray(I)?I[1]:I)===b||!(!Array.isArray(I)||"string"!=typeof b)&&pL(I,b)>=0}const LS={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function l4(I){return I.substring(LS.key,LS.keyEnd)}function fJ(I,b){const F=LS.textEnd;return F===b?-1:(b=LS.keyEnd=function w7(I,b,F){for(;b<F&&I.charCodeAt(b)>32;)b++;return b}(I,LS.key=b,F),d4(I,b,F))}function d4(I,b,F){for(;b<F&&I.charCodeAt(b)<=32;)b++;return b}function pJ(I,b,F){return fN(I,b,F,!1),pJ}function gJ(I,b){return fN(I,b,null,!0),gJ}function Vee(I){!function WP(I,b,F,_n){const ca=T1(),_d=SS(2);ca.firstUpdatePass&&g4(ca,null,_d,_n);const _p=j0();if(F!==r1&&IR(_p,_d,F)){const t_=ca.data[KS()];if(_J(t_,_n)&&!T7(ca,_d)){let s_=_n?t_.classesWithoutHost:t_.stylesWithoutHost;null!==s_&&(F=n_(s_,F||"")),Q5(ca,t_,_p,F,_n)}else!function Y5(I,b,F,_n,ca,_d,_p,t_){ca===r1&&(ca=$_);let s_=0,A_=0,C_=0<ca.length?ca[0]:null,Q_=0<_d.length?_d[0]:null;for(;null!==C_||null!==Q_;){const Qv=s_<ca.length?ca[s_+1]:void 0,g0=A_<_d.length?_d[A_+1]:void 0;let Q0,P0=null;C_===Q_?(s_+=2,A_+=2,Qv!==g0&&(P0=Q_,Q0=g0)):null===Q_||null!==C_&&C_<Q_?(s_+=2,P0=C_):(A_+=2,P0=Q_,Q0=g0),null!==P0&&AJ(I,b,F,_n,P0,Q0,_p,t_),C_=s_<ca.length?ca[s_]:null,Q_=A_<_d.length?_d[A_]:null}}(ca,t_,_p,_p[11],_p[_d+1],_p[_d+1]=function Gee(I,b,F){if(null==F||""===F)return $_;const _n=[],ca=gO(F);if(Array.isArray(ca))for(let _d=0;_d<ca.length;_d++)I(_n,ca[_d],!0);else if("object"==typeof ca)for(const _d in ca)ca.hasOwnProperty(_d)&&I(_n,_d,ca[_d]);else"string"==typeof ca&&b(_n,ca);return _n}(I,b,F),_n,_d)}}(ER,W2,I,!0)}function W2(I,b){for(let F=function jee(I){return function VH(I){LS.key=0,LS.keyEnd=0,LS.value=0,LS.valueEnd=0,LS.textEnd=I.length}(I),fJ(I,d4(I,0,LS.textEnd))}(b);F>=0;F=fJ(b,F))ER(I,l4(b),!0)}function fN(I,b,F,_n){const ca=j0(),_d=T1(),_p=SS(2);_d.firstUpdatePass&&g4(_d,I,_p,_n),b!==r1&&IR(ca,_p,b)&&AJ(_d,_d.data[KS()],ca,ca[11],I,ca[_p+1]=function xU(I,b){return null==I||("string"==typeof b?I+=b:"object"==typeof I&&(I=bh(gO(I)))),I}(b,F),_n,_p)}function T7(I,b){return b>=I.expandoStartIndex}function g4(I,b,F,_n){const ca=I.data;if(null===ca[F+1]){const _d=ca[KS()],_p=T7(I,F);_J(_d,_n)&&null===b&&!_p&&(b=!1),b=function QH(I,b,F,_n){const ca=rM(I);let _d=_n?b.residualClasses:b.residualStyles;if(null===ca)0===(_n?b.classBindings:b.styleBindings)&&(F=z5(F=m4(null,I,b,F,_n),b.attrs,_n),_d=null);else{const _p=b.directiveStylingLast;if(-1===_p||I[_p]!==ca)if(F=m4(ca,I,b,F,_n),null===_d){let s_=function mJ(I,b,F){const _n=F?b.classBindings:b.styleBindings;if(0!==Y3(_n))return I[IM(_n)]}(I,b,_n);void 0!==s_&&Array.isArray(s_)&&(s_=m4(null,I,b,s_[1],_n),s_=z5(s_,b.attrs,_n),function BT(I,b,F,_n){I[IM(F?b.classBindings:b.styleBindings)]=_n}(I,b,_n,s_))}else _d=function K2(I,b,F){let _n;const ca=b.directiveEnd;for(let _d=1+b.directiveStylingLast;_d<ca;_d++)_n=z5(_n,I[_d].hostAttrs,F);return z5(_n,b.attrs,F)}(I,b,_n)}return void 0!==_d&&(_n?b.residualClasses=_d:b.residualStyles=_d),F}(ca,_d,b,_n),function q2(I,b,F,_n,ca,_d){let _p=_d?b.classBindings:b.styleBindings,t_=IM(_p),s_=Y3(_p);I[_n]=F;let C_,A_=!1;if(Array.isArray(F)){const Q_=F;C_=Q_[1],(null===C_||pL(Q_,C_)>0)&&(A_=!0)}else C_=F;if(ca)if(0!==s_){const Qv=IM(I[t_+1]);I[_n+1]=Z9(Qv,t_),0!==Qv&&(I[Qv+1]=X9(I[Qv+1],_n)),I[t_+1]=function Ede(I,b){return 131071&I|b<<17}(I[t_+1],_n)}else I[_n+1]=Z9(t_,0),0!==t_&&(I[t_+1]=X9(I[t_+1],_n)),t_=_n;else I[_n+1]=Z9(s_,0),0===t_?t_=_n:I[s_+1]=X9(I[s_+1],_n),s_=_n;A_&&(I[_n+1]=$X(I[_n+1])),UH(I,C_,_n,!0),UH(I,C_,_n,!1),function W5(I,b,F,_n,ca){const _d=ca?I.residualClasses:I.residualStyles;null!=_d&&"string"==typeof b&&pL(_d,b)>=0&&(F[_n+1]=QV(F[_n+1]))}(b,C_,I,_n,_d),_p=Z9(t_,s_),_d?b.classBindings=_p:b.styleBindings=_p}(ca,_d,b,F,_p,_n)}}function m4(I,b,F,_n,ca){let _d=null;const _p=F.directiveEnd;let t_=F.directiveStylingLast;for(-1===t_?t_=F.directiveStart:t_++;t_<_p&&(_d=b[t_],_n=z5(_n,_d.hostAttrs,ca),_d!==I);)t_++;return null!==I&&(F.directiveStylingLast=t_),_n}function z5(I,b,F){const _n=F?1:2;let ca=-1;if(null!==b)for(let _d=0;_d<b.length;_d++){const _p=b[_d];"number"==typeof _p?ca=_p:ca===_n&&(Array.isArray(I)||(I=void 0===I?[]:["",I]),ER(I,_p,!!F||b[++_d]))}return void 0===I?null:I}function AJ(I,b,F,_n,ca,_d,_p,t_){if(!(3&b.type))return;const s_=I.data,A_=s_[t_+1];l8(function loe(I){return 1==(1&I)}(A_)?PU(s_,b,F,ca,Y3(A_),_p):void 0)||(l8(_d)||function uoe(I){return 2==(2&I)}(A_)&&(_d=PU(s_,null,F,ca,t_,_p)),function K9(I,b,F,_n,ca){const _d=nT(I);if(b)ca?_d?I.addClass(F,_n):F.classList.add(_n):_d?I.removeClass(F,_n):F.classList.remove(_n);else{let _p=-1===_n.indexOf("-")?void 0:O_.DashCase;if(null==ca)_d?I.removeStyle(F,_n,_p):F.style.removeProperty(_n);else{const t_="string"==typeof ca&&ca.endsWith("!important");t_&&(ca=ca.slice(0,-10),_p|=O_.Important),_d?I.setStyle(F,_n,ca,_p):F.style.setProperty(_n,ca,t_?"important":"")}}}(_n,_p,_P(KS(),F),ca,_d))}function PU(I,b,F,_n,ca,_d){const _p=null===b;let t_;for(;ca>0;){const s_=I[ca],A_=Array.isArray(s_),C_=A_?s_[1]:s_,Q_=null===C_;let Qv=F[ca+1];Qv===r1&&(Qv=Q_?$_:void 0);let g0=Q_?pM(Qv,_n):C_===_n?Qv:void 0;if(A_&&!l8(g0)&&(g0=pM(s_,_n)),l8(g0)&&(t_=g0,_p))return t_;const P0=I[ca+1];ca=_p?IM(P0):Y3(P0)}if(null!==b){let s_=_d?b.residualClasses:b.residualStyles;null!=s_&&(t_=pM(s_,_n))}return t_}function l8(I){return void 0!==I}function _J(I,b){return 0!=(I.flags&(b?16:32))}function S7(I,b=""){const F=j0(),_n=T1(),ca=I+20,_d=_n.firstCreatePass?qV(_n,ca,1,b,null):_n.data[ca],_p=F[ca]=function T5(I,b){return nT(I)?I.createText(b):I.createTextNode(b)}(F[11],b);U2(_n,F,_p,_d),NO(_d,!1)}function vJ(I){return d8("",I,""),vJ}function d8(I,b,F){const _n=j0(),ca=function OU(I,b,F,_n){return IR(I,EP(),F)?b+B_(F)+_n:r1}(_n,I,b,F);return ca!==r1&&HP(_n,KS(),ca),d8}function p8(I,b,F){const _n=j0();if(IR(_n,EP(),b)){const _d=T1(),_p=cS();j2(_d,_p,_n,I,b,function CL(I,b,F){return(null===I||LN(I))&&(F=function oL(I){for(;Array.isArray(I);){if("object"==typeof I[1])return I;I=I[0]}return null}(F[b.index])),F[11]}(rM(_d.data),_p,_n),F,!0)}return p8}const A4=void 0;var rse=["en",[["a","p"],["AM","PM"],A4],[["AM","PM"],A4,A4],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],A4,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],A4,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",A4,"{1} 'at' {0}",A4],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function nse(I){const F=Math.floor(Math.abs(I)),_n=I.toString().replace(/^[^.]*\.?/,"").length;return 1===F&&0===_n?1:5}];let J5={};function SJ(I){const b=function P7(I){return I.toLowerCase().replace(/_/g,"-")}(I);let F=k7(b);if(F)return F;const _n=b.split("-")[0];if(F=k7(_n),F)return F;if("en"===_n)return rse;throw new Error(`Missing locale data for the locale "${I}".`)}function RJ(I){return SJ(I)[$I.PluralCase]}function k7(I){return I in J5||(J5[I]=D1.ng&&D1.ng.common&&D1.ng.common.locales&&D1.ng.common.locales[I]),J5[I]}var $I=(()=>(($I=$I||{})[$I.LocaleId=0]="LocaleId",$I[$I.DayPeriodsFormat=1]="DayPeriodsFormat",$I[$I.DayPeriodsStandalone=2]="DayPeriodsStandalone",$I[$I.DaysFormat=3]="DaysFormat",$I[$I.DaysStandalone=4]="DaysStandalone",$I[$I.MonthsFormat=5]="MonthsFormat",$I[$I.MonthsStandalone=6]="MonthsStandalone",$I[$I.Eras=7]="Eras",$I[$I.FirstDayOfWeek=8]="FirstDayOfWeek",$I[$I.WeekendRange=9]="WeekendRange",$I[$I.DateFormat=10]="DateFormat",$I[$I.TimeFormat=11]="TimeFormat",$I[$I.DateTimeFormat=12]="DateTimeFormat",$I[$I.NumberSymbols=13]="NumberSymbols",$I[$I.NumberFormats=14]="NumberFormats",$I[$I.CurrencyCode=15]="CurrencyCode",$I[$I.CurrencySymbol=16]="CurrencySymbol",$I[$I.CurrencyName=17]="CurrencyName",$I[$I.Currencies=18]="Currencies",$I[$I.Directionality=19]="Directionality",$I[$I.PluralCase=20]="PluralCase",$I[$I.ExtraData=21]="ExtraData",$I))();const YH="en-US";let ste=YH;function fW(I,b,F,_n,ca){if(I=p_(I),Array.isArray(I))for(let _d=0;_d<I.length;_d++)fW(I[_d],b,F,_n,ca);else{const _d=T1(),_p=j0();let t_=lN(I)?I:p_(I.provide),s_=SU(I);const A_=ST(),C_=1048575&A_.providerIndexes,Q_=A_.directiveStart,Qv=A_.providerIndexes>>20;if(lN(I)||!I.multi){const g0=new bP(s_,ca,YN),P0=jJ(t_,b,ca?C_:C_+Qv,Q_);-1===P0?(lL(TP(A_,_p),_d,t_),Q7(_d,I,b.length),b.push(t_),A_.directiveStart++,A_.directiveEnd++,ca&&(A_.providerIndexes+=1048576),F.push(g0),_p.push(g0)):(F[P0]=g0,_p[P0]=g0)}else{const g0=jJ(t_,b,C_+Qv,Q_),P0=jJ(t_,b,C_,C_+Qv),Q0=g0>=0&&F[g0],uI=P0>=0&&F[P0];if(ca&&!uI||!ca&&!Q0){lL(TP(A_,_p),_d,t_);const wI=function bte(I,b,F,_n,ca){const _d=new bP(I,F,YN);return _d.multi=[],_d.index=b,_d.componentProviders=0,pW(_d,ca,_n&&!F),_d}(ca?_8:Ite,F.length,ca,_n,s_);!ca&&uI&&(F[P0].providerFactory=wI),Q7(_d,I,b.length,0),b.push(t_),A_.directiveStart++,A_.directiveEnd++,ca&&(A_.providerIndexes+=1048576),F.push(wI),_p.push(wI)}else Q7(_d,I,g0>-1?g0:P0,pW(F[ca?P0:g0],s_,!ca&&_n));!ca&&_n&&uI&&F[P0].componentProviders++}}}function Q7(I,b,F,_n){const ca=lN(b),_d=function pH(I){return!!I.useClass}(b);if(ca||_d){const s_=(_d?p_(b.useClass):b).prototype.ngOnDestroy;if(s_){const A_=I.destroyHooks||(I.destroyHooks=[]);if(!ca&&b.multi){const C_=A_.indexOf(F);-1===C_?A_.push(F,[_n,s_]):A_[C_+1].push(_n,s_)}else A_.push(F,s_)}}}function pW(I,b,F){return F&&I.componentProviders++,I.multi.push(b)-1}function jJ(I,b,F,_n){for(let ca=F;ca<_n;ca++)if(b[ca]===I)return ca;return-1}function Ite(I,b,F,_n){return v8(this.multi,[])}function _8(I,b,F,_n){const ca=this.multi;let _d;if(this.providerFactory){const _p=this.providerFactory.componentProviders,t_=b2(F,F[1],this.providerFactory.index,_n);_d=t_.slice(0,_p),v8(ca,_d);for(let s_=_p;s_<t_.length;s_++)_d.push(t_[s_])}else _d=[],v8(ca,_d);return _d}function v8(I,b){for(let F=0;F<I.length;F++)b.push((0,I[F])());return b}function E4(I,b=[]){return F=>{F.providersResolver=(_n,ca)=>function fse(I,b,F){const _n=T1();if(_n.firstCreatePass){const ca=LN(I);fW(F,_n.data,_n.blueprint,ca,!0),fW(b,_n.data,_n.blueprint,ca,!1)}}(_n,ca?ca(I):I,b)}}class y8{}class Cte{resolveComponentFactory(b){throw function pse(I){const b=Error(`No component factory found for ${bh(I)}. Did you add it to @NgModule.entryComponents?`);return b.ngComponent=I,b}(b)}}let H7=(()=>{class I{}return I.NULL=new Cte,I})();function r6(){return I4(ST(),j0())}function I4(I,b){return new q7(WS(I,b))}let q7=(()=>{class I{constructor(F){this.nativeElement=F}}return I.__NG_ELEMENT_ID__=r6,I})();function wte(I){return I instanceof q7?I.nativeElement:I}class W7{}let Ste=(()=>{class I{}return I.__NG_ELEMENT_ID__=()=>function Y2(){const I=j0(),F=sR(ST().index,I);return function I8(I){return I[11]}(HR(F)?F:I)}(),I})(),gse=(()=>{class I{}return I.\u0275prov=Z1({token:I,providedIn:"root",factory:()=>null}),I})();class gW{constructor(b){this.full=b,this.major=b.split(".")[0],this.minor=b.split(".")[1],this.patch=b.split(".").slice(2).join(".")}}const K7=new gW("13.3.8"),mW={};function jU(I,b,F,_n,ca=!1){for(;null!==F;){const _d=b[F.index];if(null!==_d&&_n.push(K1(_d)),PN(_d))for(let t_=10;t_<_d.length;t_++){const s_=_d[t_],A_=s_[1].firstChild;null!==A_&&jU(s_[1],s_,A_,_n)}const _p=F.type;if(8&_p)jU(I,b,F.child,_n);else if(32&_p){const t_=N0(F,b);let s_;for(;s_=t_();)_n.push(s_)}else if(16&_p){const t_=qX(b,F);if(Array.isArray(t_))_n.push(...t_);else{const s_=VI(b[16]);jU(s_[1],s_,t_,_n,!0)}}F=ca?F.projectionNext:F.next}return _n}class i6{constructor(b,F){this._lView=b,this._cdRefInjectingView=F,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const b=this._lView,F=b[1];return jU(F,b,F.firstChild,[])}get context(){return this._lView[8]}set context(b){this._lView[8]=b}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const b=this._lView[3];if(PN(b)){const F=b[8],_n=F?F.indexOf(this):-1;_n>-1&&(n1(b,_n),fM(F,_n))}this._attachedToViewContainer=!1}GX(this._lView[1],this._lView)}onDestroy(b){LY(this._lView[1],this._lView,null,b)}markForCheck(){wU(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){!function aH(I,b,F){const _n=b[10];_n.begin&&_n.begin();try{KV(I,b,I.template,F)}catch(ca){throw _O(b,ca),ca}finally{_n.end&&_n.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new S_(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function z3(I,b){C0(I,b,b[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(b){if(this._attachedToViewContainer)throw new S_(902,"");this._appRef=b}}class GJ extends i6{constructor(b){super(b),this._view=b}detectChanges(){Z3(this._view)}checkNoChanges(){}get context(){return null}}class QJ extends H7{constructor(b){super(),this.ngModule=b}resolveComponentFactory(b){const F=bS(b);return new z7(F,this.ngModule)}}function AW(I){const b=[];for(let F in I)I.hasOwnProperty(F)&&b.push({propName:I[F],templateName:F});return b}class z7 extends y8{constructor(b,F){super(),this.componentDef=b,this.ngModule=F,this.componentType=b.type,this.selector=function wY(I){return I.map(t7).join(",")}(b.selectors),this.ngContentSelectors=b.ngContentSelectors?b.ngContentSelectors:[],this.isBoundToModule=!!F}get inputs(){return AW(this.componentDef.inputs)}get outputs(){return AW(this.componentDef.outputs)}create(b,F,_n,ca){const _d=(ca=ca||this.ngModule)?function HJ(I,b){return{get:(F,_n,ca)=>{const _d=I.get(F,mW,ca);return _d!==mW||_n===mW?_d:b.get(F,_n,ca)}}}(b,ca.injector):b,_p=_d.get(W7,tU),t_=_d.get(gse,null),s_=_p.createRenderer(null,this.componentDef),A_=this.componentDef.selectors[0][0]||"div",C_=_n?function see(I,b,F){if(nT(I))return I.selectRootElement(b,F===M1.ShadowDom);let _n="string"==typeof b?I.querySelector(b):b;return _n.textContent="",_n}(s_,_n,this.componentDef.encapsulation):qT(_p.createRenderer(null,this.componentDef),A_,function _W(I){const b=I.toLowerCase();return"svg"===b?"svg":"math"===b?"math":null}(A_)),Q_=this.componentDef.onPush?576:528,Qv=function Iee(I,b){return{components:[],scheduler:I||UV,clean:ZR,playerHandler:b||null,flags:0}}(),g0=rH(0,null,null,1,0,null,null,null,null,null),P0=a7(null,g0,Qv,Q_,null,null,_p,s_,t_,_d);let Q0,uI;IP(P0);try{const wI=function L5(I,b,F,_n,ca,_d){const _p=F[1];F[20]=I;const s_=qV(_p,20,2,"#host",null),A_=s_.mergedAttrs=b.hostAttrs;null!==A_&&(uH(s_,A_,!0),null!==I&&(xT(ca,I,A_),null!==s_.classes&&GV(ca,I,s_.classes),null!==s_.styles&&zX(ca,I,s_.styles)));const C_=_n.createRenderer(I,b),Q_=a7(F,iee(b),null,b.onPush?64:16,F[20],s_,_n,C_,_d||null,null);return _p.firstCreatePass&&(lL(TP(s_,F),_p,b.type),KN(_p,s_),lee(s_,F.length,1)),d7(F,Q_),F[20]=Q_}(C_,this.componentDef,P0,_p,s_);if(C_)if(_n)xT(s_,C_,["ng-version",K7.full]);else{const{attrs:V0,classes:YI}=function Y9(I){const b=[],F=[];let _n=1,ca=2;for(;_n<I.length;){let _d=I[_n];if("string"==typeof _d)2===ca?""!==_d&&b.push(_d,I[++_n]):8===ca&&F.push(_d);else{if(!qN(ca))break;ca=_d}_n++}return{attrs:b,classes:F}}(this.componentDef.selectors[0]);V0&&xT(s_,C_,V0),YI&&YI.length>0&&GV(s_,C_,YI.join(" "))}if(uI=kT(g0,20),void 0!==F){const V0=uI.projection=[];for(let YI=0;YI<this.ngContentSelectors.length;YI++){const j1=F[YI];V0.push(null!=j1?Array.from(j1):null)}}Q0=function Eee(I,b,F,_n,ca){const _d=F[1],_p=function Soe(I,b,F){const _n=ST();I.firstCreatePass&&(F.providersResolver&&F.providersResolver(F),H1(I,_n,b,WV(I,b,1,null),F));const ca=b2(b,I,_n.directiveStart,_n);kS(ca,b);const _d=WS(_n,b);return _d&&kS(_d,b),ca}(_d,F,b);if(_n.components.push(_p),I[8]=_p,ca&&ca.forEach(s_=>s_(_p,b)),b.contentQueries){const s_=ST();b.contentQueries(1,_p,s_.directiveStart)}const t_=ST();return!_d.firstCreatePass||null===b.hostBindings&&null===b.hostAttrs||(aL(t_.index),GP(F[1],t_,0,t_.directiveStart,t_.directiveEnd,b),BY(b,_p)),_p}(wI,this.componentDef,P0,Qv,[IH]),N5(g0,P0,null)}finally{fO()}return new qJ(this.componentType,Q0,I4(uI,P0),P0,uI)}}class qJ extends class VJ{}{constructor(b,F,_n,ca,_d){super(),this.location=_n,this._rootLView=ca,this._tNode=_d,this.instance=F,this.hostView=this.changeDetectorRef=new GJ(ca),this.componentType=b}get injector(){return new kP(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(b){this.hostView.onDestroy(b)}}class b4{}class VU{}const o6=new Map;class C4 extends b4{constructor(b,F){super(),this._parent=F,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new QJ(this);const _n=CS(b);this._bootstrapComponents=Nf(_n.bootstrap),this._r3Injector=pee(b,F,[{provide:b4,useValue:this},{provide:H7,useValue:this.componentFactoryResolver}],bh(b)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(b)}get(b,F=G2.THROW_IF_NOT_FOUND,_n=KI.Default){return b===G2||b===b4||b===lH?this:this._r3Injector.get(b,F,_n)}destroy(){const b=this._r3Injector;!b.destroyed&&b.destroy(),this.destroyCbs.forEach(F=>F()),this.destroyCbs=null}onDestroy(b){this.destroyCbs.push(b)}}class yW extends VU{constructor(b){super(),this.moduleType=b,null!==CS(b)&&function vW(I){const b=new Set;!function F(_n){const ca=CS(_n,!0),_d=ca.id;null!==_d&&(function gN(I,b,F){if(b&&b!==F)throw new Error(`Duplicate module registered for ${I} - ${bh(b)} vs ${bh(b.name)}`)}(_d,o6.get(_d),_n),o6.set(_d,_n));const _p=Nf(ca.imports);for(const t_ of _p)b.has(t_)||(b.add(t_),F(t_))}(I)}(b)}create(b){return new C4(this.moduleType,b)}}function vse(I,b,F,_n,ca){return function c6(I,b,F,_n,ca,_d,_p){const t_=b+F;return function RU(I,b,F,_n){const ca=IR(I,b,F);return IR(I,b+1,_n)||ca}(I,t_,ca,_d)?function wL(I,b,F){return I[b]=F}(I,t_+2,_p?_n.call(_p,ca,_d):_n(ca,_d)):function GU(I,b){const F=I[b];return F===r1?void 0:F}(I,t_+2)}(j0(),function vR(){const I=zI.lFrame;let b=I.bindingRootIndex;return-1===b&&(b=I.bindingRootIndex=I.tView.bindingStartIndex),b}(),I,b,F,_n,ca)}function JJ(I){return b=>{setTimeout(I,void 0,b)}}const NL=class Lte extends f.x{constructor(b=!1){super(),this.__isAsync=b}emit(b){super.next(b)}subscribe(b,F,_n){var ca,_d,_p;let t_=b,s_=F||(()=>null),A_=_n;if(b&&"object"==typeof b){const Q_=b;t_=null===(ca=Q_.next)||void 0===ca?void 0:ca.bind(Q_),s_=null===(_d=Q_.error)||void 0===_d?void 0:_d.bind(Q_),A_=null===(_p=Q_.complete)||void 0===_p?void 0:_p.bind(Q_)}this.__isAsync&&(s_=JJ(s_),t_&&(t_=JJ(t_)),A_&&(A_=JJ(A_)));const C_=super.subscribe({next:t_,error:s_,complete:A_});return b instanceof k.w0&&b.add(C_),C_}};function Ese(){return this._results[t8()]()}class $J{constructor(b=!1){this._emitDistinctChangesOnly=b,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const F=t8(),_n=$J.prototype;_n[F]||(_n[F]=Ese)}get changes(){return this._changes||(this._changes=new NL)}get(b){return this._results[b]}map(b){return this._results.map(b)}filter(b){return this._results.filter(b)}find(b){return this._results.find(b)}reduce(b,F){return this._results.reduce(b,F)}forEach(b){this._results.forEach(b)}some(b){return this._results.some(b)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(b,F){const _n=this;_n.dirty=!1;const ca=yR(b);(this._changesDetected=!function SG(I,b,F){if(I.length!==b.length)return!1;for(let _n=0;_n<I.length;_n++){let ca=I[_n],_d=b[_n];if(F&&(ca=F(ca),_d=F(_d)),_d!==ca)return!1}return!0}(_n._results,ca,F))&&(_n._results=ca,_n.length=ca.length,_n.last=ca[this.length-1],_n.first=ca[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let u6=(()=>{class I{}return I.__NG_ELEMENT_ID__=Ise,I})();const Mte=u6,Bte=class extends Mte{constructor(b,F,_n){super(),this._declarationLView=b,this._declarationTContainer=F,this.elementRef=_n}createEmbeddedView(b){const F=this._declarationTContainer.tViews,_n=a7(this._declarationLView,F,b,16,null,F.declTNode,null,null,null,null);_n[17]=this._declarationLView[this._declarationTContainer.index];const _d=this._declarationLView[19];return null!==_d&&(_n[19]=_d.createEmbeddedView(F)),N5(F,_n,b),new i6(_n)}};function Ise(){return Z7(ST(),j0())}function Z7(I,b){return 4&I.type?new Bte(b,I,I4(I,b)):null}let TW=(()=>{class I{}return I.__NG_ELEMENT_ID__=bse,I})();function bse(){return Vte(ST(),j0())}const Ute=TW,Fte=class extends Ute{constructor(b,F,_n){super(),this._lContainer=b,this._hostTNode=F,this._hostLView=_n}get element(){return I4(this._hostTNode,this._hostLView)}get injector(){return new kP(this._hostTNode,this._hostLView)}get parentInjector(){const b=uS(this._hostTNode,this._hostLView);if(cM(b)){const F=wP(b,this._hostLView),_n=CP(b);return new kP(F[1].data[_n+8],F)}return new kP(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(b){const F=jte(this._lContainer);return null!==F&&F[b]||null}get length(){return this._lContainer.length-10}createEmbeddedView(b,F,_n){const ca=b.createEmbeddedView(F||{});return this.insert(ca,_n),ca}createComponent(b,F,_n,ca,_d){const _p=b&&!function x3(I){return"function"==typeof I}(b);let t_;if(_p)t_=F;else{const Q_=F||{};t_=Q_.index,_n=Q_.injector,ca=Q_.projectableNodes,_d=Q_.ngModuleRef}const s_=_p?b:new z7(bS(b)),A_=_n||this.parentInjector;if(!_d&&null==s_.ngModule){const Qv=(_p?A_:this.parentInjector).get(b4,null);Qv&&(_d=Qv)}const C_=s_.create(A_,ca,void 0,_d);return this.insert(C_.hostView,t_),C_}insert(b,F){const _n=b._lView,ca=_n[1];if(function BN(I){return PN(I[3])}(_n)){const C_=this.indexOf(b);if(-1!==C_)this.detach(C_);else{const Q_=_n[3],Qv=new Fte(Q_,Q_[6],Q_[3]);Qv.detach(Qv.indexOf(b))}}const _d=this._adjustIndex(F),_p=this._lContainer;!function rT(I,b,F,_n){const ca=10+_n,_d=F.length;_n>0&&(F[ca-1][4]=b),_n<_d-10?(b[4]=F[ca],hM(F,10+_n,b)):(F.push(b),b[4]=null),b[3]=F;const _p=b[17];null!==_p&&F!==_p&&function M2(I,b){const F=I[9];b[16]!==b[3][3][16]&&(I[2]=!0),null===F?I[9]=[b]:F.push(b)}(_p,b);const t_=b[19];null!==t_&&t_.insertView(I),b[2]|=128}(ca,_n,_p,_d);const t_=W9(_d,_p),s_=_n[11],A_=AO(s_,_p[7]);return null!==A_&&function WG(I,b,F,_n,ca,_d){_n[0]=ca,_n[6]=b,C0(I,_n,F,1,ca,_d)}(ca,_p[6],s_,_n,A_,t_),b.attachToViewContainerRef(),hM(SW(_p),_d,b),b}move(b,F){return this.insert(b,F)}indexOf(b){const F=jte(this._lContainer);return null!==F?F.indexOf(b):-1}remove(b){const F=this._adjustIndex(b,-1),_n=n1(this._lContainer,F);_n&&(fM(SW(this._lContainer),F),GX(_n[1],_n))}detach(b){const F=this._adjustIndex(b,-1),_n=n1(this._lContainer,F);return _n&&null!=fM(SW(this._lContainer),F)?new i6(_n):null}_adjustIndex(b,F=0){return null==b?this.length+F:b}};function jte(I){return I[8]}function SW(I){return I[8]||(I[8]=[])}function Vte(I,b){let F;const _n=b[I.index];if(PN(_n))F=_n;else{let ca;if(8&I.type)ca=K1(_n);else{const _d=b[11];ca=_d.createComment("");const _p=WS(I,b);jP(_d,AO(_d,_p),ca,function H9(I,b){return nT(I)?I.nextSibling(b):b.nextSibling}(_d,_p),!1)}b[I.index]=F=QP(_n,b,ca,I),d7(b,F)}return new Fte(F,I,b)}class X7{constructor(b){this.queryList=b,this.matches=null}clone(){return new X7(this.queryList)}setDirty(){this.queryList.setDirty()}}class w4{constructor(b=[]){this.queries=b}createEmbeddedView(b){const F=b.queries;if(null!==F){const _n=null!==b.contentQueries?b.contentQueries[0]:F.length,ca=[];for(let _d=0;_d<_n;_d++){const _p=F.getByIndex(_d);ca.push(this.queries[_p.indexInDeclarationView].clone())}return new w4(ca)}return null}insertView(b){this.dirtyQueriesWithMatches(b)}detachView(b){this.dirtyQueriesWithMatches(b)}dirtyQueriesWithMatches(b){for(let F=0;F<this.queries.length;F++)null!==zte(b,F).matches&&this.queries[F].setDirty()}}class ZJ{constructor(b,F,_n=null){this.predicate=b,this.flags=F,this.read=_n}}class T4{constructor(b=[]){this.queries=b}elementStart(b,F){for(let _n=0;_n<this.queries.length;_n++)this.queries[_n].elementStart(b,F)}elementEnd(b){for(let F=0;F<this.queries.length;F++)this.queries[F].elementEnd(b)}embeddedTView(b){let F=null;for(let _n=0;_n<this.length;_n++){const ca=null!==F?F.length:0,_d=this.getByIndex(_n).embeddedTView(b,ca);_d&&(_d.indexInDeclarationView=_n,null!==F?F.push(_d):F=[_d])}return null!==F?new T4(F):null}template(b,F){for(let _n=0;_n<this.queries.length;_n++)this.queries[_n].template(b,F)}getByIndex(b){return this.queries[b]}get length(){return this.queries.length}track(b){this.queries.push(b)}}class S4{constructor(b,F=-1){this.metadata=b,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=F}elementStart(b,F){this.isApplyingToNode(F)&&this.matchTNode(b,F)}elementEnd(b){this._declarationNodeIndex===b.index&&(this._appliesToNextNode=!1)}template(b,F){this.elementStart(b,F)}embeddedTView(b,F){return this.isApplyingToNode(b)?(this.crossesNgTemplate=!0,this.addMatch(-b.index,F),new S4(this.metadata)):null}isApplyingToNode(b){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const F=this._declarationNodeIndex;let _n=b.parent;for(;null!==_n&&8&_n.type&&_n.index!==F;)_n=_n.parent;return F===(null!==_n?_n.index:-1)}return this._appliesToNextNode}matchTNode(b,F){const _n=this.metadata.predicate;if(Array.isArray(_n))for(let ca=0;ca<_n.length;ca++){const _d=_n[ca];this.matchTNodeWithReadOption(b,F,Qte(F,_d)),this.matchTNodeWithReadOption(b,F,lU(F,b,_d,!1,!1))}else _n===u6?4&F.type&&this.matchTNodeWithReadOption(b,F,-1):this.matchTNodeWithReadOption(b,F,lU(F,b,_n,!1,!1))}matchTNodeWithReadOption(b,F,_n){if(null!==_n){const ca=this.metadata.read;if(null!==ca)if(ca===q7||ca===TW||ca===u6&&4&F.type)this.addMatch(F.index,-2);else{const _d=lU(F,b,ca,!1,!1);null!==_d&&this.addMatch(F.index,_d)}else this.addMatch(F.index,_n)}}addMatch(b,F){null===this.matches?this.matches=[b,F]:this.matches.push(b,F)}}function Qte(I,b){const F=I.localNames;if(null!==F)for(let _n=0;_n<F.length;_n+=2)if(F[_n]===b)return F[_n+1];return null}function RW(I,b,F,_n){return-1===F?function XJ(I,b){return 11&I.type?I4(I,b):4&I.type?Z7(I,b):null}(b,I):-2===F?function Hte(I,b,F){return F===q7?I4(b,I):F===u6?Z7(b,I):F===TW?Vte(b,I):void 0}(I,b,_n):b2(I,I[1],F,b)}function qte(I,b,F,_n){const ca=b[19].queries[_n];if(null===ca.matches){const _d=I.data,_p=F.matches,t_=[];for(let s_=0;s_<_p.length;s_+=2){const A_=_p[s_];t_.push(A_<0?null:RW(b,_d[A_],_p[s_+1],F.metadata.read))}ca.matches=t_}return ca.matches}function e$(I,b,F,_n){const ca=I.queries.getByIndex(F),_d=ca.matches;if(null!==_d){const _p=qte(I,b,ca,F);for(let t_=0;t_<_d.length;t_+=2){const s_=_d[t_];if(s_>0)_n.push(_p[t_/2]);else{const A_=_d[t_+1],C_=b[-s_];for(let Q_=10;Q_<C_.length;Q_++){const Qv=C_[Q_];Qv[17]===Qv[3]&&e$(Qv[1],Qv,A_,_n)}if(null!==C_[9]){const Q_=C_[9];for(let Qv=0;Qv<Q_.length;Qv++){const g0=Q_[Qv];e$(g0[1],g0,A_,_n)}}}}}return _n}function Wte(I){const b=j0(),F=T1(),_n=R3();lV(_n+1);const ca=zte(F,_n);if(I.dirty&&vP(b)===(2==(2&ca.metadata.flags))){if(null===ca.matches)I.reset([]);else{const _d=ca.crossesNgTemplate?e$(F,b,_n,[]):qte(F,b,ca,_n);I.reset(_d,wte),I.notifyOnChanges()}return!0}return!1}function Kte(I,b,F,_n){const ca=T1();if(ca.firstCreatePass){const _d=ST();(function $N(I,b,F){null===I.queries&&(I.queries=new T4),I.queries.track(new S4(b,F))})(ca,new ZJ(b,F,_n),_d.index),function wse(I,b){const F=I.contentQueries||(I.contentQueries=[]);b!==(F.length?F[F.length-1]:-1)&&F.push(I.queries.length-1,b)}(ca,I),2==(2&F)&&(ca.staticContentQueries=!0)}!function r$(I,b,F){const _n=new $J(4==(4&F));LY(I,b,_n,_n.destroy),null===b[19]&&(b[19]=new w4),b[19].queries.push(new X7(_n))}(ca,j0(),F)}function t$(){return function n$(I,b){return I[19].queries[b].queryList}(j0(),R3())}function zte(I,b){return I.queries.getByIndex(b)}function oQ(...I){}const sQ=new RT("Application Initializer");let NW=(()=>{class I{constructor(F){this.appInits=F,this.resolve=oQ,this.reject=oQ,this.initialized=!1,this.done=!1,this.donePromise=new Promise((_n,ca)=>{this.resolve=_n,this.reject=ca})}runInitializers(){if(this.initialized)return;const F=[],_n=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let ca=0;ca<this.appInits.length;ca++){const _d=this.appInits[ca]();if(s8(_d))F.push(_d);else if(a8(_d)){const _p=new Promise((t_,s_)=>{_d.subscribe({complete:t_,error:s_})});F.push(_p)}}Promise.all(F).then(()=>{_n()}).catch(ca=>{this.reject(ca)}),0===F.length&&_n(),this.initialized=!0}}return I.\u0275fac=function(F){return new(F||I)(SI(sQ,8))},I.\u0275prov=Z1({token:I,factory:I.\u0275fac,providedIn:"root"}),I})();const tO=new RT("AppId",{providedIn:"root",factory:function w8(){return`${A$()}${A$()}${A$()}`}});function A$(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const l6=new RT("Platform Initializer"),zP=new RT("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),kW=new RT("appBootstrapListener");let _$=(()=>{class I{log(F){console.log(F)}warn(F){console.warn(F)}}return I.\u0275fac=function(F){return new(F||I)},I.\u0275prov=Z1({token:I,factory:I.\u0275fac,providedIn:"platform"}),I})();const v$=new RT("LocaleId",{providedIn:"root",factory:()=>Q1(v$,KI.Optional|KI.SkipSelf)||function Lse(){return"undefined"!=typeof $localize&&$localize.locale||YH}()}),Mse=new RT("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class PW{constructor(b,F){this.ngModuleFactory=b,this.componentFactories=F}}let nne=(()=>{class I{compileModuleSync(F){return new yW(F)}compileModuleAsync(F){return Promise.resolve(this.compileModuleSync(F))}compileModuleAndAllComponentsSync(F){const _n=this.compileModuleSync(F),_d=Nf(CS(F).declarations).reduce((_p,t_)=>{const s_=bS(t_);return s_&&_p.push(new z7(s_)),_p},[]);return new PW(_n,_d)}compileModuleAndAllComponentsAsync(F){return Promise.resolve(this.compileModuleAndAllComponentsSync(F))}clearCache(){}clearCacheFor(F){}getModuleId(F){}}return I.\u0275fac=function(F){return new(F||I)},I.\u0275prov=Z1({token:I,factory:I.\u0275fac,providedIn:"root"}),I})();const Use=(()=>Promise.resolve(0))();function xW(I){"undefined"==typeof Zone?Use.then(()=>{I&&I.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",I)}class $2{constructor({enableLongStackTrace:b=!1,shouldCoalesceEventChangeDetection:F=!1,shouldCoalesceRunChangeDetection:_n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new NL(!1),this.onMicrotaskEmpty=new NL(!1),this.onStable=new NL(!1),this.onError=new NL(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const ca=this;ca._nesting=0,ca._outer=ca._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(ca._inner=ca._inner.fork(new Zone.TaskTrackingZoneSpec)),b&&Zone.longStackTraceZoneSpec&&(ca._inner=ca._inner.fork(Zone.longStackTraceZoneSpec)),ca.shouldCoalesceEventChangeDetection=!_n&&F,ca.shouldCoalesceRunChangeDetection=_n,ca.lastRequestAnimationFrameId=-1,ca.nativeRequestAnimationFrame=function LW(){let I=D1.requestAnimationFrame,b=D1.cancelAnimationFrame;if("undefined"!=typeof Zone&&I&&b){const F=I[Zone.__symbol__("OriginalDelegate")];F&&(I=F);const _n=b[Zone.__symbol__("OriginalDelegate")];_n&&(b=_n)}return{nativeRequestAnimationFrame:I,nativeCancelAnimationFrame:b}}().nativeRequestAnimationFrame,function aQ(I){const b=()=>{!function MW(I){I.isCheckStableRunning||-1!==I.lastRequestAnimationFrameId||(I.lastRequestAnimationFrameId=I.nativeRequestAnimationFrame.call(D1,()=>{I.fakeTopEventTask||(I.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{I.lastRequestAnimationFrameId=-1,cQ(I),I.isCheckStableRunning=!0,T8(I),I.isCheckStableRunning=!1},void 0,()=>{},()=>{})),I.fakeTopEventTask.invoke()}),cQ(I))}(I)};I._inner=I._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(F,_n,ca,_d,_p,t_)=>{try{return BW(I),F.invokeTask(ca,_d,_p,t_)}finally{(I.shouldCoalesceEventChangeDetection&&"eventTask"===_d.type||I.shouldCoalesceRunChangeDetection)&&b(),y$(I)}},onInvoke:(F,_n,ca,_d,_p,t_,s_)=>{try{return BW(I),F.invoke(ca,_d,_p,t_,s_)}finally{I.shouldCoalesceRunChangeDetection&&b(),y$(I)}},onHasTask:(F,_n,ca,_d)=>{F.hasTask(ca,_d),_n===ca&&("microTask"==_d.change?(I._hasPendingMicrotasks=_d.microTask,cQ(I),T8(I)):"macroTask"==_d.change&&(I.hasPendingMacrotasks=_d.macroTask))},onHandleError:(F,_n,ca,_d)=>(F.handleError(ca,_d),I.runOutsideAngular(()=>I.onError.emit(_d)),!1)})}(ca)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!$2.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if($2.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(b,F,_n){return this._inner.run(b,F,_n)}runTask(b,F,_n,ca){const _d=this._inner,_p=_d.scheduleEventTask("NgZoneEvent: "+ca,b,ine,oQ,oQ);try{return _d.runTask(_p,F,_n)}finally{_d.cancelTask(_p)}}runGuarded(b,F,_n){return this._inner.runGuarded(b,F,_n)}runOutsideAngular(b){return this._outer.run(b)}}const ine={};function T8(I){if(0==I._nesting&&!I.hasPendingMicrotasks&&!I.isStable)try{I._nesting++,I.onMicrotaskEmpty.emit(null)}finally{if(I._nesting--,!I.hasPendingMicrotasks)try{I.runOutsideAngular(()=>I.onStable.emit(null))}finally{I.isStable=!0}}}function cQ(I){I.hasPendingMicrotasks=!!(I._hasPendingMicrotasks||(I.shouldCoalesceEventChangeDetection||I.shouldCoalesceRunChangeDetection)&&-1!==I.lastRequestAnimationFrameId)}function BW(I){I._nesting++,I.isStable&&(I.isStable=!1,I.onUnstable.emit(null))}function y$(I){I._nesting--,T8(I)}class UW{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new NL,this.onMicrotaskEmpty=new NL,this.onStable=new NL,this.onError=new NL}run(b,F,_n){return b.apply(F,_n)}runGuarded(b,F,_n){return b.apply(F,_n)}runOutsideAngular(b){return b()}runTask(b,F,_n,ca){return b.apply(F,_n)}}let uQ=(()=>{class I{constructor(F){this._ngZone=F,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),F.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{$2.assertNotInAngularZone(),xW(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())xW(()=>{for(;0!==this._callbacks.length;){let F=this._callbacks.pop();clearTimeout(F.timeoutId),F.doneCb(this._didWork)}this._didWork=!1});else{let F=this.getPendingTasks();this._callbacks=this._callbacks.filter(_n=>!_n.updateCb||!_n.updateCb(F)||(clearTimeout(_n.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(F=>({source:F.source,creationLocation:F.creationLocation,data:F.data})):[]}addCallback(F,_n,ca){let _d=-1;_n&&_n>0&&(_d=setTimeout(()=>{this._callbacks=this._callbacks.filter(_p=>_p.timeoutId!==_d),F(this._didWork,this.getPendingTasks())},_n)),this._callbacks.push({doneCb:F,timeoutId:_d,updateCb:ca})}whenStable(F,_n,ca){if(ca&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(F,_n,ca),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(F,_n,ca){return[]}}return I.\u0275fac=function(F){return new(F||I)(SI($2))},I.\u0275prov=Z1({token:I,factory:I.\u0275fac}),I})(),one=(()=>{class I{constructor(){this._applications=new Map,E$.addToWindow(this)}registerApplication(F,_n){this._applications.set(F,_n)}unregisterApplication(F){this._applications.delete(F)}unregisterAllApplications(){this._applications.clear()}getTestability(F){return this._applications.get(F)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(F,_n=!0){return E$.findTestabilityInTree(this,F,_n)}}return I.\u0275fac=function(F){return new(F||I)},I.\u0275prov=Z1({token:I,factory:I.\u0275fac,providedIn:"platform"}),I})();class kL{addToWindow(b){}findTestabilityInTree(b,F,_n){return null}}function FW(I){E$=I}let E$=new kL,h6=null;const sne=new RT("AllowMultipleToken"),XN=new RT("PlatformOnDestroy");class jW{constructor(b,F){this.name=b,this.token=F}}function b$(I,b,F=[]){const _n=`Platform: ${b}`,ca=new RT(_n);return(_d=[])=>{let _p=O8();if(!_p||_p.injector.get(sne,!1)){const t_=[...F,..._d,{provide:ca,useValue:!0}];I?I(t_):function R8(I){if(h6&&!h6.get(sne,!1))throw new S_(400,"");h6=I;const b=I.get(cne),F=I.get(l6,null);F&&F.forEach(_n=>_n())}(function ane(I=[],b){return G2.create({name:b,providers:[{provide:f7,useValue:"platform"},{provide:XN,useValue:()=>h6=null},...I]})}(t_,_n))}return function VW(I){const b=O8();if(!b)throw new S_(401,"");return b}()}}function O8(){var I;return null!==(I=null==h6?void 0:h6.get(cne))&&void 0!==I?I:null}let cne=(()=>{class I{constructor(F){this._injector=F,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(F,_n){const t_=function une(I,b){let F;return F="noop"===I?new UW:("zone.js"===I?void 0:I)||new $2({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==b?void 0:b.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==b?void 0:b.ngZoneRunCoalescing)}),F}(_n?_n.ngZone:void 0,{ngZoneEventCoalescing:_n&&_n.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:_n&&_n.ngZoneRunCoalescing||!1}),s_=[{provide:$2,useValue:t_}];return t_.run(()=>{const A_=G2.create({providers:s_,parent:this.injector,name:F.moduleType.name}),C_=F.create(A_),Q_=C_.injector.get(yL,null);if(!Q_)throw new S_(402,"");return t_.runOutsideAngular(()=>{const Qv=t_.onError.subscribe({next:g0=>{Q_.handleError(g0)}});C_.onDestroy(()=>{w$(this._modules,C_),Qv.unsubscribe()})}),function lne(I,b,F){try{const _n=F();return s8(_n)?_n.catch(ca=>{throw b.runOutsideAngular(()=>I.handleError(ca)),ca}):_n}catch(_n){throw b.runOutsideAngular(()=>I.handleError(_n)),_n}}(Q_,t_,()=>{const Qv=C_.injector.get(NW);return Qv.runInitializers(),Qv.donePromise.then(()=>(function ate(I){eI(I,"Expected localeId to be defined"),"string"==typeof I&&(ste=I.toLowerCase().replace(/_/g,"-"))}(C_.injector.get(v$,YH)||YH),this._moduleDoBootstrap(C_),C_))})})}bootstrapModule(F,_n=[]){const ca=C$({},_n);return function S8(I,b,F){const _n=new yW(F);return Promise.resolve(_n)}(0,0,F).then(_d=>this.bootstrapModuleFactory(_d,ca))}_moduleDoBootstrap(F){const _n=F.injector.get(GW);if(F._bootstrapComponents.length>0)F._bootstrapComponents.forEach(ca=>_n.bootstrap(ca));else{if(!F.instance.ngDoBootstrap)throw new S_(403,"");F.instance.ngDoBootstrap(_n)}this._modules.push(F)}onDestroy(F){this._destroyListeners.push(F)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new S_(404,"");this._modules.slice().forEach(_n=>_n.destroy()),this._destroyListeners.forEach(_n=>_n());const F=this._injector.get(XN,null);null==F||F(),this._destroyed=!0}get destroyed(){return this._destroyed}}return I.\u0275fac=function(F){return new(F||I)(SI(G2))},I.\u0275prov=Z1({token:I,factory:I.\u0275fac,providedIn:"platform"}),I})();function C$(I,b){return Array.isArray(b)?b.reduce(C$,I):Object.assign(Object.assign({},I),b)}let GW=(()=>{class I{constructor(F,_n,ca,_d){this._zone=F,this._injector=_n,this._exceptionHandler=ca,this._initStatus=_d,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const _p=new q.y(s_=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{s_.next(this._stable),s_.complete()})}),t_=new q.y(s_=>{let A_;this._zone.runOutsideAngular(()=>{A_=this._zone.onStable.subscribe(()=>{$2.assertNotInAngularZone(),xW(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,s_.next(!0))})})});const C_=this._zone.onUnstable.subscribe(()=>{$2.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{s_.next(!1)}))});return()=>{A_.unsubscribe(),C_.unsubscribe()}});this.isStable=(0,_r.T)(_p,t_.pipe((0,_s.B)()))}bootstrap(F,_n){if(!this._initStatus.done)throw new S_(405,"");let ca;ca=F instanceof y8?F:this._injector.get(H7).resolveComponentFactory(F),this.componentTypes.push(ca.componentType);const _d=function lQ(I){return I.isBoundToModule}(ca)?void 0:this._injector.get(b4),t_=ca.create(G2.NULL,[],_n||ca.selector,_d),s_=t_.location.nativeElement,A_=t_.injector.get(uQ,null),C_=A_&&t_.injector.get(one);return A_&&C_&&C_.registerApplication(s_,A_),t_.onDestroy(()=>{this.detachView(t_.hostView),w$(this.components,t_),C_&&C_.unregisterApplication(s_)}),this._loadComponent(t_),t_}tick(){if(this._runningTick)throw new S_(101,"");try{this._runningTick=!0;for(let F of this._views)F.detectChanges()}catch(F){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(F))}finally{this._runningTick=!1}}attachView(F){const _n=F;this._views.push(_n),_n.attachToAppRef(this)}detachView(F){const _n=F;w$(this._views,_n),_n.detachFromAppRef()}_loadComponent(F){this.attachView(F.hostView),this.tick(),this.components.push(F),this._injector.get(kW,[]).concat(this._bootstrapListeners).forEach(ca=>ca(F))}ngOnDestroy(){this._views.slice().forEach(F=>F.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return I.\u0275fac=function(F){return new(F||I)(SI($2),SI(G2),SI(yL),SI(NW))},I.\u0275prov=Z1({token:I,factory:I.\u0275fac,providedIn:"root"}),I})();function w$(I,b){const F=I.indexOf(b);F>-1&&I.splice(F,1)}let x4=!0,L4=!1;function dQ(){return L4=!0,x4}function jse(){if(L4)throw new Error("Cannot enable prod mode after platform setup.");x4=!1}let dne=(()=>{class I{}return I.__NG_ELEMENT_ID__=hne,I})();function hne(I){return function fne(I,b,F){if(X6(I)&&!F){const _n=sR(I.index,b);return new i6(_n,_n)}return 47&I.type?new i6(b[16],b):null}(ST(),j0(),16==(16&I))}class mne{constructor(){}supports(b){return n4(b)}create(b){return new zde(b)}}const Hse=(I,b)=>b;class zde{constructor(b){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=b||Hse}forEachItem(b){let F;for(F=this._itHead;null!==F;F=F._next)b(F)}forEachOperation(b){let F=this._itHead,_n=this._removalsHead,ca=0,_d=null;for(;F||_n;){const _p=!_n||F&&F.currentIndex<hQ(_n,ca,_d)?F:_n,t_=hQ(_p,ca,_d),s_=_p.currentIndex;if(_p===_n)ca--,_n=_n._nextRemoved;else if(F=F._next,null==_p.previousIndex)ca++;else{_d||(_d=[]);const A_=t_-ca,C_=s_-ca;if(A_!=C_){for(let Qv=0;Qv<A_;Qv++){const g0=Qv<_d.length?_d[Qv]:_d[Qv]=0,P0=g0+Qv;C_<=P0&&P0<A_&&(_d[Qv]=g0+1)}_d[_p.previousIndex]=C_-A_}}t_!==s_&&b(_p,t_,s_)}}forEachPreviousItem(b){let F;for(F=this._previousItHead;null!==F;F=F._nextPrevious)b(F)}forEachAddedItem(b){let F;for(F=this._additionsHead;null!==F;F=F._nextAdded)b(F)}forEachMovedItem(b){let F;for(F=this._movesHead;null!==F;F=F._nextMoved)b(F)}forEachRemovedItem(b){let F;for(F=this._removalsHead;null!==F;F=F._nextRemoved)b(F)}forEachIdentityChange(b){let F;for(F=this._identityChangesHead;null!==F;F=F._nextIdentityChange)b(F)}diff(b){if(null==b&&(b=[]),!n4(b))throw new S_(900,"");return this.check(b)?this:null}onDestroy(){}check(b){this._reset();let ca,_d,_p,F=this._itHead,_n=!1;if(Array.isArray(b)){this.length=b.length;for(let t_=0;t_<this.length;t_++)_d=b[t_],_p=this._trackByFn(t_,_d),null!==F&&Object.is(F.trackById,_p)?(_n&&(F=this._verifyReinsertion(F,_d,_p,t_)),Object.is(F.item,_d)||this._addIdentityChange(F,_d)):(F=this._mismatch(F,_d,_p,t_),_n=!0),F=F._next}else ca=0,function wee(I,b){if(Array.isArray(I))for(let F=0;F<I.length;F++)b(I[F]);else{const F=I[t8()]();let _n;for(;!(_n=F.next()).done;)b(_n.value)}}(b,t_=>{_p=this._trackByFn(ca,t_),null!==F&&Object.is(F.trackById,_p)?(_n&&(F=this._verifyReinsertion(F,t_,_p,ca)),Object.is(F.item,t_)||this._addIdentityChange(F,t_)):(F=this._mismatch(F,t_,_p,ca),_n=!0),F=F._next,ca++}),this.length=ca;return this._truncate(F),this.collection=b,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let b;for(b=this._previousItHead=this._itHead;null!==b;b=b._next)b._nextPrevious=b._next;for(b=this._additionsHead;null!==b;b=b._nextAdded)b.previousIndex=b.currentIndex;for(this._additionsHead=this._additionsTail=null,b=this._movesHead;null!==b;b=b._nextMoved)b.previousIndex=b.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(b,F,_n,ca){let _d;return null===b?_d=this._itTail:(_d=b._prev,this._remove(b)),null!==(b=null===this._unlinkedRecords?null:this._unlinkedRecords.get(_n,null))?(Object.is(b.item,F)||this._addIdentityChange(b,F),this._reinsertAfter(b,_d,ca)):null!==(b=null===this._linkedRecords?null:this._linkedRecords.get(_n,ca))?(Object.is(b.item,F)||this._addIdentityChange(b,F),this._moveAfter(b,_d,ca)):b=this._addAfter(new Yde(F,_n),_d,ca),b}_verifyReinsertion(b,F,_n,ca){let _d=null===this._unlinkedRecords?null:this._unlinkedRecords.get(_n,null);return null!==_d?b=this._reinsertAfter(_d,b._prev,ca):b.currentIndex!=ca&&(b.currentIndex=ca,this._addToMoves(b,ca)),b}_truncate(b){for(;null!==b;){const F=b._next;this._addToRemovals(this._unlink(b)),b=F}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(b,F,_n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(b);const ca=b._prevRemoved,_d=b._nextRemoved;return null===ca?this._removalsHead=_d:ca._nextRemoved=_d,null===_d?this._removalsTail=ca:_d._prevRemoved=ca,this._insertAfter(b,F,_n),this._addToMoves(b,_n),b}_moveAfter(b,F,_n){return this._unlink(b),this._insertAfter(b,F,_n),this._addToMoves(b,_n),b}_addAfter(b,F,_n){return this._insertAfter(b,F,_n),this._additionsTail=null===this._additionsTail?this._additionsHead=b:this._additionsTail._nextAdded=b,b}_insertAfter(b,F,_n){const ca=null===F?this._itHead:F._next;return b._next=ca,b._prev=F,null===ca?this._itTail=b:ca._prev=b,null===F?this._itHead=b:F._next=b,null===this._linkedRecords&&(this._linkedRecords=new qse),this._linkedRecords.put(b),b.currentIndex=_n,b}_remove(b){return this._addToRemovals(this._unlink(b))}_unlink(b){null!==this._linkedRecords&&this._linkedRecords.remove(b);const F=b._prev,_n=b._next;return null===F?this._itHead=_n:F._next=_n,null===_n?this._itTail=F:_n._prev=F,b}_addToMoves(b,F){return b.previousIndex===F||(this._movesTail=null===this._movesTail?this._movesHead=b:this._movesTail._nextMoved=b),b}_addToRemovals(b){return null===this._unlinkedRecords&&(this._unlinkedRecords=new qse),this._unlinkedRecords.put(b),b.currentIndex=null,b._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=b,b._prevRemoved=null):(b._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=b),b}_addIdentityChange(b,F){return b.item=F,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=b:this._identityChangesTail._nextIdentityChange=b,b}}class Yde{constructor(b,F){this.item=b,this.trackById=F,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Jde{constructor(){this._head=null,this._tail=null}add(b){null===this._head?(this._head=this._tail=b,b._nextDup=null,b._prevDup=null):(this._tail._nextDup=b,b._prevDup=this._tail,b._nextDup=null,this._tail=b)}get(b,F){let _n;for(_n=this._head;null!==_n;_n=_n._nextDup)if((null===F||F<=_n.currentIndex)&&Object.is(_n.trackById,b))return _n;return null}remove(b){const F=b._prevDup,_n=b._nextDup;return null===F?this._head=_n:F._nextDup=_n,null===_n?this._tail=F:_n._prevDup=F,null===this._head}}class qse{constructor(){this.map=new Map}put(b){const F=b.trackById;let _n=this.map.get(F);_n||(_n=new Jde,this.map.set(F,_n)),_n.add(b)}get(b,F){const ca=this.map.get(b);return ca?ca.get(b,F):null}remove(b){const F=b.trackById;return this.map.get(F).remove(b)&&this.map.delete(F),b}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function hQ(I,b,F){const _n=I.previousIndex;if(null===_n)return _n;let ca=0;return F&&_n<F.length&&(ca=F[_n]),_n+b+ca}class Ane{constructor(){}supports(b){return b instanceof Map||zY(b)}create(){return new P$}}class P${constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(b){let F;for(F=this._mapHead;null!==F;F=F._next)b(F)}forEachPreviousItem(b){let F;for(F=this._previousMapHead;null!==F;F=F._nextPrevious)b(F)}forEachChangedItem(b){let F;for(F=this._changesHead;null!==F;F=F._nextChanged)b(F)}forEachAddedItem(b){let F;for(F=this._additionsHead;null!==F;F=F._nextAdded)b(F)}forEachRemovedItem(b){let F;for(F=this._removalsHead;null!==F;F=F._nextRemoved)b(F)}diff(b){if(b){if(!(b instanceof Map||zY(b)))throw new S_(900,"")}else b=new Map;return this.check(b)?this:null}onDestroy(){}check(b){this._reset();let F=this._mapHead;if(this._appendAfter=null,this._forEach(b,(_n,ca)=>{if(F&&F.key===ca)this._maybeAddToChanges(F,_n),this._appendAfter=F,F=F._next;else{const _d=this._getOrCreateRecordForKey(ca,_n);F=this._insertBeforeOrAppend(F,_d)}}),F){F._prev&&(F._prev._next=null),this._removalsHead=F;for(let _n=F;null!==_n;_n=_n._nextRemoved)_n===this._mapHead&&(this._mapHead=null),this._records.delete(_n.key),_n._nextRemoved=_n._next,_n.previousValue=_n.currentValue,_n.currentValue=null,_n._prev=null,_n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(b,F){if(b){const _n=b._prev;return F._next=b,F._prev=_n,b._prev=F,_n&&(_n._next=F),b===this._mapHead&&(this._mapHead=F),this._appendAfter=b,b}return this._appendAfter?(this._appendAfter._next=F,F._prev=this._appendAfter):this._mapHead=F,this._appendAfter=F,null}_getOrCreateRecordForKey(b,F){if(this._records.has(b)){const ca=this._records.get(b);this._maybeAddToChanges(ca,F);const _d=ca._prev,_p=ca._next;return _d&&(_d._next=_p),_p&&(_p._prev=_d),ca._next=null,ca._prev=null,ca}const _n=new KW(b);return this._records.set(b,_n),_n.currentValue=F,this._addToAdditions(_n),_n}_reset(){if(this.isDirty){let b;for(this._previousMapHead=this._mapHead,b=this._previousMapHead;null!==b;b=b._next)b._nextPrevious=b._next;for(b=this._changesHead;null!==b;b=b._nextChanged)b.previousValue=b.currentValue;for(b=this._additionsHead;null!=b;b=b._nextAdded)b.previousValue=b.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(b,F){Object.is(F,b.currentValue)||(b.previousValue=b.currentValue,b.currentValue=F,this._addToChanges(b))}_addToAdditions(b){null===this._additionsHead?this._additionsHead=this._additionsTail=b:(this._additionsTail._nextAdded=b,this._additionsTail=b)}_addToChanges(b){null===this._changesHead?this._changesHead=this._changesTail=b:(this._changesTail._nextChanged=b,this._changesTail=b)}_forEach(b,F){b instanceof Map?b.forEach(F):Object.keys(b).forEach(_n=>F(b[_n],_n))}}class KW{constructor(b){this.key=b,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function fQ(){return new p6([new mne])}let p6=(()=>{class I{constructor(F){this.factories=F}static create(F,_n){if(null!=_n){const ca=_n.factories.slice();F=F.concat(ca)}return new I(F)}static extend(F){return{provide:I,useFactory:_n=>I.create(F,_n||fQ()),deps:[[I,new P2,new cR]]}}find(F){const _n=this.factories.find(ca=>ca.supports(F));if(null!=_n)return _n;throw new S_(901,"")}}return I.\u0275prov=Z1({token:I,providedIn:"root",factory:fQ}),I})();function D8(){return new N8([new Ane])}let N8=(()=>{class I{constructor(F){this.factories=F}static create(F,_n){if(_n){const ca=_n.factories.slice();F=F.concat(ca)}return new I(F)}static extend(F){return{provide:I,useFactory:_n=>I.create(F,_n||D8()),deps:[[I,new P2,new cR]]}}find(F){const _n=this.factories.find(_d=>_d.supports(F));if(_n)return _n;throw new S_(901,"")}}return I.\u0275prov=Z1({token:I,providedIn:"root",factory:D8}),I})();const _ne=b$(null,"core",[]);let vne=(()=>{class I{constructor(F){}}return I.\u0275fac=function(F){return new(F||I)(SI(GW))},I.\u0275mod=AR({type:I}),I.\u0275inj=L1({}),I})()},3942:(h,l,g)=>{"use strict";g.d(l,{Z:()=>S_});var f=g(2090),k=g(4859),q=g(9681),_r=g(1877);class _s{constructor(B_,V_){this._delegate=B_,this.firebase=V_,(0,q._addComponent)(B_,new k.wA("app-compat",()=>this,"PUBLIC")),this.container=B_.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(B_){this._delegate.automaticDataCollectionEnabled=B_}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(B_=>{this._delegate.checkDestroyed(),B_()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,q.deleteApp)(this._delegate)))}_getService(B_,V_=q._DEFAULT_ENTRY_NAME){var _0;this._delegate.checkDestroyed();const c0=this._delegate.container.getProvider(B_);return!c0.isInitialized()&&"EXPLICIT"===(null===(_0=c0.getComponent())||void 0===_0?void 0:_0.instantiationMode)&&c0.initialize(),c0.getImmediate({identifier:V_})}_removeServiceInstance(B_,V_=q._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(B_).clearInstance(V_)}_addComponent(B_){(0,q._addComponent)(this._delegate,B_)}_addOrOverwriteComponent(B_){(0,q._addOrOverwriteComponent)(this._delegate,B_)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const _l=new f.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),_A=function n_(){const x_=function bh(x_){const B_={},V_={__esModule:!0,initializeApp:function Pv(e0,P_={}){const _v=q.initializeApp(e0,P_);if((0,f.r3)(B_,_v.name))return B_[_v.name];const E_=new x_(_v,V_);return B_[_v.name]=E_,E_},app:c0,registerVersion:q.registerVersion,setLogLevel:q.setLogLevel,onLog:q.onLog,apps:null,SDK_VERSION:q.SDK_VERSION,INTERNAL:{registerComponent:function I0(e0){const P_=e0.name,_v=P_.replace("-compat","");if(q._registerComponent(e0)&&"PUBLIC"===e0.type){const E_=(L_=c0())=>{if("function"!=typeof L_[_v])throw _l.create("invalid-app-argument",{appName:P_});return L_[_v]()};void 0!==e0.serviceProps&&(0,f.ZB)(E_,e0.serviceProps),V_[_v]=E_,x_.prototype[_v]=function(...L_){return this._getService.bind(this,P_).apply(this,e0.multipleInstances?L_:[])}}return"PUBLIC"===e0.type?V_[_v]:null},removeApp:function _0(e0){delete B_[e0]},useAsService:function G_(e0,P_){return"serverAuth"===P_?null:P_},modularAPIs:q}};function c0(e0){if(!(0,f.r3)(B_,e0=e0||q._DEFAULT_ENTRY_NAME))throw _l.create("no-app",{appName:e0});return B_[e0]}return V_.default=V_,Object.defineProperty(V_,"apps",{get:function h0(){return Object.keys(B_).map(e0=>B_[e0])}}),c0.App=x_,V_}(_s);return x_.INTERNAL=Object.assign(Object.assign({},x_.INTERNAL),{createFirebaseNamespace:n_,extendNamespace:function B_(V_){(0,f.ZB)(x_,V_)},createSubscribe:f.ne,ErrorFactory:f.LL,deepExtend:f.ZB}),x_}(),r_=new _r.Yd("@firebase/app-compat");if((0,f.jU)()&&void 0!==self.firebase){r_.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const x_=self.firebase.SDK_VERSION;x_&&x_.indexOf("LITE")>=0&&r_.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const S_=_A;!function v_(x_){(0,q.registerVersion)("@firebase/app-compat","0.1.25",x_)}()},9681:(h,l,g)=>{"use strict";g.r(l),g.d(l,{FirebaseError:()=>_r.ZR,SDK_VERSION:()=>$O,_DEFAULT_ENTRY_NAME:()=>eI,_addComponent:()=>UI,_addOrOverwriteComponent:()=>Z1,_apps:()=>x1,_clearComponents:()=>SN,_components:()=>_1,_getProvider:()=>L1,_registerComponent:()=>sT,_removeServiceInstance:()=>w1,deleteApp:()=>KI,getApp:()=>jR,getApps:()=>ZO,initializeApp:()=>RN,onLog:()=>GT,registerVersion:()=>TT,setLogLevel:()=>dP});var f=g(5861),k=g(4859),q=g(1877),_r=g(2090),_s=g(8766);class ga{constructor(m0){this.container=m0}getPlatformInfoString(){return this.container.getProviders().map(G0=>{if(function _l(_y){const m0=_y.getComponent();return"VERSION"===(null==m0?void 0:m0.type)}(G0)){const yI=G0.getImmediate();return`${yI.library}/${yI.version}`}return null}).filter(G0=>G0).join(" ")}}const bh="@firebase/app",_A=new q.Yd("@firebase/app"),eI="[DEFAULT]",Y0={[bh]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},x1=new Map,_1=new Map;function UI(_y,m0){try{_y.container.addComponent(m0)}catch(G0){_A.debug(`Component ${m0.name} failed to register with FirebaseApp ${_y.name}`,G0)}}function Z1(_y,m0){_y.container.addOrOverwriteComponent(m0)}function sT(_y){const m0=_y.name;if(_1.has(m0))return _A.debug(`There were multiple attempts to register component ${m0}.`),!1;_1.set(m0,_y);for(const G0 of x1.values())UI(G0,_y);return!0}function L1(_y,m0){const G0=_y.container.getProvider("heartbeat").getImmediate({optional:!0});return G0&&G0.triggerHeartbeat(),_y.container.getProvider(m0)}function w1(_y,m0,G0=eI){L1(_y,m0).clearInstance(G0)}function SN(){_1.clear()}const NT=new _r.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."});class YT{constructor(m0,G0,yI){this._isDeleted=!1,this._options=Object.assign({},m0),this._config=Object.assign({},G0),this._name=G0.name,this._automaticDataCollectionEnabled=G0.automaticDataCollectionEnabled,this._container=yI,this.container.addComponent(new k.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(m0){this.checkDestroyed(),this._automaticDataCollectionEnabled=m0}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(m0){this._isDeleted=m0}checkDestroyed(){if(this.isDeleted)throw NT.create("app-deleted",{appName:this._name})}}const $O="9.8.1";function RN(_y,m0={}){"object"!=typeof m0&&(m0={name:m0});const G0=Object.assign({name:eI,automaticDataCollectionEnabled:!1},m0),yI=G0.name;if("string"!=typeof yI||!yI)throw NT.create("bad-app-name",{appName:String(yI)});const qI=x1.get(yI);if(qI){if((0,_r.vZ)(_y,qI.options)&&(0,_r.vZ)(G0,qI.config))return qI;throw NT.create("duplicate-app",{appName:yI})}const XI=new k.H0(yI);for(const _b of _1.values())XI.addComponent(_b);const vT=new YT(_y,G0,XI);return x1.set(yI,vT),vT}function jR(_y=eI){const m0=x1.get(_y);if(!m0)throw NT.create("no-app",{appName:_y});return m0}function ZO(){return Array.from(x1.values())}function KI(_y){return dO.apply(this,arguments)}function dO(){return(dO=(0,f.Z)(function*(_y){const m0=_y.name;x1.has(m0)&&(x1.delete(m0),yield Promise.all(_y.container.getProviders().map(G0=>G0.delete())),_y.isDeleted=!0)})).apply(this,arguments)}function TT(_y,m0,G0){var yI;let qI=null!==(yI=Y0[_y])&&void 0!==yI?yI:_y;G0&&(qI+=`-${G0}`);const XI=qI.match(/\s|\//),vT=m0.match(/\s|\//);if(XI||vT){const _b=[`Unable to register library "${qI}" with version "${m0}":`];return XI&&_b.push(`library name "${qI}" contains illegal characters (whitespace or "/")`),XI&&vT&&_b.push("and"),vT&&_b.push(`version name "${m0}" contains illegal characters (whitespace or "/")`),void _A.warn(_b.join(" "))}sT(new k.wA(`${qI}-version`,()=>({library:qI,version:m0}),"VERSION"))}function GT(_y,m0){if(null!==_y&&"function"!=typeof _y)throw NT.create("invalid-log-argument");(0,q.Am)(_y,m0)}function dP(_y){(0,q.Ub)(_y)}const JT="firebase-heartbeat-store";let SO=null;function _x(){return SO||(SO=(0,_s.X3)("firebase-heartbeat-database",1,{upgrade:(_y,m0)=>{0===m0&&_y.createObjectStore(JT)}}).catch(_y=>{throw NT.create("storage-open",{originalErrorMessage:_y.message})})),SO}function kI(){return(kI=(0,f.Z)(function*(_y){try{return(yield _x()).transaction(JT).objectStore(JT).get(rR(_y))}catch(m0){throw NT.create("storage-get",{originalErrorMessage:m0.message})}})).apply(this,arguments)}function JI(_y,m0){return gR.apply(this,arguments)}function gR(){return(gR=(0,f.Z)(function*(_y,m0){try{const yI=(yield _x()).transaction(JT,"readwrite");return yield yI.objectStore(JT).put(m0,rR(_y)),yI.done}catch(G0){throw NT.create("storage-set",{originalErrorMessage:G0.message})}})).apply(this,arguments)}function rR(_y){return`${_y.name}!${_y.options.appId}`}class mR{constructor(m0){this.container=m0,this._heartbeatsCache=null;const G0=this.container.getProvider("app").getImmediate();this._storage=new _E(G0),this._heartbeatsCachePromise=this._storage.read().then(yI=>(this._heartbeatsCache=yI,yI))}triggerHeartbeat(){var m0=this;return(0,f.Z)(function*(){const yI=m0.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),qI=$T();if(null===m0._heartbeatsCache&&(m0._heartbeatsCache=yield m0._heartbeatsCachePromise),m0._heartbeatsCache.lastSentHeartbeatDate!==qI&&!m0._heartbeatsCache.heartbeats.some(XI=>XI.date===qI))return m0._heartbeatsCache.heartbeats.push({date:qI,agent:yI}),m0._heartbeatsCache.heartbeats=m0._heartbeatsCache.heartbeats.filter(XI=>{const vT=new Date(XI.date).valueOf();return Date.now()-vT<=2592e6}),m0._storage.overwrite(m0._heartbeatsCache)})()}getHeartbeatsHeader(){var m0=this;return(0,f.Z)(function*(){if(null===m0._heartbeatsCache&&(yield m0._heartbeatsCachePromise),null===m0._heartbeatsCache||0===m0._heartbeatsCache.heartbeats.length)return"";const G0=$T(),{heartbeatsToSend:yI,unsentEntries:qI}=function $_(_y,m0=1024){const G0=[];let yI=_y.slice();for(const qI of _y){const XI=G0.find(vT=>vT.agent===qI.agent);if(XI){if(XI.dates.push(qI.date),r0(G0)>m0){XI.dates.pop();break}}else if(G0.push({agent:qI.agent,dates:[qI.date]}),r0(G0)>m0){G0.pop();break}yI=yI.slice(1)}return{heartbeatsToSend:G0,unsentEntries:yI}}(m0._heartbeatsCache.heartbeats),XI=(0,_r.L)(JSON.stringify({version:2,heartbeats:yI}));return m0._heartbeatsCache.lastSentHeartbeatDate=G0,qI.length>0?(m0._heartbeatsCache.heartbeats=qI,yield m0._storage.overwrite(m0._heartbeatsCache)):(m0._heartbeatsCache.heartbeats=[],m0._storage.overwrite(m0._heartbeatsCache)),XI})()}}function $T(){return(new Date).toISOString().substring(0,10)}class _E{constructor(m0){this.app=m0,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,f.Z)(function*(){return!!(0,_r.hl)()&&(0,_r.eu)().then(()=>!0).catch(()=>!1)})()}read(){var m0=this;return(0,f.Z)(function*(){return(yield m0._canUseIndexedDBPromise)&&(yield function M1(_y){return kI.apply(this,arguments)}(m0.app))||{heartbeats:[]}})()}overwrite(m0){var G0=this;return(0,f.Z)(function*(){var yI;if(yield G0._canUseIndexedDBPromise){const XI=yield G0.read();return JI(G0.app,{lastSentHeartbeatDate:null!==(yI=m0.lastSentHeartbeatDate)&&void 0!==yI?yI:XI.lastSentHeartbeatDate,heartbeats:m0.heartbeats})}})()}add(m0){var G0=this;return(0,f.Z)(function*(){var yI;if(yield G0._canUseIndexedDBPromise){const XI=yield G0.read();return JI(G0.app,{lastSentHeartbeatDate:null!==(yI=m0.lastSentHeartbeatDate)&&void 0!==yI?yI:XI.lastSentHeartbeatDate,heartbeats:[...XI.heartbeats,...m0.heartbeats]})}})()}}function r0(_y){return(0,_r.L)(JSON.stringify({version:2,heartbeats:_y})).length}!function M0(_y){sT(new k.wA("platform-logger",m0=>new ga(m0),"PRIVATE")),sT(new k.wA("heartbeat",m0=>new mR(m0),"PRIVATE")),TT(bh,"0.7.24",_y),TT(bh,"0.7.24","esm2017"),TT("fire-js","")}("")},4859:(h,l,g)=>{"use strict";g.d(l,{H0:()=>bh,wA:()=>q,zt:()=>_s});var f=g(5861),k=g(2090);class q{constructor(_A,r_,p_){this.name=_A,this.instanceFactory=r_,this.type=p_,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(_A){return this.instantiationMode=_A,this}setMultipleInstances(_A){return this.multipleInstances=_A,this}setServiceProps(_A){return this.serviceProps=_A,this}setInstanceCreatedCallback(_A){return this.onInstanceCreated=_A,this}}const _r="[DEFAULT]";class _s{constructor(_A,r_){this.name=_A,this.container=r_,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(_A){const r_=this.normalizeInstanceIdentifier(_A);if(!this.instancesDeferred.has(r_)){const p_=new k.BH;if(this.instancesDeferred.set(r_,p_),this.isInitialized(r_)||this.shouldAutoInitialize())try{const I_=this.getOrInitializeService({instanceIdentifier:r_});I_&&p_.resolve(I_)}catch(I_){}}return this.instancesDeferred.get(r_).promise}getImmediate(_A){var r_;const p_=this.normalizeInstanceIdentifier(null==_A?void 0:_A.identifier),I_=null!==(r_=null==_A?void 0:_A.optional)&&void 0!==r_&&r_;if(!this.isInitialized(p_)&&!this.shouldAutoInitialize()){if(I_)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:p_})}catch(v_){if(I_)return null;throw v_}}getComponent(){return this.component}setComponent(_A){if(_A.name!==this.name)throw Error(`Mismatching Component ${_A.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=_A,this.shouldAutoInitialize()){if(function _l(n_){return"EAGER"===n_.instantiationMode}(_A))try{this.getOrInitializeService({instanceIdentifier:_r})}catch(r_){}for(const[r_,p_]of this.instancesDeferred.entries()){const I_=this.normalizeInstanceIdentifier(r_);try{const v_=this.getOrInitializeService({instanceIdentifier:I_});p_.resolve(v_)}catch(v_){}}}}clearInstance(_A=_r){this.instancesDeferred.delete(_A),this.instancesOptions.delete(_A),this.instances.delete(_A)}delete(){var _A=this;return(0,f.Z)(function*(){const r_=Array.from(_A.instances.values());yield Promise.all([...r_.filter(p_=>"INTERNAL"in p_).map(p_=>p_.INTERNAL.delete()),...r_.filter(p_=>"_delete"in p_).map(p_=>p_._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(_A=_r){return this.instances.has(_A)}getOptions(_A=_r){return this.instancesOptions.get(_A)||{}}initialize(_A={}){const{options:r_={}}=_A,p_=this.normalizeInstanceIdentifier(_A.instanceIdentifier);if(this.isInitialized(p_))throw Error(`${this.name}(${p_}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const I_=this.getOrInitializeService({instanceIdentifier:p_,options:r_});for(const[v_,S_]of this.instancesDeferred.entries())p_===this.normalizeInstanceIdentifier(v_)&&S_.resolve(I_);return I_}onInit(_A,r_){var p_;const I_=this.normalizeInstanceIdentifier(r_),v_=null!==(p_=this.onInitCallbacks.get(I_))&&void 0!==p_?p_:new Set;v_.add(_A),this.onInitCallbacks.set(I_,v_);const S_=this.instances.get(I_);return S_&&_A(S_,I_),()=>{v_.delete(_A)}}invokeOnInitCallbacks(_A,r_){const p_=this.onInitCallbacks.get(r_);if(p_)for(const I_ of p_)try{I_(_A,r_)}catch(v_){}}getOrInitializeService({instanceIdentifier:_A,options:r_={}}){let p_=this.instances.get(_A);if(!p_&&this.component&&(p_=this.component.instanceFactory(this.container,{instanceIdentifier:(n_=_A,n_===_r?void 0:n_),options:r_}),this.instances.set(_A,p_),this.instancesOptions.set(_A,r_),this.invokeOnInitCallbacks(p_,_A),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,_A,p_)}catch(I_){}var n_;return p_||null}normalizeInstanceIdentifier(_A=_r){return this.component?this.component.multipleInstances?_A:_r:_A}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class bh{constructor(_A){this.name=_A,this.providers=new Map}addComponent(_A){const r_=this.getProvider(_A.name);if(r_.isComponentSet())throw new Error(`Component ${_A.name} has already been registered with ${this.name}`);r_.setComponent(_A)}addOrOverwriteComponent(_A){this.getProvider(_A.name).isComponentSet()&&this.providers.delete(_A.name),this.addComponent(_A)}getProvider(_A){if(this.providers.has(_A))return this.providers.get(_A);const r_=new _s(_A,this);return this.providers.set(_A,r_),r_}getProviders(){return Array.from(this.providers.values())}}},1877:(h,l,g)=>{"use strict";g.d(l,{Am:()=>n_,Ub:()=>bh,Yd:()=>_l,in:()=>k});const f=[];var k=(()=>{return(_A=k||(k={}))[_A.DEBUG=0]="DEBUG",_A[_A.VERBOSE=1]="VERBOSE",_A[_A.INFO=2]="INFO",_A[_A.WARN=3]="WARN",_A[_A.ERROR=4]="ERROR",_A[_A.SILENT=5]="SILENT",k;var _A})();const q={debug:k.DEBUG,verbose:k.VERBOSE,info:k.INFO,warn:k.WARN,error:k.ERROR,silent:k.SILENT},_r=k.INFO,_s={[k.DEBUG]:"log",[k.VERBOSE]:"log",[k.INFO]:"info",[k.WARN]:"warn",[k.ERROR]:"error"},ga=(_A,r_,...p_)=>{if(r_<_A.logLevel)return;const I_=(new Date).toISOString(),v_=_s[r_];if(!v_)throw new Error(`Attempted to log a message with an invalid logType (value: ${r_})`);console[v_](`[${I_}]  ${_A.name}:`,...p_)};class _l{constructor(r_){this.name=r_,this._logLevel=_r,this._logHandler=ga,this._userLogHandler=null,f.push(this)}get logLevel(){return this._logLevel}set logLevel(r_){if(!(r_ in k))throw new TypeError(`Invalid value "${r_}" assigned to \`logLevel\``);this._logLevel=r_}setLogLevel(r_){this._logLevel="string"==typeof r_?q[r_]:r_}get logHandler(){return this._logHandler}set logHandler(r_){if("function"!=typeof r_)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=r_}get userLogHandler(){return this._userLogHandler}set userLogHandler(r_){this._userLogHandler=r_}debug(...r_){this._userLogHandler&&this._userLogHandler(this,k.DEBUG,...r_),this._logHandler(this,k.DEBUG,...r_)}log(...r_){this._userLogHandler&&this._userLogHandler(this,k.VERBOSE,...r_),this._logHandler(this,k.VERBOSE,...r_)}info(...r_){this._userLogHandler&&this._userLogHandler(this,k.INFO,...r_),this._logHandler(this,k.INFO,...r_)}warn(...r_){this._userLogHandler&&this._userLogHandler(this,k.WARN,...r_),this._logHandler(this,k.WARN,...r_)}error(...r_){this._userLogHandler&&this._userLogHandler(this,k.ERROR,...r_),this._logHandler(this,k.ERROR,...r_)}}function bh(_A){f.forEach(r_=>{r_.setLogLevel(_A)})}function n_(_A,r_){for(const p_ of f){let I_=null;r_&&r_.level&&(I_=q[r_.level]),p_.userLogHandler=null===_A?null:(v_,S_,...x_)=>{const B_=x_.map(V_=>{if(null==V_)return null;if("string"==typeof V_)return V_;if("number"==typeof V_||"boolean"==typeof V_)return V_.toString();if(V_ instanceof Error)return V_.message;try{return JSON.stringify(V_)}catch(_0){return null}}).filter(V_=>V_).join(" ");S_>=(null!=I_?I_:v_.logLevel)&&_A({level:k[S_].toLowerCase(),message:B_,args:x_,type:v_.name})}}}},8766:(h,l,g)=>{"use strict";g.d(l,{Lj:()=>Pv,X3:()=>c0});var f=g(5861);let q,_r;const _l=new WeakMap,bh=new WeakMap,n_=new WeakMap,_A=new WeakMap,r_=new WeakMap;let v_={get(P_,_v,E_){if(P_ instanceof IDBTransaction){if("done"===_v)return bh.get(P_);if("objectStoreNames"===_v)return P_.objectStoreNames||n_.get(P_);if("store"===_v)return E_.objectStoreNames[1]?void 0:E_.objectStore(E_.objectStoreNames[0])}return V_(P_[_v])},set:(P_,_v,E_)=>(P_[_v]=E_,!0),has:(P_,_v)=>P_ instanceof IDBTransaction&&("done"===_v||"store"===_v)||_v in P_};function B_(P_){return"function"==typeof P_?function x_(P_){return P_!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function ga(){return _r||(_r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(P_)?function(..._v){return P_.apply(_0(this),_v),V_(_l.get(this))}:function(..._v){return V_(P_.apply(_0(this),_v))}:function(_v,...E_){const L_=P_.call(_0(this),_v,...E_);return n_.set(L_,_v.sort?_v.sort():[_v]),V_(L_)}}(P_):(P_ instanceof IDBTransaction&&function I_(P_){if(bh.has(P_))return;const _v=new Promise((E_,L_)=>{const F_=()=>{P_.removeEventListener("complete",J_),P_.removeEventListener("error",Y_),P_.removeEventListener("abort",Y_)},J_=()=>{E_(),F_()},Y_=()=>{L_(P_.error||new DOMException("AbortError","AbortError")),F_()};P_.addEventListener("complete",J_),P_.addEventListener("error",Y_),P_.addEventListener("abort",Y_)});bh.set(P_,_v)}(P_),((P_,_v)=>_v.some(E_=>P_ instanceof E_))(P_,function _s(){return q||(q=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(P_,v_):P_)}function V_(P_){if(P_ instanceof IDBRequest)return function p_(P_){const _v=new Promise((E_,L_)=>{const F_=()=>{P_.removeEventListener("success",J_),P_.removeEventListener("error",Y_)},J_=()=>{E_(V_(P_.result)),F_()},Y_=()=>{L_(P_.error),F_()};P_.addEventListener("success",J_),P_.addEventListener("error",Y_)});return _v.then(E_=>{E_ instanceof IDBCursor&&_l.set(E_,P_)}).catch(()=>{}),r_.set(_v,P_),_v}(P_);if(_A.has(P_))return _A.get(P_);const _v=B_(P_);return _v!==P_&&(_A.set(P_,_v),r_.set(_v,P_)),_v}const _0=P_=>r_.get(P_);function c0(P_,_v,{blocked:E_,upgrade:L_,blocking:F_,terminated:J_}={}){const Y_=indexedDB.open(P_,_v),D0=V_(Y_);return L_&&Y_.addEventListener("upgradeneeded",O0=>{L_(V_(Y_.result),O0.oldVersion,O0.newVersion,V_(Y_.transaction))}),E_&&Y_.addEventListener("blocked",()=>E_()),D0.then(O0=>{J_&&O0.addEventListener("close",()=>J_()),F_&&O0.addEventListener("versionchange",()=>F_())}).catch(()=>{}),D0}function Pv(P_,{blocked:_v}={}){const E_=indexedDB.deleteDatabase(P_);return _v&&E_.addEventListener("blocked",()=>_v()),V_(E_).then(()=>{})}const h0=["get","getKey","getAll","getAllKeys","count"],I0=["put","add","delete","clear"],G_=new Map;function e0(P_,_v){if(!(P_ instanceof IDBDatabase)||_v in P_||"string"!=typeof _v)return;if(G_.get(_v))return G_.get(_v);const E_=_v.replace(/FromIndex$/,""),L_=_v!==E_,F_=I0.includes(E_);if(!(E_ in(L_?IDBIndex:IDBObjectStore).prototype)||!F_&&!h0.includes(E_))return;const J_=function(){var Y_=(0,f.Z)(function*(D0,...O0){const EI=this.transaction(D0,F_?"readwrite":"readonly");let eI=EI.store;return L_&&(eI=eI.index(O0.shift())),(yield Promise.all([eI[E_](...O0),F_&&EI.done]))[0]});return function(O0){return Y_.apply(this,arguments)}}();return G_.set(_v,J_),J_}!function S_(P_){v_=P_(v_)}(P_=>Z0e($0e({},P_),{get:(_v,E_,L_)=>e0(_v,E_)||P_.get(_v,E_,L_),has:(_v,E_)=>!!e0(_v,E_)||P_.has(_v,E_)}))},5861:(h,l,g)=>{"use strict";function f(q,_r,_s,ga,_l,bh,n_){try{var _A=q[bh](n_),r_=_A.value}catch(p_){return void _s(p_)}_A.done?_r(r_):Promise.resolve(r_).then(ga,_l)}function k(q){return function(){var _r=this,_s=arguments;return new Promise(function(ga,_l){var bh=q.apply(_r,_s);function n_(r_){f(bh,ga,_l,n_,_A,"next",r_)}function _A(r_){f(bh,ga,_l,n_,_A,"throw",r_)}n_(void 0)})}}g.d(l,{Z:()=>k})}},h=>{h(h.s=6114)}]);